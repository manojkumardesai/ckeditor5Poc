{
  "version": 3,
  "sources": ["../../../../../../node_modules/fuzzysort/fuzzysort.js", "../../../../../../node_modules/@ckeditor/ckeditor5-adapter-ckfinder/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-alignment/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-autoformat/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-autosave/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-basic-styles/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-block-quote/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-bookmark/dist/index.js", "../../../../../../node_modules/blurhash/dist/esm/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-ckbox/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-ckfinder/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-cloud-services/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-code-block/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-easy-image/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-editor-balloon/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-editor-classic/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-editor-decoupled/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-editor-inline/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-editor-multi-root/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-emoji/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-essentials/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-find-and-replace/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-font/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-fullscreen/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-heading/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-highlight/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-horizontal-line/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-html-embed/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-html-support/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-image/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-indent/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-language/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-link/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-list/dist/index.js", "../../../../../../node_modules/marked/lib/marked.esm.js", "../../../../../../node_modules/turndown/lib/turndown.browser.es.js", "../../../../../../node_modules/turndown-plugin-gfm/lib/turndown-plugin-gfm.es.js", "../../../../../../node_modules/@ckeditor/ckeditor5-markdown-gfm/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-media-embed/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-mention/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-minimap/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-page-break/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-remove-format/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-restricted-editing/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-show-blocks/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-source-editing/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-special-characters/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-style/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-table/dist/index.js", "../../../../../../node_modules/@ckeditor/ckeditor5-word-count/dist/index.js"],
  "sourcesContent": ["// https://github.com/farzher/fuzzysort v3.0.2\n\n// UMD (Universal Module Definition) for fuzzysort\n;\n((root, UMD) => {\n  if (typeof define === 'function' && define.amd) define([], UMD);else if (typeof module === 'object' && module.exports) module.exports = UMD();else root['fuzzysort'] = UMD();\n})(this, _ => {\n  'use strict';\n\n  var single = (search, target) => {\n    if (!search || !target) return NULL;\n    var preparedSearch = getPreparedSearch(search);\n    if (!isPrepared(target)) target = getPrepared(target);\n    var searchBitflags = preparedSearch.bitflags;\n    if ((searchBitflags & target._bitflags) !== searchBitflags) return NULL;\n    return algorithm(preparedSearch, target);\n  };\n  var go = (search, targets, options) => {\n    if (!search) return options?.all ? all(targets, options) : noResults;\n    var preparedSearch = getPreparedSearch(search);\n    var searchBitflags = preparedSearch.bitflags;\n    var containsSpace = preparedSearch.containsSpace;\n    var threshold = denormalizeScore(options?.threshold || 0);\n    var limit = options?.limit || INFINITY;\n    var resultsLen = 0;\n    var limitedCount = 0;\n    var targetsLen = targets.length;\n    function push_result(result) {\n      if (resultsLen < limit) {\n        q.add(result);\n        ++resultsLen;\n      } else {\n        ++limitedCount;\n        if (result._score > q.peek()._score) q.replaceTop(result);\n      }\n    }\n\n    // This code is copy/pasted 3 times for performance reasons [options.key, options.keys, no keys]\n\n    // options.key\n    if (options?.key) {\n      var key = options.key;\n      for (var i = 0; i < targetsLen; ++i) {\n        var obj = targets[i];\n        var target = getValue(obj, key);\n        if (!target) continue;\n        if (!isPrepared(target)) target = getPrepared(target);\n        if ((searchBitflags & target._bitflags) !== searchBitflags) continue;\n        var result = algorithm(preparedSearch, target);\n        if (result === NULL) continue;\n        if (result._score < threshold) continue;\n        result.obj = obj;\n        push_result(result);\n      }\n\n      // options.keys\n    } else if (options?.keys) {\n      var keys = options.keys;\n      var keysLen = keys.length;\n      outer: for (var i = 0; i < targetsLen; ++i) {\n        var obj = targets[i];\n        {\n          // early out based on bitflags\n          var keysBitflags = 0;\n          for (var keyI = 0; keyI < keysLen; ++keyI) {\n            var key = keys[keyI];\n            var target = getValue(obj, key);\n            if (!target) {\n              tmpTargets[keyI] = noTarget;\n              continue;\n            }\n            if (!isPrepared(target)) target = getPrepared(target);\n            tmpTargets[keyI] = target;\n            keysBitflags |= target._bitflags;\n          }\n          if ((searchBitflags & keysBitflags) !== searchBitflags) continue;\n        }\n        if (containsSpace) for (let i = 0; i < preparedSearch.spaceSearches.length; i++) keysSpacesBestScores[i] = NEGATIVE_INFINITY;\n        for (var keyI = 0; keyI < keysLen; ++keyI) {\n          target = tmpTargets[keyI];\n          if (target === noTarget) {\n            tmpResults[keyI] = noTarget;\n            continue;\n          }\n          tmpResults[keyI] = algorithm(preparedSearch, target, /*allowSpaces=*/false, /*allowPartialMatch=*/containsSpace);\n          if (tmpResults[keyI] === NULL) {\n            tmpResults[keyI] = noTarget;\n            continue;\n          }\n\n          // todo: this seems weird and wrong. like what if our first match wasn't good. this should just replace it instead of averaging with it\n          // if our second match isn't good we ignore it instead of averaging with it\n          if (containsSpace) for (let i = 0; i < preparedSearch.spaceSearches.length; i++) {\n            if (allowPartialMatchScores[i] > -1000) {\n              if (keysSpacesBestScores[i] > NEGATIVE_INFINITY) {\n                var tmp = (keysSpacesBestScores[i] + allowPartialMatchScores[i]) / 4; /*bonus score for having multiple matches*/\n                if (tmp > keysSpacesBestScores[i]) keysSpacesBestScores[i] = tmp;\n              }\n            }\n            if (allowPartialMatchScores[i] > keysSpacesBestScores[i]) keysSpacesBestScores[i] = allowPartialMatchScores[i];\n          }\n        }\n        if (containsSpace) {\n          for (let i = 0; i < preparedSearch.spaceSearches.length; i++) {\n            if (keysSpacesBestScores[i] === NEGATIVE_INFINITY) continue outer;\n          }\n        } else {\n          var hasAtLeast1Match = false;\n          for (let i = 0; i < keysLen; i++) {\n            if (tmpResults[i]._score !== NEGATIVE_INFINITY) {\n              hasAtLeast1Match = true;\n              break;\n            }\n          }\n          if (!hasAtLeast1Match) continue;\n        }\n        var objResults = new KeysResult(keysLen);\n        for (let i = 0; i < keysLen; i++) {\n          objResults[i] = tmpResults[i];\n        }\n        if (containsSpace) {\n          var score = 0;\n          for (let i = 0; i < preparedSearch.spaceSearches.length; i++) score += keysSpacesBestScores[i];\n        } else {\n          // todo could rewrite this scoring to be more similar to when there's spaces\n          // if we match multiple keys give us bonus points\n          var score = NEGATIVE_INFINITY;\n          for (let i = 0; i < keysLen; i++) {\n            var result = objResults[i];\n            if (result._score > -1000) {\n              if (score > NEGATIVE_INFINITY) {\n                var tmp = (score + result._score) / 4; /*bonus score for having multiple matches*/\n                if (tmp > score) score = tmp;\n              }\n            }\n            if (result._score > score) score = result._score;\n          }\n        }\n        objResults.obj = obj;\n        objResults._score = score;\n        if (options?.scoreFn) {\n          score = options.scoreFn(objResults);\n          if (!score) continue;\n          score = denormalizeScore(score);\n          objResults._score = score;\n        }\n        if (score < threshold) continue;\n        push_result(objResults);\n      }\n\n      // no keys\n    } else {\n      for (var i = 0; i < targetsLen; ++i) {\n        var target = targets[i];\n        if (!target) continue;\n        if (!isPrepared(target)) target = getPrepared(target);\n        if ((searchBitflags & target._bitflags) !== searchBitflags) continue;\n        var result = algorithm(preparedSearch, target);\n        if (result === NULL) continue;\n        if (result._score < threshold) continue;\n        push_result(result);\n      }\n    }\n    if (resultsLen === 0) return noResults;\n    var results = new Array(resultsLen);\n    for (var i = resultsLen - 1; i >= 0; --i) results[i] = q.poll();\n    results.total = resultsLen + limitedCount;\n    return results;\n  };\n\n  // this is written as 1 function instead of 2 for minification. perf seems fine ...\n  // except when minified. the perf is very slow\n  var highlight = (result, open = '<b>', close = '</b>') => {\n    var callback = typeof open === 'function' ? open : undefined;\n    var target = result.target;\n    var targetLen = target.length;\n    var indexes = result.indexes;\n    var highlighted = '';\n    var matchI = 0;\n    var indexesI = 0;\n    var opened = false;\n    var parts = [];\n    for (var i = 0; i < targetLen; ++i) {\n      var char = target[i];\n      if (indexes[indexesI] === i) {\n        ++indexesI;\n        if (!opened) {\n          opened = true;\n          if (callback) {\n            parts.push(highlighted);\n            highlighted = '';\n          } else {\n            highlighted += open;\n          }\n        }\n        if (indexesI === indexes.length) {\n          if (callback) {\n            highlighted += char;\n            parts.push(callback(highlighted, matchI++));\n            highlighted = '';\n            parts.push(target.substr(i + 1));\n          } else {\n            highlighted += char + close + target.substr(i + 1);\n          }\n          break;\n        }\n      } else {\n        if (opened) {\n          opened = false;\n          if (callback) {\n            parts.push(callback(highlighted, matchI++));\n            highlighted = '';\n          } else {\n            highlighted += close;\n          }\n        }\n      }\n      highlighted += char;\n    }\n    return callback ? parts : highlighted;\n  };\n  var prepare = target => {\n    if (typeof target === 'number') target = '' + target;else if (typeof target !== 'string') target = '';\n    var info = prepareLowerInfo(target);\n    return new_result(target, {\n      _targetLower: info._lower,\n      _targetLowerCodes: info.lowerCodes,\n      _bitflags: info.bitflags\n    });\n  };\n  var cleanup = () => {\n    preparedCache.clear();\n    preparedSearchCache.clear();\n  };\n\n  // Below this point is only internal code\n  // Below this point is only internal code\n  // Below this point is only internal code\n  // Below this point is only internal code\n\n  class Result {\n    get ['indexes']() {\n      return this._indexes.slice(0, this._indexes.len).sort((a, b) => a - b);\n    }\n    set ['indexes'](indexes) {\n      return this._indexes = indexes;\n    }\n    ['highlight'](open, close) {\n      return highlight(this, open, close);\n    }\n    get ['score']() {\n      return normalizeScore(this._score);\n    }\n    set ['score'](score) {\n      this._score = denormalizeScore(score);\n    }\n  }\n  class KeysResult extends Array {\n    get ['score']() {\n      return normalizeScore(this._score);\n    }\n    set ['score'](score) {\n      this._score = denormalizeScore(score);\n    }\n  }\n  var new_result = (target, options) => {\n    const result = new Result();\n    result['target'] = target;\n    result['obj'] = options.obj ?? NULL;\n    result._score = options._score ?? NEGATIVE_INFINITY;\n    result._indexes = options._indexes ?? [];\n    result._targetLower = options._targetLower ?? '';\n    result._targetLowerCodes = options._targetLowerCodes ?? NULL;\n    result._nextBeginningIndexes = options._nextBeginningIndexes ?? NULL;\n    result._bitflags = options._bitflags ?? 0;\n    return result;\n  };\n  var normalizeScore = score => {\n    if (score === NEGATIVE_INFINITY) return 0;\n    if (score > 1) return score;\n    return Math.E ** (((-score + 1) ** .04307 - 1) * -2);\n  };\n  var denormalizeScore = normalizedScore => {\n    if (normalizedScore === 0) return NEGATIVE_INFINITY;\n    if (normalizedScore > 1) return normalizedScore;\n    return 1 - Math.pow(Math.log(normalizedScore) / -2 + 1, 1 / 0.04307);\n  };\n  var prepareSearch = search => {\n    if (typeof search === 'number') search = '' + search;else if (typeof search !== 'string') search = '';\n    search = search.trim();\n    var info = prepareLowerInfo(search);\n    var spaceSearches = [];\n    if (info.containsSpace) {\n      var searches = search.split(/\\s+/);\n      searches = [...new Set(searches)]; // distinct\n      for (var i = 0; i < searches.length; i++) {\n        if (searches[i] === '') continue;\n        var _info = prepareLowerInfo(searches[i]);\n        spaceSearches.push({\n          lowerCodes: _info.lowerCodes,\n          _lower: searches[i].toLowerCase(),\n          containsSpace: false\n        });\n      }\n    }\n    return {\n      lowerCodes: info.lowerCodes,\n      _lower: info._lower,\n      containsSpace: info.containsSpace,\n      bitflags: info.bitflags,\n      spaceSearches: spaceSearches\n    };\n  };\n  var getPrepared = target => {\n    if (target.length > 999) return prepare(target); // don't cache huge targets\n    var targetPrepared = preparedCache.get(target);\n    if (targetPrepared !== undefined) return targetPrepared;\n    targetPrepared = prepare(target);\n    preparedCache.set(target, targetPrepared);\n    return targetPrepared;\n  };\n  var getPreparedSearch = search => {\n    if (search.length > 999) return prepareSearch(search); // don't cache huge searches\n    var searchPrepared = preparedSearchCache.get(search);\n    if (searchPrepared !== undefined) return searchPrepared;\n    searchPrepared = prepareSearch(search);\n    preparedSearchCache.set(search, searchPrepared);\n    return searchPrepared;\n  };\n  var all = (targets, options) => {\n    var results = [];\n    results.total = targets.length; // this total can be wrong if some targets are skipped\n\n    var limit = options?.limit || INFINITY;\n    if (options?.key) {\n      for (var i = 0; i < targets.length; i++) {\n        var obj = targets[i];\n        var target = getValue(obj, options.key);\n        if (target == NULL) continue;\n        if (!isPrepared(target)) target = getPrepared(target);\n        var result = new_result(target.target, {\n          _score: target._score,\n          obj: obj\n        });\n        results.push(result);\n        if (results.length >= limit) return results;\n      }\n    } else if (options?.keys) {\n      for (var i = 0; i < targets.length; i++) {\n        var obj = targets[i];\n        var objResults = new KeysResult(options.keys.length);\n        for (var keyI = options.keys.length - 1; keyI >= 0; --keyI) {\n          var target = getValue(obj, options.keys[keyI]);\n          if (!target) {\n            objResults[keyI] = noTarget;\n            continue;\n          }\n          if (!isPrepared(target)) target = getPrepared(target);\n          target._score = NEGATIVE_INFINITY;\n          target._indexes.len = 0;\n          objResults[keyI] = target;\n        }\n        objResults.obj = obj;\n        objResults._score = NEGATIVE_INFINITY;\n        results.push(objResults);\n        if (results.length >= limit) return results;\n      }\n    } else {\n      for (var i = 0; i < targets.length; i++) {\n        var target = targets[i];\n        if (target == NULL) continue;\n        if (!isPrepared(target)) target = getPrepared(target);\n        target._score = NEGATIVE_INFINITY;\n        target._indexes.len = 0;\n        results.push(target);\n        if (results.length >= limit) return results;\n      }\n    }\n    return results;\n  };\n  var algorithm = (preparedSearch, prepared, allowSpaces = false, allowPartialMatch = false) => {\n    if (allowSpaces === false && preparedSearch.containsSpace) return algorithmSpaces(preparedSearch, prepared, allowPartialMatch);\n    var searchLower = preparedSearch._lower;\n    var searchLowerCodes = preparedSearch.lowerCodes;\n    var searchLowerCode = searchLowerCodes[0];\n    var targetLowerCodes = prepared._targetLowerCodes;\n    var searchLen = searchLowerCodes.length;\n    var targetLen = targetLowerCodes.length;\n    var searchI = 0; // where we at\n    var targetI = 0; // where you at\n    var matchesSimpleLen = 0;\n\n    // very basic fuzzy match; to remove non-matching targets ASAP!\n    // walk through target. find sequential matches.\n    // if all chars aren't found then exit\n    for (;;) {\n      var isMatch = searchLowerCode === targetLowerCodes[targetI];\n      if (isMatch) {\n        matchesSimple[matchesSimpleLen++] = targetI;\n        ++searchI;\n        if (searchI === searchLen) break;\n        searchLowerCode = searchLowerCodes[searchI];\n      }\n      ++targetI;\n      if (targetI >= targetLen) return NULL; // Failed to find searchI\n    }\n    var searchI = 0;\n    var successStrict = false;\n    var matchesStrictLen = 0;\n    var nextBeginningIndexes = prepared._nextBeginningIndexes;\n    if (nextBeginningIndexes === NULL) nextBeginningIndexes = prepared._nextBeginningIndexes = prepareNextBeginningIndexes(prepared.target);\n    targetI = matchesSimple[0] === 0 ? 0 : nextBeginningIndexes[matchesSimple[0] - 1];\n\n    // Our target string successfully matched all characters in sequence!\n    // Let's try a more advanced and strict test to improve the score\n    // only count it as a match if it's consecutive or a beginning character!\n    var backtrackCount = 0;\n    if (targetI !== targetLen) for (;;) {\n      if (targetI >= targetLen) {\n        // We failed to find a good spot for this search char, go back to the previous search char and force it forward\n        if (searchI <= 0) break; // We failed to push chars forward for a better match\n\n        ++backtrackCount;\n        if (backtrackCount > 200) break; // exponential backtracking is taking too long, just give up and return a bad match\n\n        --searchI;\n        var lastMatch = matchesStrict[--matchesStrictLen];\n        targetI = nextBeginningIndexes[lastMatch];\n      } else {\n        var isMatch = searchLowerCodes[searchI] === targetLowerCodes[targetI];\n        if (isMatch) {\n          matchesStrict[matchesStrictLen++] = targetI;\n          ++searchI;\n          if (searchI === searchLen) {\n            successStrict = true;\n            break;\n          }\n          ++targetI;\n        } else {\n          targetI = nextBeginningIndexes[targetI];\n        }\n      }\n    }\n\n    // check if it's a substring match\n    var substringIndex = searchLen <= 1 ? -1 : prepared._targetLower.indexOf(searchLower, matchesSimple[0]); // perf: this is slow\n    var isSubstring = !!~substringIndex;\n    var isSubstringBeginning = !isSubstring ? false : substringIndex === 0 || prepared._nextBeginningIndexes[substringIndex - 1] === substringIndex;\n\n    // if it's a substring match but not at a beginning index, let's try to find a substring starting at a beginning index for a better score\n    if (isSubstring && !isSubstringBeginning) {\n      for (var i = 0; i < nextBeginningIndexes.length; i = nextBeginningIndexes[i]) {\n        if (i <= substringIndex) continue;\n        for (var s = 0; s < searchLen; s++) if (searchLowerCodes[s] !== prepared._targetLowerCodes[i + s]) break;\n        if (s === searchLen) {\n          substringIndex = i;\n          isSubstringBeginning = true;\n          break;\n        }\n      }\n    }\n\n    // tally up the score & keep track of matches for highlighting later\n    // if it's a simple match, we'll switch to a substring match if a substring exists\n    // if it's a strict match, we'll switch to a substring match only if that's a better score\n\n    var calculateScore = matches => {\n      var score = 0;\n      var extraMatchGroupCount = 0;\n      for (var i = 1; i < searchLen; ++i) {\n        if (matches[i] - matches[i - 1] !== 1) {\n          score -= matches[i];\n          ++extraMatchGroupCount;\n        }\n      }\n      var unmatchedDistance = matches[searchLen - 1] - matches[0] - (searchLen - 1);\n      score -= (12 + unmatchedDistance) * extraMatchGroupCount; // penality for more groups\n\n      if (matches[0] !== 0) score -= matches[0] * matches[0] * .2; // penality for not starting near the beginning\n\n      if (!successStrict) {\n        score *= 1000;\n      } else {\n        // successStrict on a target with too many beginning indexes loses points for being a bad target\n        var uniqueBeginningIndexes = 1;\n        for (var i = nextBeginningIndexes[0]; i < targetLen; i = nextBeginningIndexes[i]) ++uniqueBeginningIndexes;\n        if (uniqueBeginningIndexes > 24) score *= (uniqueBeginningIndexes - 24) * 10; // quite arbitrary numbers here ...\n      }\n      score -= (targetLen - searchLen) / 2; // penality for longer targets\n\n      if (isSubstring) score /= 1 + searchLen * searchLen * 1; // bonus for being a full substring\n      if (isSubstringBeginning) score /= 1 + searchLen * searchLen * 1; // bonus for substring starting on a beginningIndex\n\n      score -= (targetLen - searchLen) / 2; // penality for longer targets\n\n      return score;\n    };\n    if (!successStrict) {\n      if (isSubstring) for (var i = 0; i < searchLen; ++i) matchesSimple[i] = substringIndex + i; // at this point it's safe to overwrite matchehsSimple with substr matches\n      var matchesBest = matchesSimple;\n      var score = calculateScore(matchesBest);\n    } else {\n      if (isSubstringBeginning) {\n        for (var i = 0; i < searchLen; ++i) matchesSimple[i] = substringIndex + i; // at this point it's safe to overwrite matchehsSimple with substr matches\n        var matchesBest = matchesSimple;\n        var score = calculateScore(matchesSimple);\n      } else {\n        var matchesBest = matchesStrict;\n        var score = calculateScore(matchesStrict);\n      }\n    }\n    prepared._score = score;\n    for (var i = 0; i < searchLen; ++i) prepared._indexes[i] = matchesBest[i];\n    prepared._indexes.len = searchLen;\n    const result = new Result();\n    result.target = prepared.target;\n    result._score = prepared._score;\n    result._indexes = prepared._indexes;\n    return result;\n  };\n  var algorithmSpaces = (preparedSearch, target, allowPartialMatch) => {\n    var seen_indexes = new Set();\n    var score = 0;\n    var result = NULL;\n    var first_seen_index_last_search = 0;\n    var searches = preparedSearch.spaceSearches;\n    var searchesLen = searches.length;\n    var changeslen = 0;\n\n    // Return _nextBeginningIndexes back to its normal state\n    var resetNextBeginningIndexes = () => {\n      for (let i = changeslen - 1; i >= 0; i--) target._nextBeginningIndexes[nextBeginningIndexesChanges[i * 2 + 0]] = nextBeginningIndexesChanges[i * 2 + 1];\n    };\n    var hasAtLeast1Match = false;\n    for (var i = 0; i < searchesLen; ++i) {\n      allowPartialMatchScores[i] = NEGATIVE_INFINITY;\n      var search = searches[i];\n      result = algorithm(search, target);\n      if (allowPartialMatch) {\n        if (result === NULL) continue;\n        hasAtLeast1Match = true;\n      } else {\n        if (result === NULL) {\n          resetNextBeginningIndexes();\n          return NULL;\n        }\n      }\n\n      // if not the last search, we need to mutate _nextBeginningIndexes for the next search\n      var isTheLastSearch = i === searchesLen - 1;\n      if (!isTheLastSearch) {\n        var indexes = result._indexes;\n        var indexesIsConsecutiveSubstring = true;\n        for (let i = 0; i < indexes.len - 1; i++) {\n          if (indexes[i + 1] - indexes[i] !== 1) {\n            indexesIsConsecutiveSubstring = false;\n            break;\n          }\n        }\n        if (indexesIsConsecutiveSubstring) {\n          var newBeginningIndex = indexes[indexes.len - 1] + 1;\n          var toReplace = target._nextBeginningIndexes[newBeginningIndex - 1];\n          for (let i = newBeginningIndex - 1; i >= 0; i--) {\n            if (toReplace !== target._nextBeginningIndexes[i]) break;\n            target._nextBeginningIndexes[i] = newBeginningIndex;\n            nextBeginningIndexesChanges[changeslen * 2 + 0] = i;\n            nextBeginningIndexesChanges[changeslen * 2 + 1] = toReplace;\n            changeslen++;\n          }\n        }\n      }\n      score += result._score / searchesLen;\n      allowPartialMatchScores[i] = result._score / searchesLen;\n\n      // dock points based on order otherwise \"c man\" returns Manifest.cpp instead of CheatManager.h\n      if (result._indexes[0] < first_seen_index_last_search) {\n        score -= (first_seen_index_last_search - result._indexes[0]) * 2;\n      }\n      first_seen_index_last_search = result._indexes[0];\n      for (var j = 0; j < result._indexes.len; ++j) seen_indexes.add(result._indexes[j]);\n    }\n    if (allowPartialMatch && !hasAtLeast1Match) return NULL;\n    resetNextBeginningIndexes();\n\n    // allows a search with spaces that's an exact substring to score well\n    var allowSpacesResult = algorithm(preparedSearch, target, /*allowSpaces=*/true);\n    if (allowSpacesResult !== NULL && allowSpacesResult._score > score) {\n      if (allowPartialMatch) {\n        for (var i = 0; i < searchesLen; ++i) {\n          allowPartialMatchScores[i] = allowSpacesResult._score / searchesLen;\n        }\n      }\n      return allowSpacesResult;\n    }\n    if (allowPartialMatch) result = target;\n    result._score = score;\n    var i = 0;\n    for (let index of seen_indexes) result._indexes[i++] = index;\n    result._indexes.len = i;\n    return result;\n  };\n\n  // we use this instead of just .normalize('NFD').replace(/[\\u0300-\\u036f]/g, '') because that screws with japanese characters\n  var remove_accents = str => str.replace(/\\p{Script=Latin}+/gu, match => match.normalize('NFD')).replace(/[\\u0300-\\u036f]/g, '');\n  var prepareLowerInfo = str => {\n    str = remove_accents(str);\n    var strLen = str.length;\n    var lower = str.toLowerCase();\n    var lowerCodes = []; // new Array(strLen)    sparse array is too slow\n    var bitflags = 0;\n    var containsSpace = false; // space isn't stored in bitflags because of how searching with a space works\n\n    for (var i = 0; i < strLen; ++i) {\n      var lowerCode = lowerCodes[i] = lower.charCodeAt(i);\n      if (lowerCode === 32) {\n        containsSpace = true;\n        continue; // it's important that we don't set any bitflags for space\n      }\n      var bit = lowerCode >= 97 && lowerCode <= 122 ? lowerCode - 97 // alphabet\n      : lowerCode >= 48 && lowerCode <= 57 ? 26 // numbers\n      // 3 bits available\n      : lowerCode <= 127 ? 30 // other ascii\n      : 31; // other utf8\n      bitflags |= 1 << bit;\n    }\n    return {\n      lowerCodes: lowerCodes,\n      bitflags: bitflags,\n      containsSpace: containsSpace,\n      _lower: lower\n    };\n  };\n  var prepareBeginningIndexes = target => {\n    var targetLen = target.length;\n    var beginningIndexes = [];\n    var beginningIndexesLen = 0;\n    var wasUpper = false;\n    var wasAlphanum = false;\n    for (var i = 0; i < targetLen; ++i) {\n      var targetCode = target.charCodeAt(i);\n      var isUpper = targetCode >= 65 && targetCode <= 90;\n      var isAlphanum = isUpper || targetCode >= 97 && targetCode <= 122 || targetCode >= 48 && targetCode <= 57;\n      var isBeginning = isUpper && !wasUpper || !wasAlphanum || !isAlphanum;\n      wasUpper = isUpper;\n      wasAlphanum = isAlphanum;\n      if (isBeginning) beginningIndexes[beginningIndexesLen++] = i;\n    }\n    return beginningIndexes;\n  };\n  var prepareNextBeginningIndexes = target => {\n    target = remove_accents(target);\n    var targetLen = target.length;\n    var beginningIndexes = prepareBeginningIndexes(target);\n    var nextBeginningIndexes = []; // new Array(targetLen)     sparse array is too slow\n    var lastIsBeginning = beginningIndexes[0];\n    var lastIsBeginningI = 0;\n    for (var i = 0; i < targetLen; ++i) {\n      if (lastIsBeginning > i) {\n        nextBeginningIndexes[i] = lastIsBeginning;\n      } else {\n        lastIsBeginning = beginningIndexes[++lastIsBeginningI];\n        nextBeginningIndexes[i] = lastIsBeginning === undefined ? targetLen : lastIsBeginning;\n      }\n    }\n    return nextBeginningIndexes;\n  };\n  var preparedCache = new Map();\n  var preparedSearchCache = new Map();\n\n  // the theory behind these being globals is to reduce garbage collection by not making new arrays\n  var matchesSimple = [];\n  var matchesStrict = [];\n  var nextBeginningIndexesChanges = []; // allows straw berry to match strawberry well, by modifying the end of a substring to be considered a beginning index for the rest of the search\n  var keysSpacesBestScores = [];\n  var allowPartialMatchScores = [];\n  var tmpTargets = [];\n  var tmpResults = [];\n\n  // prop = 'key'                  2.5ms optimized for this case, seems to be about as fast as direct obj[prop]\n  // prop = 'key1.key2'            10ms\n  // prop = ['key1', 'key2']       27ms\n  // prop = obj => obj.tags.join() ??ms\n  var getValue = (obj, prop) => {\n    var tmp = obj[prop];\n    if (tmp !== undefined) return tmp;\n    if (typeof prop === 'function') return prop(obj); // this should run first. but that makes string props slower\n    var segs = prop;\n    if (!Array.isArray(prop)) segs = prop.split('.');\n    var len = segs.length;\n    var i = -1;\n    while (obj && ++i < len) obj = obj[segs[i]];\n    return obj;\n  };\n  var isPrepared = x => {\n    return typeof x === 'object' && typeof x._bitflags === 'number';\n  };\n  var INFINITY = Infinity;\n  var NEGATIVE_INFINITY = -INFINITY;\n  var noResults = [];\n  noResults.total = 0;\n  var NULL = null;\n  var noTarget = prepare('');\n\n  // Hacked version of https://github.com/lemire/FastPriorityQueue.js\n  var fastpriorityqueue = r => {\n    var e = [],\n      o = 0,\n      a = {},\n      v = r => {\n        for (var a = 0, v = e[a], c = 1; c < o;) {\n          var s = c + 1;\n          a = c, s < o && e[s]._score < e[c]._score && (a = s), e[a - 1 >> 1] = e[a], c = 1 + (a << 1);\n        }\n        for (var f = a - 1 >> 1; a > 0 && v._score < e[f]._score; f = (a = f) - 1 >> 1) e[a] = e[f];\n        e[a] = v;\n      };\n    return a.add = r => {\n      var a = o;\n      e[o++] = r;\n      for (var v = a - 1 >> 1; a > 0 && r._score < e[v]._score; v = (a = v) - 1 >> 1) e[a] = e[v];\n      e[a] = r;\n    }, a.poll = r => {\n      if (0 !== o) {\n        var a = e[0];\n        return e[0] = e[--o], v(), a;\n      }\n    }, a.peek = r => {\n      if (0 !== o) return e[0];\n    }, a.replaceTop = r => {\n      e[0] = r, v();\n    }, a;\n  };\n  var q = fastpriorityqueue(); // reuse this\n\n  // fuzzysort is written this way for minification. all names are mangeled unless quoted\n  return {\n    'single': single,\n    'go': go,\n    'prepare': prepare,\n    'cleanup': cleanup\n  };\n}); // UMD", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { FileRepository } from '@ckeditor/ckeditor5-upload/dist/index.js';\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /* globals window, document */ /**\n                                   * @module adapter-ckfinder/utils\n                                   */\nconst TOKEN_COOKIE_NAME = 'ckCsrfToken';\nconst TOKEN_LENGTH = 40;\nconst tokenCharset = 'abcdefghijklmnopqrstuvwxyz0123456789';\n/**\n * Returns the CSRF token value. The value is a hash stored in `document.cookie`\n * under the `ckCsrfToken` key. The CSRF token can be used to secure the communication\n * between the web browser and the CKFinder server.\n */\nfunction getCsrfToken() {\n  let token = getCookie(TOKEN_COOKIE_NAME);\n  if (!token || token.length != TOKEN_LENGTH) {\n    token = generateToken(TOKEN_LENGTH);\n    setCookie(TOKEN_COOKIE_NAME, token);\n  }\n  return token;\n}\n/**\n * Returns the value of the cookie with a given name or `null` if the cookie is not found.\n */\nfunction getCookie(name) {\n  name = name.toLowerCase();\n  const parts = document.cookie.split(';');\n  for (const part of parts) {\n    const pair = part.split('=');\n    const key = decodeURIComponent(pair[0].trim().toLowerCase());\n    if (key === name) {\n      return decodeURIComponent(pair[1]);\n    }\n  }\n  return null;\n}\n/**\n * Sets the value of the cookie with a given name.\n */\nfunction setCookie(name, value) {\n  document.cookie = encodeURIComponent(name) + '=' + encodeURIComponent(value) + ';path=/';\n}\n/**\n * Generates the CSRF token with the given length.\n */\nfunction generateToken(length) {\n  let result = '';\n  const randValues = new Uint8Array(length);\n  window.crypto.getRandomValues(randValues);\n  for (let j = 0; j < randValues.length; j++) {\n    const character = tokenCharset.charAt(randValues[j] % tokenCharset.length);\n    result += Math.random() > 0.5 ? character.toUpperCase() : character;\n  }\n  return result;\n}\n\n/**\n * A plugin that enables file uploads in CKEditor 5 using the CKFinder serverâ€“side connector.\n *\n * See the {@glink features/file-management/ckfinder \"CKFinder file manager integration\"} guide to learn how to configure\n * and use this feature as well as find out more about the full integration with the file manager\n * provided by the {@link module:ckfinder/ckfinder~CKFinder} plugin.\n *\n * Check out the {@glink features/images/image-upload/image-upload comprehensive \"Image upload overview\"} guide to learn\n * about other ways to upload images into CKEditor 5.\n */\nclass CKFinderUploadAdapter extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FileRepository];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKFinderUploadAdapter';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const url = this.editor.config.get('ckfinder.uploadUrl');\n    if (!url) {\n      return;\n    }\n    // Register CKFinderAdapter\n    this.editor.plugins.get(FileRepository).createUploadAdapter = loader => new UploadAdapter(loader, url, this.editor.t);\n  }\n}\n/**\n * Upload adapter for CKFinder.\n */\nclass UploadAdapter {\n  /**\n  * FileLoader instance to use during the upload.\n  */\n  loader;\n  /**\n  * Upload URL.\n  */\n  url;\n  /**\n  * Locale translation method.\n  */\n  t;\n  xhr;\n  /**\n  * Creates a new adapter instance.\n  */\n  constructor(loader, url, t) {\n    this.loader = loader;\n    this.url = url;\n    this.t = t;\n  }\n  /**\n  * Starts the upload process.\n  *\n  * @see module:upload/filerepository~UploadAdapter#upload\n  */\n  upload() {\n    return this.loader.file.then(file => {\n      return new Promise((resolve, reject) => {\n        this._initRequest();\n        this._initListeners(resolve, reject, file);\n        this._sendRequest(file);\n      });\n    });\n  }\n  /**\n  * Aborts the upload process.\n  *\n  * @see module:upload/filerepository~UploadAdapter#abort\n  */\n  abort() {\n    if (this.xhr) {\n      this.xhr.abort();\n    }\n  }\n  /**\n  * Initializes the XMLHttpRequest object.\n  */\n  _initRequest() {\n    const xhr = this.xhr = new XMLHttpRequest();\n    xhr.open('POST', this.url, true);\n    xhr.responseType = 'json';\n  }\n  /**\n  * Initializes XMLHttpRequest listeners.\n  *\n  * @param resolve Callback function to be called when the request is successful.\n  * @param reject Callback function to be called when the request cannot be completed.\n  * @param file File instance to be uploaded.\n  */\n  _initListeners(resolve, reject, file) {\n    const xhr = this.xhr;\n    const loader = this.loader;\n    const t = this.t;\n    const genericError = t('Cannot upload file:') + ` ${file.name}.`;\n    xhr.addEventListener('error', () => reject(genericError));\n    xhr.addEventListener('abort', () => reject());\n    xhr.addEventListener('load', () => {\n      const response = xhr.response;\n      if (!response || !response.uploaded) {\n        return reject(response && response.error && response.error.message ? response.error.message : genericError);\n      }\n      resolve({\n        default: response.url\n      });\n    });\n    // Upload progress when it's supported.\n    /* istanbul ignore else -- @preserve */\n    if (xhr.upload) {\n      xhr.upload.addEventListener('progress', evt => {\n        if (evt.lengthComputable) {\n          loader.uploadTotal = evt.total;\n          loader.uploaded = evt.loaded;\n        }\n      });\n    }\n  }\n  /**\n  * Prepares the data and sends the request.\n  *\n  * @param file File instance to be uploaded.\n  */\n  _sendRequest(file) {\n    // Prepare form data.\n    const data = new FormData();\n    data.append('upload', file);\n    data.append('ckCsrfToken', getCsrfToken());\n    // Send request.\n    this.xhr.send(data);\n  }\n}\nexport { CKFinderUploadAdapter };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { logWarning, CKEditorError, first } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { ButtonView, createDropdown, addToolbarToDropdown, MenuBarMenuView, MenuBarMenuListView, MenuBarMenuListItemView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconAlignLeft, IconAlignRight, IconAlignCenter, IconAlignJustify } from '@ckeditor/ckeditor5-icons/dist/index.js';\n\n/**\n * @module alignment/utils\n */ /**\n    * The list of supported alignment options:\n    *\n    * * `'left'`,\n    * * `'right'`,\n    * * `'center'`,\n    * * `'justify'`\n    */\nconst supportedOptions = ['left', 'right', 'center', 'justify'];\n/**\n * Checks whether the passed option is supported by {@link module:alignment/alignmentediting~AlignmentEditing}.\n *\n * @param option The option value to check.\n */\nfunction isSupported(option) {\n  return supportedOptions.includes(option);\n}\n/**\n * Checks whether alignment is the default one considering the direction\n * of the editor content.\n *\n * @param alignment The name of the alignment to check.\n * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n */\nfunction isDefault(alignment, locale) {\n  // Right now only LTR is supported so the 'left' value is always the default one.\n  if (locale.contentLanguageDirection == 'rtl') {\n    return alignment === 'right';\n  } else {\n    return alignment === 'left';\n  }\n}\n/**\n * Brings the configuration to the common form, an array of objects.\n *\n * @param configuredOptions Alignment plugin configuration.\n * @returns Normalized object holding the configuration.\n */\nfunction normalizeAlignmentOptions(configuredOptions) {\n  const normalizedOptions = configuredOptions.map(option => {\n    let result;\n    if (typeof option == 'string') {\n      result = {\n        name: option\n      };\n    } else {\n      result = option;\n    }\n    return result;\n  }) // Remove all unknown options.\n  .filter(option => {\n    const isNameValid = supportedOptions.includes(option.name);\n    if (!isNameValid) {\n      /**\n      * The `name` in one of the `alignment.options` is not recognized.\n      * The available options are: `'left'`, `'right'`, `'center'` and `'justify'`.\n      *\n      * @error alignment-config-name-not-recognized\n      * @param option Options with unknown value of the `name` property.\n      */\n      logWarning('alignment-config-name-not-recognized', {\n        option\n      });\n    }\n    return isNameValid;\n  });\n  const classNameCount = normalizedOptions.filter(option => Boolean(option.className)).length;\n  // We either use classes for all styling options or for none.\n  if (classNameCount && classNameCount < normalizedOptions.length) {\n    /**\n    * The `className` property has to be defined for all options once at least one option declares `className`.\n    *\n    * @error alignment-config-classnames-are-missing\n    * @param configuredOptions Contents of `alignment.options`.\n    */\n    throw new CKEditorError('alignment-config-classnames-are-missing', {\n      configuredOptions\n    });\n  }\n  // Validate resulting config.\n  normalizedOptions.forEach((option, index, allOptions) => {\n    const succeedingOptions = allOptions.slice(index + 1);\n    const nameAlreadyExists = succeedingOptions.some(item => item.name == option.name);\n    if (nameAlreadyExists) {\n      /**\n      * The same `name` in one of the `alignment.options` was already declared.\n      * Each `name` representing one alignment option can be set exactly once.\n      *\n      * @error alignment-config-name-already-defined\n      * @param option First option that declares given `name`.\n      * @param configuredOptions Contents of `alignment.options`.\n      */\n      throw new CKEditorError('alignment-config-name-already-defined', {\n        option,\n        configuredOptions\n      });\n    }\n    // The `className` property is present. Check for duplicates then.\n    if (option.className) {\n      const classNameAlreadyExists = succeedingOptions.some(item => item.className == option.className);\n      if (classNameAlreadyExists) {\n        /**\n        * The same `className` in one of the `alignment.options` was already declared.\n        *\n        * @error alignment-config-classname-already-defined\n        * @param option First option that declares given `className`.\n        * @param configuredOptions\n        * Contents of `alignment.options`.\n        */\n        throw new CKEditorError('alignment-config-classname-already-defined', {\n          option,\n          configuredOptions\n        });\n      }\n    }\n  });\n  return normalizedOptions;\n}\nconst ALIGNMENT = 'alignment';\n/**\n * The alignment command plugin.\n */\nclass AlignmentCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const firstBlock = first(this.editor.model.document.selection.getSelectedBlocks());\n    // As first check whether to enable or disable the command as the value will always be false if the command cannot be enabled.\n    this.isEnabled = Boolean(firstBlock) && this._canBeAligned(firstBlock);\n    if (this.isEnabled && firstBlock.hasAttribute('alignment')) {\n      this.value = firstBlock.getAttribute('alignment');\n    } else {\n      this.value = locale.contentLanguageDirection === 'rtl' ? 'right' : 'left';\n    }\n  }\n  /**\n  * Executes the command. Applies the alignment `value` to the selected blocks.\n  * If no `value` is passed, the `value` is the default one or it is equal to the currently selected block's alignment attribute,\n  * the command will remove the attribute from the selected blocks.\n  *\n  * @param options Options for the executed command.\n  * @param options.value The value to apply.\n  * @fires execute\n  */\n  execute(options = {}) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const model = editor.model;\n    const doc = model.document;\n    const value = options.value;\n    model.change(writer => {\n      // Get only those blocks from selected that can have alignment set\n      const blocks = Array.from(doc.selection.getSelectedBlocks()).filter(block => this._canBeAligned(block));\n      const currentAlignment = blocks[0].getAttribute('alignment');\n      // Remove alignment attribute if current alignment is:\n      // - default (should not be stored in model as it will bloat model data)\n      // - equal to currently set\n      // - or no value is passed - denotes default alignment.\n      const removeAlignment = isDefault(value, locale) || currentAlignment === value || !value;\n      if (removeAlignment) {\n        removeAlignmentFromSelection(blocks, writer);\n      } else {\n        setAlignmentOnSelection(blocks, writer, value);\n      }\n    });\n  }\n  /**\n  * Checks whether a block can have alignment set.\n  *\n  * @param block The block to be checked.\n  */\n  _canBeAligned(block) {\n    return this.editor.model.schema.checkAttribute(block, ALIGNMENT);\n  }\n}\n/**\n * Removes the alignment attribute from blocks.\n */\nfunction removeAlignmentFromSelection(blocks, writer) {\n  for (const block of blocks) {\n    writer.removeAttribute(ALIGNMENT, block);\n  }\n}\n/**\n * Sets the alignment attribute on blocks.\n */\nfunction setAlignmentOnSelection(blocks, writer, alignment) {\n  for (const block of blocks) {\n    writer.setAttribute(ALIGNMENT, alignment, block);\n  }\n}\n\n/**\n * The alignment editing feature. It introduces the {@link module:alignment/alignmentcommand~AlignmentCommand command} and adds\n * the `alignment` attribute for block elements in the {@link module:engine/model/model~Model model}.\n */\nclass AlignmentEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'AlignmentEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('alignment', {\n      options: supportedOptions.map(option => ({\n        name: option\n      }))\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const schema = editor.model.schema;\n    const options = normalizeAlignmentOptions(editor.config.get('alignment.options'));\n    // Filter out unsupported options and those that are redundant, e.g. `left` in LTR / `right` in RTL mode.\n    const optionsToConvert = options.filter(option => isSupported(option.name) && !isDefault(option.name, locale));\n    // Once there is at least one `className` defined, we switch to alignment with classes.\n    const shouldUseClasses = optionsToConvert.some(option => !!option.className);\n    // Allow alignment attribute on all blocks.\n    schema.extend('$block', {\n      allowAttributes: 'alignment'\n    });\n    editor.model.schema.setAttributeProperties('alignment', {\n      isFormatting: true\n    });\n    if (shouldUseClasses) {\n      editor.conversion.attributeToAttribute(buildClassDefinition(optionsToConvert));\n    } else {\n      // Downcast inline styles.\n      editor.conversion.for('downcast').attributeToAttribute(buildDowncastInlineDefinition(optionsToConvert));\n    }\n    const upcastInlineDefinitions = buildUpcastInlineDefinitions(optionsToConvert);\n    // Always upcast from inline styles.\n    for (const definition of upcastInlineDefinitions) {\n      editor.conversion.for('upcast').attributeToAttribute(definition);\n    }\n    const upcastCompatibilityDefinitions = buildUpcastCompatibilityDefinitions(optionsToConvert);\n    // Always upcast from deprecated `align` attribute.\n    for (const definition of upcastCompatibilityDefinitions) {\n      editor.conversion.for('upcast').attributeToAttribute(definition);\n    }\n    editor.commands.add('alignment', new AlignmentCommand(editor));\n  }\n}\n/**\n * Prepare downcast conversion definition for inline alignment styling.\n */\nfunction buildDowncastInlineDefinition(options) {\n  const view = {};\n  for (const {\n    name\n  } of options) {\n    view[name] = {\n      key: 'style',\n      value: {\n        'text-align': name\n      }\n    };\n  }\n  const definition = {\n    model: {\n      key: 'alignment',\n      values: options.map(option => option.name)\n    },\n    view\n  };\n  return definition;\n}\n/**\n * Prepare upcast definitions for inline alignment styles.\n */\nfunction buildUpcastInlineDefinitions(options) {\n  const definitions = [];\n  for (const {\n    name\n  } of options) {\n    definitions.push({\n      view: {\n        key: 'style',\n        value: {\n          'text-align': name\n        }\n      },\n      model: {\n        key: 'alignment',\n        value: name\n      }\n    });\n  }\n  return definitions;\n}\n/**\n * Prepare upcast definitions for deprecated `align` attribute.\n */\nfunction buildUpcastCompatibilityDefinitions(options) {\n  const definitions = [];\n  for (const {\n    name\n  } of options) {\n    definitions.push({\n      view: {\n        key: 'align',\n        value: name\n      },\n      model: {\n        key: 'alignment',\n        value: name\n      }\n    });\n  }\n  return definitions;\n}\n/**\n * Prepare conversion definitions for upcast and downcast alignment with classes.\n */\nfunction buildClassDefinition(options) {\n  const view = {};\n  for (const option of options) {\n    view[option.name] = {\n      key: 'class',\n      value: option.className\n    };\n  }\n  const definition = {\n    model: {\n      key: 'alignment',\n      values: options.map(option => option.name)\n    },\n    view\n  };\n  return definition;\n}\nconst iconsMap = /* #__PURE__ */(() => new Map([['left', IconAlignLeft], ['right', IconAlignRight], ['center', IconAlignCenter], ['justify', IconAlignJustify]]))();\n/**\n * The default alignment UI plugin.\n *\n * It introduces the `'alignment:left'`, `'alignment:right'`, `'alignment:center'` and `'alignment:justify'` buttons\n * and the `'alignment'` dropdown.\n */\nclass AlignmentUI extends Plugin {\n  /**\n  * Returns the localized option titles provided by the plugin.\n  *\n  * The following localized titles corresponding with\n  * {@link module:alignment/alignmentconfig~AlignmentConfig#options} are available:\n  *\n  * * `'left'`,\n  * * `'right'`,\n  * * `'center'`,\n  * * `'justify'`.\n  *\n  * @readonly\n  */\n  get localizedOptionTitles() {\n    const t = this.editor.t;\n    return {\n      'left': t('Align left'),\n      'right': t('Align right'),\n      'center': t('Align center'),\n      'justify': t('Justify')\n    };\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'AlignmentUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const options = normalizeAlignmentOptions(editor.config.get('alignment.options'));\n    options.map(option => option.name).filter(isSupported).forEach(option => this._addButton(option));\n    this._addToolbarDropdown(options);\n    this._addMenuBarMenu(options);\n  }\n  /**\n  * Helper method for initializing the button and linking it with an appropriate command.\n  *\n  * @param option The name of the alignment option for which the button is added.\n  */\n  _addButton(option) {\n    const editor = this.editor;\n    editor.ui.componentFactory.add(`alignment:${option}`, locale => this._createButton(locale, option));\n  }\n  /**\n  * Helper method for creating the button view element.\n  *\n  * @param locale Editor locale.\n  * @param option The name of the alignment option for which the button is added.\n  * @param buttonAttrs Optional parameters passed to button view instance.\n  */\n  _createButton(locale, option, buttonAttrs = {}) {\n    const editor = this.editor;\n    const command = editor.commands.get('alignment');\n    const buttonView = new ButtonView(locale);\n    buttonView.set({\n      label: this.localizedOptionTitles[option],\n      icon: iconsMap.get(option),\n      tooltip: true,\n      isToggleable: true,\n      ...buttonAttrs\n    });\n    // Bind button model to command.\n    buttonView.bind('isEnabled').to(command);\n    buttonView.bind('isOn').to(command, 'value', value => value === option);\n    // Execute command.\n    this.listenTo(buttonView, 'execute', () => {\n      editor.execute('alignment', {\n        value: option\n      });\n      editor.editing.view.focus();\n    });\n    return buttonView;\n  }\n  /**\n  * Helper method for initializing the toolnar dropdown and linking it with an appropriate command.\n  *\n  * @param option The name of the alignment option for which the button is added.\n  */\n  _addToolbarDropdown(options) {\n    const editor = this.editor;\n    const factory = editor.ui.componentFactory;\n    factory.add('alignment', locale => {\n      const dropdownView = createDropdown(locale);\n      const tooltipPosition = locale.uiLanguageDirection === 'rtl' ? 'w' : 'e';\n      const t = locale.t;\n      // Add existing alignment buttons to dropdown's toolbar.\n      addToolbarToDropdown(dropdownView, () => options.map(option => this._createButton(locale, option.name, {\n        tooltipPosition\n      })), {\n        enableActiveItemFocusOnDropdownOpen: true,\n        isVertical: true,\n        ariaLabel: t('Text alignment toolbar')\n      });\n      // Configure dropdown properties an behavior.\n      dropdownView.buttonView.set({\n        label: t('Text alignment'),\n        tooltip: true\n      });\n      dropdownView.extendTemplate({\n        attributes: {\n          class: 'ck-alignment-dropdown'\n        }\n      });\n      // The default icon depends on the direction of the content.\n      const defaultIcon = locale.contentLanguageDirection === 'rtl' ? iconsMap.get('right') : iconsMap.get('left');\n      const command = editor.commands.get('alignment');\n      // Change icon to reflect current selection's alignment.\n      dropdownView.buttonView.bind('icon').to(command, 'value', value => iconsMap.get(value) || defaultIcon);\n      // Enable button if any of the buttons is enabled.\n      dropdownView.bind('isEnabled').to(command, 'isEnabled');\n      // Focus the editable after executing the command.\n      // Overrides a default behaviour where the focus is moved to the dropdown button (#12125).\n      this.listenTo(dropdownView, 'execute', () => {\n        editor.editing.view.focus();\n      });\n      return dropdownView;\n    });\n  }\n  /**\n  * Creates a menu for all alignment options to use either in menu bar.\n  *\n  * @param options Normalized alignment options from config.\n  */\n  _addMenuBarMenu(options) {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('menuBar:alignment', locale => {\n      const command = editor.commands.get('alignment');\n      const t = locale.t;\n      const menuView = new MenuBarMenuView(locale);\n      const listView = new MenuBarMenuListView(locale);\n      menuView.bind('isEnabled').to(command);\n      listView.set({\n        ariaLabel: t('Text alignment'),\n        role: 'menu'\n      });\n      menuView.buttonView.set({\n        label: t('Text alignment')\n      });\n      for (const option of options) {\n        const listItemView = new MenuBarMenuListItemView(locale, menuView);\n        const buttonView = new MenuBarMenuListItemButtonView(locale);\n        buttonView.delegate('execute').to(menuView);\n        buttonView.set({\n          label: this.localizedOptionTitles[option.name],\n          icon: iconsMap.get(option.name),\n          role: 'menuitemcheckbox',\n          isToggleable: true\n        });\n        buttonView.on('execute', () => {\n          editor.execute('alignment', {\n            value: option.name\n          });\n          editor.editing.view.focus();\n        });\n        buttonView.bind('isOn').to(command, 'value', value => value === option.name);\n        buttonView.bind('isEnabled').to(command, 'isEnabled');\n        listItemView.children.add(buttonView);\n        listView.items.add(listItemView);\n      }\n      menuView.panelView.children.add(listView);\n      return menuView;\n    });\n  }\n}\n\n/**\n * The text alignment plugin.\n *\n * For a detailed overview, check the {@glink features/text-alignment Text alignment} feature guide\n * and the {@glink api/alignment package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:alignment/alignmentediting~AlignmentEditing} and\n * {@link module:alignment/alignmentui~AlignmentUI} plugins.\n */\nclass Alignment extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [AlignmentEditing, AlignmentUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Alignment';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { Alignment, AlignmentEditing, AlignmentUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Delete } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { LiveRange } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { first } from '@ckeditor/ckeditor5-utils/dist/index.js';\n\n/**\n * The block autoformatting engine. It allows to format various block patterns. For example,\n * it can be configured to turn a paragraph starting with `*` and followed by a space into a list item.\n *\n * The autoformatting operation is integrated with the undo manager,\n * so the autoformatting step can be undone if the user's intention was not to format the text.\n *\n * See the {@link module:autoformat/blockautoformatediting~blockAutoformatEditing `blockAutoformatEditing`} documentation\n * to learn how to create custom block autoformatters. You can also use\n * the {@link module:autoformat/autoformat~Autoformat} feature which enables a set of default autoformatters\n * (lists, headings, bold and italic).\n *\n * @module autoformat/blockautoformatediting\n */ /**\n    * Creates a listener triggered on {@link module:engine/model/document~Document#event:change:data `change:data`} event in the document.\n    * Calls the callback when inserted text matches the regular expression or the command name\n    * if provided instead of the callback.\n    *\n    * Examples of usage:\n    *\n    * To convert a paragraph into heading 1 when `- ` is typed, using just the command name:\n    *\n    * ```ts\n    * blockAutoformatEditing( editor, plugin, /^\\- $/, 'heading1' );\n    * ```\n    *\n    * To convert a paragraph into heading 1 when `- ` is typed, using just the callback:\n    *\n    * ```ts\n    * blockAutoformatEditing( editor, plugin, /^\\- $/, ( context ) => {\n    * \tconst { match } = context;\n    * \tconst headingLevel = match[ 1 ].length;\n    *\n    * \teditor.execute( 'heading', {\n    * \t\tformatId: `heading${ headingLevel }`\n    * \t} );\n    * } );\n    * ```\n    *\n    * @param editor The editor instance.\n    * @param plugin The autoformat plugin instance.\n    * @param pattern The regular expression to execute on just inserted text. The regular expression is tested against the text\n    * from the beginning until the caret position.\n    * @param callbackOrCommand The callback to execute or the command to run when the text is matched.\n    * In case of providing the callback, it receives the following parameter:\n    * * match RegExp.exec() result of matching the pattern to inserted text.\n    */\nfunction blockAutoformatEditing(editor, plugin, pattern, callbackOrCommand) {\n  let callback;\n  let command = null;\n  if (typeof callbackOrCommand == 'function') {\n    callback = callbackOrCommand;\n  } else {\n    // We assume that the actual command name was provided.\n    command = editor.commands.get(callbackOrCommand);\n    callback = () => {\n      editor.execute(callbackOrCommand);\n    };\n  }\n  editor.model.document.on('change:data', (evt, batch) => {\n    if (command && !command.isEnabled || !plugin.isEnabled) {\n      return;\n    }\n    const range = first(editor.model.document.selection.getRanges());\n    if (!range.isCollapsed) {\n      return;\n    }\n    if (batch.isUndo || !batch.isLocal) {\n      return;\n    }\n    const changes = Array.from(editor.model.document.differ.getChanges());\n    const entry = changes[0];\n    // Typing is represented by only a single change.\n    if (changes.length != 1 || entry.type !== 'insert' || entry.name != '$text' || entry.length != 1) {\n      return;\n    }\n    const blockToFormat = entry.position.parent;\n    // Block formatting should be disabled in codeBlocks (#5800).\n    if (blockToFormat.is('element', 'codeBlock')) {\n      return;\n    }\n    // Only list commands and custom callbacks can be applied inside a list.\n    if (blockToFormat.is('element', 'listItem') && typeof callbackOrCommand !== 'function' && !['numberedList', 'bulletedList', 'todoList'].includes(callbackOrCommand)) {\n      return;\n    }\n    // In case a command is bound, do not re-execute it over an existing block style which would result in a style removal.\n    // Instead, just drop processing so that autoformat trigger text is not lost. E.g. writing \"# \" in a level 1 heading.\n    if (command && command.value === true) {\n      return;\n    }\n    const firstNode = blockToFormat.getChild(0);\n    const firstNodeRange = editor.model.createRangeOn(firstNode);\n    // Range is only expected to be within or at the very end of the first text node.\n    if (!firstNodeRange.containsRange(range) && !range.end.isEqual(firstNodeRange.end)) {\n      return;\n    }\n    const match = pattern.exec(firstNode.data.substr(0, range.end.offset));\n    // ...and this text node's data match the pattern.\n    if (!match) {\n      return;\n    }\n    // Use enqueueChange to create new batch to separate typing batch from the auto-format changes.\n    editor.model.enqueueChange(writer => {\n      // Matched range.\n      const start = writer.createPositionAt(blockToFormat, 0);\n      const end = writer.createPositionAt(blockToFormat, match[0].length);\n      const range = new LiveRange(start, end);\n      const wasChanged = callback({\n        match\n      });\n      // Remove matched text.\n      if (wasChanged !== false) {\n        writer.remove(range);\n        const selectionRange = editor.model.document.selection.getFirstRange();\n        const blockRange = writer.createRangeIn(blockToFormat);\n        // If the block is empty and the document selection has been moved when\n        // applying formatting (e.g. is now in newly created block).\n        if (blockToFormat.isEmpty && !blockRange.isEqual(selectionRange) && !blockRange.containsRange(selectionRange, true)) {\n          writer.remove(blockToFormat);\n        }\n      }\n      range.detach();\n      editor.model.enqueueChange(() => {\n        const deletePlugin = editor.plugins.get('Delete');\n        deletePlugin.requestUndoOnBackspace();\n      });\n    });\n  });\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * The inline autoformatting engine. It allows to format various inline patterns. For example,\n    * it can be configured to make \"foo\" bold when typed `**foo**` (the `**` markers will be removed).\n    *\n    * The autoformatting operation is integrated with the undo manager,\n    * so the autoformatting step can be undone if the user's intention was not to format the text.\n    *\n    * See the {@link module:autoformat/inlineautoformatediting~inlineAutoformatEditing `inlineAutoformatEditing`} documentation\n    * to learn how to create custom inline autoformatters. You can also use\n    * the {@link module:autoformat/autoformat~Autoformat} feature which enables a set of default autoformatters\n    * (lists, headings, bold and italic).\n    *\n    * @module autoformat/inlineautoformatediting\n    */ /**\n       * Enables autoformatting mechanism for a given {@link module:core/editor/editor~Editor}.\n       *\n       * It formats the matched text by applying the given model attribute or by running the provided formatting callback.\n       * On every {@link module:engine/model/document~Document#event:change:data data change} in the model document\n       * the autoformatting engine checks the text on the left of the selection\n       * and executes the provided action if the text matches given criteria (regular expression or callback).\n       *\n       * @param editor The editor instance.\n       * @param plugin The autoformat plugin instance.\n       * @param testRegexpOrCallback The regular expression or callback to execute on text.\n       * Provided regular expression *must* have three capture groups. The first and the third capture group\n       * should match opening and closing delimiters. The second capture group should match the text to format.\n       *\n       * ```ts\n       * // Matches the `**bold text**` pattern.\n       * // There are three capturing groups:\n       * // - The first to match the starting `**` delimiter.\n       * // - The second to match the text to format.\n       * // - The third to match the ending `**` delimiter.\n       * inlineAutoformatEditing( editor, plugin, /(\\*\\*)([^\\*]+?)(\\*\\*)$/g, formatCallback );\n       * ```\n       *\n       * When a function is provided instead of the regular expression, it will be executed with the text to match as a parameter.\n       * The function should return proper \"ranges\" to delete and format.\n       *\n       * ```ts\n       * {\n       * \tremove: [\n       * \t\t[ 0, 1 ],\t// Remove the first letter from the given text.\n       * \t\t[ 5, 6 ]\t// Remove the 6th letter from the given text.\n       * \t],\n       * \tformat: [\n       * \t\t[ 1, 5 ]\t// Format all letters from 2nd to 5th.\n       * \t]\n       * }\n       * ```\n       *\n       * @param formatCallback A callback to apply actual formatting.\n       * It should return `false` if changes should not be applied (e.g. if a command is disabled).\n       *\n       * ```ts\n       * inlineAutoformatEditing( editor, plugin, /(\\*\\*)([^\\*]+?)(\\*\\*)$/g, ( writer, rangesToFormat ) => {\n       * \tconst command = editor.commands.get( 'bold' );\n       *\n       * \tif ( !command.isEnabled ) {\n       * \t\treturn false;\n       * \t}\n       *\n       * \tconst validRanges = editor.model.schema.getValidRanges( rangesToFormat, 'bold' );\n       *\n       * \tfor ( let range of validRanges ) {\n       * \t\twriter.setAttribute( 'bold', true, range );\n       * \t}\n       * } );\n       * ```\n       */\nfunction inlineAutoformatEditing(editor, plugin, testRegexpOrCallback, formatCallback) {\n  let regExp;\n  let testCallback;\n  if (testRegexpOrCallback instanceof RegExp) {\n    regExp = testRegexpOrCallback;\n  } else {\n    testCallback = testRegexpOrCallback;\n  }\n  // A test callback run on changed text.\n  testCallback = testCallback || (text => {\n    let result;\n    const remove = [];\n    const format = [];\n    while ((result = regExp.exec(text)) !== null) {\n      // There should be full match and 3 capture groups.\n      if (result && result.length < 4) {\n        break;\n      }\n      let {\n        index,\n        '1': leftDel,\n        '2': content,\n        '3': rightDel\n      } = result;\n      // Real matched string - there might be some non-capturing groups so we need to recalculate starting index.\n      const found = leftDel + content + rightDel;\n      index += result[0].length - found.length;\n      // Start and End offsets of delimiters to remove.\n      const delStart = [index, index + leftDel.length];\n      const delEnd = [index + leftDel.length + content.length, index + leftDel.length + content.length + rightDel.length];\n      remove.push(delStart);\n      remove.push(delEnd);\n      format.push([index + leftDel.length, index + leftDel.length + content.length]);\n    }\n    return {\n      remove,\n      format\n    };\n  });\n  editor.model.document.on('change:data', (evt, batch) => {\n    if (batch.isUndo || !batch.isLocal || !plugin.isEnabled) {\n      return;\n    }\n    const model = editor.model;\n    const selection = model.document.selection;\n    // Do nothing if selection is not collapsed.\n    if (!selection.isCollapsed) {\n      return;\n    }\n    const changes = Array.from(model.document.differ.getChanges());\n    const entry = changes[0];\n    // Typing is represented by only a single change.\n    if (changes.length != 1 || entry.type !== 'insert' || entry.name != '$text' || entry.length != 1) {\n      return;\n    }\n    const focus = selection.focus;\n    const block = focus.parent;\n    const {\n      text,\n      range\n    } = getTextAfterCode(model.createRange(model.createPositionAt(block, 0), focus), model);\n    const testOutput = testCallback(text);\n    const rangesToFormat = testOutputToRanges(range.start, testOutput.format, model);\n    const rangesToRemove = testOutputToRanges(range.start, testOutput.remove, model);\n    if (!(rangesToFormat.length && rangesToRemove.length)) {\n      return;\n    }\n    // Use enqueueChange to create new batch to separate typing batch from the auto-format changes.\n    model.enqueueChange(writer => {\n      // Apply format.\n      const hasChanged = formatCallback(writer, rangesToFormat);\n      // Strict check on `false` to have backward compatibility (when callbacks were returning `undefined`).\n      if (hasChanged === false) {\n        return;\n      }\n      // Remove delimiters - use reversed order to not mix the offsets while removing.\n      for (const range of rangesToRemove.reverse()) {\n        writer.remove(range);\n      }\n      model.enqueueChange(() => {\n        const deletePlugin = editor.plugins.get('Delete');\n        deletePlugin.requestUndoOnBackspace();\n      });\n    });\n  });\n}\n/**\n * Converts output of the test function provided to the inlineAutoformatEditing and converts it to the model ranges\n * inside provided block.\n */\nfunction testOutputToRanges(start, arrays, model) {\n  return arrays.filter(array => array[0] !== undefined && array[1] !== undefined).map(array => {\n    return model.createRange(start.getShiftedBy(array[0]), start.getShiftedBy(array[1]));\n  });\n}\n/**\n * Returns the last text line after the last code element from the given range.\n * It is similar to {@link module:typing/utils/getlasttextline.getLastTextLine `getLastTextLine()`},\n * but it ignores any text before the last `code`.\n */\nfunction getTextAfterCode(range, model) {\n  let start = range.start;\n  const text = Array.from(range.getItems()).reduce((rangeText, node) => {\n    // Trim text to a last occurrence of an inline element and update range start.\n    if (!(node.is('$text') || node.is('$textProxy')) || node.getAttribute('code')) {\n      start = model.createPositionAfter(node);\n      return '';\n    }\n    return rangeText + node.data;\n  }, '');\n  return {\n    text,\n    range: model.createRange(start, range.end)\n  };\n}\n\n/**\n * Enables a set of predefined autoformatting actions.\n *\n * For a detailed overview, check the {@glink features/autoformat Autoformatting} feature guide\n * and the {@glink api/autoformat package page}.\n */\nclass Autoformat extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Delete];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Autoformat';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    const t = this.editor.t;\n    this._addListAutoformats();\n    this._addBasicStylesAutoformats();\n    this._addHeadingAutoformats();\n    this._addBlockQuoteAutoformats();\n    this._addCodeBlockAutoformats();\n    this._addHorizontalLineAutoformats();\n    // Add the information about the keystroke to the accessibility database.\n    editor.accessibility.addKeystrokeInfos({\n      keystrokes: [{\n        label: t('Revert autoformatting action'),\n        keystroke: 'Backspace'\n      }]\n    });\n  }\n  /**\n  * Adds autoformatting related to the {@link module:list/list~List}.\n  *\n  * When typed:\n  * - `* ` or `- ` &ndash; A paragraph will be changed into a bulleted list.\n  * - `1. ` or `1) ` &ndash; A paragraph will be changed into a numbered list (\"1\" can be any digit or a list of digits).\n  * - `[] ` or `[ ] ` &ndash; A paragraph will be changed into a to-do list.\n  * - `[x] ` or `[ x ] ` &ndash; A paragraph will be changed into a checked to-do list.\n  */\n  _addListAutoformats() {\n    const commands = this.editor.commands;\n    if (commands.get('bulletedList')) {\n      blockAutoformatEditing(this.editor, this, /^[*-]\\s$/, 'bulletedList');\n    }\n    if (commands.get('numberedList')) {\n      blockAutoformatEditing(this.editor, this, /^1[.|)]\\s$/, 'numberedList');\n    }\n    if (commands.get('todoList')) {\n      blockAutoformatEditing(this.editor, this, /^\\[\\s?\\]\\s$/, 'todoList');\n    }\n    if (commands.get('checkTodoList')) {\n      blockAutoformatEditing(this.editor, this, /^\\[\\s?x\\s?\\]\\s$/, () => {\n        this.editor.execute('todoList');\n        this.editor.execute('checkTodoList');\n      });\n    }\n  }\n  /**\n  * Adds autoformatting related to the {@link module:basic-styles/bold~Bold},\n  * {@link module:basic-styles/italic~Italic}, {@link module:basic-styles/code~Code}\n  * and {@link module:basic-styles/strikethrough~Strikethrough}\n  *\n  * When typed:\n  * - `**foobar**` &ndash; `**` characters are removed and `foobar` is set to bold,\n  * - `__foobar__` &ndash; `__` characters are removed and `foobar` is set to bold,\n  * - `*foobar*` &ndash; `*` characters are removed and `foobar` is set to italic,\n  * - `_foobar_` &ndash; `_` characters are removed and `foobar` is set to italic,\n  * - ``` `foobar` &ndash; ``` ` ``` characters are removed and `foobar` is set to code,\n  * - `~~foobar~~` &ndash; `~~` characters are removed and `foobar` is set to strikethrough.\n  */\n  _addBasicStylesAutoformats() {\n    const commands = this.editor.commands;\n    if (commands.get('bold')) {\n      const boldCallback = getCallbackFunctionForInlineAutoformat(this.editor, 'bold');\n      inlineAutoformatEditing(this.editor, this, /(?:^|\\s)(\\*\\*)([^*]+)(\\*\\*)$/g, boldCallback);\n      inlineAutoformatEditing(this.editor, this, /(?:^|\\s)(__)([^_]+)(__)$/g, boldCallback);\n    }\n    if (commands.get('italic')) {\n      const italicCallback = getCallbackFunctionForInlineAutoformat(this.editor, 'italic');\n      // The italic autoformatter cannot be triggered by the bold markers, so we need to check the\n      // text before the pattern (e.g. `(?:^|[^\\*])`).\n      inlineAutoformatEditing(this.editor, this, /(?:^|\\s)(\\*)([^*_]+)(\\*)$/g, italicCallback);\n      inlineAutoformatEditing(this.editor, this, /(?:^|\\s)(_)([^_]+)(_)$/g, italicCallback);\n    }\n    if (commands.get('code')) {\n      const codeCallback = getCallbackFunctionForInlineAutoformat(this.editor, 'code');\n      inlineAutoformatEditing(this.editor, this, /(`)([^`]+)(`)$/g, codeCallback);\n    }\n    if (commands.get('strikethrough')) {\n      const strikethroughCallback = getCallbackFunctionForInlineAutoformat(this.editor, 'strikethrough');\n      inlineAutoformatEditing(this.editor, this, /(~~)([^~]+)(~~)$/g, strikethroughCallback);\n    }\n  }\n  /**\n  * Adds autoformatting related to {@link module:heading/heading~Heading}.\n  *\n  * It is using a number at the end of the command name to associate it with the proper trigger:\n  *\n  * * `heading` with a `heading1` value will be executed when typing `#`,\n  * * `heading` with a `heading2` value will be executed when typing `##`,\n  * * ... up to `heading6` for `######`.\n  */\n  _addHeadingAutoformats() {\n    const command = this.editor.commands.get('heading');\n    if (command) {\n      command.modelElements.filter(name => name.match(/^heading[1-6]$/)).forEach(modelName => {\n        const level = modelName[7];\n        const pattern = new RegExp(`^(#{${level}})\\\\s$`);\n        blockAutoformatEditing(this.editor, this, pattern, () => {\n          // Should only be active if command is enabled and heading style associated with pattern is inactive.\n          if (!command.isEnabled || command.value === modelName) {\n            return false;\n          }\n          this.editor.execute('heading', {\n            value: modelName\n          });\n        });\n      });\n    }\n  }\n  /**\n  * Adds autoformatting related to {@link module:block-quote/blockquote~BlockQuote}.\n  *\n  * When typed:\n  * * `> ` &ndash; A paragraph will be changed to a block quote.\n  */\n  _addBlockQuoteAutoformats() {\n    if (this.editor.commands.get('blockQuote')) {\n      blockAutoformatEditing(this.editor, this, /^>\\s$/, 'blockQuote');\n    }\n  }\n  /**\n  * Adds autoformatting related to {@link module:code-block/codeblock~CodeBlock}.\n  *\n  * When typed:\n  * - `` ``` `` &ndash; A paragraph will be changed to a code block.\n  */\n  _addCodeBlockAutoformats() {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    if (editor.commands.get('codeBlock')) {\n      blockAutoformatEditing(editor, this, /^```$/, () => {\n        if (selection.getFirstPosition().parent.is('element', 'listItem')) {\n          return false;\n        }\n        this.editor.execute('codeBlock', {\n          usePreviousLanguageChoice: true\n        });\n      });\n    }\n  }\n  /**\n  * Adds autoformatting related to {@link module:horizontal-line/horizontalline~HorizontalLine}.\n  *\n  * When typed:\n  * - `` --- `` &ndash; Will be replaced with a horizontal line.\n  */\n  _addHorizontalLineAutoformats() {\n    if (this.editor.commands.get('horizontalLine')) {\n      blockAutoformatEditing(this.editor, this, /^---$/, 'horizontalLine');\n    }\n  }\n}\n/**\n * Helper function for getting `inlineAutoformatEditing` callbacks that checks if command is enabled.\n */\nfunction getCallbackFunctionForInlineAutoformat(editor, attributeKey) {\n  return (writer, rangesToFormat) => {\n    const command = editor.commands.get(attributeKey);\n    if (!command.isEnabled) {\n      return false;\n    }\n    const validRanges = editor.model.schema.getValidRanges(rangesToFormat, attributeKey);\n    for (const range of validRanges) {\n      writer.setAttribute(attributeKey, true, range);\n    }\n    // After applying attribute to the text, remove given attribute from the selection.\n    // This way user is able to type a text without attribute used by auto formatter.\n    writer.removeSelectionAttribute(attributeKey);\n  };\n}\nexport { Autoformat, blockAutoformatEditing, inlineAutoformatEditing };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, PendingActions } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { DomEmitterMixin } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { debounce } from 'es-toolkit/compat';\n\n/* globals window */ /**\n                     * The {@link module:autosave/autosave~Autosave} plugin allows you to automatically save the data (e.g. send it to the server)\n                     * when needed (when the user changed the content).\n                     *\n                     * It listens to the {@link module:engine/model/document~Document#event:change:data `editor.model.document#change:data`}\n                     * and `window#beforeunload` events and calls the\n                     * {@link module:autosave/autosave~AutosaveAdapter#save `config.autosave.save()`} function.\n                     *\n                     * ```ts\n                     * ClassicEditor\n                     * \t.create( document.querySelector( '#editor' ), {\n                     * \t\tplugins: [ ArticlePluginSet, Autosave ],\n                     * \t\ttoolbar: [ 'heading', '|', 'bold', 'italic', 'link', 'bulletedList', 'numberedList', 'blockQuote', 'undo', 'redo' ],\n                     * \t\timage: {\n                     * \t\t\ttoolbar: [ 'imageStyle:block', 'imageStyle:side', '|', 'toggleImageCaption', 'imageTextAlternative' ],\n                     * \t\t},\n                     * \t\tautosave: {\n                     * \t\t\tsave( editor: Editor ) {\n                     * \t\t\t\t// The saveData() function must return a promise\n                     * \t\t\t\t// which should be resolved when the data is successfully saved.\n                     * \t\t\t\treturn saveData( editor.getData() );\n                     * \t\t\t}\n                     * \t\t}\n                     * \t} );\n                     * ```\n                     *\n                     * Read more about this feature in the {@glink features/autosave Autosave} feature guide.\n                     */\nclass Autosave extends Plugin {\n  /**\n  * The adapter is an object with a `save()` method. That method will be called whenever\n  * the data changes. It might be called some time after the change,\n  * since the event is throttled for performance reasons.\n  */\n  adapter;\n  /**\n  * Debounced save method. The `save()` method is called the specified `waitingTime` after `debouncedSave()` is called,\n  * unless a new action happens in the meantime.\n  */\n  _debouncedSave;\n  /**\n  * The last saved document version.\n  */\n  _lastDocumentVersion;\n  /**\n  * Promise used for asynchronous save calls.\n  *\n  * Created to handle the autosave call to an external data source. It resolves when that call is finished. It is re-used if\n  * save is called before the promise has been resolved. It is set to `null` if there is no call in progress.\n  */\n  _savePromise;\n  /**\n  * DOM emitter.\n  */\n  _domEmitter;\n  /**\n  * The configuration of this plugins.\n  */\n  _config;\n  /**\n  * Editor's pending actions manager.\n  */\n  _pendingActions;\n  /**\n  * Informs whether there should be another autosave callback performed, immediately after current autosave callback finishes.\n  *\n  * This is set to `true` when there is a save request while autosave callback is already being processed\n  * and the model has changed since the last save.\n  */\n  _makeImmediateSave;\n  /**\n  * An action that will be added to the pending action manager for actions happening in that plugin.\n  */\n  _action = null;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Autosave';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [PendingActions];\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    const config = editor.config.get('autosave') || {};\n    // A minimum amount of time that needs to pass after the last action.\n    // After that time the provided save callbacks are being called.\n    const waitingTime = config.waitingTime || 1000;\n    this.set('state', 'synchronized');\n    this._debouncedSave = debounce(this._save.bind(this), waitingTime);\n    this._lastDocumentVersion = editor.model.document.version;\n    this._savePromise = null;\n    this._domEmitter = new (DomEmitterMixin())();\n    this._config = config;\n    this._pendingActions = editor.plugins.get(PendingActions);\n    this._makeImmediateSave = false;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const doc = editor.model.document;\n    // Add the listener only after the editor is initialized to prevent firing save callback on data init.\n    this.listenTo(editor, 'ready', () => {\n      this.listenTo(doc, 'change:data', (evt, batch) => {\n        if (!this._saveCallbacks.length) {\n          return;\n        }\n        if (!batch.isLocal) {\n          return;\n        }\n        if (this.state === 'synchronized') {\n          this.state = 'waiting';\n          // Set pending action already when we are waiting for the autosave callback.\n          this._setPendingAction();\n        }\n        if (this.state === 'waiting') {\n          this._debouncedSave();\n        }\n        // If the plugin is in `saving` state, it will change its state later basing on the `document.version`.\n        // If the `document.version` will be higher than stored `#_lastDocumentVersion`, then it means, that some `change:data`\n        // event has fired in the meantime.\n      });\n    });\n    // Flush on the editor's destroy listener with the highest priority to ensure that\n    // `editor.getData()` will be called before plugins are destroyed.\n    this.listenTo(editor, 'destroy', () => this._flush(), {\n      priority: 'highest'\n    });\n    // It's not possible to easy test it because karma uses `beforeunload` event\n    // to warn before full page reload and this event cannot be dispatched manually.\n    /* istanbul ignore next -- @preserve */\n    this._domEmitter.listenTo(window, 'beforeunload', (evtInfo, domEvt) => {\n      if (this._pendingActions.hasAny) {\n        domEvt.returnValue = this._pendingActions.first.message;\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    // There's no need for canceling or flushing the throttled save, as\n    // it's done on the editor's destroy event with the highest priority.\n    this._domEmitter.stopListening();\n    super.destroy();\n  }\n  /**\n  * Immediately calls autosave callback. All previously queued (debounced) callbacks are cleared. If there is already an autosave\n  * callback in progress, then the requested save will be performed immediately after the current callback finishes.\n  *\n  * @returns A promise that will be resolved when the autosave callback is finished.\n  */\n  save() {\n    this._debouncedSave.cancel();\n    return this._save();\n  }\n  /**\n  * Invokes the remaining `_save()` method call.\n  */\n  _flush() {\n    this._debouncedSave.flush();\n  }\n  /**\n  * If the adapter is set and a new document version exists,\n  * the `_save()` method creates a pending action and calls the `adapter.save()` method.\n  * It waits for the result and then removes the created pending action.\n  *\n  * @returns A promise that will be resolved when the autosave callback is finished.\n  */\n  _save() {\n    if (this._savePromise) {\n      this._makeImmediateSave = this.editor.model.document.version > this._lastDocumentVersion;\n      return this._savePromise;\n    }\n    // Make sure there is a pending action (in case if `_save()` was called through manual `save()` call).\n    this._setPendingAction();\n    this.state = 'saving';\n    this._lastDocumentVersion = this.editor.model.document.version;\n    // Wait one promise cycle to be sure that save callbacks are not called inside a conversion or when the editor's state changes.\n    this._savePromise = Promise.resolve() // Make autosave callback.\n    .then(() => Promise.all(this._saveCallbacks.map(cb => cb(this.editor)))) // When the autosave callback is finished, always clear `this._savePromise`, no matter if it was successful or not.\n    .finally(() => {\n      this._savePromise = null;\n    }) // If the save was successful, we have three scenarios:\n    //\n    // 1. If a save was requested when an autosave callback was already processed, we need to immediately call\n    // another autosave callback. In this case, `this._savePromise` will not be resolved until the next callback is done.\n    // 2. Otherwise, if changes happened to the model, make a delayed autosave callback (like the change just happened).\n    // 3. If no changes happened to the model, return to the `synchronized` state.\n    .then(() => {\n      if (this._makeImmediateSave) {\n        this._makeImmediateSave = false;\n        // Start another autosave callback. Return a promise that will be resolved after the new autosave callback.\n        // This way promises returned by `_save()` will not be resolved until all changes are saved.\n        //\n        // If `save()` was called when another (most often automatic) autosave callback was already processed,\n        // the promise returned by `save()` call will be resolved only after new changes have been saved.\n        //\n        // Note that it would not work correctly if `this._savePromise` is not cleared.\n        return this._save();\n      } else {\n        if (this.editor.model.document.version > this._lastDocumentVersion) {\n          this.state = 'waiting';\n          this._debouncedSave();\n        } else {\n          this.state = 'synchronized';\n          this._pendingActions.remove(this._action);\n          this._action = null;\n        }\n      }\n    }) // In case of an error, retry the autosave callback after a delay (and also throw the original error).\n    .catch(err => {\n      // Change state to `error` so that listeners handling autosave error can be called.\n      this.state = 'error';\n      // Then, immediately change to the `saving` state as described above.\n      // Being in the `saving` state ensures that the autosave callback won't be delayed further by the `change:data` listener.\n      this.state = 'saving';\n      this._debouncedSave();\n      throw err;\n    });\n    return this._savePromise;\n  }\n  /**\n  * Creates a pending action if it is not set already.\n  */\n  _setPendingAction() {\n    const t = this.editor.t;\n    if (!this._action) {\n      this._action = this._pendingActions.add(t('Saving changes'));\n    }\n  }\n  /**\n  * Saves callbacks.\n  */\n  get _saveCallbacks() {\n    const saveCallbacks = [];\n    if (this.adapter && this.adapter.save) {\n      saveCallbacks.push(this.adapter.save);\n    }\n    if (this._config.save) {\n      saveCallbacks.push(this._config.save);\n    }\n    return saveCallbacks;\n  }\n}\nexport { Autosave };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { IconBold, IconCode, IconItalic, IconStrikethrough, IconSubscript, IconSuperscript, IconUnderline } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { MenuBarMenuListItemButtonView, ButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { TwoStepCaretMovement, inlineHighlight } from '@ckeditor/ckeditor5-typing/dist/index.js';\n\n/**\n * An extension of the base {@link module:core/command~Command} class, which provides utilities for a command\n * that toggles a single attribute on a text or an element.\n *\n * `AttributeCommand` uses {@link module:engine/model/document~Document#selection}\n * to decide which nodes (if any) should be changed, and applies or removes the attribute from them.\n *\n * The command checks the {@link module:engine/model/model~Model#schema} to decide if it can be enabled\n * for the current selection and to which nodes the attribute can be applied.\n */\nclass AttributeCommand extends Command {\n  /**\n  * The attribute that will be set by the command.\n  */\n  attributeKey;\n  /**\n  * @param attributeKey Attribute that will be set by the command.\n  */\n  constructor(editor, attributeKey) {\n    super(editor);\n    this.attributeKey = attributeKey;\n  }\n  /**\n  * Updates the command's {@link #value} and {@link #isEnabled} based on the current selection.\n  */\n  refresh() {\n    const model = this.editor.model;\n    const doc = model.document;\n    this.value = this._getValueFromFirstAllowedNode();\n    this.isEnabled = model.schema.checkAttributeInSelection(doc.selection, this.attributeKey);\n  }\n  /**\n  * Executes the command &ndash; applies the attribute to the selection or removes it from the selection.\n  *\n  * If the command is active (`value == true`), it will remove attributes. Otherwise, it will set attributes.\n  *\n  * The execution result differs, depending on the {@link module:engine/model/document~Document#selection}:\n  *\n  * * If the selection is on a range, the command applies the attribute to all nodes in that range\n  * (if they are allowed to have this attribute by the {@link module:engine/model/schema~Schema schema}).\n  * * If the selection is collapsed in a non-empty node, the command applies the attribute to the\n  * {@link module:engine/model/document~Document#selection} itself (note that typed characters copy attributes from the selection).\n  * * If the selection is collapsed in an empty node, the command applies the attribute to the parent node of the selection (note\n  * that the selection inherits all attributes from a node if it is in an empty node).\n  *\n  * @fires execute\n  * @param options Command options.\n  * @param options.forceValue If set, it will force the command behavior. If `true`,\n  * the command will apply the attribute, otherwise the command will remove the attribute.\n  * If not set, the command will look for its current value to decide what it should do.\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const doc = model.document;\n    const selection = doc.selection;\n    const value = options.forceValue === undefined ? !this.value : options.forceValue;\n    model.change(writer => {\n      if (selection.isCollapsed) {\n        if (value) {\n          writer.setSelectionAttribute(this.attributeKey, true);\n        } else {\n          writer.removeSelectionAttribute(this.attributeKey);\n        }\n      } else {\n        const ranges = model.schema.getValidRanges(selection.getRanges(), this.attributeKey);\n        for (const range of ranges) {\n          if (value) {\n            writer.setAttribute(this.attributeKey, value, range);\n          } else {\n            writer.removeAttribute(this.attributeKey, range);\n          }\n        }\n      }\n    });\n  }\n  /**\n  * Checks the attribute value of the first node in the selection that allows the attribute.\n  * For the collapsed selection returns the selection attribute.\n  *\n  * @returns The attribute value.\n  */\n  _getValueFromFirstAllowedNode() {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const selection = model.document.selection;\n    if (selection.isCollapsed) {\n      return selection.hasAttribute(this.attributeKey);\n    }\n    for (const range of selection.getRanges()) {\n      for (const item of range.getItems()) {\n        if (schema.checkAttribute(item, this.attributeKey)) {\n          return item.hasAttribute(this.attributeKey);\n        }\n      }\n    }\n    return false;\n  }\n}\nconst BOLD$1 = 'bold';\n/**\n * The bold editing feature.\n *\n * It registers the `'bold'` command and introduces the `bold` attribute in the model which renders to the view\n * as a `<strong>` element.\n */\nclass BoldEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'BoldEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = this.editor.t;\n    // Allow bold attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: BOLD$1\n    });\n    editor.model.schema.setAttributeProperties(BOLD$1, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n    // Build converter from model to view for data and editing pipelines.\n    editor.conversion.attributeToElement({\n      model: BOLD$1,\n      view: 'strong',\n      upcastAlso: ['b', viewElement => {\n        const fontWeight = viewElement.getStyle('font-weight');\n        if (!fontWeight) {\n          return null;\n        }\n        // Value of the `font-weight` attribute can be defined as a string or a number.\n        if (fontWeight == 'bold' || Number(fontWeight) >= 600) {\n          return {\n            name: true,\n            styles: ['font-weight']\n          };\n        }\n        return null;\n      }]\n    });\n    // Create bold command.\n    editor.commands.add(BOLD$1, new AttributeCommand(editor, BOLD$1));\n    // Set the Ctrl+B keystroke.\n    editor.keystrokes.set('CTRL+B', BOLD$1);\n    // Add the information about the keystroke to the accessibility database.\n    editor.accessibility.addKeystrokeInfos({\n      keystrokes: [{\n        label: t('Bold text'),\n        keystroke: 'CTRL+B'\n      }]\n    });\n  }\n}\n\n/**\n * Returns a function that creates a (toolbar or menu bar) button for a basic style feature.\n */\nfunction getButtonCreator({\n  editor,\n  commandName,\n  plugin,\n  icon,\n  label,\n  keystroke\n}) {\n  return ButtonClass => {\n    const command = editor.commands.get(commandName);\n    const view = new ButtonClass(editor.locale);\n    view.set({\n      label,\n      icon,\n      keystroke,\n      isToggleable: true\n    });\n    view.bind('isEnabled').to(command, 'isEnabled');\n    view.bind('isOn').to(command, 'value');\n    if (view instanceof MenuBarMenuListItemButtonView) {\n      view.set({\n        role: 'menuitemcheckbox'\n      });\n    } else {\n      view.set({\n        tooltip: true\n      });\n    }\n    // Execute the command.\n    plugin.listenTo(view, 'execute', () => {\n      editor.execute(commandName);\n      editor.editing.view.focus();\n    });\n    return view;\n  };\n}\nconst BOLD = 'bold';\n/**\n * The bold UI feature. It introduces the Bold button.\n */\nclass BoldUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'BoldUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const createButton = getButtonCreator({\n      editor,\n      commandName: BOLD,\n      plugin: this,\n      icon: IconBold,\n      label: t('Bold'),\n      keystroke: 'CTRL+B'\n    });\n    // Add bold button to feature components.\n    editor.ui.componentFactory.add(BOLD, () => createButton(ButtonView));\n    editor.ui.componentFactory.add('menuBar:' + BOLD, () => createButton(MenuBarMenuListItemButtonView));\n  }\n}\n\n/**\n * The bold feature.\n *\n * For a detailed overview check the {@glink features/basic-styles Basic styles feature} guide\n * and the {@glink api/basic-styles package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:basic-styles/bold/boldediting~BoldEditing bold editing feature}\n * and {@link module:basic-styles/bold/boldui~BoldUI bold UI feature}.\n */\nclass Bold extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [BoldEditing, BoldUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Bold';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nconst CODE$1 = 'code';\nconst HIGHLIGHT_CLASS = 'ck-code_selected';\n/**\n * The code editing feature.\n *\n * It registers the `'code'` command and introduces the `code` attribute in the model which renders to the view\n * as a `<code>` element.\n */\nclass CodeEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CodeEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TwoStepCaretMovement];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = this.editor.t;\n    // Allow code attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: CODE$1\n    });\n    editor.model.schema.setAttributeProperties(CODE$1, {\n      isFormatting: true,\n      copyOnEnter: false\n    });\n    editor.conversion.attributeToElement({\n      model: CODE$1,\n      view: 'code'\n    });\n    // Create code command.\n    editor.commands.add(CODE$1, new AttributeCommand(editor, CODE$1));\n    // Enable two-step caret movement for `code` attribute.\n    editor.plugins.get(TwoStepCaretMovement).registerAttribute(CODE$1);\n    // Setup highlight over selected element.\n    inlineHighlight(editor, CODE$1, 'code', HIGHLIGHT_CLASS);\n    // Add the information about the keystroke to the accessibility database.\n    editor.accessibility.addKeystrokeInfos({\n      keystrokes: [{\n        label: t('Move out of an inline code style'),\n        keystroke: [['arrowleft', 'arrowleft'], ['arrowright', 'arrowright']]\n      }]\n    });\n  }\n}\nconst CODE = 'code';\n/**\n * The code UI feature. It introduces the Code button.\n */\nclass CodeUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CodeUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const createButton = getButtonCreator({\n      editor,\n      commandName: CODE,\n      plugin: this,\n      icon: IconCode,\n      label: t('Code')\n    });\n    // Add code button to feature components.\n    editor.ui.componentFactory.add(CODE, () => createButton(ButtonView));\n    editor.ui.componentFactory.add('menuBar:' + CODE, () => createButton(MenuBarMenuListItemButtonView));\n  }\n}\n\n/**\n * The code feature.\n *\n * For a detailed overview check the {@glink features/basic-styles Basic styles feature} guide\n * and the {@glink api/basic-styles package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:basic-styles/code/codeediting~CodeEditing code editing feature}\n * and {@link module:basic-styles/code/codeui~CodeUI code UI feature}.\n */\nclass Code extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [CodeEditing, CodeUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Code';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nconst ITALIC$1 = 'italic';\n/**\n * The italic editing feature.\n *\n * It registers the `'italic'` command, the <kbd>Ctrl+I</kbd> keystroke and introduces the `italic` attribute in the model\n * which renders to the view as an `<i>` element.\n */\nclass ItalicEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ItalicEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = this.editor.t;\n    // Allow italic attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: ITALIC$1\n    });\n    editor.model.schema.setAttributeProperties(ITALIC$1, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n    editor.conversion.attributeToElement({\n      model: ITALIC$1,\n      view: 'i',\n      upcastAlso: ['em', {\n        styles: {\n          'font-style': 'italic'\n        }\n      }]\n    });\n    // Create italic command.\n    editor.commands.add(ITALIC$1, new AttributeCommand(editor, ITALIC$1));\n    // Set the Ctrl+I keystroke.\n    editor.keystrokes.set('CTRL+I', ITALIC$1);\n    // Add the information about the keystroke to the accessibility database.\n    editor.accessibility.addKeystrokeInfos({\n      keystrokes: [{\n        label: t('Italic text'),\n        keystroke: 'CTRL+I'\n      }]\n    });\n  }\n}\nconst ITALIC = 'italic';\n/**\n * The italic UI feature. It introduces the Italic button.\n */\nclass ItalicUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ItalicUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const createButton = getButtonCreator({\n      editor,\n      commandName: ITALIC,\n      plugin: this,\n      icon: IconItalic,\n      keystroke: 'CTRL+I',\n      label: t('Italic')\n    });\n    // Add bold button to feature components.\n    editor.ui.componentFactory.add(ITALIC, () => createButton(ButtonView));\n    editor.ui.componentFactory.add('menuBar:' + ITALIC, () => createButton(MenuBarMenuListItemButtonView));\n  }\n}\n\n/**\n * The italic feature.\n *\n * For a detailed overview check the {@glink features/basic-styles Basic styles feature} guide\n * and the {@glink api/basic-styles package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:basic-styles/italic/italicediting~ItalicEditing} and\n * {@link module:basic-styles/italic/italicui~ItalicUI} plugins.\n */\nclass Italic extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ItalicEditing, ItalicUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Italic';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nconst STRIKETHROUGH$1 = 'strikethrough';\n/**\n * The strikethrough editing feature.\n *\n * It registers the `'strikethrough'` command, the <kbd>Ctrl+Shift+X</kbd> keystroke and introduces the\n * `strikethroughsthrough` attribute in the model which renders to the view\n * as a `<s>` element.\n */\nclass StrikethroughEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'StrikethroughEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = this.editor.t;\n    // Allow strikethrough attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: STRIKETHROUGH$1\n    });\n    editor.model.schema.setAttributeProperties(STRIKETHROUGH$1, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n    editor.conversion.attributeToElement({\n      model: STRIKETHROUGH$1,\n      view: 's',\n      upcastAlso: ['del', 'strike', {\n        styles: {\n          'text-decoration': 'line-through'\n        }\n      }]\n    });\n    // Create strikethrough command.\n    editor.commands.add(STRIKETHROUGH$1, new AttributeCommand(editor, STRIKETHROUGH$1));\n    // Set the Ctrl+Shift+X keystroke.\n    editor.keystrokes.set('CTRL+SHIFT+X', 'strikethrough');\n    // Add the information about the keystroke to the accessibility database.\n    editor.accessibility.addKeystrokeInfos({\n      keystrokes: [{\n        label: t('Strikethrough text'),\n        keystroke: 'CTRL+SHIFT+X'\n      }]\n    });\n  }\n}\nconst STRIKETHROUGH = 'strikethrough';\n/**\n * The strikethrough UI feature. It introduces the Strikethrough button.\n */\nclass StrikethroughUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'StrikethroughUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const createButton = getButtonCreator({\n      editor,\n      commandName: STRIKETHROUGH,\n      plugin: this,\n      icon: IconStrikethrough,\n      keystroke: 'CTRL+SHIFT+X',\n      label: t('Strikethrough')\n    });\n    // Add strikethrough button to feature components.\n    editor.ui.componentFactory.add(STRIKETHROUGH, () => createButton(ButtonView));\n    editor.ui.componentFactory.add('menuBar:' + STRIKETHROUGH, () => createButton(MenuBarMenuListItemButtonView));\n  }\n}\n\n/**\n * The strikethrough feature.\n *\n * For a detailed overview check the {@glink features/basic-styles Basic styles feature} guide\n * and the {@glink api/basic-styles package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:basic-styles/strikethrough/strikethroughediting~StrikethroughEditing} and\n * {@link module:basic-styles/strikethrough/strikethroughui~StrikethroughUI} plugins.\n */\nclass Strikethrough extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [StrikethroughEditing, StrikethroughUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Strikethrough';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nconst SUBSCRIPT$1 = 'subscript';\n/**\n * The subscript editing feature.\n *\n * It registers the `sub` command and introduces the `sub` attribute in the model which renders to the view\n * as a `<sub>` element.\n */\nclass SubscriptEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SubscriptEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Allow sub attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: SUBSCRIPT$1\n    });\n    editor.model.schema.setAttributeProperties(SUBSCRIPT$1, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n    // Build converter from model to view for data and editing pipelines.\n    editor.conversion.attributeToElement({\n      model: SUBSCRIPT$1,\n      view: 'sub',\n      upcastAlso: [{\n        styles: {\n          'vertical-align': 'sub'\n        }\n      }]\n    });\n    // Create sub command.\n    editor.commands.add(SUBSCRIPT$1, new AttributeCommand(editor, SUBSCRIPT$1));\n  }\n}\nconst SUBSCRIPT = 'subscript';\n/**\n * The subscript UI feature. It introduces the Subscript button.\n */\nclass SubscriptUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SubscriptUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const createButton = getButtonCreator({\n      editor,\n      commandName: SUBSCRIPT,\n      plugin: this,\n      icon: IconSubscript,\n      label: t('Subscript')\n    });\n    // Add subscript button to feature components.\n    editor.ui.componentFactory.add(SUBSCRIPT, () => createButton(ButtonView));\n    editor.ui.componentFactory.add('menuBar:' + SUBSCRIPT, () => createButton(MenuBarMenuListItemButtonView));\n  }\n}\n\n/**\n * The subscript feature.\n *\n * It loads the {@link module:basic-styles/subscript/subscriptediting~SubscriptEditing} and\n * {@link module:basic-styles/subscript/subscriptui~SubscriptUI} plugins.\n */\nclass Subscript extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [SubscriptEditing, SubscriptUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Subscript';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nconst SUPERSCRIPT$1 = 'superscript';\n/**\n * The superscript editing feature.\n *\n * It registers the `super` command and introduces the `super` attribute in the model which renders to the view\n * as a `<super>` element.\n */\nclass SuperscriptEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SuperscriptEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Allow super attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: SUPERSCRIPT$1\n    });\n    editor.model.schema.setAttributeProperties(SUPERSCRIPT$1, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n    // Build converter from model to view for data and editing pipelines.\n    editor.conversion.attributeToElement({\n      model: SUPERSCRIPT$1,\n      view: 'sup',\n      upcastAlso: [{\n        styles: {\n          'vertical-align': 'super'\n        }\n      }]\n    });\n    // Create super command.\n    editor.commands.add(SUPERSCRIPT$1, new AttributeCommand(editor, SUPERSCRIPT$1));\n  }\n}\nconst SUPERSCRIPT = 'superscript';\n/**\n * The superscript UI feature. It introduces the Superscript button.\n */\nclass SuperscriptUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SuperscriptUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const createButton = getButtonCreator({\n      editor,\n      commandName: SUPERSCRIPT,\n      plugin: this,\n      icon: IconSuperscript,\n      label: t('Superscript')\n    });\n    // Add superscript button to feature components.\n    editor.ui.componentFactory.add(SUPERSCRIPT, () => createButton(ButtonView));\n    editor.ui.componentFactory.add('menuBar:' + SUPERSCRIPT, () => createButton(MenuBarMenuListItemButtonView));\n  }\n}\n\n/**\n * The superscript feature.\n *\n * It loads the {@link module:basic-styles/superscript/superscriptediting~SuperscriptEditing} and\n * {@link module:basic-styles/superscript/superscriptui~SuperscriptUI} plugins.\n */\nclass Superscript extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [SuperscriptEditing, SuperscriptUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Superscript';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nconst UNDERLINE$1 = 'underline';\n/**\n * The underline editing feature.\n *\n * It registers the `'underline'` command, the <kbd>Ctrl+U</kbd> keystroke\n * and introduces the `underline` attribute in the model which renders to the view as an `<u>` element.\n */\nclass UnderlineEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'UnderlineEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = this.editor.t;\n    // Allow strikethrough attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: UNDERLINE$1\n    });\n    editor.model.schema.setAttributeProperties(UNDERLINE$1, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n    editor.conversion.attributeToElement({\n      model: UNDERLINE$1,\n      view: 'u',\n      upcastAlso: {\n        styles: {\n          'text-decoration': 'underline'\n        }\n      }\n    });\n    // Create underline command.\n    editor.commands.add(UNDERLINE$1, new AttributeCommand(editor, UNDERLINE$1));\n    // Set the Ctrl+U keystroke.\n    editor.keystrokes.set('CTRL+U', 'underline');\n    // Add the information about the keystroke to the accessibility database.\n    editor.accessibility.addKeystrokeInfos({\n      keystrokes: [{\n        label: t('Underline text'),\n        keystroke: 'CTRL+U'\n      }]\n    });\n  }\n}\nconst UNDERLINE = 'underline';\n/**\n * The underline UI feature. It introduces the Underline button.\n */\nclass UnderlineUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'UnderlineUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const createButton = getButtonCreator({\n      editor,\n      commandName: UNDERLINE,\n      plugin: this,\n      icon: IconUnderline,\n      label: t('Underline'),\n      keystroke: 'CTRL+U'\n    });\n    // Add bold button to feature components.\n    editor.ui.componentFactory.add(UNDERLINE, () => createButton(ButtonView));\n    editor.ui.componentFactory.add('menuBar:' + UNDERLINE, () => createButton(MenuBarMenuListItemButtonView));\n  }\n}\n\n/**\n * The underline feature.\n *\n * For a detailed overview check the {@glink features/basic-styles Basic styles feature} guide\n * and the {@glink api/basic-styles package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:basic-styles/underline/underlineediting~UnderlineEditing} and\n * {@link module:basic-styles/underline/underlineui~UnderlineUI} plugins.\n */\nclass Underline extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [UnderlineEditing, UnderlineUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Underline';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { AttributeCommand, Bold, BoldEditing, BoldUI, Code, CodeEditing, CodeUI, Italic, ItalicEditing, ItalicUI, Strikethrough, StrikethroughEditing, StrikethroughUI, Subscript, SubscriptEditing, SubscriptUI, Superscript, SuperscriptEditing, SuperscriptUI, Underline, UnderlineEditing, UnderlineUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Enter } from '@ckeditor/ckeditor5-enter/dist/index.js';\nimport { Delete } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { first } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { IconQuote } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\n\n/**\n * The block quote command plugin.\n *\n * @extends module:core/command~Command\n */\nclass BlockQuoteCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.value = this._getValue();\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Executes the command. When the command {@link #value is on}, all top-most block quotes within\n  * the selection will be removed. If it is off, all selected blocks will be wrapped with\n  * a block quote.\n  *\n  * @fires execute\n  * @param options Command options.\n  * @param options.forceValue If set, it will force the command behavior. If `true`, the command will apply a block quote,\n  * otherwise the command will remove the block quote. If not set, the command will act basing on its current value.\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const selection = model.document.selection;\n    const blocks = Array.from(selection.getSelectedBlocks());\n    const value = options.forceValue === undefined ? !this.value : options.forceValue;\n    model.change(writer => {\n      if (!value) {\n        this._removeQuote(writer, blocks.filter(findQuote));\n      } else {\n        const blocksToQuote = blocks.filter(block => {\n          // Already quoted blocks needs to be considered while quoting too\n          // in order to reuse their <bQ> elements.\n          return findQuote(block) || checkCanBeQuoted(schema, block);\n        });\n        this._applyQuote(writer, blocksToQuote);\n      }\n    });\n  }\n  /**\n  * Checks the command's {@link #value}.\n  */\n  _getValue() {\n    const selection = this.editor.model.document.selection;\n    const firstBlock = first(selection.getSelectedBlocks());\n    // In the current implementation, the block quote must be an immediate parent of a block element.\n    return !!(firstBlock && findQuote(firstBlock));\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    if (this.value) {\n      return true;\n    }\n    const selection = this.editor.model.document.selection;\n    const schema = this.editor.model.schema;\n    const firstBlock = first(selection.getSelectedBlocks());\n    if (!firstBlock) {\n      return false;\n    }\n    return checkCanBeQuoted(schema, firstBlock);\n  }\n  /**\n  * Removes the quote from given blocks.\n  *\n  * If blocks which are supposed to be \"unquoted\" are in the middle of a quote,\n  * start it or end it, then the quote will be split (if needed) and the blocks\n  * will be moved out of it, so other quoted blocks remained quoted.\n  */\n  _removeQuote(writer, blocks) {\n    // Unquote all groups of block. Iterate in the reverse order to not break following ranges.\n    getRangesOfBlockGroups(writer, blocks).reverse().forEach(groupRange => {\n      if (groupRange.start.isAtStart && groupRange.end.isAtEnd) {\n        writer.unwrap(groupRange.start.parent);\n        return;\n      }\n      // The group of blocks are at the beginning of an <bQ> so let's move them left (out of the <bQ>).\n      if (groupRange.start.isAtStart) {\n        const positionBefore = writer.createPositionBefore(groupRange.start.parent);\n        writer.move(groupRange, positionBefore);\n        return;\n      }\n      // The blocks are in the middle of an <bQ> so we need to split the <bQ> after the last block\n      // so we move the items there.\n      if (!groupRange.end.isAtEnd) {\n        writer.split(groupRange.end);\n      }\n      // Now we are sure that groupRange.end.isAtEnd is true, so let's move the blocks right.\n      const positionAfter = writer.createPositionAfter(groupRange.end.parent);\n      writer.move(groupRange, positionAfter);\n    });\n  }\n  /**\n  * Applies the quote to given blocks.\n  */\n  _applyQuote(writer, blocks) {\n    const quotesToMerge = [];\n    // Quote all groups of block. Iterate in the reverse order to not break following ranges.\n    getRangesOfBlockGroups(writer, blocks).reverse().forEach(groupRange => {\n      let quote = findQuote(groupRange.start);\n      if (!quote) {\n        quote = writer.createElement('blockQuote');\n        writer.wrap(groupRange, quote);\n      }\n      quotesToMerge.push(quote);\n    });\n    // Merge subsequent <bQ> elements. Reverse the order again because this time we want to go through\n    // the <bQ> elements in the source order (due to how merge works â€“ it moves the right element's content\n    // to the first element and removes the right one. Since we may need to merge a couple of subsequent `<bQ>` elements\n    // we want to keep the reference to the first (furthest left) one.\n    quotesToMerge.reverse().reduce((currentQuote, nextQuote) => {\n      if (currentQuote.nextSibling == nextQuote) {\n        writer.merge(writer.createPositionAfter(currentQuote));\n        return currentQuote;\n      }\n      return nextQuote;\n    });\n  }\n}\nfunction findQuote(elementOrPosition) {\n  return elementOrPosition.parent.name == 'blockQuote' ? elementOrPosition.parent : null;\n}\n/**\n * Returns a minimal array of ranges containing groups of subsequent blocks.\n *\n * content:         abcdefgh\n * blocks:          [ a, b, d, f, g, h ]\n * output ranges:   [ab]c[d]e[fgh]\n */\nfunction getRangesOfBlockGroups(writer, blocks) {\n  let startPosition;\n  let i = 0;\n  const ranges = [];\n  while (i < blocks.length) {\n    const block = blocks[i];\n    const nextBlock = blocks[i + 1];\n    if (!startPosition) {\n      startPosition = writer.createPositionBefore(block);\n    }\n    if (!nextBlock || block.nextSibling != nextBlock) {\n      ranges.push(writer.createRange(startPosition, writer.createPositionAfter(block)));\n      startPosition = null;\n    }\n    i++;\n  }\n  return ranges;\n}\n/**\n * Checks whether <bQ> can wrap the block.\n */\nfunction checkCanBeQuoted(schema, block) {\n  // TMP will be replaced with schema.checkWrap().\n  const isBQAllowed = schema.checkChild(block.parent, 'blockQuote');\n  const isBlockAllowedInBQ = schema.checkChild(['$root', 'blockQuote'], block);\n  return isBQAllowed && isBlockAllowedInBQ;\n}\n\n/**\n * The block quote editing.\n *\n * Introduces the `'blockQuote'` command and the `'blockQuote'` model element.\n *\n * @extends module:core/plugin~Plugin\n */\nclass BlockQuoteEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'BlockQuoteEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Enter, Delete];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    editor.commands.add('blockQuote', new BlockQuoteCommand(editor));\n    schema.register('blockQuote', {\n      inheritAllFrom: '$container'\n    });\n    editor.conversion.elementToElement({\n      model: 'blockQuote',\n      view: 'blockquote'\n    });\n    // Postfixer which cleans incorrect model states connected with block quotes.\n    editor.model.document.registerPostFixer(writer => {\n      const changes = editor.model.document.differ.getChanges();\n      for (const entry of changes) {\n        if (entry.type == 'insert') {\n          const element = entry.position.nodeAfter;\n          if (!element) {\n            continue;\n          }\n          if (element.is('element', 'blockQuote') && element.isEmpty) {\n            // Added an empty blockQuote - remove it.\n            writer.remove(element);\n            return true;\n          } else if (element.is('element', 'blockQuote') && !schema.checkChild(entry.position, element)) {\n            // Added a blockQuote in incorrect place. Unwrap it so the content inside is not lost.\n            writer.unwrap(element);\n            return true;\n          } else if (element.is('element')) {\n            // Just added an element. Check that all children meet the scheme rules.\n            const range = writer.createRangeIn(element);\n            for (const child of range.getItems()) {\n              if (child.is('element', 'blockQuote') && !schema.checkChild(writer.createPositionBefore(child), child)) {\n                writer.unwrap(child);\n                return true;\n              }\n            }\n          }\n        } else if (entry.type == 'remove') {\n          const parent = entry.position.parent;\n          if (parent.is('element', 'blockQuote') && parent.isEmpty) {\n            // Something got removed and now blockQuote is empty. Remove the blockQuote as well.\n            writer.remove(parent);\n            return true;\n          }\n        }\n      }\n      return false;\n    });\n    const viewDocument = this.editor.editing.view.document;\n    const selection = editor.model.document.selection;\n    const blockQuoteCommand = editor.commands.get('blockQuote');\n    // Overwrite default Enter key behavior.\n    // If Enter key is pressed with selection collapsed in empty block inside a quote, break the quote.\n    this.listenTo(viewDocument, 'enter', (evt, data) => {\n      if (!selection.isCollapsed || !blockQuoteCommand.value) {\n        return;\n      }\n      const positionParent = selection.getLastPosition().parent;\n      if (positionParent.isEmpty) {\n        editor.execute('blockQuote');\n        editor.editing.view.scrollToTheSelection();\n        data.preventDefault();\n        evt.stop();\n      }\n    }, {\n      context: 'blockquote'\n    });\n    // Overwrite default Backspace key behavior.\n    // If Backspace key is pressed with selection collapsed in first empty block inside a quote, break the quote.\n    this.listenTo(viewDocument, 'delete', (evt, data) => {\n      if (data.direction != 'backward' || !selection.isCollapsed || !blockQuoteCommand.value) {\n        return;\n      }\n      const positionParent = selection.getLastPosition().parent;\n      if (positionParent.isEmpty && !positionParent.previousSibling) {\n        editor.execute('blockQuote');\n        editor.editing.view.scrollToTheSelection();\n        data.preventDefault();\n        evt.stop();\n      }\n    }, {\n      context: 'blockquote'\n    });\n  }\n}\n\n/**\n * The block quote UI plugin.\n *\n * It introduces the `'blockQuote'` button.\n *\n * @extends module:core/plugin~Plugin\n */\nclass BlockQuoteUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'BlockQuoteUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('blockQuote', () => {\n      const buttonView = this._createButton(ButtonView);\n      buttonView.set({\n        tooltip: true\n      });\n      return buttonView;\n    });\n    editor.ui.componentFactory.add('menuBar:blockQuote', () => {\n      const buttonView = this._createButton(MenuBarMenuListItemButtonView);\n      buttonView.set({\n        role: 'menuitemcheckbox'\n      });\n      return buttonView;\n    });\n  }\n  /**\n  * Creates a button for block quote command to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const command = editor.commands.get('blockQuote');\n    const view = new ButtonClass(editor.locale);\n    const t = locale.t;\n    view.set({\n      label: t('Block quote'),\n      icon: IconQuote,\n      isToggleable: true\n    });\n    view.bind('isEnabled').to(command, 'isEnabled');\n    view.bind('isOn').to(command, 'value');\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.execute('blockQuote');\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n}\n\n/**\n * The block quote plugin.\n *\n * For more information about this feature check the {@glink api/block-quote package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:block-quote/blockquoteediting~BlockQuoteEditing block quote editing feature}\n * and {@link module:block-quote/blockquoteui~BlockQuoteUI block quote UI feature}.\n *\n * @extends module:core/plugin~Plugin\n */\nclass BlockQuote extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [BlockQuoteEditing, BlockQuoteUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'BlockQuote';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { BlockQuote, BlockQuoteEditing, BlockQuoteUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { toWidget, WidgetToolbarRepository, isWidget, Widget } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { View, ViewCollection, FormRowView, FocusCycler, submitHandler, ButtonView, FormHeaderView, LabeledFieldView, createLabeledInputText, IconView, ContextualBalloon, BalloonPanelView, CssTransitionDisablerMixin, MenuBarMenuListItemButtonView, LabelView, clickOutsideHandler } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconBookmarkInline, IconPencil, IconRemove, IconBookmark, IconBookmarkMedium, IconBookmarkSmall } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { FocusTracker, KeystrokeHandler, logWarning } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { IconPreviousArrow } from '@ckeditor/ckeditor5-icons/dist/index.js';\n\n/**\n * The bookmark form view controller class.\n *\n * See {@link module:bookmark/ui/bookmarkformview~BookmarkFormView}.\n */\nclass BookmarkFormView extends View {\n  /**\n  * Tracks information about DOM focus in the form.\n  */\n  focusTracker = new FocusTracker();\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes = new KeystrokeHandler();\n  /**\n  * The ID input view.\n  */\n  idInputView;\n  /**\n  * The Back button view displayed in the header.\n  */\n  backButtonView;\n  /**\n  * A button used to submit the form.\n  */\n  saveButtonView;\n  /**\n  * A collection of form child views in the form.\n  */\n  children;\n  /**\n  * An array of form validators used by {@link #isValid}.\n  */\n  _validators;\n  /**\n  * A collection of views that can be focused in the form.\n  */\n  _focusables = new ViewCollection();\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * Creates an instance of the {@link module:bookmark/ui/bookmarkformview~BookmarkFormView} class.\n  *\n  * Also see {@link #render}.\n  *\n  * @param locale The localization services instance.\n  * @param validators  Form validators used by {@link #isValid}.\n  */\n  constructor(locale, validators) {\n    super(locale);\n    this._validators = validators;\n    // Create buttons.\n    this.backButtonView = this._createBackButton();\n    this.saveButtonView = this._createSaveButton();\n    // Create input fields.\n    this.idInputView = this._createIdInput();\n    this.children = this.createCollection([this._createHeaderView()]);\n    this.children.add(new FormRowView(locale, {\n      children: [this.idInputView, this.saveButtonView],\n      class: ['ck-form__row_with-submit', 'ck-form__row_large-top-padding']\n    }));\n    // Close the panel on esc key press when the **form has focus**.\n    this.keystrokes.set('Esc', (data, cancel) => {\n      this.fire('cancel');\n      cancel();\n    });\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-form', 'ck-bookmark-form', 'ck-responsive-form'],\n        // https://github.com/ckeditor/ckeditor5-link/issues/90\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    submitHandler({\n      view: this\n    });\n    const childViews = [this.backButtonView, this.idInputView, this.saveButtonView];\n    childViews.forEach(v => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n    });\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the fist {@link #_focusables} in the form.\n  */\n  focus() {\n    this.idInputView.focus();\n  }\n  /**\n  * Validates the form and returns `false` when some fields are invalid.\n  */\n  isValid() {\n    this.resetFormStatus();\n    for (const validator of this._validators) {\n      const errorText = validator(this);\n      // One error per field is enough.\n      if (errorText) {\n        // Apply updated error.\n        this.idInputView.errorText = errorText;\n        return false;\n      }\n    }\n    return true;\n  }\n  /**\n  * Cleans up the supplementary error and information text of the {@link #idInputView}\n  * bringing them back to the state when the form has been displayed for the first time.\n  *\n  * See {@link #isValid}.\n  */\n  resetFormStatus() {\n    this.idInputView.errorText = null;\n  }\n  /**\n  * Creates a back button view that cancels the form.\n  */\n  _createBackButton() {\n    const t = this.locale.t;\n    const backButton = new ButtonView(this.locale);\n    backButton.set({\n      class: 'ck-button-back',\n      label: t('Back'),\n      icon: IconPreviousArrow,\n      tooltip: true\n    });\n    backButton.delegate('execute').to(this, 'cancel');\n    return backButton;\n  }\n  /**\n  * Creates a save button view that saves the bookmark.\n  */\n  _createSaveButton() {\n    const t = this.locale.t;\n    const saveButton = new ButtonView(this.locale);\n    saveButton.set({\n      label: t('Save'),\n      withText: true,\n      type: 'submit',\n      class: 'ck-button-action ck-button-bold'\n    });\n    return saveButton;\n  }\n  /**\n  * Creates a header view for the form.\n  */\n  _createHeaderView() {\n    const t = this.locale.t;\n    const header = new FormHeaderView(this.locale, {\n      label: t('Bookmark')\n    });\n    header.children.add(this.backButtonView, 0);\n    return header;\n  }\n  /**\n  * Creates a labeled input view.\n  *\n  * @returns Labeled field view instance.\n  */\n  _createIdInput() {\n    const t = this.locale.t;\n    const labeledInput = new LabeledFieldView(this.locale, createLabeledInputText);\n    labeledInput.label = t('Bookmark name');\n    labeledInput.infoText = t('Enter the bookmark name without spaces.');\n    labeledInput.class = 'ck-labeled-field-view_full-width';\n    return labeledInput;\n  }\n  /**\n  * The native DOM `value` of the {@link #idInputView} element.\n  *\n  * **Note**: Do not confuse it with the {@link module:ui/inputtext/inputtextview~InputTextView#value}\n  * which works one way only and may not represent the actual state of the component in the DOM.\n  */\n  get id() {\n    const {\n      element\n    } = this.idInputView.fieldView;\n    if (!element) {\n      return null;\n    }\n    return element.value.trim();\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module bookmark/utils\n    */ /**\n       * Returns `true` if the bookmark id is valid; otherwise, returns `false`.\n       */\nfunction isBookmarkIdValid(id) {\n  if (!id || typeof id !== 'string') {\n    return false;\n  }\n  if (/\\s/.test(id)) {\n    return false;\n  }\n  return true;\n}\n\n/**\n * The insert bookmark command.\n *\n * The command is registered by {@link module:bookmark/bookmarkediting~BookmarkEditing} as `'insertBookmark'`.\n *\n * To insert a bookmark element at place where is the current collapsed selection or where is the beginning of document selection,\n * execute the command passing the bookmark id as a parameter:\n *\n * ```ts\n * editor.execute( 'insertBookmark', { bookmarkId: 'foo_bar' } );\n * ```\n */\nclass InsertBookmarkCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const position = this._getPositionToInsertBookmark(selection);\n    this.isEnabled = !!position;\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options Command options.\n  * @param options.bookmarkId The value of the `bookmarkId` attribute.\n  */\n  execute(options) {\n    if (!options) {\n      return;\n    }\n    const {\n      bookmarkId\n    } = options;\n    if (!isBookmarkIdValid(bookmarkId)) {\n      /**\n      * Insert bookmark command can be executed only with a valid name.\n      *\n      * A valid bookmark name must be a non-empty string and must not contain any spaces.\n      *\n      * @error insert-bookmark-command-executed-with-invalid-name\n      */\n      logWarning('insert-bookmark-command-executed-with-invalid-name');\n      return;\n    }\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    model.change(writer => {\n      let position = this._getPositionToInsertBookmark(selection);\n      const isBookmarkAllowed = model.schema.checkChild(position, 'bookmark');\n      // If the position does not allow for `bookmark` but allows for a `paragraph`\n      // then insert a `paragraph` then we will insert a `bookmark` inside.\n      if (!isBookmarkAllowed) {\n        const newPosition = editor.execute('insertParagraph', {\n          position\n        });\n        if (!newPosition) {\n          return;\n        }\n        position = newPosition;\n      }\n      const bookmarkElement = writer.createElement('bookmark', {\n        ...Object.fromEntries(selection.getAttributes()),\n        bookmarkId\n      });\n      model.insertObject(bookmarkElement, position, null, {\n        setSelection: 'on'\n      });\n    });\n  }\n  /**\n  * Returns the position where the bookmark can be inserted. And if it is not possible to insert a bookmark,\n  * check if it is possible to insert a paragraph.\n  */\n  _getPositionToInsertBookmark(selection) {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const firstRange = selection.getFirstRange();\n    const startPosition = firstRange.start;\n    // Return position if it is allowed to insert bookmark or if it is allowed to insert paragraph.\n    if (isBookmarkAllowed(startPosition, schema)) {\n      return startPosition;\n    }\n    for (const {\n      previousPosition,\n      item\n    } of firstRange) {\n      // When the table cell is selected (from the outside) we look for the first paragraph-like element inside.\n      if (item.is('element') && schema.checkChild(item, '$text') && isBookmarkAllowed(item, schema)) {\n        return model.createPositionAt(item, 0);\n      }\n      if (isBookmarkAllowed(previousPosition, schema)) {\n        return previousPosition;\n      }\n    }\n    return null;\n  }\n}\n/**\n * Verify if the given position allows for bookmark insertion. Verify if auto-paragraphing could help.\n */\nfunction isBookmarkAllowed(position, schema) {\n  if (schema.checkChild(position, 'bookmark')) {\n    return true;\n  }\n  if (!schema.checkChild(position, 'paragraph')) {\n    return false;\n  }\n  return schema.checkChild('paragraph', 'bookmark');\n}\n\n/**\n * The update bookmark command.\n *\n * The command is registered by {@link module:bookmark/bookmarkediting~BookmarkEditing} as `'updateBookmark'`.\n *\n * To update the `bookmarkId` of current selected bookmark element, execute the command passing the bookmark id as a parameter:\n *\n * ```ts\n * editor.execute( 'updateBookmark', { bookmarkId: 'newId' } );\n * ```\n */\nclass UpdateBookmarkCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedBookmark = getSelectedBookmark(selection);\n    this.isEnabled = !!selectedBookmark;\n    this.value = selectedBookmark ? selectedBookmark.getAttribute('bookmarkId') : undefined;\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options Command options.\n  * @param options.bookmarkId The new value of the `bookmarkId` attribute to set.\n  */\n  execute(options) {\n    if (!options) {\n      return;\n    }\n    const {\n      bookmarkId\n    } = options;\n    if (!isBookmarkIdValid(bookmarkId)) {\n      /**\n      * Update bookmark command can be executed only with a valid name.\n      *\n      * A valid bookmark name must be a non-empty string and must not contain any spaces.\n      *\n      * @error update-bookmark-command-executed-with-invalid-name\n      */\n      logWarning('update-bookmark-command-executed-with-invalid-name');\n      return;\n    }\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedBookmark = getSelectedBookmark(selection);\n    if (selectedBookmark) {\n      model.change(writer => {\n        writer.setAttribute('bookmarkId', bookmarkId, selectedBookmark);\n      });\n    }\n  }\n}\n/**\n * Returns the selected `bookmark` element in the model, if any.\n */\nfunction getSelectedBookmark(selection) {\n  const element = selection.getSelectedElement();\n  if (!!element && element.is('element', 'bookmark')) {\n    return element;\n  }\n  return null;\n}\n\n/**\n * The bookmark editing plugin.\n */\nclass BookmarkEditing extends Plugin {\n  /**\n  * A collection of bookmarks elements in the document.\n  */\n  _bookmarkElements = new Map();\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'BookmarkEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('bookmark', {\n      toolbar: ['bookmarkPreview', '|', 'editBookmark', 'removeBookmark']\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const {\n      editor\n    } = this;\n    this._defineSchema();\n    this._defineConverters();\n    editor.commands.add('insertBookmark', new InsertBookmarkCommand(editor));\n    editor.commands.add('updateBookmark', new UpdateBookmarkCommand(editor));\n    this.listenTo(editor.model.document, 'change:data', () => {\n      this._trackBookmarkElements();\n    });\n  }\n  /**\n  * Returns the model element for the given bookmark ID if it exists.\n  */\n  getElementForBookmarkId(bookmarkId) {\n    for (const [element, id] of this._bookmarkElements) {\n      if (id == bookmarkId) {\n        return element;\n      }\n    }\n    return null;\n  }\n  /**\n  * Returns all unique bookmark names existing in the content.\n  */\n  getAllBookmarkNames() {\n    return new Set(this._bookmarkElements.values());\n  }\n  /**\n  * Defines the schema for the bookmark feature.\n  */\n  _defineSchema() {\n    const schema = this.editor.model.schema;\n    schema.register('bookmark', {\n      inheritAllFrom: '$inlineObject',\n      allowAttributes: 'bookmarkId',\n      disallowAttributes: ['linkHref', 'htmlA']\n    });\n  }\n  /**\n  * Defines the converters for the bookmark feature.\n  */\n  _defineConverters() {\n    const {\n      editor\n    } = this;\n    const {\n      conversion,\n      t\n    } = editor;\n    editor.data.htmlProcessor.domConverter.registerInlineObjectMatcher(element => upcastMatcher(element));\n    // Register an inline object matcher so that bookmarks <a>s are correctly recognized as inline elements in editing pipeline.\n    // This prevents converting spaces around bookmarks to `&nbsp;`s.\n    editor.editing.view.domConverter.registerInlineObjectMatcher(element => upcastMatcher(element, false));\n    conversion.for('dataDowncast').elementToElement({\n      model: {\n        name: 'bookmark',\n        attributes: ['bookmarkId']\n      },\n      view: (modelElement, {\n        writer\n      }) => {\n        const emptyElement = writer.createEmptyElement('a', {\n          'id': modelElement.getAttribute('bookmarkId')\n        });\n        // `getFillerOffset` is not needed to set here, because `emptyElement` has already covered it.\n        return emptyElement;\n      }\n    });\n    conversion.for('editingDowncast').elementToElement({\n      model: {\n        name: 'bookmark',\n        attributes: ['bookmarkId']\n      },\n      view: (modelElement, {\n        writer\n      }) => {\n        const id = modelElement.getAttribute('bookmarkId');\n        const containerElement = writer.createContainerElement('a', {\n          id,\n          class: 'ck-bookmark'\n        }, [this._createBookmarkUIElement(writer)]);\n        writer.setCustomProperty('bookmark', true, containerElement);\n        this._bookmarkElements.set(modelElement, id);\n        // `getFillerOffset` is not needed to set here, because `toWidget` has already covered it.\n        const labelCreator = () => `${id} ${t('bookmark widget')}`;\n        return toWidget(containerElement, writer, {\n          label: labelCreator\n        });\n      }\n    });\n    conversion.for('upcast').add(dispatcher => dispatcher.on('element:a', dataViewModelAnchorInsertion(editor)));\n  }\n  /**\n  * Creates a UI element for the `bookmark` representation in editing view.\n  */\n  _createBookmarkUIElement(writer) {\n    return writer.createUIElement('span', {\n      class: 'ck-bookmark__icon'\n    }, function (domDocument) {\n      const domElement = this.toDomElement(domDocument);\n      const icon = new IconView();\n      icon.set({\n        content: IconBookmarkInline,\n        isColorInherited: false\n      });\n      icon.render();\n      domElement.appendChild(icon.element);\n      return domElement;\n    });\n  }\n  /**\n  * Tracking the added or removed bookmark elements.\n  */\n  _trackBookmarkElements() {\n    this._bookmarkElements.forEach((id, element) => {\n      if (element.root.rootName === '$graveyard') {\n        this._bookmarkElements.delete(element);\n      }\n    });\n  }\n}\n/**\n * A helper function to match an `anchor` element which must contain `id` or `name` attribute but without `href` attribute,\n * also when `expectEmpty` is set to `true` but the element is not empty matcher should not match any element.\n *\n * @param element The element to be checked.\n * @param expectEmpty Default set to `true`, when set to `false` matcher expects that `anchor` is not empty;\n * in editing pipeline it's not empty because it contains the `UIElement`.\n */\nfunction upcastMatcher(element, expectEmpty = true) {\n  const isAnchorElement = element.name === 'a';\n  if (!isAnchorElement) {\n    return null;\n  }\n  if (expectEmpty && !element.isEmpty) {\n    return null;\n  }\n  const hasIdAttribute = element.hasAttribute('id');\n  const hasNameAttribute = element.hasAttribute('name');\n  const hasHrefAttribute = element.hasAttribute('href');\n  if (hasIdAttribute && !hasHrefAttribute) {\n    return {\n      name: true,\n      attributes: ['id']\n    };\n  }\n  if (hasNameAttribute && !hasHrefAttribute) {\n    return {\n      name: true,\n      attributes: ['name']\n    };\n  }\n  return null;\n}\n/**\n * A view-to-model converter that handles converting pointed or wrapped anchors with `id` and/or `name` attributes.\n *\n * @returns Returns a conversion callback.\n */\nfunction dataViewModelAnchorInsertion(editor) {\n  return (evt, data, conversionApi) => {\n    const viewItem = data.viewItem;\n    const match = upcastMatcher(viewItem, false);\n    if (!match || !conversionApi.consumable.test(viewItem, match)) {\n      return;\n    }\n    const enableNonEmptyAnchorConversion = isEnabledNonEmptyAnchorConversion(editor);\n    if (!enableNonEmptyAnchorConversion && !viewItem.isEmpty) {\n      return;\n    }\n    const modelWriter = conversionApi.writer;\n    const anchorId = viewItem.getAttribute('id');\n    const anchorName = viewItem.getAttribute('name');\n    const bookmarkId = anchorId || anchorName;\n    const bookmark = modelWriter.createElement('bookmark', {\n      bookmarkId\n    });\n    if (!conversionApi.safeInsert(bookmark, data.modelCursor)) {\n      return;\n    }\n    conversionApi.consumable.consume(viewItem, match);\n    if (anchorId === anchorName) {\n      conversionApi.consumable.consume(viewItem, {\n        attributes: ['name']\n      });\n    }\n    conversionApi.updateConversionResult(bookmark, data);\n    // Convert children uses the result of `bookmark` insertion to convert the `anchor` content\n    // after the bookmark element (not inside it).\n    const {\n      modelCursor,\n      modelRange\n    } = conversionApi.convertChildren(viewItem, data.modelCursor);\n    data.modelCursor = modelCursor;\n    data.modelRange = modelWriter.createRange(data.modelRange.start, modelRange.end);\n  };\n}\n/**\n * Normalize the bookmark configuration option `enableNonEmptyAnchorConversion`.\n */\nfunction isEnabledNonEmptyAnchorConversion(editor) {\n  const enableNonEmptyAnchorConversion = editor.config.get('bookmark.enableNonEmptyAnchorConversion');\n  // When not defined, option `enableNonEmptyAnchorConversion` by default is set to `true`.\n  return enableNonEmptyAnchorConversion !== undefined ? enableNonEmptyAnchorConversion : true;\n}\nconst VISUAL_SELECTION_MARKER_NAME = 'bookmark-ui';\n/**\n * The UI plugin of the bookmark feature.\n *\n * It registers the `'bookmark'` UI button in the editor's {@link module:ui/componentfactory~ComponentFactory component factory}\n * which inserts the `bookmark` element upon selection.\n */\nclass BookmarkUI extends Plugin {\n  /**\n  * The form view displayed inside the balloon.\n  */\n  formView = null;\n  /**\n  * The contextual balloon plugin instance.\n  */\n  _balloon;\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [BookmarkEditing, ContextualBalloon, WidgetToolbarRepository];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'BookmarkUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    this._balloon = editor.plugins.get(ContextualBalloon);\n    // Register the link provider in link plugin to display the link form.\n    if (editor.plugins.has('LinkUI')) {\n      this._registerLinkProvider();\n    }\n    // Create toolbar buttons.\n    this._registerComponents();\n    // Renders a fake visual selection marker on an expanded selection.\n    editor.conversion.for('editingDowncast').markerToHighlight({\n      model: VISUAL_SELECTION_MARKER_NAME,\n      view: {\n        classes: ['ck-fake-bookmark-selection']\n      }\n    });\n    // Renders a fake visual selection marker on a collapsed selection.\n    editor.conversion.for('editingDowncast').markerToElement({\n      model: VISUAL_SELECTION_MARKER_NAME,\n      view: (data, {\n        writer\n      }) => {\n        if (!data.markerRange.isCollapsed) {\n          return null;\n        }\n        const markerElement = writer.createUIElement('span');\n        writer.addClass(['ck-fake-bookmark-selection', 'ck-fake-bookmark-selection_collapsed'], markerElement);\n        return markerElement;\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const widgetToolbarRepository = this.editor.plugins.get(WidgetToolbarRepository);\n    const defaultPositions = BalloonPanelView.defaultPositions;\n    widgetToolbarRepository.register('bookmark', {\n      ariaLabel: t('Bookmark toolbar'),\n      items: editor.config.get('bookmark.toolbar'),\n      getRelatedElement: getSelectedBookmarkWidget,\n      balloonClassName: 'ck-bookmark-balloon ck-toolbar-container',\n      // Override positions to the same list as for balloon panel default\n      // so widget toolbar will try to use same position as form view.\n      positions: [defaultPositions.southArrowNorth, defaultPositions.southArrowNorthMiddleWest, defaultPositions.southArrowNorthMiddleEast, defaultPositions.southArrowNorthWest, defaultPositions.southArrowNorthEast, defaultPositions.northArrowSouth, defaultPositions.northArrowSouthMiddleWest, defaultPositions.northArrowSouthMiddleEast, defaultPositions.northArrowSouthWest, defaultPositions.northArrowSouthEast, defaultPositions.viewportStickyNorth]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    // Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n    if (this.formView) {\n      this.formView.destroy();\n    }\n  }\n  /**\n  * Creates views.\n  */\n  _createViews() {\n    this.formView = this._createFormView();\n    // Attach lifecycle actions to the the balloon.\n    this._enableUserBalloonInteractions();\n  }\n  /**\n  * Creates the {@link module:bookmark/ui/bookmarkformview~BookmarkFormView} instance.\n  */\n  _createFormView() {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const t = locale.t;\n    const insertBookmarkCommand = editor.commands.get('insertBookmark');\n    const updateBookmarkCommand = editor.commands.get('updateBookmark');\n    const commands = [insertBookmarkCommand, updateBookmarkCommand];\n    const formView = new (CssTransitionDisablerMixin(BookmarkFormView))(locale, getFormValidators(editor));\n    formView.idInputView.fieldView.bind('value').to(updateBookmarkCommand, 'value');\n    formView.saveButtonView.bind('label').to(updateBookmarkCommand, 'value', value => value ? t('Save') : t('Insert'));\n    // Form elements should be read-only when corresponding commands are disabled.\n    formView.idInputView.bind('isEnabled').toMany(commands, 'isEnabled', (...areEnabled) => areEnabled.some(isEnabled => isEnabled));\n    // Disable the \"save\" button if the command is disabled.\n    formView.saveButtonView.bind('isEnabled').toMany(commands, 'isEnabled', (...areEnabled) => areEnabled.some(isEnabled => isEnabled));\n    // Close the panel on form after clicking back button.\n    this.listenTo(formView, 'cancel', () => {\n      this._hideFormView();\n    });\n    // Execute link command after clicking the \"Save\" button.\n    this.listenTo(formView, 'submit', () => {\n      if (formView.isValid()) {\n        const value = formView.id;\n        if (this._getSelectedBookmarkElement()) {\n          editor.execute('updateBookmark', {\n            bookmarkId: value\n          });\n        } else {\n          editor.execute('insertBookmark', {\n            bookmarkId: value\n          });\n        }\n        this._hideFormView();\n      }\n    });\n    // Update balloon position when form error changes.\n    this.listenTo(formView.idInputView, 'change:errorText', () => {\n      editor.ui.update();\n    });\n    return formView;\n  }\n  /**\n  * Creates link form menu list entry, so it'll be possible to access\n  * the list of the bookmarks from the link form.\n  */\n  _registerLinkProvider() {\n    const t = this.editor.locale.t;\n    const linksUI = this.editor.plugins.get('LinkUI');\n    const bookmarkEditing = this.editor.plugins.get(BookmarkEditing);\n    const getListItems = () => Array.from(bookmarkEditing.getAllBookmarkNames()).sort((a, b) => a.localeCompare(b)).map(bookmarkId => ({\n      id: bookmarkId,\n      href: `#${bookmarkId}`,\n      label: bookmarkId,\n      icon: IconBookmarkMedium\n    }));\n    const getItem = href => {\n      const bookmark = [...bookmarkEditing.getAllBookmarkNames()].find(item => `#${item}` === href);\n      if (!bookmark) {\n        return null;\n      }\n      return {\n        href,\n        label: bookmark,\n        icon: IconBookmarkSmall,\n        tooltip: t('Scroll to bookmark')\n      };\n    };\n    linksUI.registerLinksListProvider({\n      label: t('Bookmarks'),\n      emptyListPlaceholder: t('No bookmarks available.'),\n      navigate: ({\n        href\n      }) => this._scrollToBookmark(href),\n      getListItems,\n      getItem\n    });\n  }\n  /**\n  * Scrolls the editor to the bookmark with the given id.\n  */\n  _scrollToBookmark(href) {\n    const bookmarkEditing = this.editor.plugins.get(BookmarkEditing);\n    const bookmarkElement = bookmarkEditing.getElementForBookmarkId(href.slice(1));\n    if (!bookmarkElement) {\n      return false;\n    }\n    this.editor.model.change(writer => {\n      writer.setSelection(bookmarkElement, 'on');\n    });\n    this.editor.editing.view.scrollToTheSelection({\n      alignToTop: true,\n      forceScroll: true\n    });\n    return true;\n  }\n  /**\n  * Creates a toolbar Bookmark button. Clicking this button will show\n  * a {@link #_balloon} attached to the selection.\n  */\n  _registerComponents() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('bookmark', () => {\n      const buttonView = this._createBookmarkButton(ButtonView);\n      buttonView.set({\n        tooltip: true\n      });\n      return buttonView;\n    });\n    editor.ui.componentFactory.add('menuBar:bookmark', () => {\n      return this._createBookmarkButton(MenuBarMenuListItemButtonView);\n    });\n    // Bookmark toolbar buttons.\n    editor.ui.componentFactory.add('bookmarkPreview', locale => {\n      const updateBookmarkCommand = editor.commands.get('updateBookmark');\n      const label = new LabelView(locale);\n      label.extendTemplate({\n        attributes: {\n          class: ['ck-bookmark-toolbar__preview']\n        }\n      });\n      label.bind('text').to(updateBookmarkCommand, 'value');\n      return label;\n    });\n    editor.ui.componentFactory.add('editBookmark', locale => {\n      const updateBookmarkCommand = editor.commands.get('updateBookmark');\n      const button = new ButtonView(locale);\n      const t = locale.t;\n      button.set({\n        label: t('Edit bookmark'),\n        icon: IconPencil,\n        tooltip: true\n      });\n      button.bind('isEnabled').to(updateBookmarkCommand);\n      this.listenTo(button, 'execute', () => {\n        this._showFormView();\n      });\n      return button;\n    });\n    editor.ui.componentFactory.add('removeBookmark', locale => {\n      const deleteCommand = editor.commands.get('delete');\n      const button = new ButtonView(locale);\n      const t = locale.t;\n      button.set({\n        label: t('Remove bookmark'),\n        icon: IconRemove,\n        tooltip: true\n      });\n      button.bind('isEnabled').to(deleteCommand);\n      this.listenTo(button, 'execute', () => {\n        editor.execute('delete');\n        editor.editing.view.focus();\n      });\n      return button;\n    });\n  }\n  /**\n  * Creates a button for `bookmark` command to use either in toolbar or in menu bar.\n  */\n  _createBookmarkButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const view = new ButtonClass(locale);\n    const insertCommand = editor.commands.get('insertBookmark');\n    const updateCommand = editor.commands.get('updateBookmark');\n    const t = locale.t;\n    view.set({\n      label: t('Bookmark'),\n      icon: IconBookmark\n    });\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.editing.view.scrollToTheSelection();\n      this._showFormView();\n    });\n    view.bind('isEnabled').toMany([insertCommand, updateCommand], 'isEnabled', (...areEnabled) => areEnabled.some(isEnabled => isEnabled));\n    view.bind('isOn').to(updateCommand, 'value', value => !!value);\n    return view;\n  }\n  /**\n  * Attaches actions that control whether the balloon panel containing the\n  * {@link #formView} is visible or not.\n  */\n  _enableUserBalloonInteractions() {\n    // Close the panel on the Esc key press when the editable has focus and the balloon is visible.\n    this.editor.keystrokes.set('Esc', (data, cancel) => {\n      if (this._isFormVisible) {\n        this._hideFormView();\n        cancel();\n      }\n    });\n    // Close on click outside of balloon panel element.\n    clickOutsideHandler({\n      emitter: this.formView,\n      activator: () => this._isFormInPanel,\n      contextElements: () => [this._balloon.view.element],\n      callback: () => {\n        // Focusing on the editable during a click outside the balloon panel might\n        // cause the selection to move to the beginning of the editable, so we avoid\n        // focusing on it during this action.\n        // See: https://github.com/ckeditor/ckeditor5/issues/18253\n        this._hideFormView(false);\n      }\n    });\n  }\n  /**\n  * Adds the {@link #formView} to the {@link #_balloon}.\n  */\n  _addFormView() {\n    if (!this.formView) {\n      this._createViews();\n    }\n    if (this._isFormInPanel) {\n      return;\n    }\n    const updateBookmarkCommand = this.editor.commands.get('updateBookmark');\n    this.formView.disableCssTransitions();\n    this.formView.resetFormStatus();\n    this._balloon.add({\n      view: this.formView,\n      position: this._getBalloonPositionData()\n    });\n    this.formView.backButtonView.isVisible = updateBookmarkCommand.isEnabled;\n    this.formView.idInputView.fieldView.value = updateBookmarkCommand.value || '';\n    // Select input when form view is currently visible.\n    if (this._balloon.visibleView === this.formView) {\n      this.formView.idInputView.fieldView.select();\n    }\n    this.formView.enableCssTransitions();\n  }\n  /**\n  * Removes the {@link #formView} from the {@link #_balloon}.\n  */\n  _removeFormView(updateFocus = true) {\n    // Blur the input element before removing it from DOM to prevent issues in some browsers.\n    // See https://github.com/ckeditor/ckeditor5/issues/1501.\n    this.formView.saveButtonView.focus();\n    // Reset the ID field to update the state of the submit button.\n    this.formView.idInputView.fieldView.reset();\n    this._balloon.remove(this.formView);\n    // Because the form has an input which has focus, the focus must be brought back\n    // to the editor. Otherwise, it would be lost.\n    if (updateFocus) {\n      this.editor.editing.view.focus();\n    }\n    this._hideFakeVisualSelection();\n  }\n  /**\n  * Shows the {@link #formView}.\n  */\n  _showFormView() {\n    if (!this.formView) {\n      this._createViews();\n    }\n    if (!this._getSelectedBookmarkElement()) {\n      this._showFakeVisualSelection();\n    }\n    this._addFormView();\n    // Be sure panel with bookmark is visible.\n    this._balloon.showStack('main');\n    // Begin responding to ui#update once the UI is added.\n    this._startUpdatingUI();\n  }\n  /**\n  * Removes the {@link #formView} from the {@link #_balloon}.\n  */\n  _hideFormView(updateFocus = true) {\n    if (!this._isFormInPanel) {\n      return;\n    }\n    const editor = this.editor;\n    this.stopListening(editor.ui, 'update');\n    this.stopListening(this._balloon, 'change:visibleView');\n    // Make sure the focus always gets back to the editable _before_ removing the focused form view.\n    // Doing otherwise causes issues in some browsers. See https://github.com/ckeditor/ckeditor5-link/issues/193.\n    if (updateFocus) {\n      editor.editing.view.focus();\n    }\n    // Remove form first because it's on top of the stack.\n    this._removeFormView(updateFocus);\n    this._hideFakeVisualSelection();\n  }\n  /**\n  * Makes the UI react to the {@link module:ui/editorui/editorui~EditorUI#event:update} event to\n  * reposition itself when the editor UI should be refreshed.\n  *\n  * See: {@link #_hideFormView} to learn when the UI stops reacting to the `update` event.\n  */\n  _startUpdatingUI() {\n    const editor = this.editor;\n    const viewDocument = editor.editing.view.document;\n    let prevSelectedBookmark = this._getSelectedBookmarkElement();\n    let prevSelectionParent = getSelectionParent();\n    const update = () => {\n      const selectedBookmark = this._getSelectedBookmarkElement();\n      const selectionParent = getSelectionParent();\n      // Hide the panel if:\n      //\n      // * the selection went out of the EXISTING bookmark element. E.g. user moved the caret out\n      //   of the bookmark,\n      // * the selection went to a different parent when creating a NEW bookmark. E.g. someone\n      //   else modified the document.\n      // * the selection has expanded (e.g. displaying bookmark actions then pressing SHIFT+Right arrow).\n      //\n      if (prevSelectedBookmark && !selectedBookmark || !prevSelectedBookmark && selectionParent !== prevSelectionParent) {\n        this._hideFormView();\n      } else if (this._isFormVisible) {\n        // If still in a bookmark element, simply update the position of the balloon.\n        // If there was no bookmark (e.g. inserting one), the balloon must be moved\n        // to the new position in the editing view (a new native DOM range).\n        this._balloon.updatePosition(this._getBalloonPositionData());\n      }\n      prevSelectedBookmark = selectedBookmark;\n      prevSelectionParent = selectionParent;\n    };\n    function getSelectionParent() {\n      return viewDocument.selection.focus.getAncestors().reverse().find(node => node.is('element'));\n    }\n    this.listenTo(editor.ui, 'update', update);\n    this.listenTo(this._balloon, 'change:visibleView', update);\n  }\n  /**\n  * Returns `true` when {@link #formView} is in the {@link #_balloon}.\n  */\n  get _isFormInPanel() {\n    return !!this.formView && this._balloon.hasView(this.formView);\n  }\n  /**\n  * Returns `true` when {@link #formView} is in the {@link #_balloon} and it is currently visible.\n  */\n  get _isFormVisible() {\n    return !!this.formView && this._balloon.visibleView == this.formView;\n  }\n  /**\n  * Returns positioning options for the {@link #_balloon}. They control the way the balloon is attached\n  * to the target element or selection.\n  */\n  _getBalloonPositionData() {\n    const view = this.editor.editing.view;\n    const model = this.editor.model;\n    let target;\n    const bookmarkElement = this._getSelectedBookmarkElement();\n    if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n      // There are cases when we highlight selection using a marker (#7705, #4721).\n      const markerViewElements = Array.from(this.editor.editing.mapper.markerNameToElements(VISUAL_SELECTION_MARKER_NAME));\n      const newRange = view.createRange(view.createPositionBefore(markerViewElements[0]), view.createPositionAfter(markerViewElements[markerViewElements.length - 1]));\n      target = view.domConverter.viewRangeToDom(newRange);\n    } else if (bookmarkElement) {\n      target = () => {\n        const mapper = this.editor.editing.mapper;\n        const domConverter = view.domConverter;\n        const viewElement = mapper.toViewElement(bookmarkElement);\n        return domConverter.mapViewToDom(viewElement);\n      };\n    }\n    if (!target) {\n      return;\n    }\n    return {\n      target\n    };\n  }\n  /**\n  * Returns the bookmark {@link module:engine/view/attributeelement~AttributeElement} under\n  * the {@link module:engine/view/document~Document editing view's} selection or `null`\n  * if there is none.\n  */\n  _getSelectedBookmarkElement() {\n    const selection = this.editor.model.document.selection;\n    const element = selection.getSelectedElement();\n    if (element && element.is('element', 'bookmark')) {\n      return element;\n    }\n    return null;\n  }\n  /**\n  * Displays a fake visual selection when the contextual balloon is displayed.\n  *\n  * This adds a 'bookmark-ui' marker into the document that is rendered as a highlight on selected text fragment.\n  */\n  _showFakeVisualSelection() {\n    const model = this.editor.model;\n    model.change(writer => {\n      const range = model.document.selection.getFirstRange();\n      if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n        writer.updateMarker(VISUAL_SELECTION_MARKER_NAME, {\n          range\n        });\n      } else {\n        if (range.start.isAtEnd) {\n          const startPosition = range.start.getLastMatchingPosition(({\n            item\n          }) => !model.schema.isContent(item), {\n            boundaries: range\n          });\n          writer.addMarker(VISUAL_SELECTION_MARKER_NAME, {\n            usingOperation: false,\n            affectsData: false,\n            range: writer.createRange(startPosition, range.end)\n          });\n        } else {\n          writer.addMarker(VISUAL_SELECTION_MARKER_NAME, {\n            usingOperation: false,\n            affectsData: false,\n            range\n          });\n        }\n      }\n    });\n  }\n  /**\n  * Hides the fake visual selection created in {@link #_showFakeVisualSelection}.\n  */\n  _hideFakeVisualSelection() {\n    const model = this.editor.model;\n    if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n      model.change(writer => {\n        writer.removeMarker(VISUAL_SELECTION_MARKER_NAME);\n      });\n    }\n  }\n}\n/**\n * Returns bookmark form validation callbacks.\n */\nfunction getFormValidators(editor) {\n  const {\n    t\n  } = editor;\n  const bookmarkEditing = editor.plugins.get(BookmarkEditing);\n  return [form => {\n    if (!form.id) {\n      return t('Bookmark must not be empty.');\n    }\n  }, form => {\n    if (form.id && /\\s/.test(form.id)) {\n      return t('Bookmark name cannot contain space characters.');\n    }\n  }, form => {\n    const selectedElement = editor.model.document.selection.getSelectedElement();\n    const existingBookmarkForId = bookmarkEditing.getElementForBookmarkId(form.id);\n    // Accept change of bookmark ID if no real change is happening (edit -> submit, without changes).\n    if (selectedElement === existingBookmarkForId) {\n      return;\n    }\n    if (existingBookmarkForId) {\n      return t('Bookmark name already exists.');\n    }\n  }];\n}\n/**\n * Returns the currently selected bookmark view element.\n */\nfunction getSelectedBookmarkWidget(selection) {\n  const element = selection.getSelectedElement();\n  if (!element || !isWidget(element) || !element.getCustomProperty('bookmark')) {\n    return null;\n  }\n  return element;\n}\n\n/**\n * The bookmark feature.\n *\n * For a detailed overview, check the {@glink features/bookmarks Bookmarks} feature guide.\n */\nclass Bookmark extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Bookmark';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [BookmarkEditing, BookmarkUI, Widget];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { Bookmark, BookmarkEditing, BookmarkUI, InsertBookmarkCommand, UpdateBookmarkCommand };\n", "var q = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\", \"#\", \"$\", \"%\", \"*\", \"+\", \",\", \"-\", \".\", \":\", \";\", \"=\", \"?\", \"@\", \"[\", \"]\", \"^\", \"_\", \"{\", \"|\", \"}\", \"~\"],\n  x = t => {\n    let e = 0;\n    for (let r = 0; r < t.length; r++) {\n      let n = t[r],\n        l = q.indexOf(n);\n      e = e * 83 + l;\n    }\n    return e;\n  },\n  p = (t, e) => {\n    var r = \"\";\n    for (let n = 1; n <= e; n++) {\n      let l = Math.floor(t) / Math.pow(83, e - n) % 83;\n      r += q[Math.floor(l)];\n    }\n    return r;\n  };\nvar f = t => {\n    let e = t / 255;\n    return e <= .04045 ? e / 12.92 : Math.pow((e + .055) / 1.055, 2.4);\n  },\n  h = t => {\n    let e = Math.max(0, Math.min(1, t));\n    return e <= .0031308 ? Math.trunc(e * 12.92 * 255 + .5) : Math.trunc((1.055 * Math.pow(e, .4166666666666667) - .055) * 255 + .5);\n  },\n  F = t => t < 0 ? -1 : 1,\n  M = (t, e) => F(t) * Math.pow(Math.abs(t), e);\nvar d = class extends Error {\n  constructor(e) {\n    super(e), this.name = \"ValidationError\", this.message = e;\n  }\n};\nvar C = t => {\n    if (!t || t.length < 6) throw new d(\"The blurhash string must be at least 6 characters\");\n    let e = x(t[0]),\n      r = Math.floor(e / 9) + 1,\n      n = e % 9 + 1;\n    if (t.length !== 4 + 2 * n * r) throw new d(`blurhash length mismatch: length is ${t.length} but it should be ${4 + 2 * n * r}`);\n  },\n  N = t => {\n    try {\n      C(t);\n    } catch (e) {\n      return {\n        result: !1,\n        errorReason: e.message\n      };\n    }\n    return {\n      result: !0\n    };\n  },\n  z = t => {\n    let e = t >> 16,\n      r = t >> 8 & 255,\n      n = t & 255;\n    return [f(e), f(r), f(n)];\n  },\n  L = (t, e) => {\n    let r = Math.floor(t / 361),\n      n = Math.floor(t / 19) % 19,\n      l = t % 19;\n    return [M((r - 9) / 9, 2) * e, M((n - 9) / 9, 2) * e, M((l - 9) / 9, 2) * e];\n  },\n  U = (t, e, r, n) => {\n    C(t), n = n | 1;\n    let l = x(t[0]),\n      m = Math.floor(l / 9) + 1,\n      b = l % 9 + 1,\n      i = (x(t[1]) + 1) / 166,\n      u = new Array(b * m);\n    for (let o = 0; o < u.length; o++) if (o === 0) {\n      let a = x(t.substring(2, 6));\n      u[o] = z(a);\n    } else {\n      let a = x(t.substring(4 + o * 2, 6 + o * 2));\n      u[o] = L(a, i * n);\n    }\n    let c = e * 4,\n      s = new Uint8ClampedArray(c * r);\n    for (let o = 0; o < r; o++) for (let a = 0; a < e; a++) {\n      let y = 0,\n        B = 0,\n        R = 0;\n      for (let w = 0; w < m; w++) for (let P = 0; P < b; P++) {\n        let G = Math.cos(Math.PI * a * P / e) * Math.cos(Math.PI * o * w / r),\n          T = u[P + w * b];\n        y += T[0] * G, B += T[1] * G, R += T[2] * G;\n      }\n      let V = h(y),\n        I = h(B),\n        E = h(R);\n      s[4 * a + 0 + o * c] = V, s[4 * a + 1 + o * c] = I, s[4 * a + 2 + o * c] = E, s[4 * a + 3 + o * c] = 255;\n    }\n    return s;\n  },\n  j = U;\nvar A = 4,\n  D = (t, e, r, n) => {\n    let l = 0,\n      m = 0,\n      b = 0,\n      g = e * A;\n    for (let u = 0; u < e; u++) {\n      let c = A * u;\n      for (let s = 0; s < r; s++) {\n        let o = c + s * g,\n          a = n(u, s);\n        l += a * f(t[o]), m += a * f(t[o + 1]), b += a * f(t[o + 2]);\n      }\n    }\n    let i = 1 / (e * r);\n    return [l * i, m * i, b * i];\n  },\n  $ = t => {\n    let e = h(t[0]),\n      r = h(t[1]),\n      n = h(t[2]);\n    return (e << 16) + (r << 8) + n;\n  },\n  H = (t, e) => {\n    let r = Math.floor(Math.max(0, Math.min(18, Math.floor(M(t[0] / e, .5) * 9 + 9.5)))),\n      n = Math.floor(Math.max(0, Math.min(18, Math.floor(M(t[1] / e, .5) * 9 + 9.5)))),\n      l = Math.floor(Math.max(0, Math.min(18, Math.floor(M(t[2] / e, .5) * 9 + 9.5))));\n    return r * 19 * 19 + n * 19 + l;\n  },\n  O = (t, e, r, n, l) => {\n    if (n < 1 || n > 9 || l < 1 || l > 9) throw new d(\"BlurHash must have between 1 and 9 components\");\n    if (e * r * 4 !== t.length) throw new d(\"Width and height must match the pixels array\");\n    let m = [];\n    for (let s = 0; s < l; s++) for (let o = 0; o < n; o++) {\n      let a = o == 0 && s == 0 ? 1 : 2,\n        y = D(t, e, r, (B, R) => a * Math.cos(Math.PI * o * B / e) * Math.cos(Math.PI * s * R / r));\n      m.push(y);\n    }\n    let b = m[0],\n      g = m.slice(1),\n      i = \"\",\n      u = n - 1 + (l - 1) * 9;\n    i += p(u, 1);\n    let c;\n    if (g.length > 0) {\n      let s = Math.max(...g.map(a => Math.max(...a))),\n        o = Math.floor(Math.max(0, Math.min(82, Math.floor(s * 166 - .5))));\n      c = (o + 1) / 166, i += p(o, 1);\n    } else c = 1, i += p(0, 1);\n    return i += p($(b), 4), g.forEach(s => {\n      i += p(H(s, c), 2);\n    }), i;\n  },\n  S = O;\nexport { d as ValidationError, j as decode, S as encode, N as isBlurhashValid };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, Command, PendingActions } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView, Notification } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconBrowseFiles, IconImageAssetManager, IconCkboxImageEdit } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { Range } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { createElement, toMap, CKEditorError, logError, global, delay, abortableDebounce, retry } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { decode } from 'blurhash';\nimport { FileRepository } from '@ckeditor/ckeditor5-upload/dist/index.js';\nimport { isEqual } from 'es-toolkit/compat';\n\n/**\n * Introduces UI components for the `CKBox` plugin.\n *\n * The plugin introduces two UI components to the {@link module:ui/componentfactory~ComponentFactory UI component factory}:\n *\n * * the `'ckbox'` toolbar button,\n * * the `'menuBar:ckbox'` menu bar component, which is by default added to the `'Insert'` menu.\n *\n * It also integrates with the `insertImage` toolbar component and `menuBar:insertImage` menu component.\n */\nclass CKBoxUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKBoxUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    // Do not register the `ckbox` button if the command does not exist.\n    // This might happen when CKBox library is not loaded on the page.\n    if (!editor.commands.get('ckbox')) {\n      return;\n    }\n    editor.ui.componentFactory.add('ckbox', () => this._createFileToolbarButton());\n    editor.ui.componentFactory.add('menuBar:ckbox', () => this._createFileMenuBarButton());\n    if (editor.plugins.has('ImageInsertUI')) {\n      editor.plugins.get('ImageInsertUI').registerIntegration({\n        name: 'assetManager',\n        observable: () => editor.commands.get('ckbox'),\n        buttonViewCreator: () => this._createImageToolbarButton(),\n        formViewCreator: () => this._createImageDropdownButton(),\n        menuBarButtonViewCreator: isOnly => this._createImageMenuBarButton(isOnly ? 'insertOnly' : 'insertNested')\n      });\n    }\n  }\n  /**\n  * Creates the base for various kinds of the button component provided by this feature.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const view = new ButtonClass(locale);\n    const command = editor.commands.get('ckbox');\n    view.bind('isOn', 'isEnabled').to(command, 'value', 'isEnabled');\n    view.on('execute', () => {\n      editor.execute('ckbox');\n    });\n    return view;\n  }\n  /**\n  * Creates a simple toolbar button for files management, with an icon and a tooltip.\n  */\n  _createFileToolbarButton() {\n    const t = this.editor.locale.t;\n    const button = this._createButton(ButtonView);\n    button.icon = IconBrowseFiles;\n    button.label = t('Open file manager');\n    button.tooltip = true;\n    return button;\n  }\n  /**\n  * Creates a simple toolbar button for images management, with an icon and a tooltip.\n  */\n  _createImageToolbarButton() {\n    const t = this.editor.locale.t;\n    const imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n    const button = this._createButton(ButtonView);\n    button.icon = IconImageAssetManager;\n    button.bind('label').to(imageInsertUI, 'isImageSelected', isImageSelected => isImageSelected ? t('Replace image with file manager') : t('Insert image with file manager'));\n    button.tooltip = true;\n    return button;\n  }\n  /**\n  * Creates a button for images management for the dropdown view, with an icon, text and no tooltip.\n  */\n  _createImageDropdownButton() {\n    const t = this.editor.locale.t;\n    const imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n    const button = this._createButton(ButtonView);\n    button.icon = IconImageAssetManager;\n    button.withText = true;\n    button.bind('label').to(imageInsertUI, 'isImageSelected', isImageSelected => isImageSelected ? t('Replace with file manager') : t('Insert with file manager'));\n    button.on('execute', () => {\n      imageInsertUI.dropdownView.isOpen = false;\n    });\n    return button;\n  }\n  /**\n  * Creates a button for files management for the menu bar.\n  */\n  _createFileMenuBarButton() {\n    const t = this.editor.locale.t;\n    const button = this._createButton(MenuBarMenuListItemButtonView);\n    button.icon = IconBrowseFiles;\n    button.withText = true;\n    button.label = t('File');\n    return button;\n  }\n  /**\n  * Creates a button for images management for the menu bar.\n  */\n  _createImageMenuBarButton(type) {\n    // Use t() stored in a variable with a different name to reuse existing translations from another package.\n    const translateVariableKey = this.editor.locale.t;\n    const t = this.editor.locale.t;\n    const button = this._createButton(MenuBarMenuListItemButtonView);\n    button.icon = IconImageAssetManager;\n    button.withText = true;\n    switch (type) {\n      case 'insertOnly':\n        button.label = translateVariableKey('Image');\n        break;\n      case 'insertNested':\n        button.label = t('With file manager');\n        break;\n    }\n    return button;\n  }\n}\n\n/**\n * Converts image source set provided by the CKBox into an object containing:\n * - responsive URLs for the \"webp\" image format,\n * - one fallback URL for browsers that do not support the \"webp\" format.\n */\nfunction getImageUrls(imageUrls) {\n  const responsiveUrls = [];\n  let maxWidth = 0;\n  for (const key in imageUrls) {\n    const width = parseInt(key, 10);\n    if (!isNaN(width)) {\n      if (width > maxWidth) {\n        maxWidth = width;\n      }\n      responsiveUrls.push(`${imageUrls[key]} ${key}w`);\n    }\n  }\n  const imageSources = [{\n    srcset: responsiveUrls.join(','),\n    sizes: `(max-width: ${maxWidth}px) 100vw, ${maxWidth}px`,\n    type: 'image/webp'\n  }];\n  return {\n    imageFallbackUrl: imageUrls.default,\n    imageSources\n  };\n}\n/**\n * Returns a workspace id to use for communication with the CKBox service.\n *\n * @param defaultWorkspaceId The default workspace to use taken from editor config.\n */\nfunction getWorkspaceId(token, defaultWorkspaceId) {\n  const [, binaryTokenPayload] = token.value.split('.');\n  const payload = JSON.parse(atob(binaryTokenPayload));\n  const workspaces = payload.auth?.ckbox?.workspaces || [payload.aud];\n  if (!defaultWorkspaceId) {\n    return workspaces[0];\n  }\n  if (payload.auth?.ckbox?.role == 'superadmin' || workspaces.includes(defaultWorkspaceId)) {\n    return defaultWorkspaceId;\n  }\n  return null;\n}\n/**\n * Default resolution for decoding blurhash values.\n * Relatively small values must be used in order to ensure acceptable performance.\n */\nconst BLUR_RESOLUTION = 32;\n/**\n * Generates an image data URL from its `blurhash` representation.\n */\nfunction blurHashToDataUrl(hash) {\n  if (!hash) {\n    return;\n  }\n  try {\n    const resolutionInPx = `${BLUR_RESOLUTION}px`;\n    const canvas = document.createElement('canvas');\n    canvas.setAttribute('width', resolutionInPx);\n    canvas.setAttribute('height', resolutionInPx);\n    const ctx = canvas.getContext('2d');\n    /* istanbul ignore next -- @preserve */\n    if (!ctx) {\n      return;\n    }\n    const imageData = ctx.createImageData(BLUR_RESOLUTION, BLUR_RESOLUTION);\n    const decoded = decode(hash, BLUR_RESOLUTION, BLUR_RESOLUTION);\n    imageData.data.set(decoded);\n    ctx.putImageData(imageData, 0, 0);\n    return canvas.toDataURL();\n  } catch (e) {\n    return undefined;\n  }\n}\n/**\n * Sends the HTTP request.\n *\n * @internal\n * @param config.url the URL where the request will be sent.\n * @param config.method The HTTP method.\n * @param config.data Additional data to send.\n * @param config.onUploadProgress A callback informing about the upload progress.\n */\nfunction sendHttpRequest({\n  url,\n  method = 'GET',\n  data,\n  onUploadProgress,\n  signal,\n  authorization\n}) {\n  const xhr = new XMLHttpRequest();\n  xhr.open(method, url.toString());\n  xhr.setRequestHeader('Authorization', authorization);\n  xhr.setRequestHeader('CKBox-Version', 'CKEditor 5');\n  xhr.responseType = 'json';\n  // The callback is attached to the `signal#abort` event.\n  const abortCallback = () => {\n    xhr.abort();\n  };\n  return new Promise((resolve, reject) => {\n    signal.throwIfAborted();\n    signal.addEventListener('abort', abortCallback);\n    xhr.addEventListener('loadstart', () => {\n      signal.addEventListener('abort', abortCallback);\n    });\n    xhr.addEventListener('loadend', () => {\n      signal.removeEventListener('abort', abortCallback);\n    });\n    xhr.addEventListener('error', () => {\n      reject();\n    });\n    xhr.addEventListener('abort', () => {\n      reject();\n    });\n    xhr.addEventListener('load', () => {\n      const response = xhr.response;\n      if (!response || response.statusCode >= 400) {\n        return reject(response && response.message);\n      }\n      resolve(response);\n    });\n    /* istanbul ignore else -- @preserve */\n    if (onUploadProgress) {\n      xhr.upload.addEventListener('progress', evt => {\n        onUploadProgress(evt);\n      });\n    }\n    // Send the request.\n    xhr.send(data);\n  });\n}\nconst MIME_TO_EXTENSION = {\n  'image/gif': 'gif',\n  'image/jpeg': 'jpg',\n  'image/png': 'png',\n  'image/webp': 'webp',\n  'image/bmp': 'bmp',\n  'image/tiff': 'tiff'\n};\n/**\n * Returns an extension a typical file in the specified `mimeType` format would have.\n */\nfunction convertMimeTypeToExtension(mimeType) {\n  return MIME_TO_EXTENSION[mimeType];\n}\n/**\n * Tries to fetch the given `url` and returns 'content-type' of the response.\n */\nasync function getContentTypeOfUrl(url, options) {\n  try {\n    const response = await fetch(url, {\n      method: 'HEAD',\n      cache: 'force-cache',\n      ...options\n    });\n    if (!response.ok) {\n      return '';\n    }\n    return response.headers.get('content-type') || '';\n  } catch {\n    return '';\n  }\n}\n/**\n * Returns an extension from the given value.\n */\nfunction getFileExtension(file) {\n  const fileName = file.name;\n  const extensionRegExp = /\\.(?<ext>[^.]+)$/;\n  const match = fileName.match(extensionRegExp);\n  return match.groups.ext.toLowerCase();\n}\n\n// Defines the waiting time (in milliseconds) for inserting the chosen asset into the model. The chosen asset is temporarily stored in the\n// `CKBoxCommand#_chosenAssets` and it is removed from there automatically after this time. See `CKBoxCommand#_chosenAssets` for more\n// details.\nconst ASSET_INSERTION_WAIT_TIMEOUT = 1000;\n/**\n * The CKBox command. It is used by the {@link module:ckbox/ckboxediting~CKBoxEditing CKBox editing feature} to open the CKBox file manager.\n * The file manager allows inserting an image or a link to a file into the editor content.\n *\n * ```ts\n * editor.execute( 'ckbox' );\n * ```\n *\n * **Note:** This command uses other features to perform the following tasks:\n * - To insert images it uses the {@link module:image/image/insertimagecommand~InsertImageCommand 'insertImage'} command from the\n * {@link module:image/image~Image Image feature}.\n * - To insert links to other files it uses the {@link module:link/linkcommand~LinkCommand 'link'} command from the\n * {@link module:link/link~Link Link feature}.\n */\nclass CKBoxCommand extends Command {\n  /**\n  * A set of all chosen assets. They are stored temporarily and they are automatically removed 1 second after being chosen.\n  * Chosen assets have to be \"remembered\" for a while to be able to map the given asset with the element inserted into the model.\n  * This association map is then used to set the ID on the model element.\n  *\n  * All chosen assets are automatically removed after the timeout, because (theoretically) it may happen that they will never be\n  * inserted into the model, even if the {@link module:link/linkcommand~LinkCommand `'link'`} command or the\n  * {@link module:image/image/insertimagecommand~InsertImageCommand `'insertImage'`} command is enabled. Such a case may arise when\n  * another plugin blocks the command execution. Then, in order not to keep the chosen (but not inserted) assets forever, we delete\n  * them automatically to prevent memory leakage. The 1 second timeout is enough to insert the asset into the model and extract the\n  * ID from the chosen asset.\n  *\n  * The assets are stored only if\n  * the {@link module:ckbox/ckboxconfig~CKBoxConfig#ignoreDataId `config.ckbox.ignoreDataId`} option is set to `false` (by default).\n  *\n  * @internal\n  */\n  _chosenAssets = new Set();\n  /**\n  * The DOM element that acts as a mounting point for the CKBox dialog.\n  */\n  _wrapper = null;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._initListeners();\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.value = this._getValue();\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    this.fire('ckbox:open');\n  }\n  /**\n  * Indicates if the CKBox dialog is already opened.\n  *\n  * @protected\n  * @returns {Boolean}\n  */\n  _getValue() {\n    return this._wrapper !== null;\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  */\n  _checkEnabled() {\n    const imageCommand = this.editor.commands.get('insertImage');\n    const linkCommand = this.editor.commands.get('link');\n    if (!imageCommand.isEnabled && !linkCommand.isEnabled) {\n      return false;\n    }\n    return true;\n  }\n  /**\n  * Creates the options object for the CKBox dialog.\n  *\n  * @returns The object with properties:\n  * - theme The theme for CKBox dialog.\n  * - language The language for CKBox dialog.\n  * - tokenUrl The token endpoint URL.\n  * - serviceOrigin The base URL of the API service.\n  * - forceDemoLabel Whether to force \"Powered by CKBox\" link.\n  * - assets.onChoose The callback function invoked after choosing the assets.\n  * - dialog.onClose The callback function invoked after closing the CKBox dialog.\n  * - dialog.width The dialog width in pixels.\n  * - dialog.height The dialog height in pixels.\n  * - categories.icons Allows setting custom icons for categories.\n  * - view.openLastView Sets if the last view visited by the user will be reopened\n  * on the next startup.\n  * - view.startupFolderId Sets the ID of the folder that will be opened on startup.\n  * - view.startupCategoryId Sets the ID of the category that will be opened on startup.\n  * - view.hideMaximizeButton Sets whether to hide the â€˜Maximizeâ€™ button.\n  * - view.componentsHideTimeout Sets timeout after which upload components are hidden\n  * after completed upload.\n  * - view.dialogMinimizeTimeout Sets timeout after which upload dialog is minimized\n  * after completed upload.\n  */\n  _prepareOptions() {\n    const editor = this.editor;\n    const ckboxConfig = editor.config.get('ckbox');\n    const dialog = ckboxConfig.dialog;\n    const categories = ckboxConfig.categories;\n    const view = ckboxConfig.view;\n    const upload = ckboxConfig.upload;\n    return {\n      theme: ckboxConfig.theme,\n      language: ckboxConfig.language,\n      tokenUrl: ckboxConfig.tokenUrl,\n      serviceOrigin: ckboxConfig.serviceOrigin,\n      forceDemoLabel: ckboxConfig.forceDemoLabel,\n      choosableFileExtensions: ckboxConfig.choosableFileExtensions,\n      assets: {\n        onChoose: assets => this.fire('ckbox:choose', assets)\n      },\n      dialog: {\n        onClose: () => this.fire('ckbox:close'),\n        width: dialog && dialog.width,\n        height: dialog && dialog.height\n      },\n      categories: categories && {\n        icons: categories.icons\n      },\n      view: view && {\n        openLastView: view.openLastView,\n        startupFolderId: view.startupFolderId,\n        startupCategoryId: view.startupCategoryId,\n        hideMaximizeButton: view.hideMaximizeButton\n      },\n      upload: upload && {\n        componentsHideTimeout: upload.componentsHideTimeout,\n        dialogMinimizeTimeout: upload.dialogMinimizeTimeout\n      }\n    };\n  }\n  /**\n  * Initializes various event listeners for the `ckbox:*` events, because all functionality of the `ckbox` command is event-based.\n  */\n  _initListeners() {\n    const editor = this.editor;\n    const model = editor.model;\n    const shouldInsertDataId = !editor.config.get('ckbox.ignoreDataId');\n    const downloadableFilesConfig = editor.config.get('ckbox.downloadableFiles');\n    // Refresh the command after firing the `ckbox:*` event.\n    this.on('ckbox', () => {\n      this.refresh();\n    }, {\n      priority: 'low'\n    });\n    // Handle opening of the CKBox dialog.\n    this.on('ckbox:open', () => {\n      if (!this.isEnabled || this.value) {\n        return;\n      }\n      this._wrapper = createElement(document, 'div', {\n        class: 'ck ckbox-wrapper'\n      });\n      document.body.appendChild(this._wrapper);\n      window.CKBox.mount(this._wrapper, this._prepareOptions());\n    });\n    // Handle closing of the CKBox dialog.\n    this.on('ckbox:close', () => {\n      if (!this.value) {\n        return;\n      }\n      this._wrapper.remove();\n      this._wrapper = null;\n      editor.editing.view.focus();\n    });\n    // Handle choosing the assets.\n    this.on('ckbox:choose', (evt, assets) => {\n      if (!this.isEnabled) {\n        return;\n      }\n      const imageCommand = editor.commands.get('insertImage');\n      const linkCommand = editor.commands.get('link');\n      const assetsToProcess = prepareAssets({\n        assets,\n        downloadableFilesConfig,\n        isImageAllowed: imageCommand.isEnabled,\n        isLinkAllowed: linkCommand.isEnabled\n      });\n      const assetsCount = assetsToProcess.length;\n      if (assetsCount === 0) {\n        return;\n      }\n      // All assets are inserted in one undo step.\n      model.change(writer => {\n        for (const asset of assetsToProcess) {\n          const isLastAsset = asset === assetsToProcess[assetsCount - 1];\n          const isSingleAsset = assetsCount === 1;\n          this._insertAsset(asset, isLastAsset, writer, isSingleAsset);\n          // If asset ID must be set for the inserted model element, store the asset temporarily and remove it automatically\n          // after the timeout.\n          if (shouldInsertDataId) {\n            setTimeout(() => this._chosenAssets.delete(asset), ASSET_INSERTION_WAIT_TIMEOUT);\n            this._chosenAssets.add(asset);\n          }\n        }\n      });\n      editor.editing.view.focus();\n    });\n    // Clean up after the editor is destroyed.\n    this.listenTo(editor, 'destroy', () => {\n      this.fire('ckbox:close');\n      this._chosenAssets.clear();\n    });\n  }\n  /**\n  * Inserts the asset into the model.\n  *\n  * @param asset The asset to be inserted.\n  * @param isLastAsset Indicates if the current asset is the last one from the chosen set.\n  * @param writer An instance of the model writer.\n  * @param isSingleAsset It's true when only one asset is processed.\n  */\n  _insertAsset(asset, isLastAsset, writer, isSingleAsset) {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    // Remove the `linkHref` attribute to not affect the asset to be inserted.\n    writer.removeSelectionAttribute('linkHref');\n    if (asset.type === 'image') {\n      this._insertImage(asset);\n    } else {\n      this._insertLink(asset, writer, isSingleAsset);\n    }\n    // Except for the last chosen asset, move the selection to the end of the current range to avoid overwriting other, already\n    // inserted assets.\n    if (!isLastAsset) {\n      writer.setSelection(selection.getLastPosition());\n    }\n  }\n  /**\n  * Inserts the image by calling the `insertImage` command.\n  *\n  * @param asset The asset to be inserted.\n  */\n  _insertImage(asset) {\n    const editor = this.editor;\n    const {\n      imageFallbackUrl,\n      imageSources,\n      imageTextAlternative,\n      imageWidth,\n      imageHeight,\n      imagePlaceholder\n    } = asset.attributes;\n    editor.execute('insertImage', {\n      source: {\n        src: imageFallbackUrl,\n        sources: imageSources,\n        alt: imageTextAlternative,\n        width: imageWidth,\n        height: imageHeight,\n        ...(imagePlaceholder ? {\n          placeholder: imagePlaceholder\n        } : null)\n      }\n    });\n  }\n  /**\n  * Inserts the link to the asset by calling the `link` command.\n  *\n  * @param asset The asset to be inserted.\n  * @param writer An instance of the model writer.\n  * @param isSingleAsset It's true when only one asset is processed.\n  */\n  _insertLink(asset, writer, isSingleAsset) {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    const {\n      linkName,\n      linkHref\n    } = asset.attributes;\n    // If the selection is collapsed, insert the asset name as the link label and select it.\n    if (selection.isCollapsed) {\n      const selectionAttributes = toMap(selection.getAttributes());\n      const textNode = writer.createText(linkName, selectionAttributes);\n      if (!isSingleAsset) {\n        const selectionLastPosition = selection.getLastPosition();\n        const parentElement = selectionLastPosition.parent;\n        // Insert new `paragraph` when selection is not in an empty `paragraph`.\n        if (!(parentElement.name === 'paragraph' && parentElement.isEmpty)) {\n          editor.execute('insertParagraph', {\n            position: selectionLastPosition\n          });\n        }\n        const range = model.insertContent(textNode);\n        writer.setSelection(range);\n        editor.execute('link', linkHref);\n        return;\n      }\n      const range = model.insertContent(textNode);\n      writer.setSelection(range);\n    }\n    editor.execute('link', linkHref);\n  }\n}\n/**\n * Parses the chosen assets into the internal data format. Filters out chosen assets that are not allowed.\n */\nfunction prepareAssets({\n  downloadableFilesConfig,\n  assets,\n  isImageAllowed,\n  isLinkAllowed\n}) {\n  return assets.map(asset => isImage(asset) ? {\n    id: asset.data.id,\n    type: 'image',\n    attributes: prepareImageAssetAttributes(asset)\n  } : {\n    id: asset.data.id,\n    type: 'link',\n    attributes: prepareLinkAssetAttributes(asset, downloadableFilesConfig)\n  }).filter(asset => asset.type === 'image' ? isImageAllowed : isLinkAllowed);\n}\n/**\n * Parses the assets attributes into the internal data format.\n *\n * @internal\n */\nfunction prepareImageAssetAttributes(asset) {\n  const {\n    imageFallbackUrl,\n    imageSources\n  } = getImageUrls(asset.data.imageUrls);\n  const {\n    description,\n    width,\n    height,\n    blurHash\n  } = asset.data.metadata;\n  const imagePlaceholder = blurHashToDataUrl(blurHash);\n  return {\n    imageFallbackUrl,\n    imageSources,\n    imageTextAlternative: description || '',\n    imageWidth: width,\n    imageHeight: height,\n    ...(imagePlaceholder ? {\n      imagePlaceholder\n    } : null)\n  };\n}\n/**\n * Parses the assets attributes into the internal data format.\n *\n * @param asset The asset to prepare the attributes for.\n * @param config The CKBox download asset configuration.\n */\nfunction prepareLinkAssetAttributes(asset, config) {\n  return {\n    linkName: asset.data.name,\n    linkHref: getAssetUrl(asset, config)\n  };\n}\n/**\n * Checks whether the asset is an image.\n */\nfunction isImage(asset) {\n  const metadata = asset.data.metadata;\n  if (!metadata) {\n    return false;\n  }\n  return metadata.width && metadata.height;\n}\n/**\n * Creates the URL for the asset.\n *\n * @param asset The asset to create the URL for.\n * @param config The CKBox download asset configuration.\n */\nfunction getAssetUrl(asset, config) {\n  const url = new URL(asset.data.url);\n  if (isDownloadableAsset(asset, config)) {\n    url.searchParams.set('download', 'true');\n  }\n  return url.toString();\n}\n/**\n * Determines if download should be enabled for given asset based on configuration.\n *\n * @param asset The asset to check.\n * @param config The CKBox download asset configuration.\n */\nfunction isDownloadableAsset(asset, config) {\n  if (typeof config === 'function') {\n    return config(asset);\n  }\n  return true;\n}\nconst DEFAULT_CKBOX_THEME_NAME = 'lark';\n/**\n * The CKBox utilities plugin.\n */\nclass CKBoxUtils extends Plugin {\n  /**\n  * CKEditor Cloud Services access token.\n  */\n  _token;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKBoxUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return ['CloudServices'];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const hasConfiguration = !!editor.config.get('ckbox');\n    const isLibraryLoaded = !!window.CKBox;\n    // Proceed with plugin initialization only when the integrator intentionally wants to use it, i.e. when the `config.ckbox` exists or\n    // the CKBox JavaScript library is loaded.\n    if (!hasConfiguration && !isLibraryLoaded) {\n      return;\n    }\n    editor.config.define('ckbox', {\n      serviceOrigin: 'https://api.ckbox.io',\n      defaultUploadCategories: null,\n      ignoreDataId: false,\n      language: editor.locale.uiLanguage,\n      theme: DEFAULT_CKBOX_THEME_NAME,\n      tokenUrl: editor.config.get('cloudServices.tokenUrl')\n    });\n    const cloudServices = editor.plugins.get('CloudServices');\n    const cloudServicesTokenUrl = editor.config.get('cloudServices.tokenUrl');\n    const ckboxTokenUrl = editor.config.get('ckbox.tokenUrl');\n    if (!ckboxTokenUrl) {\n      /**\n      * The {@link module:ckbox/ckboxconfig~CKBoxConfig#tokenUrl `config.ckbox.tokenUrl`} or the\n      * {@link module:cloud-services/cloudservicesconfig~CloudServicesConfig#tokenUrl `config.cloudServices.tokenUrl`}\n      * configuration is required for the CKBox plugin.\n      *\n      * ```ts\n      * ClassicEditor.create( document.createElement( 'div' ), {\n      * \tckbox: {\n      * \t\ttokenUrl: \"YOUR_TOKEN_URL\"\n      * \t\t// ...\n      * \t}\n      * \t// ...\n      * } );\n      * ```\n      *\n      * @error ckbox-plugin-missing-token-url\n      */\n      throw new CKEditorError('ckbox-plugin-missing-token-url', this);\n    }\n    if (ckboxTokenUrl == cloudServicesTokenUrl) {\n      this._token = Promise.resolve(cloudServices.token);\n    } else {\n      this._token = cloudServices.registerTokenUrl(ckboxTokenUrl);\n    }\n    // Grant access to private categories after token is fetched. This is done within the same promise chain\n    // to ensure all services using the token have access to private categories.\n    // This step is critical as previewing images from private categories requires proper cookies.\n    this._token = this._token.then(async token => {\n      await this._authorizePrivateCategoriesAccess(token.value);\n      return token;\n    });\n  }\n  /**\n  * Returns a token used by the CKBox plugin for communication with the CKBox service.\n  */\n  getToken() {\n    return this._token;\n  }\n  /**\n  * The ID of workspace to use when uploading an image.\n  */\n  async getWorkspaceId() {\n    const t = this.editor.t;\n    const cannotAccessDefaultWorkspaceError = t('Cannot access default workspace.');\n    const defaultWorkspaceId = this.editor.config.get('ckbox.defaultUploadWorkspaceId');\n    const workspaceId = getWorkspaceId(await this._token, defaultWorkspaceId);\n    if (workspaceId == null) {\n      /**\n      * The user is not authorized to access the workspace defined in  the`ckbox.defaultUploadWorkspaceId` configuration.\n      *\n      * @error ckbox-access-default-workspace-error\n      */\n      logError('ckbox-access-default-workspace-error');\n      throw cannotAccessDefaultWorkspaceError;\n    }\n    return workspaceId;\n  }\n  /**\n  * Resolves a promise with an object containing a category with which the uploaded file is associated or an error code.\n  */\n  async getCategoryIdForFile(fileOrUrl, options) {\n    const t = this.editor.t;\n    const cannotFindCategoryError = t('Cannot determine a category for the uploaded file.');\n    const defaultCategories = this.editor.config.get('ckbox.defaultUploadCategories');\n    const allCategoriesPromise = this._getAvailableCategories(options);\n    const extension = typeof fileOrUrl == 'string' ? convertMimeTypeToExtension(await getContentTypeOfUrl(fileOrUrl, options)) : getFileExtension(fileOrUrl);\n    const allCategories = await allCategoriesPromise;\n    // Couldn't fetch all categories. Perhaps the authorization token is invalid.\n    if (!allCategories) {\n      throw cannotFindCategoryError;\n    }\n    // If a user specifies the plugin configuration, find the first category that accepts the uploaded file.\n    if (defaultCategories) {\n      const userCategory = Object.keys(defaultCategories).find(category => {\n        return defaultCategories[category].find(e => e.toLowerCase() == extension);\n      });\n      // If found, return its ID if the category exists on the server side.\n      if (userCategory) {\n        const serverCategory = allCategories.find(category => category.id === userCategory || category.name === userCategory);\n        if (!serverCategory) {\n          throw cannotFindCategoryError;\n        }\n        return serverCategory.id;\n      }\n    }\n    // Otherwise, find the first category that accepts the uploaded file and returns its ID.\n    const category = allCategories.find(category => category.extensions.find(e => e.toLowerCase() == extension));\n    if (!category) {\n      throw cannotFindCategoryError;\n    }\n    return category.id;\n  }\n  /**\n  * Resolves a promise with an array containing available categories with which the uploaded file can be associated.\n  *\n  * If the API returns limited results, the method will collect all items.\n  */\n  async _getAvailableCategories(options) {\n    const ITEMS_PER_REQUEST = 50;\n    const editor = this.editor;\n    const token = this._token;\n    const {\n      signal\n    } = options;\n    const serviceOrigin = editor.config.get('ckbox.serviceOrigin');\n    const workspaceId = await this.getWorkspaceId();\n    try {\n      const result = [];\n      let offset = 0;\n      let remainingItems;\n      do {\n        const data = await fetchCategories(offset);\n        result.push(...data.items);\n        remainingItems = data.totalCount - (offset + ITEMS_PER_REQUEST);\n        offset += ITEMS_PER_REQUEST;\n      } while (remainingItems > 0);\n      return result;\n    } catch {\n      signal.throwIfAborted();\n      /**\n      * Fetching a list of available categories with which an uploaded file can be associated failed.\n      *\n      * @error ckbox-fetch-category-http-error\n      */\n      logError('ckbox-fetch-category-http-error');\n      return undefined;\n    }\n    async function fetchCategories(offset) {\n      const categoryUrl = new URL('categories', serviceOrigin);\n      categoryUrl.searchParams.set('limit', String(ITEMS_PER_REQUEST));\n      categoryUrl.searchParams.set('offset', String(offset));\n      categoryUrl.searchParams.set('workspaceId', workspaceId);\n      return sendHttpRequest({\n        url: categoryUrl,\n        signal,\n        authorization: (await token).value\n      });\n    }\n  }\n  /**\n  * Authorize private categories access to the CKBox service. Request sets cookie for the current domain,\n  * that allows user to preview images from private categories.\n  */\n  async _authorizePrivateCategoriesAccess(token) {\n    const serviceUrl = this.editor.config.get('ckbox.serviceOrigin');\n    const formData = new FormData();\n    formData.set('token', token);\n    await fetch(`${serviceUrl}/categories/authorizePrivateAccess`, {\n      method: 'POST',\n      credentials: 'include',\n      mode: 'no-cors',\n      body: formData\n    });\n  }\n}\n\n/**\n * A plugin that enables file uploads in CKEditor 5 using the CKBox serverâ€“side connector.\n * See the {@glink features/file-management/ckbox CKBox file manager integration} guide to learn how to configure\n * and use this feature as well as find out more about the full integration with the file manager\n * provided by the {@link module:ckbox/ckbox~CKBox} plugin.\n *\n * Check out the {@glink features/images/image-upload/image-upload Image upload overview} guide to learn about\n * other ways to upload images into CKEditor 5.\n */\nclass CKBoxUploadAdapter extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return ['ImageUploadEditing', 'ImageUploadProgress', FileRepository, CKBoxEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKBoxUploadAdapter';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  async afterInit() {\n    const editor = this.editor;\n    const hasConfiguration = !!editor.config.get('ckbox');\n    const isLibraryLoaded = !!window.CKBox;\n    // Editor supports only one upload adapter. Register the CKBox upload adapter (and potentially overwrite other one) only when the\n    // integrator intentionally wants to use the CKBox plugin, i.e. when the `config.ckbox` exists or the CKBox JavaScript library is\n    // loaded.\n    if (!hasConfiguration && !isLibraryLoaded) {\n      return;\n    }\n    const fileRepository = editor.plugins.get(FileRepository);\n    const ckboxUtils = editor.plugins.get(CKBoxUtils);\n    fileRepository.createUploadAdapter = loader => new Adapter(loader, editor, ckboxUtils);\n    const shouldInsertDataId = !editor.config.get('ckbox.ignoreDataId');\n    const imageUploadEditing = editor.plugins.get('ImageUploadEditing');\n    // Mark uploaded assets with the `ckboxImageId` attribute. Its value represents an ID in CKBox.\n    if (shouldInsertDataId) {\n      imageUploadEditing.on('uploadComplete', (evt, {\n        imageElement,\n        data\n      }) => {\n        editor.model.change(writer => {\n          writer.setAttribute('ckboxImageId', data.ckboxImageId, imageElement);\n        });\n      });\n    }\n  }\n}\n/**\n * Upload adapter for CKBox.\n */\nclass Adapter {\n  /**\n  * FileLoader instance to use during the upload.\n  */\n  loader;\n  /**\n  * CKEditor Cloud Services access token.\n  */\n  token;\n  /**\n  * The editor instance.\n  */\n  editor;\n  /**\n  * The abort controller for aborting asynchronous processes.\n  */\n  controller;\n  /**\n  * The base URL where all requests should be sent.\n  */\n  serviceOrigin;\n  /**\n  * The reference to CKBoxUtils plugin.\n  */\n  ckboxUtils;\n  /**\n  * Creates a new adapter instance.\n  */\n  constructor(loader, editor, ckboxUtils) {\n    this.loader = loader;\n    this.token = ckboxUtils.getToken();\n    this.ckboxUtils = ckboxUtils;\n    this.editor = editor;\n    this.controller = new AbortController();\n    this.serviceOrigin = editor.config.get('ckbox.serviceOrigin');\n  }\n  /**\n  * Starts the upload process.\n  *\n  * @see module:upload/filerepository~UploadAdapter#upload\n  */\n  async upload() {\n    const ckboxUtils = this.ckboxUtils;\n    const t = this.editor.t;\n    const file = await this.loader.file;\n    const category = await ckboxUtils.getCategoryIdForFile(file, {\n      signal: this.controller.signal\n    });\n    const uploadUrl = new URL('assets', this.serviceOrigin);\n    const formData = new FormData();\n    uploadUrl.searchParams.set('workspaceId', await ckboxUtils.getWorkspaceId());\n    formData.append('categoryId', category);\n    formData.append('file', file);\n    const requestConfig = {\n      method: 'POST',\n      url: uploadUrl,\n      data: formData,\n      onUploadProgress: evt => {\n        /* istanbul ignore else -- @preserve */if (evt.lengthComputable) {\n          this.loader.uploadTotal = evt.total;\n          this.loader.uploaded = evt.loaded;\n        }\n      },\n      signal: this.controller.signal,\n      authorization: (await this.token).value\n    };\n    return sendHttpRequest(requestConfig).then(async data => {\n      const imageUrls = getImageUrls(data.imageUrls);\n      return {\n        ckboxImageId: data.id,\n        default: imageUrls.imageFallbackUrl,\n        sources: imageUrls.imageSources\n      };\n    }).catch(() => {\n      const genericError = t('Cannot upload file:') + ` ${file.name}.`;\n      return Promise.reject(genericError);\n    });\n  }\n  /**\n  * Aborts the upload process.\n  *\n  * @see module:upload/filerepository~UploadAdapter#abort\n  */\n  abort() {\n    this.controller.abort();\n  }\n}\nconst COMMAND_FORCE_DISABLE_ID = 'NoPermission';\n/**\n * The CKBox editing feature. It introduces the {@link module:ckbox/ckboxcommand~CKBoxCommand CKBox command} and\n * {@link module:ckbox/ckboxuploadadapter~CKBoxUploadAdapter CKBox upload adapter}.\n */\nclass CKBoxEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKBoxEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return ['LinkEditing', 'PictureEditing', CKBoxUploadAdapter, CKBoxUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!this._shouldBeInitialised()) {\n      return;\n    }\n    this._checkImagePlugins();\n    // Registering the `ckbox` command makes sense only if the CKBox library is loaded, as the `ckbox` command opens the CKBox dialog.\n    if (isLibraryLoaded()) {\n      editor.commands.add('ckbox', new CKBoxCommand(editor));\n    }\n    // Promise is not handled intentionally. Errors should be displayed in console if there are so.\n    isUploadPermissionGranted(editor).then(isCreateAssetAllowed => {\n      if (!isCreateAssetAllowed) {\n        this._blockImageCommands();\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    if (!this._shouldBeInitialised()) {\n      return;\n    }\n    // Extending the schema, registering converters and applying fixers only make sense if the configuration option to assign\n    // the assets ID with the model elements is enabled.\n    if (!editor.config.get('ckbox.ignoreDataId')) {\n      this._initSchema();\n      this._initConversion();\n      this._initFixers();\n    }\n  }\n  /**\n  * Returns true only when the integrator intentionally wants to use the plugin, i.e. when the `config.ckbox` exists or\n  * the CKBox JavaScript library is loaded.\n  */\n  _shouldBeInitialised() {\n    const editor = this.editor;\n    const hasConfiguration = !!editor.config.get('ckbox');\n    return hasConfiguration || isLibraryLoaded();\n  }\n  /**\n  * Blocks `uploadImage` and `ckboxImageEdit` commands.\n  */\n  _blockImageCommands() {\n    const editor = this.editor;\n    const uploadImageCommand = editor.commands.get('uploadImage');\n    const imageEditingCommand = editor.commands.get('ckboxImageEdit');\n    if (uploadImageCommand) {\n      uploadImageCommand.isAccessAllowed = false;\n      uploadImageCommand.forceDisabled(COMMAND_FORCE_DISABLE_ID);\n    }\n    if (imageEditingCommand) {\n      imageEditingCommand.forceDisabled(COMMAND_FORCE_DISABLE_ID);\n    }\n  }\n  /**\n  * Checks if at least one image plugin is loaded.\n  */\n  _checkImagePlugins() {\n    const editor = this.editor;\n    if (!editor.plugins.has('ImageBlockEditing') && !editor.plugins.has('ImageInlineEditing')) {\n      /**\n      * The CKBox feature requires one of the following plugins to be loaded to work correctly:\n      *\n      * * {@link module:image/imageblock~ImageBlock},\n      * * {@link module:image/imageinline~ImageInline},\n      * * {@link module:image/image~Image} (loads both `ImageBlock` and `ImageInline`)\n      *\n      * Please make sure your editor configuration is correct.\n      *\n      * @error ckbox-plugin-image-feature-missing\n      * @param {module:core/editor/editor~Editor} editor\n      */\n      logError('ckbox-plugin-image-feature-missing', editor);\n    }\n  }\n  /**\n  * Extends the schema to allow the `ckboxImageId` and `ckboxLinkId` attributes for links and images.\n  */\n  _initSchema() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    schema.extend('$text', {\n      allowAttributes: 'ckboxLinkId'\n    });\n    if (schema.isRegistered('imageBlock')) {\n      schema.extend('imageBlock', {\n        allowAttributes: ['ckboxImageId', 'ckboxLinkId']\n      });\n    }\n    if (schema.isRegistered('imageInline')) {\n      schema.extend('imageInline', {\n        allowAttributes: ['ckboxImageId', 'ckboxLinkId']\n      });\n    }\n    schema.addAttributeCheck(context => {\n      // Don't allow `ckboxLinkId` on elements which do not have `linkHref` attribute.\n      if (!context.last.getAttribute('linkHref')) {\n        return false;\n      }\n    }, 'ckboxLinkId');\n  }\n  /**\n  * Configures the upcast and downcast conversions for the `ckboxImageId` and `ckboxLinkId` attributes.\n  */\n  _initConversion() {\n    const editor = this.editor;\n    // Convert `ckboxLinkId` => `data-ckbox-resource-id`.\n    editor.conversion.for('downcast').add(dispatcher => {\n      // Due to custom converters for linked block images, handle the `ckboxLinkId` attribute manually.\n      dispatcher.on('attribute:ckboxLinkId:imageBlock', (evt, data, conversionApi) => {\n        const {\n          writer,\n          mapper,\n          consumable\n        } = conversionApi;\n        if (!consumable.consume(data.item, evt.name)) {\n          return;\n        }\n        const viewFigure = mapper.toViewElement(data.item);\n        const linkInImage = [...viewFigure.getChildren()].find(child => child.name === 'a');\n        // No link inside an image - no conversion needed.\n        if (!linkInImage) {\n          return;\n        }\n        if (data.item.hasAttribute('ckboxLinkId')) {\n          writer.setAttribute('data-ckbox-resource-id', data.item.getAttribute('ckboxLinkId'), linkInImage);\n        } else {\n          writer.removeAttribute('data-ckbox-resource-id', linkInImage);\n        }\n      }, {\n        priority: 'low'\n      });\n      dispatcher.on('attribute:ckboxLinkId', (evt, data, conversionApi) => {\n        const {\n          writer,\n          mapper,\n          consumable\n        } = conversionApi;\n        if (!consumable.consume(data.item, evt.name)) {\n          return;\n        }\n        // Remove the previous attribute value if it was applied.\n        if (data.attributeOldValue) {\n          const viewElement = createLinkElement(writer, data.attributeOldValue);\n          writer.unwrap(mapper.toViewRange(data.range), viewElement);\n        }\n        // Add the new attribute value if specified in a model element.\n        if (data.attributeNewValue) {\n          const viewElement = createLinkElement(writer, data.attributeNewValue);\n          if (data.item.is('selection')) {\n            const viewSelection = writer.document.selection;\n            writer.wrap(viewSelection.getFirstRange(), viewElement);\n          } else {\n            writer.wrap(mapper.toViewRange(data.range), viewElement);\n          }\n        }\n      }, {\n        priority: 'low'\n      });\n    });\n    // Convert `data-ckbox-resource-id` => `ckboxLinkId`.\n    //\n    // The helper conversion does not handle all cases, so take care of the `data-ckbox-resource-id` attribute manually for images\n    // and links.\n    editor.conversion.for('upcast').add(dispatcher => {\n      dispatcher.on('element:a', (evt, data, conversionApi) => {\n        const {\n          writer,\n          consumable\n        } = conversionApi;\n        // Upcast the `data-ckbox-resource-id` attribute only for valid link elements.\n        if (!data.viewItem.getAttribute('href')) {\n          return;\n        }\n        const consumableAttributes = {\n          attributes: ['data-ckbox-resource-id']\n        };\n        if (!consumable.consume(data.viewItem, consumableAttributes)) {\n          return;\n        }\n        const attributeValue = data.viewItem.getAttribute('data-ckbox-resource-id');\n        // Missing the `data-ckbox-resource-id` attribute.\n        if (!attributeValue) {\n          return;\n        }\n        if (data.modelRange) {\n          // If the `<a>` element contains more than single children (e.g. a linked image), set the `ckboxLinkId` for each\n          // allowed child.\n          for (let item of data.modelRange.getItems()) {\n            if (item.is('$textProxy')) {\n              item = item.textNode;\n            }\n            // Do not copy the `ckboxLinkId` attribute when wrapping an element in a block element, e.g. when\n            // auto-paragraphing.\n            if (shouldUpcastAttributeForNode(item)) {\n              writer.setAttribute('ckboxLinkId', attributeValue, item);\n            }\n          }\n        } else {\n          // Otherwise, just set the `ckboxLinkId` for the model element.\n          const modelElement = data.modelCursor.nodeBefore || data.modelCursor.parent;\n          writer.setAttribute('ckboxLinkId', attributeValue, modelElement);\n        }\n      }, {\n        priority: 'low'\n      });\n    });\n    // Convert `ckboxImageId` => `data-ckbox-resource-id`.\n    editor.conversion.for('downcast').attributeToAttribute({\n      model: 'ckboxImageId',\n      view: 'data-ckbox-resource-id'\n    });\n    // Convert `data-ckbox-resource-id` => `ckboxImageId`.\n    editor.conversion.for('upcast').elementToAttribute({\n      model: {\n        key: 'ckboxImageId',\n        value: viewElement => viewElement.getAttribute('data-ckbox-resource-id')\n      },\n      view: {\n        attributes: {\n          'data-ckbox-resource-id': /[\\s\\S]+/\n        }\n      }\n    });\n    const replaceImageSourceCommand = editor.commands.get('replaceImageSource');\n    if (replaceImageSourceCommand) {\n      this.listenTo(replaceImageSourceCommand, 'cleanupImage', (_, [writer, image]) => {\n        writer.removeAttribute('ckboxImageId', image);\n      });\n    }\n  }\n  /**\n  * Registers post-fixers that add or remove the `ckboxLinkId` and `ckboxImageId` attributes.\n  */\n  _initFixers() {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    // Registers the post-fixer to sync the asset ID with the model elements.\n    model.document.registerPostFixer(syncDataIdPostFixer(editor));\n    // Registers the post-fixer to remove the `ckboxLinkId` attribute from the model selection.\n    model.document.registerPostFixer(injectSelectionPostFixer(selection));\n  }\n}\n/**\n * A post-fixer that synchronizes the asset ID with the model element.\n */\nfunction syncDataIdPostFixer(editor) {\n  return writer => {\n    let changed = false;\n    const model = editor.model;\n    const ckboxCommand = editor.commands.get('ckbox');\n    // The ID from chosen assets are stored in the `CKBoxCommand#_chosenAssets`. If there is no command, it makes no sense to check\n    // for changes in the model.\n    if (!ckboxCommand) {\n      return changed;\n    }\n    for (const entry of model.document.differ.getChanges()) {\n      if (entry.type !== 'insert' && entry.type !== 'attribute') {\n        continue;\n      }\n      const range = entry.type === 'insert' ? new Range(entry.position, entry.position.getShiftedBy(entry.length)) : entry.range;\n      const isLinkHrefAttributeRemoval = entry.type === 'attribute' && entry.attributeKey === 'linkHref' && entry.attributeNewValue === null;\n      for (const item of range.getItems()) {\n        // If the `linkHref` attribute has been removed, sync the change with the `ckboxLinkId` attribute.\n        if (isLinkHrefAttributeRemoval && item.hasAttribute('ckboxLinkId')) {\n          writer.removeAttribute('ckboxLinkId', item);\n          changed = true;\n          continue;\n        }\n        // Otherwise, the change concerns either a new model element or an attribute change. Try to find the assets for the modified\n        // model element.\n        const assets = findAssetsForItem(item, ckboxCommand._chosenAssets);\n        for (const asset of assets) {\n          const attributeName = asset.type === 'image' ? 'ckboxImageId' : 'ckboxLinkId';\n          if (asset.id === item.getAttribute(attributeName)) {\n            continue;\n          }\n          writer.setAttribute(attributeName, asset.id, item);\n          changed = true;\n        }\n      }\n    }\n    return changed;\n  };\n}\n/**\n * A post-fixer that removes the `ckboxLinkId` from the selection if it does not represent a link anymore.\n */\nfunction injectSelectionPostFixer(selection) {\n  return writer => {\n    const shouldRemoveLinkIdAttribute = !selection.hasAttribute('linkHref') && selection.hasAttribute('ckboxLinkId');\n    if (shouldRemoveLinkIdAttribute) {\n      writer.removeSelectionAttribute('ckboxLinkId');\n      return true;\n    }\n    return false;\n  };\n}\n/**\n * Tries to find the asset that is associated with the model element by comparing the attributes:\n * - the image fallback URL with the `src` attribute for images,\n * - the link URL with the `href` attribute for links.\n *\n * For any model element, zero, one or more than one asset can be found (e.g. a linked image may be associated with the link asset and the\n * image asset).\n */\nfunction findAssetsForItem(item, assets) {\n  const isImageElement = item.is('element', 'imageInline') || item.is('element', 'imageBlock');\n  const isLinkElement = item.hasAttribute('linkHref');\n  return [...assets].filter(asset => {\n    if (asset.type === 'image' && isImageElement) {\n      return asset.attributes.imageFallbackUrl === item.getAttribute('src');\n    }\n    if (asset.type === 'link' && isLinkElement) {\n      return asset.attributes.linkHref === item.getAttribute('linkHref');\n    }\n  });\n}\n/**\n * Creates view link element with the requested ID.\n */\nfunction createLinkElement(writer, id) {\n  // Priority equal 5 is needed to merge adjacent `<a>` elements together.\n  const viewElement = writer.createAttributeElement('a', {\n    'data-ckbox-resource-id': id\n  }, {\n    priority: 5\n  });\n  writer.setCustomProperty('link', true, viewElement);\n  return viewElement;\n}\n/**\n * Checks if the model element may have the `ckboxLinkId` attribute.\n */\nfunction shouldUpcastAttributeForNode(node) {\n  if (node.is('$text')) {\n    return true;\n  }\n  if (node.is('element', 'imageInline') || node.is('element', 'imageBlock')) {\n    return true;\n  }\n  return false;\n}\n/**\n * Returns true if the CKBox library is loaded, false otherwise.\n */\nfunction isLibraryLoaded() {\n  return !!window.CKBox;\n}\n/**\n * Checks is access allowed to upload assets.\n */\nasync function isUploadPermissionGranted(editor) {\n  const ckboxUtils = editor.plugins.get(CKBoxUtils);\n  const origin = editor.config.get('ckbox.serviceOrigin');\n  const url = new URL('permissions', origin);\n  const {\n    value\n  } = await ckboxUtils.getToken();\n  const response = await sendHttpRequest({\n    url,\n    authorization: value,\n    signal: new AbortController().signal // Aborting is unnecessary.\n  });\n  return Object.values(response).some(category => category['asset:create']);\n}\n\n/**\n * The CKBox feature, a bridge between the CKEditor 5 WYSIWYG editor and the CKBox file manager and uploader.\n *\n * This is a \"glue\" plugin which enables:\n *\n * * {@link module:ckbox/ckboxediting~CKBoxEditing},\n * * {@link module:ckbox/ckboxui~CKBoxUI},\n *\n * See the {@glink features/file-management/ckbox CKBox integration} guide to learn how to configure and use this feature.\n *\n * Check out the {@glink features/images/image-upload/image-upload Image upload} guide to learn about other ways to upload\n * images into CKEditor 5.\n */\nclass CKBox extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKBox';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [CKBoxEditing, CKBoxUI];\n  }\n}\n\n/**\n * @internal\n */\nfunction createEditabilityChecker(allowExternalImagesEditing) {\n  const checkUrl = createUrlChecker(allowExternalImagesEditing);\n  return element => {\n    const isImageElement = element.is('element', 'imageInline') || element.is('element', 'imageBlock');\n    if (!isImageElement) {\n      return false;\n    }\n    if (element.hasAttribute('ckboxImageId')) {\n      return true;\n    }\n    if (element.hasAttribute('src')) {\n      return checkUrl(element.getAttribute('src'));\n    }\n    return false;\n  };\n}\nfunction createUrlChecker(allowExternalImagesEditing) {\n  if (Array.isArray(allowExternalImagesEditing)) {\n    const urlMatchers = allowExternalImagesEditing.map(createUrlChecker);\n    return src => urlMatchers.some(matcher => matcher(src));\n  }\n  if (allowExternalImagesEditing == 'origin') {\n    const origin = global.window.location.origin;\n    return src => new URL(src, global.document.baseURI).origin == origin;\n  }\n  if (typeof allowExternalImagesEditing == 'function') {\n    return allowExternalImagesEditing;\n  }\n  if (allowExternalImagesEditing instanceof RegExp) {\n    return src => !!(src.match(allowExternalImagesEditing) || src.replace(/^https?:\\/\\//, '').match(allowExternalImagesEditing));\n  }\n  return () => false;\n}\n\n/**\n * The CKBox edit image command.\n *\n * Opens the CKBox dialog for editing the image.\n */\nclass CKBoxImageEditCommand extends Command {\n  /**\n  * The DOM element that acts as a mounting point for the CKBox Edit Image dialog.\n  */\n  _wrapper = null;\n  /**\n  * The states of image processing in progress.\n  */\n  _processInProgress = new Set();\n  /**\n  * Determines if the element can be edited.\n  */\n  _canEdit;\n  /**\n  * A wrapper function to prepare mount options. Ensures that at most one preparation is in-flight.\n  */\n  _prepareOptions;\n  /**\n  * CKBox's onClose function runs before the final cleanup, potentially causing\n  * page layout changes after it finishes. To address this, we use a setTimeout hack\n  * to ensure that floating elements on the page maintain their correct position.\n  *\n  * See: https://github.com/ckeditor/ckeditor5/issues/16153.\n  */\n  _updateUiDelayed = delay(() => this.editor.ui.update(), 0);\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this.value = false;\n    this._canEdit = createEditabilityChecker(editor.config.get('ckbox.allowExternalImagesEditing'));\n    this._prepareOptions = abortableDebounce((signal, state) => this._prepareOptionsAbortable(signal, state));\n    this._prepareListeners();\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    this.value = this._getValue();\n    const selectedElement = editor.model.document.selection.getSelectedElement();\n    this.isEnabled = !!selectedElement && this._canEdit(selectedElement) && !this._checkIfElementIsBeingProcessed(selectedElement);\n  }\n  /**\n  * Opens the CKBox Image Editor dialog for editing the image.\n  */\n  execute() {\n    if (this._getValue()) {\n      return;\n    }\n    const wrapper = createElement(document, 'div', {\n      class: 'ck ckbox-wrapper'\n    });\n    this._wrapper = wrapper;\n    this.value = true;\n    document.body.appendChild(this._wrapper);\n    const imageElement = this.editor.model.document.selection.getSelectedElement();\n    const processingState = {\n      element: imageElement,\n      controller: new AbortController()\n    };\n    this._prepareOptions(processingState).then(options => window.CKBox.mountImageEditor(wrapper, options), error => {\n      const editor = this.editor;\n      const t = editor.t;\n      const notification = editor.plugins.get(Notification);\n      notification.showWarning(t('Failed to determine category of edited image.'), {\n        namespace: 'ckbox'\n      });\n      console.error(error);\n      this._handleImageEditorClose();\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    this._handleImageEditorClose();\n    this._prepareOptions.abort();\n    this._updateUiDelayed.cancel();\n    for (const state of this._processInProgress.values()) {\n      state.controller.abort();\n    }\n    super.destroy();\n  }\n  /**\n  * Indicates if the CKBox Image Editor dialog is already opened.\n  */\n  _getValue() {\n    return this._wrapper !== null;\n  }\n  /**\n  * Creates the options object for the CKBox Image Editor dialog.\n  */\n  async _prepareOptionsAbortable(signal, state) {\n    const editor = this.editor;\n    const ckboxConfig = editor.config.get('ckbox');\n    const ckboxUtils = editor.plugins.get(CKBoxUtils);\n    const {\n      element\n    } = state;\n    let imageMountOptions;\n    const ckboxImageId = element.getAttribute('ckboxImageId');\n    if (ckboxImageId) {\n      imageMountOptions = {\n        assetId: ckboxImageId\n      };\n    } else {\n      const imageUrl = new URL(element.getAttribute('src'), document.baseURI).href;\n      const uploadCategoryId = await ckboxUtils.getCategoryIdForFile(imageUrl, {\n        signal\n      });\n      imageMountOptions = {\n        imageUrl,\n        uploadCategoryId\n      };\n    }\n    return {\n      ...imageMountOptions,\n      imageEditing: {\n        allowOverwrite: false\n      },\n      tokenUrl: ckboxConfig.tokenUrl,\n      ...(ckboxConfig.serviceOrigin && {\n        serviceOrigin: ckboxConfig.serviceOrigin\n      }),\n      onClose: () => this._handleImageEditorClose(),\n      onSave: asset => this._handleImageEditorSave(state, asset)\n    };\n  }\n  /**\n  * Initializes event lister for an event of removing an image.\n  */\n  _prepareListeners() {\n    // Abort editing processing when the image has been removed.\n    this.listenTo(this.editor.model.document, 'change:data', () => {\n      const processingStates = this._getProcessingStatesOfDeletedImages();\n      processingStates.forEach(processingState => {\n        processingState.controller.abort();\n      });\n    });\n  }\n  /**\n  * Gets processing states of images that have been deleted in the mean time.\n  */\n  _getProcessingStatesOfDeletedImages() {\n    const states = [];\n    for (const state of this._processInProgress.values()) {\n      if (state.element.root.rootName == '$graveyard') {\n        states.push(state);\n      }\n    }\n    return states;\n  }\n  _checkIfElementIsBeingProcessed(selectedElement) {\n    for (const {\n      element\n    } of this._processInProgress) {\n      if (isEqual(element, selectedElement)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  /**\n  * Closes the CKBox Image Editor dialog.\n  */\n  _handleImageEditorClose() {\n    if (!this._wrapper) {\n      return;\n    }\n    this._wrapper.remove();\n    this._wrapper = null;\n    this.editor.editing.view.focus();\n    this._updateUiDelayed();\n    this.refresh();\n  }\n  /**\n  * Save edited image. In case server respond with \"success\" replace with edited image,\n  * otherwise show notification error.\n  */\n  _handleImageEditorSave(state, asset) {\n    const t = this.editor.locale.t;\n    const notification = this.editor.plugins.get(Notification);\n    const pendingActions = this.editor.plugins.get(PendingActions);\n    const action = pendingActions.add(t('Processing the edited image.'));\n    this._processInProgress.add(state);\n    this._showImageProcessingIndicator(state.element, asset);\n    this.refresh();\n    this._waitForAssetProcessed(asset.data.id, state.controller.signal).then(asset => {\n      this._replaceImage(state.element, asset);\n    }, error => {\n      // Remove processing indicator. It was added only to ViewElement.\n      this.editor.editing.reconvertItem(state.element);\n      if (state.controller.signal.aborted) {\n        return;\n      }\n      if (!error || error instanceof CKEditorError) {\n        notification.showWarning(t('Server failed to process the image.'), {\n          namespace: 'ckbox'\n        });\n      } else {\n        console.error(error);\n      }\n    }).finally(() => {\n      this._processInProgress.delete(state);\n      pendingActions.remove(action);\n      this.refresh();\n    });\n  }\n  /**\n  * Get asset's status on server. If server responds with \"success\" status then\n  * image is already proceeded and ready for saving.\n  */\n  async _getAssetStatusFromServer(id, signal) {\n    const ckboxUtils = this.editor.plugins.get(CKBoxUtils);\n    const url = new URL('assets/' + id, this.editor.config.get('ckbox.serviceOrigin'));\n    const response = await sendHttpRequest({\n      url,\n      signal,\n      authorization: (await ckboxUtils.getToken()).value\n    });\n    const status = response.metadata.metadataProcessingStatus;\n    if (!status || status == 'queued') {\n      /**\n      * Image has not been processed yet.\n      *\n      * @error ckbox-image-not-processed\n      */\n      throw new CKEditorError('ckbox-image-not-processed');\n    }\n    return {\n      data: {\n        ...response\n      }\n    };\n  }\n  /**\n  * Waits for an asset to be processed.\n  * It retries retrieving asset status from the server in case of failure.\n  */\n  async _waitForAssetProcessed(id, signal) {\n    const result = await retry(() => this._getAssetStatusFromServer(id, signal), {\n      signal,\n      maxAttempts: 5\n    });\n    if (result.data.metadata.metadataProcessingStatus != 'success') {\n      /**\n      * The image processing failed.\n      *\n      * @error ckbox-image-processing-failed\n      */\n      throw new CKEditorError('ckbox-image-processing-failed');\n    }\n    return result;\n  }\n  /**\n  * Shows processing indicator while image is processing.\n  *\n  * @param asset Data about certain asset.\n  */\n  _showImageProcessingIndicator(element, asset) {\n    const editor = this.editor;\n    editor.editing.view.change(writer => {\n      const imageElementView = editor.editing.mapper.toViewElement(element);\n      const imageUtils = this.editor.plugins.get('ImageUtils');\n      const img = imageUtils.findViewImgElement(imageElementView);\n      writer.removeStyle('aspect-ratio', img);\n      writer.setAttribute('width', asset.data.metadata.width, img);\n      writer.setAttribute('height', asset.data.metadata.height, img);\n      writer.setStyle('width', `${asset.data.metadata.width}px`, img);\n      writer.setStyle('height', `${asset.data.metadata.height}px`, img);\n      writer.addClass('image-processing', imageElementView);\n    });\n  }\n  /**\n  * Replace the edited image with the new one.\n  */\n  _replaceImage(element, asset) {\n    const editor = this.editor;\n    const {\n      imageFallbackUrl,\n      imageSources,\n      imageWidth,\n      imageHeight,\n      imagePlaceholder\n    } = prepareImageAssetAttributes(asset);\n    const previousSelectionRanges = Array.from(editor.model.document.selection.getRanges());\n    editor.model.change(writer => {\n      writer.setSelection(element, 'on');\n      editor.execute('insertImage', {\n        imageType: element.is('element', 'imageInline') ? 'imageInline' : null,\n        source: {\n          src: imageFallbackUrl,\n          sources: imageSources,\n          width: imageWidth,\n          height: imageHeight,\n          ...(imagePlaceholder ? {\n            placeholder: imagePlaceholder\n          } : null),\n          ...(element.hasAttribute('alt') ? {\n            alt: element.getAttribute('alt')\n          } : null)\n        }\n      });\n      const previousChildren = element.getChildren();\n      element = editor.model.document.selection.getSelectedElement();\n      for (const child of previousChildren) {\n        writer.append(writer.cloneElement(child), element);\n      }\n      writer.setAttribute('ckboxImageId', asset.data.id, element);\n      writer.setSelection(previousSelectionRanges);\n    });\n  }\n}\n\n/**\n * The CKBox image edit editing plugin.\n */\nclass CKBoxImageEditEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKBoxImageEditEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [CKBoxEditing, CKBoxUtils, PendingActions, Notification, 'ImageUtils', 'ImageEditing'];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const {\n      editor\n    } = this;\n    editor.commands.add('ckboxImageEdit', new CKBoxImageEditCommand(editor));\n  }\n}\n\n/**\n * The UI plugin of the CKBox image edit feature.\n *\n * It registers the `'ckboxImageEdit'` UI button in the editor's {@link module:ui/componentfactory~ComponentFactory component factory}\n * that allows you to open the CKBox dialog and edit the image.\n */\nclass CKBoxImageEditUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKBoxImageEditUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('ckboxImageEdit', locale => {\n      const command = editor.commands.get('ckboxImageEdit');\n      const uploadImageCommand = editor.commands.get('uploadImage');\n      const view = new ButtonView(locale);\n      const t = locale.t;\n      view.set({\n        icon: IconCkboxImageEdit,\n        tooltip: true\n      });\n      view.bind('label').to(uploadImageCommand, 'isAccessAllowed', isAccessAllowed => isAccessAllowed ? t('Edit image') : t('You have no image editing permissions.'));\n      view.bind('isOn').to(command, 'value', command, 'isEnabled', (value, isEnabled) => value && isEnabled);\n      view.bind('isEnabled').to(command);\n      // Execute the command.\n      this.listenTo(view, 'execute', () => {\n        editor.execute('ckboxImageEdit');\n        editor.editing.view.focus();\n      });\n      return view;\n    });\n  }\n}\n\n/**\n * The CKBox image edit feature.\n */\nclass CKBoxImageEdit extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKBoxImageEdit';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [CKBoxImageEditEditing, CKBoxImageEditUI];\n  }\n}\nexport { CKBox, CKBoxEditing, CKBoxImageEdit, CKBoxImageEditEditing, CKBoxImageEditUI, CKBoxUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, Command } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView, Notification } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconBrowseFiles, IconImageAssetManager } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { CKEditorError } from '@ckeditor/ckeditor5-utils/dist/index.js';\n\n/**\n * Introduces UI components for `CKFinder` plugin.\n *\n * The plugin introduces two UI components to the {@link module:ui/componentfactory~ComponentFactory UI component factory}:\n *\n * * the `'ckfinder'` toolbar button,\n * * the `'menuBar:ckfinder'` menu bar component, which is by default added to the `'Insert'` menu.\n *\n * It also integrates with the `insertImage` toolbar component and `menuBar:insertImage` menu component.\n */\nclass CKFinderUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKFinderUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('ckfinder', () => this._createFileToolbarButton());\n    editor.ui.componentFactory.add('menuBar:ckfinder', () => this._createFileMenuBarButton());\n    if (editor.plugins.has('ImageInsertUI')) {\n      editor.plugins.get('ImageInsertUI').registerIntegration({\n        name: 'assetManager',\n        observable: () => editor.commands.get('ckfinder'),\n        buttonViewCreator: () => this._createImageToolbarButton(),\n        formViewCreator: () => this._createImageDropdownButton(),\n        menuBarButtonViewCreator: isOnly => this._createImageMenuBarButton(isOnly ? 'insertOnly' : 'insertNested')\n      });\n    }\n  }\n  /**\n  * Creates the base for various kinds of the button component provided by this feature.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const view = new ButtonClass(locale);\n    const command = editor.commands.get('ckfinder');\n    view.bind('isEnabled').to(command);\n    view.on('execute', () => {\n      editor.execute('ckfinder');\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n  /**\n  * Creates a simple toolbar button for files management, with an icon and a tooltip.\n  */\n  _createFileToolbarButton() {\n    const t = this.editor.locale.t;\n    const button = this._createButton(ButtonView);\n    button.icon = IconBrowseFiles;\n    button.label = t('Insert image or file');\n    button.tooltip = true;\n    return button;\n  }\n  /**\n  * Creates a simple toolbar button for images management, with an icon and a tooltip.\n  */\n  _createImageToolbarButton() {\n    const t = this.editor.locale.t;\n    const imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n    const button = this._createButton(ButtonView);\n    button.icon = IconImageAssetManager;\n    button.bind('label').to(imageInsertUI, 'isImageSelected', isImageSelected => isImageSelected ? t('Replace image with file manager') : t('Insert image with file manager'));\n    button.tooltip = true;\n    return button;\n  }\n  /**\n  * Creates a button for images management for the dropdown view, with an icon, text and no tooltip.\n  */\n  _createImageDropdownButton() {\n    const t = this.editor.locale.t;\n    const imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n    const button = this._createButton(ButtonView);\n    button.icon = IconImageAssetManager;\n    button.withText = true;\n    button.bind('label').to(imageInsertUI, 'isImageSelected', isImageSelected => isImageSelected ? t('Replace with file manager') : t('Insert with file manager'));\n    button.on('execute', () => {\n      imageInsertUI.dropdownView.isOpen = false;\n    });\n    return button;\n  }\n  /**\n  * Creates a button for files management for the menu bar.\n  */\n  _createFileMenuBarButton() {\n    const t = this.editor.locale.t;\n    const button = this._createButton(MenuBarMenuListItemButtonView);\n    button.icon = IconBrowseFiles;\n    button.withText = true;\n    button.label = t('File');\n    return button;\n  }\n  /**\n  * Creates a button for images management for the menu bar.\n  */\n  _createImageMenuBarButton(type) {\n    // Use t() stored in a variable with a different name to reuse existing translations from another package.\n    const translateVariableKey = this.editor.locale.t;\n    const t = this.editor.locale.t;\n    const button = this._createButton(MenuBarMenuListItemButtonView);\n    button.icon = IconImageAssetManager;\n    button.withText = true;\n    switch (type) {\n      case 'insertOnly':\n        button.label = translateVariableKey('Image');\n        break;\n      case 'insertNested':\n        button.label = t('With file manager');\n        break;\n    }\n    return button;\n  }\n}\n\n/**\n * The CKFinder command. It is used by the {@link module:ckfinder/ckfinderediting~CKFinderEditing CKFinder editing feature}\n * to open the CKFinder file manager to insert an image or a link to a file into the editor content.\n *\n * ```ts\n * editor.execute( 'ckfinder' );\n * ```\n *\n * **Note:** This command uses other features to perform tasks:\n * - To insert images the {@link module:image/image/insertimagecommand~InsertImageCommand 'insertImage'} command\n * from the {@link module:image/image~Image Image feature}.\n * - To insert links to files the {@link module:link/linkcommand~LinkCommand 'link'} command\n * from the {@link module:link/link~Link Link feature}.\n */\nclass CKFinderCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    // The CKFinder command does not affect data by itself.\n    this.affectsData = false;\n    // Remove default document listener to lower its priority.\n    this.stopListening(this.editor.model.document, 'change');\n    // Lower this command listener priority to be sure that refresh() will be called after link & image refresh.\n    this.listenTo(this.editor.model.document, 'change', () => this.refresh(), {\n      priority: 'low'\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const imageCommand = this.editor.commands.get('insertImage');\n    const linkCommand = this.editor.commands.get('link');\n    // The CKFinder command is enabled when one of image or link command is enabled.\n    this.isEnabled = imageCommand.isEnabled || linkCommand.isEnabled;\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const editor = this.editor;\n    const openerMethod = this.editor.config.get('ckfinder.openerMethod') || 'modal';\n    if (openerMethod != 'popup' && openerMethod != 'modal') {\n      /**\n      * The `ckfinder.openerMethod` must be one of: \"popup\" or \"modal\".\n      *\n      * @error ckfinder-unknown-openermethod\n      */\n      throw new CKEditorError('ckfinder-unknown-openermethod', editor);\n    }\n    const options = this.editor.config.get('ckfinder.options') || {};\n    options.chooseFiles = true;\n    // Cache the user-defined onInit method\n    const originalOnInit = options.onInit;\n    // Pass the lang code to the CKFinder if not defined by user.\n    if (!options.language) {\n      options.language = editor.locale.uiLanguage;\n    }\n    // The onInit method allows to extend CKFinder's behavior. It is used to attach event listeners to file choosing related events.\n    options.onInit = finder => {\n      // Call original options.onInit if it was defined by user.\n      if (originalOnInit) {\n        originalOnInit(finder);\n      }\n      finder.on('files:choose', evt => {\n        const files = evt.data.files.toArray();\n        // Insert links\n        const links = files.filter(file => !file.isImage());\n        const images = files.filter(file => file.isImage());\n        for (const linkFile of links) {\n          editor.execute('link', linkFile.getUrl());\n        }\n        const imagesUrls = [];\n        for (const image of images) {\n          const url = image.getUrl();\n          imagesUrls.push(url ? url : finder.request('file:getProxyUrl', {\n            file: image\n          }));\n        }\n        if (imagesUrls.length) {\n          insertImages(editor, imagesUrls);\n        }\n      });\n      finder.on('file:choose:resizedImage', evt => {\n        const resizedUrl = evt.data.resizedUrl;\n        if (!resizedUrl) {\n          const notification = editor.plugins.get('Notification');\n          const t = editor.locale.t;\n          notification.showWarning(t('Could not obtain resized image URL.'), {\n            title: t('Selecting resized image failed'),\n            namespace: 'ckfinder'\n          });\n          return;\n        }\n        insertImages(editor, [resizedUrl]);\n      });\n    };\n    window.CKFinder[openerMethod](options);\n  }\n}\nfunction insertImages(editor, urls) {\n  const imageCommand = editor.commands.get('insertImage');\n  // Check if inserting an image is actually possible - it might be possible to only insert a link.\n  if (!imageCommand.isEnabled) {\n    const notification = editor.plugins.get('Notification');\n    const t = editor.locale.t;\n    notification.showWarning(t('Could not insert image at the current position.'), {\n      title: t('Inserting image failed'),\n      namespace: 'ckfinder'\n    });\n    return;\n  }\n  editor.execute('insertImage', {\n    source: urls\n  });\n}\n\n/**\n * The CKFinder editing feature. It introduces the {@link module:ckfinder/ckfindercommand~CKFinderCommand CKFinder command}.\n */\nclass CKFinderEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKFinderEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Notification, 'LinkEditing'];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!editor.plugins.has('ImageBlockEditing') && !editor.plugins.has('ImageInlineEditing')) {\n      /**\n      * CKFinder requires at least one plugin providing support for images loaded in the editor. Please\n      * make sure either:\n      *\n      * * {@link module:image/image~Image} (which loads both types of images),\n      * * or {@link module:image/imageblock~ImageBlock},\n      * * or {@link module:image/imageinline~ImageInline}.\n      *\n      * is loaded in your editor configuration.\n      *\n      * @error ckfinder-missing-image-plugin\n      */\n      throw new CKEditorError('ckfinder-missing-image-plugin', editor);\n    }\n    editor.commands.add('ckfinder', new CKFinderCommand(editor));\n  }\n}\n\n/**\n * The CKFinder feature, a bridge between the CKEditor 5 WYSIWYG editor and the\n * [CKFinder](https://ckeditor.com/ckfinder) file manager and uploader.\n *\n * This is a \"glue\" plugin which enables:\n *\n * * {@link module:ckfinder/ckfinderediting~CKFinderEditing},\n * * {@link module:ckfinder/ckfinderui~CKFinderUI},\n * * {@link module:adapter-ckfinder/uploadadapter~CKFinderUploadAdapter}.\n *\n * See the {@glink features/file-management/ckfinder \"CKFinder integration\" guide} to learn how to configure\n * and use this feature.\n *\n * Check out the {@glink features/images/image-upload/image-upload comprehensive \"Image upload\" guide} to learn about\n * other ways to upload images into CKEditor 5.\n */\nclass CKFinder extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CKFinder';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return ['Link', 'CKFinderUploadAdapter', CKFinderEditing, CKFinderUI];\n  }\n}\nexport { CKFinder, CKFinderEditing, CKFinderUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { ContextPlugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { ObservableMixin, CKEditorError, logWarning, EmitterMixin } from '@ckeditor/ckeditor5-utils/dist/index.js';\nconst DEFAULT_OPTIONS = {\n  autoRefresh: true\n};\nconst DEFAULT_TOKEN_REFRESH_TIMEOUT_TIME = 3600000; // 1 hour\nconst TOKEN_FAILED_REFRESH_TIMEOUT_TIME = 5000; // 5 seconds\n/**\n * The class representing the token used for communication with CKEditor Cloud Services.\n * The value of the token is retrieved from the specified URL and refreshed every 1 hour by default.\n * If the token retrieval fails, the token will automatically retry in 5 seconds intervals.\n */\nclass Token extends /* #__PURE__ */ObservableMixin() {\n  /**\n  * Base refreshing function.\n  */\n  _refresh;\n  /**\n  * Cached token options.\n  */\n  _options;\n  /**\n  * `setTimeout()` id for a token refresh when {@link module:cloud-services/token/token~TokenOptions auto refresh} is enabled.\n  */\n  _tokenRefreshTimeout;\n  /**\n  * Flag indicating whether the token has been destroyed.\n  */\n  _isDestroyed = false;\n  /**\n  * Creates `Token` instance.\n  * Method `init` should be called after using the constructor or use `create` method instead.\n  *\n  * @param tokenUrlOrRefreshToken Endpoint address to download the token or a callback that provides the token. If the\n  * value is a function it has to match the {@link module:cloud-services/token/token~Token#refreshToken} interface.\n  */\n  constructor(tokenUrlOrRefreshToken, options = {}) {\n    super();\n    if (!tokenUrlOrRefreshToken) {\n      /**\n      * A `tokenUrl` must be provided as the first constructor argument.\n      *\n      * @error token-missing-token-url\n      */\n      throw new CKEditorError('token-missing-token-url', this);\n    }\n    if (options.initValue) {\n      this._validateTokenValue(options.initValue);\n    }\n    this.set('value', options.initValue);\n    if (typeof tokenUrlOrRefreshToken === 'function') {\n      this._refresh = tokenUrlOrRefreshToken;\n    } else {\n      this._refresh = () => defaultRefreshToken(tokenUrlOrRefreshToken);\n    }\n    this._options = {\n      ...DEFAULT_OPTIONS,\n      ...options\n    };\n  }\n  /**\n  * Initializes the token.\n  */\n  init() {\n    return new Promise((resolve, reject) => {\n      if (!this.value) {\n        this.refreshToken().then(resolve).catch(reject);\n        return;\n      }\n      if (this._options.autoRefresh) {\n        this._registerRefreshTokenTimeout();\n      }\n      resolve(this);\n    });\n  }\n  /**\n  * Refresh token method. Useful in a method form as it can be overridden in tests.\n  *\n  * This method will be invoked periodically based on the token expiry date after first call to keep the token up-to-date\n  * (requires {@link module:cloud-services/token/token~TokenOptions auto refresh option} to be set).\n  *\n  * If the token refresh fails, the method will retry in 5 seconds intervals until success or the token gets\n  * {@link #destroy destroyed}.\n  */\n  refreshToken() {\n    const autoRefresh = this._options.autoRefresh;\n    return this._refresh().then(value => {\n      this._validateTokenValue(value);\n      this.set('value', value);\n      if (autoRefresh) {\n        this._registerRefreshTokenTimeout();\n      }\n      return this;\n    }).catch(err => {\n      /**\n      * You will see this warning when the CKEditor {@link module:cloud-services/token/token~Token token} could not be refreshed.\n      * This may be a result of a network error, a token endpoint (server) error, or an invalid\n      * {@link module:cloud-services/cloudservicesconfig~CloudServicesConfig#tokenUrl token URL configuration}.\n      *\n      * If this warning repeats, please make sure that the configuration is correct and that the token\n      * endpoint is up and running. {@link module:cloud-services/cloudservicesconfig~CloudServicesConfig#tokenUrl Learn more}\n      * about token configuration.\n      *\n      * **Note:** If the token's {@link module:cloud-services/token/token~TokenOptions auto refresh option} is enabled,\n      * attempts to refresh will be made until success or token's\n      * {@link module:cloud-services/token/token~Token#destroy destruction}.\n      *\n      * @error token-refresh-failed\n      * @param autoRefresh Whether the token will keep auto refreshing.\n      */\n      logWarning('token-refresh-failed', {\n        autoRefresh\n      });\n      // If the refresh failed, keep trying to refresh the token. Failing to do so will eventually\n      // lead to the disconnection from the RTC service and the editing session (and potential data loss\n      // if the user keeps editing).\n      if (autoRefresh) {\n        this._registerRefreshTokenTimeout(TOKEN_FAILED_REFRESH_TIMEOUT_TIME);\n      }\n      throw err;\n    });\n  }\n  /**\n  * Destroys token instance. Stops refreshing.\n  */\n  destroy() {\n    this._isDestroyed = true;\n    clearTimeout(this._tokenRefreshTimeout);\n  }\n  /**\n  * Checks whether the provided token follows the JSON Web Tokens (JWT) format.\n  *\n  * @param tokenValue The token to validate.\n  */\n  _validateTokenValue(tokenValue) {\n    // The token must be a string.\n    const isString = typeof tokenValue === 'string';\n    // The token must be a plain string without quotes (\"\").\n    const isPlainString = !/^\".*\"$/.test(tokenValue);\n    // JWT token contains 3 parts: header, payload, and signature.\n    // Each part is separated by a dot.\n    const isJWTFormat = isString && tokenValue.split('.').length === 3;\n    if (!(isPlainString && isJWTFormat)) {\n      /**\n      * The provided token must follow the [JSON Web Tokens](https://jwt.io/introduction/) format.\n      *\n      * @error token-not-in-jwt-format\n      */\n      throw new CKEditorError('token-not-in-jwt-format', this);\n    }\n  }\n  /**\n  * Registers a refresh token timeout for the time taken from token.\n  */\n  _registerRefreshTokenTimeout(timeoutTime) {\n    clearTimeout(this._tokenRefreshTimeout);\n    if (this._isDestroyed) {\n      return;\n    }\n    const tokenRefreshTimeoutTime = timeoutTime || this._getTokenRefreshTimeoutTime();\n    this._tokenRefreshTimeout = setTimeout(() => {\n      this.refreshToken();\n    }, tokenRefreshTimeoutTime);\n  }\n  /**\n  * Returns token refresh timeout time calculated from expire time in the token payload.\n  *\n  * If the token parse fails or the token payload doesn't contain, the default DEFAULT_TOKEN_REFRESH_TIMEOUT_TIME is returned.\n  */\n  _getTokenRefreshTimeoutTime() {\n    try {\n      const [, binaryTokenPayload] = this.value.split('.');\n      const {\n        exp: tokenExpireTime\n      } = JSON.parse(atob(binaryTokenPayload));\n      if (!tokenExpireTime) {\n        return DEFAULT_TOKEN_REFRESH_TIMEOUT_TIME;\n      }\n      const tokenRefreshTimeoutTime = Math.floor((tokenExpireTime * 1000 - Date.now()) / 2);\n      return tokenRefreshTimeoutTime;\n    } catch (err) {\n      return DEFAULT_TOKEN_REFRESH_TIMEOUT_TIME;\n    }\n  }\n  /**\n  * Creates a initialized {@link module:cloud-services/token/token~Token} instance.\n  *\n  * @param tokenUrlOrRefreshToken Endpoint address to download the token or a callback that provides the token. If the\n  * value is a function it has to match the {@link module:cloud-services/token/token~Token#refreshToken} interface.\n  */\n  static create(tokenUrlOrRefreshToken, options = {}) {\n    const token = new Token(tokenUrlOrRefreshToken, options);\n    return token.init();\n  }\n}\n/**\n * This function is called in a defined interval by the {@link ~Token} class. It also can be invoked manually.\n * It should return a promise, which resolves with the new token value.\n * If any error occurs it should return a rejected promise with an error message.\n */\nfunction defaultRefreshToken(tokenUrl) {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    xhr.open('GET', tokenUrl);\n    xhr.addEventListener('load', () => {\n      const statusCode = xhr.status;\n      const xhrResponse = xhr.response;\n      if (statusCode < 200 || statusCode > 299) {\n        /**\n        * Cannot download new token from the provided url.\n        *\n        * @error token-cannot-download-new-token\n        */\n        return reject(new CKEditorError('token-cannot-download-new-token', null));\n      }\n      return resolve(xhrResponse);\n    });\n    xhr.addEventListener('error', () => reject(new Error('Network Error')));\n    xhr.addEventListener('abort', () => reject(new Error('Abort')));\n    xhr.send();\n  });\n}\nconst BASE64_HEADER_REG_EXP = /^data:(\\S*?);base64,/;\n/**\n * FileUploader class used to upload single file.\n */\nclass FileUploader extends /* #__PURE__ */EmitterMixin() {\n  /**\n  * A file that is being uploaded.\n  */\n  file;\n  xhr;\n  /**\n  * CKEditor Cloud Services access token.\n  */\n  _token;\n  /**\n  * CKEditor Cloud Services API address.\n  */\n  _apiAddress;\n  /**\n  * Creates `FileUploader` instance.\n  *\n  * @param fileOrData A blob object or a data string encoded with Base64.\n  * @param token Token used for authentication.\n  * @param apiAddress API address.\n  */\n  constructor(fileOrData, token, apiAddress) {\n    super();\n    if (!fileOrData) {\n      /**\n      * File must be provided as the first argument.\n      *\n      * @error fileuploader-missing-file\n      */\n      throw new CKEditorError('fileuploader-missing-file', null);\n    }\n    if (!token) {\n      /**\n      * Token must be provided as the second argument.\n      *\n      * @error fileuploader-missing-token\n      */\n      throw new CKEditorError('fileuploader-missing-token', null);\n    }\n    if (!apiAddress) {\n      /**\n      * Api address must be provided as the third argument.\n      *\n      * @error fileuploader-missing-api-address\n      */\n      throw new CKEditorError('fileuploader-missing-api-address', null);\n    }\n    this.file = _isBase64(fileOrData) ? _base64ToBlob(fileOrData) : fileOrData;\n    this._token = token;\n    this._apiAddress = apiAddress;\n  }\n  /**\n  * Registers callback on `progress` event.\n  */\n  onProgress(callback) {\n    this.on('progress', (event, data) => callback(data));\n    return this;\n  }\n  /**\n  * Registers callback on `error` event. Event is called once when error occurs.\n  */\n  onError(callback) {\n    this.once('error', (event, data) => callback(data));\n    return this;\n  }\n  /**\n  * Aborts upload process.\n  */\n  abort() {\n    this.xhr.abort();\n  }\n  /**\n  * Sends XHR request to API.\n  */\n  send() {\n    this._prepareRequest();\n    this._attachXHRListeners();\n    return this._sendRequest();\n  }\n  /**\n  * Prepares XHR request.\n  */\n  _prepareRequest() {\n    const xhr = new XMLHttpRequest();\n    xhr.open('POST', this._apiAddress);\n    xhr.setRequestHeader('Authorization', this._token.value);\n    xhr.responseType = 'json';\n    this.xhr = xhr;\n  }\n  /**\n  * Attaches listeners to the XHR.\n  */\n  _attachXHRListeners() {\n    const xhr = this.xhr;\n    const onError = message => {\n      return () => this.fire('error', message);\n    };\n    xhr.addEventListener('error', onError('Network Error'));\n    xhr.addEventListener('abort', onError('Abort'));\n    /* istanbul ignore else -- @preserve */\n    if (xhr.upload) {\n      xhr.upload.addEventListener('progress', event => {\n        if (event.lengthComputable) {\n          this.fire('progress', {\n            total: event.total,\n            uploaded: event.loaded\n          });\n        }\n      });\n    }\n    xhr.addEventListener('load', () => {\n      const statusCode = xhr.status;\n      const xhrResponse = xhr.response;\n      if (statusCode < 200 || statusCode > 299) {\n        return this.fire('error', xhrResponse.message || xhrResponse.error);\n      }\n    });\n  }\n  /**\n  * Sends XHR request.\n  */\n  _sendRequest() {\n    const formData = new FormData();\n    const xhr = this.xhr;\n    formData.append('file', this.file);\n    return new Promise((resolve, reject) => {\n      xhr.addEventListener('load', () => {\n        const statusCode = xhr.status;\n        const xhrResponse = xhr.response;\n        if (statusCode < 200 || statusCode > 299) {\n          if (xhrResponse.message) {\n            /**\n            * Uploading file failed.\n            *\n            * @error fileuploader-uploading-data-failed\n            */\n            return reject(new CKEditorError('fileuploader-uploading-data-failed', this, {\n              message: xhrResponse.message\n            }));\n          }\n          return reject(xhrResponse.error);\n        }\n        return resolve(xhrResponse);\n      });\n      xhr.addEventListener('error', () => reject(new Error('Network Error')));\n      xhr.addEventListener('abort', () => reject(new Error('Abort')));\n      xhr.send(formData);\n    });\n  }\n}\n/**\n * Transforms Base64 string data into file.\n *\n * @param base64 String data.\n */\nfunction _base64ToBlob(base64, sliceSize = 512) {\n  try {\n    const contentType = base64.match(BASE64_HEADER_REG_EXP)[1];\n    const base64Data = atob(base64.replace(BASE64_HEADER_REG_EXP, ''));\n    const byteArrays = [];\n    for (let offset = 0; offset < base64Data.length; offset += sliceSize) {\n      const slice = base64Data.slice(offset, offset + sliceSize);\n      const byteNumbers = new Array(slice.length);\n      for (let i = 0; i < slice.length; i++) {\n        byteNumbers[i] = slice.charCodeAt(i);\n      }\n      byteArrays.push(new Uint8Array(byteNumbers));\n    }\n    return new Blob(byteArrays, {\n      type: contentType\n    });\n  } catch (error) {\n    /**\n    * Problem with decoding Base64 image data.\n    *\n    * @error fileuploader-decoding-image-data-error\n    */\n    throw new CKEditorError('fileuploader-decoding-image-data-error', null);\n  }\n}\n/**\n * Checks that string is Base64.\n */\nfunction _isBase64(string) {\n  if (typeof string !== 'string') {\n    return false;\n  }\n  return !!string.match(BASE64_HEADER_REG_EXP)?.length;\n}\n\n/**\n * UploadGateway abstracts file uploads to CKEditor Cloud Services.\n */\nclass UploadGateway {\n  /**\n  * CKEditor Cloud Services access token.\n  */\n  _token;\n  /**\n  * CKEditor Cloud Services API address.\n  */\n  _apiAddress;\n  /**\n  * Creates `UploadGateway` instance.\n  *\n  * @param token Token used for authentication.\n  * @param apiAddress API address.\n  */\n  constructor(token, apiAddress) {\n    if (!token) {\n      /**\n      * Token must be provided.\n      *\n      * @error uploadgateway-missing-token\n      */\n      throw new CKEditorError('uploadgateway-missing-token', null);\n    }\n    if (!apiAddress) {\n      /**\n      * Api address must be provided.\n      *\n      * @error uploadgateway-missing-api-address\n      */\n      throw new CKEditorError('uploadgateway-missing-api-address', null);\n    }\n    this._token = token;\n    this._apiAddress = apiAddress;\n  }\n  /**\n  * Creates a {@link module:cloud-services/uploadgateway/fileuploader~FileUploader} instance that wraps\n  * file upload process. The file is being sent at a time when the\n  * {@link module:cloud-services/uploadgateway/fileuploader~FileUploader#send} method is called.\n  *\n  * ```ts\n  * const token = await Token.create( 'https://token-endpoint' );\n  * new UploadGateway( token, 'https://example.org' )\n  * \t.upload( 'FILE' )\n  * \t.onProgress( ( data ) => console.log( data ) )\n  * \t.send()\n  * \t.then( ( response ) => console.log( response ) );\n  * ```\n  *\n  * @param {Blob|String} fileOrData A blob object or a data string encoded with Base64.\n  * @returns {module:cloud-services/uploadgateway/fileuploader~FileUploader} Returns `FileUploader` instance.\n  */\n  upload(fileOrData) {\n    return new FileUploader(fileOrData, this._token, this._apiAddress);\n  }\n}\n\n/**\n * The `CloudServicesCore` plugin exposes the base API for communication with CKEditor Cloud Services.\n */\nclass CloudServicesCore extends ContextPlugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CloudServicesCore';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * Creates the {@link module:cloud-services/token/token~Token} instance.\n  *\n  * @param tokenUrlOrRefreshToken Endpoint address to download the token or a callback that provides the token. If the\n  * value is a function it has to match the {@link module:cloud-services/token/token~Token#refreshToken} interface.\n  * @param options.initValue Initial value of the token.\n  * @param options.autoRefresh Specifies whether to start the refresh automatically.\n  */\n  createToken(tokenUrlOrRefreshToken, options) {\n    return new Token(tokenUrlOrRefreshToken, options);\n  }\n  /**\n  * Creates the {@link module:cloud-services/uploadgateway/uploadgateway~UploadGateway} instance.\n  *\n  * @param token Token used for authentication.\n  * @param apiAddress API address.\n  */\n  createUploadGateway(token, apiAddress) {\n    return new UploadGateway(token, apiAddress);\n  }\n}\n\n/**\n * Plugin introducing the integration between CKEditor 5 and CKEditor Cloud Services .\n *\n * It initializes the token provider based on\n * the {@link module:cloud-services/cloudservicesconfig~CloudServicesConfig `config.cloudService`}.\n */\nclass CloudServices extends ContextPlugin {\n  /**\n  * The authentication token URL for CKEditor Cloud Services or a callback to the token value promise. See the\n  * {@link module:cloud-services/cloudservicesconfig~CloudServicesConfig#tokenUrl} for more details.\n  */\n  tokenUrl;\n  /**\n  * The URL to which the files should be uploaded.\n  */\n  uploadUrl;\n  /**\n  * The URL for web socket communication, used by the `RealTimeCollaborativeEditing` plugin. Every customer (organization in the CKEditor\n  * Ecosystem dashboard) has their own, unique URLs to communicate with CKEditor Cloud Services. The URL can be found in the\n  * CKEditor Ecosystem customer dashboard.\n  *\n  * Note: Unlike most plugins, `RealTimeCollaborativeEditing` is not included in any CKEditor 5 build and needs to be installed manually.\n  * Check [Collaboration overview](https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/overview.html) for more details.\n  */\n  webSocketUrl;\n  /**\n  * An optional parameter used for integration with CKEditor Cloud Services when uploading the editor build to cloud services.\n  *\n  * Whenever the editor build or the configuration changes, this parameter should be set to a new, unique value to differentiate\n  * the new bundle (build + configuration) from the old ones.\n  */\n  bundleVersion;\n  /**\n  * Other plugins use this token for the authorization process. It handles token requesting and refreshing.\n  * Its value is `null` when {@link module:cloud-services/cloudservicesconfig~CloudServicesConfig#tokenUrl} is not provided.\n  *\n  * @readonly\n  */\n  token = null;\n  /**\n  * A map of token object instances keyed by the token URLs.\n  */\n  _tokens = new Map();\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CloudServices';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [CloudServicesCore];\n  }\n  /**\n  * @inheritDoc\n  */\n  async init() {\n    const config = this.context.config;\n    const options = config.get('cloudServices') || {};\n    for (const [key, value] of Object.entries(options)) {\n      this[key] = value;\n    }\n    if (!this.tokenUrl) {\n      this.token = null;\n      return;\n    }\n    // Initialization of the token may fail. By default, the token is being refreshed on the failure.\n    // The problem is that if this happens here, then the token refresh interval will be executed even\n    // after destroying the editor (as the exception was thrown from `init` method). To prevent that\n    // behavior we need to catch the exception and destroy the uninitialized token instance.\n    // See: https://github.com/ckeditor/ckeditor5/issues/17531\n    const cloudServicesCore = this.context.plugins.get('CloudServicesCore');\n    const uninitializedToken = cloudServicesCore.createToken(this.tokenUrl);\n    try {\n      this.token = await uninitializedToken.init();\n      this._tokens.set(this.tokenUrl, this.token);\n    } catch (error) {\n      uninitializedToken.destroy();\n      throw error;\n    }\n  }\n  /**\n  * Registers an additional authentication token URL for CKEditor Cloud Services or a callback to the token value promise. See the\n  * {@link module:cloud-services/cloudservicesconfig~CloudServicesConfig#tokenUrl} for more details.\n  *\n  * @param tokenUrl The authentication token URL for CKEditor Cloud Services or a callback to the token value promise.\n  */\n  async registerTokenUrl(tokenUrl) {\n    // Reuse the token instance in case of multiple features using the same token URL.\n    if (this._tokens.has(tokenUrl)) {\n      return this.getTokenFor(tokenUrl);\n    }\n    const cloudServicesCore = this.context.plugins.get('CloudServicesCore');\n    const token = await cloudServicesCore.createToken(tokenUrl).init();\n    this._tokens.set(tokenUrl, token);\n    return token;\n  }\n  /**\n  * Returns an authentication token provider previously registered by {@link #registerTokenUrl}.\n  *\n  * @param tokenUrl The authentication token URL for CKEditor Cloud Services or a callback to the token value promise.\n  */\n  getTokenFor(tokenUrl) {\n    const token = this._tokens.get(tokenUrl);\n    if (!token) {\n      /**\n      * The provided `tokenUrl` was not registered by {@link module:cloud-services/cloudservices~CloudServices#registerTokenUrl}.\n      *\n      * @error cloudservices-token-not-registered\n      */\n      throw new CKEditorError('cloudservices-token-not-registered', this);\n    }\n    return token;\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    for (const token of this._tokens.values()) {\n      token.destroy();\n    }\n  }\n}\nexport { CloudServices, CloudServicesCore, Token };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { ShiftEnter } from '@ckeditor/ckeditor5-enter/dist/index.js';\nimport { UpcastWriter } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { ClipboardPipeline } from '@ckeditor/ckeditor5-clipboard/dist/index.js';\nimport { first, Collection } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { createDropdown, SplitButtonView, addListToDropdown, MenuBarMenuView, MenuBarMenuListView, MenuBarMenuListItemView, MenuBarMenuListItemButtonView, ViewModel } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconCodeBlock } from '@ckeditor/ckeditor5-icons/dist/index.js';\n\n/**\n * Returns code block languages as defined in `config.codeBlock.languages` but processed:\n *\n * * To consider the editor localization, i.e. to display {@link module:code-block/codeblockconfig~CodeBlockLanguageDefinition}\n * in the correct language. There is no way to use {@link module:utils/locale~Locale#t} when the user\n * configuration is defined because the editor does not exist yet.\n * * To make sure each definition has a CSS class associated with it even if not specified\n * in the original configuration.\n */\nfunction getNormalizedAndLocalizedLanguageDefinitions(editor) {\n  const t = editor.t;\n  const languageDefs = editor.config.get('codeBlock.languages');\n  for (const def of languageDefs) {\n    if (def.label === 'Plain text') {\n      def.label = t('Plain text');\n    }\n    if (def.class === undefined) {\n      def.class = `language-${def.language}`;\n    }\n  }\n  return languageDefs;\n}\n/**\n * Returns an object associating certain language definition properties with others. For instance:\n *\n * For:\n *\n * ```ts\n * const definitions = {\n * \t{ language: 'php', class: 'language-php', label: 'PHP' },\n * \t{ language: 'javascript', class: 'js', label: 'JavaScript' },\n * };\n *\n * getPropertyAssociation( definitions, 'class', 'language' );\n * ```\n *\n * returns:\n *\n * ```ts\n * {\n * \t'language-php': 'php',\n * \t'js': 'javascript'\n * }\n * ```\n *\n * and\n *\n * ```ts\n * getPropertyAssociation( definitions, 'language', 'label' );\n * ```\n *\n * returns:\n *\n * ```ts\n * {\n * \t'php': 'PHP',\n * \t'javascript': 'JavaScript'\n * }\n * ```\n */\nfunction getPropertyAssociation(languageDefs, key, value) {\n  const association = {};\n  for (const def of languageDefs) {\n    if (key === 'class') {\n      // Only the first class is considered.\n      const newKey = def[key].split(' ').shift();\n      association[newKey] = def[value];\n    } else {\n      association[def[key]] = def[value];\n    }\n  }\n  return association;\n}\n/**\n * For a given model text node, it returns white spaces that precede other characters in that node.\n * This corresponds to the indentation part of the code block line.\n */\nfunction getLeadingWhiteSpaces(textNode) {\n  return textNode.data.match(/^(\\s*)/)[0];\n}\n/**\n * For plain text containing the code (a snippet), it returns a document fragment containing\n * view text nodes separated by `<br>` elements (in place of new line characters \"\\n\"), for instance:\n *\n * Input:\n *\n * ```ts\n * \"foo()\\n\n * bar()\"\n * ```\n *\n * Output:\n *\n * ```html\n * <DocumentFragment>\n * \t\"foo()\"\n * \t<br/>\n * \t\"bar()\"\n * </DocumentFragment>\n * ```\n *\n * @param text The raw code text to be converted.\n */\nfunction rawSnippetTextToViewDocumentFragment(writer, text) {\n  const fragment = writer.createDocumentFragment();\n  const textLines = text.split('\\n');\n  const items = textLines.reduce((nodes, line, lineIndex) => {\n    nodes.push(line);\n    if (lineIndex < textLines.length - 1) {\n      nodes.push(writer.createElement('br'));\n    }\n    return nodes;\n  }, []);\n  writer.appendChild(items, fragment);\n  return fragment;\n}\n/**\n * Returns an array of all model positions within the selection that represent code block lines.\n *\n * If the selection is collapsed, it returns the exact selection anchor position:\n *\n * ```html\n * <codeBlock>[]foo</codeBlock>        ->     <codeBlock>^foo</codeBlock>\n * <codeBlock>foo[]bar</codeBlock>     ->     <codeBlock>foo^bar</codeBlock>\n * ```\n *\n * Otherwise, it returns positions **before** each text node belonging to all code blocks contained by the selection:\n *\n * ```html\n * <codeBlock>                                <codeBlock>\n *     foo[bar                                   ^foobar\n *     <softBreak></softBreak>         ->        <softBreak></softBreak>\n *     baz]qux                                   ^bazqux\n * </codeBlock>                               </codeBlock>\n * ```\n *\n * It also works across other nonâ€“code blocks:\n *\n * ```html\n * <codeBlock>                                <codeBlock>\n *     foo[bar                                   ^foobar\n * </codeBlock>                               </codeBlock>\n * <paragraph>text</paragraph>         ->     <paragraph>text</paragraph>\n * <codeBlock>                                <codeBlock>\n *     baz]qux                                   ^bazqux\n * </codeBlock>                               </codeBlock>\n * ```\n *\n * **Note:** The positions are in reverse order so they do not get outdated when iterating over them and\n * the writer inserts or removes elements at the same time.\n *\n * **Note:** The position is located after the leading white spaces in the text node.\n */\nfunction getIndentOutdentPositions(model) {\n  const selection = model.document.selection;\n  const positions = [];\n  // When the selection is collapsed, there's only one position we can indent or outdent.\n  if (selection.isCollapsed) {\n    return [selection.anchor];\n  }\n  // When the selection is NOT collapsed, collect all positions starting before text nodes\n  // (code lines) in any <codeBlock> within the selection.\n  // Walk backward so positions we are about to collect here do not get outdated when\n  // inserting or deleting using the writer.\n  const walker = selection.getFirstRange().getWalker({\n    ignoreElementEnd: true,\n    direction: 'backward'\n  });\n  for (const {\n    item\n  } of walker) {\n    let node = item.is('$textProxy') ? item.textNode : item;\n    const parent = node.parent;\n    if (!parent.is('element', 'codeBlock') || node.is('element', 'softBreak')) {\n      continue;\n    }\n    // For each item in code block, move backwards until the beginning of the line it is in is found.\n    while (node.previousSibling && !node.previousSibling.is('element', 'softBreak')) {\n      node = node.previousSibling;\n    }\n    // Take the leading white spaces into account (only for text nodes).\n    const startOffset = !node.is('$text') ? node.startOffset : node.startOffset + getLeadingWhiteSpaces(node).length;\n    const position = model.createPositionAt(parent, startOffset);\n    // Do not add the same position twice. Unfortunately using set doesn't deduplicate positions because\n    // they are different objects.\n    if (positions.every(pos => !pos.isEqual(position))) {\n      positions.push(position);\n    }\n  }\n  return positions;\n}\n/**\n * Checks if any of the blocks within the model selection is a code block.\n */\nfunction isModelSelectionInCodeBlock(selection) {\n  const firstBlock = first(selection.getSelectedBlocks());\n  return !!firstBlock && firstBlock.is('element', 'codeBlock');\n}\n/**\n * Checks if an {@link module:engine/model/element~Element Element} can become a code block.\n *\n * @param schema Model's schema.\n * @param element The element to be checked.\n * @returns Check result.\n */\nfunction canBeCodeBlock(schema, element) {\n  if (element.is('rootElement') || schema.isLimit(element)) {\n    return false;\n  }\n  return schema.checkChild(element.parent, 'codeBlock');\n}\n/**\n * Get the translated message read by the screen reader when you enter or exit an element with your cursor.\n */\nfunction getCodeBlockAriaAnnouncement(t, languageDefs, element, direction) {\n  const languagesToLabels = getPropertyAssociation(languageDefs, 'language', 'label');\n  const codeBlockLanguage = element.getAttribute('language');\n  if (codeBlockLanguage in languagesToLabels) {\n    const language = languagesToLabels[codeBlockLanguage];\n    if (direction === 'enter') {\n      return t('Entering %0 code snippet', language);\n    }\n    return t('Leaving %0 code snippet', language);\n  }\n  if (direction === 'enter') {\n    return t('Entering code snippet');\n  }\n  return t('Leaving code snippet');\n}\n/**\n * For given position, finds the closest position that is at the beginning of a line of code and returns a text node that is at the\n * beginning of the line (or `null` if there's no text node at the beginning of a given line).\n *\n * Line beings at the start of a code block element and after each `softBreak` element.\n *\n * Note: even though code block doesn't allow inline elements other than `<softBreak>` by default, some features may overwrite this rule,\n * so such inline elements are taken into account.\n *\n * Some examples of expected results:\n *\n * ```\n * <codeBlock>^</codeBlock>                                ->   null\n * <codeBlock>^foobar</codeBlock>                          ->   <codeBlock>[foobar]</codeBlock>\n * <codeBlock>foobar^</codeBlock>                          ->   <codeBlock>[foobar]</codeBlock>\n * <codeBlock>foo^bar</codeBlock>                          ->   <codeBlock>[foobar]</codeBlock>\n * <codeBlock>foo^<softBreak />bar</codeBlock>             ->   <codeBlock>[foo]<softBreak />bar</codeBlock>\n * <codeBlock>foo<softBreak />bar^</codeBlock>             ->   <codeBlock>foo<softBreak />[bar]</codeBlock>\n * <codeBlock>foo<softBreak />b^ar</codeBlock>             ->   <codeBlock>foo<softBreak />[bar]</codeBlock>\n * <codeBlock>foo<softBreak />^bar</codeBlock>             ->   <codeBlock>foo<softBreak />[bar]</codeBlock>\n * <codeBlock>^<element /></codeBlock>                     ->   null\n * <codeBlock><element />^</codeBlock>                     ->   null\n * <codeBlock>foo^<element /></codeBlock>                  ->   <codeBlock>[foo]<element /></codeBlock>\n * <codeBlock>foo<element />^</codeBlock>                  ->   <codeBlock>[foo]<element /></codeBlock>\n * <codeBlock>foo<element />bar^</codeBlock>               ->   <codeBlock>[foo]<element />bar</codeBlock>\n * <codeBlock><element />bar^</codeBlock>                  ->   null\n * <codeBlock>foo<softBreak />^<softBreak /></codeBlock>   ->   null\n * <codeBlock>foo<softBreak />^<element /></codeBlock>     ->   null\n * <codeBlock>foo<softBreak /><element />^</codeBlock>     ->   null\n * <codeBlock>foo<softBreak />bar<element />^</codeBlock>  ->   <codeBlock>foo<softBreak />[bar]<element /></codeBlock>\n * <codeBlock>foo<softBreak /><element />ba^r</codeBlock>  ->   null\n * ```\n */\nfunction getTextNodeAtLineStart(position, model) {\n  // First, move position before a text node, if it is inside a text node.\n  if (position.textNode) {\n    position = model.createPositionBefore(position.textNode);\n  }\n  // Then, jump-back the position until it is before a `softBreak` or at the beginning of the `codeBlock`.\n  while (position.nodeBefore && !position.nodeBefore.is('element', 'softBreak')) {\n    position = model.createPositionBefore(position.nodeBefore);\n  }\n  // Now, the position is at the beginning of a line.\n  // Return a text node after the position, if there is one.\n  const nodeAtStart = position.nodeAfter;\n  return nodeAtStart && nodeAtStart.is('$text') ? nodeAtStart : null;\n}\n\n/**\n * The code block command plugin.\n */\nclass CodeBlockCommand extends Command {\n  /**\n  * Contains the last used language.\n  */\n  _lastLanguage;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._lastLanguage = null;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.value = this._getValue();\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Executes the command. When the command {@link #value is on}, all topmost code blocks within\n  * the selection will be removed. If it is off, all selected blocks will be flattened and\n  * wrapped by a code block.\n  *\n  * @fires execute\n  * @param options Command options.\n  * @param options.language The code block language.\n  * @param options.forceValue If set, it will force the command behavior. If `true`, the command will apply a code block,\n  * otherwise the command will remove the code block. If not set, the command will act basing on its current value.\n  * @param options.usePreviousLanguageChoice If set on `true` and the `options.language` is not specified, the command\n  * will apply the previous language (if the command was already executed) when inserting the `codeBlock` element.\n  */\n  execute(options = {}) {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    const normalizedLanguagesDefs = getNormalizedAndLocalizedLanguageDefinitions(editor);\n    const firstLanguageInConfig = normalizedLanguagesDefs[0];\n    const blocks = Array.from(selection.getSelectedBlocks());\n    const value = options.forceValue == undefined ? !this.value : options.forceValue;\n    const language = getLanguage(options, this._lastLanguage, firstLanguageInConfig.language);\n    model.change(writer => {\n      if (value) {\n        this._applyCodeBlock(writer, blocks, language);\n      } else {\n        this._removeCodeBlock(writer, blocks);\n      }\n    });\n  }\n  /**\n  * Checks the command's {@link #value}.\n  *\n  * @returns The current value.\n  */\n  _getValue() {\n    const selection = this.editor.model.document.selection;\n    const firstBlock = first(selection.getSelectedBlocks());\n    const isCodeBlock = !!firstBlock?.is('element', 'codeBlock');\n    return isCodeBlock ? firstBlock.getAttribute('language') : false;\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    if (this.value) {\n      return true;\n    }\n    const selection = this.editor.model.document.selection;\n    const schema = this.editor.model.schema;\n    const firstBlock = first(selection.getSelectedBlocks());\n    if (!firstBlock) {\n      return false;\n    }\n    return canBeCodeBlock(schema, firstBlock);\n  }\n  _applyCodeBlock(writer, blocks, language) {\n    this._lastLanguage = language;\n    const schema = this.editor.model.schema;\n    const allowedBlocks = blocks.filter(block => canBeCodeBlock(schema, block));\n    for (const block of allowedBlocks) {\n      writer.rename(block, 'codeBlock');\n      writer.setAttribute('language', language, block);\n      schema.removeDisallowedAttributes([block], writer);\n      // Remove children of the  `codeBlock` element that are not allowed. See #9567.\n      Array.from(block.getChildren()).filter(child => !schema.checkChild(block, child)).forEach(child => writer.remove(child));\n    }\n    allowedBlocks.reverse().forEach((currentBlock, i) => {\n      const nextBlock = allowedBlocks[i + 1];\n      if (currentBlock.previousSibling === nextBlock) {\n        writer.appendElement('softBreak', nextBlock);\n        writer.merge(writer.createPositionBefore(currentBlock));\n      }\n    });\n  }\n  _removeCodeBlock(writer, blocks) {\n    const codeBlocks = blocks.filter(block => block.is('element', 'codeBlock'));\n    for (const block of codeBlocks) {\n      const range = writer.createRangeOn(block);\n      for (const item of Array.from(range.getItems()).reverse()) {\n        if (item.is('element', 'softBreak') && item.parent.is('element', 'codeBlock')) {\n          const {\n            position\n          } = writer.split(writer.createPositionBefore(item));\n          const elementAfter = position.nodeAfter;\n          writer.rename(elementAfter, 'paragraph');\n          writer.removeAttribute('language', elementAfter);\n          writer.remove(item);\n        }\n      }\n      writer.rename(block, 'paragraph');\n      writer.removeAttribute('language', block);\n    }\n  }\n}\n/**\n * Picks the language for the new code block. If any language is passed as an option,\n * it will be returned. Else, if option usePreviousLanguageChoice is true and some\n * code block was already created (lastLanguage is not null) then previously used\n * language will be returned. If not, it will return default language.\n */\nfunction getLanguage(options, lastLanguage, defaultLanguage) {\n  if (options.language) {\n    return options.language;\n  }\n  if (options.usePreviousLanguageChoice && lastLanguage) {\n    return lastLanguage;\n  }\n  return defaultLanguage;\n}\n\n/**\n * The code block indentation increase command plugin.\n */\nclass IndentCodeBlockCommand extends Command {\n  /**\n  * A sequence of characters added to the line when the command is executed.\n  */\n  _indentSequence;\n  constructor(editor) {\n    super(editor);\n    this._indentSequence = editor.config.get('codeBlock.indentSequence');\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Executes the command. When the command {@link #isEnabled is enabled}, the indentation of the\n  * code lines in the selection will be increased.\n  *\n  * @fires execute\n  */\n  execute() {\n    const editor = this.editor;\n    const model = editor.model;\n    model.change(writer => {\n      const positions = getIndentOutdentPositions(model);\n      // Indent all positions, for instance assuming the indent sequence is 4x space (\"    \"):\n      //\n      //\t\t<codeBlock>^foo</codeBlock>        ->       <codeBlock>    foo</codeBlock>\n      //\n      //\t\t<codeBlock>foo^bar</codeBlock>     ->       <codeBlock>foo    bar</codeBlock>\n      //\n      // Also, when there is more than one position:\n      //\n      //\t\t<codeBlock>\n      //\t\t\t^foobar\n      //\t\t\t<softBreak></softBreak>\n      //\t\t\t^bazqux\n      //\t\t</codeBlock>\n      //\n      //\t\t->\n      //\n      //\t\t<codeBlock>\n      //\t\t\t    foobar\n      //\t\t\t<softBreak></softBreak>\n      //\t\t\t    bazqux\n      //\t\t</codeBlock>\n      //\n      for (const position of positions) {\n        const indentSequenceTextElement = writer.createText(this._indentSequence);\n        // Previously insertion was done by writer.insertText(). It was changed to insertContent() to enable\n        // integration of code block with track changes. It's the easiest way of integration because insertContent()\n        // is already integrated with track changes, but if it ever cause any troubles it can be reverted, however\n        // some additional work will be required in track changes integration of code block.\n        model.insertContent(indentSequenceTextElement, position);\n      }\n    });\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  */\n  _checkEnabled() {\n    if (!this._indentSequence) {\n      return false;\n    }\n    // Indent (forward) command is always enabled when there's any code block in the selection\n    // because you can always indent code lines.\n    return isModelSelectionInCodeBlock(this.editor.model.document.selection);\n  }\n}\n\n/**\n * The code block indentation decrease command plugin.\n */\nclass OutdentCodeBlockCommand extends Command {\n  /**\n  * A sequence of characters removed from the line when the command is executed.\n  */\n  _indentSequence;\n  constructor(editor) {\n    super(editor);\n    this._indentSequence = editor.config.get('codeBlock.indentSequence');\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Executes the command. When the command {@link #isEnabled is enabled}, the indentation of the\n  * code lines in the selection will be decreased.\n  *\n  * @fires execute\n  */\n  execute() {\n    const editor = this.editor;\n    const model = editor.model;\n    model.change(() => {\n      const positions = getIndentOutdentPositions(model);\n      // Outdent all positions, for instance assuming the indent sequence is 4x space (\"    \"):\n      //\n      //\t\t<codeBlock>^foo</codeBlock>         ->       <codeBlock>foo</codeBlock>\n      //\n      //\t\t<codeBlock>    ^bar</codeBlock>     ->       <codeBlock>bar</codeBlock>\n      //\n      // Also, when there is more than one position:\n      //\n      //\t\t<codeBlock>\n      //\t\t\t    ^foobar\n      //\t\t\t<softBreak></softBreak>\n      //\t\t\t    ^bazqux\n      //\t\t</codeBlock>\n      //\n      //\t\t->\n      //\n      //\t\t<codeBlock>\n      //\t\t\tfoobar\n      //\t\t\t<softBreak></softBreak>\n      //\t\t\tbazqux\n      //\t\t</codeBlock>\n      for (const position of positions) {\n        const range = getLastOutdentableSequenceRange(model, position, this._indentSequence);\n        if (range) {\n          // Previously deletion was done by writer.remove(). It was changed to deleteContent() to enable\n          // integration of code block with track changes. It's the easiest way of integration because deleteContent()\n          // is already integrated with track changes, but if it ever cause any troubles it can be reverted, however\n          // some additional work will be required in track changes integration of code block.\n          model.deleteContent(model.createSelection(range));\n        }\n      }\n    });\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @private\n  * @returns {Boolean} Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    if (!this._indentSequence) {\n      return false;\n    }\n    const model = this.editor.model;\n    if (!isModelSelectionInCodeBlock(model.document.selection)) {\n      return false;\n    }\n    // Outdent command can execute only when there is an indent character sequence\n    // in some of the lines.\n    return getIndentOutdentPositions(model).some(position => {\n      return getLastOutdentableSequenceRange(model, position, this._indentSequence);\n    });\n  }\n}\n// For a position coming from `getIndentOutdentPositions()`, it returns the range representing\n// the last occurrence of the indent sequence among the leading whitespaces of the code line the\n// position represents.\n//\n// For instance, assuming the indent sequence is 4x space (\"    \"):\n//\n//\t\t<codeBlock>foo^</codeBlock>                                 ->          null\n//\t\t<codeBlock>foo^<softBreak></softBreak>bar</codeBlock>       ->          null\n//\t\t<codeBlock>  ^foo</codeBlock>                               ->          null\n//\t\t<codeBlock>        ^foo</codeBlock>                         ->          <codeBlock>    [    ]foo</codeBlock>\n//\t\t<codeBlock>    ^foo    bar</codeBlock>                      ->          <codeBlock>[    ]foo    bar</codeBlock>\n//\n// @param {<module:engine/model/model~Model>} model\n// @param {<module:engine/model/position~Position>} position\n// @param {String} sequence\n// @returns {<module:engine/model/range~Range>|null}\nfunction getLastOutdentableSequenceRange(model, position, sequence) {\n  // Positions start before each text node (code line). Get the node corresponding to the position.\n  const nodeAtPosition = getTextNodeAtLineStart(position, model);\n  if (!nodeAtPosition) {\n    return null;\n  }\n  const leadingWhiteSpaces = getLeadingWhiteSpaces(nodeAtPosition);\n  const lastIndexOfSequence = leadingWhiteSpaces.lastIndexOf(sequence);\n  // For instance, assuming the indent sequence is 4x space (\"    \"):\n  //\n  //\t\t<codeBlock>    \t^foo</codeBlock>           ->             null\n  //\n  if (lastIndexOfSequence + sequence.length !== leadingWhiteSpaces.length) {\n    return null;\n  }\n  // For instance, assuming the indent sequence is 4x space (\"    \"):\n  //\n  //\t\t<codeBlock>  ^foo</codeBlock>           ->             null\n  //\n  if (lastIndexOfSequence === -1) {\n    return null;\n  }\n  const {\n    parent,\n    startOffset\n  } = nodeAtPosition;\n  // Create a range that contains the **last** indent sequence among the leading whitespaces\n  // of the line.\n  //\n  // For instance, assuming the indent sequence is 4x space (\"    \"):\n  //\n  //\t\t<codeBlock>        ^foo</codeBlock>      ->     <codeBlock>    [    ]foo</codeBlock>\n  //\n  return model.createRange(model.createPositionAt(parent, startOffset + lastIndexOfSequence), model.createPositionAt(parent, startOffset + lastIndexOfSequence + sequence.length));\n}\n\n/**\n * A model-to-view (both editing and data) converter for the `codeBlock` element.\n *\n * Sample input:\n *\n * ```html\n * <codeBlock language=\"javascript\">foo();<softBreak></softBreak>bar();</codeBlock>\n * ```\n *\n * Sample output (editing):\n *\n * ```html\n * <pre data-language=\"JavaScript\"><code class=\"language-javascript\">foo();<br />bar();</code></pre>\n * ```\n *\n * Sample output (data, see {@link module:code-block/converters~modelToDataViewSoftBreakInsertion}):\n *\n * ```html\n * <pre><code class=\"language-javascript\">foo();\\nbar();</code></pre>\n * ```\n *\n * @param languageDefs The normalized language configuration passed to the feature.\n * @param useLabels When `true`, the `<pre>` element will get a `data-language` attribute with a\n * humanâ€“readable label of the language. Used only in the editing.\n * @returns Returns a conversion callback.\n */\nfunction modelToViewCodeBlockInsertion(model, languageDefs, useLabels = false) {\n  // Language CSS classes:\n  //\n  //\t\t{\n  //\t\t\tphp: 'language-php',\n  //\t\t\tpython: 'language-python',\n  //\t\t\tjavascript: 'js',\n  //\t\t\t...\n  //\t\t}\n  const languagesToClasses = getPropertyAssociation(languageDefs, 'language', 'class');\n  // Language labels:\n  //\n  //\t\t{\n  //\t\t\tphp: 'PHP',\n  //\t\t\tpython: 'Python',\n  //\t\t\tjavascript: 'JavaScript',\n  //\t\t\t...\n  //\t\t}\n  const languagesToLabels = getPropertyAssociation(languageDefs, 'language', 'label');\n  return (evt, data, conversionApi) => {\n    const {\n      writer,\n      mapper,\n      consumable\n    } = conversionApi;\n    if (!consumable.consume(data.item, 'insert')) {\n      return;\n    }\n    const codeBlockLanguage = data.item.getAttribute('language');\n    const targetViewPosition = mapper.toViewPosition(model.createPositionBefore(data.item));\n    const preAttributes = {};\n    // Attributes added only in the editing view.\n    if (useLabels) {\n      preAttributes['data-language'] = languagesToLabels[codeBlockLanguage];\n      preAttributes.spellcheck = 'false';\n    }\n    const codeAttributes = languagesToClasses[codeBlockLanguage] ? {\n      class: languagesToClasses[codeBlockLanguage]\n    } : undefined;\n    const code = writer.createContainerElement('code', codeAttributes);\n    const pre = writer.createContainerElement('pre', preAttributes, code);\n    writer.insert(targetViewPosition, pre);\n    mapper.bindElements(data.item, code);\n  };\n}\n/**\n * A model-to-data view converter for the new line (`softBreak`) separator.\n *\n * Sample input:\n *\n * ```html\n * <codeBlock ...>foo();<softBreak></softBreak>bar();</codeBlock>\n * ```\n *\n * Sample output:\n *\n * ```html\n * <pre><code ...>foo();\\nbar();</code></pre>\n * ```\n *\n * @returns Returns a conversion callback.\n */\nfunction modelToDataViewSoftBreakInsertion(model) {\n  return (evt, data, conversionApi) => {\n    if (data.item.parent.name !== 'codeBlock') {\n      return;\n    }\n    const {\n      writer,\n      mapper,\n      consumable\n    } = conversionApi;\n    if (!consumable.consume(data.item, 'insert')) {\n      return;\n    }\n    const position = mapper.toViewPosition(model.createPositionBefore(data.item));\n    writer.insert(position, writer.createText('\\n'));\n  };\n}\n/**\n * A view-to-model converter for `<pre>` with the `<code>` HTML.\n *\n * Sample input:\n *\n * ```html\n * <pre><code class=\"language-javascript\">foo();bar();</code></pre>\n * ```\n *\n * Sample output:\n *\n * ```html\n * <codeBlock language=\"javascript\">foo();bar();</codeBlock>\n * ```\n *\n * @param languageDefs The normalized language configuration passed to the feature.\n * @returns Returns a conversion callback.\n */\nfunction dataViewToModelCodeBlockInsertion(editingView, languageDefs) {\n  // Language names associated with CSS classes:\n  //\n  //\t\t{\n  //\t\t\t'language-php': 'php',\n  //\t\t\t'language-python': 'python',\n  //\t\t\tjs: 'javascript',\n  //\t\t\t...\n  //\t\t}\n  const classesToLanguages = getPropertyAssociation(languageDefs, 'class', 'language');\n  const defaultLanguageName = languageDefs[0].language;\n  return (evt, data, conversionApi) => {\n    const viewCodeElement = data.viewItem;\n    const viewPreElement = viewCodeElement.parent;\n    if (!viewPreElement || !viewPreElement.is('element', 'pre')) {\n      return;\n    }\n    // In case of nested code blocks we don't want to convert to another code block.\n    if (data.modelCursor.findAncestor('codeBlock')) {\n      return;\n    }\n    const {\n      consumable,\n      writer\n    } = conversionApi;\n    if (!consumable.test(viewCodeElement, {\n      name: true\n    })) {\n      return;\n    }\n    const codeBlock = writer.createElement('codeBlock');\n    const viewChildClasses = [...viewCodeElement.getClassNames()];\n    // As we're to associate each class with a model language, a lack of class (empty class) can be\n    // also associated with a language if the language definition was configured so. Pushing an empty\n    // string to make sure the association will work.\n    if (!viewChildClasses.length) {\n      viewChildClasses.push('');\n    }\n    // Figure out if any of the <code> element's class names is a valid programming\n    // language class. If so, use it on the model element (becomes the language of the entire block).\n    for (const className of viewChildClasses) {\n      const language = classesToLanguages[className];\n      if (language) {\n        writer.setAttribute('language', language, codeBlock);\n        break;\n      }\n    }\n    // If no language value was set, use the default language from the config.\n    if (!codeBlock.hasAttribute('language')) {\n      writer.setAttribute('language', defaultLanguageName, codeBlock);\n    }\n    // Convert children before inserting the code block element\n    // to make sure that code block won't be splitted by any block.\n    conversionApi.convertChildren(viewCodeElement, codeBlock);\n    // Let's try to insert code block.\n    if (!conversionApi.safeInsert(codeBlock, data.modelCursor)) {\n      return;\n    }\n    consumable.consume(viewCodeElement, {\n      name: true\n    });\n    conversionApi.updateConversionResult(codeBlock, data);\n  };\n}\n/**\n * A view-to-model converter for new line characters in `<pre>`.\n *\n * Sample input:\n *\n * ```html\n * <pre><code class=\"language-javascript\">foo();\\nbar();</code></pre>\n * ```\n *\n * Sample output:\n *\n * ```html\n * <codeBlock language=\"javascript\">foo();<softBreak></softBreak>bar();</codeBlock>\n * ```\n *\n * @returns {Function} Returns a conversion callback.\n */\nfunction dataViewToModelTextNewlinesInsertion() {\n  return (evt, data, {\n    consumable,\n    writer\n  }) => {\n    let position = data.modelCursor;\n    // When node is already converted then do nothing.\n    if (!consumable.test(data.viewItem)) {\n      return;\n    }\n    // When not inside `codeBlock` then do nothing.\n    if (!position.findAncestor('codeBlock')) {\n      return;\n    }\n    consumable.consume(data.viewItem);\n    const text = data.viewItem.data;\n    const textLines = text.split('\\n').map(data => writer.createText(data));\n    const lastLine = textLines[textLines.length - 1];\n    for (const node of textLines) {\n      writer.insert(node, position);\n      position = position.getShiftedBy(node.offsetSize);\n      if (node !== lastLine) {\n        const softBreak = writer.createElement('softBreak');\n        writer.insert(softBreak, position);\n        position = writer.createPositionAfter(softBreak);\n      }\n    }\n    data.modelRange = writer.createRange(data.modelCursor, position);\n    data.modelCursor = position;\n  };\n}\n/**\n * A view-to-model converter that handles orphan text nodes (white spaces, new lines, etc.)\n * that surround `<code>` inside `<pre>`.\n *\n * Sample input:\n *\n * ```html\n * // White spaces\n * <pre> <code>foo()</code> </pre>\n *\n * // White spaces\n * <pre>      <code>foo()</code>      </pre>\n *\n * // White spaces\n * <pre>\t\t\t<code>foo()</code>\t\t\t</pre>\n *\n * // New lines\n * <pre>\n * \t<code>foo()</code>\n * </pre>\n *\n * // Redundant text\n * <pre>ABC<code>foo()</code>DEF</pre>\n * ```\n *\n * Unified output for each case:\n *\n * ```html\n * <codeBlock language=\"plaintext\">foo()</codeBlock>\n * ```\n *\n * @returns Returns a conversion callback.\n */\nfunction dataViewToModelOrphanNodeConsumer() {\n  return (evt, data, {\n    consumable\n  }) => {\n    const preElement = data.viewItem;\n    // Don't clean up nested pre elements. Their content should stay as it is, they are not upcasted\n    // to code blocks.\n    if (preElement.findAncestor('pre')) {\n      return;\n    }\n    const preChildren = Array.from(preElement.getChildren());\n    const childCodeElement = preChildren.find(node => node.is('element', 'code'));\n    // <code>-less <pre>. It will not upcast to code block in the model, skipping.\n    if (!childCodeElement) {\n      return;\n    }\n    for (const child of preChildren) {\n      if (child === childCodeElement || !child.is('$text')) {\n        continue;\n      }\n      // Consuming the orphan to remove it from the input data.\n      // Second argument in `consumable.consume` is discarded for text nodes.\n      consumable.consume(child, {\n        name: true\n      });\n    }\n  };\n}\nconst DEFAULT_ELEMENT = 'paragraph';\n/**\n * The editing part of the code block feature.\n *\n * Introduces the `'codeBlock'` command and the `'codeBlock'` model element.\n */\nclass CodeBlockEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CodeBlockEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ShiftEnter];\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('codeBlock', {\n      languages: [{\n        language: 'plaintext',\n        label: 'Plain text'\n      }, {\n        language: 'c',\n        label: 'C'\n      }, {\n        language: 'cs',\n        label: 'C#'\n      }, {\n        language: 'cpp',\n        label: 'C++'\n      }, {\n        language: 'css',\n        label: 'CSS'\n      }, {\n        language: 'diff',\n        label: 'Diff'\n      }, {\n        language: 'html',\n        label: 'HTML'\n      }, {\n        language: 'java',\n        label: 'Java'\n      }, {\n        language: 'javascript',\n        label: 'JavaScript'\n      }, {\n        language: 'php',\n        label: 'PHP'\n      }, {\n        language: 'python',\n        label: 'Python'\n      }, {\n        language: 'ruby',\n        label: 'Ruby'\n      }, {\n        language: 'typescript',\n        label: 'TypeScript'\n      }, {\n        language: 'xml',\n        label: 'XML'\n      }],\n      // A single tab.\n      indentSequence: '\\t'\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const model = editor.model;\n    const view = editor.editing.view;\n    const normalizedLanguagesDefs = getNormalizedAndLocalizedLanguageDefinitions(editor);\n    // The main command.\n    editor.commands.add('codeBlock', new CodeBlockCommand(editor));\n    // Commands that change the indentation.\n    editor.commands.add('indentCodeBlock', new IndentCodeBlockCommand(editor));\n    editor.commands.add('outdentCodeBlock', new OutdentCodeBlockCommand(editor));\n    this.listenTo(view.document, 'tab', (evt, data) => {\n      const commandName = data.shiftKey ? 'outdentCodeBlock' : 'indentCodeBlock';\n      const command = editor.commands.get(commandName);\n      if (!command.isEnabled) {\n        return;\n      }\n      editor.execute(commandName);\n      data.stopPropagation();\n      data.preventDefault();\n      evt.stop();\n    }, {\n      context: 'pre'\n    });\n    schema.register('codeBlock', {\n      allowWhere: '$block',\n      allowChildren: '$text',\n      // Disallow `$inlineObject` and its derivatives like `inlineWidget` inside `codeBlock` to ensure that only text,\n      // not other inline elements like inline images, are allowed. This maintains the semantic integrity of code blocks.\n      disallowChildren: '$inlineObject',\n      allowAttributes: ['language'],\n      allowAttributesOf: '$listItem',\n      isBlock: true\n    });\n    // Disallow formatting attributes on `codeBlock` children.\n    schema.addAttributeCheck((context, attributeName) => {\n      const parent = context.getItem(context.length - 2);\n      const isFormatting = schema.getAttributeProperties(attributeName).isFormatting;\n      if (isFormatting && parent && parent.name == 'codeBlock') {\n        return false;\n      }\n    });\n    // Conversion.\n    editor.editing.downcastDispatcher.on('insert:codeBlock', modelToViewCodeBlockInsertion(model, normalizedLanguagesDefs, true));\n    editor.data.downcastDispatcher.on('insert:codeBlock', modelToViewCodeBlockInsertion(model, normalizedLanguagesDefs));\n    editor.data.downcastDispatcher.on('insert:softBreak', modelToDataViewSoftBreakInsertion(model), {\n      priority: 'high'\n    });\n    editor.data.upcastDispatcher.on('element:code', dataViewToModelCodeBlockInsertion(view, normalizedLanguagesDefs));\n    editor.data.upcastDispatcher.on('text', dataViewToModelTextNewlinesInsertion());\n    editor.data.upcastDispatcher.on('element:pre', dataViewToModelOrphanNodeConsumer(), {\n      priority: 'high'\n    });\n    // Intercept the clipboard input (paste) when the selection is anchored in the code block and force the clipboard\n    // data to be pasted as a single plain text. Otherwise, the code lines will split the code block and\n    // \"spill out\" as separate paragraphs.\n    this.listenTo(editor.editing.view.document, 'clipboardInput', (evt, data) => {\n      let insertionRange = model.createRange(model.document.selection.anchor);\n      // Use target ranges in case this is a drop.\n      if (data.targetRanges) {\n        insertionRange = editor.editing.mapper.toModelRange(data.targetRanges[0]);\n      }\n      if (!insertionRange.start.parent.is('element', 'codeBlock')) {\n        return;\n      }\n      const text = data.dataTransfer.getData('text/plain');\n      const writer = new UpcastWriter(editor.editing.view.document);\n      // Pass the view fragment to the default clipboardInput handler.\n      data.content = rawSnippetTextToViewDocumentFragment(writer, text);\n    });\n    if (editor.plugins.has('ClipboardPipeline')) {\n      // Elements may have a plain textual representation (hence be present in the 'text/plain' data transfer),\n      // but not be allowed in the code block.\n      // Filter them out before inserting the content to the model.\n      editor.plugins.get(ClipboardPipeline).on('contentInsertion', (evt, data) => {\n        const model = editor.model;\n        const selection = model.document.selection;\n        if (!selection.anchor.parent.is('element', 'codeBlock')) {\n          return;\n        }\n        model.change(writer => {\n          const contentRange = writer.createRangeIn(data.content);\n          for (const item of [...contentRange.getItems()]) {\n            // Remove all nodes disallowed in the code block.\n            if (item.is('node') && !schema.checkChild(selection.anchor, item)) {\n              writer.remove(item);\n            }\n          }\n        });\n      });\n    }\n    // Make sure multiâ€“line selection is always wrapped in a code block when `getSelectedContent()`\n    // is used (e.g. clipboard copy). Otherwise, only the raw text will be copied to the clipboard and,\n    // upon next paste, this bare text will not be inserted as a code block, which is not the best UX.\n    // Similarly, when the selection in a single line, the selected content should be an inline code\n    // so it can be pasted later on and retain it's preformatted nature.\n    this.listenTo(model, 'getSelectedContent', (evt, [selection]) => {\n      const anchor = selection.anchor;\n      if (selection.isCollapsed || !anchor.parent.is('element', 'codeBlock') || !anchor.hasSameParentAs(selection.focus)) {\n        return;\n      }\n      model.change(writer => {\n        const docFragment = evt.return;\n        // fo[o<softBreak></softBreak>b]ar  ->   <codeBlock language=\"...\">[o<softBreak></softBreak>b]<codeBlock>\n        if (anchor.parent.is('element') && (docFragment.childCount > 1 || selection.containsEntireContent(anchor.parent))) {\n          const codeBlock = writer.createElement('codeBlock', anchor.parent.getAttributes());\n          writer.append(docFragment, codeBlock);\n          const newDocumentFragment = writer.createDocumentFragment();\n          writer.append(codeBlock, newDocumentFragment);\n          evt.return = newDocumentFragment;\n          return;\n        }\n        // \"f[oo]\"                          ->   <$text code=\"true\">oo</text>\n        const textNode = docFragment.getChild(0);\n        if (schema.checkAttribute(textNode, 'code')) {\n          writer.setAttribute('code', true, textNode);\n        }\n      });\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    const commands = editor.commands;\n    const indent = commands.get('indent');\n    const outdent = commands.get('outdent');\n    if (indent) {\n      // Priority is highest due to integration with `IndentList` command of `List` plugin.\n      // If selection is in a code block we give priority to it. This way list item cannot be indented\n      // but if we would give priority to indenting list item then user would have to indent list item\n      // as much as possible and only then he could indent code block.\n      indent.registerChildCommand(commands.get('indentCodeBlock'), {\n        priority: 'highest'\n      });\n    }\n    if (outdent) {\n      outdent.registerChildCommand(commands.get('outdentCodeBlock'));\n    }\n    // Customize the response to the <kbd>Enter</kbd> and <kbd>Shift</kbd>+<kbd>Enter</kbd>\n    // key press when the selection is in the code block. Upon enter key press we can either\n    // leave the block if it's \"two or three enters\" in a row or create a new code block line, preserving\n    // previous line's indentation.\n    this.listenTo(editor.editing.view.document, 'enter', (evt, data) => {\n      const positionParent = editor.model.document.selection.getLastPosition().parent;\n      if (!positionParent.is('element', 'codeBlock')) {\n        return;\n      }\n      if (!leaveBlockStartOnEnter(editor, data.isSoft) && !leaveBlockEndOnEnter(editor, data.isSoft)) {\n        breakLineOnEnter(editor);\n      }\n      data.preventDefault();\n      evt.stop();\n    }, {\n      context: 'pre'\n    });\n    this._initAriaAnnouncements();\n  }\n  /**\n  * Observe when user enters or leaves code block and set proper aria value in global live announcer.\n  * This allows screen readers to indicate when the user has entered and left the specified code block.\n  *\n  * @internal\n  */\n  _initAriaAnnouncements() {\n    const {\n      model,\n      ui,\n      t\n    } = this.editor;\n    const languageDefs = getNormalizedAndLocalizedLanguageDefinitions(this.editor);\n    let lastFocusedCodeBlock = null;\n    model.document.selection.on('change:range', () => {\n      const focusParent = model.document.selection.focus.parent;\n      if (!ui || lastFocusedCodeBlock === focusParent || !focusParent.is('element')) {\n        return;\n      }\n      if (lastFocusedCodeBlock && lastFocusedCodeBlock.is('element', 'codeBlock')) {\n        ui.ariaLiveAnnouncer.announce(getCodeBlockAriaAnnouncement(t, languageDefs, lastFocusedCodeBlock, 'leave'));\n      }\n      if (focusParent.is('element', 'codeBlock')) {\n        ui.ariaLiveAnnouncer.announce(getCodeBlockAriaAnnouncement(t, languageDefs, focusParent, 'enter'));\n      }\n      lastFocusedCodeBlock = focusParent;\n    });\n  }\n}\n/**\n * Normally, when the Enter (or Shift+Enter) key is pressed, a soft line break is to be added to the\n * code block. Let's try to follow the indentation of the previous line when possible, for instance:\n *\n * ```html\n * // Before pressing enter (or shift enter)\n * <codeBlock>\n * \"    foo()\"[]                   // Indent of 4 spaces.\n * </codeBlock>\n *\n * // After pressing:\n * <codeBlock>\n * \"    foo()\"                 // Indent of 4 spaces.\n * <softBreak></softBreak>     // A new soft break created by pressing enter.\n * \"    \"[]                    // Retain the indent of 4 spaces.\n * </codeBlock>\n * ```\n */\nfunction breakLineOnEnter(editor) {\n  const model = editor.model;\n  const modelDoc = model.document;\n  // Use last position as other mechanisms (e.g. condition deciding whether this function should be called) also check that.\n  const lastSelectionPosition = modelDoc.selection.getLastPosition();\n  let leadingWhiteSpaces;\n  const node = getTextNodeAtLineStart(lastSelectionPosition, model);\n  // Figure out the indentation (white space chars) at the beginning of the line.\n  if (node && node.is('$text')) {\n    leadingWhiteSpaces = getLeadingWhiteSpaces(node);\n  }\n  // Keeping everything in a change block for a single undo step.\n  editor.model.change(writer => {\n    editor.execute('shiftEnter');\n    // If the line before being broken in two had some indentation, let's retain it\n    // in the new line.\n    if (leadingWhiteSpaces) {\n      writer.insertText(leadingWhiteSpaces, modelDoc.selection.anchor);\n    }\n  });\n}\n/**\n * Leave the code block when Enter (but NOT Shift+Enter) has been pressed twice at the beginning\n * of the code block:\n *\n * ```html\n * // Before:\n * <codeBlock>[]<softBreak></softBreak>foo</codeBlock>\n *\n * // After pressing:\n * <paragraph>[]</paragraph><codeBlock>foo</codeBlock>\n * ```\n *\n * @param isSoftEnter When `true`, enter was pressed along with <kbd>Shift</kbd>.\n * @returns `true` when selection left the block. `false` if stayed.\n */\nfunction leaveBlockStartOnEnter(editor, isSoftEnter) {\n  const model = editor.model;\n  const modelDoc = model.document;\n  const view = editor.editing.view;\n  const lastSelectionPosition = modelDoc.selection.getLastPosition();\n  const nodeAfter = lastSelectionPosition.nodeAfter;\n  if (isSoftEnter || !modelDoc.selection.isCollapsed || !lastSelectionPosition.isAtStart) {\n    return false;\n  }\n  if (!isSoftBreakNode(nodeAfter)) {\n    return false;\n  }\n  // We're doing everything in a single change block to have a single undo step.\n  editor.model.change(writer => {\n    // \"Clone\" the <codeBlock> in the standard way.\n    editor.execute('enter');\n    // The cloned block exists now before the original code block.\n    const newBlock = modelDoc.selection.anchor.parent.previousSibling;\n    // Make the cloned <codeBlock> a regular <paragraph> (with clean attributes, so no language).\n    writer.rename(newBlock, DEFAULT_ELEMENT);\n    writer.setSelection(newBlock, 'in');\n    editor.model.schema.removeDisallowedAttributes([newBlock], writer);\n    // Remove the <softBreak> that originally followed the selection position.\n    writer.remove(nodeAfter);\n  });\n  // Eye candy.\n  view.scrollToTheSelection();\n  return true;\n}\n/**\n * Leave the code block when Enter (but NOT Shift+Enter) has been pressed twice at the end\n * of the code block:\n *\n * ```html\n * // Before:\n * <codeBlock>foo[]</codeBlock>\n *\n * // After first press:\n * <codeBlock>foo<softBreak></softBreak>[]</codeBlock>\n *\n * // After second press:\n * <codeBlock>foo</codeBlock><paragraph>[]</paragraph>\n * ```\n *\n * @param isSoftEnter When `true`, enter was pressed along with <kbd>Shift</kbd>.\n * @returns `true` when selection left the block. `false` if stayed.\n */\nfunction leaveBlockEndOnEnter(editor, isSoftEnter) {\n  const model = editor.model;\n  const modelDoc = model.document;\n  const view = editor.editing.view;\n  const lastSelectionPosition = modelDoc.selection.getLastPosition();\n  const nodeBefore = lastSelectionPosition.nodeBefore;\n  let emptyLineRangeToRemoveOnEnter;\n  if (isSoftEnter || !modelDoc.selection.isCollapsed || !lastSelectionPosition.isAtEnd || !nodeBefore || !nodeBefore.previousSibling) {\n    return false;\n  }\n  // When the position is directly preceded by two soft breaks\n  //\n  //\t\t<codeBlock>foo<softBreak></softBreak><softBreak></softBreak>[]</codeBlock>\n  //\n  // it creates the following range that will be cleaned up before leaving:\n  //\n  //\t\t<codeBlock>foo[<softBreak></softBreak><softBreak></softBreak>]</codeBlock>\n  //\n  if (isSoftBreakNode(nodeBefore) && isSoftBreakNode(nodeBefore.previousSibling)) {\n    emptyLineRangeToRemoveOnEnter = model.createRange(model.createPositionBefore(nodeBefore.previousSibling), model.createPositionAfter(nodeBefore));\n  } else if (isEmptyishTextNode(nodeBefore) && isSoftBreakNode(nodeBefore.previousSibling) && isSoftBreakNode(nodeBefore.previousSibling.previousSibling)) {\n    emptyLineRangeToRemoveOnEnter = model.createRange(model.createPositionBefore(nodeBefore.previousSibling.previousSibling), model.createPositionAfter(nodeBefore));\n  } else if (isEmptyishTextNode(nodeBefore) && isSoftBreakNode(nodeBefore.previousSibling) && isEmptyishTextNode(nodeBefore.previousSibling.previousSibling) && nodeBefore.previousSibling.previousSibling && isSoftBreakNode(nodeBefore.previousSibling.previousSibling.previousSibling)) {\n    emptyLineRangeToRemoveOnEnter = model.createRange(model.createPositionBefore(nodeBefore.previousSibling.previousSibling.previousSibling), model.createPositionAfter(nodeBefore));\n  } else {\n    return false;\n  }\n  // We're doing everything in a single change block to have a single undo step.\n  editor.model.change(writer => {\n    // Remove the last <softBreak>s and all white space characters that followed them.\n    writer.remove(emptyLineRangeToRemoveOnEnter);\n    // \"Clone\" the <codeBlock> in the standard way.\n    editor.execute('enter');\n    const newBlock = modelDoc.selection.anchor.parent;\n    // Make the cloned <codeBlock> a regular <paragraph> (with clean attributes, so no language).\n    writer.rename(newBlock, DEFAULT_ELEMENT);\n    editor.model.schema.removeDisallowedAttributes([newBlock], writer);\n  });\n  // Eye candy.\n  view.scrollToTheSelection();\n  return true;\n}\nfunction isEmptyishTextNode(node) {\n  return node && node.is('$text') && !node.data.match(/\\S/);\n}\nfunction isSoftBreakNode(node) {\n  return node && node.is('element', 'softBreak');\n}\n\n/**\n * The code block UI plugin.\n *\n * Introduces the `'codeBlock'` dropdown.\n */\nclass CodeBlockUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CodeBlockUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const componentFactory = editor.ui.componentFactory;\n    const normalizedLanguageDefs = getNormalizedAndLocalizedLanguageDefinitions(editor);\n    const itemDefinitions = this._getLanguageListItemDefinitions(normalizedLanguageDefs);\n    const command = editor.commands.get('codeBlock');\n    componentFactory.add('codeBlock', locale => {\n      const dropdownView = createDropdown(locale, SplitButtonView);\n      const splitButtonView = dropdownView.buttonView;\n      const accessibleLabel = t('Insert code block');\n      splitButtonView.set({\n        label: accessibleLabel,\n        tooltip: true,\n        icon: IconCodeBlock,\n        isToggleable: true\n      });\n      splitButtonView.bind('isOn').to(command, 'value', value => !!value);\n      splitButtonView.on('execute', () => {\n        editor.execute('codeBlock', {\n          usePreviousLanguageChoice: true\n        });\n        editor.editing.view.focus();\n      });\n      dropdownView.on('execute', evt => {\n        editor.execute('codeBlock', {\n          language: evt.source._codeBlockLanguage,\n          forceValue: true\n        });\n        editor.editing.view.focus();\n      });\n      dropdownView.class = 'ck-code-block-dropdown';\n      dropdownView.bind('isEnabled').to(command);\n      addListToDropdown(dropdownView, itemDefinitions, {\n        role: 'menu',\n        ariaLabel: accessibleLabel\n      });\n      return dropdownView;\n    });\n    componentFactory.add('menuBar:codeBlock', locale => {\n      const menuView = new MenuBarMenuView(locale);\n      menuView.buttonView.set({\n        role: 'menuitem',\n        label: t('Code block'),\n        icon: IconCodeBlock\n      });\n      menuView.bind('isEnabled').to(command);\n      const listView = new MenuBarMenuListView(locale);\n      listView.set({\n        ariaLabel: t('Insert code block')\n      });\n      for (const definition of itemDefinitions) {\n        const listItemView = new MenuBarMenuListItemView(locale, menuView);\n        const buttonView = new MenuBarMenuListItemButtonView(locale);\n        buttonView.bind(...Object.keys(definition.model)).to(definition.model);\n        buttonView.set({\n          isToggleable: true,\n          role: 'menuitemcheckbox'\n        });\n        buttonView.delegate('execute').to(menuView);\n        buttonView.on('execute', () => {\n          editor.execute('codeBlock', {\n            language: definition.model._codeBlockLanguage,\n            forceValue: command.value == definition.model._codeBlockLanguage ? false : true\n          });\n          editor.editing.view.focus();\n        });\n        listItemView.children.add(buttonView);\n        listView.items.add(listItemView);\n      }\n      menuView.panelView.children.add(listView);\n      return menuView;\n    });\n  }\n  /**\n  * A helper returning a collection of the `codeBlock` dropdown items representing languages\n  * available for the user to choose from.\n  */\n  _getLanguageListItemDefinitions(normalizedLanguageDefs) {\n    const editor = this.editor;\n    const command = editor.commands.get('codeBlock');\n    const itemDefinitions = new Collection();\n    for (const languageDef of normalizedLanguageDefs) {\n      const definition = {\n        type: 'button',\n        model: new ViewModel({\n          _codeBlockLanguage: languageDef.language,\n          label: languageDef.label,\n          role: 'menuitemradio',\n          withText: true\n        })\n      };\n      definition.model.bind('isOn').to(command, 'value', value => {\n        return value === definition.model._codeBlockLanguage;\n      });\n      itemDefinitions.add(definition);\n    }\n    return itemDefinitions;\n  }\n}\n\n/**\n * The code block plugin.\n *\n * For more information about this feature check the {@glink api/code-block package page} and the\n * {@glink features/code-blocks code block} feature guide.\n *\n * This is a \"glue\" plugin that loads the {@link module:code-block/codeblockediting~CodeBlockEditing code block editing feature}\n * and the {@link module:code-block/codeblockui~CodeBlockUI code block UI feature}.\n */\nclass CodeBlock extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [CodeBlockEditing, CodeBlockUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CodeBlock';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { CodeBlock, CodeBlockEditing, CodeBlockUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { logWarning } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { FileRepository } from '@ckeditor/ckeditor5-upload/dist/index.js';\n\n/**\n * A plugin that enables upload to [CKEditor Cloud Services](https://ckeditor.com/ckeditor-cloud-services/).\n *\n * It is mainly used by the {@link module:easy-image/easyimage~EasyImage} feature.\n *\n * After enabling this adapter you need to configure the CKEditor Cloud Services integration through\n * {@link module:cloud-services/cloudservicesconfig~CloudServicesConfig `config.cloudServices`}.\n */\nclass CloudServicesUploadAdapter extends Plugin {\n  _uploadGateway;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CloudServicesUploadAdapter';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return ['CloudServices', FileRepository];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const cloudServices = editor.plugins.get('CloudServices');\n    const token = cloudServices.token;\n    const uploadUrl = cloudServices.uploadUrl;\n    if (!token) {\n      return;\n    }\n    const cloudServicesCore = editor.plugins.get('CloudServicesCore');\n    this._uploadGateway = cloudServicesCore.createUploadGateway(token, uploadUrl);\n    editor.plugins.get(FileRepository).createUploadAdapter = loader => {\n      return new Adapter(this._uploadGateway, loader);\n    };\n  }\n}\nclass Adapter {\n  uploadGateway;\n  loader;\n  fileUploader;\n  constructor(uploadGateway, loader) {\n    this.uploadGateway = uploadGateway;\n    this.loader = loader;\n  }\n  upload() {\n    return this.loader.file.then(file => {\n      this.fileUploader = this.uploadGateway.upload(file);\n      this.fileUploader.on('progress', (evt, data) => {\n        this.loader.uploadTotal = data.total;\n        this.loader.uploaded = data.uploaded;\n      });\n      return this.fileUploader.send();\n    });\n  }\n  abort() {\n    this.fileUploader.abort();\n  }\n}\n\n/**\n * The Easy Image feature, which makes the image upload in CKEditor 5 possible with virtually zero\n * server setup. A part of the [CKEditor Cloud Services](https://ckeditor.com/ckeditor-cloud-services/)\n * family.\n *\n * This is a \"glue\" plugin which enables:\n *\n * * {@link module:easy-image/cloudservicesuploadadapter~CloudServicesUploadAdapter}.\n *\n * This plugin requires plugin to be present in the editor configuration:\n *\n * * {@link module:image/image~Image},\n * * {@link module:image/imageupload~ImageUpload},\n *\n * See the [Easy Image Quick Start guide](https://ckeditor.com/docs/cs/latest/guides/easy-image/quick-start.html) to learn how to configure\n * and use this feature.\n *\n * Check out the {@glink features/images/image-upload/image-upload comprehensive \"Image upload\" guide} to learn about\n * other ways to upload images into CKEditor 5.\n *\n * **Note**: After enabling the Easy Image plugin you need to configure the\n * [CKEditor Cloud Services](https://ckeditor.com/ckeditor-cloud-services/)\n * integration through {@link module:cloud-services/cloudservicesconfig~CloudServicesConfig `config.cloudServices`}.\n */\nclass EasyImage extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'EasyImage';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [CloudServicesUploadAdapter, 'ImageUpload'];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!editor.plugins.has('ImageBlockEditing') && !editor.plugins.has('ImageInlineEditing')) {\n      /**\n      * The Easy Image feature requires one of the following plugins to be loaded to work correctly:\n      *\n      * * {@link module:image/imageblock~ImageBlock},\n      * * {@link module:image/imageinline~ImageInline},\n      * * {@link module:image/image~Image} (loads both `ImageBlock` and `ImageInline`)\n      *\n      * Please make sure your editor configuration is correct.\n      *\n      * @error easy-image-image-feature-missing\n      * @param {module:core/editor/editor~Editor} editor\n      */\n      logWarning('easy-image-image-feature-missing', editor);\n    }\n  }\n}\nexport { CloudServicesUploadAdapter, EasyImage };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { ElementApiMixin, Editor, secureSourceElement, attachToForm } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { EditorUI, EditorUIView, InlineEditableUIView, MenuBarView, BalloonToolbar } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { CKEditorError, getDataFromElement } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { enablePlaceholder } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { isElement as isElement$1 } from 'es-toolkit/compat';\n\n/**\n * The balloon editor UI class.\n */\nclass BalloonEditorUI extends EditorUI {\n  /**\n  * The main (topâ€“most) view of the editor UI.\n  */\n  view;\n  /**\n  * Creates an instance of the balloon editor UI class.\n  *\n  * @param editor The editor instance.\n  * @param view The view of the UI.\n  */\n  constructor(editor, view) {\n    super(editor);\n    this.view = view;\n  }\n  /**\n  * @inheritDoc\n  */\n  get element() {\n    return this.view.editable.element;\n  }\n  /**\n  * Initializes the UI.\n  */\n  init() {\n    const editor = this.editor;\n    const view = this.view;\n    const editingView = editor.editing.view;\n    const editable = view.editable;\n    const editingRoot = editingView.document.getRoot();\n    // The editable UI and editing root should share the same name. Then name is used\n    // to recognize the particular editable, for instance in ARIA attributes.\n    editable.name = editingRoot.rootName;\n    view.render();\n    // The editable UI element in DOM is available for sure only after the editor UI view has been rendered.\n    // But it can be available earlier if a DOM element has been passed to BalloonEditor.create().\n    const editableElement = editable.element;\n    // Register the editable UI view in the editor. A single editor instance can aggregate multiple\n    // editable areas (roots) but the balloon editor has only one.\n    this.setEditableElement(editable.name, editableElement);\n    // Let the editable UI element respond to the changes in the global editor focus\n    // tracker. It has been added to the same tracker a few lines above but, in reality, there are\n    // many focusable areas in the editor, like balloons, toolbars or dropdowns and as long\n    // as they have focus, the editable should act like it is focused too (although technically\n    // it isn't), e.g. by setting the proper CSS class, visually announcing focus to the user.\n    // Doing otherwise will result in editable focus styles disappearing, once e.g. the\n    // toolbar gets focused.\n    editable.bind('isFocused').to(this.focusTracker);\n    // Bind the editable UI element to the editing view, making it an endâ€“ and entryâ€“point\n    // of the editor's engine. This is where the engine meets the UI.\n    editingView.attachDomRoot(editableElement);\n    this._initPlaceholder();\n    this.initMenuBar(this.view.menuBarView);\n    this.fire('ready');\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    const view = this.view;\n    const editingView = this.editor.editing.view;\n    if (editingView.getDomRoot(view.editable.name)) {\n      editingView.detachDomRoot(view.editable.name);\n    }\n    view.destroy();\n  }\n  /**\n  * Enable the placeholder text on the editing root.\n  */\n  _initPlaceholder() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const editingRoot = editingView.document.getRoot();\n    const placeholder = editor.config.get('placeholder');\n    if (placeholder) {\n      const placeholderText = typeof placeholder === 'string' ? placeholder : placeholder[editingRoot.rootName];\n      if (placeholderText) {\n        editingRoot.placeholder = placeholderText;\n      }\n    }\n    enablePlaceholder({\n      view: editingView,\n      element: editingRoot,\n      isDirectHost: false,\n      keepOnFocus: true\n    });\n  }\n}\n\n/**\n * Contextual editor UI view. Uses the {@link module:ui/editableui/inline/inlineeditableuiview~InlineEditableUIView}.\n */\nclass BalloonEditorUIView extends EditorUIView {\n  /**\n  * Editable UI view.\n  */\n  editable;\n  /**\n  * Menu bar view instance.\n  */\n  menuBarView;\n  /**\n  * Creates an instance of the balloon editor UI view.\n  *\n  * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n  * @param editingView The editing view instance this view is related to.\n  * @param editableElement The editable element. If not specified, it will be automatically created by\n  * {@link module:ui/editableui/editableuiview~EditableUIView}. Otherwise, the given element will be used.\n  * @param label When set, this value will be used as an accessible `aria-label` of the\n  * {@link module:ui/editableui/editableuiview~EditableUIView editable view}.\n  */\n  constructor(locale, editingView, editableElement, label) {\n    super(locale);\n    this.editable = new InlineEditableUIView(locale, editingView, editableElement, {\n      label\n    });\n    this.menuBarView = new MenuBarView(locale);\n    this.menuBarView.extendTemplate({\n      attributes: {\n        class: ['ck-reset_all', 'ck-rounded-corners'],\n        dir: locale.uiLanguageDirection\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.registerChild(this.editable);\n    this.registerChild(this.menuBarView);\n  }\n}\n\n/**\n * The balloon editor implementation (Medium-like editor).\n * It uses an inline editable and a toolbar based on the {@link module:ui/toolbar/balloon/balloontoolbar~BalloonToolbar}.\n * See the {@glink examples/builds/balloon-editor demo}.\n *\n * In order to create a balloon editor instance, use the static\n * {@link module:editor-balloon/ballooneditor~BalloonEditor.create `BalloonEditor.create()`} method.\n */\nclass BalloonEditor extends /* #__PURE__ */ElementApiMixin(Editor) {\n  /**\n  * @inheritDoc\n  */\n  static get editorName() {\n    return 'BalloonEditor';\n  }\n  /**\n  * @inheritDoc\n  */\n  ui;\n  /**\n  * Creates an instance of the balloon editor.\n  *\n  * **Note:** do not use the constructor to create editor instances. Use the static\n  * {@link module:editor-balloon/ballooneditor~BalloonEditor.create `BalloonEditor.create()`} method instead.\n  *\n  * @param sourceElementOrData The DOM element that will be the source for the created editor\n  * (on which the editor will be initialized) or initial data for the editor. For more information see\n  * {@link module:editor-balloon/ballooneditor~BalloonEditor.create `BalloonEditor.create()`}.\n  * @param config The editor configuration.\n  */\n  constructor(sourceElementOrData, config = {}) {\n    // If both `config.initialData` is set and initial data is passed as the constructor parameter, then throw.\n    if (!isElement(sourceElementOrData) && config.initialData !== undefined) {\n      // Documented in core/editor/editorconfig.jsdoc.\n      // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n      throw new CKEditorError('editor-create-initial-data', null);\n    }\n    super(config);\n    if (this.config.get('initialData') === undefined) {\n      this.config.set('initialData', getInitialData(sourceElementOrData));\n    }\n    if (isElement(sourceElementOrData)) {\n      this.sourceElement = sourceElementOrData;\n      secureSourceElement(this, sourceElementOrData);\n    }\n    const plugins = this.config.get('plugins');\n    plugins.push(BalloonToolbar);\n    this.config.set('plugins', plugins);\n    this.config.define('balloonToolbar', this.config.get('toolbar'));\n    this.model.document.createRoot();\n    const view = new BalloonEditorUIView(this.locale, this.editing.view, this.sourceElement, this.config.get('label'));\n    this.ui = new BalloonEditorUI(this, view);\n    attachToForm(this);\n  }\n  /**\n  * Destroys the editor instance, releasing all resources used by it.\n  *\n  * Updates the original editor element with the data if the\n  * {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy `updateSourceElementOnDestroy`}\n  * configuration option is set to `true`.\n  */\n  destroy() {\n    // Cache the data, then destroy.\n    // It's safe to assume that the model->view conversion will not work after super.destroy().\n    const data = this.getData();\n    this.ui.destroy();\n    return super.destroy().then(() => {\n      if (this.sourceElement) {\n        this.updateSourceElement(data);\n      }\n    });\n  }\n  /**\n  * Creates a new balloon editor instance.\n  *\n  * There are three general ways how the editor can be initialized.\n  *\n  * # Using an existing DOM element (and loading data from it)\n  *\n  * You can initialize the editor using an existing DOM element:\n  *\n  * ```ts\n  * BalloonEditor\n  * \t.create( document.querySelector( '#editor' ) )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * The element's content will be used as the editor data and the element will become the editable element.\n  *\n  * # Creating a detached editor\n  *\n  * Alternatively, you can initialize the editor by passing the initial data directly as a string.\n  * In this case, the editor will render an element that must be inserted into the DOM for the editor to work properly:\n  *\n  * ```ts\n  * BalloonEditor\n  * \t.create( '<p>Hello world!</p>' )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  *\n  * \t\t// Initial data was provided so the editor UI element needs to be added manually to the DOM.\n  * \t\tdocument.body.appendChild( editor.ui.element );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * This lets you dynamically append the editor to your web page whenever it is convenient for you. You may use this method if your\n  * web page content is generated on the client side and the DOM structure is not ready at the moment when you initialize the editor.\n  *\n  * # Using an existing DOM element (and data provided in `config.initialData`)\n  *\n  * You can also mix these two ways by providing a DOM element to be used and passing the initial data through the configuration:\n  *\n  * ```ts\n  * BalloonEditor\n  * \t.create( document.querySelector( '#editor' ), {\n  * \t\tinitialData: '<h2>Initial data</h2><p>Foo bar.</p>'\n  * \t} )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * This method can be used to initialize the editor on an existing element with the specified content in case if your integration\n  * makes it difficult to set the content of the source element.\n  *\n  * Note that an error will be thrown if you pass the initial data both as the first parameter and also in the configuration.\n  *\n  * # Configuring the editor\n  *\n  * See the {@link module:core/editor/editorconfig~EditorConfig editor configuration documentation} to learn more about\n  * customizing plugins, toolbar and more.\n  *\n  * # Using the editor from source\n  *\n  * If you want to use the balloon editor,\n  * you need to define the list of\n  * {@link module:core/editor/editorconfig~EditorConfig#plugins plugins to be initialized} and\n  * {@link module:core/editor/editorconfig~EditorConfig#toolbar toolbar items}.\n  *\n  * @param sourceElementOrData The DOM element that will be the source for the created editor\n  * or the editor's initial data.\n  *\n  * If a DOM element is passed, its content will be automatically loaded to the editor upon initialization.\n  * The editor data will be set back to the original element once the editor is destroyed only if the\n  * {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy updateSourceElementOnDestroy}\n  * option is set to `true`.\n  *\n  * If the initial data is passed, a detached editor will be created. In this case you need to insert it into the DOM manually.\n  * It is available under the {@link module:editor-balloon/ballooneditorui~BalloonEditorUI#element `editor.ui.element`} property.\n  *\n  * @param config The editor configuration.\n  * @returns A promise resolved once the editor is ready. The promise resolves with the created editor instance.\n  */\n  static create(sourceElementOrData, config = {}) {\n    return new Promise(resolve => {\n      if (isElement(sourceElementOrData) && sourceElementOrData.tagName === 'TEXTAREA') {\n        // Documented in core/editor/editor.js\n        // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n        throw new CKEditorError('editor-wrong-element', null);\n      }\n      const editor = new this(sourceElementOrData, config);\n      resolve(editor.initPlugins().then(() => editor.ui.init()).then(() => editor.data.init(editor.config.get('initialData'))).then(() => editor.fire('ready')).then(() => editor));\n    });\n  }\n}\nfunction getInitialData(sourceElementOrData) {\n  return isElement(sourceElementOrData) ? getDataFromElement(sourceElementOrData) : sourceElementOrData;\n}\nfunction isElement(value) {\n  return isElement$1(value);\n}\nexport { BalloonEditor };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { EditorUI, normalizeToolbarConfig, DialogView, BoxedEditorUIView, StickyPanelView, ToolbarView, MenuBarView, InlineEditableUIView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { enablePlaceholder } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { ElementReplacer, Rect, CKEditorError, getDataFromElement } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { ElementApiMixin, Editor, attachToForm } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { isElement as isElement$1 } from 'es-toolkit/compat';\n\n/**\n * The classic editor UI class.\n */\nclass ClassicEditorUI extends EditorUI {\n  /**\n  * The main (topâ€“most) view of the editor UI.\n  */\n  view;\n  /**\n  * A normalized `config.toolbar` object.\n  */\n  _toolbarConfig;\n  /**\n  * The element replacer instance used to hide the editor's source element.\n  */\n  _elementReplacer;\n  /**\n  * Creates an instance of the classic editor UI class.\n  *\n  * @param editor The editor instance.\n  * @param view The view of the UI.\n  */\n  constructor(editor, view) {\n    super(editor);\n    this.view = view;\n    this._toolbarConfig = normalizeToolbarConfig(editor.config.get('toolbar'));\n    this._elementReplacer = new ElementReplacer();\n    this.listenTo(editor.editing.view, 'scrollToTheSelection', this._handleScrollToTheSelectionWithStickyPanel.bind(this));\n  }\n  /**\n  * @inheritDoc\n  */\n  get element() {\n    return this.view.element;\n  }\n  /**\n  * Initializes the UI.\n  *\n  * @param replacementElement The DOM element that will be the source for the created editor.\n  */\n  init(replacementElement) {\n    const editor = this.editor;\n    const view = this.view;\n    const editingView = editor.editing.view;\n    const editable = view.editable;\n    const editingRoot = editingView.document.getRoot();\n    // The editable UI and editing root should share the same name. Then name is used\n    // to recognize the particular editable, for instance in ARIA attributes.\n    editable.name = editingRoot.rootName;\n    view.render();\n    // The editable UI element in DOM is available for sure only after the editor UI view has been rendered.\n    // But it can be available earlier if a DOM element has been passed to BalloonEditor.create().\n    const editableElement = editable.element;\n    // Register the editable UI view in the editor. A single editor instance can aggregate multiple\n    // editable areas (roots) but the classic editor has only one.\n    this.setEditableElement(editable.name, editableElement);\n    // Let the editable UI element respond to the changes in the global editor focus\n    // tracker. It has been added to the same tracker a few lines above but, in reality, there are\n    // many focusable areas in the editor, like balloons, toolbars or dropdowns and as long\n    // as they have focus, the editable should act like it is focused too (although technically\n    // it isn't), e.g. by setting the proper CSS class, visually announcing focus to the user.\n    // Doing otherwise will result in editable focus styles disappearing, once e.g. the\n    // toolbar gets focused.\n    view.editable.bind('isFocused').to(this.focusTracker);\n    // Bind the editable UI element to the editing view, making it an endâ€“ and entryâ€“point\n    // of the editor's engine. This is where the engine meets the UI.\n    editingView.attachDomRoot(editableElement);\n    // If an element containing the initial data of the editor was provided, replace it with\n    // an editor instance's UI in DOM until the editor is destroyed. For instance, a <textarea>\n    // can be such element.\n    if (replacementElement) {\n      this._elementReplacer.replace(replacementElement, this.element);\n    }\n    this._initPlaceholder();\n    this._initToolbar();\n    if (view.menuBarView) {\n      this.initMenuBar(view.menuBarView);\n    }\n    this._initDialogPluginIntegration();\n    this._initContextualBalloonIntegration();\n    this.fire('ready');\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    const view = this.view;\n    const editingView = this.editor.editing.view;\n    this._elementReplacer.restore();\n    if (editingView.getDomRoot(view.editable.name)) {\n      editingView.detachDomRoot(view.editable.name);\n    }\n    view.destroy();\n  }\n  /**\n  * Initializes the editor toolbar.\n  */\n  _initToolbar() {\n    const view = this.view;\n    // Setâ€“up the sticky panel with toolbar.\n    view.stickyPanel.bind('isActive').to(this.focusTracker, 'isFocused');\n    view.stickyPanel.limiterElement = view.element;\n    view.stickyPanel.bind('viewportTopOffset').to(this, 'viewportOffset', ({\n      top\n    }) => top || 0);\n    view.toolbar.fillFromConfig(this._toolbarConfig, this.componentFactory);\n    // Register the toolbar so it becomes available for Alt+F10 and Esc navigation.\n    this.addToolbar(view.toolbar);\n  }\n  /**\n  * Enable the placeholder text on the editing root.\n  */\n  _initPlaceholder() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const editingRoot = editingView.document.getRoot();\n    const sourceElement = editor.sourceElement;\n    let placeholderText;\n    const placeholder = editor.config.get('placeholder');\n    if (placeholder) {\n      placeholderText = typeof placeholder === 'string' ? placeholder : placeholder[this.view.editable.name];\n    }\n    if (!placeholderText && sourceElement && sourceElement.tagName.toLowerCase() === 'textarea') {\n      placeholderText = sourceElement.getAttribute('placeholder');\n    }\n    if (placeholderText) {\n      editingRoot.placeholder = placeholderText;\n    }\n    enablePlaceholder({\n      view: editingView,\n      element: editingRoot,\n      isDirectHost: false,\n      keepOnFocus: true\n    });\n  }\n  /**\n  * Provides an integration between the sticky toolbar and {@link module:ui/panel/balloon/contextualballoon contextual balloon plugin}.\n  * It allows the contextual balloon to consider the height of the\n  * {@link module:editor-classic/classiceditoruiview~ClassicEditorUIView#stickyPanel}. It prevents the balloon from overlapping\n  * the sticky toolbar by adjusting the balloon's position using viewport offset configuration.\n  */\n  _initContextualBalloonIntegration() {\n    if (!this.editor.plugins.has('ContextualBalloon')) {\n      return;\n    }\n    const {\n      stickyPanel\n    } = this.view;\n    const contextualBalloon = this.editor.plugins.get('ContextualBalloon');\n    contextualBalloon.on('getPositionOptions', evt => {\n      const position = evt.return;\n      if (!position || !stickyPanel.isSticky || !stickyPanel.element) {\n        return;\n      }\n      // Measure toolbar (and menu bar) height.\n      const stickyPanelHeight = new Rect(stickyPanel.element).height;\n      // Handle edge case when the target element is larger than the limiter.\n      // It's an issue because the contextual balloon can overlap top table cells when the table is larger than the viewport\n      // and it's placed at the top of the editor. It's better to overlap toolbar in that situation.\n      // Check this issue: https://github.com/ckeditor/ckeditor5/issues/15744\n      const target = typeof position.target === 'function' ? position.target() : position.target;\n      const limiter = typeof position.limiter === 'function' ? position.limiter() : position.limiter;\n      if (target && limiter && new Rect(target).height >= new Rect(limiter).height - stickyPanelHeight) {\n        return;\n      }\n      // Ensure that viewport offset is present, it can be undefined according to the typing.\n      const viewportOffsetConfig = {\n        ...position.viewportOffsetConfig\n      };\n      const newTopViewportOffset = (viewportOffsetConfig.top || 0) + stickyPanelHeight;\n      evt.return = {\n        ...position,\n        viewportOffsetConfig: {\n          ...viewportOffsetConfig,\n          top: newTopViewportOffset\n        }\n      };\n    }, {\n      priority: 'low'\n    });\n    // Update balloon position when the toolbar becomes sticky or when ui viewportOffset changes.\n    const updateBalloonPosition = () => {\n      if (contextualBalloon.visibleView) {\n        contextualBalloon.updatePosition();\n      }\n    };\n    this.listenTo(stickyPanel, 'change:isSticky', updateBalloonPosition);\n    this.listenTo(this.editor.ui, 'change:viewportOffset', updateBalloonPosition);\n  }\n  /**\n  * Provides an integration between the sticky toolbar and {@link module:utils/dom/scroll~scrollViewportToShowTarget}.\n  * It allows the UI-agnostic engine method to consider the geometry of the\n  * {@link module:editor-classic/classiceditoruiview~ClassicEditorUIView#stickyPanel} that pins to the\n  * edge of the viewport and can obscure the user caret after scrolling the window.\n  *\n  * @param evt The `scrollToTheSelection` event info.\n  * @param data The payload carried by the `scrollToTheSelection` event.\n  * @param originalArgs The original arguments passed to `scrollViewportToShowTarget()` method (see implementation to learn more).\n  */\n  _handleScrollToTheSelectionWithStickyPanel(evt, data, originalArgs) {\n    const stickyPanel = this.view.stickyPanel;\n    if (stickyPanel.isSticky) {\n      const stickyPanelHeight = new Rect(stickyPanel.element).height;\n      data.viewportOffset.top += stickyPanelHeight;\n    } else {\n      const scrollViewportOnPanelGettingSticky = () => {\n        this.editor.editing.view.scrollToTheSelection(originalArgs);\n      };\n      this.listenTo(stickyPanel, 'change:isSticky', scrollViewportOnPanelGettingSticky);\n      // This works as a post-scroll-fixer because it's impossible predict whether the panel will be sticky after scrolling or not.\n      // Listen for a short period of time only and if the toolbar does not become sticky very soon, cancel the listener.\n      setTimeout(() => {\n        this.stopListening(stickyPanel, 'change:isSticky', scrollViewportOnPanelGettingSticky);\n      }, 20);\n    }\n  }\n  /**\n  * Provides an integration between the sticky toolbar and {@link module:ui/dialog/dialog the Dialog plugin}.\n  *\n  * It moves the dialog down to ensure that the\n  * {@link module:editor-classic/classiceditoruiview~ClassicEditorUIView#stickyPanel sticky panel}\n  * used by the editor UI will not get obscured by the dialog when the dialog uses one of its automatic positions.\n  */\n  _initDialogPluginIntegration() {\n    if (!this.editor.plugins.has('Dialog')) {\n      return;\n    }\n    const stickyPanel = this.view.stickyPanel;\n    const dialogPlugin = this.editor.plugins.get('Dialog');\n    dialogPlugin.on('show', () => {\n      const dialogView = dialogPlugin.view;\n      dialogView.on('moveTo', (evt, data) => {\n        // Engage only when the panel is sticky, and the dialog is using one of default positions.\n        // Ignore modals because they are displayed on top of the page (and overlay) and they do not collide with anything\n        // See (https://github.com/ckeditor/ckeditor5/issues/17339).\n        if (!stickyPanel.isSticky || dialogView.wasMoved || dialogView.isModal) {\n          return;\n        }\n        const stickyPanelContentRect = new Rect(stickyPanel.contentPanelElement);\n        if (data[1] < stickyPanelContentRect.bottom + DialogView.defaultOffset) {\n          data[1] = stickyPanelContentRect.bottom + DialogView.defaultOffset;\n        }\n      }, {\n        priority: 'high'\n      });\n    }, {\n      priority: 'low'\n    });\n  }\n}\n\n/**\n * Classic editor UI view. Uses an inline editable and a sticky toolbar, all\n * enclosed in a boxed UI view.\n */\nclass ClassicEditorUIView extends BoxedEditorUIView {\n  /**\n  * Sticky panel view instance. This is a parent view of a {@link #toolbar}\n  * that makes toolbar sticky.\n  */\n  stickyPanel;\n  /**\n  * Toolbar view instance.\n  */\n  toolbar;\n  /**\n  * Editable UI view.\n  */\n  editable;\n  /**\n  * Creates an instance of the classic editor UI view.\n  *\n  * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n  * @param editingView The editing view instance this view is related to.\n  * @param options Configuration options for the view instance.\n  * @param options.shouldToolbarGroupWhenFull When set `true` enables automatic items grouping\n  * in the main {@link module:editor-classic/classiceditoruiview~ClassicEditorUIView#toolbar toolbar}.\n  * See {@link module:ui/toolbar/toolbarview~ToolbarOptions#shouldGroupWhenFull} to learn more.\n  * @param options.label When set, this value will be used as an accessible `aria-label` of the\n  * {@link module:ui/editableui/editableuiview~EditableUIView editable view}.\n  */\n  constructor(locale, editingView, options = {}) {\n    super(locale);\n    this.stickyPanel = new StickyPanelView(locale);\n    this.toolbar = new ToolbarView(locale, {\n      shouldGroupWhenFull: options.shouldToolbarGroupWhenFull\n    });\n    if (options.useMenuBar) {\n      this.menuBarView = new MenuBarView(locale);\n    }\n    this.editable = new InlineEditableUIView(locale, editingView, undefined, {\n      label: options.label\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    if (this.menuBarView) {\n      // Set toolbar as a child of a stickyPanel and makes toolbar sticky.\n      this.stickyPanel.content.addMany([this.menuBarView, this.toolbar]);\n    } else {\n      this.stickyPanel.content.add(this.toolbar);\n    }\n    this.top.add(this.stickyPanel);\n    this.main.add(this.editable);\n  }\n}\n\n/**\n * The classic editor implementation. It uses an inline editable and a sticky toolbar, all enclosed in a boxed UI.\n * See the {@glink examples/builds/classic-editor demo}.\n *\n * In order to create a classic editor instance, use the static\n * {@link module:editor-classic/classiceditor~ClassicEditor.create `ClassicEditor.create()`} method.\n */\nclass ClassicEditor extends /* #__PURE__ */ElementApiMixin(Editor) {\n  /**\n  * @inheritDoc\n  */\n  static get editorName() {\n    return 'ClassicEditor';\n  }\n  /**\n  * @inheritDoc\n  */\n  ui;\n  /**\n  * Creates an instance of the classic editor.\n  *\n  * **Note:** do not use the constructor to create editor instances. Use the static\n  * {@link module:editor-classic/classiceditor~ClassicEditor.create `ClassicEditor.create()`} method instead.\n  *\n  * @param sourceElementOrData The DOM element that will be the source for the created editor\n  * or the editor's initial data. For more information see\n  * {@link module:editor-classic/classiceditor~ClassicEditor.create `ClassicEditor.create()`}.\n  * @param config The editor configuration.\n  */\n  constructor(sourceElementOrData, config = {}) {\n    // If both `config.initialData` is set and initial data is passed as the constructor parameter, then throw.\n    if (!isElement(sourceElementOrData) && config.initialData !== undefined) {\n      // Documented in core/editor/editorconfig.jsdoc.\n      // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n      throw new CKEditorError('editor-create-initial-data', null);\n    }\n    super(config);\n    this.config.define('menuBar.isVisible', false);\n    if (this.config.get('initialData') === undefined) {\n      this.config.set('initialData', getInitialData(sourceElementOrData));\n    }\n    if (isElement(sourceElementOrData)) {\n      this.sourceElement = sourceElementOrData;\n    }\n    this.model.document.createRoot();\n    const shouldToolbarGroupWhenFull = !this.config.get('toolbar.shouldNotGroupWhenFull');\n    const menuBarConfig = this.config.get('menuBar');\n    const view = new ClassicEditorUIView(this.locale, this.editing.view, {\n      shouldToolbarGroupWhenFull,\n      useMenuBar: menuBarConfig.isVisible,\n      label: this.config.get('label')\n    });\n    this.ui = new ClassicEditorUI(this, view);\n    attachToForm(this);\n  }\n  /**\n  * Destroys the editor instance, releasing all resources used by it.\n  *\n  * Updates the original editor element with the data if the\n  * {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy `updateSourceElementOnDestroy`}\n  * configuration option is set to `true`.\n  */\n  destroy() {\n    if (this.sourceElement) {\n      this.updateSourceElement();\n    }\n    this.ui.destroy();\n    return super.destroy();\n  }\n  /**\n  * Creates a new classic editor instance.\n  *\n  * There are three ways how the editor can be initialized.\n  *\n  * # Replacing a DOM element (and loading data from it)\n  *\n  * You can initialize the editor using an existing DOM element:\n  *\n  * ```ts\n  * ClassicEditor\n  * \t.create( document.querySelector( '#editor' ) )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * The element's content will be used as the editor data and the element will be replaced by the editor UI.\n  *\n  * # Creating a detached editor\n  *\n  * Alternatively, you can initialize the editor by passing the initial data directly as a string.\n  * In this case, the editor will render an element that must be inserted into the DOM:\n  *\n  * ```ts\n  * ClassicEditor\n  * \t.create( '<p>Hello world!</p>' )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  *\n  * \t\t// Initial data was provided so the editor UI element needs to be added manually to the DOM.\n  * \t\tdocument.body.appendChild( editor.ui.element );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * This lets you dynamically append the editor to your web page whenever it is convenient for you. You may use this method if your\n  * web page content is generated on the client side and the DOM structure is not ready at the moment when you initialize the editor.\n  *\n  * # Replacing a DOM element (and data provided in `config.initialData`)\n  *\n  * You can also mix these two ways by providing a DOM element to be used and passing the initial data through the configuration:\n  *\n  * ```ts\n  * ClassicEditor\n  * \t.create( document.querySelector( '#editor' ), {\n  * \t\tinitialData: '<h2>Initial data</h2><p>Foo bar.</p>'\n  * \t} )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * This method can be used to initialize the editor on an existing element with the specified content in case if your integration\n  * makes it difficult to set the content of the source element.\n  *\n  * Note that an error will be thrown if you pass the initial data both as the first parameter and also in the configuration.\n  *\n  * # Configuring the editor\n  *\n  * See the {@link module:core/editor/editorconfig~EditorConfig editor configuration documentation} to learn more about\n  * customizing plugins, toolbar and more.\n  *\n  * @param sourceElementOrData The DOM element that will be the source for the created editor\n  * or the editor's initial data.\n  *\n  * If a DOM element is passed, its content will be automatically loaded to the editor upon initialization\n  * and the {@link module:editor-classic/classiceditorui~ClassicEditorUI#element editor element} will replace the passed element\n  * in the DOM (the original one will be hidden and the editor will be injected next to it).\n  *\n  * If the {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy updateSourceElementOnDestroy}\n  * option is set to `true`, the editor data will be set back to the original element once the editor is destroyed and when a form,\n  * in which this element is contained, is submitted (if the original element is a `<textarea>`). This ensures seamless integration\n  * with native web forms.\n  *\n  * If the initial data is passed, a detached editor will be created. In this case you need to insert it into the DOM manually.\n  * It is available under the {@link module:editor-classic/classiceditorui~ClassicEditorUI#element `editor.ui.element`} property.\n  *\n  * @param config The editor configuration.\n  * @returns A promise resolved once the editor is ready. The promise resolves with the created editor instance.\n  */\n  static create(sourceElementOrData, config = {}) {\n    return new Promise(resolve => {\n      const editor = new this(sourceElementOrData, config);\n      resolve(editor.initPlugins().then(() => editor.ui.init(isElement(sourceElementOrData) ? sourceElementOrData : null)).then(() => editor.data.init(editor.config.get('initialData'))).then(() => editor.fire('ready')).then(() => editor));\n    });\n  }\n}\nfunction getInitialData(sourceElementOrData) {\n  return isElement(sourceElementOrData) ? getDataFromElement(sourceElementOrData) : sourceElementOrData;\n}\nfunction isElement(value) {\n  return isElement$1(value);\n}\nexport { ClassicEditor, ClassicEditorUIView };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { ElementApiMixin, Editor, secureSourceElement } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { CKEditorError, getDataFromElement } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { EditorUI, EditorUIView, ToolbarView, MenuBarView, InlineEditableUIView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { enablePlaceholder } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { isElement as isElement$1 } from 'es-toolkit/compat';\n\n/**\n * The decoupled editor UI class.\n */\nclass DecoupledEditorUI extends EditorUI {\n  /**\n  * The main (topâ€“most) view of the editor UI.\n  */\n  view;\n  /**\n  * Creates an instance of the decoupled editor UI class.\n  *\n  * @param editor The editor instance.\n  * @param view The view of the UI.\n  */\n  constructor(editor, view) {\n    super(editor);\n    this.view = view;\n  }\n  /**\n  * Initializes the UI.\n  */\n  init() {\n    const editor = this.editor;\n    const view = this.view;\n    const editingView = editor.editing.view;\n    const editable = view.editable;\n    const editingRoot = editingView.document.getRoot();\n    // The editable UI and editing root should share the same name. Then name is used\n    // to recognize the particular editable, for instance in ARIA attributes.\n    editable.name = editingRoot.rootName;\n    view.render();\n    // The editable UI element in DOM is available for sure only after the editor UI view has been rendered.\n    // But it can be available earlier if a DOM element has been passed to DecoupledEditor.create().\n    const editableElement = editable.element;\n    // Register the editable UI view in the editor. A single editor instance can aggregate multiple\n    // editable areas (roots) but the decoupled editor has only one.\n    this.setEditableElement(editable.name, editableElement);\n    // Let the editable UI element respond to the changes in the global editor focus\n    // tracker. It has been added to the same tracker a few lines above but, in reality, there are\n    // many focusable areas in the editor, like balloons, toolbars or dropdowns and as long\n    // as they have focus, the editable should act like it is focused too (although technically\n    // it isn't), e.g. by setting the proper CSS class, visually announcing focus to the user.\n    // Doing otherwise will result in editable focus styles disappearing, once e.g. the\n    // toolbar gets focused.\n    view.editable.bind('isFocused').to(this.focusTracker);\n    // Bind the editable UI element to the editing view, making it an endâ€“ and entryâ€“point\n    // of the editor's engine. This is where the engine meets the UI.\n    editingView.attachDomRoot(editableElement);\n    this._initPlaceholder();\n    this._initToolbar();\n    this.initMenuBar(this.view.menuBarView);\n    this.fire('ready');\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    const view = this.view;\n    const editingView = this.editor.editing.view;\n    if (editingView.getDomRoot(view.editable.name)) {\n      editingView.detachDomRoot(view.editable.name);\n    }\n    view.destroy();\n  }\n  /**\n  * Initializes the inline editor toolbar and its panel.\n  */\n  _initToolbar() {\n    const editor = this.editor;\n    const view = this.view;\n    const toolbar = view.toolbar;\n    toolbar.fillFromConfig(editor.config.get('toolbar'), this.componentFactory);\n    // Register the toolbar so it becomes available for Alt+F10 and Esc navigation.\n    this.addToolbar(view.toolbar);\n  }\n  /**\n  * Enable the placeholder text on the editing root.\n  */\n  _initPlaceholder() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const editingRoot = editingView.document.getRoot();\n    const placeholder = editor.config.get('placeholder');\n    if (placeholder) {\n      const placeholderText = typeof placeholder === 'string' ? placeholder : placeholder[editingRoot.rootName];\n      if (placeholderText) {\n        editingRoot.placeholder = placeholderText;\n      }\n    }\n    enablePlaceholder({\n      view: editingView,\n      element: editingRoot,\n      isDirectHost: false,\n      keepOnFocus: true\n    });\n  }\n}\n\n/**\n * The decoupled editor UI view. It is a virtual view providing an inline\n * {@link module:editor-decoupled/decouplededitoruiview~DecoupledEditorUIView#editable},\n * {@link module:editor-decoupled/decouplededitoruiview~DecoupledEditorUIView#toolbar}, and a\n * {@link module:editor-decoupled/decouplededitoruiview~DecoupledEditorUIView#menuBarView} but without any\n * specific arrangement of the components in the DOM.\n *\n * See {@link module:editor-decoupled/decouplededitor~DecoupledEditor.create `DecoupledEditor.create()`}\n * to learn more about this view.\n */\nclass DecoupledEditorUIView extends EditorUIView {\n  /**\n  * The main toolbar of the decoupled editor UI.\n  */\n  toolbar;\n  /**\n  * The editable of the decoupled editor UI.\n  */\n  editable;\n  /**\n  * Menu bar view instance.\n  */\n  menuBarView;\n  /**\n  * Creates an instance of the decoupled editor UI view.\n  *\n  * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n  * @param editingView The editing view instance this view is related to.\n  * @param options Configuration options for the view instance.\n  * @param options.editableElement The editable element. If not specified, it will be automatically created by\n  * {@link module:ui/editableui/editableuiview~EditableUIView}. Otherwise, the given element will be used.\n  * @param options.shouldToolbarGroupWhenFull When set `true` enables automatic items grouping\n  * in the main {@link module:editor-decoupled/decouplededitoruiview~DecoupledEditorUIView#toolbar toolbar}.\n  * See {@link module:ui/toolbar/toolbarview~ToolbarOptions#shouldGroupWhenFull} to learn more.\n  * @param options.label When set, this value will be used as an accessible `aria-label` of the\n  * {@link module:ui/editableui/editableuiview~EditableUIView editable view}.\n  */\n  constructor(locale, editingView, options = {}) {\n    super(locale);\n    this.toolbar = new ToolbarView(locale, {\n      shouldGroupWhenFull: options.shouldToolbarGroupWhenFull\n    });\n    this.menuBarView = new MenuBarView(locale);\n    this.editable = new InlineEditableUIView(locale, editingView, options.editableElement, {\n      label: options.label\n    });\n    // This toolbar may be placed anywhere in the page so things like font size need to be reset in it.\n    // Because of the above, make sure the toolbar supports rounded corners.\n    // Also, make sure the toolbar has the proper dir attribute because its ancestor may not have one\n    // and some toolbar item styles depend on this attribute.\n    this.toolbar.extendTemplate({\n      attributes: {\n        class: ['ck-reset_all', 'ck-rounded-corners'],\n        dir: locale.uiLanguageDirection\n      }\n    });\n    this.menuBarView.extendTemplate({\n      attributes: {\n        class: ['ck-reset_all', 'ck-rounded-corners'],\n        dir: locale.uiLanguageDirection\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.registerChild([this.menuBarView, this.toolbar, this.editable]);\n  }\n}\n\n/**\n * The decoupled editor implementation. It provides an inline editable and a toolbar. However, unlike other editors,\n * it does not render these components anywhere in the DOM unless configured.\n *\n * This type of an editor is dedicated to integrations which require a customized UI with an open\n * structure, allowing developers to specify the exact location of the interface.\n *\n * See the document editor {@glink examples/builds/document-editor demo} to learn about possible use cases\n * for the decoupled editor.\n *\n * In order to create a decoupled editor instance, use the static\n * {@link module:editor-decoupled/decouplededitor~DecoupledEditor.create `DecoupledEditor.create()`} method.\n *\n * Note that you will need to attach the editor toolbar and menu bar to your web page manually, in a desired place,\n * after the editor is initialized.\n */\nclass DecoupledEditor extends /* #__PURE__ */ElementApiMixin(Editor) {\n  /**\n  * @inheritDoc\n  */\n  static get editorName() {\n    return 'DecoupledEditor';\n  }\n  /**\n  * @inheritDoc\n  */\n  ui;\n  /**\n  * Creates an instance of the decoupled editor.\n  *\n  * **Note:** Do not use the constructor to create editor instances. Use the static\n  * {@link module:editor-decoupled/decouplededitor~DecoupledEditor.create `DecoupledEditor.create()`} method instead.\n  *\n  * @param sourceElementOrData The DOM element that will be the source for the created editor\n  * (on which the editor will be initialized) or initial data for the editor. For more information see\n  * {@link module:editor-balloon/ballooneditor~BalloonEditor.create `BalloonEditor.create()`}.\n  * @param config The editor configuration.\n  */\n  constructor(sourceElementOrData, config = {}) {\n    // If both `config.initialData` is set and initial data is passed as the constructor parameter, then throw.\n    if (!isElement(sourceElementOrData) && config.initialData !== undefined) {\n      // Documented in core/editor/editorconfig.jsdoc.\n      // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n      throw new CKEditorError('editor-create-initial-data', null);\n    }\n    super(config);\n    if (this.config.get('initialData') === undefined) {\n      this.config.set('initialData', getInitialData(sourceElementOrData));\n    }\n    if (isElement(sourceElementOrData)) {\n      this.sourceElement = sourceElementOrData;\n      secureSourceElement(this, sourceElementOrData);\n    }\n    this.model.document.createRoot();\n    const shouldToolbarGroupWhenFull = !this.config.get('toolbar.shouldNotGroupWhenFull');\n    const view = new DecoupledEditorUIView(this.locale, this.editing.view, {\n      editableElement: this.sourceElement,\n      shouldToolbarGroupWhenFull,\n      label: this.config.get('label')\n    });\n    this.ui = new DecoupledEditorUI(this, view);\n  }\n  /**\n  * Destroys the editor instance, releasing all resources used by it.\n  *\n  * Updates the original editor element with the data if the\n  * {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy `updateSourceElementOnDestroy`}\n  * configuration option is set to `true`.\n  *\n  * **Note**: The decoupled editor does not remove the toolbar and editable when destroyed. You can\n  * do that yourself in the destruction chain:\n  *\n  * ```ts\n  * editor.destroy()\n  * \t.then( () => {\n  * \t\t// Remove the toolbar from DOM.\n  * \t\teditor.ui.view.toolbar.element.remove();\n  *\n  * \t\t// Remove the editable from DOM.\n  * \t\teditor.ui.view.editable.element.remove();\n  *\n  * \t\tconsole.log( 'Editor was destroyed' );\n  * \t} );\n  * ```\n  */\n  destroy() {\n    // Cache the data, then destroy.\n    // It's safe to assume that the model->view conversion will not work after super.destroy().\n    const data = this.getData();\n    this.ui.destroy();\n    return super.destroy().then(() => {\n      if (this.sourceElement) {\n        this.updateSourceElement(data);\n      }\n    });\n  }\n  /**\n  * Creates a new decoupled editor instance.\n  *\n  * **Note:** remember that `DecoupledEditor` does not append the toolbar element to your web page, so you have to do it manually\n  * after the editor has been initialized.\n  *\n  * There are two ways how the editor can be initialized.\n  *\n  * # Using an existing DOM element (and loading data from it)\n  *\n  * You can initialize the editor using an existing DOM element:\n  *\n  * ```ts\n  * DecoupledEditor\n  * \t.create( document.querySelector( '#editor' ) )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  *\n  * \t\t// Append the toolbar to the <body> element.\n  * \t\tdocument.body.appendChild( editor.ui.view.toolbar.element );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * The element's content will be used as the editor data and the element will become the editable element.\n  *\n  * # Creating a detached editor\n  *\n  * Alternatively, you can initialize the editor by passing the initial data directly as a string.\n  * In this case, you will have to manually append both the toolbar element and the editable element to your web page.\n  *\n  * ```ts\n  * DecoupledEditor\n  * \t.create( '<p>Hello world!</p>' )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  *\n  * \t\t// Append the toolbar to the <body> element.\n  * \t\tdocument.body.appendChild( editor.ui.view.toolbar.element );\n  *\n  * \t\t// Initial data was provided so the editor UI element needs to be added manually to the DOM.\n  * \t\tdocument.body.appendChild( editor.ui.getEditableElement() );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * This lets you dynamically append the editor to your web page whenever it is convenient for you. You may use this method if your\n  * web page content is generated on the client side and the DOM structure is not ready at the moment when you initialize the editor.\n  *\n  * # Using an existing DOM element (and data provided in `config.initialData`)\n  *\n  * You can also mix these two ways by providing a DOM element to be used and passing the initial data through the configuration:\n  *\n  * ```ts\n  * DecoupledEditor\n  * \t.create( document.querySelector( '#editor' ), {\n  * \t\tinitialData: '<h2>Initial data</h2><p>Foo bar.</p>'\n  * \t} )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  *\n  * \t\t// Append the toolbar to the <body> element.\n  * \t\tdocument.body.appendChild( editor.ui.view.toolbar.element );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * This method can be used to initialize the editor on an existing element with the specified content in case if your integration\n  * makes it difficult to set the content of the source element.\n  *\n  * Note that an error will be thrown if you pass the initial data both as the first parameter and also in the configuration.\n  *\n  * # Configuring the editor\n  *\n  * See the {@link module:core/editor/editorconfig~EditorConfig editor configuration documentation} to learn more about\n  * customizing plugins, toolbar and more.\n  *\n  * @param sourceElementOrData The DOM element that will be the source for the created editor\n  * or the editor's initial data.\n  *\n  * If a DOM element is passed, its content will be automatically loaded to the editor upon initialization.\n  * The editor data will be set back to the original element once the editor is destroyed only if the\n  * {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy updateSourceElementOnDestroy}\n  * option is set to `true`.\n  *\n  * If the initial data is passed, a detached editor will be created. In this case you need to insert it into the DOM manually.\n  * It is available via\n  * {@link module:editor-decoupled/decouplededitorui~DecoupledEditorUI#getEditableElement `editor.ui.getEditableElement()`}.\n  *\n  * @param config The editor configuration.\n  * @returns A promise resolved once the editor is ready. The promise resolves with the created editor instance.\n  */\n  static create(sourceElementOrData, config = {}) {\n    return new Promise(resolve => {\n      if (isElement(sourceElementOrData) && sourceElementOrData.tagName === 'TEXTAREA') {\n        // Documented in core/editor/editor.js\n        // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n        throw new CKEditorError('editor-wrong-element', null);\n      }\n      const editor = new this(sourceElementOrData, config);\n      resolve(editor.initPlugins().then(() => editor.ui.init()).then(() => editor.data.init(editor.config.get('initialData'))).then(() => editor.fire('ready')).then(() => editor));\n    });\n  }\n}\nfunction getInitialData(sourceElementOrData) {\n  return isElement(sourceElementOrData) ? getDataFromElement(sourceElementOrData) : sourceElementOrData;\n}\nfunction isElement(value) {\n  return isElement$1(value);\n}\nexport { DecoupledEditor };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { ElementApiMixin, Editor, secureSourceElement, attachToForm } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { ResizeObserver, toUnit, Rect, CKEditorError, getDataFromElement } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { EditorUI, normalizeToolbarConfig, EditorUIView, ToolbarView, MenuBarView, BalloonPanelView, InlineEditableUIView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { enablePlaceholder } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { isElement as isElement$1 } from 'es-toolkit/compat';\n\n/**\n * The inline editor UI class.\n *\n * @extends module:ui/editorui/editorui~EditorUI\n */\nclass InlineEditorUI extends EditorUI {\n  /**\n  * The main (topâ€“most) view of the editor UI.\n  */\n  view;\n  /**\n  * A normalized `config.toolbar` object.\n  */\n  _toolbarConfig;\n  /**\n  * Creates an instance of the inline editor UI class.\n  *\n  * @param editor The editor instance.\n  * @param view The view of the UI.\n  */\n  constructor(editor, view) {\n    super(editor);\n    this.view = view;\n    this._toolbarConfig = normalizeToolbarConfig(editor.config.get('toolbar'));\n  }\n  /**\n  * @inheritDoc\n  */\n  get element() {\n    return this.view.editable.element;\n  }\n  /**\n  * Initializes the UI.\n  */\n  init() {\n    const editor = this.editor;\n    const view = this.view;\n    const editingView = editor.editing.view;\n    const editable = view.editable;\n    const editingRoot = editingView.document.getRoot();\n    // The editable UI and editing root should share the same name. Then name is used\n    // to recognize the particular editable, for instance in ARIA attributes.\n    editable.name = editingRoot.rootName;\n    view.render();\n    // The editable UI element in DOM is available for sure only after the editor UI view has been rendered.\n    // But it can be available earlier if a DOM element has been passed to InlineEditor.create().\n    const editableElement = editable.element;\n    // Register the editable UI view in the editor. A single editor instance can aggregate multiple\n    // editable areas (roots) but the inline editor has only one.\n    this.setEditableElement(editable.name, editableElement);\n    // Let the editable UI element respond to the changes in the global editor focus\n    // tracker. It has been added to the same tracker a few lines above but, in reality, there are\n    // many focusable areas in the editor, like balloons, toolbars or dropdowns and as long\n    // as they have focus, the editable should act like it is focused too (although technically\n    // it isn't), e.g. by setting the proper CSS class, visually announcing focus to the user.\n    // Doing otherwise will result in editable focus styles disappearing, once e.g. the\n    // toolbar gets focused.\n    editable.bind('isFocused').to(this.focusTracker);\n    // Bind the editable UI element to the editing view, making it an endâ€“ and entryâ€“point\n    // of the editor's engine. This is where the engine meets the UI.\n    editingView.attachDomRoot(editableElement);\n    this._initPlaceholder();\n    this._initToolbar();\n    if (view.menuBarView) {\n      this.initMenuBar(view.menuBarView);\n    }\n    this.fire('ready');\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    const view = this.view;\n    const editingView = this.editor.editing.view;\n    if (editingView.getDomRoot(view.editable.name)) {\n      editingView.detachDomRoot(view.editable.name);\n    }\n    view.destroy();\n  }\n  /**\n  * Initializes the inline editor toolbar and its panel.\n  */\n  _initToolbar() {\n    const editor = this.editor;\n    const view = this.view;\n    const editableElement = view.editable.element;\n    const toolbar = view.toolbar;\n    // Setâ€“up the view#panel.\n    view.panel.bind('isVisible').to(this.focusTracker, 'isFocused');\n    view.bind('viewportTopOffset').to(this, 'viewportOffset', ({\n      top\n    }) => top || 0);\n    // https://github.com/ckeditor/ckeditor5-editor-inline/issues/4\n    view.listenTo(editor.ui, 'update', () => {\n      // Don't pin if the panel is not already visible. It prevents the panel\n      // showing up when there's no focus in the UI.\n      if (view.panel.isVisible) {\n        view.panel.pin({\n          target: editableElement,\n          positions: view.panelPositions\n        });\n      }\n    });\n    toolbar.fillFromConfig(this._toolbarConfig, this.componentFactory);\n    // Register the toolbar so it becomes available for Alt+F10 and Esc navigation.\n    this.addToolbar(toolbar);\n  }\n  /**\n  * Enable the placeholder text on the editing root.\n  */\n  _initPlaceholder() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const editingRoot = editingView.document.getRoot();\n    const placeholder = editor.config.get('placeholder');\n    if (placeholder) {\n      const placeholderText = typeof placeholder === 'string' ? placeholder : placeholder[editingRoot.rootName];\n      if (placeholderText) {\n        editingRoot.placeholder = placeholderText;\n      }\n    }\n    enablePlaceholder({\n      view: editingView,\n      element: editingRoot,\n      isDirectHost: false,\n      keepOnFocus: true\n    });\n  }\n}\nconst toPx = /* #__PURE__ */toUnit('px');\n/**\n * Inline editor UI view. Uses an nline editable and a floating toolbar.\n */\nclass InlineEditorUIView extends EditorUIView {\n  /**\n  * A floating toolbar view instance.\n  */\n  toolbar;\n  /**\n  * A balloon panel view instance.\n  */\n  panel;\n  /**\n  * A set of positioning functions used by the {@link #panel} to float around\n  * {@link #element editableElement}.\n  *\n  * The positioning functions are as follows:\n  *\n  * * West:\n  *\n  * ```\n  * [ Panel ]\n  * +------------------+\n  * | #editableElement |\n  * +------------------+\n  *\n  * +------------------+\n  * | #editableElement |\n  * |[ Panel ]         |\n  * |                  |\n  * +------------------+\n  *\n  * +------------------+\n  * | #editableElement |\n  * +------------------+\n  * [ Panel ]\n  * ```\n  *\n  * * East:\n  *\n  * ```\n  *            [ Panel ]\n  * +------------------+\n  * | #editableElement |\n  * +------------------+\n  *\n  * +------------------+\n  * | #editableElement |\n  * |         [ Panel ]|\n  * |                  |\n  * +------------------+\n  *\n  * +------------------+\n  * | #editableElement |\n  * +------------------+\n  *            [ Panel ]\n  * ```\n  *\n  * See: {@link module:utils/dom/position~Options#positions}.\n  */\n  panelPositions;\n  /**\n  * Editable UI view.\n  */\n  editable;\n  /**\n  * An instance of the resize observer that helps dynamically determine the geometry of the toolbar\n  * and manage items that do not fit into a single row.\n  *\n  * **Note:** Created in {@link #render}.\n  */\n  _resizeObserver;\n  /**\n  * Creates an instance of the inline editor UI view.\n  *\n  * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n  * @param editingView The editing view instance this view is related to.\n  * @param editableElement The editable element. If not specified, it will be automatically created by\n  * {@link module:ui/editableui/editableuiview~EditableUIView}. Otherwise, the given element will be used.\n  * @param options Configuration options for the view instance.\n  * @param options.shouldToolbarGroupWhenFull When set `true` enables automatic items grouping\n  * in the main {@link module:editor-inline/inlineeditoruiview~InlineEditorUIView#toolbar toolbar}.\n  * See {@link module:ui/toolbar/toolbarview~ToolbarOptions#shouldGroupWhenFull} to learn more.\n  * @param options.label When set, this value will be used as an accessible `aria-label` of the\n  * {@link module:ui/editableui/editableuiview~EditableUIView editable view}.\n  */\n  constructor(locale, editingView, editableElement, options = {}) {\n    super(locale);\n    this.toolbar = new ToolbarView(locale, {\n      shouldGroupWhenFull: options.shouldToolbarGroupWhenFull,\n      isFloating: true\n    });\n    if (options.useMenuBar) {\n      this.menuBarView = new MenuBarView(locale);\n    }\n    this.set('viewportTopOffset', 0);\n    this.panel = new BalloonPanelView(locale);\n    this.panelPositions = this._getPanelPositions();\n    this.panel.extendTemplate({\n      attributes: {\n        class: 'ck-toolbar-container'\n      }\n    });\n    this.editable = new InlineEditableUIView(locale, editingView, editableElement, {\n      label: options.label\n    });\n    this._resizeObserver = null;\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.body.add(this.panel);\n    this.registerChild(this.editable);\n    if (this.menuBarView) {\n      // Set toolbar as a child of a stickyPanel and makes toolbar sticky.\n      this.panel.content.addMany([this.menuBarView, this.toolbar]);\n    } else {\n      this.panel.content.add(this.toolbar);\n    }\n    const options = this.toolbar.options;\n    // Set toolbar's max-width on the initialization and update it on the editable resize,\n    // if 'shouldToolbarGroupWhenFull' in config is set to 'true'.\n    if (options.shouldGroupWhenFull) {\n      const editableElement = this.editable.element;\n      this._resizeObserver = new ResizeObserver(editableElement, () => {\n        this.toolbar.maxWidth = toPx(new Rect(editableElement).width);\n      });\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    if (this._resizeObserver) {\n      this._resizeObserver.destroy();\n    }\n  }\n  /**\n  * Determines the panel top position of the {@link #panel} in {@link #panelPositions}.\n  *\n  * @param editableRect Rect of the {@link #element}.\n  * @param panelRect Rect of the {@link #panel}.\n  */\n  _getPanelPositionTop(editableRect, panelRect) {\n    let top;\n    if (editableRect.top > panelRect.height + this.viewportTopOffset) {\n      top = editableRect.top - panelRect.height;\n    } else if (editableRect.bottom > panelRect.height + this.viewportTopOffset + 50) {\n      top = this.viewportTopOffset;\n    } else {\n      top = editableRect.bottom;\n    }\n    return top;\n  }\n  /**\n  * Returns the positions for {@link #panelPositions}.\n  *\n  * See: {@link module:utils/dom/position~Options#positions}.\n  */\n  _getPanelPositions() {\n    const positions = [(editableRect, panelRect) => {\n      return {\n        top: this._getPanelPositionTop(editableRect, panelRect),\n        left: editableRect.left,\n        name: 'toolbar_west',\n        config: {\n          withArrow: false\n        }\n      };\n    }, (editableRect, panelRect) => {\n      return {\n        top: this._getPanelPositionTop(editableRect, panelRect),\n        left: editableRect.left + editableRect.width - panelRect.width,\n        name: 'toolbar_east',\n        config: {\n          withArrow: false\n        }\n      };\n    }];\n    if (this.locale.uiLanguageDirection === 'ltr') {\n      return positions;\n    } else {\n      return positions.reverse();\n    }\n  }\n}\n\n/**\n * The inline editor implementation. It uses an inline editable and a floating toolbar.\n * See the {@glink examples/builds/inline-editor demo}.\n *\n * In order to create a inline editor instance, use the static\n * {@link module:editor-inline/inlineeditor~InlineEditor.create `InlineEditor.create()`} method.\n */\nclass InlineEditor extends /* #__PURE__ */ElementApiMixin(Editor) {\n  /**\n  * @inheritDoc\n  */\n  static get editorName() {\n    return 'InlineEditor';\n  }\n  /**\n  * @inheritDoc\n  */\n  ui;\n  /**\n  * Creates an instance of the inline editor.\n  *\n  * **Note:** Do not use the constructor to create editor instances. Use the static\n  * {@link module:editor-inline/inlineeditor~InlineEditor.create `InlineEditor.create()`} method instead.\n  *\n  * @param sourceElementOrData The DOM element that will be the source for the created editor\n  * (on which the editor will be initialized) or initial data for the editor. For more information see\n  * {@link module:editor-inline/inlineeditor~InlineEditor.create `InlineEditor.create()`}.\n  * @param config The editor configuration.\n  */\n  constructor(sourceElementOrData, config = {}) {\n    // If both `config.initialData` and initial data parameter in `create()` are set, then throw.\n    if (!isElement(sourceElementOrData) && config.initialData !== undefined) {\n      // Documented in core/editor/editorconfig.jsdoc.\n      // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n      throw new CKEditorError('editor-create-initial-data', null);\n    }\n    super(config);\n    this.config.define('menuBar.isVisible', false);\n    if (this.config.get('initialData') === undefined) {\n      this.config.set('initialData', getInitialData(sourceElementOrData));\n    }\n    this.model.document.createRoot();\n    if (isElement(sourceElementOrData)) {\n      this.sourceElement = sourceElementOrData;\n      secureSourceElement(this, sourceElementOrData);\n    }\n    const shouldToolbarGroupWhenFull = !this.config.get('toolbar.shouldNotGroupWhenFull');\n    const menuBarConfig = this.config.get('menuBar');\n    const view = new InlineEditorUIView(this.locale, this.editing.view, this.sourceElement, {\n      shouldToolbarGroupWhenFull,\n      useMenuBar: menuBarConfig.isVisible,\n      label: this.config.get('label')\n    });\n    this.ui = new InlineEditorUI(this, view);\n    attachToForm(this);\n  }\n  /**\n  * Destroys the editor instance, releasing all resources used by it.\n  *\n  * Updates the original editor element with the data if the\n  * {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy `updateSourceElementOnDestroy`}\n  * configuration option is set to `true`.\n  */\n  destroy() {\n    // Cache the data, then destroy.\n    // It's safe to assume that the model->view conversion will not work after super.destroy().\n    const data = this.getData();\n    this.ui.destroy();\n    return super.destroy().then(() => {\n      if (this.sourceElement) {\n        this.updateSourceElement(data);\n      }\n    });\n  }\n  /**\n  * Creates a new inline editor instance.\n  *\n  * There are three general ways how the editor can be initialized.\n  *\n  * # Using an existing DOM element (and loading data from it)\n  *\n  * You can initialize the editor using an existing DOM element:\n  *\n  * ```ts\n  * InlineEditor\n  * \t.create( document.querySelector( '#editor' ) )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * The element's content will be used as the editor data and the element will become the editable element.\n  *\n  * # Creating a detached editor\n  *\n  * Alternatively, you can initialize the editor by passing the initial data directly as a `String`.\n  * In this case, the editor will render an element that must be inserted into the DOM for the editor to work properly:\n  *\n  * ```ts\n  * InlineEditor\n  * \t.create( '<p>Hello world!</p>' )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  *\n  * \t\t// Initial data was provided so the editor UI element needs to be added manually to the DOM.\n  * \t\tdocument.body.appendChild( editor.ui.element );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * This lets you dynamically append the editor to your web page whenever it is convenient for you. You may use this method if your\n  * web page content is generated on the client side and the DOM structure is not ready at the moment when you initialize the editor.\n  *\n  * # Using an existing DOM element (and data provided in `config.initialData`)\n  *\n  * You can also mix these two ways by providing a DOM element to be used and passing the initial data through the configuration:\n  *\n  * ```ts\n  * InlineEditor\n  * \t.create( document.querySelector( '#editor' ), {\n  * \t\tinitialData: '<h2>Initial data</h2><p>Foo bar.</p>'\n  * \t} )\n  * \t.then( editor => {\n  * \t\tconsole.log( 'Editor was initialized', editor );\n  * \t} )\n  * \t.catch( err => {\n  * \t\tconsole.error( err.stack );\n  * \t} );\n  * ```\n  *\n  * This method can be used to initialize the editor on an existing element with the specified content in case if your integration\n  * makes it difficult to set the content of the source element.\n  *\n  * Note that an error will be thrown if you pass the initial data both as the first parameter and also in the configuration.\n  *\n  * # Configuring the editor\n  *\n  * See the {@link module:core/editor/editorconfig~EditorConfig editor configuration documentation} to learn more about\n  * customizing plugins, toolbar and more.\n  *\n  * @param sourceElementOrData The DOM element that will be the source for the created editor\n  * or the editor's initial data.\n  *\n  * If a DOM element is passed, its content will be automatically loaded to the editor upon initialization.\n  * The editor data will be set back to the original element once the editor is destroyed only if the\n  * {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy updateSourceElementOnDestroy}\n  * option is set to `true`.\n  *\n  * If the initial data is passed, a detached editor will be created. In this case you need to insert it into the DOM manually.\n  * It is available under the {@link module:editor-inline/inlineeditorui~InlineEditorUI#element `editor.ui.element`} property.\n  *\n  * @param config The editor configuration.\n  * @returns A promise resolved once the editor is ready. The promise resolves with the created editor instance.\n  */\n  static create(sourceElementOrData, config = {}) {\n    return new Promise(resolve => {\n      if (isElement(sourceElementOrData) && sourceElementOrData.tagName === 'TEXTAREA') {\n        // Documented in core/editor/editor.js\n        // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n        throw new CKEditorError('editor-wrong-element', null);\n      }\n      const editor = new this(sourceElementOrData, config);\n      resolve(editor.initPlugins().then(() => editor.ui.init()).then(() => editor.data.init(editor.config.get('initialData'))).then(() => editor.fire('ready')).then(() => editor));\n    });\n  }\n}\nfunction getInitialData(sourceElementOrData) {\n  return isElement(sourceElementOrData) ? getDataFromElement(sourceElementOrData) : sourceElementOrData;\n}\nfunction isElement(value) {\n  return isElement$1(value);\n}\nexport { InlineEditor };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Editor, secureSourceElement } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { CKEditorError, logWarning, setDataInElement, getDataFromElement } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { EditorUI, EditorUIView, ToolbarView, MenuBarView, InlineEditableUIView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { enablePlaceholder } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { isElement as isElement$1 } from 'es-toolkit/compat';\n\n/**\n * The multi-root editor UI class.\n */\nclass MultiRootEditorUI extends EditorUI {\n  /**\n  * The main (topâ€“most) view of the editor UI.\n  */\n  view;\n  /**\n  * The editable element that was focused the last time when any of the editables had focus.\n  */\n  _lastFocusedEditableElement;\n  /**\n  * Creates an instance of the multi-root editor UI class.\n  *\n  * @param editor The editor instance.\n  * @param view The view of the UI.\n  */\n  constructor(editor, view) {\n    super(editor);\n    this.view = view;\n    this._lastFocusedEditableElement = null;\n  }\n  /**\n  * Initializes the UI.\n  */\n  init() {\n    const view = this.view;\n    view.render();\n    // Keep track of the last focused editable element. Knowing which one was focused\n    // is useful when the focus moves from editable to other UI components like balloons\n    // (especially inputs) but the editable remains the \"focus context\" (e.g. link balloon\n    // attached to a link in an editable). In this case, the editable should preserve visual\n    // focus styles.\n    this.focusTracker.on('change:focusedElement', (evt, name, focusedElement) => {\n      for (const editable of Object.values(this.view.editables)) {\n        if (focusedElement === editable.element) {\n          this._lastFocusedEditableElement = editable.element;\n        }\n      }\n    });\n    // If the focus tracker loses focus, stop tracking the last focused editable element.\n    // Wherever the focus is restored, it will no longer be in the context of that editable\n    // because the focus \"came from the outside\", as opposed to the focus moving from one element\n    // to another within the editor UI.\n    this.focusTracker.on('change:isFocused', (evt, name, isFocused) => {\n      if (!isFocused) {\n        this._lastFocusedEditableElement = null;\n      }\n    });\n    for (const editable of Object.values(this.view.editables)) {\n      this.addEditable(editable);\n    }\n    this._initToolbar();\n    this.initMenuBar(this.view.menuBarView);\n    this.fire('ready');\n  }\n  /**\n  * Adds the editable to the editor UI.\n  *\n  * After the editable is added to the editor UI it can be considered \"active\".\n  *\n  * The editable is attached to the editor editing pipeline, which means that it will be updated as the editor model updates and\n  * changing its content will be reflected in the editor model. Keystrokes, focus handling and placeholder are initialized.\n  *\n  * @param editable The editable instance to add.\n  * @param placeholder Placeholder for the editable element. If not set, placeholder value from the\n  * {@link module:core/editor/editorconfig~EditorConfig#placeholder editor configuration} will be used (if it was provided).\n  */\n  addEditable(editable, placeholder) {\n    // The editable UI element in DOM is available for sure only after the editor UI view has been rendered.\n    // But it can be available earlier if a DOM element has been passed to `MultiRootEditor.create()`.\n    const editableElement = editable.element;\n    // Bind the editable UI element to the editing view, making it an endâ€“ and entryâ€“point\n    // of the editor's engine. This is where the engine meets the UI.\n    this.editor.editing.view.attachDomRoot(editableElement, editable.name);\n    // Register each editable UI view in the editor.\n    this.setEditableElement(editable.name, editableElement);\n    // Let the editable UI element respond to the changes in the global editor focus\n    // tracker. It has been added to the same tracker a few lines above but, in reality, there are\n    // many focusable areas in the editor, like balloons, toolbars or dropdowns and as long\n    // as they have focus, the editable should act like it is focused too (although technically\n    // it isn't), e.g. by setting the proper CSS class, visually announcing focus to the user.\n    // Doing otherwise will result in editable focus styles disappearing, once e.g. the\n    // toolbar gets focused.\n    editable.bind('isFocused').to(this.focusTracker, 'isFocused', this.focusTracker, 'focusedElement', (isFocused, focusedElement) => {\n      // When the focus tracker is blurred, it means the focus moved out of the editor UI.\n      // No editable will maintain focus then.\n      if (!isFocused) {\n        return false;\n      }\n      // If the focus tracker says the editor UI is focused and currently focused element\n      // is the editable, then the editable should be visually marked as focused too.\n      if (focusedElement === editableElement) {\n        return true;\n      } else {\n        return this._lastFocusedEditableElement === editableElement;\n      }\n    });\n    this._initPlaceholder(editable, placeholder);\n  }\n  /**\n  * Removes the editable instance from the editor UI.\n  *\n  * Removed editable can be considered \"deactivated\".\n  *\n  * The editable is detached from the editing pipeline, so model changes are no longer reflected in it. All handling added in\n  * {@link #addEditable} is removed.\n  *\n  * @param editable Editable to remove from the editor UI.\n  */\n  removeEditable(editable) {\n    const editingView = this.editor.editing.view;\n    if (editingView.getDomRoot(editable.name)) {\n      editingView.detachDomRoot(editable.name);\n    }\n    editable.unbind('isFocused');\n    this.removeEditableElement(editable.name);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    for (const editable of Object.values(this.view.editables)) {\n      this.removeEditable(editable);\n    }\n    this.view.destroy();\n  }\n  /**\n  * Initializes the editor main toolbar and its panel.\n  */\n  _initToolbar() {\n    const editor = this.editor;\n    const view = this.view;\n    const toolbar = view.toolbar;\n    toolbar.fillFromConfig(editor.config.get('toolbar'), this.componentFactory);\n    // Register the toolbar, so it becomes available for Alt+F10 and Esc navigation.\n    this.addToolbar(view.toolbar);\n  }\n  /**\n  * Enables the placeholder text on a given editable.\n  *\n  * @param editable Editable on which the placeholder should be set.\n  * @param placeholder Placeholder for the editable element. If not set, placeholder value from the\n  * {@link module:core/editor/editorconfig~EditorConfig#placeholder editor configuration} will be used (if it was provided).\n  */\n  _initPlaceholder(editable, placeholder) {\n    if (!placeholder) {\n      const configPlaceholder = this.editor.config.get('placeholder');\n      if (configPlaceholder) {\n        placeholder = typeof configPlaceholder === 'string' ? configPlaceholder : configPlaceholder[editable.name];\n      }\n    }\n    const editingView = this.editor.editing.view;\n    const editingRoot = editingView.document.getRoot(editable.name);\n    if (placeholder) {\n      editingRoot.placeholder = placeholder;\n    }\n    enablePlaceholder({\n      view: editingView,\n      element: editingRoot,\n      isDirectHost: false,\n      keepOnFocus: true\n    });\n  }\n}\n\n/**\n * The multi-root editor UI view. It is a virtual view providing an inline\n * {@link module:editor-multi-root/multirooteditoruiview~MultiRootEditorUIView#editable} and a\n * {@link module:editor-multi-root/multirooteditoruiview~MultiRootEditorUIView#toolbar}, but without any\n * specific arrangement of the components in the DOM.\n *\n * See {@link module:editor-multi-root/multirooteditor~MultiRootEditor.create `MultiRootEditor.create()`}\n * to learn more about this view.\n */\nclass MultiRootEditorUIView extends EditorUIView {\n  /**\n  * The main toolbar of the multi-root editor UI.\n  */\n  toolbar;\n  /**\n  * Editable elements used by the multi-root editor UI.\n  */\n  editables;\n  editable;\n  /**\n  * Menu bar view instance.\n  */\n  menuBarView;\n  /**\n  * The editing view instance this view is related to.\n  */\n  _editingView;\n  /**\n  * Creates an instance of the multi-root editor UI view.\n  *\n  * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n  * @param editingView The editing view instance this view is related to.\n  * @param editableNames Names for all editable views. For each name, one\n  * {@link module:ui/editableui/inline/inlineeditableuiview~InlineEditableUIView `InlineEditableUIView`} instance will be initialized.\n  * @param options Configuration options for the view instance.\n  * @param options.editableElements The editable elements to be used, assigned to their names. If not specified, they will be\n  * automatically created by {@link module:ui/editableui/inline/inlineeditableuiview~InlineEditableUIView `InlineEditableUIView`}\n  * instances.\n  * @param options.shouldToolbarGroupWhenFull When set to `true` enables automatic items grouping\n  * in the main {@link module:editor-multi-root/multirooteditoruiview~MultiRootEditorUIView#toolbar toolbar}.\n  * See {@link module:ui/toolbar/toolbarview~ToolbarOptions#shouldGroupWhenFull} to learn more.\n  * @param options.label When set, this value will be used as an accessible `aria-label` of the\n  * {@link module:ui/editableui/editableuiview~EditableUIView editable view} elements.\n  */\n  constructor(locale, editingView, editableNames, options = {}) {\n    super(locale);\n    this._editingView = editingView;\n    this.toolbar = new ToolbarView(locale, {\n      shouldGroupWhenFull: options.shouldToolbarGroupWhenFull\n    });\n    this.menuBarView = new MenuBarView(locale);\n    this.editables = {};\n    // Create `InlineEditableUIView` instance for each editable.\n    for (const editableName of editableNames) {\n      const editableElement = options.editableElements ? options.editableElements[editableName] : undefined;\n      let {\n        label\n      } = options;\n      if (typeof label === 'object') {\n        label = label[editableName];\n      }\n      this.createEditable(editableName, editableElement, label);\n    }\n    this.editable = Object.values(this.editables)[0];\n    // This toolbar may be placed anywhere in the page so things like font size need to be reset in it.\n    // Because of the above, make sure the toolbar supports rounded corners.\n    // Also, make sure the toolbar has the proper dir attribute because its ancestor may not have one\n    // and some toolbar item styles depend on this attribute.\n    this.toolbar.extendTemplate({\n      attributes: {\n        class: ['ck-reset_all', 'ck-rounded-corners'],\n        dir: locale.uiLanguageDirection\n      }\n    });\n    this.menuBarView.extendTemplate({\n      attributes: {\n        class: ['ck-reset_all', 'ck-rounded-corners'],\n        dir: locale.uiLanguageDirection\n      }\n    });\n  }\n  /**\n  * Creates an editable instance with given name and registers it in the editor UI view.\n  *\n  * If `editableElement` is provided, the editable instance will be created on top of it. Otherwise, the editor will create a new\n  * DOM element and use it instead.\n  *\n  * @param editableName The name for the editable.\n  * @param editableElement DOM element for which the editable should be created.\n  * @param label The accessible editable label used by assistive technologies.\n  * @returns The created editable instance.\n  */\n  createEditable(editableName, editableElement, label) {\n    const editable = new InlineEditableUIView(this.locale, this._editingView, editableElement, {\n      label\n    });\n    this.editables[editableName] = editable;\n    editable.name = editableName;\n    if (this.isRendered) {\n      this.registerChild(editable);\n    }\n    return editable;\n  }\n  /**\n  * Destroys and removes the editable from the editor UI view.\n  *\n  * @param editableName The name of the editable that should be removed.\n  */\n  removeEditable(editableName) {\n    const editable = this.editables[editableName];\n    if (this.isRendered) {\n      this.deregisterChild(editable);\n    }\n    delete this.editables[editableName];\n    editable.destroy();\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.registerChild(Object.values(this.editables));\n    this.registerChild(this.toolbar);\n    this.registerChild(this.menuBarView);\n  }\n}\n\n/**\n * The multi-root editor implementation.\n *\n * The multi-root editor provides multiple inline editable elements and a toolbar. All editable areas are controlled by one editor\n * instance, which means that they share common configuration, document ID, or undo stack.\n *\n * This type of editor is dedicated to integrations which require a customized UI with an open structure, featuring multiple editable areas,\n * allowing developers to have a control over the exact location of these editable areas.\n *\n * In order to create a multi-root editor instance, use the static\n * {@link module:editor-multi-root/multirooteditor~MultiRootEditor.create `MultiRootEditor.create()`} method.\n *\n * Note that you will need to attach the editor toolbar to your web page manually, in a desired place, after the editor is initialized.\n */\nclass MultiRootEditor extends Editor {\n  /**\n  * @inheritDoc\n  */\n  static get editorName() {\n    return 'MultiRootEditor';\n  }\n  /**\n  * @inheritDoc\n  */\n  ui;\n  /**\n  * The elements on which the editor has been initialized.\n  */\n  sourceElements;\n  /**\n  * Holds attributes keys that were passed in {@link module:core/editor/editorconfig~EditorConfig#rootsAttributes `rootsAttributes`}\n  * config property and should be returned by {@link #getRootsAttributes}.\n  */\n  _registeredRootsAttributesKeys = new Set();\n  /**\n  * A set of lock IDs for enabling or disabling particular root.\n  */\n  _readOnlyRootLocks = new Map();\n  /**\n  * Creates an instance of the multi-root editor.\n  *\n  * **Note:** Do not use the constructor to create editor instances. Use the static\n  * {@link module:editor-multi-root/multirooteditor~MultiRootEditor.create `MultiRootEditor.create()`} method instead.\n  *\n  * @param sourceElementsOrData The DOM elements that will be the source for the created editor\n  * or the editor's initial data. The editor will initialize multiple roots with names according to the keys in the passed object.\n  * For more information see {@link module:editor-multi-root/multirooteditor~MultiRootEditor.create `MultiRootEditor.create()`}.\n  * @param config The editor configuration.\n  */\n  constructor(sourceElementsOrData, config = {}) {\n    const rootNames = Object.keys(sourceElementsOrData);\n    const sourceIsData = rootNames.length === 0 || typeof sourceElementsOrData[rootNames[0]] === 'string';\n    if (sourceIsData && config.initialData !== undefined && Object.keys(config.initialData).length > 0) {\n      // Documented in core/editor/editorconfig.jsdoc.\n      // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n      throw new CKEditorError('editor-create-initial-data', null);\n    }\n    super(config);\n    if (!sourceIsData) {\n      this.sourceElements = sourceElementsOrData;\n    } else {\n      this.sourceElements = {};\n    }\n    if (this.config.get('initialData') === undefined) {\n      // Create initial data object containing data from all roots.\n      const initialData = {};\n      for (const rootName of rootNames) {\n        initialData[rootName] = getInitialData(sourceElementsOrData[rootName]);\n      }\n      this.config.set('initialData', initialData);\n    }\n    if (!sourceIsData) {\n      for (const rootName of rootNames) {\n        secureSourceElement(this, sourceElementsOrData[rootName]);\n      }\n    }\n    this.editing.view.document.roots.on('add', (evt, viewRoot) => {\n      // Here we change the standard binding of readOnly flag by adding\n      // additional constraint that multi-root has (enabling / disabling particular root).\n      viewRoot.unbind('isReadOnly');\n      viewRoot.bind('isReadOnly').to(this.editing.view.document, 'isReadOnly', isReadOnly => {\n        return isReadOnly || this._readOnlyRootLocks.has(viewRoot.rootName);\n      });\n      // Hacky solution to nested editables.\n      // Nested editables should be managed each separately and do not base on view document or view root.\n      viewRoot.on('change:isReadOnly', (evt, prop, value) => {\n        const viewRange = this.editing.view.createRangeIn(viewRoot);\n        for (const viewItem of viewRange.getItems()) {\n          if (viewItem.is('editableElement')) {\n            viewItem.unbind('isReadOnly');\n            viewItem.isReadOnly = value;\n          }\n        }\n      });\n    });\n    for (const rootName of rootNames) {\n      // Create root and `UIView` element for each editable container.\n      this.model.document.createRoot('$root', rootName);\n    }\n    if (this.config.get('lazyRoots')) {\n      for (const rootName of this.config.get('lazyRoots')) {\n        const root = this.model.document.createRoot('$root', rootName);\n        root._isLoaded = false;\n      }\n    }\n    if (this.config.get('rootsAttributes')) {\n      const rootsAttributes = this.config.get('rootsAttributes');\n      for (const [rootName, attributes] of Object.entries(rootsAttributes)) {\n        if (!this.model.document.getRoot(rootName)) {\n          /**\n          * Trying to set attributes on a non-existing root.\n          *\n          * Roots specified in {@link module:core/editor/editorconfig~EditorConfig#rootsAttributes} do not match initial\n          * editor roots.\n          *\n          * @error multi-root-editor-root-attributes-no-root\n          */\n          throw new CKEditorError('multi-root-editor-root-attributes-no-root', null);\n        }\n        for (const key of Object.keys(attributes)) {\n          this.registerRootAttribute(key);\n        }\n      }\n      this.data.on('init', () => {\n        this.model.enqueueChange({\n          isUndoable: false\n        }, writer => {\n          for (const [name, attributes] of Object.entries(rootsAttributes)) {\n            const root = this.model.document.getRoot(name);\n            for (const [key, value] of Object.entries(attributes)) {\n              if (value !== null) {\n                writer.setAttribute(key, value, root);\n              }\n            }\n          }\n        });\n      });\n    }\n    const options = {\n      shouldToolbarGroupWhenFull: !this.config.get('toolbar.shouldNotGroupWhenFull'),\n      editableElements: sourceIsData ? undefined : sourceElementsOrData,\n      label: this.config.get('label')\n    };\n    const view = new MultiRootEditorUIView(this.locale, this.editing.view, rootNames, options);\n    this.ui = new MultiRootEditorUI(this, view);\n    this.model.document.on('change:data', () => {\n      const changedRoots = this.model.document.differ.getChangedRoots();\n      // Fire detaches first. If there are multiple roots removed and added in one batch, it should be easier to handle if\n      // changes aren't mixed. Detaching will usually lead to just removing DOM elements. Detaching first will lead to a clean DOM\n      // when new editables are added in `addRoot` event.\n      for (const changes of changedRoots) {\n        const root = this.model.document.getRoot(changes.name);\n        if (changes.state == 'detached') {\n          this.fire('detachRoot', root);\n        }\n      }\n      for (const changes of changedRoots) {\n        const root = this.model.document.getRoot(changes.name);\n        if (changes.state == 'attached') {\n          this.fire('addRoot', root);\n        }\n      }\n    });\n    // Overwrite `Model#canEditAt()` decorated method.\n    // Check if the provided selection is inside a read-only root. If so, return `false`.\n    this.listenTo(this.model, 'canEditAt', (evt, [selection]) => {\n      // Skip empty selections.\n      if (!selection) {\n        return;\n      }\n      let selectionInReadOnlyRoot = false;\n      for (const range of selection.getRanges()) {\n        const root = range.root;\n        if (this._readOnlyRootLocks.has(root.rootName)) {\n          selectionInReadOnlyRoot = true;\n          break;\n        }\n      }\n      // If selection is in read-only root, return `false` and prevent further processing.\n      // Otherwise, allow for other callbacks (or default callback) to evaluate.\n      if (selectionInReadOnlyRoot) {\n        evt.return = false;\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    this.decorate('loadRoot');\n    this.on('loadRoot', (evt, [rootName]) => {\n      const root = this.model.document.getRoot(rootName);\n      if (!root) {\n        /**\n        * The root to load does not exist.\n        *\n        * @error multi-root-editor-load-root-no-root\n        */\n        throw new CKEditorError('multi-root-editor-load-root-no-root', this, {\n          rootName\n        });\n      }\n      if (root._isLoaded) {\n        /**\n        * The root to load was already loaded before. The `loadRoot()` call has no effect.\n        *\n        * @error multi-root-editor-load-root-already-loaded\n        */\n        logWarning('multi-root-editor-load-root-already-loaded');\n        evt.stop();\n      }\n    }, {\n      priority: 'highest'\n    });\n  }\n  /**\n  * Destroys the editor instance, releasing all resources used by it.\n  *\n  * Updates the original editor element with the data if the\n  * {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy `updateSourceElementOnDestroy`}\n  * configuration option is set to `true`.\n  *\n  * **Note**: The multi-root editor does not remove the toolbar and editable when destroyed. You can\n  * do that yourself in the destruction chain, if you need to:\n  *\n  * ```ts\n  * editor.destroy().then( () => {\n  * \t// Remove the toolbar from DOM.\n  * \teditor.ui.view.toolbar.element.remove();\n  *\n  * \t// Remove editable elements from DOM.\n  * \tfor ( const editable of Object.values( editor.ui.view.editables ) ) {\n  * \t    editable.element.remove();\n  * \t}\n  *\n  * \tconsole.log( 'Editor was destroyed' );\n  * } );\n  * ```\n  */\n  destroy() {\n    const shouldUpdateSourceElement = this.config.get('updateSourceElementOnDestroy');\n    // Cache the data and editable DOM elements, then destroy.\n    // It's safe to assume that the model->view conversion will not work after `super.destroy()`,\n    // same as `ui.getEditableElement()` method will not return editables.\n    const data = {};\n    for (const rootName of Object.keys(this.sourceElements)) {\n      data[rootName] = shouldUpdateSourceElement ? this.getData({\n        rootName\n      }) : '';\n    }\n    this.ui.destroy();\n    return super.destroy().then(() => {\n      for (const rootName of Object.keys(this.sourceElements)) {\n        setDataInElement(this.sourceElements[rootName], data[rootName]);\n      }\n    });\n  }\n  /**\n  * Adds a new root to the editor.\n  *\n  * ```ts\n  * editor.addRoot( 'myRoot', { data: '<p>Initial root data.</p>' } );\n  * ```\n  *\n  * After a root is added, you will be able to modify and retrieve its data.\n  *\n  * All root names must be unique. An error will be thrown if you will try to create a root with the name same as\n  * an already existing, attached root. However, you can call this method for a detached root. See also {@link #detachRoot}.\n  *\n  * Whenever a root is added, the editor instance will fire {@link #event:addRoot `addRoot` event}. The event is also called when\n  * the root is added indirectly, e.g. by the undo feature or on a remote client during real-time collaboration.\n  *\n  * Note, that this method only adds a root to the editor model. It **does not** create a DOM editable element for the new root.\n  * Until such element is created (and attached to the root), the root is \"virtual\": it is not displayed anywhere and its data can\n  * be changed only using the editor API.\n  *\n  * To create a DOM editable element for the root, listen to {@link #event:addRoot `addRoot` event} and call {@link #createEditable}.\n  * Then, insert the DOM element in a desired place, that will depend on the integration with your application and your requirements.\n  *\n  * ```ts\n  * editor.on( 'addRoot', ( evt, root ) => {\n  * \tconst editableElement = editor.createEditable( root );\n  *\n  * \t// You may want to create a more complex DOM structure here.\n  * \t//\n  * \t// Alternatively, you may want to create a DOM structure before\n  * \t// calling `editor.addRoot()` and only append `editableElement` at\n  * \t// a proper place.\n  *\n  * \tdocument.querySelector( '#editors' ).appendChild( editableElement );\n  * } );\n  *\n  * // ...\n  *\n  * editor.addRoot( 'myRoot' ); // Will create a root, a DOM editable element and append it to `#editors` container element.\n  * ```\n  *\n  * You can set root attributes on the new root while you add it:\n  *\n  * ```ts\n  * // Add a collapsed root at fourth position from top.\n  * // Keep in mind that these are just examples of attributes. You need to provide your own features that will handle the attributes.\n  * editor.addRoot( 'myRoot', { attributes: { isCollapsed: true, index: 4 } } );\n  * ```\n  *\n  * Note that attributes added together with a root are automatically registered.\n  *\n  * See also {@link ~MultiRootEditor#registerRootAttribute `MultiRootEditor#registerRootAttribute()`} and\n  * {@link module:core/editor/editorconfig~EditorConfig#rootsAttributes `config.rootsAttributes` configuration option}.\n  *\n  * By setting `isUndoable` flag to `true`, you can allow for detaching the root using the undo feature.\n  *\n  * Additionally, you can group adding multiple roots in one undo step. This can be useful if you add multiple roots that are\n  * combined into one, bigger UI element, and want them all to be undone together.\n  *\n  * ```ts\n  * let rowId = 0;\n  *\n  * editor.model.change( () => {\n  * \teditor.addRoot( 'left-row-' + rowId, { isUndoable: true } );\n  * \teditor.addRoot( 'center-row-' + rowId, { isUndoable: true } );\n  * \teditor.addRoot( 'right-row-' + rowId, { isUndoable: true } );\n  *\n  * \trowId++;\n  * } );\n  * ```\n  *\n  * @param rootName Name of the root to add.\n  * @param options Additional options for the added root.\n  */\n  addRoot(rootName, {\n    data = '',\n    attributes = {},\n    elementName = '$root',\n    isUndoable = false\n  } = {}) {\n    const _addRoot = writer => {\n      const root = writer.addRoot(rootName, elementName);\n      if (data) {\n        writer.insert(this.data.parse(data, root), root, 0);\n      }\n      for (const key of Object.keys(attributes)) {\n        this.registerRootAttribute(key);\n        writer.setAttribute(key, attributes[key], root);\n      }\n    };\n    if (isUndoable) {\n      this.model.change(_addRoot);\n    } else {\n      this.model.enqueueChange({\n        isUndoable: false\n      }, _addRoot);\n    }\n  }\n  /**\n  * Detaches a root from the editor.\n  *\n  * ```ts\n  * editor.detachRoot( 'myRoot' );\n  * ```\n  *\n  * A detached root is not entirely removed from the editor model, however it can be considered removed.\n  *\n  * After a root is detached all its children are removed, all markers inside it are removed, and whenever something is inserted to it,\n  * it is automatically removed as well. Finally, a detached root is not returned by\n  * {@link module:engine/model/document~Document#getRootNames} by default.\n  *\n  * It is possible to re-add a previously detached root calling {@link #addRoot}.\n  *\n  * Whenever a root is detached, the editor instance will fire {@link #event:detachRoot `detachRoot` event}. The event is also\n  * called when the root is detached indirectly, e.g. by the undo feature or on a remote client during real-time collaboration.\n  *\n  * Note, that this method only detached a root in the editor model. It **does not** destroy the DOM editable element linked with\n  * the root and it **does not** remove the DOM element from the DOM structure of your application.\n  *\n  * To properly remove a DOM editable element after a root was detached, listen to {@link #event:detachRoot `detachRoot` event}\n  * and call {@link #detachEditable}. Then, remove the DOM element from your application.\n  *\n  * ```ts\n  * editor.on( 'detachRoot', ( evt, root ) => {\n  * \tconst editableElement = editor.detachEditable( root );\n  *\n  * \t// You may want to do an additional DOM clean-up here.\n  *\n  * \teditableElement.remove();\n  * } );\n  *\n  * // ...\n  *\n  * editor.detachRoot( 'myRoot' ); // Will detach the root, and remove the DOM editable element.\n  * ```\n  *\n  * By setting `isUndoable` flag to `true`, you can allow for re-adding the root using the undo feature.\n  *\n  * Additionally, you can group detaching multiple roots in one undo step. This can be useful if the roots are combined into one,\n  * bigger UI element, and you want them all to be re-added together.\n  *\n  * ```ts\n  * editor.model.change( () => {\n  * \teditor.detachRoot( 'left-row-3', true );\n  * \teditor.detachRoot( 'center-row-3', true );\n  * \teditor.detachRoot( 'right-row-3', true );\n  * } );\n  * ```\n  *\n  * @param rootName Name of the root to detach.\n  * @param isUndoable Whether detaching the root can be undone (using the undo feature) or not.\n  */\n  detachRoot(rootName, isUndoable = false) {\n    if (isUndoable) {\n      this.model.change(writer => writer.detachRoot(rootName));\n    } else {\n      this.model.enqueueChange({\n        isUndoable: false\n      }, writer => writer.detachRoot(rootName));\n    }\n  }\n  /**\n  * Creates and returns a new DOM editable element for the given root element.\n  *\n  * The new DOM editable is attached to the model root and can be used to modify the root content.\n  *\n  * @param root Root for which the editable element should be created.\n  * @param placeholder Placeholder for the editable element. If not set, placeholder value from the\n  * {@link module:core/editor/editorconfig~EditorConfig#placeholder editor configuration} will be used (if it was provided).\n  * @param label The accessible label text describing the editable to the assistive technologies.\n  * @returns The created DOM element. Append it in a desired place in your application.\n  */\n  createEditable(root, placeholder, label) {\n    const editable = this.ui.view.createEditable(root.rootName, undefined, label);\n    this.ui.addEditable(editable, placeholder);\n    this.editing.view.forceRender();\n    return editable.element;\n  }\n  /**\n  * Detaches the DOM editable element that was attached to the given root.\n  *\n  * @param root Root for which the editable element should be detached.\n  * @returns The DOM element that was detached. You may want to remove it from your application DOM structure.\n  */\n  detachEditable(root) {\n    const rootName = root.rootName;\n    const editable = this.ui.view.editables[rootName];\n    this.ui.removeEditable(editable);\n    this.ui.view.removeEditable(rootName);\n    return editable.element;\n  }\n  /**\n  * Loads a root that has previously been declared in {@link module:core/editor/editorconfig~EditorConfig#lazyRoots `lazyRoots`}\n  * configuration option.\n  *\n  * Only roots specified in the editor config can be loaded. A root cannot be loaded multiple times. A root cannot be unloaded and\n  * loading a root cannot be reverted using the undo feature.\n  *\n  * When a root becomes loaded, it will be treated by the editor as though it was just added. This, among others, means that all\n  * related events and mechanisms will be fired, including {@link ~MultiRootEditor#event:addRoot `addRoot` event},\n  * {@link module:engine/model/document~Document#event:change `model.Document` `change` event}, model post-fixers and conversion.\n  *\n  * Until the root becomes loaded, all above mechanisms are suppressed.\n  *\n  * This method is {@link module:utils/observablemixin~Observable#decorate decorated}.\n  *\n  * Note that attributes loaded together with a root are automatically registered.\n  *\n  * See also {@link ~MultiRootEditor#registerRootAttribute `MultiRootEditor#registerRootAttribute()`} and\n  * {@link module:core/editor/editorconfig~EditorConfig#rootsAttributes `config.rootsAttributes` configuration option}.\n  *\n  * When this method is used in real-time collaboration environment, its effects become asynchronous as the editor will first synchronize\n  * with the remote editing session, before the root is added to the editor.\n  *\n  * If the root has been already loaded by any other client, the additional data passed in `loadRoot()` parameters will be ignored.\n  *\n  * @param rootName Name of the root to load.\n  * @param options Additional options for the loaded root.\n  * @fires loadRoot\n  */\n  loadRoot(rootName, {\n    data = '',\n    attributes = {}\n  } = {}) {\n    // `root` will be defined as it is guaranteed by a check in a higher priority callback.\n    const root = this.model.document.getRoot(rootName);\n    this.model.enqueueChange({\n      isUndoable: false\n    }, writer => {\n      if (data) {\n        writer.insert(this.data.parse(data, root), root, 0);\n      }\n      for (const key of Object.keys(attributes)) {\n        this.registerRootAttribute(key);\n        writer.setAttribute(key, attributes[key], root);\n      }\n      root._isLoaded = true;\n      this.model.document.differ._bufferRootLoad(root);\n    });\n  }\n  /**\n  * Returns the document data for all attached roots.\n  *\n  * @param options Additional configuration for the retrieved data.\n  * Editor features may introduce more configuration options that can be set through this parameter.\n  * @param options.trim Whether returned data should be trimmed. This option is set to `'empty'` by default,\n  * which means that whenever editor content is considered empty, an empty string is returned. To turn off trimming\n  * use `'none'`. In such cases exact content will be returned (for example `'<p>&nbsp;</p>'` for an empty editor).\n  * @returns The full document data.\n  */\n  getFullData(options) {\n    const data = {};\n    for (const rootName of this.model.document.getRootNames()) {\n      data[rootName] = this.data.get({\n        ...options,\n        rootName\n      });\n    }\n    return data;\n  }\n  /**\n  * Returns attributes for all attached roots.\n  *\n  * Note: all and only {@link ~MultiRootEditor#registerRootAttribute registered} roots attributes will be returned.\n  * If a registered root attribute is not set for a given root, `null` will be returned.\n  *\n  * @returns Object with roots attributes. Keys are roots names, while values are attributes set on given root.\n  */\n  getRootsAttributes() {\n    const rootsAttributes = {};\n    for (const rootName of this.model.document.getRootNames()) {\n      rootsAttributes[rootName] = this.getRootAttributes(rootName);\n    }\n    return rootsAttributes;\n  }\n  /**\n  * Returns attributes for the specified root.\n  *\n  * Note: all and only {@link ~MultiRootEditor#registerRootAttribute registered} roots attributes will be returned.\n  * If a registered root attribute is not set for a given root, `null` will be returned.\n  */\n  getRootAttributes(rootName) {\n    const rootAttributes = {};\n    const root = this.model.document.getRoot(rootName);\n    for (const key of this._registeredRootsAttributesKeys) {\n      rootAttributes[key] = root.hasAttribute(key) ? root.getAttribute(key) : null;\n    }\n    return rootAttributes;\n  }\n  /**\n  * Registers given string as a root attribute key. Registered root attributes are added to\n  * {@link module:engine/model/schema~Schema schema}, and also returned by\n  * {@link ~MultiRootEditor#getRootAttributes `getRootAttributes()`} and\n  * {@link ~MultiRootEditor#getRootsAttributes `getRootsAttributes()`}.\n  *\n  * Note: attributes passed in {@link module:core/editor/editorconfig~EditorConfig#rootsAttributes `config.rootsAttributes`} are\n  * automatically registered as the editor is initialized. However, registering the same attribute twice does not have any negative\n  * impact, so it is recommended to use this method in any feature that uses roots attributes.\n  */\n  registerRootAttribute(key) {\n    if (this._registeredRootsAttributesKeys.has(key)) {\n      return;\n    }\n    this._registeredRootsAttributesKeys.add(key);\n    this.editing.model.schema.extend('$root', {\n      allowAttributes: key\n    });\n  }\n  /**\n  * Switches given editor root to the read-only mode.\n  *\n  * In contrary to {@link module:core/editor/editor~Editor#enableReadOnlyMode `enableReadOnlyMode()`}, which switches the whole editor\n  * to the read-only mode, this method turns only a particular root to the read-only mode. This can be useful when you want to prevent\n  * editing only a part of the editor content.\n  *\n  * When you switch a root to the read-only mode, you need provide a unique identifier (`lockId`) that will identify this request. You\n  * will need to provide the same `lockId` when you will want to\n  * {@link module:editor-multi-root/multirooteditor~MultiRootEditor#enableRoot re-enable} the root.\n  *\n  * ```ts\n  * const model = editor.model;\n  * const myRoot = model.document.getRoot( 'myRoot' );\n  *\n  * editor.disableRoot( 'myRoot', 'my-lock' );\n  * model.canEditAt( myRoot ); // `false`\n  *\n  * editor.disableRoot( 'myRoot', 'other-lock' );\n  * editor.disableRoot( 'myRoot', 'other-lock' ); // Multiple locks with the same ID have no effect.\n  * model.canEditAt( myRoot ); // `false`\n  *\n  * editor.enableRoot( 'myRoot', 'my-lock' );\n  * model.canEditAt( myRoot ); // `false`\n  *\n  * editor.enableRoot( 'myRoot', 'other-lock' );\n  * model.canEditAt( myRoot ); // `true`\n  * ```\n  *\n  * See also {@link module:core/editor/editor~Editor#enableReadOnlyMode `Editor#enableReadOnlyMode()`} and\n  * {@link module:editor-multi-root/multirooteditor~MultiRootEditor#enableRoot `MultiRootEditor#enableRoot()`}.\n  *\n  * @param rootName Name of the root to switch to read-only mode.\n  * @param lockId A unique ID for setting the editor to the read-only state.\n  */\n  disableRoot(rootName, lockId) {\n    if (rootName == '$graveyard') {\n      /**\n      * You cannot disable the `$graveyard` root.\n      *\n      * @error multi-root-editor-cannot-disable-graveyard-root\n      */\n      throw new CKEditorError('multi-root-editor-cannot-disable-graveyard-root', this);\n    }\n    const locksForGivenRoot = this._readOnlyRootLocks.get(rootName);\n    if (locksForGivenRoot) {\n      locksForGivenRoot.add(lockId);\n    } else {\n      this._readOnlyRootLocks.set(rootName, new Set([lockId]));\n      const editableRootElement = this.editing.view.document.getRoot(rootName);\n      editableRootElement.isReadOnly = true;\n      // Since one of the roots has changed read-only state, we need to refresh all commands that affect data.\n      Array.from(this.commands.commands()).forEach(command => command.affectsData && command.refresh());\n    }\n  }\n  /**\n  * Removes given read-only lock from the given root.\n  *\n  * See {@link module:editor-multi-root/multirooteditor~MultiRootEditor#disableRoot `disableRoot()`}.\n  *\n  * @param rootName Name of the root to switch back from the read-only mode.\n  * @param lockId A unique ID for setting the editor to the read-only state.\n  */\n  enableRoot(rootName, lockId) {\n    const locksForGivenRoot = this._readOnlyRootLocks.get(rootName);\n    if (!locksForGivenRoot || !locksForGivenRoot.has(lockId)) {\n      return;\n    }\n    if (locksForGivenRoot.size === 1) {\n      this._readOnlyRootLocks.delete(rootName);\n      const editableRootElement = this.editing.view.document.getRoot(rootName);\n      editableRootElement.isReadOnly = this.isReadOnly;\n      // Since one of the roots has changed read-only state, we need to refresh all commands that affect data.\n      Array.from(this.commands.commands()).forEach(command => command.affectsData && command.refresh());\n    } else {\n      locksForGivenRoot.delete(lockId);\n    }\n  }\n  /**\n  * Creates a new multi-root editor instance.\n  *\n  * **Note:** remember that `MultiRootEditor` does not append the toolbar element to your web page, so you have to do it manually\n  * after the editor has been initialized.\n  *\n  * There are a few different ways to initialize the multi-root editor.\n  *\n  * # Using existing DOM elements:\n  *\n  * ```ts\n  * MultiRootEditor.create( {\n  * \tintro: document.querySelector( '#editor-intro' ),\n  * \tcontent: document.querySelector( '#editor-content' ),\n  * \tsidePanelLeft: document.querySelector( '#editor-side-left' ),\n  * \tsidePanelRight: document.querySelector( '#editor-side-right' ),\n  * \toutro: document.querySelector( '#editor-outro' )\n  * } )\n  * .then( editor => {\n  * \tconsole.log( 'Editor was initialized', editor );\n  *\n  * \t// Append the toolbar inside a provided DOM element.\n  * \tdocument.querySelector( '#toolbar-container' ).appendChild( editor.ui.view.toolbar.element );\n  * } )\n  * .catch( err => {\n  * \tconsole.error( err.stack );\n  * } );\n  * ```\n  *\n  * The elements' content will be used as the editor data and elements will become editable elements.\n  *\n  * # Creating a detached editor\n  *\n  * Alternatively, you can initialize the editor by passing the initial data directly as strings.\n  * In this case, you will have to manually append both the toolbar element and the editable elements to your web page.\n  *\n  * ```ts\n  * MultiRootEditor.create( {\n  * \tintro: '<p><strong>Exciting</strong> intro text to an article.</p>',\n  * \tcontent: '<p>Lorem ipsum dolor sit amet.</p>',\n  * \tsidePanelLeft: '<blockquote>Strong quotation from article.</blockquote>',\n  * \tsidePanelRight: '<p>List of similar articles...</p>',\n  * \toutro: '<p>Closing text.</p>'\n  * } )\n  * .then( editor => {\n  * \tconsole.log( 'Editor was initialized', editor );\n  *\n  * \t// Append the toolbar inside a provided DOM element.\n  * \tdocument.querySelector( '#toolbar-container' ).appendChild( editor.ui.view.toolbar.element );\n  *\n  * \t// Append DOM editable elements created by the editor.\n  * \tconst editables = editor.ui.view.editables;\n  * \tconst container = document.querySelector( '#editable-container' );\n  *\n  * \tcontainer.appendChild( editables.intro.element );\n  * \tcontainer.appendChild( editables.content.element );\n  * \tcontainer.appendChild( editables.outro.element );\n  * } )\n  * .catch( err => {\n  * \tconsole.error( err.stack );\n  * } );\n  * ```\n  *\n  * This lets you dynamically append the editor to your web page whenever it is convenient for you. You may use this method if your\n  * web page content is generated on the client side and the DOM structure is not ready at the moment when you initialize the editor.\n  *\n  * # Using an existing DOM element (and data provided in `config.initialData`)\n  *\n  * You can also mix these two ways by providing a DOM element to be used and passing the initial data through the configuration:\n  *\n  * ```ts\n  * MultiRootEditor.create( {\n  * \tintro: document.querySelector( '#editor-intro' ),\n  * \tcontent: document.querySelector( '#editor-content' ),\n  * \tsidePanelLeft: document.querySelector( '#editor-side-left' ),\n  * \tsidePanelRight: document.querySelector( '#editor-side-right' ),\n  * \toutro: document.querySelector( '#editor-outro' )\n  * }, {\n  * \tinitialData: {\n  * \t\tintro: '<p><strong>Exciting</strong> intro text to an article.</p>',\n  * \t\tcontent: '<p>Lorem ipsum dolor sit amet.</p>',\n  * \t\tsidePanelLeft '<blockquote>Strong quotation from article.</blockquote>':\n  * \t\tsidePanelRight '<p>List of similar articles...</p>':\n  * \t\toutro: '<p>Closing text.</p>'\n  * \t}\n  * } )\n  * .then( editor => {\n  * \tconsole.log( 'Editor was initialized', editor );\n  *\n  * \t// Append the toolbar inside a provided DOM element.\n  * \tdocument.querySelector( '#toolbar-container' ).appendChild( editor.ui.view.toolbar.element );\n  * } )\n  * .catch( err => {\n  * \tconsole.error( err.stack );\n  * } );\n  * ```\n  *\n  * This method can be used to initialize the editor on an existing element with the specified content in case if your integration\n  * makes it difficult to set the content of the source element.\n  *\n  * Note that an error will be thrown if you pass the initial data both as the first parameter and also in the configuration.\n  *\n  * # Configuring the editor\n  *\n  * See the {@link module:core/editor/editorconfig~EditorConfig editor configuration documentation} to learn more about\n  * customizing plugins, toolbar and more.\n  *\n  * @param sourceElementsOrData The DOM elements that will be the source for the created editor\n  * or the editor's initial data. The editor will initialize multiple roots with names according to the keys in the passed object.\n  *\n  * If DOM elements are passed, their content will be automatically loaded to the editor upon initialization and the elements will be\n  * used as the editor's editable areas. The editor data will be set back to the original element once the editor is destroyed if the\n  * {@link module:core/editor/editorconfig~EditorConfig#updateSourceElementOnDestroy updateSourceElementOnDestroy} option\n  * is set to `true`.\n  *\n  * If the initial data is passed, a detached editor will be created. For each entry in the passed object, one editor root and one\n  * editable DOM element will be created. You will need to attach the editable elements into the DOM manually. The elements are available\n  * through the {@link module:editor-multi-root/multirooteditorui~MultiRootEditorUI#getEditableElement `editor.ui.getEditableElement()`}\n  * method.\n  * @param config The editor configuration.\n  * @returns A promise resolved once the editor is ready. The promise resolves with the created editor instance.\n  */\n  static create(sourceElementsOrData, config = {}) {\n    return new Promise(resolve => {\n      for (const sourceItem of Object.values(sourceElementsOrData)) {\n        if (isElement(sourceItem) && sourceItem.tagName === 'TEXTAREA') {\n          // Documented in core/editor/editor.js\n          // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n          throw new CKEditorError('editor-wrong-element', null);\n        }\n      }\n      const editor = new this(sourceElementsOrData, config);\n      resolve(editor.initPlugins().then(() => editor.ui.init()).then(() => {\n        // This is checked directly before setting the initial data,\n        // as plugins may change `EditorConfig#initialData` value.\n        editor._verifyRootsWithInitialData();\n        return editor.data.init(editor.config.get('initialData'));\n      }).then(() => editor.fire('ready')).then(() => editor));\n    });\n  }\n  /**\n  * @internal\n  */\n  _verifyRootsWithInitialData() {\n    const initialData = this.config.get('initialData');\n    // Roots that are not in the initial data.\n    for (const rootName of this.model.document.getRootNames()) {\n      if (!(rootName in initialData)) {\n        /**\n        * Editor roots do not match the\n        * {@link module:core/editor/editorconfig~EditorConfig#initialData `initialData` configuration}.\n        *\n        * This may happen for one of the two reasons:\n        *\n        * * Configuration error. The `sourceElementsOrData` parameter in\n        * {@link module:editor-multi-root/multirooteditor~MultiRootEditor.create `MultiRootEditor.create()`} contains different\n        * roots than {@link module:core/editor/editorconfig~EditorConfig#initialData `initialData` configuration}.\n        * * As the editor was initialized, the {@link module:core/editor/editorconfig~EditorConfig#initialData `initialData`}\n        * configuration value or the state of the editor roots has been changed.\n        *\n        * @error multi-root-editor-root-initial-data-mismatch\n        */\n        throw new CKEditorError('multi-root-editor-root-initial-data-mismatch', null);\n      }\n    }\n    // Roots that are not in the editor.\n    for (const rootName of Object.keys(initialData)) {\n      const root = this.model.document.getRoot(rootName);\n      if (!root || !root.isAttached()) {\n        // eslint-disable-next-line ckeditor5-rules/ckeditor-error-message\n        throw new CKEditorError('multi-root-editor-root-initial-data-mismatch', null);\n      }\n    }\n  }\n}\nfunction getInitialData(sourceElementOrData) {\n  return isElement(sourceElementOrData) ? getDataFromElement(sourceElementOrData) : sourceElementOrData;\n}\nfunction isElement(value) {\n  return isElement$1(value);\n}\nexport { MultiRootEditor };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, Command } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { logWarning, version, FocusTracker, KeystrokeHandler, global, Collection } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { Typing } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport fuzzysort from 'fuzzysort';\nimport { groupBy, escapeRegExp } from 'es-toolkit/compat';\nimport { View, addKeyboardHandlingForGrid, ButtonView, FocusCycler, SearchTextView, createLabeledInputText, createDropdown, ViewModel, addListToDropdown, SearchInfoView, ViewCollection, isFocusable, isViewWithFocusCycler, FormHeaderView, ContextualBalloon, Dialog, MenuBarMenuListItemButtonView, clickOutsideHandler } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconPreviousArrow, IconEmoji } from '@ckeditor/ckeditor5-icons/dist/index.js';\n\n/**\n * @license Copyright (c) 2023, Koala Interactive SAS\n * For licensing, see https://github.com/koala-interactive/is-emoji-supported/blob/master/LICENSE.md\n */ /**\n    * @module emoji/utils/isemojisupported\n    */ /**\n       * Checks if the two pixels parts are the same using canvas.\n       */\nfunction isEmojiSupported(unicode) {\n  const ctx = getCanvas();\n  /* istanbul ignore next -- @preserve */\n  if (!ctx) {\n    return false;\n  }\n  const CANVAS_HEIGHT = 25;\n  const CANVAS_WIDTH = 20;\n  const textSize = Math.floor(CANVAS_HEIGHT / 2);\n  // Initialize canvas context.\n  ctx.font = textSize + 'px Arial, Sans-Serif';\n  ctx.textBaseline = 'top';\n  ctx.canvas.width = CANVAS_WIDTH * 2;\n  ctx.canvas.height = CANVAS_HEIGHT;\n  ctx.clearRect(0, 0, CANVAS_WIDTH * 2, CANVAS_HEIGHT);\n  // Draw in red on the left.\n  ctx.fillStyle = '#FF0000';\n  ctx.fillText(unicode, 0, 22);\n  // Draw in blue on right.\n  ctx.fillStyle = '#0000FF';\n  ctx.fillText(unicode, CANVAS_WIDTH, 22);\n  const a = ctx.getImageData(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT).data;\n  const count = a.length;\n  let i = 0;\n  // Search the first visible pixel.\n  for (; i < count && !a[i + 3]; i += 4);\n  // No visible pixel.\n  /* istanbul ignore next -- @preserve */\n  if (i >= count) {\n    return false;\n  }\n  // Emoji has immutable color, so we check the color of the emoji in two different colors.\n  // the result show be the same.\n  const x = CANVAS_WIDTH + i / 4 % CANVAS_WIDTH;\n  const y = Math.floor(i / 4 / CANVAS_WIDTH);\n  const b = ctx.getImageData(x, y, 1, 1).data;\n  /* istanbul ignore next -- @preserve */\n  if (a[i] !== b[0] || a[i + 2] !== b[2]) {\n    return false;\n  }\n  //Some emojis consist of different ones, so they will show multiple characters if they are not supported.\n  /* istanbul ignore next -- @preserve */\n  if (ctx.measureText(unicode).width >= CANVAS_WIDTH) {\n    return false;\n  }\n  // Supported.\n  return true;\n}\nfunction getCanvas() {\n  try {\n    return document.createElement('canvas').getContext('2d', {\n      willReadFrequently: true\n    });\n  } catch {\n    /* istanbul ignore next -- @preserve */return null;\n  }\n}\n\n/**\n * @module emoji/emojiutils\n */\nconst SKIN_TONE_MAP = {\n  0: 'default',\n  1: 'light',\n  2: 'medium-light',\n  3: 'medium',\n  4: 'medium-dark',\n  5: 'dark'\n};\n/**\n * A map representing an emoji and its release version.\n * It's used to identify a user's minimal supported emoji level.\n * We skip versions with older patches, such as 15.0 instead of 15.1 etc.\n */\nconst EMOJI_SUPPORT_LEVEL = {\n  'ðŸ«©': 16,\n  'ðŸ«¨': 15.1,\n  'ðŸ« ': 14,\n  'ðŸ˜¶â€ðŸŒ«ï¸': 13.1,\n  'ðŸ§‘â€ðŸ’»': 12.1,\n  'ðŸ¥°': 11,\n  'ðŸ¤ª': 5,\n  'âš•ï¸': 4,\n  'ðŸ¤£': 3,\n  'ðŸ‘‹ðŸ½': 2,\n  'ðŸ˜€': 1,\n  'ðŸ˜': 0.7,\n  'ðŸ˜‚': 0.6 // Face with Tears of Joy.\n};\nconst BASELINE_EMOJI_WIDTH = 24;\n/**\n * The Emoji utilities plugin.\n */\nclass EmojiUtils extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'EmojiUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * Checks if the emoji is supported by verifying the emoji version supported by the system first.\n  * Then checks if emoji contains a zero width joiner (ZWJ), and if yes, then checks if it is supported by the system.\n  */\n  isEmojiSupported(item, emojiSupportedVersionByOs, container) {\n    const isEmojiVersionSupported = item.version <= emojiSupportedVersionByOs;\n    if (!isEmojiVersionSupported) {\n      return false;\n    }\n    if (!this.hasZwj(item.emoji)) {\n      return true;\n    }\n    return this.isEmojiZwjSupported(item, container);\n  }\n  /**\n  * Checks the supported emoji version by the OS, by sampling some representatives from different emoji releases.\n  */\n  getEmojiSupportedVersionByOs() {\n    for (const [emoji, emojiVersion] of Object.entries(EMOJI_SUPPORT_LEVEL)) {\n      if (EmojiUtils._isEmojiSupported(emoji)) {\n        return emojiVersion;\n      }\n    }\n    return 0;\n  }\n  /**\n  * Check for ZWJ (zero width joiner) character.\n  */\n  hasZwj(emoji) {\n    return emoji.includes('\\u200d');\n  }\n  /**\n  * Checks whether the emoji is supported in the operating system.\n  */\n  isEmojiZwjSupported(item, container) {\n    const emojiWidth = this.getNodeWidth(container, item.emoji);\n    // On Windows, some supported emoji are ~50% bigger than the baseline emoji, but what we really want to guard\n    // against are the ones that are 2x the size, because those are truly broken (person with red hair = person with\n    // floating red wig, black cat = cat with black square, polar bear = bear with snowflake, etc.)\n    // So here we set the threshold at 1.8 times the size of the baseline emoji.\n    return emojiWidth < BASELINE_EMOJI_WIDTH * 1.8;\n  }\n  /**\n  * Returns the width of the provided node.\n  */\n  getNodeWidth(container, node) {\n    const span = document.createElement('span');\n    span.textContent = node;\n    container.appendChild(span);\n    const nodeWidth = span.offsetWidth;\n    container.removeChild(span);\n    return nodeWidth;\n  }\n  /**\n  * Creates a div for emoji width testing purposes.\n  */\n  createEmojiWidthTestingContainer() {\n    const container = document.createElement('div');\n    container.setAttribute('aria-hidden', 'true');\n    container.style.position = 'absolute';\n    container.style.left = '-9999px';\n    container.style.whiteSpace = 'nowrap';\n    container.style.fontSize = BASELINE_EMOJI_WIDTH + 'px';\n    return container;\n  }\n  /**\n  * Adds default skin tone property to each emoji. If emoji defines other skin tones, they are added as well.\n  */\n  normalizeEmojiSkinTone(item) {\n    const entry = {\n      ...item,\n      skins: {\n        default: item.emoji\n      }\n    };\n    if (item.skins) {\n      item.skins.forEach(skin => {\n        const skinTone = SKIN_TONE_MAP[skin.tone];\n        entry.skins[skinTone] = skin.emoji;\n      });\n    }\n    return entry;\n  }\n  /**\n  * Checks whether the emoji belongs to a group that is allowed.\n  */\n  isEmojiCategoryAllowed(item) {\n    // Category group=2 contains skin tones only, which we do not want to render.\n    return item.group !== 2;\n  }\n  /**\n  * A function used to determine if emoji is supported by detecting pixels.\n  *\n  * Referenced for unit testing purposes. Kept in a separate file because of licensing.\n  */\n  static _isEmojiSupported = isEmojiSupported;\n}\n\n// An endpoint from which the emoji data will be downloaded during plugin initialization.\n// The `{version}` placeholder is replaced with the value from editor config.\nconst DEFAULT_EMOJI_DATABASE_URL = 'https://cdn.ckeditor.com/ckeditor5/data/emoji/{version}/en.json';\nconst DEFAULT_EMOJI_VERSION = 16;\n/**\n * The emoji repository plugin.\n *\n * Loads the emoji repository from URL during plugin initialization and provides utility methods to search it.\n */\nclass EmojiRepository extends Plugin {\n  /**\n  * Emoji repository in a configured version.\n  */\n  _items;\n  /**\n  * The resolved URL from which the emoji repository is downloaded.\n  */\n  _url;\n  /**\n  * A promise resolved after downloading the emoji collection.\n  * The promise resolves with `true` when the repository is successfully downloaded or `false` otherwise.\n  */\n  _repositoryPromise;\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [EmojiUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'EmojiRepository';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('emoji', {\n      version: undefined,\n      skinTone: 'default',\n      definitionsUrl: undefined,\n      useCustomFont: false\n    });\n    this._url = this._getUrl();\n    this._repositoryPromise = new Promise(resolve => {\n      this._repositoryPromiseResolveCallback = resolve;\n    });\n    this._items = null;\n  }\n  /**\n  * @inheritDoc\n  */\n  async init() {\n    this._warnAboutCdnUse();\n    await this._loadAndCacheEmoji();\n    this._items = this._getItems();\n    if (!this._items) {\n      /**\n      * Unable to identify the available emoji to display.\n      *\n      * See the {@glink features/emoji#troubleshooting troubleshooting} section in the {@glink features/emoji Emoji feature} guide\n      * for more details.\n      *\n      * @error emoji-repository-empty\n      */\n      logWarning('emoji-repository-empty');\n      return this._repositoryPromiseResolveCallback(false);\n    }\n    return this._repositoryPromiseResolveCallback(true);\n  }\n  /**\n  * Returns an array of emoji entries that match the search query.\n  * If the emoji repository is not loaded this method returns an empty array.\n  *\n  * @param searchQuery A search query to match emoji.\n  * @returns An array of emoji entries that match the search query.\n  */\n  getEmojiByQuery(searchQuery) {\n    if (!this._items) {\n      return [];\n    }\n    const searchQueryTokens = searchQuery.split(/\\s/).filter(Boolean);\n    // Perform the search only if there is at least two non-white characters next to each other.\n    const shouldSearch = searchQueryTokens.some(token => token.length >= 2);\n    if (!shouldSearch) {\n      return [];\n    }\n    return fuzzysort.go(searchQuery, this._items, {\n      threshold: 0.6,\n      keys: ['emoticon', 'annotation', emojiEntry => {\n        // Instead of searching over all tags, let's use only those that matches the query.\n        // It enables searching in tags with the space character in names.\n        const searchQueryTokens = searchQuery.split(/\\s/).filter(Boolean);\n        const matchedTags = searchQueryTokens.flatMap(tok => {\n          return emojiEntry.tags?.filter(t => t.startsWith(tok));\n        });\n        return matchedTags.join();\n      }]\n    }).map(result => result.obj);\n  }\n  /**\n  * Groups all emojis by categories.\n  * If the emoji repository is not loaded, it returns an empty array.\n  *\n  * @returns An array of emoji entries grouped by categories.\n  */\n  getEmojiCategories() {\n    const repository = this._getItems();\n    if (!repository) {\n      return [];\n    }\n    const {\n      t\n    } = this.editor.locale;\n    const categories = [{\n      title: t('Smileys & Expressions'),\n      icon: 'ðŸ˜„',\n      groupId: 0\n    }, {\n      title: t('Gestures & People'),\n      icon: 'ðŸ‘‹',\n      groupId: 1\n    }, {\n      title: t('Animals & Nature'),\n      icon: 'ðŸ»',\n      groupId: 3\n    }, {\n      title: t('Food & Drinks'),\n      icon: 'ðŸŽ',\n      groupId: 4\n    }, {\n      title: t('Travel & Places'),\n      icon: 'ðŸš˜',\n      groupId: 5\n    }, {\n      title: t('Activities'),\n      icon: 'ðŸ€',\n      groupId: 6\n    }, {\n      title: t('Objects'),\n      icon: 'ðŸ’¡',\n      groupId: 7\n    }, {\n      title: t('Symbols'),\n      icon: 'ðŸ”µ',\n      groupId: 8\n    }, {\n      title: t('Flags'),\n      icon: 'ðŸ',\n      groupId: 9\n    }];\n    const groups = groupBy(repository, item => item.group);\n    return categories.map(category => {\n      return {\n        ...category,\n        items: groups[category.groupId]\n      };\n    });\n  }\n  /**\n  * Returns an array of available skin tones.\n  */\n  getSkinTones() {\n    const {\n      t\n    } = this.editor.locale;\n    return [{\n      id: 'default',\n      icon: 'ðŸ‘‹',\n      tooltip: t('Default skin tone')\n    }, {\n      id: 'light',\n      icon: 'ðŸ‘‹ðŸ»',\n      tooltip: t('Light skin tone')\n    }, {\n      id: 'medium-light',\n      icon: 'ðŸ‘‹ðŸ¼',\n      tooltip: t('Medium Light skin tone')\n    }, {\n      id: 'medium',\n      icon: 'ðŸ‘‹ðŸ½',\n      tooltip: t('Medium skin tone')\n    }, {\n      id: 'medium-dark',\n      icon: 'ðŸ‘‹ðŸ¾',\n      tooltip: t('Medium Dark skin tone')\n    }, {\n      id: 'dark',\n      icon: 'ðŸ‘‹ðŸ¿',\n      tooltip: t('Dark skin tone')\n    }];\n  }\n  /**\n  * Indicates whether the emoji repository has been successfully downloaded and the plugin is operational.\n  */\n  isReady() {\n    return this._repositoryPromise;\n  }\n  /**\n  * Returns the URL from which the emoji repository is downloaded. If the URL is not provided\n  * in the configuration, the default URL is used with the version from the configuration.\n  *\n  * If both the URL and version are provided, a warning is logged.\n  */\n  _getUrl() {\n    const {\n      definitionsUrl,\n      version: version$1\n    } = this.editor.config.get('emoji');\n    if (!definitionsUrl || definitionsUrl === 'cdn') {\n      // URL was not provided or is set to 'cdn', so we use the default CDN URL.\n      const urlVersion = version$1 || DEFAULT_EMOJI_VERSION;\n      const url = new URL(DEFAULT_EMOJI_DATABASE_URL.replace('{version}', urlVersion.toString()));\n      url.searchParams.set('editorVersion', version);\n      return url;\n    }\n    if (version$1) {\n      /**\n      * Both {@link module:emoji/emojiconfig~EmojiConfig#definitionsUrl `emoji.definitionsUrl`} and\n      * {@link module:emoji/emojiconfig~EmojiConfig#version `emoji.version`} configuration options\n      * are set. Only the `emoji.definitionsUrl` option will be used.\n      *\n      * The `emoji.version` option will be ignored and should be removed from the configuration.\n      *\n      * @error emoji-repository-redundant-version\n      */\n      logWarning('emoji-repository-redundant-version');\n    }\n    return new URL(definitionsUrl);\n  }\n  /**\n  * Warn users on self-hosted installations that this plugin uses a CDN to fetch the emoji repository.\n  */\n  _warnAboutCdnUse() {\n    const editor = this.editor;\n    const config = editor.config.get('emoji');\n    const licenseKey = editor.config.get('licenseKey');\n    const distributionChannel = window[Symbol.for('cke distribution')];\n    if (licenseKey === 'GPL') {\n      // Don't warn GPL users.\n      return;\n    }\n    if (distributionChannel === 'cloud') {\n      // Don't warn cloud users, because they already use our CDN.\n      return;\n    }\n    if (config && config.definitionsUrl) {\n      // Don't warn users who have configured their own definitions URL.\n      return;\n    }\n    /**\n    * It was detected that your installation uses a commercial license key,\n    * and the default {@glink features/emoji#emoji-source CKEditor CDN for Emoji plugin data}.\n    *\n    * To avoid this, you can use the {@link module:emoji/emojiconfig~EmojiConfig#definitionsUrl `emoji.definitionsUrl`}\n    * configuration option to provide a URL to your own emoji repository.\n    *\n    * If you want to suppress this warning, while using the default CDN, set this configuration option to `cdn`.\n    *\n    * @error emoji-repository-cdn-use\n    */\n    logWarning('emoji-repository-cdn-use');\n  }\n  /**\n  * Returns the emoji repository in a configured version if it is a non-empty array. Returns `null` otherwise.\n  */\n  _getItems() {\n    const repository = EmojiRepository._results[this._url.href];\n    return repository && repository.length ? repository : null;\n  }\n  /**\n  * Loads the emoji repository. If the repository is already loaded, it returns the cached result.\n  * Otherwise, it fetches the repository from the URL and adds it to the cache.\n  */\n  async _loadAndCacheEmoji() {\n    if (EmojiRepository._results[this._url.href]) {\n      // The repository has already been downloaded.\n      return;\n    }\n    const result = await fetch(this._url, {\n      cache: 'force-cache'\n    }).then(response => {\n      if (!response.ok) {\n        return [];\n      }\n      return response.json();\n    }).catch(() => {\n      return [];\n    });\n    EmojiRepository._results[this._url.href] = this._normalizeEmoji(result);\n  }\n  /**\n  * Normalizes the raw data fetched from CDN. By normalization, we meant:\n  *\n  *  * Filter out unsupported emoji (these that will not render correctly),\n  *  * Prepare skin tone variants if an emoji defines them.\n  */\n  _normalizeEmoji(data) {\n    const editor = this.editor;\n    const useCustomFont = editor.config.get('emoji.useCustomFont');\n    const emojiUtils = editor.plugins.get('EmojiUtils');\n    const insertableEmoji = data.filter(item => emojiUtils.isEmojiCategoryAllowed(item));\n    // When using a custom font, the feature does not filter any emoji.\n    if (useCustomFont) {\n      return insertableEmoji.map(item => emojiUtils.normalizeEmojiSkinTone(item));\n    }\n    const emojiSupportedVersionByOs = emojiUtils.getEmojiSupportedVersionByOs();\n    const container = emojiUtils.createEmojiWidthTestingContainer();\n    document.body.appendChild(container);\n    const results = insertableEmoji.filter(item => emojiUtils.isEmojiSupported(item, emojiSupportedVersionByOs, container)).map(item => emojiUtils.normalizeEmojiSkinTone(item));\n    container.remove();\n    return results;\n  }\n  /**\n  * Versioned emoji repository.\n  */\n  static _results = {};\n}\n/**\n* Unable to load the emoji repository from the URL.\n*\n* If the URL works properly and there is no disruption of communication, please check your\n* {@glink getting-started/setup/csp Content Security Policy (CSP)} setting and make sure\n* the URL connection is allowed by the editor.\n*\n* @error emoji-repository-load-failed\n*/\n\nconst EMOJI_MENTION_MARKER = ':';\nconst EMOJI_SHOW_ALL_OPTION_ID = ':__EMOJI_SHOW_ALL:';\nconst EMOJI_HINT_OPTION_ID = ':__EMOJI_HINT:';\n/**\n * The emoji mention plugin.\n *\n * Introduces the autocomplete of emojis while typing.\n */\nclass EmojiMention extends Plugin {\n  /**\n  * Defines a number of displayed items in the auto complete dropdown.\n  *\n  * It includes the \"Show all emoji...\" option if the `EmojiPicker` plugin is loaded.\n  */\n  _emojiDropdownLimit;\n  /**\n  * Defines a skin tone that is set in the emoji config.\n  */\n  _skinTone;\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [EmojiRepository, Typing, 'Mention'];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'EmojiMention';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this.editor.config.define('emoji', {\n      dropdownLimit: 6\n    });\n    this._emojiDropdownLimit = editor.config.get('emoji.dropdownLimit');\n    this._skinTone = editor.config.get('emoji.skinTone');\n    this._setupMentionConfiguration(editor);\n  }\n  /**\n  * Initializes the configuration for emojis in the mention feature.\n  * If the marker used by emoji mention is already registered, it displays a warning.\n  * If emoji mention configuration is detected, it does not register it for a second time.\n  */\n  _setupMentionConfiguration(editor) {\n    const mergeFieldsPrefix = editor.config.get('mergeFields.prefix');\n    const mentionFeedsConfigs = editor.config.get('mention.feeds');\n    const isEmojiMarkerUsedByMergeFields = mergeFieldsPrefix ? mergeFieldsPrefix[0] === EMOJI_MENTION_MARKER : false;\n    const isEmojiMarkerUsedByMention = mentionFeedsConfigs.filter(config => !config._isEmojiMarker).some(config => config.marker === EMOJI_MENTION_MARKER);\n    if (isEmojiMarkerUsedByMention || isEmojiMarkerUsedByMergeFields) {\n      /**\n      * The `marker` in the `emoji` config is already used by other plugin configuration.\n      *\n      * @error emoji-config-marker-already-used\n      * @param {string} marker Used marker.\n      */\n      logWarning('emoji-config-marker-already-used', {\n        marker: EMOJI_MENTION_MARKER\n      });\n      return;\n    }\n    const isEmojiConfigDefined = mentionFeedsConfigs.some(config => config._isEmojiMarker);\n    if (isEmojiConfigDefined) {\n      return;\n    }\n    const emojiMentionFeedConfig = {\n      _isEmojiMarker: true,\n      marker: EMOJI_MENTION_MARKER,\n      dropdownLimit: this._emojiDropdownLimit,\n      itemRenderer: this._customItemRendererFactory(this.editor.t),\n      feed: this._queryEmojiCallbackFactory()\n    };\n    this.editor.config.set('mention.feeds', [...mentionFeedsConfigs, emojiMentionFeedConfig]);\n  }\n  /**\n  * @inheritDoc\n  */\n  async init() {\n    const editor = this.editor;\n    this.emojiPickerPlugin = editor.plugins.has('EmojiPicker') ? editor.plugins.get('EmojiPicker') : null;\n    this.emojiRepositoryPlugin = editor.plugins.get('EmojiRepository');\n    this._isEmojiRepositoryAvailable = await this.emojiRepositoryPlugin.isReady();\n    // Override the `mention` command listener if the emoji repository is ready.\n    if (this._isEmojiRepositoryAvailable) {\n      editor.once('ready', this._overrideMentionExecuteListener.bind(this));\n    }\n  }\n  /**\n  * Returns the `itemRenderer()` callback for mention config.\n  */\n  _customItemRendererFactory(t) {\n    return item => {\n      const itemElement = document.createElement('button');\n      itemElement.classList.add('ck');\n      itemElement.classList.add('ck-button');\n      itemElement.classList.add('ck-button_with-text');\n      itemElement.id = `mention-list-item-id${item.id.slice(0, -1)}`;\n      itemElement.type = 'button';\n      itemElement.tabIndex = -1;\n      const labelElement = document.createElement('span');\n      labelElement.classList.add('ck');\n      labelElement.classList.add('ck-button__label');\n      itemElement.appendChild(labelElement);\n      if (item.id === EMOJI_HINT_OPTION_ID) {\n        itemElement.classList.add('ck-list-item-button');\n        itemElement.classList.add('ck-disabled');\n        labelElement.textContent = t('Keep on typing to see the emoji.');\n      } else if (item.id === EMOJI_SHOW_ALL_OPTION_ID) {\n        labelElement.textContent = t('Show all emoji...');\n      } else {\n        labelElement.textContent = `${item.text} ${item.id}`;\n      }\n      return itemElement;\n    };\n  }\n  /**\n  * Overrides the default mention execute listener to insert an emoji as plain text instead.\n  */\n  _overrideMentionExecuteListener() {\n    const editor = this.editor;\n    editor.commands.get('mention').on('execute', (event, data) => {\n      const eventData = data[0];\n      // Ignore non-emoji auto-complete actions.\n      if (eventData.marker !== EMOJI_MENTION_MARKER) {\n        return;\n      }\n      // Do not propagate the event.\n      event.stop();\n      // Do nothing when executing after selecting a hint message.\n      if (eventData.mention.id === EMOJI_HINT_OPTION_ID) {\n        return;\n      }\n      // Trigger the picker UI.\n      if (eventData.mention.id === EMOJI_SHOW_ALL_OPTION_ID) {\n        const text = [...eventData.range.getItems()].filter(item => item.is('$textProxy')).map(item => item.data).reduce((result, text) => result + text, '');\n        editor.model.change(writer => {\n          editor.model.deleteContent(writer.createSelection(eventData.range));\n        });\n        const emojiPickerPlugin = this.emojiPickerPlugin;\n        emojiPickerPlugin.showUI(text.slice(1));\n        setTimeout(() => {\n          emojiPickerPlugin.emojiPickerView.focus();\n        });\n      } else {\n        editor.execute('insertText', {\n          text: eventData.mention.text,\n          range: eventData.range\n        });\n      }\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Returns the `feed()` callback for mention config.\n  */\n  _queryEmojiCallbackFactory() {\n    return searchQuery => {\n      // Do not show anything when a query starts with a space.\n      if (searchQuery.startsWith(' ')) {\n        return [];\n      }\n      // Do not show anything when a query starts with a marker character.\n      if (searchQuery.startsWith(EMOJI_MENTION_MARKER)) {\n        return [];\n      }\n      // If the repository plugin is not available, return an empty feed to avoid confusion. See: #17842.\n      if (!this._isEmojiRepositoryAvailable) {\n        return [];\n      }\n      const emojis = this.emojiRepositoryPlugin.getEmojiByQuery(searchQuery).map(emoji => {\n        let text = emoji.skins[this._skinTone] || emoji.skins.default;\n        if (this.emojiPickerPlugin) {\n          text = emoji.skins[this.emojiPickerPlugin.skinTone] || emoji.skins.default;\n        }\n        return {\n          id: `:${emoji.annotation}:`,\n          text\n        };\n      });\n      if (!this.emojiPickerPlugin) {\n        return emojis.slice(0, this._emojiDropdownLimit);\n      }\n      const actionItem = {\n        id: searchQuery.length > 1 ? EMOJI_SHOW_ALL_OPTION_ID : EMOJI_HINT_OPTION_ID\n      };\n      return [...emojis.slice(0, this._emojiDropdownLimit - 1), actionItem];\n    };\n  }\n}\n\n/**\n * Command that shows the emoji user interface.\n */\nclass EmojiCommand extends Command {\n  /**\n  * Updates the command's {@link #isEnabled} based on the current selection.\n  */\n  refresh() {\n    const editor = this.editor;\n    const model = editor.model;\n    const schema = model.schema;\n    const selection = model.document.selection;\n    this.isEnabled = schema.checkChild(selection.getFirstPosition(), '$text');\n  }\n  /**\n  * Opens emoji user interface for the current document selection.\n  *\n  * @fires execute\n  * @param [searchValue=''] A default query used to filer the grid when opening the UI.\n  */\n  execute(searchValue = '') {\n    const emojiPickerPlugin = this.editor.plugins.get('EmojiPicker');\n    emojiPickerPlugin.showUI(searchValue);\n  }\n}\n\n/**\n * A grid of emoji tiles. It allows browsing emojis and selecting them to be inserted into the content.\n */\nclass EmojiGridView extends View {\n  /**\n  * A collection of the child tile views. Each tile represents a particular emoji.\n  */\n  tiles;\n  /**\n  * Tracks information about the DOM focus in the grid.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * An array containing all emojis grouped by their categories.\n  */\n  emojiCategories;\n  /**\n  * A collection of all already created tile views. Each tile represents a particular emoji.\n  * The cached tiles collection is used for efficiency purposes to avoid re-creating a particular\n  * tile again when the grid view has changed.\n  */\n  cachedTiles;\n  /**\n  * A callback used to filter grid items by a specified query.\n  */\n  _getEmojiByQuery;\n  /**\n  * @inheritDoc\n  */\n  constructor(locale, {\n    categoryName,\n    emojiCategories,\n    getEmojiByQuery,\n    skinTone\n  }) {\n    super(locale);\n    this.set('isEmpty', true);\n    this.set('categoryName', categoryName);\n    this.set('skinTone', skinTone);\n    this.tiles = this.createCollection();\n    this.cachedTiles = this.createCollection();\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this._getEmojiByQuery = getEmojiByQuery;\n    this.emojiCategories = emojiCategories;\n    const bind = this.bindTemplate;\n    this.setTemplate({\n      tag: 'div',\n      children: [{\n        tag: 'div',\n        attributes: {\n          role: 'grid',\n          class: ['ck', 'ck-emoji__grid']\n        },\n        children: this.tiles\n      }],\n      attributes: {\n        role: 'tabpanel',\n        class: ['ck', 'ck-emoji__tiles',\n        // To avoid issues with focus cycling, ignore a grid when it's empty.\n        bind.if('isEmpty', 'ck-hidden', value => value)]\n      }\n    });\n    addKeyboardHandlingForGrid({\n      keystrokeHandler: this.keystrokes,\n      focusTracker: this.focusTracker,\n      gridItems: this.tiles,\n      numberOfColumns: () => global.window.getComputedStyle(this.element.firstChild) // Responsive `.ck-emoji-grid__tiles`.\n      .getPropertyValue('grid-template-columns').split(' ').length,\n      uiLanguageDirection: this.locale && this.locale.uiLanguageDirection\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.keystrokes.destroy();\n    this.focusTracker.destroy();\n  }\n  /**\n  * Focuses the first focusable in {@link ~EmojiGridView#tiles} if available.\n  */\n  focus() {\n    const firstTile = this.tiles.first;\n    if (firstTile) {\n      firstTile.focus();\n    }\n  }\n  /**\n  * Filters the grid view by the given regular expression.\n  *\n  * It filters either by the pattern or an emoji category, but never both.\n  *\n  * @param pattern Expression to search or `null` when filter by category name.\n  */\n  filter(pattern) {\n    const {\n      matchingItems,\n      allItems\n    } = pattern ? this._getItemsByQuery(pattern.source) : this._getItemsByCategory();\n    this._updateGrid(matchingItems);\n    this.set('isEmpty', matchingItems.length === 0);\n    return {\n      resultsCount: matchingItems.length,\n      totalItemsCount: allItems.length\n    };\n  }\n  /**\n  * Filters emojis to show based on the specified query phrase.\n  *\n  * @param query A query used to filter the grid.\n  */\n  _getItemsByQuery(query) {\n    return {\n      matchingItems: this._getEmojiByQuery(query),\n      allItems: this.emojiCategories.flatMap(group => group.items)\n    };\n  }\n  /**\n  * Returns emojis that belong to the specified category.\n  */\n  _getItemsByCategory() {\n    const emojiCategory = this.emojiCategories.find(item => item.title === this.categoryName);\n    const {\n      items\n    } = emojiCategory;\n    return {\n      matchingItems: items,\n      allItems: items\n    };\n  }\n  /**\n  * Updates the grid by removing the existing items and insert the new ones.\n  *\n  * @param items An array of items to insert.\n  */\n  _updateGrid(items) {\n    // Clean-up.\n    [...this.tiles].forEach(item => {\n      this.focusTracker.remove(item);\n      this.tiles.remove(item);\n    });\n    items // Create tiles from matching results.\n    .map(item => {\n      const emoji = item.skins[this.skinTone] || item.skins.default;\n      return this.cachedTiles.get(emoji) || this._createTile(emoji, item.annotation);\n    }) // Insert new elements.\n    .forEach(item => {\n      this.tiles.add(item);\n      this.focusTracker.add(item);\n    });\n  }\n  /**\n  * Creates a new tile for the grid. Created tile is added to the {@link #cachedTiles} collection for further usage, if needed.\n  *\n  * @param emoji The emoji itself.\n  * @param name The name of the emoji (e.g. \"Smiling Face with Smiling Eyes\").\n  */\n  _createTile(emoji, name) {\n    const tile = new ButtonView(this.locale);\n    tile.viewUid = emoji;\n    tile.extendTemplate({\n      attributes: {\n        class: ['ck-emoji__tile']\n      }\n    });\n    tile.set({\n      label: emoji,\n      tooltip: name,\n      withText: true,\n      ariaLabel: name,\n      // To improve accessibility, disconnect a button and its label connection so that screen\n      // readers can read the `[aria-label]` attribute directly from the more descriptive button.\n      ariaLabelledBy: undefined\n    });\n    tile.on('execute', () => {\n      this.fire('execute', {\n        name,\n        emoji\n      });\n    });\n    this.cachedTiles.add(tile);\n    return tile;\n  }\n}\n\n/**\n * A class representing the navigation part of the emoji UI.\n * It is responsible allowing the user to select a particular emoji category.\n */\nclass EmojiCategoriesView extends View {\n  /**\n  * Tracks information about the DOM focus in the grid.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * Helps cycling over focusable children in the input view.\n  */\n  focusCycler;\n  /**\n  * A collection of the categories buttons.\n  */\n  buttonViews;\n  /**\n  * @inheritDoc\n  */\n  constructor(locale, {\n    emojiCategories,\n    categoryName\n  }) {\n    super(locale);\n    this.buttonViews = this.createCollection(emojiCategories.map(emojiCategory => this._createCategoryButton(emojiCategory)));\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this.focusCycler = new FocusCycler({\n      focusables: this.buttonViews,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        focusPrevious: 'arrowleft',\n        focusNext: 'arrowright'\n      }\n    });\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-emoji__categories-list'],\n        role: 'tablist'\n      },\n      children: this.buttonViews\n    });\n    this.on('change:categoryName', (event, name, newValue, oldValue) => {\n      const oldCategoryButton = this.buttonViews.find(button => button.tooltip === oldValue);\n      if (oldCategoryButton) {\n        oldCategoryButton.isOn = false;\n      }\n      const newCategoryButton = this.buttonViews.find(button => button.tooltip === newValue);\n      newCategoryButton.isOn = true;\n    });\n    this.set('categoryName', categoryName);\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.buttonViews.forEach(buttonView => {\n      this.focusTracker.add(buttonView);\n    });\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n    this.buttonViews.destroy();\n  }\n  /**\n  * @inheritDoc\n  */\n  focus() {\n    this.buttonViews.first.focus();\n  }\n  /**\n  * Marks all categories buttons as enabled (clickable).\n  */\n  enableCategories() {\n    this.buttonViews.forEach(buttonView => {\n      buttonView.isEnabled = true;\n    });\n  }\n  /**\n  * Marks all categories buttons as disabled (non-clickable).\n  */\n  disableCategories() {\n    this.buttonViews.forEach(buttonView => {\n      buttonView.set({\n        class: '',\n        isEnabled: false,\n        isOn: false\n      });\n    });\n  }\n  /**\n  * Creates a button representing a category item.\n  */\n  _createCategoryButton(emojiCategory) {\n    const buttonView = new ButtonView();\n    const bind = buttonView.bindTemplate;\n    // A `[role=\"tab\"]` element requires also the `[aria-selected]` attribute with its state.\n    buttonView.extendTemplate({\n      attributes: {\n        'aria-selected': bind.to('isOn', value => value.toString()),\n        class: ['ck-emoji__category-item']\n      }\n    });\n    buttonView.set({\n      ariaLabel: emojiCategory.title,\n      label: emojiCategory.icon,\n      role: 'tab',\n      tooltip: emojiCategory.title,\n      withText: true,\n      // To improve accessibility, disconnect a button and its label connection so that screen\n      // readers can read the `[aria-label]` attribute directly from the more descriptive button.\n      ariaLabelledBy: undefined\n    });\n    buttonView.on('execute', () => {\n      this.categoryName = emojiCategory.title;\n    });\n    buttonView.on('change:isEnabled', () => {\n      if (buttonView.isEnabled && buttonView.tooltip === this.categoryName) {\n        buttonView.isOn = true;\n      }\n    });\n    return buttonView;\n  }\n}\n\n/**\n * A view responsible for providing an input element that allows filtering emoji by the provided query.\n */\nclass EmojiSearchView extends View {\n  /**\n  * The find in text input view that stores the searched string.\n  */\n  inputView;\n  /**\n  * An instance of the `EmojiGridView`.\n  */\n  gridView;\n  /**\n  * @inheritDoc\n  */\n  constructor(locale, {\n    gridView,\n    resultsView\n  }) {\n    super(locale);\n    this.gridView = gridView;\n    const t = locale.t;\n    this.inputView = new SearchTextView(this.locale, {\n      queryView: {\n        label: t('Find an emoji (min. 2 characters)'),\n        creator: createLabeledInputText\n      },\n      filteredView: this.gridView,\n      infoView: {\n        instance: resultsView\n      }\n    });\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-search'],\n        tabindex: '-1'\n      },\n      children: [this.inputView.queryView]\n    });\n    // Pass through the `search` event to handle it by a parent view.\n    this.inputView.delegate('search').to(this);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.inputView.destroy();\n  }\n  /**\n  * Searches the {@link #gridView} for the given query.\n  *\n  * @param query The search query string.\n  */\n  search(query) {\n    const regExp = query ? new RegExp(escapeRegExp(query), 'ig') : null;\n    const filteringResults = this.gridView.filter(regExp);\n    this.inputView.fire('search', {\n      query,\n      ...filteringResults\n    });\n  }\n  /**\n  * Allows defining the default value in the search text field.\n  *\n  * @param value The new value.\n  */\n  setInputValue(value) {\n    if (!value) {\n      this.inputView.queryView.fieldView.reset();\n    } else {\n      this.inputView.queryView.fieldView.value = value;\n    }\n  }\n  /**\n  * Returns an input provided by a user in the search text field.\n  */\n  getInputValue() {\n    return this.inputView.queryView.fieldView.element.value;\n  }\n  /**\n  * @inheritDoc\n  */\n  focus() {\n    this.inputView.focus();\n  }\n}\n\n/**\n * A view responsible for selecting a skin tone for an emoji.\n */\nclass EmojiToneView extends View {\n  /**\n  * A dropdown element for selecting an active skin tone.\n  */\n  dropdownView;\n  /**\n  * An array of available skin tones.\n  */\n  _skinTones;\n  /**\n  * @inheritDoc\n  */\n  constructor(locale, {\n    skinTone,\n    skinTones\n  }) {\n    super(locale);\n    this.set('skinTone', skinTone);\n    this._skinTones = skinTones;\n    const t = locale.t;\n    const accessibleLabel = t('Select skin tone');\n    const dropdownView = createDropdown(locale);\n    const itemDefinitions = new Collection();\n    for (const {\n      id,\n      icon,\n      tooltip\n    } of this._skinTones) {\n      const def = {\n        type: 'button',\n        model: new ViewModel({\n          value: id,\n          label: icon,\n          ariaLabel: tooltip,\n          tooltip,\n          tooltipPosition: 'e',\n          role: 'menuitemradio',\n          withText: true,\n          // To improve accessibility, disconnect a button and its label connection so that screen\n          // readers can read the `[aria-label]` attribute directly from the more descriptive button.\n          ariaLabelledBy: undefined\n        })\n      };\n      def.model.bind('isOn').to(this, 'skinTone', value => value === id);\n      itemDefinitions.add(def);\n    }\n    addListToDropdown(dropdownView, itemDefinitions, {\n      ariaLabel: accessibleLabel,\n      role: 'menu'\n    });\n    dropdownView.buttonView.set({\n      label: this._getSkinTone().icon,\n      ariaLabel: accessibleLabel,\n      ariaLabelledBy: undefined,\n      isOn: false,\n      withText: true,\n      tooltip: accessibleLabel\n    });\n    this.dropdownView = dropdownView;\n    // Execute command when an item from the dropdown is selected.\n    this.listenTo(dropdownView, 'execute', evt => {\n      this.skinTone = evt.source.value;\n    });\n    dropdownView.buttonView.bind('label').to(this, 'skinTone', () => {\n      return this._getSkinTone().icon;\n    });\n    dropdownView.buttonView.bind('ariaLabel').to(this, 'skinTone', () => {\n      // Render a current state, but also what the dropdown does.\n      return `${this._getSkinTone().tooltip}, ${accessibleLabel}`;\n    });\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-emoji__skin-tone']\n      },\n      children: [dropdownView]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  focus() {\n    this.dropdownView.buttonView.focus();\n  }\n  /**\n  * Helper method for receiving an object describing the active skin tone.\n  */\n  _getSkinTone() {\n    return this._skinTones.find(tone => tone.id === this.skinTone);\n  }\n}\n\n/**\n * A view that glues pieces of the emoji panel together.\n */\nclass EmojiPickerView extends View {\n  /**\n  * A collection of the focusable children of the view.\n  */\n  items;\n  /**\n  * Tracks information about the DOM focus in the view.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * Helps cycling over focusable {@link #items} in the view.\n  */\n  focusCycler;\n  /**\n  * An instance of the `EmojiSearchView`.\n  */\n  searchView;\n  /**\n  * An instance of the `EmojiToneView`.\n  */\n  toneView;\n  /**\n  * An instance of the `EmojiCategoriesView`.\n  */\n  categoriesView;\n  /**\n  * An instance of the `EmojiGridView`.\n  */\n  gridView;\n  /**\n  * An instance of the `EmojiGridView`.\n  */\n  infoView;\n  /**\n  * @inheritDoc\n  */\n  constructor(locale, {\n    emojiCategories,\n    getEmojiByQuery,\n    skinTone,\n    skinTones\n  }) {\n    super(locale);\n    const categoryName = emojiCategories[0].title;\n    this.gridView = new EmojiGridView(locale, {\n      categoryName,\n      emojiCategories,\n      getEmojiByQuery,\n      skinTone\n    });\n    this.infoView = new SearchInfoView();\n    this.searchView = new EmojiSearchView(locale, {\n      gridView: this.gridView,\n      resultsView: this.infoView\n    });\n    this.categoriesView = new EmojiCategoriesView(locale, {\n      emojiCategories,\n      categoryName\n    });\n    this.toneView = new EmojiToneView(locale, {\n      skinTone,\n      skinTones\n    });\n    this.items = this.createCollection([this.searchView, this.toneView, this.categoriesView, this.gridView, this.infoView]);\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this.focusCycler = new FocusCycler({\n      focusables: this.items,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        focusPrevious: 'shift + tab',\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'div',\n      children: [{\n        tag: 'div',\n        children: [this.searchView, this.toneView],\n        attributes: {\n          class: ['ck', 'ck-emoji__search']\n        }\n      }, this.categoriesView, this.gridView, {\n        tag: 'div',\n        children: [this.infoView],\n        attributes: {\n          class: ['ck', 'ck-search__results']\n        }\n      }],\n      attributes: {\n        tabindex: '-1',\n        class: ['ck', 'ck-emoji', 'ck-search']\n      }\n    });\n    this._setupEventListeners();\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.focusTracker.add(this.searchView.element);\n    this.focusTracker.add(this.toneView.element);\n    this.focusTracker.add(this.categoriesView.element);\n    this.focusTracker.add(this.gridView.element);\n    this.focusTracker.add(this.infoView.element);\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the search input.\n  */\n  focus() {\n    this.searchView.focus();\n  }\n  /**\n  * Initializes interactions between sub-views.\n  */\n  _setupEventListeners() {\n    const t = this.locale.t;\n    // Disable the category switcher when filtering by a query.\n    this.searchView.on('search', (evt, data) => {\n      if (data.query) {\n        this.categoriesView.disableCategories();\n      } else {\n        this.categoriesView.enableCategories();\n      }\n    });\n    // Show a user-friendly message depending on the search query.\n    this.searchView.on('search', (evt, data) => {\n      if (data.query.length === 1) {\n        this.infoView.set({\n          primaryText: t('Keep on typing to see the emoji.'),\n          secondaryText: t('The query must contain at least two characters.'),\n          isVisible: true\n        });\n      } else if (!data.resultsCount) {\n        this.infoView.set({\n          primaryText: t('No emojis were found matching \"%0\".', data.query),\n          secondaryText: t('Please try a different phrase or check the spelling.'),\n          isVisible: true\n        });\n      } else {\n        this.infoView.set({\n          isVisible: false\n        });\n      }\n    });\n    // Emit an update event to react to balloon dimensions changes.\n    this.searchView.on('search', () => {\n      this.fire('update');\n      this.gridView.element.scrollTo(0, 0);\n    });\n    // Update the grid of emojis when the selected category is changed.\n    this.categoriesView.on('change:categoryName', (ev, args, categoryName) => {\n      this.gridView.categoryName = categoryName;\n      this.searchView.search('');\n    });\n    // Update the grid of emojis when the selected skin tone is changed.\n    // In such a case, the displayed emoji should use an updated skin tone value.\n    this.toneView.on('change:skinTone', (evt, propertyName, newValue) => {\n      this.gridView.skinTone = newValue;\n      this.searchView.search(this.searchView.getInputValue());\n    });\n  }\n}\n\n/**\n * The emoji picker form view.\n */\nclass EmojiPickerFormView extends View {\n  /**\n  * The Back button view displayed in the header.\n  */\n  backButtonView;\n  /**\n  * Tracks information about DOM focus in the form.\n  */\n  focusTracker = new FocusTracker();\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes = new KeystrokeHandler();\n  /**\n  * A collection of child views.\n  */\n  children;\n  /**\n  * A collection of views that can be focused in the form.\n  */\n  _focusables = new ViewCollection();\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * Creates an instance of the {@link module:emoji/ui/emojipickerformview~EmojiPickerFormView} class.\n  *\n  * Also see {@link #render}.\n  *\n  * @param locale The localization services instance.\n  */\n  constructor(locale) {\n    super(locale);\n    this.backButtonView = this._createBackButton();\n    this.children = this.createCollection([this._createHeaderView()]);\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backward using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-form', 'ck-emoji-picker-form', 'ck-responsive-form'],\n        // https://github.com/ckeditor/ckeditor5-link/issues/90\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    const childViews = [...this.children.filter(isFocusable), this.backButtonView];\n    childViews.forEach(v => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n      // Register the view in the focus cycler to avoid nested focus cycles traps.\n      if (isViewWithFocusCycler(v)) {\n        this._focusCycler.chain(v.focusCycler);\n      }\n    });\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the fist {@link #_focusables} in the form.\n  */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n  /**\n  * Creates a back button view that cancels the form.\n  */\n  _createBackButton() {\n    const t = this.locale.t;\n    const backButton = new ButtonView(this.locale);\n    backButton.set({\n      class: 'ck-button-back',\n      label: t('Back'),\n      icon: IconPreviousArrow,\n      tooltip: true\n    });\n    backButton.delegate('execute').to(this, 'cancel');\n    return backButton;\n  }\n  /**\n  * Creates a header view for the form.\n  */\n  _createHeaderView() {\n    const t = this.locale.t;\n    const header = new FormHeaderView(this.locale, {\n      label: t('Emoji picker')\n    });\n    header.children.add(this.backButtonView, 0);\n    return header;\n  }\n}\nconst VISUAL_SELECTION_MARKER_NAME = 'emoji-picker';\n/**\n * The emoji picker plugin.\n *\n * Introduces the `'emoji'` dropdown.\n */\nclass EmojiPicker extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [EmojiRepository, ContextualBalloon, Dialog, Typing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'EmojiPicker';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  async init() {\n    const editor = this.editor;\n    this.balloonPlugin = editor.plugins.get('ContextualBalloon');\n    this.emojiRepositoryPlugin = editor.plugins.get('EmojiRepository');\n    // Skip registering a button in the toolbar and list item in the menu bar if the emoji repository is not ready.\n    if (!(await this.emojiRepositoryPlugin.isReady())) {\n      return;\n    }\n    const command = new EmojiCommand(editor);\n    editor.commands.add('emoji', command);\n    editor.ui.componentFactory.add('emoji', () => {\n      const button = this._createButton(ButtonView, command);\n      button.set({\n        tooltip: true\n      });\n      return button;\n    });\n    editor.ui.componentFactory.add('menuBar:emoji', () => {\n      return this._createButton(MenuBarMenuListItemButtonView, command);\n    });\n    this._setupConversion();\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    if (this.emojiPickerView) {\n      this.emojiPickerView.destroy();\n    }\n  }\n  /**\n  * Represents an active skin tone. Its value depends on the emoji UI plugin.\n  *\n  * Before opening the UI for the first time, the returned value is read from the editor configuration.\n  * Otherwise, it reflects the user's intention.\n  */\n  get skinTone() {\n    if (!this.emojiPickerView) {\n      return this.editor.config.get('emoji.skinTone');\n    }\n    return this.emojiPickerView.gridView.skinTone;\n  }\n  /**\n  * Displays the balloon with the emoji picker.\n  *\n  * @param [searchValue=''] A default query used to filer the grid when opening the UI.\n  */\n  showUI(searchValue = '') {\n    // Show visual selection on a text when the contextual balloon is displayed.\n    // See #17654.\n    this._showFakeVisualSelection();\n    if (!this.emojiPickerView) {\n      this.emojiPickerView = this._createEmojiPickerView();\n    }\n    if (searchValue) {\n      this.emojiPickerView.searchView.setInputValue(searchValue);\n    }\n    this.emojiPickerView.searchView.search(searchValue);\n    if (!this.emojiPickerFormView) {\n      this.emojiPickerFormView = this._createEmojiPickerFormView();\n    }\n    if (!this.balloonPlugin.hasView(this.emojiPickerFormView)) {\n      // Show back button if there is another balloon view visible.\n      this.emojiPickerFormView.backButtonView.isVisible = !!this.balloonPlugin.visibleView;\n      this.balloonPlugin.add({\n        view: this.emojiPickerFormView,\n        position: this._getBalloonPositionData(),\n        balloonClassName: 'ck-emoji-picker-balloon'\n      });\n    }\n    this.emojiPickerView.focus();\n  }\n  /**\n  * Creates a button for toolbar and menu bar that will show the emoji dialog.\n  */\n  _createButton(ViewClass, command) {\n    const buttonView = new ViewClass(this.editor.locale);\n    const t = this.editor.locale.t;\n    buttonView.bind('isEnabled').to(command, 'isEnabled');\n    buttonView.set({\n      label: t('Emoji'),\n      icon: IconEmoji,\n      isToggleable: true\n    });\n    buttonView.on('execute', () => {\n      this.editor.editing.view.scrollToTheSelection();\n      this.showUI();\n    });\n    return buttonView;\n  }\n  /**\n  * Creates an instance of the `EmojiPickerView` class that represents an emoji balloon.\n  */\n  _createEmojiPickerView() {\n    const emojiPickerView = new EmojiPickerView(this.editor.locale, {\n      emojiCategories: this.emojiRepositoryPlugin.getEmojiCategories(),\n      skinTone: this.editor.config.get('emoji.skinTone'),\n      skinTones: this.emojiRepositoryPlugin.getSkinTones(),\n      getEmojiByQuery: query => {\n        return this.emojiRepositoryPlugin.getEmojiByQuery(query);\n      }\n    });\n    // Insert an emoji on a tile click.\n    this.listenTo(emojiPickerView.gridView, 'execute', (evt, data) => {\n      const editor = this.editor;\n      const textToInsert = data.emoji;\n      this._hideUI();\n      editor.execute('insertText', {\n        text: textToInsert\n      });\n    });\n    return emojiPickerView;\n  }\n  /**\n  * Creates an instance of the `EmojiPickerFormView` class that represents a balloon with the emoji picker.\n  */\n  _createEmojiPickerFormView() {\n    const emojiPickerFormView = new EmojiPickerFormView(this.editor.locale);\n    emojiPickerFormView.children.add(this.emojiPickerView);\n    // Update the balloon position when layout is changed.\n    this.listenTo(this.emojiPickerView, 'update', () => {\n      if (this.balloonPlugin.visibleView === emojiPickerFormView) {\n        this.balloonPlugin.updatePosition();\n      }\n    });\n    // Close the dialog when the back button is clicked.\n    this.listenTo(emojiPickerFormView, 'cancel', () => {\n      this._hideUI();\n    });\n    // Close the panel on `Esc` key press when the **actions have focus**.\n    emojiPickerFormView.keystrokes.set('Esc', (data, cancel) => {\n      this._hideUI();\n      cancel();\n    });\n    // Close the dialog when clicking outside of it.\n    clickOutsideHandler({\n      emitter: emojiPickerFormView,\n      contextElements: [this.balloonPlugin.view.element],\n      callback: () => {\n        // Focusing on the editable during a click outside the balloon panel might\n        // cause the selection to move to the beginning of the editable, so we avoid\n        // focusing on it during this action.\n        // See: https://github.com/ckeditor/ckeditor5/issues/18253\n        this._hideUI(false);\n      },\n      activator: () => this.balloonPlugin.visibleView === emojiPickerFormView\n    });\n    return emojiPickerFormView;\n  }\n  /**\n  * Hides the balloon with the emoji picker.\n  *\n  * @param updateFocus Whether to focus the editor after closing the emoji picker.\n  */\n  _hideUI(updateFocus = true) {\n    this.balloonPlugin.remove(this.emojiPickerFormView);\n    this.emojiPickerView.searchView.setInputValue('');\n    if (updateFocus) {\n      this.editor.editing.view.focus();\n    }\n    this._hideFakeVisualSelection();\n  }\n  /**\n  * Registers converters.\n  */\n  _setupConversion() {\n    const editor = this.editor;\n    // Renders a fake visual selection marker on an expanded selection.\n    editor.conversion.for('editingDowncast').markerToHighlight({\n      model: VISUAL_SELECTION_MARKER_NAME,\n      view: {\n        classes: ['ck-fake-emoji-selection']\n      }\n    });\n    // Renders a fake visual selection marker on a collapsed selection.\n    editor.conversion.for('editingDowncast').markerToElement({\n      model: VISUAL_SELECTION_MARKER_NAME,\n      view: (data, {\n        writer\n      }) => {\n        if (!data.markerRange.isCollapsed) {\n          return null;\n        }\n        const markerElement = writer.createUIElement('span');\n        writer.addClass(['ck-fake-emoji-selection', 'ck-fake-emoji-selection_collapsed'], markerElement);\n        return markerElement;\n      }\n    });\n  }\n  /**\n  * Returns positioning options for the {@link #balloonPlugin}. They control the way the balloon is attached\n  * to the target element or selection.\n  */\n  _getBalloonPositionData() {\n    const view = this.editor.editing.view;\n    const viewDocument = view.document;\n    // Set a target position by converting view selection range to DOM.\n    const target = () => view.domConverter.viewRangeToDom(viewDocument.selection.getFirstRange());\n    return {\n      target\n    };\n  }\n  /**\n  * Displays a fake visual selection when the contextual balloon is displayed.\n  *\n  * This adds an 'emoji-picker' marker into the document that is rendered as a highlight on selected text fragment.\n  */\n  _showFakeVisualSelection() {\n    const model = this.editor.model;\n    model.change(writer => {\n      const range = model.document.selection.getFirstRange();\n      if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n        writer.updateMarker(VISUAL_SELECTION_MARKER_NAME, {\n          range\n        });\n      } else {\n        if (range.start.isAtEnd) {\n          const startPosition = range.start.getLastMatchingPosition(({\n            item\n          }) => !model.schema.isContent(item), {\n            boundaries: range\n          });\n          writer.addMarker(VISUAL_SELECTION_MARKER_NAME, {\n            usingOperation: false,\n            affectsData: false,\n            range: writer.createRange(startPosition, range.end)\n          });\n        } else {\n          writer.addMarker(VISUAL_SELECTION_MARKER_NAME, {\n            usingOperation: false,\n            affectsData: false,\n            range\n          });\n        }\n      }\n    });\n  }\n  /**\n  * Hides the fake visual selection.\n  */\n  _hideFakeVisualSelection() {\n    const model = this.editor.model;\n    if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n      model.change(writer => {\n        writer.removeMarker(VISUAL_SELECTION_MARKER_NAME);\n      });\n    }\n  }\n}\n\n/**\n * The emoji plugin.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:emoji/emojimention~EmojiMention},\n * * {@link module:emoji/emojipicker~EmojiPicker},\n */\nclass Emoji extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [EmojiMention, EmojiPicker];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Emoji';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { Emoji, EmojiCommand, EmojiMention, EmojiPicker, EmojiRepository, EmojiUtils };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Clipboard } from '@ckeditor/ckeditor5-clipboard/dist/index.js';\nimport { Enter, ShiftEnter } from '@ckeditor/ckeditor5-enter/dist/index.js';\nimport { SelectAll } from '@ckeditor/ckeditor5-select-all/dist/index.js';\nimport { Typing } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { Undo } from '@ckeditor/ckeditor5-undo/dist/index.js';\nimport { AccessibilityHelp } from '@ckeditor/ckeditor5-ui/dist/index.js';\n\n/**\n * A plugin including all essential editing features. It represents a set of features that enables similar functionalities\n * to a `<textarea>` element.\n *\n * It includes:\n *\n * * {@link module:ui/editorui/accessibilityhelp/accessibilityhelp~AccessibilityHelp},\n * * {@link module:clipboard/clipboard~Clipboard},\n * * {@link module:enter/enter~Enter},\n * * {@link module:select-all/selectall~SelectAll},\n * * {@link module:enter/shiftenter~ShiftEnter},\n * * {@link module:typing/typing~Typing},\n * * {@link module:undo/undo~Undo}.\n *\n * This plugin set does not define any block-level containers (such as {@link module:paragraph/paragraph~Paragraph}).\n * If your editor is supposed to handle block content, make sure to include it.\n */\nclass Essentials extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [AccessibilityHelp, Clipboard, Enter, SelectAll, ShiftEnter, Typing, Undo];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Essentials';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { Essentials };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, Command } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { IconPreviousArrow, IconFindReplace } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { View, ViewCollection, FocusCycler, submitHandler, CollapsibleView, SwitchButtonView, ButtonView, LabeledFieldView, createLabeledInputText, Dialog, DropdownView, createDropdown, FormHeaderView, MenuBarMenuListItemButtonView, DialogViewPosition, CssTransitionDisablerMixin } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { FocusTracker, KeystrokeHandler, isVisible, Rect, ObservableMixin, Collection, uid, scrollViewportToShowTarget } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { escapeRegExp, debounce } from 'es-toolkit/compat';\n\n/**\n * The find and replace form view class.\n *\n * See {@link module:find-and-replace/ui/findandreplaceformview~FindAndReplaceFormView}.\n */\nclass FindAndReplaceFormView extends View {\n  /**\n  * A collection of child views.\n  */\n  children;\n  /**\n  * The find in text input view that stores the searched string.\n  *\n  * @internal\n  */\n  _findInputView;\n  /**\n  * The replace input view.\n  */\n  _replaceInputView;\n  /**\n  * The find button view that initializes the search process.\n  */\n  _findButtonView;\n  /**\n  * The find previous button view.\n  */\n  _findPrevButtonView;\n  /**\n  * The find next button view.\n  */\n  _findNextButtonView;\n  /**\n  * A collapsible view aggregating the advanced search options.\n  */\n  _advancedOptionsCollapsibleView;\n  /**\n  * A switch button view controlling the \"Match case\" option.\n  */\n  _matchCaseSwitchView;\n  /**\n  * A switch button view controlling the \"Whole words only\" option.\n  */\n  _wholeWordsOnlySwitchView;\n  /**\n  * The replace button view.\n  */\n  _replaceButtonView;\n  /**\n  * The replace all button view.\n  */\n  _replaceAllButtonView;\n  /**\n  * The `div` aggregating the inputs.\n  */\n  _inputsDivView;\n  /**\n  * The `div` aggregating the action buttons.\n  */\n  _actionButtonsDivView;\n  /**\n  * Tracks information about the DOM focus in the form.\n  */\n  _focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  _keystrokes;\n  /**\n  * A collection of views that can be focused in the form.\n  */\n  _focusables;\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  focusCycler;\n  /**\n  * Creates a view of find and replace form.\n  *\n  * @param locale The localization services instance.\n  */\n  constructor(locale) {\n    super(locale);\n    const t = locale.t;\n    this.children = this.createCollection();\n    this.set('matchCount', 0);\n    this.set('highlightOffset', 0);\n    this.set('isDirty', false);\n    this.set('_areCommandsEnabled', {});\n    this.set('_resultsCounterText', '');\n    this.set('_matchCase', false);\n    this.set('_wholeWordsOnly', false);\n    this.bind('_searchResultsFound').to(this, 'matchCount', this, 'isDirty', (matchCount, isDirty) => {\n      return matchCount > 0 && !isDirty;\n    });\n    this._findInputView = this._createInputField(t('Find in textâ€¦'));\n    this._findPrevButtonView = this._createButton({\n      label: t('Previous result'),\n      class: 'ck-button-prev',\n      icon: IconPreviousArrow,\n      keystroke: 'Shift+F3',\n      tooltip: true\n    });\n    this._findNextButtonView = this._createButton({\n      label: t('Next result'),\n      class: 'ck-button-next',\n      icon: IconPreviousArrow,\n      keystroke: 'F3',\n      tooltip: true\n    });\n    this._replaceInputView = this._createInputField(t('Replace withâ€¦'), 'ck-labeled-field-replace');\n    this._inputsDivView = this._createInputsDiv();\n    this._matchCaseSwitchView = this._createMatchCaseSwitch();\n    this._wholeWordsOnlySwitchView = this._createWholeWordsOnlySwitch();\n    this._advancedOptionsCollapsibleView = this._createAdvancedOptionsCollapsible();\n    this._replaceAllButtonView = this._createButton({\n      label: t('Replace all'),\n      class: 'ck-button-replaceall',\n      withText: true\n    });\n    this._replaceButtonView = this._createButton({\n      label: t('Replace'),\n      class: 'ck-button-replace',\n      withText: true\n    });\n    this._findButtonView = this._createButton({\n      label: t('Find'),\n      class: 'ck-button-find ck-button-action',\n      withText: true\n    });\n    this._actionButtonsDivView = this._createActionButtonsDiv();\n    this._focusTracker = new FocusTracker();\n    this._keystrokes = new KeystrokeHandler();\n    this._focusables = new ViewCollection();\n    this.focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this._focusTracker,\n      keystrokeHandler: this._keystrokes,\n      actions: {\n        // Navigate form fields backwards using the <kbd>Shift</kbd> + <kbd>Tab</kbd> keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the <kbd>Tab</kbd> key.\n        focusNext: 'tab'\n      }\n    });\n    this.children.addMany([this._inputsDivView, this._advancedOptionsCollapsibleView, this._actionButtonsDivView]);\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-find-and-replace-form'],\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    submitHandler({\n      view: this\n    });\n    this._initFocusCycling();\n    this._initKeystrokeHandling();\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this._focusTracker.destroy();\n    this._keystrokes.destroy();\n  }\n  /**\n  * @inheritDoc\n  */\n  focus(direction) {\n    if (direction === -1) {\n      this.focusCycler.focusLast();\n    } else {\n      this.focusCycler.focusFirst();\n    }\n  }\n  /**\n  * Resets the form before re-appearing.\n  *\n  * It clears error messages, hides the match counter and disables the replace feature\n  * until the next hit of the \"Find\" button.\n  *\n  * **Note**: It does not reset inputs and options, though. This way the form works better in editors with\n  * disappearing toolbar (e.g. BalloonEditor): hiding the toolbar by accident (together with the find and replace UI)\n  * does not require filling the entire form again.\n  */\n  reset() {\n    this._findInputView.errorText = null;\n    this.isDirty = true;\n  }\n  /**\n  * Returns the value of the find input.\n  */\n  get _textToFind() {\n    return this._findInputView.fieldView.element.value;\n  }\n  /**\n  * Returns the value of the replace input.\n  */\n  get _textToReplace() {\n    return this._replaceInputView.fieldView.element.value;\n  }\n  /**\n  * Configures and returns the `<div>` aggregating all form inputs.\n  */\n  _createInputsDiv() {\n    const locale = this.locale;\n    const t = locale.t;\n    const inputsDivView = new View(locale);\n    // Typing in the find field invalidates all previous results (the form is \"dirty\").\n    this._findInputView.fieldView.on('input', () => {\n      this.isDirty = true;\n    });\n    // Pressing prev/next buttons fires related event on the form.\n    this._findPrevButtonView.delegate('execute').to(this, 'findPrevious');\n    this._findNextButtonView.delegate('execute').to(this, 'findNext');\n    // Prev/next buttons will be disabled when related editor command gets disabled.\n    this._findPrevButtonView.bind('isEnabled').to(this, '_areCommandsEnabled', ({\n      findPrevious\n    }) => findPrevious);\n    this._findNextButtonView.bind('isEnabled').to(this, '_areCommandsEnabled', ({\n      findNext\n    }) => findNext);\n    this._injectFindResultsCounter();\n    this._replaceInputView.bind('isEnabled').to(this, '_areCommandsEnabled', this, '_searchResultsFound', ({\n      replace\n    }, resultsFound) => replace && resultsFound);\n    this._replaceInputView.bind('infoText').to(this._replaceInputView, 'isEnabled', this._replaceInputView, 'isFocused', (isEnabled, isFocused) => {\n      if (isEnabled || !isFocused) {\n        return '';\n      }\n      return t('Tip: Find some text first in order to replace it.');\n    });\n    inputsDivView.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-find-and-replace-form__inputs']\n      },\n      children: [this._findInputView, this._findPrevButtonView, this._findNextButtonView, this._replaceInputView]\n    });\n    return inputsDivView;\n  }\n  /**\n  * The action performed when the {@link #_findButtonView} is pressed.\n  */\n  _onFindButtonExecute() {\n    // When hitting \"Find\" in an empty input, an error should be displayed.\n    // Also, if the form was \"dirty\", it should remain so.\n    if (!this._textToFind) {\n      const t = this.t;\n      this._findInputView.errorText = t('Text to find must not be empty.');\n      return;\n    }\n    // Hitting \"Find\" automatically clears the dirty state.\n    this.isDirty = false;\n    this.fire('findNext', {\n      searchText: this._textToFind,\n      matchCase: this._matchCase,\n      wholeWords: this._wholeWordsOnly\n    });\n  }\n  /**\n  * Configures an injects the find results counter displaying a \"N of M\" label of the {@link #_findInputView}.\n  */\n  _injectFindResultsCounter() {\n    const locale = this.locale;\n    const t = locale.t;\n    const bind = this.bindTemplate;\n    const resultsCounterView = new View(this.locale);\n    this.bind('_resultsCounterText').to(this, 'highlightOffset', this, 'matchCount', (highlightOffset, matchCount) => t('%0 of %1', [highlightOffset, matchCount]));\n    resultsCounterView.setTemplate({\n      tag: 'span',\n      attributes: {\n        class: ['ck', 'ck-results-counter',\n        // The counter only makes sense when the field text corresponds to search results in the editing.\n        bind.if('isDirty', 'ck-hidden')]\n      },\n      children: [{\n        text: bind.to('_resultsCounterText')\n      }]\n    });\n    // The whole idea is that when the text of the counter changes, its width also increases/decreases and\n    // it consumes more or less space over the input. The input, on the other hand, should adjust it's right\n    // padding so its *entire* text always remains visible and available to the user.\n    const updateFindInputPadding = () => {\n      const inputElement = this._findInputView.fieldView.element;\n      // Don't adjust the padding if the input (also: counter) were not rendered or not inserted into DOM yet.\n      if (!inputElement || !isVisible(inputElement)) {\n        return;\n      }\n      const counterWidth = new Rect(resultsCounterView.element).width;\n      const paddingPropertyName = locale.uiLanguageDirection === 'ltr' ? 'paddingRight' : 'paddingLeft';\n      if (!counterWidth) {\n        inputElement.style[paddingPropertyName] = '';\n      } else {\n        inputElement.style[paddingPropertyName] = `calc( 2 * var(--ck-spacing-standard) + ${counterWidth}px )`;\n      }\n    };\n    // Adjust the input padding when the text of the counter changes, for instance \"1 of 200\" is narrower than \"123 of 200\".\n    // Using \"low\" priority to let the text be set by the template binding first.\n    this.on('change:_resultsCounterText', updateFindInputPadding, {\n      priority: 'low'\n    });\n    // Adjust the input padding when the counter shows or hides. When hidden, there should be no padding. When it shows, the\n    // padding should be set according to the text of the counter.\n    // Using \"low\" priority to let the text be set by the template binding first.\n    this.on('change:isDirty', updateFindInputPadding, {\n      priority: 'low'\n    });\n    // Put the counter element next to the <input> in the find field.\n    this._findInputView.template.children[0].children.push(resultsCounterView);\n  }\n  /**\n  * Creates the collapsible view aggregating the advanced search options.\n  */\n  _createAdvancedOptionsCollapsible() {\n    const t = this.locale.t;\n    const collapsible = new CollapsibleView(this.locale, [this._matchCaseSwitchView, this._wholeWordsOnlySwitchView]);\n    collapsible.set({\n      label: t('Advanced options'),\n      isCollapsed: true\n    });\n    return collapsible;\n  }\n  /**\n  * Configures and returns the `<div>` element aggregating all form action buttons.\n  */\n  _createActionButtonsDiv() {\n    const actionsDivView = new View(this.locale);\n    this._replaceButtonView.bind('isEnabled').to(this, '_areCommandsEnabled', this, '_searchResultsFound', ({\n      replace\n    }, resultsFound) => replace && resultsFound);\n    this._replaceAllButtonView.bind('isEnabled').to(this, '_areCommandsEnabled', this, '_searchResultsFound', ({\n      replaceAll\n    }, resultsFound) => replaceAll && resultsFound);\n    this._replaceButtonView.on('execute', () => {\n      this.fire('replace', {\n        searchText: this._textToFind,\n        replaceText: this._textToReplace\n      });\n    });\n    this._replaceAllButtonView.on('execute', () => {\n      this.fire('replaceAll', {\n        searchText: this._textToFind,\n        replaceText: this._textToReplace\n      });\n      this.focus();\n    });\n    this._findButtonView.on('execute', this._onFindButtonExecute.bind(this));\n    actionsDivView.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-find-and-replace-form__actions']\n      },\n      children: [this._replaceAllButtonView, this._replaceButtonView, this._findButtonView]\n    });\n    return actionsDivView;\n  }\n  /**\n  * Creates, configures and returns and instance of a dropdown allowing users to narrow\n  * the search criteria down. The dropdown has a list with switch buttons for each option.\n  */\n  _createMatchCaseSwitch() {\n    const t = this.locale.t;\n    const matchCaseSwitchButton = new SwitchButtonView(this.locale);\n    matchCaseSwitchButton.set({\n      label: t('Match case'),\n      withText: true\n    });\n    // Let the switch be controlled by form's observable property.\n    matchCaseSwitchButton.bind('isOn').to(this, '_matchCase');\n    // // Update the state of the form when a switch is toggled.\n    matchCaseSwitchButton.on('execute', () => {\n      this._matchCase = !this._matchCase;\n      // Toggling a switch makes the form dirty because this changes search criteria\n      // just like typing text of the find input.\n      this.isDirty = true;\n    });\n    return matchCaseSwitchButton;\n  }\n  /**\n  * Creates, configures and returns and instance of a dropdown allowing users to narrow\n  * the search criteria down. The dropdown has a list with switch buttons for each option.\n  */\n  _createWholeWordsOnlySwitch() {\n    const t = this.locale.t;\n    const wholeWordsOnlySwitchButton = new SwitchButtonView(this.locale);\n    wholeWordsOnlySwitchButton.set({\n      label: t('Whole words only'),\n      withText: true\n    });\n    // Let the switch be controlled by form's observable property.\n    wholeWordsOnlySwitchButton.bind('isOn').to(this, '_wholeWordsOnly');\n    // // Update the state of the form when a switch is toggled.\n    wholeWordsOnlySwitchButton.on('execute', () => {\n      this._wholeWordsOnly = !this._wholeWordsOnly;\n      // Toggling a switch makes the form dirty because this changes search criteria\n      // just like typing text of the find input.\n      this.isDirty = true;\n    });\n    return wholeWordsOnlySwitchButton;\n  }\n  /**\n  * Initializes the {@link #_focusables} and {@link #_focusTracker} to allow navigation\n  * using <kbd>Tab</kbd> and <kbd>Shift</kbd>+<kbd>Tab</kbd> keystrokes in the right order.\n  */\n  _initFocusCycling() {\n    const childViews = [this._findInputView, this._findPrevButtonView, this._findNextButtonView, this._replaceInputView, this._advancedOptionsCollapsibleView.buttonView, this._matchCaseSwitchView, this._wholeWordsOnlySwitchView, this._replaceAllButtonView, this._replaceButtonView, this._findButtonView];\n    childViews.forEach(v => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n      // Register the view in the focus tracker.\n      this._focusTracker.add(v.element);\n    });\n  }\n  /**\n  * Initializes the keystroke handling in the form.\n  */\n  _initKeystrokeHandling() {\n    const stopPropagation = data => data.stopPropagation();\n    const stopPropagationAndPreventDefault = data => {\n      data.stopPropagation();\n      data.preventDefault();\n    };\n    // Start listening for the keystrokes coming from #element.\n    this._keystrokes.listenTo(this.element);\n    // Find the next result upon F3.\n    this._keystrokes.set('f3', event => {\n      stopPropagationAndPreventDefault(event);\n      this._findNextButtonView.fire('execute');\n    });\n    // Find the previous result upon F3.\n    this._keystrokes.set('shift+f3', event => {\n      stopPropagationAndPreventDefault(event);\n      this._findPrevButtonView.fire('execute');\n    });\n    // Find or replace upon pressing Enter in the find and replace fields.\n    this._keystrokes.set('enter', event => {\n      const target = event.target;\n      if (target === this._findInputView.fieldView.element) {\n        if (this._areCommandsEnabled.findNext) {\n          this._findNextButtonView.fire('execute');\n        } else {\n          this._findButtonView.fire('execute');\n        }\n        stopPropagationAndPreventDefault(event);\n      } else if (target === this._replaceInputView.fieldView.element && !this.isDirty) {\n        this._replaceButtonView.fire('execute');\n        stopPropagationAndPreventDefault(event);\n      }\n    });\n    // Find previous upon pressing Shift+Enter in the find field.\n    this._keystrokes.set('shift+enter', event => {\n      const target = event.target;\n      if (target !== this._findInputView.fieldView.element) {\n        return;\n      }\n      if (this._areCommandsEnabled.findPrevious) {\n        this._findPrevButtonView.fire('execute');\n      } else {\n        this._findButtonView.fire('execute');\n      }\n      stopPropagationAndPreventDefault(event);\n    });\n    // Since the form is in the dropdown panel which is a child of the toolbar, the toolbar's\n    // keystroke handler would take over the key management in the URL input.\n    // We need to prevent this ASAP. Otherwise, the basic caret movement using the arrow keys will be impossible.\n    this._keystrokes.set('arrowright', stopPropagation);\n    this._keystrokes.set('arrowleft', stopPropagation);\n    this._keystrokes.set('arrowup', stopPropagation);\n    this._keystrokes.set('arrowdown', stopPropagation);\n  }\n  /**\n  * Creates a button view.\n  *\n  * @param options The properties of the `ButtonView`.\n  * @returns The button view instance.\n  */\n  _createButton(options) {\n    const button = new ButtonView(this.locale);\n    button.set(options);\n    return button;\n  }\n  /**\n  * Creates a labeled input view.\n  *\n  * @param label The input label.\n  * @returns The labeled input view instance.\n  */\n  _createInputField(label, className) {\n    const labeledInput = new LabeledFieldView(this.locale, createLabeledInputText);\n    labeledInput.label = label;\n    labeledInput.class = className;\n    return labeledInput;\n  }\n}\n\n/**\n * The default find and replace UI.\n *\n * It registers the `'findAndReplace'` UI button in the editor's {@link module:ui/componentfactory~ComponentFactory component factory}.\n * that uses the {@link module:find-and-replace/findandreplace~FindAndReplace FindAndReplace} plugin API.\n */\nclass FindAndReplaceUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Dialog];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FindAndReplaceUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * A reference to the find and replace form view.\n  */\n  formView;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('findAndReplace.uiType', 'dialog');\n    this.formView = null;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const isUiUsingDropdown = editor.config.get('findAndReplace.uiType') === 'dropdown';\n    const findCommand = editor.commands.get('find');\n    const t = this.editor.t;\n    // Register the toolbar component: dropdown or button (that opens a dialog).\n    editor.ui.componentFactory.add('findAndReplace', () => {\n      let view;\n      if (isUiUsingDropdown) {\n        view = this._createDropdown();\n        // Button should be disabled when in source editing mode. See #10001.\n        view.bind('isEnabled').to(findCommand);\n      } else {\n        view = this._createDialogButtonForToolbar();\n      }\n      editor.keystrokes.set('Ctrl+F', (data, cancelEvent) => {\n        if (!findCommand.isEnabled) {\n          return;\n        }\n        if (view instanceof DropdownView) {\n          const dropdownButtonView = view.buttonView;\n          if (!dropdownButtonView.isOn) {\n            dropdownButtonView.fire('execute');\n          }\n        } else {\n          if (view.isOn) {\n            // If the dialog is open, do not close it. Instead focus it.\n            // Unfortunately we can't simply use:\n            // \tthis.formView!.focus();\n            // because it would always move focus to the first input field, which we don't want.\n            editor.plugins.get('Dialog').view.focus();\n          } else {\n            view.fire('execute');\n          }\n        }\n        cancelEvent();\n      });\n      return view;\n    });\n    if (!isUiUsingDropdown) {\n      editor.ui.componentFactory.add('menuBar:findAndReplace', () => {\n        return this._createDialogButtonForMenuBar();\n      });\n    }\n    // Add the information about the keystroke to the accessibility database.\n    editor.accessibility.addKeystrokeInfos({\n      keystrokes: [{\n        label: t('Find in the document'),\n        keystroke: 'CTRL+F'\n      }]\n    });\n  }\n  /**\n  * Creates a dropdown containing the find and replace form.\n  */\n  _createDropdown() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const dropdownView = createDropdown(editor.locale);\n    dropdownView.once('change:isOpen', () => {\n      this.formView = this._createFormView();\n      this.formView.children.add(new FormHeaderView(editor.locale, {\n        label: t('Find and replace')\n      }), 0);\n      dropdownView.panelView.children.add(this.formView);\n    });\n    // Every time a dropdown is opened, the search text field should get focused and selected for better UX.\n    // Note: Using the low priority here to make sure the following listener starts working after\n    // the default action of the drop-down is executed (i.e. the panel showed up). Otherwise,\n    // the invisible form/input cannot be focused/selected.\n    //\n    // Each time a dropdown is closed, move the focus back to the find and replace toolbar button\n    // and let the find and replace editing feature know that all search results can be invalidated\n    // and no longer should be marked in the content.\n    dropdownView.on('change:isOpen', (event, name, isOpen) => {\n      if (isOpen) {\n        this._setupFormView();\n      } else {\n        this.fire('searchReseted');\n      }\n    }, {\n      priority: 'low'\n    });\n    dropdownView.buttonView.set({\n      icon: IconFindReplace,\n      label: t('Find and replace'),\n      keystroke: 'CTRL+F',\n      tooltip: true\n    });\n    return dropdownView;\n  }\n  /**\n  * Creates a button that opens a dialog with the find and replace form.\n  */\n  _createDialogButtonForToolbar() {\n    const editor = this.editor;\n    const buttonView = this._createButton(ButtonView);\n    const dialog = editor.plugins.get('Dialog');\n    buttonView.set({\n      tooltip: true\n    });\n    // Button should be on when the find and replace dialog is opened.\n    buttonView.bind('isOn').to(dialog, 'id', id => id === 'findAndReplace');\n    // Every time a dialog is opened, the search text field should get focused and selected for better UX.\n    // Each time a dialog is closed, move the focus back to the find and replace toolbar button\n    // and let the find and replace editing feature know that all search results can be invalidated\n    // and no longer should be marked in the content.\n    buttonView.on('execute', () => {\n      if (buttonView.isOn) {\n        dialog.hide();\n      } else {\n        this._showDialog();\n      }\n    });\n    return buttonView;\n  }\n  /**\n  * Creates a button for for menu bar that will show find and replace dialog.\n  */\n  _createDialogButtonForMenuBar() {\n    const buttonView = this._createButton(MenuBarMenuListItemButtonView);\n    const dialogPlugin = this.editor.plugins.get('Dialog');\n    const dialog = this.editor.plugins.get('Dialog');\n    buttonView.set({\n      role: 'menuitemcheckbox',\n      isToggleable: true\n    });\n    // Button should be on when the find and replace dialog is opened.\n    buttonView.bind('isOn').to(dialog, 'id', id => id === 'findAndReplace');\n    buttonView.on('execute', () => {\n      if (dialogPlugin.id === 'findAndReplace') {\n        dialogPlugin.hide();\n        return;\n      }\n      this._showDialog();\n    });\n    return buttonView;\n  }\n  /**\n  * Creates a button for find and replace command to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const findCommand = editor.commands.get('find');\n    const buttonView = new ButtonClass(editor.locale);\n    const t = editor.locale.t;\n    // Button should be disabled when in source editing mode. See #10001.\n    buttonView.bind('isEnabled').to(findCommand);\n    buttonView.set({\n      icon: IconFindReplace,\n      label: t('Find and replace'),\n      keystroke: 'CTRL+F'\n    });\n    return buttonView;\n  }\n  /**\n  * Shows the find and replace dialog.\n  */\n  _showDialog() {\n    const editor = this.editor;\n    const dialog = editor.plugins.get('Dialog');\n    const t = editor.locale.t;\n    if (!this.formView) {\n      this.formView = this._createFormView();\n    }\n    dialog.show({\n      id: 'findAndReplace',\n      title: t('Find and replace'),\n      content: this.formView,\n      position: DialogViewPosition.EDITOR_TOP_SIDE,\n      onShow: () => {\n        this._setupFormView();\n      },\n      onHide: () => {\n        this.fire('searchReseted');\n      }\n    });\n  }\n  /**\n  * Sets up the form view for the find and replace.\n  *\n  * @param formView A related form view.\n  */\n  _createFormView() {\n    const editor = this.editor;\n    const formView = new (CssTransitionDisablerMixin(FindAndReplaceFormView))(editor.locale);\n    const commands = editor.commands;\n    const findAndReplaceEditing = this.editor.plugins.get('FindAndReplaceEditing');\n    const editingState = findAndReplaceEditing.state;\n    formView.bind('highlightOffset').to(editingState, 'highlightedOffset');\n    // Let the form know how many results were found in total.\n    formView.listenTo(editingState.results, 'change', () => {\n      formView.matchCount = editingState.results.length;\n    });\n    // Command states are used to enable/disable individual form controls.\n    // To keep things simple, instead of binding 4 individual observables, there's only one that combines every\n    // commands' isEnabled state. Yes, it will change more often but this simplifies the structure of the form.\n    const findNextCommand = commands.get('findNext');\n    const findPreviousCommand = commands.get('findPrevious');\n    const replaceCommand = commands.get('replace');\n    const replaceAllCommand = commands.get('replaceAll');\n    formView.bind('_areCommandsEnabled').to(findNextCommand, 'isEnabled', findPreviousCommand, 'isEnabled', replaceCommand, 'isEnabled', replaceAllCommand, 'isEnabled', (findNext, findPrevious, replace, replaceAll) => ({\n      findNext,\n      findPrevious,\n      replace,\n      replaceAll\n    }));\n    // The UI plugin works as an interface between the form and the editing part of the feature.\n    formView.delegate('findNext', 'findPrevious', 'replace', 'replaceAll').to(this);\n    // Let the feature know that search results are no longer relevant because the user changed the searched phrase\n    // (or options) but didn't hit the \"Find\" button yet (e.g. still typing).\n    formView.on('change:isDirty', (evt, data, isDirty) => {\n      if (isDirty) {\n        this.fire('searchReseted');\n      }\n    });\n    return formView;\n  }\n  /**\n  * Clears the find and replace form and focuses the search text field.\n  */\n  _setupFormView() {\n    this.formView.disableCssTransitions();\n    this.formView.reset();\n    this.formView._findInputView.fieldView.select();\n    this.formView.enableCssTransitions();\n  }\n}\n\n/**\n * The find command. It is used by the {@link module:find-and-replace/findandreplace~FindAndReplace find and replace feature}.\n */\nclass FindCommand extends Command {\n  /**\n  * The find and replace state object used for command operations.\n  */\n  _state;\n  /**\n  * Creates a new `FindCommand` instance.\n  *\n  * @param editor The editor on which this command will be used.\n  * @param state An object to hold plugin state.\n  */\n  constructor(editor, state) {\n    super(editor);\n    // The find command is always enabled.\n    this.isEnabled = true;\n    // It does not affect data so should be enabled in read-only mode.\n    this.affectsData = false;\n    this._state = state;\n  }\n  /**\n  * Executes the command.\n  *\n  * @param callbackOrText\n  * @param options Options object.\n  * @param options.matchCase If set to `true`, the letter case will be matched.\n  * @param options.wholeWords If set to `true`, only whole words that match `callbackOrText` will be matched.\n  *\n  * @fires execute\n  */\n  execute(callbackOrText, {\n    matchCase,\n    wholeWords\n  } = {}) {\n    const {\n      editor\n    } = this;\n    const {\n      model\n    } = editor;\n    const findAndReplaceUtils = editor.plugins.get('FindAndReplaceUtils');\n    let findCallback;\n    let callbackSearchText = '';\n    // Allow to execute `find()` on a plugin with a keyword only.\n    if (typeof callbackOrText === 'string') {\n      findCallback = (...args) => ({\n        results: findAndReplaceUtils.findByTextCallback(callbackOrText, {\n          matchCase,\n          wholeWords\n        })(...args),\n        searchText: callbackOrText\n      });\n    } else {\n      findCallback = callbackOrText;\n    }\n    // Wrap the callback to get the search text that will be assigned to the state.\n    const oldCallback = findCallback;\n    findCallback = (...args) => {\n      const result = oldCallback(...args);\n      if (result && 'searchText' in result) {\n        callbackSearchText = result.searchText;\n      }\n      return result;\n    };\n    // Initial search is done on all nodes in all roots inside the content.\n    const results = model.document.getRootNames().reduce((currentResults, rootName) => findAndReplaceUtils.updateFindResultFromRange(model.createRangeIn(model.document.getRoot(rootName)), model, findCallback, currentResults), null);\n    this._state.clear(model);\n    this._state.results.addMany(results);\n    this._state.highlightedResult = results.get(0);\n    this._state.searchText = callbackSearchText;\n    if (findCallback) {\n      this._state.lastSearchCallback = findCallback;\n    }\n    this._state.matchCase = !!matchCase;\n    this._state.matchWholeWords = !!wholeWords;\n    return {\n      results,\n      findCallback\n    };\n  }\n}\n\n/**\n * The object storing find and replace plugin state for a given editor instance.\n */\nclass FindAndReplaceState extends /* #__PURE__ */ObservableMixin() {\n  /**\n  * Creates an instance of the state.\n  */\n  constructor(model) {\n    super();\n    this.set('results', new Collection());\n    this.set('highlightedResult', null);\n    this.set('highlightedOffset', 0);\n    this.set('searchText', '');\n    this.set('replaceText', '');\n    this.set('lastSearchCallback', null);\n    this.set('matchCase', false);\n    this.set('matchWholeWords', false);\n    this.results.on('change', (eventInfo, {\n      removed,\n      index\n    }) => {\n      if (Array.from(removed).length) {\n        let highlightedResultRemoved = false;\n        model.change(writer => {\n          for (const removedResult of removed) {\n            if (this.highlightedResult === removedResult) {\n              highlightedResultRemoved = true;\n            }\n            if (model.markers.has(removedResult.marker.name)) {\n              writer.removeMarker(removedResult.marker);\n            }\n          }\n        });\n        if (highlightedResultRemoved) {\n          const nextHighlightedIndex = index >= this.results.length ? 0 : index;\n          this.highlightedResult = this.results.get(nextHighlightedIndex);\n        }\n      }\n    });\n    this.on('change:highlightedResult', () => {\n      this.refreshHighlightOffset(model);\n    });\n  }\n  /**\n  * Cleans the state up and removes markers from the model.\n  */\n  clear(model) {\n    this.searchText = '';\n    model.change(writer => {\n      if (this.highlightedResult) {\n        const oldMatchId = this.highlightedResult.marker.name.split(':')[1];\n        const oldMarker = model.markers.get(`findResultHighlighted:${oldMatchId}`);\n        if (oldMarker) {\n          writer.removeMarker(oldMarker);\n        }\n      }\n      [...this.results].forEach(({\n        marker\n      }) => {\n        writer.removeMarker(marker);\n      });\n    });\n    this.results.clear();\n  }\n  /**\n  * Refreshes the highlight result offset based on it's index within the result list.\n  */\n  refreshHighlightOffset(model) {\n    const {\n      highlightedResult,\n      results\n    } = this;\n    if (highlightedResult) {\n      this.highlightedOffset = sortSearchResultsByMarkerPositions(model, [...results]).indexOf(highlightedResult) + 1;\n    } else {\n      this.highlightedOffset = 0;\n    }\n  }\n}\n/**\n * Sorts search results by marker positions. Make sure that the results are sorted in the same order as they appear in the document\n * to avoid issues with the `find next` command. Apparently, the order of the results in the state might be different than the order\n * of the markers in the model.\n */\nfunction sortSearchResultsByMarkerPositions(model, results) {\n  const sortMapping = {\n    before: -1,\n    same: 0,\n    after: 1,\n    different: 1\n  };\n  // `compareWith` doesn't play well with multi-root documents, so we need to sort results by root name first\n  // and then sort them within each root. It prevents \"random\" order of results when the document has multiple roots.\n  // See more: https://github.com/ckeditor/ckeditor5/pull/17292#issuecomment-2442084549\n  return model.document.getRootNames().flatMap(rootName => results.filter(result => result.marker.getStart().root.rootName === rootName).sort((a, b) => sortMapping[a.marker.getStart().compareWith(b.marker.getStart())]));\n}\nclass ReplaceCommandBase extends Command {\n  /**\n  * The find and replace state object used for command operations.\n  */\n  _state;\n  /**\n  * Creates a new `ReplaceCommand` instance.\n  *\n  * @param editor Editor on which this command will be used.\n  * @param state An object to hold plugin state.\n  */\n  constructor(editor, state) {\n    super(editor);\n    // The replace command is always enabled.\n    this.isEnabled = true;\n    this._state = state;\n    // Since this command executes on particular result independent of selection, it should be checked directly in execute block.\n    this._isEnabledBasedOnSelection = false;\n  }\n  /**\n  * Common logic for both `replace` commands.\n  * Replace a given find result by a string or a callback.\n  *\n  * @param result A single result from the find command.\n  */\n  _replace(replacementText, result) {\n    const {\n      model\n    } = this.editor;\n    const range = result.marker.getRange();\n    // Don't replace a result that is in non-editable place.\n    if (!model.canEditAt(range)) {\n      return;\n    }\n    model.change(writer => {\n      // Don't replace a result (marker) that found its way into the $graveyard (e.g. removed by collaborators).\n      if (range.root.rootName === '$graveyard') {\n        this._state.results.remove(result);\n        return;\n      }\n      let textAttributes = {};\n      for (const item of range.getItems()) {\n        if (item.is('$text') || item.is('$textProxy')) {\n          textAttributes = item.getAttributes();\n          break;\n        }\n      }\n      model.insertContent(writer.createText(replacementText, textAttributes), range);\n      if (this._state.results.has(result)) {\n        this._state.results.remove(result);\n      }\n    });\n  }\n}\n\n/**\n * The replace command. It is used by the {@link module:find-and-replace/findandreplace~FindAndReplace find and replace feature}.\n */\nclass ReplaceCommand extends ReplaceCommandBase {\n  /**\n  * Replace a given find result by a string or a callback.\n  *\n  * @param result A single result from the find command.\n  *\n  * @fires execute\n  */\n  execute(replacementText, result) {\n    // We save highlight offset here, as the information about the highlighted result will be lost after the changes.\n    //\n    // It happens because result list is partially regenerated if the result is removed from the paragraph.\n    // Partially means that all sibling result items that are placed in the same paragraph are removed and added again,\n    // which causes the highlighted result to be malformed (usually it's set to first but it's not guaranteed).\n    //\n    // While this saving can be done in editing state, it's better to keep it here, as it's a part of the command logic\n    // and might be super tricky to implement in multi-root documents.\n    //\n    // Keep in mind that the highlighted offset is indexed from 1, as it's displayed to the user. It's why we subtract 1 here.\n    //\n    // More info: https://github.com/ckeditor/ckeditor5/issues/16648\n    const oldHighlightOffset = Math.max(this._state.highlightedOffset - 1, 0);\n    this._replace(replacementText, result);\n    // Let's revert the highlight offset to the previous value.\n    if (this._state.results.length) {\n      // Highlight offset operates on sorted array, so we need to sort the results first.\n      // It's not guaranteed that items in state results are sorted, usually they are, but it's not guaranteed when\n      // the result is removed from the paragraph with other highlighted results.\n      const sortedResults = sortSearchResultsByMarkerPositions(this.editor.model, [...this._state.results]);\n      // Just make sure that we don't overflow the results array, so use modulo.\n      this._state.highlightedResult = sortedResults[oldHighlightOffset % sortedResults.length];\n    }\n  }\n}\n\n/**\n * The replace all command. It is used by the {@link module:find-and-replace/findandreplace~FindAndReplace find and replace feature}.\n */\nclass ReplaceAllCommand extends ReplaceCommandBase {\n  /**\n  * Replaces all the occurrences of `textToReplace` with a given `newText` string.\n  *\n  * ```ts\n  *\treplaceAllCommand.execute( 'replaceAll', 'new text replacement', 'text to replace' );\n  * ```\n  *\n  * Alternatively you can call it from editor instance:\n  *\n  * ```ts\n  *\teditor.execute( 'replaceAll', 'new text', 'old text' );\n  * ```\n  *\n  * @param newText Text that will be inserted to the editor for each match.\n  * @param textToReplace Text to be replaced or a collection of matches\n  * as returned by the find command.\n  *\n  * @fires module:core/command~Command#event:execute\n  */\n  execute(newText, textToReplace) {\n    const {\n      editor\n    } = this;\n    const {\n      model\n    } = editor;\n    const findAndReplaceUtils = editor.plugins.get('FindAndReplaceUtils');\n    const results = textToReplace instanceof Collection ? textToReplace : model.document.getRootNames().reduce((currentResults, rootName) => findAndReplaceUtils.updateFindResultFromRange(model.createRangeIn(model.document.getRoot(rootName)), model, findAndReplaceUtils.findByTextCallback(textToReplace, this._state), currentResults), null);\n    if (results.length) {\n      // Wrapped in single change will batch it into one transaction.\n      model.change(() => {\n        [...results].forEach(searchResult => {\n          // Just reuse logic from the replace command to replace a single match.\n          this._replace(newText, searchResult);\n        });\n      });\n    }\n  }\n}\n\n/**\n * The find next command. Moves the highlight to the next search result.\n *\n * It is used by the {@link module:find-and-replace/findandreplace~FindAndReplace find and replace feature}.\n */\nclass FindNextCommand extends Command {\n  /**\n  * The find and replace state object used for command operations.\n  */\n  _state;\n  /**\n  * Creates a new `FindNextCommand` instance.\n  *\n  * @param editor The editor on which this command will be used.\n  * @param state An object to hold plugin state.\n  */\n  constructor(editor, state) {\n    super(editor);\n    // It does not affect data so should be enabled in read-only mode.\n    this.affectsData = false;\n    this._state = state;\n    this.isEnabled = false;\n    this.listenTo(this._state.results, 'change', () => {\n      this.isEnabled = this._state.results.length > 1;\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.isEnabled = this._state.results.length > 1;\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const results = this._state.results;\n    const currentIndex = results.getIndex(this._state.highlightedResult);\n    const nextIndex = currentIndex + 1 >= results.length ? 0 : currentIndex + 1;\n    this._state.highlightedResult = this._state.results.get(nextIndex);\n  }\n}\n\n/**\n * The find previous command. Moves the highlight to the previous search result.\n *\n * It is used by the {@link module:find-and-replace/findandreplace~FindAndReplace find and replace feature}.\n */\nclass FindPreviousCommand extends FindNextCommand {\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const results = this._state.results;\n    const currentIndex = results.getIndex(this._state.highlightedResult);\n    const previousIndex = currentIndex - 1 < 0 ? this._state.results.length - 1 : currentIndex - 1;\n    this._state.highlightedResult = this._state.results.get(previousIndex);\n  }\n}\n\n/**\n * A set of helpers related to find and replace.\n */\nclass FindAndReplaceUtils extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FindAndReplaceUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * Executes findCallback and updates search results list.\n  *\n  * @param range The model range to scan for matches.\n  * @param model The model.\n  * @param findCallback The callback that should return `true` if provided text matches the search term.\n  * @param startResults An optional collection of find matches that the function should\n  * start with. This would be a collection returned by a previous `updateFindResultFromRange()` call.\n  * @returns A collection of objects describing find match.\n  *\n  * An example structure:\n  *\n  * ```js\n  * {\n  *\tid: resultId,\n  *\tlabel: foundItem.label,\n  *\tmarker\n  *\t}\n  * ```\n  */\n  updateFindResultFromRange(range, model, findCallback, startResults) {\n    const results = startResults || new Collection();\n    const checkIfResultAlreadyOnList = marker => results.find(markerItem => {\n      const {\n        marker: resultsMarker\n      } = markerItem;\n      const resultRange = resultsMarker.getRange();\n      const markerRange = marker.getRange();\n      return resultRange.isEqual(markerRange);\n    });\n    model.change(writer => {\n      [...range].forEach(({\n        type,\n        item\n      }) => {\n        if (type === 'elementStart') {\n          if (model.schema.checkChild(item, '$text')) {\n            let foundItems = findCallback({\n              item,\n              text: this.rangeToText(model.createRangeIn(item))\n            });\n            if (!foundItems) {\n              return;\n            }\n            if ('results' in foundItems) {\n              foundItems = foundItems.results;\n            }\n            foundItems.forEach(foundItem => {\n              const resultId = `findResult:${uid()}`;\n              const marker = writer.addMarker(resultId, {\n                usingOperation: false,\n                affectsData: false,\n                range: writer.createRange(writer.createPositionAt(item, foundItem.start), writer.createPositionAt(item, foundItem.end))\n              });\n              const index = findInsertIndex(results, marker);\n              if (!checkIfResultAlreadyOnList(marker)) {\n                results.add({\n                  id: resultId,\n                  label: foundItem.label,\n                  marker\n                }, index);\n              }\n            });\n          }\n        }\n      });\n    });\n    return results;\n  }\n  /**\n  * Returns text representation of a range. The returned text length should be the same as range length.\n  * In order to achieve this, this function will replace inline elements (text-line) as new line character (\"\\n\").\n  *\n  * @param range The model range.\n  * @returns The text content of the provided range.\n  */\n  rangeToText(range) {\n    return Array.from(range.getItems({\n      shallow: true\n    })).reduce((rangeText, node) => {\n      // Trim text to a last occurrence of an inline element and update range start.\n      if (!(node.is('$text') || node.is('$textProxy'))) {\n        // Editor has only one inline element defined in schema: `<softBreak>` which is treated as new line character in blocks.\n        // Special handling might be needed for other inline elements (inline widgets).\n        return `${rangeText}\\n`;\n      }\n      return rangeText + node.data;\n    }, '');\n  }\n  /**\n  * Creates a text matching callback for a specified search term and matching options.\n  *\n  * @param searchTerm The search term.\n  * @param options Matching options.\n  * \t- options.matchCase=false If set to `true` letter casing will be ignored.\n  * \t- options.wholeWords=false If set to `true` only whole words that match `callbackOrText` will be matched.\n  */\n  findByTextCallback(searchTerm, options) {\n    let flags = 'gu';\n    if (!options.matchCase) {\n      flags += 'i';\n    }\n    let regExpQuery = `(${escapeRegExp(searchTerm)})`;\n    if (options.wholeWords) {\n      const nonLetterGroup = '[^a-zA-Z\\u00C0-\\u024F\\u1E00-\\u1EFF]';\n      if (!new RegExp('^' + nonLetterGroup).test(searchTerm)) {\n        regExpQuery = `(^|${nonLetterGroup}|_)${regExpQuery}`;\n      }\n      if (!new RegExp(nonLetterGroup + '$').test(searchTerm)) {\n        regExpQuery = `${regExpQuery}(?=_|${nonLetterGroup}|$)`;\n      }\n    }\n    const regExp = new RegExp(regExpQuery, flags);\n    function findCallback({\n      text\n    }) {\n      const matches = [...text.matchAll(regExp)];\n      return matches.map(regexpMatchToFindResult);\n    }\n    return findCallback;\n  }\n}\n// Finds the appropriate index in the resultsList Collection.\nfunction findInsertIndex(resultsList, markerToInsert) {\n  const result = resultsList.find(({\n    marker\n  }) => {\n    return markerToInsert.getStart().isBefore(marker.getStart());\n  });\n  return result ? resultsList.getIndex(result) : resultsList.length;\n}\n/**\n *  Maps RegExp match result to find result.\n */\nfunction regexpMatchToFindResult(matchResult) {\n  const lastGroupIndex = matchResult.length - 1;\n  let startOffset = matchResult.index;\n  // Searches with match all flag have an extra matching group with empty string or white space matched before the word.\n  // If the search term starts with the space already, there is no extra group even with match all flag on.\n  if (matchResult.length === 3) {\n    startOffset += matchResult[1].length;\n  }\n  return {\n    label: matchResult[lastGroupIndex],\n    start: startOffset,\n    end: startOffset + matchResult[lastGroupIndex].length\n  };\n}\nconst HIGHLIGHT_CLASS = 'ck-find-result_selected';\n/**\n * Implements the editing part for find and replace plugin. For example conversion, commands etc.\n */\nclass FindAndReplaceEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FindAndReplaceUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FindAndReplaceEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * An object storing the find and replace state within a given editor instance.\n  */\n  state;\n  /**\n  * @inheritDoc\n  */\n  init() {\n    this.state = new FindAndReplaceState(this.editor.model);\n    this.set('_isSearchActive', false);\n    this._defineConverters();\n    this._defineCommands();\n    this.listenTo(this.state, 'change:highlightedResult', (eventInfo, name, newValue, oldValue) => {\n      const {\n        model\n      } = this.editor;\n      model.change(writer => {\n        if (oldValue) {\n          const oldMatchId = oldValue.marker.name.split(':')[1];\n          const oldMarker = model.markers.get(`findResultHighlighted:${oldMatchId}`);\n          if (oldMarker) {\n            writer.removeMarker(oldMarker);\n          }\n        }\n        if (newValue) {\n          const newMatchId = newValue.marker.name.split(':')[1];\n          writer.addMarker(`findResultHighlighted:${newMatchId}`, {\n            usingOperation: false,\n            affectsData: false,\n            range: newValue.marker.getRange()\n          });\n        }\n      });\n    });\n    /* istanbul ignore next -- @preserve */\n    const scrollToHighlightedResult = (eventInfo, name, newValue) => {\n      if (newValue) {\n        const domConverter = this.editor.editing.view.domConverter;\n        const viewRange = this.editor.editing.mapper.toViewRange(newValue.marker.getRange());\n        scrollViewportToShowTarget({\n          target: domConverter.viewRangeToDom(viewRange),\n          viewportOffset: 40\n        });\n      }\n    };\n    const debouncedScrollListener = debounce(scrollToHighlightedResult.bind(this), 32);\n    // Debounce scroll as highlight might be changed very frequently, e.g. when there's a replace all command.\n    this.listenTo(this.state, 'change:highlightedResult', debouncedScrollListener, {\n      priority: 'low'\n    });\n    // It's possible that the editor will get destroyed before debounced call kicks in.\n    // This would result with accessing a view three that is no longer in DOM.\n    this.listenTo(this.editor, 'destroy', debouncedScrollListener.cancel);\n    this.on('change:_isSearchActive', (evt, name, isSearchActive) => {\n      if (isSearchActive) {\n        this.listenTo(this.editor.model.document, 'change:data', this._onDocumentChange);\n      } else {\n        this.stopListening(this.editor.model.document, 'change:data', this._onDocumentChange);\n      }\n    });\n  }\n  /**\n  * Initiate a search.\n  */\n  find(callbackOrText, findAttributes) {\n    this._isSearchActive = true;\n    this.editor.execute('find', callbackOrText, findAttributes);\n    return this.state.results;\n  }\n  /**\n  * Stops active results from updating, and clears out the results.\n  */\n  stop() {\n    this.state.clear(this.editor.model);\n    this._isSearchActive = false;\n  }\n  /**\n  * Sets up the commands.\n  */\n  _defineCommands() {\n    this.editor.commands.add('find', new FindCommand(this.editor, this.state));\n    this.editor.commands.add('findNext', new FindNextCommand(this.editor, this.state));\n    this.editor.commands.add('findPrevious', new FindPreviousCommand(this.editor, this.state));\n    this.editor.commands.add('replace', new ReplaceCommand(this.editor, this.state));\n    this.editor.commands.add('replaceAll', new ReplaceAllCommand(this.editor, this.state));\n  }\n  /**\n  * Sets up the marker downcast converters for search results highlighting.\n  */\n  _defineConverters() {\n    const {\n      editor\n    } = this;\n    // Setup the marker highlighting conversion.\n    editor.conversion.for('editingDowncast').markerToHighlight({\n      model: 'findResult',\n      view: ({\n        markerName\n      }) => {\n        const [, id] = markerName.split(':');\n        // Marker removal from the view has a bug: https://github.com/ckeditor/ckeditor5/issues/7499\n        // A minimal option is to return a new object for each converted marker...\n        return {\n          name: 'span',\n          classes: ['ck-find-result'],\n          attributes: {\n            // ...however, adding a unique attribute should be future-proof..\n            'data-find-result': id\n          }\n        };\n      }\n    });\n    editor.conversion.for('editingDowncast').markerToHighlight({\n      model: 'findResultHighlighted',\n      view: ({\n        markerName\n      }) => {\n        const [, id] = markerName.split(':');\n        // Marker removal from the view has a bug: https://github.com/ckeditor/ckeditor5/issues/7499\n        // A minimal option is to return a new object for each converted marker...\n        return {\n          name: 'span',\n          classes: [HIGHLIGHT_CLASS],\n          attributes: {\n            // ...however, adding a unique attribute should be future-proof..\n            'data-find-result': id\n          }\n        };\n      }\n    });\n  }\n  /**\n  * Reacts to document changes in order to update search list.\n  */\n  _onDocumentChange = () => {\n    const changedNodes = new Set();\n    const removedMarkers = new Set();\n    const model = this.editor.model;\n    const {\n      results\n    } = this.state;\n    const changes = model.document.differ.getChanges();\n    const changedMarkers = model.document.differ.getChangedMarkers();\n    // Get nodes in which changes happened to re-run a search callback on them.\n    changes.forEach(change => {\n      if (!change.position) {\n        return;\n      }\n      if (change.name === '$text' || change.position.nodeAfter && model.schema.isInline(change.position.nodeAfter)) {\n        changedNodes.add(change.position.parent);\n        [...model.markers.getMarkersAtPosition(change.position)].forEach(markerAtChange => {\n          removedMarkers.add(markerAtChange.name);\n        });\n      } else if (change.type === 'insert' && change.position.nodeAfter) {\n        changedNodes.add(change.position.nodeAfter);\n      }\n    });\n    // Get markers from removed nodes also.\n    changedMarkers.forEach(({\n      name,\n      data: {\n        newRange\n      }\n    }) => {\n      if (newRange && newRange.start.root.rootName === '$graveyard') {\n        removedMarkers.add(name);\n      }\n    });\n    // Get markers from the updated nodes and remove all (search will be re-run on these nodes).\n    changedNodes.forEach(node => {\n      const markersInNode = [...model.markers.getMarkersIntersectingRange(model.createRangeIn(node))];\n      markersInNode.forEach(marker => removedMarkers.add(marker.name));\n    });\n    // Remove results from the changed part of content.\n    removedMarkers.forEach(markerName => {\n      if (!results.has(markerName)) {\n        return;\n      }\n      if (results.get(markerName) === this.state.highlightedResult) {\n        this.state.highlightedResult = null;\n      }\n      results.remove(markerName);\n    });\n    // Run search callback again on updated nodes.\n    const changedSearchResults = [];\n    const findAndReplaceUtils = this.editor.plugins.get('FindAndReplaceUtils');\n    changedNodes.forEach(nodeToCheck => {\n      const changedNodeSearchResults = findAndReplaceUtils.updateFindResultFromRange(model.createRangeOn(nodeToCheck), model, this.state.lastSearchCallback, results);\n      changedSearchResults.push(...changedNodeSearchResults);\n    });\n    changedMarkers.forEach(markerToCheck => {\n      // Handle search result highlight update when T&C plugin is active.\n      // Lookup is performed only on newly inserted markers.\n      if (markerToCheck.data.newRange) {\n        const changedNodeSearchResults = findAndReplaceUtils.updateFindResultFromRange(markerToCheck.data.newRange, model, this.state.lastSearchCallback, results);\n        changedSearchResults.push(...changedNodeSearchResults);\n      }\n    });\n    if (!this.state.highlightedResult && changedSearchResults.length) {\n      // If there are found phrases but none is selected, select the first one.\n      this.state.highlightedResult = changedSearchResults[0];\n    } else {\n      // If there is already highlight item then refresh highlight offset after appending new items.\n      this.state.refreshHighlightOffset(model);\n    }\n  };\n}\n\n/**\n * The find and replace plugin.\n *\n * For a detailed overview, check the {@glink features/find-and-replace Find and replace feature documentation}.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * The {@link module:find-and-replace/findandreplaceediting~FindAndReplaceEditing find and replace editing feature},\n * * The {@link module:find-and-replace/findandreplaceui~FindAndReplaceUI find and replace UI feature}\n */\nclass FindAndReplace extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FindAndReplaceEditing, FindAndReplaceUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FindAndReplace';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const ui = this.editor.plugins.get('FindAndReplaceUI');\n    const findAndReplaceEditing = this.editor.plugins.get('FindAndReplaceEditing');\n    const state = findAndReplaceEditing.state;\n    ui.on('findNext', (event, data) => {\n      // Data is contained only for the \"find\" button.\n      if (data) {\n        state.searchText = data.searchText;\n        findAndReplaceEditing.find(data.searchText, data);\n      } else {\n        // Find next arrow button press.\n        this.editor.execute('findNext');\n      }\n    });\n    ui.on('findPrevious', (event, data) => {\n      if (data && state.searchText !== data.searchText) {\n        findAndReplaceEditing.find(data.searchText);\n      } else {\n        // Subsequent calls.\n        this.editor.execute('findPrevious');\n      }\n    });\n    ui.on('replace', (event, data) => {\n      if (state.searchText !== data.searchText) {\n        findAndReplaceEditing.find(data.searchText);\n      }\n      const highlightedResult = state.highlightedResult;\n      if (highlightedResult) {\n        this.editor.execute('replace', data.replaceText, highlightedResult);\n      }\n    });\n    ui.on('replaceAll', (event, data) => {\n      // The state hadn't been yet built for this search text.\n      if (state.searchText !== data.searchText) {\n        findAndReplaceEditing.find(data.searchText);\n      }\n      this.editor.execute('replaceAll', data.replaceText, state.results);\n    });\n    // Reset the state when the user invalidated last search results, for instance,\n    // by starting typing another search query or changing options.\n    ui.on('searchReseted', () => {\n      state.clear(this.editor.model);\n      findAndReplaceEditing.stop();\n    });\n  }\n}\nexport { FindAndReplace, FindAndReplaceEditing, FindAndReplaceUI, FindAndReplaceUtils, FindCommand, FindNextCommand, FindPreviousCommand, ReplaceAllCommand, ReplaceCommand };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { ColorSelectorView, createDropdown, addListToDropdown, MenuBarMenuView, MenuBarMenuListView, MenuBarMenuListItemView, MenuBarMenuListItemButtonView, ViewModel, normalizeColorOptions, getLocalizedColorOptions, focusChildOnDropdownOpen } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { Collection, CKEditorError } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { IconFontFamily, IconFontSize, IconFontColor, IconFontBackground } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { isLength, isPercentage, addBackgroundRules } from '@ckeditor/ckeditor5-engine/dist/index.js';\n\n/**\n * The base font command.\n */\nclass FontCommand extends Command {\n  /**\n  * A model attribute on which this command operates.\n  */\n  attributeKey;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor Editor instance.\n  * @param attributeKey The name of a model attribute on which this command operates.\n  */\n  constructor(editor, attributeKey) {\n    super(editor);\n    this.attributeKey = attributeKey;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const doc = model.document;\n    this.value = doc.selection.getAttribute(this.attributeKey);\n    this.isEnabled = model.schema.checkAttributeInSelection(doc.selection, this.attributeKey);\n  }\n  /**\n  * Executes the command. Applies the `value` of the {@link #attributeKey} to the selection.\n  * If no `value` is passed, it removes the attribute from the selection.\n  *\n  * @param options Options for the executed command.\n  * @param options.value The value to apply.\n  * @fires execute\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const document = model.document;\n    const selection = document.selection;\n    const value = options.value;\n    const batch = options.batch;\n    const updateAttribute = writer => {\n      if (selection.isCollapsed) {\n        if (value) {\n          writer.setSelectionAttribute(this.attributeKey, value);\n        } else {\n          writer.removeSelectionAttribute(this.attributeKey);\n        }\n      } else {\n        const ranges = model.schema.getValidRanges(selection.getRanges(), this.attributeKey);\n        for (const range of ranges) {\n          if (value) {\n            writer.setAttribute(this.attributeKey, value, range);\n          } else {\n            writer.removeAttribute(this.attributeKey, range);\n          }\n        }\n      }\n    };\n    // In some scenarios, you may want to use a single undo step for multiple changes (e.g. in color picker).\n    if (batch) {\n      model.enqueueChange(batch, writer => {\n        updateAttribute(writer);\n      });\n    } else {\n      model.change(writer => {\n        updateAttribute(writer);\n      });\n    }\n  }\n}\n\n/**\n * The name of the font size plugin.\n */\nconst FONT_SIZE = 'fontSize';\n/**\n * The name of the font family plugin.\n */\nconst FONT_FAMILY = 'fontFamily';\n/**\n * The name of the font color plugin.\n */\nconst FONT_COLOR = 'fontColor';\n/**\n * The name of the font background color plugin.\n */\nconst FONT_BACKGROUND_COLOR = 'fontBackgroundColor';\n/**\n * Builds a proper converter definition out of input data.\n */\nfunction buildDefinition(modelAttributeKey, options) {\n  const definition = {\n    model: {\n      key: modelAttributeKey,\n      values: []\n    },\n    view: {},\n    upcastAlso: {}\n  };\n  for (const option of options) {\n    definition.model.values.push(option.model);\n    definition.view[option.model] = option.view;\n    if (option.upcastAlso) {\n      definition.upcastAlso[option.model] = option.upcastAlso;\n    }\n  }\n  return definition;\n}\n/**\n * A {@link module:font/fontcolor~FontColor font color} and\n * {@link module:font/fontbackgroundcolor~FontBackgroundColor font background color} helper\n * responsible for upcasting data to the model.\n *\n * **Note**: The `styleAttr` parameter should be either `'color'` or `'background-color'`.\n */\nfunction renderUpcastAttribute(styleAttr) {\n  return viewElement => normalizeColorCode(viewElement.getStyle(styleAttr));\n}\n/**\n * A {@link module:font/fontcolor~FontColor font color} and\n * {@link module:font/fontbackgroundcolor~FontBackgroundColor font background color} helper\n * responsible for downcasting a color attribute to a `<span>` element.\n *\n * **Note**: The `styleAttr` parameter should be either `'color'` or `'background-color'`.\n */\nfunction renderDowncastElement(styleAttr) {\n  return (modelAttributeValue, {\n    writer\n  }) => writer.createAttributeElement('span', {\n    style: `${styleAttr}:${modelAttributeValue}`\n  }, {\n    priority: 7\n  });\n}\n/**\n * A helper that adds {@link module:ui/colorselector/colorselectorview~ColorSelectorView} to the color dropdown with proper initial values.\n *\n * @param config.dropdownView The dropdown view to which a {@link module:ui/colorselector/colorselectorview~ColorSelectorView}\n * will be added.\n * @param config.colors An array with definitions representing colors to be displayed in the color selector.\n * @param config.removeButtonLabel The label for the button responsible for removing the color.\n * @param config.documentColorsLabel The label for the section with document colors.\n * @param config.documentColorsCount The number of document colors inside the dropdown.\n * @param config.colorPickerViewConfig Configuration of the color picker view.\n * @returns The new color selector view.\n */\nfunction addColorSelectorToDropdown({\n  dropdownView,\n  colors,\n  columns,\n  removeButtonLabel,\n  colorPickerLabel,\n  documentColorsLabel,\n  documentColorsCount,\n  colorPickerViewConfig\n}) {\n  const locale = dropdownView.locale;\n  const colorSelectorView = new ColorSelectorView(locale, {\n    colors,\n    columns,\n    removeButtonLabel,\n    colorPickerLabel,\n    documentColorsLabel,\n    documentColorsCount,\n    colorPickerViewConfig\n  });\n  dropdownView.colorSelectorView = colorSelectorView;\n  dropdownView.panelView.children.add(colorSelectorView);\n  return colorSelectorView;\n}\n/**\n * Fixes the color value string.\n */\nfunction normalizeColorCode(value) {\n  return value.replace(/\\s/g, '');\n}\n\n/**\n * The font family command. It is used by {@link module:font/fontfamily/fontfamilyediting~FontFamilyEditing}\n * to apply the font family.\n *\n * ```ts\n * editor.execute( 'fontFamily', { value: 'Arial' } );\n * ```\n *\n * **Note**: Executing the command without the value removes the attribute from the model.\n */\nclass FontFamilyCommand extends FontCommand {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor, FONT_FAMILY);\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module font/fontfamily/utils\n    */ /**\n       * Normalizes the {@link module:font/fontconfig~FontFamilyConfig#options configuration options}\n       * to the {@link module:font/fontconfig~FontFamilyOption} format.\n       *\n       * @param configuredOptions An array of options taken from the configuration.\n       */\nfunction normalizeOptions$1(configuredOptions) {\n  // Convert options to objects.\n  return configuredOptions.map(getOptionDefinition$1) // Filter out undefined values that `getOptionDefinition` might return.\n  .filter(option => option !== undefined);\n}\n/**\n * Returns an option definition either created from string shortcut.\n * If object is passed then this method will return it without alternating it. Returns undefined for item than cannot be parsed.\n *\n */\nfunction getOptionDefinition$1(option) {\n  // Treat any object as full item definition provided by user in configuration.\n  if (typeof option === 'object') {\n    return option;\n  }\n  // Handle 'default' string as a special case. It will be used to remove the fontFamily attribute.\n  if (option === 'default') {\n    return {\n      title: 'Default',\n      model: undefined\n    };\n  }\n  // Ignore values that we cannot parse to a definition.\n  if (typeof option !== 'string') {\n    return undefined;\n  }\n  // Return font family definition from font string.\n  return generateFontPreset(option);\n}\n/**\n * Creates a predefined preset for pixel size. It deconstructs font-family like string into full configuration option.\n * A font definition is passed as coma delimited set of font family names. Font names might be quoted.\n *\n * @param fontDefinition A font definition form configuration.\n */\nfunction generateFontPreset(fontDefinition) {\n  // Remove quotes from font names. They will be normalized later.\n  const fontNames = fontDefinition.replace(/\"|'/g, '').split(',');\n  // The first matched font name will be used as dropdown list item title and as model value.\n  const firstFontName = fontNames[0];\n  // CSS-compatible font names.\n  const cssFontNames = fontNames.map(normalizeFontNameForCSS).join(', ');\n  return {\n    title: firstFontName,\n    model: cssFontNames,\n    view: {\n      name: 'span',\n      styles: {\n        'font-family': cssFontNames\n      },\n      priority: 7\n    }\n  };\n}\n/**\n * Normalizes font name for the style attribute. It adds braces (') if font name contains spaces.\n */\nfunction normalizeFontNameForCSS(fontName) {\n  fontName = fontName.trim();\n  // Compound font names should be quoted.\n  if (fontName.indexOf(' ') > 0) {\n    fontName = `'${fontName}'`;\n  }\n  return fontName;\n}\n\n/**\n * The font family editing feature.\n *\n * It introduces the {@link module:font/fontfamily/fontfamilycommand~FontFamilyCommand command} and\n * the `fontFamily` attribute in the {@link module:engine/model/model~Model model} which renders\n * in the {@link module:engine/view/view view} as an inline `<span>` element (`<span style=\"font-family: Arial\">`),\n * depending on the {@link module:font/fontconfig~FontFamilyConfig configuration}.\n */\nclass FontFamilyEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontFamilyEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    // Define default configuration using font families shortcuts.\n    editor.config.define(FONT_FAMILY, {\n      options: ['default', 'Arial, Helvetica, sans-serif', 'Courier New, Courier, monospace', 'Georgia, serif', 'Lucida Sans Unicode, Lucida Grande, sans-serif', 'Tahoma, Geneva, sans-serif', 'Times New Roman, Times, serif', 'Trebuchet MS, Helvetica, sans-serif', 'Verdana, Geneva, sans-serif'],\n      supportAllValues: false\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Allow fontFamily attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: FONT_FAMILY\n    });\n    editor.model.schema.setAttributeProperties(FONT_FAMILY, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n    // Get configured font family options without \"default\" option.\n    const options = normalizeOptions$1(editor.config.get('fontFamily.options')).filter(item => item.model);\n    const definition = buildDefinition(FONT_FAMILY, options);\n    // Set-up the two-way conversion.\n    if (editor.config.get('fontFamily.supportAllValues')) {\n      this._prepareAnyValueConverters();\n      this._prepareCompatibilityConverter();\n    } else {\n      editor.conversion.attributeToElement(definition);\n    }\n    editor.commands.add(FONT_FAMILY, new FontFamilyCommand(editor));\n  }\n  /**\n  * These converters enable keeping any value found as `style=\"font-family: *\"` as a value of an attribute on a text even\n  * if it is not defined in the plugin configuration.\n  */\n  _prepareAnyValueConverters() {\n    const editor = this.editor;\n    editor.conversion.for('downcast').attributeToElement({\n      model: FONT_FAMILY,\n      view: (attributeValue, {\n        writer\n      }) => {\n        return writer.createAttributeElement('span', {\n          style: 'font-family:' + attributeValue\n        }, {\n          priority: 7\n        });\n      }\n    });\n    editor.conversion.for('upcast').elementToAttribute({\n      model: {\n        key: FONT_FAMILY,\n        value: viewElement => viewElement.getStyle('font-family')\n      },\n      view: {\n        name: 'span',\n        styles: {\n          'font-family': /.*/\n        }\n      }\n    });\n  }\n  /**\n  * Adds support for legacy `<font face=\"..\">` formatting.\n  */\n  _prepareCompatibilityConverter() {\n    const editor = this.editor;\n    editor.conversion.for('upcast').elementToAttribute({\n      view: {\n        name: 'font',\n        attributes: {\n          'face': /.*/\n        }\n      },\n      model: {\n        key: FONT_FAMILY,\n        value: viewElement => viewElement.getAttribute('face')\n      }\n    });\n  }\n}\n\n/**\n * The font family UI plugin. It introduces the `'fontFamily'` dropdown.\n */\nclass FontFamilyUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontFamilyUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const options = this._getLocalizedOptions();\n    const command = editor.commands.get(FONT_FAMILY);\n    const accessibleLabel = t('Font Family');\n    const listOptions = _prepareListOptions$1(options, command);\n    // Register UI component.\n    editor.ui.componentFactory.add(FONT_FAMILY, locale => {\n      const dropdownView = createDropdown(locale);\n      addListToDropdown(dropdownView, listOptions, {\n        role: 'menu',\n        ariaLabel: accessibleLabel\n      });\n      dropdownView.buttonView.set({\n        label: accessibleLabel,\n        icon: IconFontFamily,\n        tooltip: true\n      });\n      dropdownView.extendTemplate({\n        attributes: {\n          class: 'ck-font-family-dropdown'\n        }\n      });\n      dropdownView.bind('isEnabled').to(command);\n      // Execute command when an item from the dropdown is selected.\n      this.listenTo(dropdownView, 'execute', evt => {\n        editor.execute(evt.source.commandName, {\n          value: evt.source.commandParam\n        });\n        editor.editing.view.focus();\n      });\n      return dropdownView;\n    });\n    editor.ui.componentFactory.add(`menuBar:${FONT_FAMILY}`, locale => {\n      const menuView = new MenuBarMenuView(locale);\n      menuView.buttonView.set({\n        label: accessibleLabel,\n        icon: IconFontFamily\n      });\n      menuView.bind('isEnabled').to(command);\n      const listView = new MenuBarMenuListView(locale);\n      for (const definition of listOptions) {\n        const listItemView = new MenuBarMenuListItemView(locale, menuView);\n        const buttonView = new MenuBarMenuListItemButtonView(locale);\n        buttonView.set({\n          role: 'menuitemradio',\n          isToggleable: true\n        });\n        buttonView.bind(...Object.keys(definition.model)).to(definition.model);\n        buttonView.delegate('execute').to(menuView);\n        buttonView.on('execute', () => {\n          editor.execute(definition.model.commandName, {\n            value: definition.model.commandParam\n          });\n          editor.editing.view.focus();\n        });\n        listItemView.children.add(buttonView);\n        listView.items.add(listItemView);\n      }\n      menuView.panelView.children.add(listView);\n      return menuView;\n    });\n  }\n  /**\n  * Returns options as defined in `config.fontFamily.options` but processed to account for\n  * editor localization, i.e. to display {@link module:font/fontconfig~FontFamilyOption}\n  * in the correct language.\n  *\n  * Note: The reason behind this method is that there is no way to use {@link module:utils/locale~Locale#t}\n  * when the user configuration is defined because the editor does not exist yet.\n  */\n  _getLocalizedOptions() {\n    const editor = this.editor;\n    const t = editor.t;\n    const options = normalizeOptions$1(editor.config.get(FONT_FAMILY).options);\n    return options.map(option => {\n      // The only title to localize is \"Default\" others are font names.\n      if (option.title === 'Default') {\n        option.title = t('Default');\n      }\n      return option;\n    });\n  }\n}\n/**\n * Prepares FontFamily dropdown items.\n */\nfunction _prepareListOptions$1(options, command) {\n  const itemDefinitions = new Collection();\n  // Create dropdown items.\n  for (const option of options) {\n    const def = {\n      type: 'button',\n      model: new ViewModel({\n        commandName: FONT_FAMILY,\n        commandParam: option.model,\n        label: option.title,\n        role: 'menuitemradio',\n        withText: true\n      })\n    };\n    def.model.bind('isOn').to(command, 'value', value => {\n      // \"Default\" or check in strict font-family converters mode.\n      if (value === option.model) {\n        return true;\n      }\n      if (!value || !option.model) {\n        return false;\n      }\n      return value.split(',')[0].replace(/'/g, '').toLowerCase() === option.model.toLowerCase();\n    });\n    // Try to set a dropdown list item style.\n    if (option.view && typeof option.view !== 'string' && option.view.styles) {\n      def.model.set('labelStyle', `font-family: ${option.view.styles['font-family']}`);\n    }\n    itemDefinitions.add(def);\n  }\n  return itemDefinitions;\n}\n\n/**\n * The font family plugin.\n *\n * For a detailed overview, check the {@glink features/font font feature} documentatiom\n * and the {@glink api/font package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:font/fontfamily/fontfamilyediting~FontFamilyEditing} and\n * {@link module:font/fontfamily/fontfamilyui~FontFamilyUI} features in the editor.\n */\nclass FontFamily extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FontFamilyEditing, FontFamilyUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontFamily';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The font size command. It is used by {@link module:font/fontsize/fontsizeediting~FontSizeEditing}\n * to apply the font size.\n *\n * ```ts\n * editor.execute( 'fontSize', { value: 'small' } );\n * ```\n *\n * **Note**: Executing the command without the value removes the attribute from the model.\n */\nclass FontSizeCommand extends FontCommand {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor, FONT_SIZE);\n  }\n}\n\n/**\n * Normalizes and translates the {@link module:font/fontconfig~FontSizeConfig#options configuration options}\n * to the {@link module:font/fontconfig~FontSizeOption} format.\n *\n * @param configuredOptions An array of options taken from the configuration.\n */\nfunction normalizeOptions(configuredOptions) {\n  // Convert options to objects.\n  return configuredOptions.map(item => getOptionDefinition(item)) // Filter out undefined values that `getOptionDefinition` might return.\n  .filter(option => option !== undefined);\n}\n// Default named presets map. Always create a new instance of the preset object in order to avoid modifying references.\nconst namedPresets = {\n  get tiny() {\n    return {\n      title: 'Tiny',\n      model: 'tiny',\n      view: {\n        name: 'span',\n        classes: 'text-tiny',\n        priority: 7\n      }\n    };\n  },\n  get small() {\n    return {\n      title: 'Small',\n      model: 'small',\n      view: {\n        name: 'span',\n        classes: 'text-small',\n        priority: 7\n      }\n    };\n  },\n  get big() {\n    return {\n      title: 'Big',\n      model: 'big',\n      view: {\n        name: 'span',\n        classes: 'text-big',\n        priority: 7\n      }\n    };\n  },\n  get huge() {\n    return {\n      title: 'Huge',\n      model: 'huge',\n      view: {\n        name: 'span',\n        classes: 'text-huge',\n        priority: 7\n      }\n    };\n  }\n};\n/**\n * Returns an option definition either from preset or creates one from number shortcut.\n * If object is passed then this method will return it without alternating it. Returns undefined for item than cannot be parsed.\n */\nfunction getOptionDefinition(option) {\n  if (typeof option === 'number') {\n    option = String(option);\n  }\n  // Check whether passed option is a full item definition provided by user in configuration.\n  if (typeof option === 'object' && isFullItemDefinition(option)) {\n    return attachPriority(option);\n  }\n  const preset = findPreset(option);\n  // Item is a named preset.\n  if (preset) {\n    return attachPriority(preset);\n  }\n  // 'Default' font size. It will be used to remove the fontSize attribute.\n  if (option === 'default') {\n    return {\n      model: undefined,\n      title: 'Default'\n    };\n  }\n  // At this stage we probably have numerical value to generate a preset so parse it's value.\n  // Discard any faulty values.\n  if (isNumericalDefinition(option)) {\n    return undefined;\n  }\n  // Return font size definition from size value.\n  return generatePixelPreset(option);\n}\n/**\n * Creates a predefined preset for pixel size.\n * @param definition Font size in pixels.\n * @returns\n */\nfunction generatePixelPreset(definition) {\n  // Extend a short (numeric value) definition.\n  if (typeof definition === 'string') {\n    definition = {\n      title: definition,\n      model: `${parseFloat(definition)}px`\n    };\n  }\n  definition.view = {\n    name: 'span',\n    styles: {\n      'font-size': definition.model\n    }\n  };\n  return attachPriority(definition);\n}\n/**\n * Adds the priority to the view element definition if missing. It's required due to ckeditor/ckeditor5#2291\n */\nfunction attachPriority(definition) {\n  if (definition.view && typeof definition.view !== 'string' && !definition.view.priority) {\n    definition.view.priority = 7;\n  }\n  return definition;\n}\n/**\n * Returns a prepared preset definition. If passed an object, a name of preset should be defined as `model` value.\n *\n * @param definition.model A preset name.\n */\nfunction findPreset(definition) {\n  return typeof definition === 'string' ? namedPresets[definition] : namedPresets[definition.model];\n}\n/**\n * We treat `definition` as completed if it is an object that contains `title`, `model` and `view` values.\n */\nfunction isFullItemDefinition(definition) {\n  return definition.title && definition.model && definition.view;\n}\nfunction isNumericalDefinition(definition) {\n  let numberValue;\n  if (typeof definition === 'object') {\n    if (!definition.model) {\n      /**\n      * Provided value as an option for {@link module:font/fontsize~FontSize} seems to invalid.\n      *\n      * See valid examples described in the {@link module:font/fontconfig~FontSizeConfig#options plugin configuration}.\n      *\n      * @error font-size-invalid-definition\n      */\n      throw new CKEditorError('font-size-invalid-definition', null, definition);\n    } else {\n      numberValue = parseFloat(definition.model);\n    }\n  } else {\n    numberValue = parseFloat(definition);\n  }\n  return isNaN(numberValue);\n}\n\n// Mapping of `<font size=\"..\">` styling to CSS's `font-size` values.\nconst styleFontSize = ['x-small', 'x-small', 'small', 'medium', 'large', 'x-large', 'xx-large', 'xxx-large'];\n/**\n * The font size editing feature.\n *\n * It introduces the {@link module:font/fontsize/fontsizecommand~FontSizeCommand command} and the `fontSize`\n * attribute in the {@link module:engine/model/model~Model model} which renders in the {@link module:engine/view/view view}\n * as a `<span>` element with either:\n * * a style attribute (`<span style=\"font-size:12px\">...</span>`),\n * * or a class attribute (`<span class=\"text-small\">...</span>`)\n *\n * depending on the {@link module:font/fontconfig~FontSizeConfig configuration}.\n */\nclass FontSizeEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontSizeEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    // Define default configuration using named presets.\n    editor.config.define(FONT_SIZE, {\n      options: ['tiny', 'small', 'default', 'big', 'huge'],\n      supportAllValues: false\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Allow fontSize attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: FONT_SIZE\n    });\n    editor.model.schema.setAttributeProperties(FONT_SIZE, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n    const supportAllValues = editor.config.get('fontSize.supportAllValues');\n    // Define view to model conversion.\n    const options = normalizeOptions(this.editor.config.get('fontSize.options')).filter(item => item.model);\n    const definition = buildDefinition(FONT_SIZE, options);\n    // Set-up the two-way conversion.\n    if (supportAllValues) {\n      this._prepareAnyValueConverters(definition);\n      this._prepareCompatibilityConverter();\n    } else {\n      editor.conversion.attributeToElement(definition);\n    }\n    // Add FontSize command.\n    editor.commands.add(FONT_SIZE, new FontSizeCommand(editor));\n  }\n  /**\n  * These converters enable keeping any value found as `style=\"font-size: *\"` as a value of an attribute on a text even\n  * if it is not defined in the plugin configuration.\n  *\n  * @param definition Converter definition out of input data.\n  */\n  _prepareAnyValueConverters(definition) {\n    const editor = this.editor;\n    // If `fontSize.supportAllValues=true`, we do not allow to use named presets in the plugin's configuration.\n    const presets = definition.model.values.filter(value => {\n      return !isLength(String(value)) && !isPercentage(String(value));\n    });\n    if (presets.length) {\n      /**\n      * If {@link module:font/fontconfig~FontSizeConfig#supportAllValues `config.fontSize.supportAllValues`} is `true`,\n      * you need to use numerical values as font size options.\n      *\n      * See valid examples described in the {@link module:font/fontconfig~FontSizeConfig#options plugin configuration}.\n      *\n      * @error font-size-invalid-use-of-named-presets\n      * @param {Array.<String>} presets Invalid values.\n      */\n      throw new CKEditorError('font-size-invalid-use-of-named-presets', null, {\n        presets\n      });\n    }\n    editor.conversion.for('downcast').attributeToElement({\n      model: FONT_SIZE,\n      view: (attributeValue, {\n        writer\n      }) => {\n        if (!attributeValue) {\n          return;\n        }\n        return writer.createAttributeElement('span', {\n          style: 'font-size:' + attributeValue\n        }, {\n          priority: 7\n        });\n      }\n    });\n    editor.conversion.for('upcast').elementToAttribute({\n      model: {\n        key: FONT_SIZE,\n        value: viewElement => viewElement.getStyle('font-size')\n      },\n      view: {\n        name: 'span',\n        styles: {\n          'font-size': /.*/\n        }\n      }\n    });\n  }\n  /**\n  * Adds support for legacy `<font size=\"..\">` formatting.\n  */\n  _prepareCompatibilityConverter() {\n    const editor = this.editor;\n    editor.conversion.for('upcast').elementToAttribute({\n      view: {\n        name: 'font',\n        attributes: {\n          // Documentation mentions sizes from 1 to 7. To handle old content we support all values\n          // up to 999 but clamp it to the valid range. Why 999? It should cover accidental values\n          // similar to percentage, e.g. 100%, 200% which could be the usual mistake for font size.\n          'size': /^[+-]?\\d{1,3}$/\n        }\n      },\n      model: {\n        key: FONT_SIZE,\n        value: viewElement => {\n          const value = viewElement.getAttribute('size');\n          const isRelative = value[0] === '-' || value[0] === '+';\n          let size = parseInt(value, 10);\n          if (isRelative) {\n            // Add relative size (which can be negative) to the default size = 3.\n            size = 3 + size;\n          }\n          const maxSize = styleFontSize.length - 1;\n          const clampedSize = Math.min(Math.max(size, 0), maxSize);\n          return styleFontSize[clampedSize];\n        }\n      }\n    });\n  }\n}\n\n/**\n * The font size UI plugin. It introduces the `'fontSize'` dropdown.\n */\nclass FontSizeUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontSizeUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const options = this._getLocalizedOptions();\n    const command = editor.commands.get(FONT_SIZE);\n    const accessibleLabel = t('Font Size');\n    const listOptions = _prepareListOptions(options, command);\n    // Register UI component.\n    editor.ui.componentFactory.add(FONT_SIZE, locale => {\n      const dropdownView = createDropdown(locale);\n      addListToDropdown(dropdownView, listOptions, {\n        role: 'menu',\n        ariaLabel: accessibleLabel\n      });\n      // Create dropdown model.\n      dropdownView.buttonView.set({\n        label: accessibleLabel,\n        icon: IconFontSize,\n        tooltip: true\n      });\n      dropdownView.extendTemplate({\n        attributes: {\n          class: ['ck-font-size-dropdown']\n        }\n      });\n      dropdownView.bind('isEnabled').to(command);\n      // Execute command when an item from the dropdown is selected.\n      this.listenTo(dropdownView, 'execute', evt => {\n        editor.execute(evt.source.commandName, {\n          value: evt.source.commandParam\n        });\n        editor.editing.view.focus();\n      });\n      return dropdownView;\n    });\n    editor.ui.componentFactory.add(`menuBar:${FONT_SIZE}`, locale => {\n      const menuView = new MenuBarMenuView(locale);\n      menuView.buttonView.set({\n        label: accessibleLabel,\n        icon: IconFontSize\n      });\n      menuView.bind('isEnabled').to(command);\n      const listView = new MenuBarMenuListView(locale);\n      for (const definition of listOptions) {\n        const listItemView = new MenuBarMenuListItemView(locale, menuView);\n        const buttonView = new MenuBarMenuListItemButtonView(locale);\n        buttonView.set({\n          role: 'menuitemradio',\n          isToggleable: true\n        });\n        buttonView.bind(...Object.keys(definition.model)).to(definition.model);\n        buttonView.delegate('execute').to(menuView);\n        buttonView.on('execute', () => {\n          editor.execute(definition.model.commandName, {\n            value: definition.model.commandParam\n          });\n          editor.editing.view.focus();\n        });\n        listItemView.children.add(buttonView);\n        listView.items.add(listItemView);\n      }\n      menuView.panelView.children.add(listView);\n      return menuView;\n    });\n  }\n  /**\n  * Returns options as defined in `config.fontSize.options` but processed to account for\n  * editor localization, i.e. to display {@link module:font/fontconfig~FontSizeOption}\n  * in the correct language.\n  *\n  * Note: The reason behind this method is that there is no way to use {@link module:utils/locale~Locale#t}\n  * when the user configuration is defined because the editor does not exist yet.\n  */\n  _getLocalizedOptions() {\n    const editor = this.editor;\n    const t = editor.t;\n    const localizedTitles = {\n      Default: t('Default'),\n      Tiny: t('Tiny'),\n      Small: t('Small'),\n      Big: t('Big'),\n      Huge: t('Huge')\n    };\n    const options = normalizeOptions(editor.config.get(FONT_SIZE).options);\n    return options.map(option => {\n      const title = localizedTitles[option.title];\n      if (title && title != option.title) {\n        // Clone the option to avoid altering the original `namedPresets` from `./utils.js`.\n        option = Object.assign({}, option, {\n          title\n        });\n      }\n      return option;\n    });\n  }\n}\n/**\n * Prepares FontSize dropdown items.\n */\nfunction _prepareListOptions(options, command) {\n  const itemDefinitions = new Collection();\n  for (const option of options) {\n    const def = {\n      type: 'button',\n      model: new ViewModel({\n        commandName: FONT_SIZE,\n        commandParam: option.model,\n        label: option.title,\n        class: 'ck-fontsize-option',\n        role: 'menuitemradio',\n        withText: true\n      })\n    };\n    if (option.view && typeof option.view !== 'string') {\n      if (option.view.styles) {\n        def.model.set('labelStyle', `font-size:${option.view.styles['font-size']}`);\n      }\n      if (option.view.classes) {\n        def.model.set('class', `${def.model.class} ${option.view.classes}`);\n      }\n    }\n    def.model.bind('isOn').to(command, 'value', value => value === option.model);\n    // Add the option to the collection.\n    itemDefinitions.add(def);\n  }\n  return itemDefinitions;\n}\n\n/**\n * The font size plugin.\n *\n * For a detailed overview, check the {@glink features/font font feature} documentation\n * and the {@glink api/font package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:font/fontsize/fontsizeediting~FontSizeEditing} and\n * {@link module:font/fontsize/fontsizeui~FontSizeUI} features in the editor.\n */\nclass FontSize extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FontSizeEditing, FontSizeUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontSize';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * Normalizes and translates the {@link module:font/fontconfig~FontSizeConfig#options configuration options}\n  * to the {@link module:font/fontconfig~FontSizeOption} format.\n  *\n  * @param configuredOptions An array of options taken from the configuration.\n  */\n  normalizeSizeOptions(options) {\n    return normalizeOptions(options);\n  }\n}\n\n/**\n * The font color command. It is used by {@link module:font/fontcolor/fontcolorediting~FontColorEditing}\n * to apply the font color.\n *\n * ```ts\n * editor.execute( 'fontColor', { value: 'rgb(250, 20, 20)' } );\n * ```\n *\n * **Note**: Executing the command with the `null` value removes the attribute from the model.\n */\nclass FontColorCommand extends FontCommand {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor, FONT_COLOR);\n  }\n}\n\n/**\n * The font color editing feature.\n *\n * It introduces the {@link module:font/fontcolor/fontcolorcommand~FontColorCommand command} and\n * the `fontColor` attribute in the {@link module:engine/model/model~Model model} which renders\n * in the {@link module:engine/view/view view} as a `<span>` element (`<span style=\"color: ...\">`),\n * depending on the {@link module:font/fontconfig~FontColorConfig configuration}.\n */\nclass FontColorEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontColorEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define(FONT_COLOR, {\n      colors: [{\n        color: 'hsl(0, 0%, 0%)',\n        label: 'Black'\n      }, {\n        color: 'hsl(0, 0%, 30%)',\n        label: 'Dim grey'\n      }, {\n        color: 'hsl(0, 0%, 60%)',\n        label: 'Grey'\n      }, {\n        color: 'hsl(0, 0%, 90%)',\n        label: 'Light grey'\n      }, {\n        color: 'hsl(0, 0%, 100%)',\n        label: 'White',\n        hasBorder: true\n      }, {\n        color: 'hsl(0, 75%, 60%)',\n        label: 'Red'\n      }, {\n        color: 'hsl(30, 75%, 60%)',\n        label: 'Orange'\n      }, {\n        color: 'hsl(60, 75%, 60%)',\n        label: 'Yellow'\n      }, {\n        color: 'hsl(90, 75%, 60%)',\n        label: 'Light green'\n      }, {\n        color: 'hsl(120, 75%, 60%)',\n        label: 'Green'\n      }, {\n        color: 'hsl(150, 75%, 60%)',\n        label: 'Aquamarine'\n      }, {\n        color: 'hsl(180, 75%, 60%)',\n        label: 'Turquoise'\n      }, {\n        color: 'hsl(210, 75%, 60%)',\n        label: 'Light blue'\n      }, {\n        color: 'hsl(240, 75%, 60%)',\n        label: 'Blue'\n      }, {\n        color: 'hsl(270, 75%, 60%)',\n        label: 'Purple'\n      }],\n      columns: 5\n    });\n    editor.conversion.for('upcast').elementToAttribute({\n      view: {\n        name: 'span',\n        styles: {\n          'color': /[\\s\\S]+/\n        }\n      },\n      model: {\n        key: FONT_COLOR,\n        value: renderUpcastAttribute('color')\n      }\n    });\n    // Support legacy `<font color=\"..\">` formatting.\n    editor.conversion.for('upcast').elementToAttribute({\n      view: {\n        name: 'font',\n        attributes: {\n          'color': /^#?\\w+$/\n        }\n      },\n      model: {\n        key: FONT_COLOR,\n        value: viewElement => viewElement.getAttribute('color')\n      }\n    });\n    editor.conversion.for('downcast').attributeToElement({\n      model: FONT_COLOR,\n      view: renderDowncastElement('color')\n    });\n    editor.commands.add(FONT_COLOR, new FontColorCommand(editor));\n    // Allow the font color attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: FONT_COLOR\n    });\n    editor.model.schema.setAttributeProperties(FONT_COLOR, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n  }\n}\n\n/**\n * The color UI plugin which isolates the common logic responsible for displaying dropdowns with color grids.\n *\n * It is used to create the `'fontBackgroundColor'` and `'fontColor'` dropdowns, each hosting\n * a {@link module:ui/colorselector/colorselectorview~ColorSelectorView}.\n */\nclass ColorUI extends Plugin {\n  /**\n  * The name of the command which will be executed when a color tile is clicked.\n  */\n  commandName;\n  /**\n  * The name of this component in the {@link module:ui/componentfactory~ComponentFactory}.\n  * Also the configuration scope name in `editor.config`.\n  */\n  componentName;\n  /**\n  * The SVG icon used by the dropdown.\n  */\n  icon;\n  /**\n  * The label used by the dropdown.\n  */\n  dropdownLabel;\n  /**\n  * The number of columns in the color grid.\n  */\n  columns;\n  /**\n  * Creates a plugin which introduces a dropdown with a preâ€“configured\n  * {@link module:ui/colorselector/colorselectorview~ColorSelectorView}.\n  *\n  * @param config The configuration object.\n  * @param config.commandName The name of the command which will be executed when a color tile is clicked.\n  * @param config.componentName The name of the dropdown in the {@link module:ui/componentfactory~ComponentFactory}\n  * and the configuration scope name in `editor.config`.\n  * @param config.icon The SVG icon used by the dropdown.\n  * @param config.dropdownLabel The label used by the dropdown.\n  */\n  constructor(editor, {\n    commandName,\n    componentName,\n    icon,\n    dropdownLabel\n  }) {\n    super(editor);\n    this.commandName = commandName;\n    this.componentName = componentName;\n    this.icon = icon;\n    this.dropdownLabel = dropdownLabel;\n    this.columns = editor.config.get(`${this.componentName}.columns`);\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const t = locale.t;\n    const command = editor.commands.get(this.commandName);\n    const componentConfig = editor.config.get(this.componentName);\n    const colorsConfig = normalizeColorOptions(componentConfig.colors);\n    const localizedColors = getLocalizedColorOptions(locale, colorsConfig);\n    const documentColorsCount = componentConfig.documentColors;\n    const hasColorPicker = componentConfig.colorPicker !== false;\n    // Register the UI component.\n    editor.ui.componentFactory.add(this.componentName, locale => {\n      const dropdownView = createDropdown(locale);\n      // Font color dropdown rendering is deferred once it gets open to improve performance (#6192).\n      let dropdownContentRendered = false;\n      const colorSelectorView = addColorSelectorToDropdown({\n        dropdownView,\n        colors: localizedColors.map(option => ({\n          label: option.label,\n          color: option.model,\n          options: {\n            hasBorder: option.hasBorder\n          }\n        })),\n        columns: this.columns,\n        removeButtonLabel: t('Remove color'),\n        colorPickerLabel: t('Color picker'),\n        documentColorsLabel: documentColorsCount !== 0 ? t('Document colors') : '',\n        documentColorsCount: documentColorsCount === undefined ? this.columns : documentColorsCount,\n        colorPickerViewConfig: hasColorPicker ? componentConfig.colorPicker || {} : false\n      });\n      colorSelectorView.bind('selectedColor').to(command, 'value');\n      dropdownView.buttonView.set({\n        label: this.dropdownLabel,\n        icon: this.icon,\n        tooltip: true\n      });\n      dropdownView.extendTemplate({\n        attributes: {\n          class: 'ck-color-ui-dropdown'\n        }\n      });\n      dropdownView.bind('isEnabled').to(command);\n      colorSelectorView.on('execute', (evt, data) => {\n        if (dropdownView.isOpen) {\n          editor.execute(this.commandName, {\n            value: data.value,\n            batch: this._undoStepBatch\n          });\n        }\n        if (data.source !== 'colorPicker') {\n          editor.editing.view.focus();\n        }\n        if (data.source === 'colorPickerSaveButton') {\n          dropdownView.isOpen = false;\n        }\n      });\n      colorSelectorView.on('colorPicker:show', () => {\n        this._undoStepBatch = editor.model.createBatch();\n      });\n      colorSelectorView.on('colorPicker:cancel', () => {\n        if (this._undoStepBatch.operations.length) {\n          // We need to close the dropdown before the undo batch.\n          // Otherwise, ColorUI treats undo as a selected color change,\n          // propagating the update to the whole selection.\n          // That's an issue if spans with various colors were selected.\n          dropdownView.isOpen = false;\n          editor.execute('undo', this._undoStepBatch);\n        }\n        editor.editing.view.focus();\n      });\n      dropdownView.on('change:isOpen', (evt, name, isVisible) => {\n        if (!dropdownContentRendered) {\n          dropdownContentRendered = true;\n          dropdownView.colorSelectorView.appendUI();\n        }\n        if (isVisible) {\n          if (documentColorsCount !== 0) {\n            colorSelectorView.updateDocumentColors(editor.model, this.componentName);\n          }\n          colorSelectorView.updateSelectedColors();\n          colorSelectorView.showColorGridsFragment();\n        }\n      });\n      // Accessibility: focus the first active color when opening the dropdown.\n      focusChildOnDropdownOpen(dropdownView, () => dropdownView.colorSelectorView.colorGridsFragmentView.staticColorsGrid.items.find(item => item.isOn));\n      return dropdownView;\n    });\n    // Register menu bar button..\n    editor.ui.componentFactory.add(`menuBar:${this.componentName}`, locale => {\n      const menuView = new MenuBarMenuView(locale);\n      menuView.buttonView.set({\n        label: this.dropdownLabel,\n        icon: this.icon\n      });\n      menuView.bind('isEnabled').to(command);\n      // Font color sub-menu rendering is deferred once it gets open to improve performance (#6192).\n      let contentRendered = false;\n      const colorSelectorView = new ColorSelectorView(locale, {\n        colors: localizedColors.map(option => ({\n          label: option.label,\n          color: option.model,\n          options: {\n            hasBorder: option.hasBorder\n          }\n        })),\n        columns: this.columns,\n        removeButtonLabel: t('Remove color'),\n        colorPickerLabel: t('Color picker'),\n        documentColorsLabel: documentColorsCount !== 0 ? t('Document colors') : '',\n        documentColorsCount: documentColorsCount === undefined ? this.columns : documentColorsCount,\n        colorPickerViewConfig: false\n      });\n      colorSelectorView.bind('selectedColor').to(command, 'value');\n      colorSelectorView.delegate('execute').to(menuView);\n      colorSelectorView.on('execute', (evt, data) => {\n        editor.execute(this.commandName, {\n          value: data.value,\n          batch: this._undoStepBatch\n        });\n        editor.editing.view.focus();\n      });\n      menuView.on('change:isOpen', (evt, name, isVisible) => {\n        if (!contentRendered) {\n          contentRendered = true;\n          colorSelectorView.appendUI();\n        }\n        if (isVisible) {\n          if (documentColorsCount !== 0) {\n            colorSelectorView.updateDocumentColors(editor.model, this.componentName);\n          }\n          colorSelectorView.updateSelectedColors();\n          colorSelectorView.showColorGridsFragment();\n        }\n      });\n      menuView.panelView.children.add(colorSelectorView);\n      return menuView;\n    });\n  }\n}\n\n/**\n * The font color UI plugin. It introduces the `'fontColor'` dropdown.\n */\nclass FontColorUI extends ColorUI {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    const t = editor.locale.t;\n    super(editor, {\n      commandName: FONT_COLOR,\n      componentName: FONT_COLOR,\n      icon: IconFontColor,\n      dropdownLabel: t('Font Color')\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontColorUI';\n  }\n}\n\n/**\n * The font color plugin.\n *\n * For a detailed overview, check the {@glink features/font font feature} documentation\n * and the {@glink api/font package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:font/fontcolor/fontcolorediting~FontColorEditing} and\n * {@link module:font/fontcolor/fontcolorui~FontColorUI} features in the editor.\n */\nclass FontColor extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FontColorEditing, FontColorUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontColor';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The font background color command. It is used by\n * {@link module:font/fontbackgroundcolor/fontbackgroundcolorediting~FontBackgroundColorEditing}\n * to apply the font background color.\n *\n * ```ts\n * editor.execute( 'fontBackgroundColor', { value: 'rgb(250, 20, 20)' } );\n * ```\n *\n * **Note**: Executing the command with the `null` value removes the attribute from the model.\n */\nclass FontBackgroundColorCommand extends FontCommand {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor, FONT_BACKGROUND_COLOR);\n  }\n}\n\n/**\n * The font background color editing feature.\n *\n * It introduces the {@link module:font/fontbackgroundcolor/fontbackgroundcolorcommand~FontBackgroundColorCommand command} and\n * the `fontBackgroundColor` attribute in the {@link module:engine/model/model~Model model} which renders\n * in the {@link module:engine/view/view view} as a `<span>` element (`<span style=\"background-color: ...\">`),\n * depending on the {@link module:font/fontconfig~FontColorConfig configuration}.\n */\nclass FontBackgroundColorEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontBackgroundColorEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define(FONT_BACKGROUND_COLOR, {\n      colors: [{\n        color: 'hsl(0, 0%, 0%)',\n        label: 'Black'\n      }, {\n        color: 'hsl(0, 0%, 30%)',\n        label: 'Dim grey'\n      }, {\n        color: 'hsl(0, 0%, 60%)',\n        label: 'Grey'\n      }, {\n        color: 'hsl(0, 0%, 90%)',\n        label: 'Light grey'\n      }, {\n        color: 'hsl(0, 0%, 100%)',\n        label: 'White',\n        hasBorder: true\n      }, {\n        color: 'hsl(0, 75%, 60%)',\n        label: 'Red'\n      }, {\n        color: 'hsl(30, 75%, 60%)',\n        label: 'Orange'\n      }, {\n        color: 'hsl(60, 75%, 60%)',\n        label: 'Yellow'\n      }, {\n        color: 'hsl(90, 75%, 60%)',\n        label: 'Light green'\n      }, {\n        color: 'hsl(120, 75%, 60%)',\n        label: 'Green'\n      }, {\n        color: 'hsl(150, 75%, 60%)',\n        label: 'Aquamarine'\n      }, {\n        color: 'hsl(180, 75%, 60%)',\n        label: 'Turquoise'\n      }, {\n        color: 'hsl(210, 75%, 60%)',\n        label: 'Light blue'\n      }, {\n        color: 'hsl(240, 75%, 60%)',\n        label: 'Blue'\n      }, {\n        color: 'hsl(270, 75%, 60%)',\n        label: 'Purple'\n      }],\n      columns: 5\n    });\n    editor.data.addStyleProcessorRules(addBackgroundRules);\n    editor.conversion.for('upcast').elementToAttribute({\n      view: {\n        name: 'span',\n        styles: {\n          'background-color': /[\\s\\S]+/\n        }\n      },\n      model: {\n        key: FONT_BACKGROUND_COLOR,\n        value: renderUpcastAttribute('background-color')\n      }\n    });\n    editor.conversion.for('downcast').attributeToElement({\n      model: FONT_BACKGROUND_COLOR,\n      view: renderDowncastElement('background-color')\n    });\n    editor.commands.add(FONT_BACKGROUND_COLOR, new FontBackgroundColorCommand(editor));\n    // Allow the font backgroundColor attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: FONT_BACKGROUND_COLOR\n    });\n    editor.model.schema.setAttributeProperties(FONT_BACKGROUND_COLOR, {\n      isFormatting: true,\n      copyOnEnter: true\n    });\n  }\n}\n\n/**\n * The font background color UI plugin. It introduces the `'fontBackgroundColor'` dropdown.\n */\nclass FontBackgroundColorUI extends ColorUI {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    const t = editor.locale.t;\n    super(editor, {\n      commandName: FONT_BACKGROUND_COLOR,\n      componentName: FONT_BACKGROUND_COLOR,\n      icon: IconFontBackground,\n      dropdownLabel: t('Font Background Color')\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontBackgroundColorUI';\n  }\n}\n\n/**\n * The font background color plugin.\n *\n * For a detailed overview, check the {@glink features/font font feature} documentation\n * and the {@glink api/font package page}.\n *\n * This is a \"glue\" plugin which loads\n * the {@link module:font/fontbackgroundcolor/fontbackgroundcolorediting~FontBackgroundColorEditing} and\n * {@link module:font/fontbackgroundcolor/fontbackgroundcolorui~FontBackgroundColorUI} features in the editor.\n */\nclass FontBackgroundColor extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FontBackgroundColorEditing, FontBackgroundColorUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FontBackgroundColor';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * A plugin that enables a set of text styling features:\n *\n * * {@link module:font/fontsize~FontSize},\n * * {@link module:font/fontfamily~FontFamily}.\n * * {@link module:font/fontcolor~FontColor},\n * * {@link module:font/fontbackgroundcolor~FontBackgroundColor}.\n *\n * For a detailed overview, check the {@glink features/font Font feature} documentation\n * and the {@glink api/font package page}.\n */\nclass Font extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FontFamily, FontSize, FontColor, FontBackgroundColor];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Font';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { Font, FontBackgroundColor, FontBackgroundColorEditing, FontBackgroundColorUI, FontColor, FontColorEditing, FontColorUI, FontFamily, FontFamilyEditing, FontFamilyUI, FontSize, FontSizeEditing, FontSizeUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { global, createElement, Rect, env } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { ClassicEditor } from '@ckeditor/ckeditor5-editor-classic/dist/index.js';\nimport { DecoupledEditor } from '@ckeditor/ckeditor5-editor-decoupled/dist/index.js';\nimport { BodyCollection, DialogViewPosition, MenuBarView, ButtonView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconFullscreenLeave, IconFullscreenEnter } from '@ckeditor/ckeditor5-icons/dist/index.js';\nconst DIALOG_OFFSET = 28;\n/**\n * The abstract editor type handler. It should be extended by the particular editor type handler.\n */\nclass AbstractEditorHandler {\n  /**\n  * Maps placeholder names to placeholder elements and moved elements.\n  */\n  _placeholderMap;\n  /**\n  * The wrapper element that holds the fullscreen mode layout.\n  */\n  _wrapper = null;\n  /**\n  * The document object in which the editor is located.\n  */\n  _document;\n  /**\n  * Data of the annotations UIs that were active before entering the fullscreen mode.\n  */\n  _annotationsUIsData = null;\n  /**\n  * The pagination body collection that is used in the fullscreen mode.\n  * If we don't move pagination lines to the fullscreen container, they won't be visible.\n  */\n  _paginationBodyCollection = null;\n  /**\n  * A callback that hides the document outline header when the source editing mode is enabled.\n  * Document outline element itself is hidden by source editing plugin.\n  */ /* istanbul ignore next -- @preserve */\n  _sourceEditingCallback = (_evt, _name, value) => {\n    this.getWrapper().querySelector('.ck-fullscreen__document-outline-header').style.display = value ? 'none' : '';\n  };\n  /**\n  * A map of elements that were hidden when entering the fullscreen mode.\n  * It is used to restore their previous visibility when leaving the fullscreen mode and avoid showing elements\n  * that were hidden before entering the fullscreen mode.\n  */\n  _hiddenElements = new Map();\n  /**\n  * A map matching the ancestors of the editable element with their scroll positions before entering fullscreen mode.\n  */\n  _savedAncestorsScrollPositions = new Map();\n  /**\n  * A callback that shows the revision viewer, stored to restore the original one after exiting the fullscreen mode.\n  */\n  _showRevisionViewerCallback = null;\n  /**\n  * A callback that closes the revision viewer, stored to restore the original one after exiting the fullscreen mode.\n  */\n  _closeRevisionViewerCallback = null;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    this._placeholderMap = new Map();\n    if (editor.plugins.has('RevisionHistory')) {\n      this._showRevisionViewerCallback = editor.config.get('revisionHistory').showRevisionViewerCallback;\n      this._closeRevisionViewerCallback = editor.config.get('revisionHistory').closeRevisionViewerCallback;\n    }\n    this._editor = editor;\n    this._document = this._editor.sourceElement ? this._editor.sourceElement.ownerDocument : global.document;\n    this._editor.config.define('fullscreen.container', this._document.body);\n    editor.on('destroy', () => {\n      if (this._wrapper) {\n        this.destroy();\n      }\n    });\n  }\n  /**\n  * Moves the given element to the fullscreen mode container, leaving a placeholder in its place.\n  */\n  moveToFullscreen(elementToMove, placeholderName) {\n    const placeholderElement = createElement(this._document, 'div');\n    placeholderElement.setAttribute('data-ck-fullscreen-placeholder', placeholderName);\n    elementToMove.replaceWith(placeholderElement);\n    this.getWrapper().querySelector(`[data-ck-fullscreen=\"${placeholderName}\"]`).append(elementToMove);\n    this._placeholderMap.set(placeholderName, {\n      placeholderElement,\n      movedElement: elementToMove\n    });\n  }\n  /**\n  * Returns a single moved element to its original place.\n  */\n  restoreMovedElementLocation(placeholderName) {\n    if (!this._placeholderMap.has(placeholderName)) {\n      return;\n    }\n    const {\n      placeholderElement,\n      movedElement\n    } = this._placeholderMap.get(placeholderName);\n    placeholderElement.replaceWith(movedElement);\n    placeholderElement.remove();\n    this._placeholderMap.delete(placeholderName);\n    if (this._placeholderMap.size === 0) {\n      this._destroyContainer();\n    }\n  }\n  /**\n  * Returns the fullscreen mode container element.\n  */\n  getWrapper() {\n    if (!this._wrapper) {\n      this._wrapper = createElement(this._document, 'div', {\n        class: 'ck ck-fullscreen__main-wrapper'\n      });\n      // For now, the container is generated in a very straightforward way. If necessary, it may be rewritten using our UI lib.\n      this._wrapper.innerHTML = `\n\t\t\t\t<div class=\"ck ck-fullscreen__top-wrapper ck-reset_all\">\n\t\t\t\t\t<div class=\"ck ck-fullscreen__menu-bar\" data-ck-fullscreen=\"menu-bar\"></div>\n\t\t\t\t\t<div class=\"ck ck-fullscreen__toolbar\" data-ck-fullscreen=\"toolbar\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ck ck-fullscreen__editable-wrapper\">\n\t\t\t\t\t<div class=\"ck ck-fullscreen__sidebar ck-fullscreen__left-sidebar\" data-ck-fullscreen=\"left-sidebar\">\n\t\t\t\t\t\t<div class=\"ck ck-fullscreen__left-sidebar--sticky\" data-ck-fullscreen=\"left-sidebar-sticky\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ck ck-fullscreen__editable\" data-ck-fullscreen=\"editable\">\n\t\t\t\t\t\t<div class=\"ck ck-fullscreen__pagination-view\" data-ck-fullscreen=\"pagination-view\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ck ck-fullscreen__sidebar ck-fullscreen__right-sidebar\" data-ck-fullscreen=\"right-sidebar\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ck ck-fullscreen__bottom-wrapper\">\n\t\t\t\t\t<div class=\"ck ck-fullscreen__body-wrapper\" data-ck-fullscreen=\"body-wrapper\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n      this._editor.config.get('fullscreen.container').appendChild(this._wrapper);\n    }\n    return this._wrapper;\n  }\n  /**\n  * Enables the fullscreen mode. It executes the editor-specific enable handler and then the configured callback.\n  */\n  enable() {\n    this._saveAncestorsScrollPositions(this._editor.ui.getEditableElement());\n    this._defaultOnEnter();\n    // Block scroll if the fullscreen container is the body element. Otherwise the document has to stay scrollable.\n    if (this._editor.config.get('fullscreen.container') === this._document.body) {\n      this._document.body.classList.add('ck-fullscreen');\n      this._document.body.parentElement.classList.add('ck-fullscreen');\n    }\n    if (this._editor.plugins.has('Dialog')) {\n      this._registerFullscreenDialogPositionAdjustments();\n    }\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore if -- @preserve */\n    if (this._editor.plugins.has('PresenceListUI')) {\n      this._generatePresenceListContainer();\n    }\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore if -- @preserve */\n    if (this._editor.plugins.has('DocumentOutlineUI')) {\n      this._generateDocumentOutlineContainer();\n    }\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore next -- @preserve */\n    if (this._editor.plugins.has('Pagination') && this._editor.plugins.get('Pagination').isEnabled) {\n      const paginationRenderer = this._editor.plugins.get('PaginationRenderer');\n      paginationRenderer.setupScrollableAncestor();\n      this._paginationBodyCollection = new BodyCollection(this._editor.locale);\n      this._paginationBodyCollection.attachToDom();\n      paginationRenderer.linesRepository.setViewCollection(this._paginationBodyCollection);\n      this._editor.once('destroy', () => {\n        this._paginationBodyCollection.detachFromDom();\n      });\n      this.moveToFullscreen(this._paginationBodyCollection.bodyCollectionContainer, 'body-wrapper');\n    }\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore if -- @preserve */\n    if (this._editor.plugins.has('AnnotationsUIs')) {\n      this._overrideAnnotationsUIs();\n    }\n    if (this._editor.plugins.has('RevisionHistory')) {\n      // Code coverage is provided in the commercial package repository as integration unit tests.\n      /* istanbul ignore if -- @preserve */\n      if (this._editor.plugins.get('RevisionHistory').isRevisionViewerOpen) {\n        // Keep in mind that closing the revision history viewer is an asynchronous operation.\n        this._editor.config.get('revisionHistory.closeRevisionViewerCallback')();\n      }\n      this._overrideRevisionHistoryCallbacks();\n    }\n    if (this._editor.plugins.has('SourceEditing') && this._editor.plugins.has('DocumentOutlineUI')) {\n      this._editor.plugins.get('SourceEditing').on('change:isSourceEditingMode', this._sourceEditingCallback);\n    }\n    // Hide all other elements in the container to ensure they don't create an empty unscrollable space.\n    for (const element of this._editor.config.get('fullscreen.container').children) {\n      // Do not hide body wrapper and ckbox wrapper to keep dialogs, balloons etc visible.\n      if (element !== this._wrapper && !element.classList.contains('ck-body-wrapper') && !element.classList.contains('ckbox-wrapper') &&\n      // Already hidden elements are not hidden again to avoid accidentally showing them after leaving fullscreen.\n      element.style.display !== 'none') {\n        this._hiddenElements.set(element, element.style.display);\n        element.style.display = 'none';\n      }\n    }\n    if (this._editor.config.get('fullscreen.onEnterCallback')) {\n      this._editor.config.get('fullscreen.onEnterCallback')(this.getWrapper());\n    }\n  }\n  /**\n  * Disables the fullscreen mode by restoring all moved elements and destroying the fullscreen container.\n  */\n  disable() {\n    if (this._editor.config.get('fullscreen.onLeaveCallback')) {\n      this._editor.config.get('fullscreen.onLeaveCallback')(this.getWrapper());\n    }\n    this._document.body.classList.remove('ck-fullscreen');\n    this._document.body.parentElement.classList.remove('ck-fullscreen');\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore if -- @preserve */\n    if (this._editor.plugins.has('DocumentOutlineUI')) {\n      this._restoreDocumentOutlineDefaultContainer();\n    }\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore if -- @preserve */\n    if (this._annotationsUIsData) {\n      this._restoreAnnotationsUIs();\n    }\n    if (this._editor.plugins.has('RevisionHistory')) {\n      this._restoreRevisionHistoryCallbacks();\n    }\n    if (this._editor.plugins.has('SourceEditing') && this._editor.plugins.has('DocumentOutlineUI')) {\n      this._editor.plugins.get('SourceEditing').off('change:isSourceEditingMode', this._sourceEditingCallback);\n    }\n    for (const placeholderName of this._placeholderMap.keys()) {\n      this.restoreMovedElementLocation(placeholderName);\n    }\n    this._editor.ui.view.toolbar.switchBehavior(this._editor.config.get('toolbar.shouldNotGroupWhenFull') === true ? 'static' : 'dynamic');\n    if (this._placeholderMap.size === 0) {\n      this._destroyContainer();\n    }\n    // Restore scroll positions of all ancestors. It may include the closest editable wrapper causing the editor to change\n    // the visible content, which is not what we want. Thus, after executing the command, we use\n    // `editor.editing.view.scrollToTheSelection()` to scroll the editor viewport to the current selection.\n    for (const [ancestor, value] of this._savedAncestorsScrollPositions) {\n      ancestor.scrollTo(value.scrollLeft, value.scrollTop);\n    }\n    this._savedAncestorsScrollPositions.clear();\n    // Pagination has to be restored after leaving fullscreen mode to ensure proper rendering.\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore next -- @preserve */\n    if (this._editor.plugins.has('Pagination') && this._editor.plugins.get('Pagination').isEnabled) {\n      const paginationRenderer = this._editor.plugins.get('PaginationRenderer');\n      paginationRenderer.setupScrollableAncestor();\n      paginationRenderer.linesRepository.setViewCollection(this._editor.ui.view.body);\n      this._paginationBodyCollection.detachFromDom();\n      this._paginationBodyCollection?.destroy();\n    }\n    // Also dialog position needs to be recalculated after leaving fullscreen mode.\n    if (this._editor.plugins.has('Dialog')) {\n      this._unregisterFullscreenDialogPositionAdjustments();\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    for (const {\n      placeholderElement,\n      movedElement\n    } of this._placeholderMap.values()) {\n      placeholderElement.remove();\n      movedElement.remove();\n    }\n    this._destroyContainer();\n    this._document.body.classList.remove('ck-fullscreen');\n    this._document.body.parentElement.classList.remove('ck-fullscreen');\n  }\n  /**\n  * A function that moves the editor UI elements to the fullscreen mode. It should be set by the particular editor type handler.\n  *\n  * Returns the fullscreen mode container element so it can be further customized via\n  * `fullscreen.onEnterCallback` configuration property.\n  */\n  _defaultOnEnter() {\n    return this.getWrapper();\n  }\n  /**\n  * Destroys the fullscreen mode container.\n  */\n  _destroyContainer() {\n    if (!this._wrapper) {\n      return;\n    }\n    this._wrapper.remove();\n    this._wrapper = null;\n    // Restore visibility of all other elements in the container.\n    for (const [element, displayValue] of this._hiddenElements) {\n      element.style.display = displayValue;\n    }\n    this._hiddenElements.clear();\n  }\n  /**\n  * Checks if the PresenceListUI plugin is available and moves its elements to fullscreen mode.\n  */ // Code coverage is provided in the commercial package repository as integration unit tests.\n  /* istanbul ignore next -- @preserve */\n  _generatePresenceListContainer() {\n    const t = this._editor.t;\n    const presenceListElement = createElement(document, 'div', {\n      class: 'ck ck-fullscreen__left-sidebar-item'\n    });\n    presenceListElement.innerHTML = `\n\t\t\t<div class=\"ck ck-fullscreen__left-sidebar-header\"></div>\n\t\t\t<div class=\"ck ck-fullscreen__presence-list\" data-ck-fullscreen=\"presence-list\"></div>\n\t\t`;\n    presenceListElement.firstElementChild.innerText = t('Connected users');\n    document.querySelector('[data-ck-fullscreen=\"left-sidebar-sticky\"]').appendChild(presenceListElement);\n    const presenceListUI = this._editor.plugins.get('PresenceListUI');\n    this.moveToFullscreen(presenceListUI.view.element, 'presence-list');\n  }\n  /**\n  * Checks if the DocumentOutlineUI plugin is available and moves its elements to fullscreen mode.\n  */ // Code coverage is provided in the commercial package repository as integration unit tests.\n  /* istanbul ignore next -- @preserve */\n  _generateDocumentOutlineContainer() {\n    const t = this._editor.t;\n    const documentOutlineHeaderElement = createElement(document, 'div', {\n      class: 'ck-fullscreen__left-sidebar-item ck-fullscreen__left-sidebar-item--no-margin'\n    });\n    documentOutlineHeaderElement.innerHTML = `\n\t\t\t<div class=\"ck ck-fullscreen__left-sidebar-header ck-fullscreen__document-outline-header\"></div>\n\t\t`;\n    documentOutlineHeaderElement.firstElementChild.innerText = t('Document outline');\n    const documentOutlineBodyWrapper = createElement(document, 'div', {\n      class: 'ck ck-fullscreen__left-sidebar-item ck-fullscreen__document-outline-wrapper'\n    });\n    documentOutlineBodyWrapper.innerHTML = `\n\t\t\t<div class=\"ck ck-fullscreen__document-outline\" data-ck-fullscreen=\"document-outline\"></div>\n\t\t`;\n    document.querySelector('[data-ck-fullscreen=\"left-sidebar\"]').appendChild(documentOutlineBodyWrapper);\n    document.querySelector('[data-ck-fullscreen=\"left-sidebar-sticky\"]').appendChild(documentOutlineHeaderElement);\n    const documentOutlineUI = this._editor.plugins.get('DocumentOutlineUI');\n    documentOutlineUI.view.documentOutlineContainer = document.querySelector('[data-ck-fullscreen=\"left-sidebar\"]');\n    this.moveToFullscreen(documentOutlineUI.view.element, 'document-outline');\n  }\n  /**\n  * Restores the default value of documentOutlineContainer, which is modified in fullscreen mode.\n  */ // Code coverage is provided in the commercial package repository as integration unit tests.\n  /* istanbul ignore next -- @preserve */\n  _restoreDocumentOutlineDefaultContainer() {\n    const documentOutlineUI = this._editor.plugins.get('DocumentOutlineUI');\n    documentOutlineUI.view.documentOutlineContainer = documentOutlineUI.view.element;\n  }\n  /**\n  * Stores the current state of the annotations UIs to restore it when leaving fullscreen mode.\n  */ // Code coverage is provided in the commercial package repository as integration unit tests.\n  /* istanbul ignore next -- @preserve */\n  _overrideAnnotationsUIs() {\n    const annotationsUIs = this._editor.plugins.get('AnnotationsUIs');\n    this._annotationsUIsData = new Map(annotationsUIs.uisData);\n    // Switch to the wide sidebar.\n    const sidebarPlugin = this._editor.plugins.get('Sidebar');\n    if (!sidebarPlugin.container) {\n      sidebarPlugin.setContainer(this.getWrapper().querySelector('[data-ck-fullscreen=\"right-sidebar\"]'));\n    }\n    const annotationsFilters = new Map();\n    for (const [uiName, data] of [...this._annotationsUIsData]) {\n      // Default filter is `() => true`. Only store filters that are different.\n      if (data.filter !== annotationsUIs.defaultFilter) {\n        annotationsFilters.set(uiName, data.filter);\n      }\n    }\n    annotationsUIs.deactivateAll();\n    // Check if someone has a filter defined for `wideSidebar`. If so, retrieve and apply it in fullscreen. Do not show any other UI.\n    if (annotationsFilters.has('wideSidebar')) {\n      annotationsUIs.activate('wideSidebar', annotationsFilters.get('wideSidebar'));\n    } else if (annotationsFilters.size) {\n      annotationsUIs.activate('wideSidebar', annotation => [...annotationsFilters.values()].some(filter => filter(annotation)));\n    } else {\n      annotationsUIs.switchTo('wideSidebar');\n    }\n    this.moveToFullscreen(sidebarPlugin.container.firstElementChild, 'right-sidebar');\n  }\n  /**\n  * Restores the saved state of the annotations UIs.\n  */ // Code coverage is provided in the commercial package repository as integration unit tests.\n  /* istanbul ignore next -- @preserve */\n  _restoreAnnotationsUIs() {\n    const annotationsUIs = this._editor.plugins.get('AnnotationsUIs');\n    annotationsUIs.deactivateAll();\n    for (const [uiName, data] of [...this._annotationsUIsData]) {\n      annotationsUIs.activate(uiName, data.filter);\n    }\n    this._annotationsUIsData = null;\n  }\n  /**\n  * Modifies the revision history viewer callbacks to display the viewer in the fullscreen mode.\n  */\n  _overrideRevisionHistoryCallbacks() {\n    // * Hide editor's editable, toolbar and sidebar;\n    // * Disable menu bar;\n    // * Show revision viewer editable, toolbar and sidebar.\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore next -- @preserve */\n    this._editor.config.set('revisionHistory.showRevisionViewerCallback', async () => {\n      const revisionViewerEditor = await this._showRevisionViewerCallback();\n      if (this._editor.plugins.has('DocumentOutlineUI')) {\n        this.getWrapper().querySelector('.ck-fullscreen__document-outline-header').style.display = 'none';\n      }\n      this.restoreMovedElementLocation('editable');\n      this.restoreMovedElementLocation('toolbar');\n      this.restoreMovedElementLocation('right-sidebar');\n      if (this._annotationsUIsData) {\n        this._restoreAnnotationsUIs();\n      }\n      if (this._editor.ui.view.menuBarView) {\n        this._editor.ui.view.menuBarView.disable();\n      }\n      this.moveToFullscreen(revisionViewerEditor.ui.getEditableElement(), 'editable');\n      this.moveToFullscreen(revisionViewerEditor.ui.view.toolbar.element, 'toolbar');\n      this.moveToFullscreen(this._editor.config.get('revisionHistory.viewerSidebarContainer'), 'right-sidebar');\n      return revisionViewerEditor;\n    });\n    // * Hide revision viewer editable, toolbar and sidebar;\n    // * Enable menu bar;\n    // * Show editor's editable, toolbar and sidebar.\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore next -- @preserve */\n    this._editor.config.set('revisionHistory.closeRevisionViewerCallback', async () => {\n      this.restoreMovedElementLocation('toolbar');\n      this.restoreMovedElementLocation('editable');\n      this.restoreMovedElementLocation('right-sidebar');\n      if (this._editor.plugins.has('DocumentOutlineUI')) {\n        this.getWrapper().querySelector('.ck-fullscreen__document-outline-header').style.display = '';\n      }\n      this.moveToFullscreen(this._editor.ui.getEditableElement(), 'editable');\n      this.moveToFullscreen(this._editor.ui.view.toolbar.element, 'toolbar');\n      await this._closeRevisionViewerCallback();\n      if (this._editor.plugins.has('AnnotationsUIs')) {\n        this._overrideAnnotationsUIs();\n      }\n      if (this._editor.ui.view.menuBarView) {\n        this._editor.ui.view.menuBarView.enable();\n      }\n    });\n  }\n  /**\n  * Resets the revision history viewer callbacks to their original values.\n  */\n  _restoreRevisionHistoryCallbacks() {\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore next -- @preserve */\n    this._editor.config.set('revisionHistory.showRevisionViewerCallback', async () => {\n      return this._showRevisionViewerCallback();\n    });\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore next -- @preserve */\n    this._editor.config.set('revisionHistory.closeRevisionViewerCallback', async () => {\n      return this._closeRevisionViewerCallback();\n    });\n  }\n  /**\n  * Adds an event listener when the dialog opens to adjust its position in fullscreen mode,\n  * utilizing the empty space on the right side of the editable element.\n  */\n  _registerFullscreenDialogPositionAdjustments() {\n    const dialog = this._editor.plugins.get('Dialog');\n    this._setNewDialogPosition();\n    dialog.on('change:isOpen', this.updateDialogPositionCallback, {\n      priority: 'highest'\n    });\n  }\n  /**\n  * Removes an event listener that adjusts the dialog's position in fullscreen mode.\n  */\n  _unregisterFullscreenDialogPositionAdjustments() {\n    const dialog = this._editor.plugins.get('Dialog');\n    const dialogView = dialog.view;\n    if (dialogView && dialogView.position === null) {\n      dialogView.position = DialogViewPosition.EDITOR_TOP_SIDE;\n    }\n    if (dialogView) {\n      dialogView.updatePosition();\n    }\n    dialog.off('change:isOpen', this.updateDialogPositionCallback);\n  }\n  /**\n  * Stores a bound reference to the _updateDialogPosition method, allowing it to be attached and detached from change event.\n  */\n  updateDialogPositionCallback = this._updateDialogPosition.bind(this);\n  /**\n  * If dialog is open, adjust its positioning.\n  */\n  _updateDialogPosition(_evt, _name, isOpen) {\n    if (isOpen) {\n      this._setNewDialogPosition();\n    }\n  }\n  /**\n  * Adjusts the dialog position to utilize the empty space on the right side of the editable.\n  * The new dialog position should be on the right side of the fullscreen view with a 30px margin.\n  * Only dialogs with the position set to \"editor-top-side\" should have their position changed.\n  */\n  _setNewDialogPosition() {\n    const dialog = this._editor.plugins.get('Dialog');\n    const dialogView = dialog.view;\n    if (!dialogView || dialogView.position !== DialogViewPosition.EDITOR_TOP_SIDE) {\n      return;\n    }\n    const fullscreenViewContainerRect = new Rect(this._wrapper).getVisible();\n    const editorContainerRect = new Rect(document.querySelector('.ck-fullscreen__editable')).getVisible();\n    const dialogRect = new Rect(dialogView.element.querySelector('.ck-dialog')).getVisible();\n    const scrollOffset = new Rect(document.querySelector('.ck-fullscreen__editable-wrapper')).excludeScrollbarsAndBorders().getVisible().width - new Rect(document.querySelector('.ck-fullscreen__editable-wrapper')).getVisible().width;\n    if (fullscreenViewContainerRect && editorContainerRect && dialogRect) {\n      dialogView.position = null;\n      dialogView.moveTo(fullscreenViewContainerRect.left + fullscreenViewContainerRect.width - dialogRect.width - DIALOG_OFFSET + scrollOffset, editorContainerRect.top);\n    }\n  }\n  /**\n  * Saves the scroll positions of all ancestors of the given element.\n  */\n  _saveAncestorsScrollPositions(domElement) {\n    let element = domElement.parentElement;\n    if (!element) {\n      return;\n    }\n    while (element) {\n      const overflowY = element.style.overflowY || global.window.getComputedStyle(element).overflowY;\n      const overflowX = element.style.overflowX || global.window.getComputedStyle(element).overflowX;\n      // Out of 5 possible keyword values: visible, hidden, clip, scroll and auto - only the last two allow for scrolling.\n      if (overflowY === 'auto' || overflowY === 'scroll' || overflowX === 'auto' || overflowX === 'scroll') {\n        this._savedAncestorsScrollPositions.set(element, {\n          scrollLeft: element.scrollLeft,\n          scrollTop: element.scrollTop\n        });\n      } else if (element.tagName === 'HTML') {\n        this._savedAncestorsScrollPositions.set(element, {\n          scrollLeft: element.scrollLeft,\n          scrollTop: element.scrollTop\n        });\n      }\n      element = element.parentElement;\n    }\n  }\n}\n\n/**\n * The classic editor fullscreen mode handler.\n */\nclass ClassicEditorHandler extends AbstractEditorHandler {\n  /**\n  * An editor instance.\n  */\n  _editor;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._editor = editor;\n  }\n  /**\n  * A function that moves the editor UI elements to the fullscreen mode.\n  */\n  _defaultOnEnter() {\n    const editorUI = this._editor.ui;\n    const editorUIView = editorUI.view;\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore next -- @preserve */\n    if (this._editor.plugins.has('Pagination') && this._editor.plugins.get('Pagination').isEnabled) {\n      this.moveToFullscreen(editorUI.getEditableElement().parentElement.querySelector('.ck-pagination-view'), 'pagination-view');\n    }\n    this.moveToFullscreen(editorUI.getEditableElement(), 'editable');\n    this.moveToFullscreen(editorUIView.toolbar.element, 'toolbar');\n    editorUIView.toolbar.switchBehavior(this._editor.config.get('fullscreen.toolbar.shouldNotGroupWhenFull') === true ? 'static' : 'dynamic');\n    // In classic editor, the `dir` attribute is set on the top-level container and it affects the styling\n    // in both menu bar and toolbar (adding the side padding to the elements).\n    // Since we don't move the whole container but only parts, we need to reapply the attribute value manually.\n    // Decupled editor doesn't have this issue because there is no top-level container,\n    // so `dir` attribute is set on each component separately.\n    this.getWrapper().setAttribute('dir', editorUIView.element.getAttribute('dir'));\n    // The `ck-rounded-corners` class is added to the wrapper element to ensure that the corners in menu bar, toolbar etc are rounded\n    // when the editor is in fullscreen mode.\n    // Decupled editor doesn't have this issue because there is no top-level container,\n    // so `ck-rounded-corners` class is set on each component separately.\n    this.getWrapper().classList.add('ck-rounded-corners');\n    if (this._editor.config.get('fullscreen.menuBar.isVisible')) {\n      if (!editorUIView.menuBarView) {\n        editorUIView.menuBarView = new MenuBarView(this._editor.locale);\n        editorUIView.menuBarView.render();\n        editorUI.initMenuBar(editorUIView.menuBarView);\n      }\n      this.moveToFullscreen(editorUIView.menuBarView.element, 'menu-bar');\n    }\n    return this.getWrapper();\n  }\n}\n\n/**\n * The decoupled editor fullscreen mode handler.\n */\nclass DecoupledEditorHandler extends AbstractEditorHandler {\n  /**\n  * An editor instance.\n  */\n  _editor;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._editor = editor;\n  }\n  /**\n  * A function that moves the editor UI elements to the fullscreen mode.\n  */\n  _defaultOnEnter() {\n    // Code coverage is provided in the commercial package repository as integration unit tests.\n    /* istanbul ignore next -- @preserve */\n    if (this._editor.plugins.has('Pagination') && this._editor.plugins.get('Pagination').isEnabled) {\n      this.moveToFullscreen(this._editor.ui.getEditableElement().parentElement.querySelector('.ck-pagination-view'), 'pagination-view');\n    }\n    this.moveToFullscreen(this._editor.ui.getEditableElement(), 'editable');\n    this.moveToFullscreen(this._editor.ui.view.toolbar.element, 'toolbar');\n    this._editor.ui.view.toolbar.switchBehavior(this._editor.config.get('fullscreen.toolbar.shouldNotGroupWhenFull') === true ? 'static' : 'dynamic');\n    if (this._editor.config.get('fullscreen.menuBar.isVisible')) {\n      this.moveToFullscreen(this._editor.ui.view.menuBarView.element, 'menu-bar');\n    }\n    return this.getWrapper();\n  }\n}\n\n/**\n * A command toggling the fullscreen mode.\n */\nclass FullscreenCommand extends Command {\n  /**\n  * Specialized class handling the fullscreen mode toggling for a specific editor type.\n  */\n  _fullscreenHandler;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this.affectsData = false;\n    this.isEnabled = true;\n    this.value = false;\n    // Choose the appropriate handler based on the editor type.\n    // Currently only ClassicEditor and DecoupledEditor are supported. For other editor types, the abstract handler is used\n    // which will throw if user tries to enable the fullscreen mode.\n    if (editor instanceof ClassicEditor) {\n      this._fullscreenHandler = new ClassicEditorHandler(editor);\n    } else if (editor instanceof DecoupledEditor) {\n      this._fullscreenHandler = new DecoupledEditorHandler(editor);\n    } else {\n      this._fullscreenHandler = new AbstractEditorHandler(editor);\n    }\n  }\n  /**\n  * Toggles the fullscreen mode.\n  */\n  execute() {\n    if (this.value) {\n      this._disableFullscreenMode();\n    } else {\n      this._enableFullscreenMode();\n    }\n  }\n  /**\n  * Enables the fullscreen mode.\n  */\n  _enableFullscreenMode() {\n    this._fullscreenHandler.enable();\n    this.value = true;\n  }\n  /**\n  * Disables the fullscreen mode.\n  */\n  _disableFullscreenMode() {\n    this._fullscreenHandler.disable();\n    this.value = false;\n  }\n}\n\n/**\n * A plugin that registers the fullscreen mode command.\n */\nclass FullscreenEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FullscreenEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('fullscreen.menuBar.isVisible', true);\n    // By default, toolbar should behave the same way in fullscreen mode as in normal mode.\n    // This means that the toolbar buttons should be grouped when the toolbar is full.\n    editor.config.define('fullscreen.toolbar.shouldNotGroupWhenFull', editor.config.get('toolbar.shouldNotGroupWhenFull') === true);\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    this.editor.commands.add('toggleFullscreen', new FullscreenCommand(this.editor));\n    const t = this.editor.locale.t;\n    // Set the Ctrl+Shift+F keystroke.\n    this.editor.keystrokes.set('Ctrl+Shift+F', (evt, cancel) => {\n      this.editor.execute('toggleFullscreen');\n      // On non-Chromium browsers, the editor view and toolbar are not blurred properly after moving the editable,\n      // even though the `document.activeElement` is changed. Hence we need to blur them manually.\n      // Fixes https://github.com/ckeditor/ckeditor5/issues/18250 and https://github.com/ckeditor/ckeditor5/issues/18247.\n      if (!env.isBlink) {\n        this.editor.editing.view.document.isFocused = false;\n        this.editor.ui.view.toolbar.focusTracker.focusedElement = null;\n      }\n      // The order of scroll and focus is not important here.\n      this.editor.editing.view.scrollToTheSelection();\n      this.editor.editing.view.focus();\n      cancel();\n    });\n    // Add the information about the keystroke to the accessibility database.\n    this.editor.accessibility.addKeystrokeInfos({\n      keystrokes: [{\n        label: t('Toggle fullscreen mode'),\n        keystroke: 'CTRL+SHIFT+F'\n      }],\n      categoryId: 'navigation'\n    });\n  }\n}\nconst COMMAND_NAME = 'toggleFullscreen';\n/**\n * A plugin registering the fullscreen mode buttons.\n */\nclass FullscreenUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FullscreenEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FullscreenUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('fullscreen', () => this._createButton(ButtonView));\n    editor.ui.componentFactory.add('menuBar:fullscreen', () => this._createButton(MenuBarMenuListItemButtonView));\n  }\n  /**\n  * Creates a button that toggles the fullscreen mode.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const t = editor.t;\n    const command = editor.commands.get(COMMAND_NAME);\n    const view = new ButtonClass(editor.locale);\n    view.set({\n      isToggleable: true\n    });\n    view.bind('isEnabled').to(command, 'isEnabled');\n    view.bind('isOn').to(command, 'value');\n    if (view instanceof MenuBarMenuListItemButtonView) {\n      view.set({\n        role: 'menuitemcheckbox',\n        label: t('Fullscreen mode')\n      });\n    } else {\n      view.bind('icon').to(command, 'value', value => value ? IconFullscreenLeave : IconFullscreenEnter);\n      view.bind('label').to(command, 'value', value => value ? t('Leave fullscreen mode') : t('Enter fullscreen mode'));\n      view.set({\n        tooltip: true\n      });\n    }\n    this.listenTo(view, 'execute', () => {\n      editor.execute(COMMAND_NAME);\n      // On non-Chromium browsers, toolbar is not blurred properly after moving the editable,\n      // even though the `document.activeElement` is changed. Hence we need to blur the view manually.\n      // Fixes https://github.com/ckeditor/ckeditor5/issues/18250 and https://github.com/ckeditor/ckeditor5/issues/18247.\n      if (!env.isBlink) {\n        this.editor.ui.view.toolbar.focusTracker.focusedElement = null;\n      }\n      // The order of scroll and focus is not important here.\n      editor.editing.view.scrollToTheSelection();\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n}\n\n/**\n * The fullscreen mode feature.\n */\nclass Fullscreen extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FullscreenEditing, FullscreenUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Fullscreen';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { Fullscreen, FullscreenEditing, FullscreenUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Paragraph } from '@ckeditor/ckeditor5-paragraph/dist/index.js';\nimport { first, priorities, Collection } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { ViewModel, createDropdown, addListToDropdown, MenuBarMenuView, MenuBarMenuListView, MenuBarMenuListItemView, MenuBarMenuListItemButtonView, ButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconHeading6, IconHeading5, IconHeading4, IconHeading3, IconHeading2, IconHeading1 } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { DowncastWriter, enablePlaceholder, hidePlaceholder, needsPlaceholder, showPlaceholder } from '@ckeditor/ckeditor5-engine/dist/index.js';\n\n/**\n * The heading command. It is used by the {@link module:heading/heading~Heading heading feature} to apply headings.\n */\nclass HeadingCommand extends Command {\n  /**\n  * Set of defined model's elements names that this command support.\n  * See {@link module:heading/headingconfig~HeadingOption}.\n  */\n  modelElements;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor Editor instance.\n  * @param modelElements Names of the element which this command can apply in the model.\n  */\n  constructor(editor, modelElements) {\n    super(editor);\n    this.modelElements = modelElements;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const block = first(this.editor.model.document.selection.getSelectedBlocks());\n    this.value = !!block && this.modelElements.includes(block.name) && block.name;\n    this.isEnabled = !!block && this.modelElements.some(heading => checkCanBecomeHeading(block, heading, this.editor.model.schema));\n  }\n  /**\n  * Executes the command. Applies the heading to the selected blocks or, if the first selected\n  * block is a heading already, turns selected headings (of this level only) to paragraphs.\n  *\n  * @param options.value Name of the element which this command will apply in the model.\n  * @fires execute\n  */\n  execute(options) {\n    const model = this.editor.model;\n    const document = model.document;\n    const modelElement = options.value;\n    model.change(writer => {\n      const blocks = Array.from(document.selection.getSelectedBlocks()).filter(block => {\n        return checkCanBecomeHeading(block, modelElement, model.schema);\n      });\n      for (const block of blocks) {\n        if (!block.is('element', modelElement)) {\n          writer.rename(block, modelElement);\n        }\n      }\n    });\n  }\n}\n/**\n * Checks whether the given block can be replaced by a specific heading.\n *\n * @param block A block to be tested.\n * @param heading Command element name in the model.\n * @param schema The schema of the document.\n */\nfunction checkCanBecomeHeading(block, heading, schema) {\n  return schema.checkChild(block.parent, heading) && !schema.isObject(block);\n}\nconst defaultModelElement = 'paragraph';\n/**\n * The headings engine feature. It handles switching between block formats &ndash; headings and paragraph.\n * This class represents the engine part of the heading feature. See also {@link module:heading/heading~Heading}.\n * It introduces `heading1`-`headingN` commands which allow to convert paragraphs into headings.\n */\nclass HeadingEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HeadingEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('heading', {\n      options: [{\n        model: 'paragraph',\n        title: 'Paragraph',\n        class: 'ck-heading_paragraph'\n      }, {\n        model: 'heading1',\n        view: 'h2',\n        title: 'Heading 1',\n        class: 'ck-heading_heading1'\n      }, {\n        model: 'heading2',\n        view: 'h3',\n        title: 'Heading 2',\n        class: 'ck-heading_heading2'\n      }, {\n        model: 'heading3',\n        view: 'h4',\n        title: 'Heading 3',\n        class: 'ck-heading_heading3'\n      }]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Paragraph];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const options = editor.config.get('heading.options');\n    const modelElements = [];\n    for (const option of options) {\n      // Skip paragraph - it is defined in required Paragraph feature.\n      if (option.model === 'paragraph') {\n        continue;\n      }\n      // Schema.\n      editor.model.schema.register(option.model, {\n        inheritAllFrom: '$block'\n      });\n      editor.conversion.elementToElement(option);\n      modelElements.push(option.model);\n    }\n    this._addDefaultH1Conversion(editor);\n    // Register the heading command for this option.\n    editor.commands.add('heading', new HeadingCommand(editor, modelElements));\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    // If the enter command is added to the editor, alter its behavior.\n    // Enter at the end of a heading element should create a paragraph.\n    const editor = this.editor;\n    const enterCommand = editor.commands.get('enter');\n    const options = editor.config.get('heading.options');\n    if (enterCommand) {\n      this.listenTo(enterCommand, 'afterExecute', (evt, data) => {\n        const positionParent = editor.model.document.selection.getFirstPosition().parent;\n        const isHeading = options.some(option => positionParent.is('element', option.model));\n        if (isHeading && !positionParent.is('element', defaultModelElement) && positionParent.childCount === 0) {\n          data.writer.rename(positionParent, defaultModelElement);\n        }\n      });\n    }\n  }\n  /**\n  * Adds default conversion for `h1` -> `heading1` with a low priority.\n  *\n  * @param editor Editor instance on which to add the `h1` conversion.\n  */\n  _addDefaultH1Conversion(editor) {\n    editor.conversion.for('upcast').elementToElement({\n      model: 'heading1',\n      view: 'h1',\n      // With a `low` priority, `paragraph` plugin autoparagraphing mechanism is executed. Make sure\n      // this listener is called before it. If not, `h1` will be transformed into a paragraph.\n      converterPriority: priorities.low + 1\n    });\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module heading/utils\n    */ /**\n       * Returns heading options as defined in `config.heading.options` but processed to consider\n       * the editor localization, i.e. to display {@link module:heading/headingconfig~HeadingOption}\n       * in the correct language.\n       *\n       * Note: The reason behind this method is that there is no way to use {@link module:utils/locale~Locale#t}\n       * when the user configuration is defined because the editor does not exist yet.\n       */\nfunction getLocalizedOptions(editor) {\n  const t = editor.t;\n  const localizedTitles = {\n    'Paragraph': t('Paragraph'),\n    'Heading 1': t('Heading 1'),\n    'Heading 2': t('Heading 2'),\n    'Heading 3': t('Heading 3'),\n    'Heading 4': t('Heading 4'),\n    'Heading 5': t('Heading 5'),\n    'Heading 6': t('Heading 6')\n  };\n  return editor.config.get('heading.options').map(option => {\n    const title = localizedTitles[option.title];\n    if (title && title != option.title) {\n      option.title = title;\n    }\n    return option;\n  });\n}\n\n/**\n * The headings UI feature. It introduces the `headings` dropdown.\n */\nclass HeadingUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HeadingUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const options = getLocalizedOptions(editor);\n    const defaultTitle = t('Choose heading');\n    const accessibleLabel = t('Heading');\n    // Register UI component.\n    editor.ui.componentFactory.add('heading', locale => {\n      const titles = {};\n      const itemDefinitions = new Collection();\n      const headingCommand = editor.commands.get('heading');\n      const paragraphCommand = editor.commands.get('paragraph');\n      const commands = [headingCommand];\n      for (const option of options) {\n        const def = {\n          type: 'button',\n          model: new ViewModel({\n            label: option.title,\n            class: option.class,\n            role: 'menuitemradio',\n            withText: true\n          })\n        };\n        if (option.model === 'paragraph') {\n          def.model.bind('isOn').to(paragraphCommand, 'value');\n          def.model.set('commandName', 'paragraph');\n          commands.push(paragraphCommand);\n        } else {\n          def.model.bind('isOn').to(headingCommand, 'value', value => value === option.model);\n          def.model.set({\n            commandName: 'heading',\n            commandValue: option.model\n          });\n        }\n        // Add the option to the collection.\n        itemDefinitions.add(def);\n        titles[option.model] = option.title;\n      }\n      const dropdownView = createDropdown(locale);\n      addListToDropdown(dropdownView, itemDefinitions, {\n        ariaLabel: accessibleLabel,\n        role: 'menu'\n      });\n      dropdownView.buttonView.set({\n        ariaLabel: accessibleLabel,\n        ariaLabelledBy: undefined,\n        isOn: false,\n        withText: true,\n        tooltip: accessibleLabel\n      });\n      dropdownView.extendTemplate({\n        attributes: {\n          class: ['ck-heading-dropdown']\n        }\n      });\n      dropdownView.bind('isEnabled').toMany(commands, 'isEnabled', (...areEnabled) => {\n        return areEnabled.some(isEnabled => isEnabled);\n      });\n      dropdownView.buttonView.bind('label').to(headingCommand, 'value', paragraphCommand, 'value', (heading, paragraph) => {\n        const whichModel = paragraph ? 'paragraph' : heading;\n        if (typeof whichModel === 'boolean') {\n          return defaultTitle;\n        }\n        // If none of the commands is active, display default title.\n        if (!titles[whichModel]) {\n          return defaultTitle;\n        }\n        return titles[whichModel];\n      });\n      dropdownView.buttonView.bind('ariaLabel').to(headingCommand, 'value', paragraphCommand, 'value', (heading, paragraph) => {\n        const whichModel = paragraph ? 'paragraph' : heading;\n        if (typeof whichModel === 'boolean') {\n          return accessibleLabel;\n        }\n        // If none of the commands is active, display default title.\n        if (!titles[whichModel]) {\n          return accessibleLabel;\n        }\n        return `${titles[whichModel]}, ${accessibleLabel}`;\n      });\n      // Execute command when an item from the dropdown is selected.\n      this.listenTo(dropdownView, 'execute', evt => {\n        const {\n          commandName,\n          commandValue\n        } = evt.source;\n        editor.execute(commandName, commandValue ? {\n          value: commandValue\n        } : undefined);\n        editor.editing.view.focus();\n      });\n      return dropdownView;\n    });\n    editor.ui.componentFactory.add('menuBar:heading', locale => {\n      const menuView = new MenuBarMenuView(locale);\n      const headingCommand = editor.commands.get('heading');\n      const paragraphCommand = editor.commands.get('paragraph');\n      const commands = [headingCommand];\n      const listView = new MenuBarMenuListView(locale);\n      menuView.set({\n        class: 'ck-heading-dropdown'\n      });\n      listView.set({\n        ariaLabel: t('Heading'),\n        role: 'menu'\n      });\n      menuView.buttonView.set({\n        label: t('Heading')\n      });\n      menuView.panelView.children.add(listView);\n      for (const option of options) {\n        const listItemView = new MenuBarMenuListItemView(locale, menuView);\n        const buttonView = new MenuBarMenuListItemButtonView(locale);\n        listItemView.children.add(buttonView);\n        listView.items.add(listItemView);\n        buttonView.set({\n          isToggleable: true,\n          label: option.title,\n          role: 'menuitemradio',\n          class: option.class\n        });\n        buttonView.delegate('execute').to(menuView);\n        buttonView.on('execute', () => {\n          const commandName = option.model === 'paragraph' ? 'paragraph' : 'heading';\n          editor.execute(commandName, {\n            value: option.model\n          });\n          editor.editing.view.focus();\n        });\n        if (option.model === 'paragraph') {\n          buttonView.bind('isOn').to(paragraphCommand, 'value');\n          commands.push(paragraphCommand);\n        } else {\n          buttonView.bind('isOn').to(headingCommand, 'value', value => value === option.model);\n        }\n      }\n      menuView.bind('isEnabled').toMany(commands, 'isEnabled', (...areEnabled) => {\n        return areEnabled.some(isEnabled => isEnabled);\n      });\n      return menuView;\n    });\n  }\n}\n\n/**\n * The headings feature.\n *\n * For a detailed overview, check the {@glink features/headings Headings feature} guide\n * and the {@glink api/heading package page}.\n *\n * This is a \"glue\" plugin which loads the {@link module:heading/headingediting~HeadingEditing heading editing feature}\n * and {@link module:heading/headingui~HeadingUI heading UI feature}.\n *\n * @extends module:core/plugin~Plugin\n */\nclass Heading extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [HeadingEditing, HeadingUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Heading';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nconst defaultIcons = /* #__PURE__ */(() => ({\n  heading1: IconHeading1,\n  heading2: IconHeading2,\n  heading3: IconHeading3,\n  heading4: IconHeading4,\n  heading5: IconHeading5,\n  heading6: IconHeading6\n}))();\n/**\n * The `HeadingButtonsUI` plugin defines a set of UI buttons that can be used instead of the\n * standard drop down component.\n *\n * This feature is not enabled by default by the {@link module:heading/heading~Heading} plugin and needs to be\n * installed manually to the editor configuration.\n *\n * Plugin introduces button UI elements, which names are same as `model` property from {@link module:heading/headingconfig~HeadingOption}.\n *\n * ```ts\n * ClassicEditor\n *   .create( {\n *     plugins: [ ..., Heading, Paragraph, HeadingButtonsUI, ParagraphButtonUI ]\n *     heading: {\n *       options: [\n *         { model: 'paragraph', title: 'Paragraph', class: 'ck-heading_paragraph' },\n *         { model: 'heading1', view: 'h2', title: 'Heading 1', class: 'ck-heading_heading1' },\n *         { model: 'heading2', view: 'h3', title: 'Heading 2', class: 'ck-heading_heading2' },\n *         { model: 'heading3', view: 'h4', title: 'Heading 3', class: 'ck-heading_heading3' }\n *       ]\n *      },\n *      toolbar: [ 'paragraph', 'heading1', 'heading2', 'heading3' ]\n *   } )\n *   .then( ... )\n *   .catch( ... );\n * ```\n *\n * NOTE: The `'paragraph'` button is defined in by the {@link module:paragraph/paragraphbuttonui~ParagraphButtonUI} plugin\n * which needs to be loaded manually as well.\n *\n * It is possible to use custom icons by providing `icon` config option in {@link module:heading/headingconfig~HeadingOption}.\n * For the default configuration standard icons are used.\n */\nclass HeadingButtonsUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const options = getLocalizedOptions(this.editor);\n    options.filter(item => item.model !== 'paragraph').map(item => this._createButton(item));\n  }\n  /**\n  * Creates single button view from provided configuration option.\n  */\n  _createButton(option) {\n    const editor = this.editor;\n    editor.ui.componentFactory.add(option.model, locale => {\n      const view = new ButtonView(locale);\n      const command = editor.commands.get('heading');\n      view.label = option.title;\n      view.icon = option.icon || defaultIcons[option.model];\n      view.tooltip = true;\n      view.isToggleable = true;\n      view.bind('isEnabled').to(command);\n      view.bind('isOn').to(command, 'value', value => value == option.model);\n      view.on('execute', () => {\n        editor.execute('heading', {\n          value: option.model\n        });\n        editor.editing.view.focus();\n      });\n      return view;\n    });\n  }\n}\n\n// A list of element names that should be treated by the Title plugin as title-like.\n// This means that an element of a type from this list will be changed to a title element\n// when it is the first element in the root.\nconst titleLikeElements = new Set(['paragraph', 'heading1', 'heading2', 'heading3', 'heading4', 'heading5', 'heading6']);\n/**\n * The Title plugin.\n *\n * It splits the document into `Title` and `Body` sections.\n */\nclass Title extends Plugin {\n  /**\n  * A reference to an empty paragraph in the body\n  * created when there is no element in the body for the placeholder purposes.\n  */\n  _bodyPlaceholder = new Map();\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Title';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return ['Paragraph'];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const model = editor.model;\n    // To use the schema for disabling some features when the selection is inside the title element\n    // it is needed to create the following structure:\n    //\n    // <title>\n    //     <title-content>The title text</title-content>\n    // </title>\n    //\n    // See: https://github.com/ckeditor/ckeditor5/issues/2005.\n    model.schema.register('title', {\n      isBlock: true,\n      allowIn: '$root'\n    });\n    model.schema.register('title-content', {\n      isBlock: true,\n      allowIn: 'title',\n      allowAttributes: ['alignment']\n    });\n    model.schema.extend('$text', {\n      allowIn: 'title-content'\n    });\n    // Disallow all attributes in `title-content`.\n    model.schema.addAttributeCheck(context => {\n      if (context.endsWith('title-content $text')) {\n        return false;\n      }\n    });\n    // Because `title` is represented by two elements in the model\n    // but only one in the view, it is needed to adjust Mapper.\n    editor.editing.mapper.on('modelToViewPosition', mapModelPositionToView(editor.editing.view));\n    editor.data.mapper.on('modelToViewPosition', mapModelPositionToView(editor.editing.view));\n    // Conversion.\n    editor.conversion.for('downcast').elementToElement({\n      model: 'title-content',\n      view: 'h1'\n    });\n    editor.conversion.for('downcast').add(dispatcher => dispatcher.on('insert:title', (evt, data, conversionApi) => {\n      conversionApi.consumable.consume(data.item, evt.name);\n    }));\n    // Custom converter is used for data v -> m conversion to avoid calling post-fixer when setting data.\n    // See https://github.com/ckeditor/ckeditor5/issues/2036.\n    editor.data.upcastDispatcher.on('element:h1', dataViewModelH1Insertion, {\n      priority: 'high'\n    });\n    editor.data.upcastDispatcher.on('element:h2', dataViewModelH1Insertion, {\n      priority: 'high'\n    });\n    editor.data.upcastDispatcher.on('element:h3', dataViewModelH1Insertion, {\n      priority: 'high'\n    });\n    // Take care about correct `title` element structure.\n    model.document.registerPostFixer(writer => this._fixTitleContent(writer));\n    // Create and take care of correct position of a `title` element.\n    model.document.registerPostFixer(writer => this._fixTitleElement(writer));\n    // Create element for `Body` placeholder if it is missing.\n    model.document.registerPostFixer(writer => this._fixBodyElement(writer));\n    // Prevent from adding extra at the end of the document.\n    model.document.registerPostFixer(writer => this._fixExtraParagraph(writer));\n    // Attach `Title` and `Body` placeholders to the empty title and/or content.\n    this._attachPlaceholders();\n    // Attach Tab handling.\n    this._attachTabPressHandling();\n  }\n  /**\n  * Returns the title of the document. Note that because this plugin does not allow any formatting inside\n  * the title element, the output of this method will be a plain text, with no HTML tags.\n  *\n  * It is not recommended to use this method together with features that insert markers to the\n  * data output, like comments or track changes features. If such markers start in the title and end in the\n  * body, the result of this method might be incorrect.\n  *\n  * @param options Additional configuration passed to the conversion process.\n  * See {@link module:engine/controller/datacontroller~DataController#get `DataController#get`}.\n  * @returns The title of the document.\n  */\n  getTitle(options = {}) {\n    const rootName = options.rootName ? options.rootName : undefined;\n    const titleElement = this._getTitleElement(rootName);\n    const titleContentElement = titleElement.getChild(0);\n    return this.editor.data.stringify(titleContentElement, options);\n  }\n  /**\n  * Returns the body of the document.\n  *\n  * Note that it is not recommended to use this method together with features that insert markers to the\n  * data output, like comments or track changes features. If such markers start in the title and end in the\n  * body, the result of this method might be incorrect.\n  *\n  * @param options Additional configuration passed to the conversion process.\n  * See {@link module:engine/controller/datacontroller~DataController#get `DataController#get`}.\n  * @returns The body of the document.\n  */\n  getBody(options = {}) {\n    const editor = this.editor;\n    const data = editor.data;\n    const model = editor.model;\n    const rootName = options.rootName ? options.rootName : undefined;\n    const root = editor.model.document.getRoot(rootName);\n    const view = editor.editing.view;\n    const viewWriter = new DowncastWriter(view.document);\n    const rootRange = model.createRangeIn(root);\n    const viewDocumentFragment = viewWriter.createDocumentFragment();\n    // Find all markers that intersects with body.\n    const bodyStartPosition = model.createPositionAfter(root.getChild(0));\n    const bodyRange = model.createRange(bodyStartPosition, model.createPositionAt(root, 'end'));\n    const markers = new Map();\n    for (const marker of model.markers) {\n      const intersection = bodyRange.getIntersection(marker.getRange());\n      if (intersection) {\n        markers.set(marker.name, intersection);\n      }\n    }\n    // Convert the entire root to view.\n    data.mapper.clearBindings();\n    data.mapper.bindElements(root, viewDocumentFragment);\n    data.downcastDispatcher.convert(rootRange, markers, viewWriter, options);\n    // Remove title element from view.\n    viewWriter.remove(viewWriter.createRangeOn(viewDocumentFragment.getChild(0)));\n    // view -> data\n    return editor.data.processor.toData(viewDocumentFragment);\n  }\n  /**\n  * Returns the `title` element when it is in the document. Returns `undefined` otherwise.\n  */\n  _getTitleElement(rootName) {\n    const root = this.editor.model.document.getRoot(rootName);\n    for (const child of root.getChildren()) {\n      if (isTitle(child)) {\n        return child;\n      }\n    }\n  }\n  /**\n  * Model post-fixer callback that ensures that `title` has only one `title-content` child.\n  * All additional children should be moved after the `title` element and renamed to a paragraph.\n  */\n  _fixTitleContent(writer) {\n    let changed = false;\n    for (const rootName of this.editor.model.document.getRootNames()) {\n      const title = this._getTitleElement(rootName);\n      // If there is no title in the content it will be created by `_fixTitleElement` post-fixer.\n      // If the title has just one element, then it is correct. No fixing.\n      if (!title || title.maxOffset === 1) {\n        continue;\n      }\n      const titleChildren = Array.from(title.getChildren());\n      // Skip first child because it is an allowed element.\n      titleChildren.shift();\n      for (const titleChild of titleChildren) {\n        writer.move(writer.createRangeOn(titleChild), title, 'after');\n        writer.rename(titleChild, 'paragraph');\n      }\n      changed = true;\n    }\n    return changed;\n  }\n  /**\n  * Model post-fixer callback that creates a title element when it is missing,\n  * takes care of the correct position of it and removes additional title elements.\n  */\n  _fixTitleElement(writer) {\n    let changed = false;\n    const model = this.editor.model;\n    for (const modelRoot of this.editor.model.document.getRoots()) {\n      const titleElements = Array.from(modelRoot.getChildren()).filter(isTitle);\n      const firstTitleElement = titleElements[0];\n      const firstRootChild = modelRoot.getChild(0);\n      // When title element is at the beginning of the document then try to fix additional title elements (if there are any).\n      if (firstRootChild.is('element', 'title')) {\n        if (titleElements.length > 1) {\n          fixAdditionalTitleElements(titleElements, writer, model);\n          changed = true;\n        }\n        continue;\n      }\n      // When there is no title in the document and first element in the document cannot be changed\n      // to the title then create an empty title element at the beginning of the document.\n      if (!firstTitleElement && !titleLikeElements.has(firstRootChild.name)) {\n        const title = writer.createElement('title');\n        writer.insert(title, modelRoot);\n        writer.insertElement('title-content', title);\n        changed = true;\n        continue;\n      }\n      if (titleLikeElements.has(firstRootChild.name)) {\n        // Change the first element in the document to the title if it can be changed (is title-like).\n        changeElementToTitle(firstRootChild, writer, model);\n      } else {\n        // Otherwise, move the first occurrence of the title element to the beginning of the document.\n        writer.move(writer.createRangeOn(firstTitleElement), modelRoot, 0);\n      }\n      fixAdditionalTitleElements(titleElements, writer, model);\n      changed = true;\n    }\n    return changed;\n  }\n  /**\n  * Model post-fixer callback that adds an empty paragraph at the end of the document\n  * when it is needed for the placeholder purposes.\n  */\n  _fixBodyElement(writer) {\n    let changed = false;\n    for (const rootName of this.editor.model.document.getRootNames()) {\n      const modelRoot = this.editor.model.document.getRoot(rootName);\n      if (modelRoot.childCount < 2) {\n        const placeholder = writer.createElement('paragraph');\n        writer.insert(placeholder, modelRoot, 1);\n        this._bodyPlaceholder.set(rootName, placeholder);\n        changed = true;\n      }\n    }\n    return changed;\n  }\n  /**\n  * Model post-fixer callback that removes a paragraph from the end of the document\n  * if it was created for the placeholder purposes and is not needed anymore.\n  */\n  _fixExtraParagraph(writer) {\n    let changed = false;\n    for (const rootName of this.editor.model.document.getRootNames()) {\n      const root = this.editor.model.document.getRoot(rootName);\n      const placeholder = this._bodyPlaceholder.get(rootName);\n      if (shouldRemoveLastParagraph(placeholder, root)) {\n        this._bodyPlaceholder.delete(rootName);\n        writer.remove(placeholder);\n        changed = true;\n      }\n    }\n    return changed;\n  }\n  /**\n  * Attaches the `Title` and `Body` placeholders to the title and/or content.\n  */\n  _attachPlaceholders() {\n    const editor = this.editor;\n    const t = editor.t;\n    const view = editor.editing.view;\n    const sourceElement = editor.sourceElement;\n    const titlePlaceholder = editor.config.get('title.placeholder') || t('Type your title');\n    const bodyPlaceholder = editor.config.get('placeholder') || sourceElement && sourceElement.tagName.toLowerCase() === 'textarea' && sourceElement.getAttribute('placeholder') || t('Type or paste your content here.');\n    // Attach placeholder to the view title element.\n    editor.editing.downcastDispatcher.on('insert:title-content', (evt, data, conversionApi) => {\n      const element = conversionApi.mapper.toViewElement(data.item);\n      element.placeholder = titlePlaceholder;\n      enablePlaceholder({\n        view,\n        element,\n        keepOnFocus: true\n      });\n    });\n    // Attach placeholder to first element after a title element and remove it if it's not needed anymore.\n    // First element after title can change, so we need to observe all changes keep placeholder in sync.\n    const bodyViewElements = new Map();\n    // This post-fixer runs after the model post-fixer, so we can assume that the second child in view root will always exist.\n    view.document.registerPostFixer(writer => {\n      let hasChanged = false;\n      for (const viewRoot of view.document.roots) {\n        // `viewRoot` can be empty despite the model post-fixers if the model root was detached.\n        if (viewRoot.isEmpty) {\n          continue;\n        }\n        // If `viewRoot` is not empty, then we can expect at least two elements in it.\n        const body = viewRoot.getChild(1);\n        const oldBody = bodyViewElements.get(viewRoot.rootName);\n        // If body element has changed we need to disable placeholder on the previous element and enable on the new one.\n        if (body !== oldBody) {\n          if (oldBody) {\n            hidePlaceholder(writer, oldBody);\n            writer.removeAttribute('data-placeholder', oldBody);\n          }\n          writer.setAttribute('data-placeholder', bodyPlaceholder, body);\n          bodyViewElements.set(viewRoot.rootName, body);\n          hasChanged = true;\n        }\n        // Then we need to display placeholder if it is needed.\n        // See: https://github.com/ckeditor/ckeditor5/issues/8689.\n        if (needsPlaceholder(body, true) && viewRoot.childCount === 2 && body.name === 'p') {\n          hasChanged = showPlaceholder(writer, body) ? true : hasChanged;\n        } else {\n          // Or hide if it is not needed.\n          hasChanged = hidePlaceholder(writer, body) ? true : hasChanged;\n        }\n      }\n      return hasChanged;\n    });\n  }\n  /**\n  * Creates navigation between the title and body sections using <kbd>Tab</kbd> and <kbd>Shift</kbd>+<kbd>Tab</kbd> keys.\n  */\n  _attachTabPressHandling() {\n    const editor = this.editor;\n    const model = editor.model;\n    // Pressing <kbd>Tab</kbd> inside the title should move the caret to the body.\n    editor.keystrokes.set('TAB', (data, cancel) => {\n      model.change(writer => {\n        const selection = model.document.selection;\n        const selectedElements = Array.from(selection.getSelectedBlocks());\n        if (selectedElements.length === 1 && selectedElements[0].is('element', 'title-content')) {\n          const root = selection.getFirstPosition().root;\n          const firstBodyElement = root.getChild(1);\n          writer.setSelection(firstBodyElement, 0);\n          cancel();\n        }\n      });\n    });\n    // Pressing <kbd>Shift</kbd>+<kbd>Tab</kbd> at the beginning of the body should move the caret to the title.\n    editor.keystrokes.set('SHIFT + TAB', (data, cancel) => {\n      model.change(writer => {\n        const selection = model.document.selection;\n        if (!selection.isCollapsed) {\n          return;\n        }\n        const selectedElement = first(selection.getSelectedBlocks());\n        const selectionPosition = selection.getFirstPosition();\n        const root = editor.model.document.getRoot(selectionPosition.root.rootName);\n        const title = root.getChild(0);\n        const body = root.getChild(1);\n        if (selectedElement === body && selectionPosition.isAtStart) {\n          writer.setSelection(title.getChild(0), 0);\n          cancel();\n        }\n      });\n    });\n  }\n}\n/**\n * A view-to-model converter for the h1 that appears at the beginning of the document (a title element).\n *\n * @see module:engine/conversion/upcastdispatcher~UpcastDispatcher#event:element\n * @param evt An object containing information about the fired event.\n * @param data An object containing conversion input, a placeholder for conversion output and possibly other values.\n * @param conversionApi Conversion interface to be used by the callback.\n */\nfunction dataViewModelH1Insertion(evt, data, conversionApi) {\n  const modelCursor = data.modelCursor;\n  const viewItem = data.viewItem;\n  if (!modelCursor.isAtStart || !modelCursor.parent.is('element', '$root')) {\n    return;\n  }\n  if (!conversionApi.consumable.consume(viewItem, {\n    name: true\n  })) {\n    return;\n  }\n  const modelWriter = conversionApi.writer;\n  const title = modelWriter.createElement('title');\n  const titleContent = modelWriter.createElement('title-content');\n  modelWriter.append(titleContent, title);\n  modelWriter.insert(title, modelCursor);\n  conversionApi.convertChildren(viewItem, titleContent);\n  conversionApi.updateConversionResult(title, data);\n}\n/**\n * Maps position from the beginning of the model `title` element to the beginning of the view `h1` element.\n *\n * ```html\n * <title>^<title-content>Foo</title-content></title> -> <h1>^Foo</h1>\n * ```\n */\nfunction mapModelPositionToView(editingView) {\n  return (evt, data) => {\n    const positionParent = data.modelPosition.parent;\n    if (!positionParent.is('element', 'title')) {\n      return;\n    }\n    const modelTitleElement = positionParent.parent;\n    const viewElement = data.mapper.toViewElement(modelTitleElement);\n    data.viewPosition = editingView.createPositionAt(viewElement, 0);\n    evt.stop();\n  };\n}\n/**\n * @returns Returns true when given element is a title. Returns false otherwise.\n */\nfunction isTitle(element) {\n  return element.is('element', 'title');\n}\n/**\n * Changes the given element to the title element.\n */\nfunction changeElementToTitle(element, writer, model) {\n  const title = writer.createElement('title');\n  writer.insert(title, element, 'before');\n  writer.insert(element, title, 0);\n  writer.rename(element, 'title-content');\n  model.schema.removeDisallowedAttributes([element], writer);\n}\n/**\n * Loops over the list of title elements and fixes additional ones.\n *\n * @returns Returns true when there was any change. Returns false otherwise.\n */\nfunction fixAdditionalTitleElements(titleElements, writer, model) {\n  let hasChanged = false;\n  for (const title of titleElements) {\n    if (title.index !== 0) {\n      fixTitleElement(title, writer, model);\n      hasChanged = true;\n    }\n  }\n  return hasChanged;\n}\n/**\n * Changes given title element to a paragraph or removes it when it is empty.\n */\nfunction fixTitleElement(title, writer, model) {\n  const child = title.getChild(0);\n  // Empty title should be removed.\n  // It is created as a result of pasting to the title element.\n  if (child.isEmpty) {\n    writer.remove(title);\n    return;\n  }\n  writer.move(writer.createRangeOn(child), title, 'before');\n  writer.rename(child, 'paragraph');\n  writer.remove(title);\n  model.schema.removeDisallowedAttributes([child], writer);\n}\n/**\n * Returns true when the last paragraph in the document was created only for the placeholder\n * purpose and it's not needed anymore. Returns false otherwise.\n */\nfunction shouldRemoveLastParagraph(placeholder, root) {\n  if (!placeholder || !placeholder.is('element', 'paragraph') || placeholder.childCount) {\n    return false;\n  }\n  if (root.childCount <= 2 || root.getChild(root.childCount - 1) !== placeholder) {\n    return false;\n  }\n  return true;\n}\nexport { Heading, HeadingButtonsUI, HeadingEditing, HeadingUI, Title };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { IconEraser, IconMarker, IconPen } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { ButtonView, createDropdown, SplitButtonView, addToolbarToDropdown, MenuBarMenuView, MenuBarMenuListView, MenuBarMenuListItemView, MenuBarMenuListItemButtonView, ListSeparatorView, ToolbarSeparatorView } from '@ckeditor/ckeditor5-ui/dist/index.js';\n\n/**\n * The highlight command. It is used by the {@link module:highlight/highlightediting~HighlightEditing highlight feature}\n * to apply the text highlighting.\n *\n * ```ts\n * editor.execute( 'highlight', { value: 'greenMarker' } );\n * ```\n *\n * **Note**: Executing the command without a value removes the attribute from the model. If the selection is collapsed\n * inside a text with the highlight attribute, the command will remove the attribute from the entire range\n * of that text.\n */\nclass HighlightCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const doc = model.document;\n    this.value = doc.selection.getAttribute('highlight');\n    this.isEnabled = model.schema.checkAttributeInSelection(doc.selection, 'highlight');\n  }\n  /**\n  * Executes the command.\n  *\n  * @param options Options for the executed command.\n  * @param options.value The value to apply.\n  *\n  * @fires execute\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const document = model.document;\n    const selection = document.selection;\n    const highlighter = options.value;\n    model.change(writer => {\n      if (selection.isCollapsed) {\n        const position = selection.getFirstPosition();\n        // When selection is inside text with `highlight` attribute.\n        if (selection.hasAttribute('highlight')) {\n          // Find the full highlighted range.\n          const isSameHighlight = value => {\n            return value.item.hasAttribute('highlight') && value.item.getAttribute('highlight') === this.value;\n          };\n          const highlightStart = position.getLastMatchingPosition(isSameHighlight, {\n            direction: 'backward'\n          });\n          const highlightEnd = position.getLastMatchingPosition(isSameHighlight);\n          const highlightRange = writer.createRange(highlightStart, highlightEnd);\n          // Then depending on current value...\n          if (!highlighter || this.value === highlighter) {\n            // ...remove attribute when passing highlighter different then current or executing \"eraser\".\n            // If we're at the end of the highlighted range, we don't want to remove highlight of the range.\n            if (!position.isEqual(highlightEnd)) {\n              writer.removeAttribute('highlight', highlightRange);\n            }\n            writer.removeSelectionAttribute('highlight');\n          } else {\n            // ...update `highlight` value.\n            // If we're at the end of the highlighted range, we don't want to change the highlight of the range.\n            if (!position.isEqual(highlightEnd)) {\n              writer.setAttribute('highlight', highlighter, highlightRange);\n            }\n            writer.setSelectionAttribute('highlight', highlighter);\n          }\n        } else if (highlighter) {\n          writer.setSelectionAttribute('highlight', highlighter);\n        }\n      } else {\n        const ranges = model.schema.getValidRanges(selection.getRanges(), 'highlight');\n        for (const range of ranges) {\n          if (highlighter) {\n            writer.setAttribute('highlight', highlighter, range);\n          } else {\n            writer.removeAttribute('highlight', range);\n          }\n        }\n      }\n    });\n  }\n}\n\n/**\n * The highlight editing feature. It introduces the {@link module:highlight/highlightcommand~HighlightCommand command} and the `highlight`\n * attribute in the {@link module:engine/model/model~Model model} which renders in the {@link module:engine/view/view view}\n * as a `<mark>` element with a `class` attribute (`<mark class=\"marker-green\">...</mark>`) depending\n * on the {@link module:highlight/highlightconfig~HighlightConfig configuration}.\n */\nclass HighlightEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HighlightEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('highlight', {\n      options: [{\n        model: 'yellowMarker',\n        class: 'marker-yellow',\n        title: 'Yellow marker',\n        color: 'var(--ck-highlight-marker-yellow)',\n        type: 'marker'\n      }, {\n        model: 'greenMarker',\n        class: 'marker-green',\n        title: 'Green marker',\n        color: 'var(--ck-highlight-marker-green)',\n        type: 'marker'\n      }, {\n        model: 'pinkMarker',\n        class: 'marker-pink',\n        title: 'Pink marker',\n        color: 'var(--ck-highlight-marker-pink)',\n        type: 'marker'\n      }, {\n        model: 'blueMarker',\n        class: 'marker-blue',\n        title: 'Blue marker',\n        color: 'var(--ck-highlight-marker-blue)',\n        type: 'marker'\n      }, {\n        model: 'redPen',\n        class: 'pen-red',\n        title: 'Red pen',\n        color: 'var(--ck-highlight-pen-red)',\n        type: 'pen'\n      }, {\n        model: 'greenPen',\n        class: 'pen-green',\n        title: 'Green pen',\n        color: 'var(--ck-highlight-pen-green)',\n        type: 'pen'\n      }]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Allow highlight attribute on text nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: 'highlight'\n    });\n    const options = editor.config.get('highlight.options');\n    // Set-up the two-way conversion.\n    editor.conversion.attributeToElement(_buildDefinition(options));\n    editor.commands.add('highlight', new HighlightCommand(editor));\n  }\n}\n/**\n * Converts the options array to a converter definition.\n *\n * @param options An array with configured options.\n */\nfunction _buildDefinition(options) {\n  const definition = {\n    model: {\n      key: 'highlight',\n      values: []\n    },\n    view: {}\n  };\n  for (const option of options) {\n    definition.model.values.push(option.model);\n    definition.view[option.model] = {\n      name: 'mark',\n      classes: option.class\n    };\n  }\n  return definition;\n}\n\n/**\n * The default highlight UI plugin. It introduces:\n *\n * * The `'highlight'` dropdown,\n * * The `'removeHighlight'` and `'highlight:*'` buttons.\n *\n * The default configuration includes the following buttons:\n *\n * * `'highlight:yellowMarker'`\n * * `'highlight:greenMarker'`\n * * `'highlight:pinkMarker'`\n * * `'highlight:blueMarker'`\n * * `'highlight:redPen'`\n * * `'highlight:greenPen'`\n *\n * See the {@link module:highlight/highlightconfig~HighlightConfig#options configuration} to learn more\n * about the defaults.\n */\nclass HighlightUI extends Plugin {\n  /**\n  * Returns the localized option titles provided by the plugin.\n  *\n  * The following localized titles corresponding with default\n  * {@link module:highlight/highlightconfig~HighlightConfig#options} are available:\n  *\n  * * `'Yellow marker'`,\n  * * `'Green marker'`,\n  * * `'Pink marker'`,\n  * * `'Blue marker'`,\n  * * `'Red pen'`,\n  * * `'Green pen'`.\n  */\n  get localizedOptionTitles() {\n    const t = this.editor.t;\n    return {\n      'Yellow marker': t('Yellow marker'),\n      'Green marker': t('Green marker'),\n      'Pink marker': t('Pink marker'),\n      'Blue marker': t('Blue marker'),\n      'Red pen': t('Red pen'),\n      'Green pen': t('Green pen')\n    };\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HighlightUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const options = this.editor.config.get('highlight.options');\n    for (const option of options) {\n      this._addHighlighterButton(option);\n    }\n    this._addRemoveHighlightButton();\n    this._addDropdown(options);\n    this._addMenuBarButton(options);\n  }\n  /**\n  * Creates the \"Remove highlight\" button.\n  */\n  _addRemoveHighlightButton() {\n    const t = this.editor.t;\n    const command = this.editor.commands.get('highlight');\n    this._addButton('removeHighlight', t('Remove highlight'), IconEraser, null, button => {\n      button.bind('isEnabled').to(command, 'isEnabled');\n    });\n  }\n  /**\n  * Creates a toolbar button from the provided highlight option.\n  */\n  _addHighlighterButton(option) {\n    const command = this.editor.commands.get('highlight');\n    // TODO: change naming\n    this._addButton('highlight:' + option.model, option.title, getIconForType(option.type), option.model, decorateHighlightButton);\n    function decorateHighlightButton(button) {\n      button.bind('isEnabled').to(command, 'isEnabled');\n      button.bind('isOn').to(command, 'value', value => value === option.model);\n      button.iconView.fillColor = option.color;\n      button.isToggleable = true;\n    }\n  }\n  /**\n  * Internal method for creating highlight buttons.\n  *\n  * @param name The name of the button.\n  * @param label The label for the button.\n  * @param icon The button icon.\n  * @param value The `value` property passed to the executed command.\n  * @param decorateButton A callback getting ButtonView instance so that it can be further customized.\n  */\n  _addButton(name, label, icon, value, decorateButton) {\n    const editor = this.editor;\n    editor.ui.componentFactory.add(name, locale => {\n      const buttonView = new ButtonView(locale);\n      const localized = this.localizedOptionTitles[label] ? this.localizedOptionTitles[label] : label;\n      buttonView.set({\n        label: localized,\n        icon,\n        tooltip: true\n      });\n      buttonView.on('execute', () => {\n        editor.execute('highlight', {\n          value\n        });\n        editor.editing.view.focus();\n      });\n      // Add additional behavior for buttonView.\n      decorateButton(buttonView);\n      return buttonView;\n    });\n  }\n  /**\n  * Creates the split button dropdown UI from the provided highlight options.\n  */\n  _addDropdown(options) {\n    const editor = this.editor;\n    const t = editor.t;\n    const componentFactory = editor.ui.componentFactory;\n    const startingHighlighter = options[0];\n    const optionsMap = options.reduce((retVal, option) => {\n      retVal[option.model] = option;\n      return retVal;\n    }, {});\n    componentFactory.add('highlight', locale => {\n      const command = editor.commands.get('highlight');\n      const dropdownView = createDropdown(locale, SplitButtonView);\n      const splitButtonView = dropdownView.buttonView;\n      splitButtonView.set({\n        label: t('Highlight'),\n        tooltip: true,\n        // Holds last executed highlighter.\n        lastExecuted: startingHighlighter.model,\n        // Holds current highlighter to execute (might be different then last used).\n        commandValue: startingHighlighter.model,\n        isToggleable: true\n      });\n      // Dropdown button changes to selection (command.value):\n      // - If selection is in highlight it get active highlight appearance (icon, color) and is activated.\n      // - Otherwise it gets appearance (icon, color) of last executed highlight.\n      splitButtonView.bind('icon').to(command, 'value', value => getIconForType(getActiveOption(value, 'type')));\n      splitButtonView.bind('color').to(command, 'value', value => getActiveOption(value, 'color'));\n      splitButtonView.bind('commandValue').to(command, 'value', value => getActiveOption(value, 'model'));\n      splitButtonView.bind('isOn').to(command, 'value', value => !!value);\n      splitButtonView.delegate('execute').to(dropdownView);\n      // Create buttons array.\n      const buttonsCreator = () => {\n        const buttons = options.map(option => {\n          // Get existing highlighter button.\n          const buttonView = componentFactory.create('highlight:' + option.model);\n          // Update lastExecutedHighlight on execute.\n          this.listenTo(buttonView, 'execute', () => {\n            dropdownView.buttonView.set({\n              lastExecuted: option.model\n            });\n          });\n          return buttonView;\n        });\n        // Add separator and eraser buttons to dropdown.\n        buttons.push(new ToolbarSeparatorView());\n        buttons.push(componentFactory.create('removeHighlight'));\n        return buttons;\n      };\n      // Make toolbar button enabled when any button in dropdown is enabled before adding separator and eraser.\n      dropdownView.bind('isEnabled').to(command, 'isEnabled');\n      addToolbarToDropdown(dropdownView, buttonsCreator, {\n        enableActiveItemFocusOnDropdownOpen: true,\n        ariaLabel: t('Text highlight toolbar')\n      });\n      bindToolbarIconStyleToActiveColor(dropdownView);\n      // Execute current action from dropdown's split button action button.\n      splitButtonView.on('execute', () => {\n        editor.execute('highlight', {\n          value: splitButtonView.commandValue\n        });\n      });\n      // Focus the editable after executing the command.\n      // It overrides a default behaviour where the focus is moved to the dropdown button (#12125).\n      this.listenTo(dropdownView, 'execute', () => {\n        editor.editing.view.focus();\n      });\n      /**\n      * Returns active highlighter option depending on current command value.\n      * If current is not set or it is the same as last execute this method will return the option key (like icon or color)\n      * of last executed highlighter. Otherwise it will return option key for current one.\n      */\n      function getActiveOption(current, key) {\n        const whichHighlighter = !current || current === splitButtonView.lastExecuted ? splitButtonView.lastExecuted : current;\n        return optionsMap[whichHighlighter][key];\n      }\n      return dropdownView;\n    });\n  }\n  /**\n  * Creates the menu bar button for highlight including submenu with available options.\n  */\n  _addMenuBarButton(options) {\n    const editor = this.editor;\n    const t = editor.t;\n    const command = editor.commands.get('highlight');\n    editor.ui.componentFactory.add('menuBar:highlight', locale => {\n      const menuView = new MenuBarMenuView(locale);\n      menuView.buttonView.set({\n        label: t('Highlight'),\n        icon: getIconForType('marker')\n      });\n      menuView.bind('isEnabled').to(command);\n      menuView.buttonView.iconView.fillColor = 'transparent';\n      const listView = new MenuBarMenuListView(locale);\n      for (const option of options) {\n        const listItemView = new MenuBarMenuListItemView(locale, menuView);\n        const buttonView = new MenuBarMenuListItemButtonView(locale);\n        buttonView.set({\n          label: option.title,\n          icon: getIconForType(option.type),\n          role: 'menuitemradio',\n          isToggleable: true\n        });\n        buttonView.iconView.fillColor = option.color;\n        buttonView.delegate('execute').to(menuView);\n        buttonView.bind('isOn').to(command, 'value', value => value === option.model);\n        buttonView.on('execute', () => {\n          editor.execute('highlight', {\n            value: option.model\n          });\n          editor.editing.view.focus();\n        });\n        listItemView.children.add(buttonView);\n        listView.items.add(listItemView);\n      }\n      // Add remove highlight button\n      listView.items.add(new ListSeparatorView(locale));\n      const listItemView = new MenuBarMenuListItemView(locale, menuView);\n      const buttonView = new MenuBarMenuListItemButtonView(locale);\n      buttonView.set({\n        label: t('Remove highlight'),\n        icon: IconEraser\n      });\n      buttonView.delegate('execute').to(menuView);\n      buttonView.on('execute', () => {\n        editor.execute('highlight', {\n          value: null\n        });\n        editor.editing.view.focus();\n      });\n      listItemView.children.add(buttonView);\n      listView.items.add(listItemView);\n      menuView.panelView.children.add(listView);\n      return menuView;\n    });\n  }\n}\n/**\n * Extends split button icon style to reflect last used button style.\n */\nfunction bindToolbarIconStyleToActiveColor(dropdownView) {\n  const actionView = dropdownView.buttonView.actionView;\n  actionView.iconView.bind('fillColor').to(dropdownView.buttonView, 'color');\n}\n/**\n * Returns icon for given highlighter type.\n */\nfunction getIconForType(type) {\n  return type === 'marker' ? IconMarker : IconPen;\n}\n\n/**\n * The highlight plugin.\n *\n * For a detailed overview, check the {@glink features/highlight Highlight feature} documentation.\n *\n * This is a \"glue\" plugin which loads the {@link module:highlight/highlightediting~HighlightEditing} and\n * {@link module:highlight/highlightui~HighlightUI} plugins.\n */\nclass Highlight extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [HighlightEditing, HighlightUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Highlight';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { Highlight, HighlightEditing, HighlightUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { findOptimalInsertionRange, toWidget, Widget } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { IconHorizontalLine } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\n\n/**\n * The horizontal line command.\n *\n * The command is registered by {@link module:horizontal-line/horizontallineediting~HorizontalLineEditing} as `'horizontalLine'`.\n *\n * To insert a horizontal line at the current selection, execute the command:\n *\n * ```ts\n * editor.execute( 'horizontalLine' );\n * ```\n */\nclass HorizontalLineCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const selection = model.document.selection;\n    this.isEnabled = isHorizontalLineAllowedInParent(selection, schema, model);\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  */\n  execute() {\n    const model = this.editor.model;\n    model.change(writer => {\n      const horizontalElement = writer.createElement('horizontalLine');\n      model.insertObject(horizontalElement, null, null, {\n        setSelection: 'after'\n      });\n    });\n  }\n}\n/**\n * Checks if a horizontal line is allowed by the schema in the optimal insertion parent.\n *\n * @param model Model instance.\n */\nfunction isHorizontalLineAllowedInParent(selection, schema, model) {\n  const parent = getInsertHorizontalLineParent(selection, model);\n  return schema.checkChild(parent, 'horizontalLine');\n}\n/**\n * Returns a node that will be used to insert a horizontal line with `model.insertContent` to check if the horizontal line can be\n * placed there.\n *\n * @param model Model instance.\n */\nfunction getInsertHorizontalLineParent(selection, model) {\n  const insertionRange = findOptimalInsertionRange(selection, model);\n  const parent = insertionRange.start.parent;\n  if (parent.isEmpty && !parent.is('element', '$root')) {\n    return parent.parent;\n  }\n  return parent;\n}\n\n/**\n * The horizontal line editing feature.\n */\nclass HorizontalLineEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HorizontalLineEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const t = editor.t;\n    const conversion = editor.conversion;\n    schema.register('horizontalLine', {\n      inheritAllFrom: '$blockObject'\n    });\n    conversion.for('dataDowncast').elementToElement({\n      model: 'horizontalLine',\n      view: (modelElement, {\n        writer\n      }) => {\n        return writer.createEmptyElement('hr');\n      }\n    });\n    conversion.for('editingDowncast').elementToStructure({\n      model: 'horizontalLine',\n      view: (modelElement, {\n        writer\n      }) => {\n        const label = t('Horizontal line');\n        const viewWrapper = writer.createContainerElement('div', null, writer.createEmptyElement('hr'));\n        writer.addClass('ck-horizontal-line', viewWrapper);\n        writer.setCustomProperty('hr', true, viewWrapper);\n        return toHorizontalLineWidget(viewWrapper, writer, label);\n      }\n    });\n    conversion.for('upcast').elementToElement({\n      view: 'hr',\n      model: 'horizontalLine'\n    });\n    editor.commands.add('horizontalLine', new HorizontalLineCommand(editor));\n  }\n}\n/**\n * Converts a given {@link module:engine/view/element~Element} to a horizontal line widget:\n * * Adds a {@link module:engine/view/element~Element#_setCustomProperty custom property} allowing to\n *   recognize the horizontal line widget element.\n * * Calls the {@link module:widget/utils~toWidget} function with the proper element's label creator.\n *\n * @param writer An instance of the view writer.\n */\nfunction toHorizontalLineWidget(viewElement, writer, label) {\n  writer.setCustomProperty('horizontalLine', true, viewElement);\n  return toWidget(viewElement, writer, {\n    label\n  });\n}\n\n/**\n * The horizontal line UI plugin.\n */\nclass HorizontalLineUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HorizontalLineUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Add the `horizontalLine` button to feature components.\n    editor.ui.componentFactory.add('horizontalLine', () => {\n      const buttonView = this._createButton(ButtonView);\n      buttonView.set({\n        tooltip: true\n      });\n      return buttonView;\n    });\n    editor.ui.componentFactory.add('menuBar:horizontalLine', () => {\n      return this._createButton(MenuBarMenuListItemButtonView);\n    });\n  }\n  /**\n  * Creates a button for horizontal line command to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const command = editor.commands.get('horizontalLine');\n    const view = new ButtonClass(editor.locale);\n    const t = locale.t;\n    view.set({\n      label: t('Horizontal line'),\n      icon: IconHorizontalLine\n    });\n    view.bind('isEnabled').to(command, 'isEnabled');\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.execute('horizontalLine');\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n}\n\n/**\n * The horizontal line feature.\n *\n * It provides the possibility to insert a horizontal line into the rich-text editor.\n *\n * For a detailed overview, check the {@glink features/horizontal-line Horizontal line feature} documentation.\n */\nclass HorizontalLine extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [HorizontalLineEditing, HorizontalLineUI, Widget];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HorizontalLine';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { HorizontalLine, HorizontalLineEditing, HorizontalLineUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { findOptimalInsertionRange, toWidget, Widget } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { logWarning, createElement } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { IconPencil, IconCheck, IconCancel, IconHtml } from '@ckeditor/ckeditor5-icons/dist/index.js';\n\n/**\n * The insert HTML embed element command.\n *\n * The command is registered by {@link module:html-embed/htmlembedediting~HtmlEmbedEditing} as `'htmlEmbed'`.\n *\n * To insert an empty HTML embed element at the current selection, execute the command:\n *\n * ```ts\n * editor.execute( 'htmlEmbed' );\n * ```\n *\n * You can specify the initial content of a new HTML embed in the argument:\n *\n * ```ts\n * editor.execute( 'htmlEmbed', '<b>Initial content.</b>' );\n * ```\n *\n * To update the content of the HTML embed, select it in the model and pass the content in the argument:\n *\n * ```ts\n * editor.execute( 'htmlEmbed', '<b>New content of an existing embed.</b>' );\n * ```\n */\nclass HtmlEmbedCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const selection = model.document.selection;\n    const selectedRawHtmlElement = getSelectedRawHtmlModelWidget(selection);\n    this.isEnabled = isHtmlEmbedAllowedInParent(selection, schema, model);\n    this.value = selectedRawHtmlElement ? selectedRawHtmlElement.getAttribute('value') || '' : null;\n  }\n  /**\n  * Executes the command, which either:\n  *\n  * * creates and inserts a new HTML embed element if none was selected,\n  * * updates the content of the HTML embed if one was selected.\n  *\n  * @fires execute\n  * @param value When passed, the value (content) will be set on a new embed or a selected one.\n  */\n  execute(value) {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    model.change(writer => {\n      let htmlEmbedElement;\n      // If the command has a non-null value, there must be some HTML embed selected in the model.\n      if (this.value !== null) {\n        htmlEmbedElement = getSelectedRawHtmlModelWidget(selection);\n      } else {\n        htmlEmbedElement = writer.createElement('rawHtml');\n        model.insertObject(htmlEmbedElement, null, null, {\n          setSelection: 'on'\n        });\n      }\n      writer.setAttribute('value', value, htmlEmbedElement);\n    });\n  }\n}\n/**\n * Checks if an HTML embed is allowed by the schema in the optimal insertion parent.\n */\nfunction isHtmlEmbedAllowedInParent(selection, schema, model) {\n  const parent = getInsertHtmlEmbedParent(selection, model);\n  return schema.checkChild(parent, 'rawHtml');\n}\n/**\n * Returns a node that will be used to insert a html embed with `model.insertContent` to check if a html embed element can be placed there.\n */\nfunction getInsertHtmlEmbedParent(selection, model) {\n  const insertionRange = findOptimalInsertionRange(selection, model);\n  const parent = insertionRange.start.parent;\n  if (parent.isEmpty && !parent.is('rootElement')) {\n    return parent.parent;\n  }\n  return parent;\n}\n/**\n * Returns the selected HTML embed element in the model, if any.\n */\nfunction getSelectedRawHtmlModelWidget(selection) {\n  const selectedElement = selection.getSelectedElement();\n  if (selectedElement && selectedElement.is('element', 'rawHtml')) {\n    return selectedElement;\n  }\n  return null;\n}\n\n/**\n * The HTML embed editing feature.\n */\nclass HtmlEmbedEditing extends Plugin {\n  /**\n  * Keeps references to {@link module:ui/button/buttonview~ButtonView edit, save, and cancel} button instances created for\n  * each widget so they can be destroyed if they are no longer in DOM after the editing view was re-rendered.\n  */\n  _widgetButtonViewReferences = new Set();\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HtmlEmbedEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('htmlEmbed', {\n      showPreviews: false,\n      sanitizeHtml: rawHtml => {\n        /**\n        * When using the HTML embed feature with the `config.htmlEmbed.showPreviews` set to `true`, it is strongly recommended to\n        * define a sanitize function that will clean up the input HTML in order to avoid XSS vulnerability.\n        *\n        * For a detailed overview, check the {@glink features/html/html-embed HTML embed feature} documentation.\n        *\n        * @error html-embed-provide-sanitize-function\n        */\n        logWarning('html-embed-provide-sanitize-function');\n        return {\n          html: rawHtml,\n          hasChanged: false\n        };\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    schema.register('rawHtml', {\n      inheritAllFrom: '$blockObject',\n      allowAttributes: ['value']\n    });\n    editor.commands.add('htmlEmbed', new HtmlEmbedCommand(editor));\n    this._setupConversion();\n  }\n  /**\n  * Prepares converters for the feature.\n  */\n  _setupConversion() {\n    const editor = this.editor;\n    const t = editor.t;\n    const view = editor.editing.view;\n    const widgetButtonViewReferences = this._widgetButtonViewReferences;\n    const htmlEmbedConfig = editor.config.get('htmlEmbed');\n    // Destroy UI buttons created for widgets that have been removed from the view document (e.g. in the previous conversion).\n    // This prevents unexpected memory leaks from UI views.\n    this.editor.editing.view.on('render', () => {\n      for (const buttonView of widgetButtonViewReferences) {\n        if (buttonView.element && buttonView.element.isConnected) {\n          return;\n        }\n        buttonView.destroy();\n        widgetButtonViewReferences.delete(buttonView);\n      }\n    }, {\n      priority: 'lowest'\n    });\n    // Register div.raw-html-embed as a raw content element so all of it's content will be provided\n    // as a view element's custom property while data upcasting.\n    editor.data.registerRawContentMatcher({\n      name: 'div',\n      classes: 'raw-html-embed'\n    });\n    editor.conversion.for('upcast').elementToElement({\n      view: {\n        name: 'div',\n        classes: 'raw-html-embed'\n      },\n      model: (viewElement, {\n        writer\n      }) => {\n        // The div.raw-html-embed is registered as a raw content element,\n        // so all it's content is available in a custom property.\n        return writer.createElement('rawHtml', {\n          value: viewElement.getCustomProperty('$rawContent')\n        });\n      }\n    });\n    editor.conversion.for('dataDowncast').elementToElement({\n      model: 'rawHtml',\n      view: (modelElement, {\n        writer\n      }) => {\n        return writer.createRawElement('div', {\n          class: 'raw-html-embed'\n        }, function (domElement) {\n          domElement.innerHTML = modelElement.getAttribute('value') || '';\n        });\n      }\n    });\n    editor.conversion.for('editingDowncast').elementToStructure({\n      model: {\n        name: 'rawHtml',\n        attributes: ['value']\n      },\n      view: (modelElement, {\n        writer\n      }) => {\n        let domContentWrapper;\n        let state;\n        let props;\n        const viewContentWrapper = writer.createRawElement('div', {\n          class: 'raw-html-embed__content-wrapper'\n        }, function (domElement) {\n          domContentWrapper = domElement;\n          renderContent({\n            editor,\n            domElement,\n            state,\n            props\n          });\n          // Since there is a `data-cke-ignore-events` attribute set on the wrapper element in the editable mode,\n          // the explicit `mousedown` handler on the `capture` phase is needed to move the selection onto the whole\n          // HTML embed widget.\n          domContentWrapper.addEventListener('mousedown', () => {\n            if (state.isEditable) {\n              const model = editor.model;\n              const selectedElement = model.document.selection.getSelectedElement();\n              // Move the selection onto the whole HTML embed widget if it's currently not selected.\n              if (selectedElement !== modelElement) {\n                model.change(writer => writer.setSelection(modelElement, 'on'));\n              }\n            }\n          }, true);\n        });\n        // API exposed on each raw HTML embed widget so other features can control a particular widget.\n        const rawHtmlApi = {\n          makeEditable() {\n            state = Object.assign({}, state, {\n              isEditable: true\n            });\n            renderContent({\n              domElement: domContentWrapper,\n              editor,\n              state,\n              props\n            });\n            view.change(writer => {\n              writer.setAttribute('data-cke-ignore-events', 'true', viewContentWrapper);\n            });\n            // This could be potentially pulled to a separate method called focusTextarea().\n            domContentWrapper.querySelector('textarea').focus();\n          },\n          save(newValue) {\n            // If the value didn't change, we just cancel. If it changed,\n            // it's enough to update the model â€“ the entire widget will be reconverted.\n            if (newValue !== state.getRawHtmlValue()) {\n              editor.execute('htmlEmbed', newValue);\n              editor.editing.view.focus();\n            } else {\n              this.cancel();\n            }\n          },\n          cancel() {\n            state = Object.assign({}, state, {\n              isEditable: false\n            });\n            renderContent({\n              domElement: domContentWrapper,\n              editor,\n              state,\n              props\n            });\n            editor.editing.view.focus();\n            view.change(writer => {\n              writer.removeAttribute('data-cke-ignore-events', viewContentWrapper);\n            });\n          }\n        };\n        state = {\n          showPreviews: htmlEmbedConfig.showPreviews,\n          isEditable: false,\n          getRawHtmlValue: () => modelElement.getAttribute('value') || ''\n        };\n        props = {\n          sanitizeHtml: htmlEmbedConfig.sanitizeHtml,\n          textareaPlaceholder: t('Paste raw HTML here...'),\n          onEditClick() {\n            rawHtmlApi.makeEditable();\n          },\n          onSaveClick(newValue) {\n            rawHtmlApi.save(newValue);\n          },\n          onCancelClick() {\n            rawHtmlApi.cancel();\n          }\n        };\n        const viewContainer = writer.createContainerElement('div', {\n          class: 'raw-html-embed',\n          'data-html-embed-label': t('HTML snippet'),\n          dir: editor.locale.uiLanguageDirection\n        }, viewContentWrapper);\n        writer.setCustomProperty('rawHtmlApi', rawHtmlApi, viewContainer);\n        writer.setCustomProperty('rawHtml', true, viewContainer);\n        return toWidget(viewContainer, writer, {\n          label: t('HTML snippet'),\n          hasSelectionHandle: true\n        });\n      }\n    });\n    function renderContent({\n      editor,\n      domElement,\n      state,\n      props\n    }) {\n      // Remove all children;\n      domElement.textContent = '';\n      const domDocument = domElement.ownerDocument;\n      let domTextarea;\n      if (state.isEditable) {\n        const textareaProps = {\n          isDisabled: false,\n          placeholder: props.textareaPlaceholder\n        };\n        domTextarea = createDomTextarea({\n          domDocument,\n          state,\n          props: textareaProps\n        });\n        domElement.append(domTextarea);\n      } else if (state.showPreviews) {\n        const previewContainerProps = {\n          sanitizeHtml: props.sanitizeHtml\n        };\n        domElement.append(createPreviewContainer({\n          domDocument,\n          state,\n          props: previewContainerProps,\n          editor\n        }));\n      } else {\n        const textareaProps = {\n          isDisabled: true,\n          placeholder: props.textareaPlaceholder\n        };\n        domElement.append(createDomTextarea({\n          domDocument,\n          state,\n          props: textareaProps\n        }));\n      }\n      const buttonsWrapperProps = {\n        onEditClick: props.onEditClick,\n        onSaveClick: () => {\n          props.onSaveClick(domTextarea.value);\n        },\n        onCancelClick: props.onCancelClick\n      };\n      domElement.prepend(createDomButtonsWrapper({\n        editor,\n        domDocument,\n        state,\n        props: buttonsWrapperProps\n      }));\n    }\n    function createDomButtonsWrapper({\n      editor,\n      domDocument,\n      state,\n      props\n    }) {\n      const domButtonsWrapper = createElement(domDocument, 'div', {\n        class: 'raw-html-embed__buttons-wrapper'\n      });\n      if (state.isEditable) {\n        const saveButtonView = createUIButton(editor, 'save', props.onSaveClick);\n        const cancelButtonView = createUIButton(editor, 'cancel', props.onCancelClick);\n        domButtonsWrapper.append(saveButtonView.element, cancelButtonView.element);\n        widgetButtonViewReferences.add(saveButtonView).add(cancelButtonView);\n      } else {\n        const editButtonView = createUIButton(editor, 'edit', props.onEditClick);\n        domButtonsWrapper.append(editButtonView.element);\n        widgetButtonViewReferences.add(editButtonView);\n      }\n      return domButtonsWrapper;\n    }\n    function createDomTextarea({\n      domDocument,\n      state,\n      props\n    }) {\n      const domTextarea = createElement(domDocument, 'textarea', {\n        placeholder: props.placeholder,\n        class: 'ck ck-reset ck-input ck-input-text raw-html-embed__source'\n      });\n      domTextarea.disabled = props.isDisabled;\n      domTextarea.value = state.getRawHtmlValue();\n      return domTextarea;\n    }\n    function createPreviewContainer({\n      editor,\n      domDocument,\n      state,\n      props\n    }) {\n      const sanitizedOutput = props.sanitizeHtml(state.getRawHtmlValue());\n      const placeholderText = state.getRawHtmlValue().length > 0 ? t('No preview available') : t('Empty snippet content');\n      const domPreviewPlaceholder = createElement(domDocument, 'div', {\n        class: 'ck ck-reset_all raw-html-embed__preview-placeholder'\n      }, placeholderText);\n      const domPreviewContent = createElement(domDocument, 'div', {\n        class: 'raw-html-embed__preview-content',\n        dir: editor.locale.contentLanguageDirection\n      });\n      // Creating a contextual document fragment allows executing scripts when inserting into the preview element.\n      // See: #8326.\n      const domRange = domDocument.createRange();\n      const domDocumentFragment = domRange.createContextualFragment(sanitizedOutput.html);\n      domPreviewContent.appendChild(domDocumentFragment);\n      const domPreviewContainer = createElement(domDocument, 'div', {\n        class: 'raw-html-embed__preview'\n      }, [domPreviewPlaceholder, domPreviewContent]);\n      return domPreviewContainer;\n    }\n  }\n}\n/**\n * Returns a UI button view that can be used in conversion.\n */\nfunction createUIButton(editor, type, onClick) {\n  const {\n    t\n  } = editor.locale;\n  const buttonView = new ButtonView(editor.locale);\n  const command = editor.commands.get('htmlEmbed');\n  buttonView.set({\n    class: `raw-html-embed__${type}-button`,\n    icon: IconPencil,\n    tooltip: true,\n    tooltipPosition: editor.locale.uiLanguageDirection === 'rtl' ? 'e' : 'w'\n  });\n  buttonView.render();\n  if (type === 'edit') {\n    buttonView.set({\n      icon: IconPencil,\n      label: t('Edit source')\n    });\n    buttonView.bind('isEnabled').to(command);\n  } else if (type === 'save') {\n    buttonView.set({\n      icon: IconCheck,\n      label: t('Save changes')\n    });\n    buttonView.bind('isEnabled').to(command);\n  } else {\n    buttonView.set({\n      icon: IconCancel,\n      label: t('Cancel')\n    });\n  }\n  buttonView.on('execute', onClick);\n  return buttonView;\n}\n\n/**\n * The HTML embed UI plugin.\n */\nclass HtmlEmbedUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HtmlEmbedUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const t = locale.t;\n    // Add the `htmlEmbed` button to feature components.\n    editor.ui.componentFactory.add('htmlEmbed', () => {\n      const buttonView = this._createButton(ButtonView);\n      buttonView.set({\n        tooltip: true,\n        label: t('Insert HTML')\n      });\n      return buttonView;\n    });\n    editor.ui.componentFactory.add('menuBar:htmlEmbed', () => {\n      const buttonView = this._createButton(MenuBarMenuListItemButtonView);\n      buttonView.set({\n        label: t('HTML snippet')\n      });\n      return buttonView;\n    });\n  }\n  /**\n  * Creates a button for html embed command to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const command = editor.commands.get('htmlEmbed');\n    const view = new ButtonClass(editor.locale);\n    view.set({\n      icon: IconHtml\n    });\n    view.bind('isEnabled').to(command, 'isEnabled');\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.execute('htmlEmbed');\n      editor.editing.view.focus();\n      const rawHtmlApi = editor.editing.view.document.selection.getSelectedElement().getCustomProperty('rawHtmlApi');\n      rawHtmlApi.makeEditable();\n    });\n    return view;\n  }\n}\n\n/**\n * The HTML embed feature.\n *\n * It allows inserting HTML snippets directly into the editor.\n *\n * For a detailed overview, check the {@glink features/html/html-embed HTML embed feature} documentation.\n */\nclass HtmlEmbed extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [HtmlEmbedEditing, HtmlEmbedUI, Widget];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HtmlEmbed';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { HtmlEmbed, HtmlEmbedEditing, HtmlEmbedUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { toArray, priorities, CKEditorError, isValidAttributeName, uid, logWarning, global } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { Matcher, StylesMap, UpcastWriter, HtmlDataProcessor } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { toWidget, Widget } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { startCase, cloneDeep, mergeWith, isPlainObject, isEqual } from 'es-toolkit/compat';\nimport { Enter } from '@ckeditor/ckeditor5-enter/dist/index.js';\n\n/**\n* Helper function for the downcast converter. Updates attributes on the given view element.\n*\n* @param writer The view writer.\n* @param oldViewAttributes The previous GHS attribute value.\n* @param newViewAttributes The current GHS attribute value.\n* @param viewElement The view element to update.\n*/\nfunction updateViewAttributes(writer, oldViewAttributes, newViewAttributes, viewElement) {\n  if (oldViewAttributes) {\n    removeViewAttributes(writer, oldViewAttributes, viewElement);\n  }\n  if (newViewAttributes) {\n    setViewAttributes(writer, newViewAttributes, viewElement);\n  }\n}\n/**\n * Helper function for the downcast converter. Sets attributes on the given view element.\n *\n * @param writer The view writer.\n * @param viewAttributes The GHS attribute value.\n * @param viewElement The view element to update.\n */\nfunction setViewAttributes(writer, viewAttributes, viewElement) {\n  if (viewAttributes.attributes) {\n    for (const [key, value] of Object.entries(viewAttributes.attributes)) {\n      writer.setAttribute(key, value, viewElement);\n    }\n  }\n  if (viewAttributes.styles) {\n    writer.setStyle(viewAttributes.styles, viewElement);\n  }\n  if (viewAttributes.classes) {\n    writer.addClass(viewAttributes.classes, viewElement);\n  }\n}\n/**\n * Helper function for the downcast converter. Removes attributes on the given view element.\n *\n * @param writer The view writer.\n * @param viewAttributes The GHS attribute value.\n * @param viewElement The view element to update.\n */\nfunction removeViewAttributes(writer, viewAttributes, viewElement) {\n  if (viewAttributes.attributes) {\n    for (const [key] of Object.entries(viewAttributes.attributes)) {\n      writer.removeAttribute(key, viewElement);\n    }\n  }\n  if (viewAttributes.styles) {\n    for (const style of Object.keys(viewAttributes.styles)) {\n      writer.removeStyle(style, viewElement);\n    }\n  }\n  if (viewAttributes.classes) {\n    writer.removeClass(viewAttributes.classes, viewElement);\n  }\n}\n/**\n* Merges view element attribute objects.\n*/\nfunction mergeViewElementAttributes(target, source) {\n  const result = cloneDeep(target);\n  let key = 'attributes';\n  for (key in source) {\n    // Merge classes.\n    if (key == 'classes') {\n      result[key] = Array.from(new Set([...(target[key] || []), ...source[key]]));\n    } else {\n      result[key] = {\n        ...target[key],\n        ...source[key]\n      };\n    }\n  }\n  return result;\n}\nfunction modifyGhsAttribute(writer, item, ghsAttributeName, subject, callback) {\n  const oldValue = item.getAttribute(ghsAttributeName);\n  const newValue = {};\n  for (const kind of ['attributes', 'styles', 'classes']) {\n    // Properties other than `subject` should be assigned from `oldValue`.\n    if (kind != subject) {\n      if (oldValue && oldValue[kind]) {\n        newValue[kind] = oldValue[kind];\n      }\n      continue;\n    }\n    // `callback` should be applied on property [`subject`].\n    if (subject == 'classes') {\n      const values = new Set(oldValue && oldValue.classes || []);\n      callback(values);\n      if (values.size) {\n        newValue[kind] = Array.from(values);\n      }\n      continue;\n    }\n    const values = new Map(Object.entries(oldValue && oldValue[kind] || {}));\n    callback(values);\n    if (values.size) {\n      newValue[kind] = Object.fromEntries(values);\n    }\n  }\n  if (Object.keys(newValue).length) {\n    if (item.is('documentSelection')) {\n      writer.setSelectionAttribute(ghsAttributeName, newValue);\n    } else {\n      writer.setAttribute(ghsAttributeName, newValue, item);\n    }\n  } else if (oldValue) {\n    if (item.is('documentSelection')) {\n      writer.removeSelectionAttribute(ghsAttributeName);\n    } else {\n      writer.removeAttribute(ghsAttributeName, item);\n    }\n  }\n}\n/**\n * Transforms passed string to PascalCase format. Examples:\n * * `div` => `Div`\n * * `h1` => `H1`\n * * `table` => `Table`\n */\nfunction toPascalCase(data) {\n  return startCase(data).replace(/ /g, '');\n}\n/**\n * Returns the attribute name of the model element that holds raw HTML attributes.\n */\nfunction getHtmlAttributeName(viewElementName) {\n  return `html${toPascalCase(viewElementName)}Attributes`;\n}\n\n/**\n * View-to-model conversion helper for object elements.\n *\n * Preserves object element content in `htmlContent` attribute.\n *\n * @returns Returns a conversion callback.\n*/\nfunction viewToModelObjectConverter({\n  model: modelName\n}) {\n  return (viewElement, conversionApi) => {\n    // Let's keep element HTML and its attributes, so we can rebuild element in downcast conversions.\n    return conversionApi.writer.createElement(modelName, {\n      htmlContent: viewElement.getCustomProperty('$rawContent')\n    });\n  };\n}\n/**\n * Conversion helper converting an object element to an HTML object widget.\n *\n * @returns Returns a conversion callback.\n*/\nfunction toObjectWidgetConverter(editor, {\n  view: viewName,\n  isInline\n}) {\n  const t = editor.t;\n  return (modelElement, {\n    writer\n  }) => {\n    const widgetLabel = t('HTML object');\n    const viewElement = createObjectView(viewName, modelElement, writer);\n    const viewAttributes = modelElement.getAttribute(getHtmlAttributeName(viewName));\n    writer.addClass('html-object-embed__content', viewElement);\n    if (viewAttributes) {\n      setViewAttributes(writer, viewAttributes, viewElement);\n    }\n    // Widget cannot be a raw element because the widget system would not be able\n    // to add its UI to it. Thus, we need separate view container.\n    const viewContainer = writer.createContainerElement(isInline ? 'span' : 'div', {\n      class: 'html-object-embed',\n      'data-html-object-embed-label': widgetLabel\n    }, viewElement);\n    return toWidget(viewContainer, writer, {\n      label: widgetLabel\n    });\n  };\n}\n/**\n* Creates object view element from the given model element.\n*/\nfunction createObjectView(viewName, modelElement, writer) {\n  return writer.createRawElement(viewName, null, (domElement, domConverter) => {\n    domConverter.setContentOf(domElement, modelElement.getAttribute('htmlContent'));\n  });\n}\n/**\n * View-to-attribute conversion helper preserving inline element attributes on `$text`.\n *\n * @returns Returns a conversion callback.\n*/\nfunction viewToAttributeInlineConverter({\n  view: viewName,\n  model: attributeKey,\n  allowEmpty\n}, dataFilter) {\n  return dispatcher => {\n    dispatcher.on(`element:${viewName}`, (evt, data, conversionApi) => {\n      let viewAttributes = dataFilter.processViewAttributes(data.viewItem, conversionApi);\n      // Do not apply the attribute if the element itself is already consumed and there are no view attributes to store.\n      if (!viewAttributes && !conversionApi.consumable.test(data.viewItem, {\n        name: true\n      })) {\n        return;\n      }\n      // Otherwise, we might need to convert it to an empty object just to preserve element itself,\n      // for example `<cite>` => <$text htmlCite=\"{}\">.\n      viewAttributes = viewAttributes || {};\n      // Consume the element itself if it wasn't consumed by any other converter.\n      conversionApi.consumable.consume(data.viewItem, {\n        name: true\n      });\n      // Since we are converting to attribute we need a range on which we will set the attribute.\n      // If the range is not created yet, we will create it.\n      if (!data.modelRange) {\n        data = Object.assign(data, conversionApi.convertChildren(data.viewItem, data.modelCursor));\n      }\n      // Convert empty inline element if allowed and has any attributes.\n      if (allowEmpty && data.modelRange.isCollapsed && Object.keys(viewAttributes).length) {\n        const modelElement = conversionApi.writer.createElement('htmlEmptyElement');\n        if (!conversionApi.safeInsert(modelElement, data.modelCursor)) {\n          return;\n        }\n        const parts = conversionApi.getSplitParts(modelElement);\n        data.modelRange = conversionApi.writer.createRange(data.modelRange.start, conversionApi.writer.createPositionAfter(parts[parts.length - 1]));\n        conversionApi.updateConversionResult(modelElement, data);\n        setAttributeOnItem(modelElement, viewAttributes, conversionApi);\n        return;\n      }\n      // Set attribute on each item in range according to the schema.\n      for (const node of data.modelRange.getItems()) {\n        setAttributeOnItem(node, viewAttributes, conversionApi);\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n  function setAttributeOnItem(node, viewAttributes, conversionApi) {\n    if (conversionApi.schema.checkAttribute(node, attributeKey)) {\n      // Node's children are converted recursively, so node can already include model attribute.\n      // We want to extend it, not replace.\n      const nodeAttributes = node.getAttribute(attributeKey);\n      const attributesToAdd = mergeViewElementAttributes(viewAttributes, nodeAttributes || {});\n      conversionApi.writer.setAttribute(attributeKey, attributesToAdd, node);\n    }\n  }\n}\n/**\n * Conversion helper converting an empty inline model element to an HTML element or widget.\n */\nfunction emptyInlineModelElementToViewConverter({\n  model: attributeKey,\n  view: viewName\n}, asWidget) {\n  return (item, {\n    writer,\n    consumable\n  }) => {\n    if (!item.hasAttribute(attributeKey)) {\n      return null;\n    }\n    const viewElement = writer.createContainerElement(viewName);\n    const attributeValue = item.getAttribute(attributeKey);\n    consumable.consume(item, `attribute:${attributeKey}`);\n    setViewAttributes(writer, attributeValue, viewElement);\n    viewElement.getFillerOffset = () => null;\n    return asWidget ? toWidget(viewElement, writer) : viewElement;\n  };\n}\n/**\n * Attribute-to-view conversion helper applying attributes to view element preserved on `$text`.\n *\n * @returns Returns a conversion callback.\n*/\nfunction attributeToViewInlineConverter({\n  priority,\n  view: viewName\n}) {\n  return (attributeValue, conversionApi) => {\n    if (!attributeValue) {\n      return;\n    }\n    const {\n      writer\n    } = conversionApi;\n    const viewElement = writer.createAttributeElement(viewName, null, {\n      priority\n    });\n    setViewAttributes(writer, attributeValue, viewElement);\n    return viewElement;\n  };\n}\n/**\n * View-to-model conversion helper preserving allowed attributes on block element.\n *\n * All matched attributes will be preserved on `html*Attributes` attribute.\n *\n * @returns Returns a conversion callback.\n*/\nfunction viewToModelBlockAttributeConverter({\n  view: viewName\n}, dataFilter) {\n  return dispatcher => {\n    dispatcher.on(`element:${viewName}`, (evt, data, conversionApi) => {\n      // Converting an attribute of an element that has not been converted to anything does not make sense\n      // because there will be nowhere to set that attribute on. At this stage, the element should've already\n      // been converted. A collapsed range can show up in to-do lists (<input>) or complex widgets (e.g. table).\n      // (https://github.com/ckeditor/ckeditor5/issues/11000).\n      if (!data.modelRange || data.modelRange.isCollapsed) {\n        return;\n      }\n      const viewAttributes = dataFilter.processViewAttributes(data.viewItem, conversionApi);\n      if (!viewAttributes) {\n        return;\n      }\n      conversionApi.writer.setAttribute(getHtmlAttributeName(data.viewItem.name), viewAttributes, data.modelRange);\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * Model-to-view conversion helper applying attributes preserved in `html*Attributes` attribute\n * for block elements.\n *\n * @returns Returns a conversion callback.\n*/\nfunction modelToViewBlockAttributeConverter({\n  view: viewName,\n  model: modelName\n}) {\n  return dispatcher => {\n    dispatcher.on(`attribute:${getHtmlAttributeName(viewName)}:${modelName}`, (evt, data, conversionApi) => {\n      if (!conversionApi.consumable.consume(data.item, evt.name)) {\n        return;\n      }\n      const {\n        attributeOldValue,\n        attributeNewValue\n      } = data;\n      const viewWriter = conversionApi.writer;\n      const viewElement = conversionApi.mapper.toViewElement(data.item);\n      updateViewAttributes(viewWriter, attributeOldValue, attributeNewValue, viewElement);\n    });\n  };\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module html-support/schemadefinitions\n    */ // Skipped elements due to HTML deprecation:\n// * noframes (not sure if we should provide support for this element. CKE4 is not supporting frameset and frame,\n//   but it will unpack <frameset><noframes>foobar</noframes></frameset> to <noframes>foobar</noframes>, so there\n//   may be some content loss. Although using noframes as a standalone element seems invalid)\n// * keygen (this one is also empty)\n// * applet (support is limited mostly to old IE)\n// * basefont (this one is also empty)\n// * isindex (basically no support for modern browsers at all)\n//\n// Skipped elements due to lack empty element support:\n// * hr\n// * area\n// * br\n// * command\n// * map\n// * wbr\n// * colgroup -> col\n//\n// Skipped elements due to complexity:\n// * datalist with option elements used as a data source for input[list] element\n//\n// Skipped elements as they are handled as an object content:\n// * track\n// * source\n// * option\n// * param\n// * optgroup\n//\n// Skipped full page HTML elements:\n// * body\n// * html\n// * title\n// * head\n// * meta\n// * link\n// * etc...\n//\n// Skipped hidden elements:\n// noscript\nvar defaultConfig = {\n  block: [\n  // Existing features.\n  {\n    model: 'codeBlock',\n    view: 'pre'\n  }, {\n    model: 'paragraph',\n    view: 'p'\n  }, {\n    model: 'blockQuote',\n    view: 'blockquote'\n  }, {\n    model: 'listItem',\n    view: 'li'\n  }, {\n    model: 'pageBreak',\n    view: 'div'\n  }, {\n    model: 'rawHtml',\n    view: 'div'\n  }, {\n    model: 'table',\n    view: 'table'\n  }, {\n    model: 'tableRow',\n    view: 'tr'\n  }, {\n    model: 'tableCell',\n    view: 'td'\n  }, {\n    model: 'tableCell',\n    view: 'th'\n  }, {\n    model: 'tableColumnGroup',\n    view: 'colgroup'\n  }, {\n    model: 'tableColumn',\n    view: 'col'\n  }, {\n    model: 'caption',\n    view: 'caption'\n  }, {\n    model: 'caption',\n    view: 'figcaption'\n  }, {\n    model: 'imageBlock',\n    view: 'img'\n  }, {\n    model: 'imageInline',\n    view: 'img'\n  }, {\n    model: 'horizontalLine',\n    view: 'hr'\n  },\n  // Compatibility features.\n  {\n    model: 'htmlP',\n    view: 'p',\n    modelSchema: {\n      inheritAllFrom: '$block'\n    }\n  }, {\n    model: 'htmlBlockquote',\n    view: 'blockquote',\n    modelSchema: {\n      inheritAllFrom: '$container'\n    }\n  }, {\n    model: 'htmlTable',\n    view: 'table',\n    modelSchema: {\n      allowWhere: '$block',\n      isBlock: true\n    }\n  }, {\n    model: 'htmlTbody',\n    view: 'tbody',\n    modelSchema: {\n      allowIn: 'htmlTable',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlThead',\n    view: 'thead',\n    modelSchema: {\n      allowIn: 'htmlTable',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlTfoot',\n    view: 'tfoot',\n    modelSchema: {\n      allowIn: 'htmlTable',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlCaption',\n    view: 'caption',\n    modelSchema: {\n      allowIn: 'htmlTable',\n      allowChildren: '$text',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlColgroup',\n    view: 'colgroup',\n    modelSchema: {\n      allowIn: 'htmlTable',\n      allowChildren: 'col',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlCol',\n    view: 'col',\n    modelSchema: {\n      allowIn: 'htmlColgroup',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlTr',\n    view: 'tr',\n    modelSchema: {\n      allowIn: ['htmlTable', 'htmlThead', 'htmlTbody'],\n      isLimit: true\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlTd',\n    view: 'td',\n    modelSchema: {\n      allowIn: 'htmlTr',\n      allowContentOf: '$container',\n      isLimit: true,\n      isBlock: false\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlTh',\n    view: 'th',\n    modelSchema: {\n      allowIn: 'htmlTr',\n      allowContentOf: '$container',\n      isLimit: true,\n      isBlock: false\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlFigure',\n    view: 'figure',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  },\n  // TODO can also include other block elements.\n  {\n    model: 'htmlFigcaption',\n    view: 'figcaption',\n    modelSchema: {\n      allowIn: 'htmlFigure',\n      allowChildren: '$text',\n      isBlock: false\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlAddress',\n    view: 'address',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlAside',\n    view: 'aside',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlMain',\n    view: 'main',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlDetails',\n    view: 'details',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlSummary',\n    view: 'summary',\n    modelSchema: {\n      allowChildren: ['htmlH1', 'htmlH2', 'htmlH3', 'htmlH4', 'htmlH5', 'htmlH6', '$text'],\n      allowIn: 'htmlDetails',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlDiv',\n    view: 'div',\n    paragraphLikeModel: 'htmlDivParagraph',\n    modelSchema: {\n      inheritAllFrom: '$container'\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlFieldset',\n    view: 'fieldset',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  },\n  // TODO can also include h1-h6.\n  {\n    model: 'htmlLegend',\n    view: 'legend',\n    modelSchema: {\n      allowIn: 'htmlFieldset',\n      allowChildren: '$text'\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlHeader',\n    view: 'header',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlFooter',\n    view: 'footer',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlForm',\n    view: 'form',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: true\n    }\n  }, {\n    model: 'htmlHgroup',\n    view: 'hgroup',\n    modelSchema: {\n      allowIn: ['$root', '$container'],\n      allowChildren: ['paragraph', 'htmlP', 'htmlH1', 'htmlH2', 'htmlH3', 'htmlH4', 'htmlH5', 'htmlH6'],\n      isBlock: false\n    }\n  }, {\n    model: 'htmlH1',\n    view: 'h1',\n    modelSchema: {\n      inheritAllFrom: '$block'\n    }\n  }, {\n    model: 'htmlH2',\n    view: 'h2',\n    modelSchema: {\n      inheritAllFrom: '$block'\n    }\n  }, {\n    model: 'htmlH3',\n    view: 'h3',\n    modelSchema: {\n      inheritAllFrom: '$block'\n    }\n  }, {\n    model: 'htmlH4',\n    view: 'h4',\n    modelSchema: {\n      inheritAllFrom: '$block'\n    }\n  }, {\n    model: 'htmlH5',\n    view: 'h5',\n    modelSchema: {\n      inheritAllFrom: '$block'\n    }\n  }, {\n    model: 'htmlH6',\n    view: 'h6',\n    modelSchema: {\n      inheritAllFrom: '$block'\n    }\n  }, {\n    model: '$htmlList',\n    modelSchema: {\n      allowWhere: '$container',\n      allowChildren: ['$htmlList', 'htmlLi'],\n      isBlock: false\n    }\n  }, {\n    model: 'htmlDir',\n    view: 'dir',\n    modelSchema: {\n      inheritAllFrom: '$htmlList'\n    }\n  }, {\n    model: 'htmlMenu',\n    view: 'menu',\n    modelSchema: {\n      inheritAllFrom: '$htmlList'\n    }\n  }, {\n    model: 'htmlUl',\n    view: 'ul',\n    modelSchema: {\n      inheritAllFrom: '$htmlList'\n    }\n  }, {\n    model: 'htmlOl',\n    view: 'ol',\n    modelSchema: {\n      inheritAllFrom: '$htmlList'\n    }\n  },\n  // TODO can also include other block elements.\n  {\n    model: 'htmlLi',\n    view: 'li',\n    modelSchema: {\n      allowIn: '$htmlList',\n      allowChildren: '$text',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlPre',\n    view: 'pre',\n    modelSchema: {\n      inheritAllFrom: '$block'\n    }\n  }, {\n    model: 'htmlArticle',\n    view: 'article',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlSection',\n    view: 'section',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  },\n  // TODO can also include text.\n  {\n    model: 'htmlNav',\n    view: 'nav',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlDivDl',\n    view: 'div',\n    modelSchema: {\n      allowChildren: ['htmlDt', 'htmlDd'],\n      allowIn: 'htmlDl'\n    }\n  }, {\n    model: 'htmlDl',\n    view: 'dl',\n    modelSchema: {\n      allowWhere: '$container',\n      allowChildren: ['htmlDt', 'htmlDd', 'htmlDivDl'],\n      isBlock: false\n    }\n  }, {\n    model: 'htmlDt',\n    view: 'dt',\n    modelSchema: {\n      allowChildren: '$block',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlDd',\n    view: 'dd',\n    modelSchema: {\n      allowChildren: '$block',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlCenter',\n    view: 'center',\n    modelSchema: {\n      inheritAllFrom: '$container',\n      isBlock: false\n    }\n  }, {\n    model: 'htmlHr',\n    view: 'hr',\n    isEmpty: true,\n    modelSchema: {\n      inheritAllFrom: '$blockObject'\n    }\n  }],\n  inline: [\n  // Existing features (attribute set on an existing model element).\n  {\n    model: 'htmlLiAttributes',\n    view: 'li',\n    appliesToBlock: true,\n    coupledAttribute: 'listItemId'\n  }, {\n    model: 'htmlOlAttributes',\n    view: 'ol',\n    appliesToBlock: true,\n    coupledAttribute: 'listItemId'\n  }, {\n    model: 'htmlUlAttributes',\n    view: 'ul',\n    appliesToBlock: true,\n    coupledAttribute: 'listItemId'\n  }, {\n    model: 'htmlFigureAttributes',\n    view: 'figure',\n    appliesToBlock: 'table'\n  }, {\n    model: 'htmlTheadAttributes',\n    view: 'thead',\n    appliesToBlock: 'table'\n  }, {\n    model: 'htmlTbodyAttributes',\n    view: 'tbody',\n    appliesToBlock: 'table'\n  }, {\n    model: 'htmlFigureAttributes',\n    view: 'figure',\n    appliesToBlock: 'imageBlock'\n  },\n  // Compatibility features.\n  {\n    model: 'htmlAcronym',\n    view: 'acronym',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlTt',\n    view: 'tt',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlFont',\n    view: 'font',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlTime',\n    view: 'time',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlVar',\n    view: 'var',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlBig',\n    view: 'big',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlSmall',\n    view: 'small',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlSamp',\n    view: 'samp',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlQ',\n    view: 'q',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlOutput',\n    view: 'output',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlKbd',\n    view: 'kbd',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlBdi',\n    view: 'bdi',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlBdo',\n    view: 'bdo',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlAbbr',\n    view: 'abbr',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlA',\n    view: 'a',\n    priority: 5,\n    coupledAttribute: 'linkHref'\n  }, {\n    model: 'htmlStrong',\n    view: 'strong',\n    coupledAttribute: 'bold',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlB',\n    view: 'b',\n    coupledAttribute: 'bold',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlI',\n    view: 'i',\n    coupledAttribute: 'italic',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlEm',\n    view: 'em',\n    coupledAttribute: 'italic',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlS',\n    view: 's',\n    coupledAttribute: 'strikethrough',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  },\n  // TODO According to HTML-spec can behave as div-like element, although CKE4 only handles it as an inline element.\n  {\n    model: 'htmlDel',\n    view: 'del',\n    coupledAttribute: 'strikethrough',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  },\n  // TODO According to HTML-spec can behave as div-like element, although CKE4 only handles it as an inline element.\n  {\n    model: 'htmlIns',\n    view: 'ins',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlU',\n    view: 'u',\n    coupledAttribute: 'underline',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlSub',\n    view: 'sub',\n    coupledAttribute: 'subscript',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlSup',\n    view: 'sup',\n    coupledAttribute: 'superscript',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlCode',\n    view: 'code',\n    coupledAttribute: 'code',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlMark',\n    view: 'mark',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlSpan',\n    view: 'span',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlCite',\n    view: 'cite',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlLabel',\n    view: 'label',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  }, {\n    model: 'htmlDfn',\n    view: 'dfn',\n    attributeProperties: {\n      copyOnEnter: true,\n      isFormatting: true\n    }\n  },\n  // Objects.\n  {\n    model: 'htmlObject',\n    view: 'object',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlIframe',\n    view: 'iframe',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlInput',\n    view: 'input',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlButton',\n    view: 'button',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlTextarea',\n    view: 'textarea',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlSelect',\n    view: 'select',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlVideo',\n    view: 'video',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlEmbed',\n    view: 'embed',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlOembed',\n    view: 'oembed',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlAudio',\n    view: 'audio',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlImg',\n    view: 'img',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlCanvas',\n    view: 'canvas',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  },\n  // TODO it could be probably represented as non-object element, although it has graphical representation,\n  // so probably makes more sense to keep it as an object.\n  {\n    model: 'htmlMeter',\n    view: 'meter',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  },\n  // TODO it could be probably represented as non-object element, although it has graphical representation,\n  // so probably makes more sense to keep it as an object.\n  {\n    model: 'htmlProgress',\n    view: 'progress',\n    isObject: true,\n    modelSchema: {\n      inheritAllFrom: '$inlineObject'\n    }\n  }, {\n    model: 'htmlScript',\n    view: 'script',\n    modelSchema: {\n      allowWhere: ['$text', '$block'],\n      isInline: true\n    }\n  }, {\n    model: 'htmlStyle',\n    view: 'style',\n    modelSchema: {\n      allowWhere: ['$text', '$block'],\n      isInline: true\n    }\n  }, {\n    model: 'htmlCustomElement',\n    view: '$customElement',\n    modelSchema: {\n      allowWhere: ['$text', '$block'],\n      allowAttributesOf: '$inlineObject',\n      isInline: true\n    }\n  }]\n};\n\n/**\n * Holds representation of the extended HTML document type definitions to be used by the\n * editor in HTML support.\n *\n * Data schema is represented by data schema definitions.\n *\n * To add new definition for block element,\n * use {@link module:html-support/dataschema~DataSchema#registerBlockElement} method:\n *\n * ```ts\n * dataSchema.registerBlockElement( {\n * \tview: 'section',\n * \tmodel: 'my-section',\n * \tmodelSchema: {\n * \t\tinheritAllFrom: '$block'\n * \t}\n * } );\n * ```\n *\n * To add new definition for inline element,\n * use {@link module:html-support/dataschema~DataSchema#registerInlineElement} method:\n *\n * ```\n * dataSchema.registerInlineElement( {\n * \tview: 'span',\n * \tmodel: 'my-span',\n * \tattributeProperties: {\n * \t\tcopyOnEnter: true\n * \t}\n * } );\n * ```\n */\nclass DataSchema extends Plugin {\n  /**\n  * A map of registered data schema definitions.\n  */\n  _definitions = [];\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'DataSchema';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    for (const definition of defaultConfig.block) {\n      this.registerBlockElement(definition);\n    }\n    for (const definition of defaultConfig.inline) {\n      this.registerInlineElement(definition);\n    }\n  }\n  /**\n  * Add new data schema definition describing block element.\n  */\n  registerBlockElement(definition) {\n    this._definitions.push({\n      ...definition,\n      isBlock: true\n    });\n  }\n  /**\n  * Add new data schema definition describing inline element.\n  */\n  registerInlineElement(definition) {\n    this._definitions.push({\n      ...definition,\n      isInline: true\n    });\n  }\n  /**\n  * Updates schema definition describing block element with new properties.\n  *\n  * Creates new scheme if it doesn't exist.\n  * Array properties are concatenated with original values.\n  *\n  * @param definition Definition update.\n  */\n  extendBlockElement(definition) {\n    this._extendDefinition({\n      ...definition,\n      isBlock: true\n    });\n  }\n  /**\n  * Updates schema definition describing inline element with new properties.\n  *\n  * Creates new scheme if it doesn't exist.\n  * Array properties are concatenated with original values.\n  *\n  * @param definition Definition update.\n  */\n  extendInlineElement(definition) {\n    this._extendDefinition({\n      ...definition,\n      isInline: true\n    });\n  }\n  /**\n  * Returns all definitions matching the given view name.\n  *\n  * @param includeReferences Indicates if this method should also include definitions of referenced models.\n  */\n  getDefinitionsForView(viewName, includeReferences = false) {\n    const definitions = new Set();\n    for (const definition of this._getMatchingViewDefinitions(viewName)) {\n      if (includeReferences) {\n        for (const reference of this._getReferences(definition.model)) {\n          definitions.add(reference);\n        }\n      }\n      definitions.add(definition);\n    }\n    return definitions;\n  }\n  /**\n  * Returns definitions matching the given model name.\n  */\n  getDefinitionsForModel(modelName) {\n    return this._definitions.filter(definition => definition.model == modelName);\n  }\n  /**\n  * Returns definitions matching the given view name.\n  */\n  _getMatchingViewDefinitions(viewName) {\n    return this._definitions.filter(def => def.view && testViewName(viewName, def.view));\n  }\n  /**\n  * Resolves all definition references registered for the given data schema definition.\n  *\n  * @param modelName Data schema model name.\n  */\n  *_getReferences(modelName) {\n    const inheritProperties = ['inheritAllFrom', 'inheritTypesFrom', 'allowWhere', 'allowContentOf', 'allowAttributesOf'];\n    const definitions = this._definitions.filter(definition => definition.model == modelName);\n    for (const {\n      modelSchema\n    } of definitions) {\n      if (!modelSchema) {\n        continue;\n      }\n      for (const property of inheritProperties) {\n        for (const referenceName of toArray(modelSchema[property] || [])) {\n          const definitions = this._definitions.filter(definition => definition.model == referenceName);\n          for (const definition of definitions) {\n            if (referenceName !== modelName) {\n              yield* this._getReferences(definition.model);\n              yield definition;\n            }\n          }\n        }\n      }\n    }\n  }\n  /**\n  * Updates schema definition with new properties.\n  *\n  * Creates new scheme if it doesn't exist.\n  * Array properties are concatenated with original values.\n  *\n  * @param definition Definition update.\n  */\n  _extendDefinition(definition) {\n    const currentDefinitions = Array.from(this._definitions.entries()).filter(([, currentDefinition]) => currentDefinition.model == definition.model);\n    if (currentDefinitions.length == 0) {\n      this._definitions.push(definition);\n      return;\n    }\n    for (const [idx, currentDefinition] of currentDefinitions) {\n      this._definitions[idx] = mergeWith({}, currentDefinition, definition, (target, source) => {\n        return Array.isArray(target) ? target.concat(source) : undefined;\n      });\n    }\n  }\n}\n/**\n * Test view name against the given pattern.\n */\nfunction testViewName(pattern, viewName) {\n  if (typeof pattern === 'string') {\n    return pattern === viewName;\n  }\n  if (pattern instanceof RegExp) {\n    return pattern.test(viewName);\n  }\n  return false;\n}\n\n/**\n * Allows to validate elements and element attributes registered by {@link module:html-support/dataschema~DataSchema}.\n *\n * To enable registered element in the editor, use {@link module:html-support/datafilter~DataFilter#allowElement} method:\n *\n * ```ts\n * dataFilter.allowElement( 'section' );\n * ```\n *\n * You can also allow or disallow specific element attributes:\n *\n * ```ts\n * // Allow `data-foo` attribute on `section` element.\n * dataFilter.allowAttributes( {\n * \tname: 'section',\n * \tattributes: {\n * \t\t'data-foo': true\n * \t}\n * } );\n *\n * // Disallow `color` style attribute on 'section' element.\n * dataFilter.disallowAttributes( {\n * \tname: 'section',\n * \tstyles: {\n * \t\tcolor: /[\\s\\S]+/\n * \t}\n * } );\n * ```\n *\n * To apply the information about allowed and disallowed attributes in custom integration plugin,\n * use the {@link module:html-support/datafilter~DataFilter#processViewAttributes `processViewAttributes()`} method.\n */\nclass DataFilter extends Plugin {\n  /**\n  * An instance of the {@link module:html-support/dataschema~DataSchema}.\n  */\n  _dataSchema;\n  /**\n  * {@link module:engine/view/matcher~Matcher Matcher} instance describing rules upon which\n  * content attributes should be allowed.\n  */\n  _allowedAttributes;\n  /**\n  * {@link module:engine/view/matcher~Matcher Matcher} instance describing rules upon which\n  * content attributes should be disallowed.\n  */\n  _disallowedAttributes;\n  /**\n  * Allowed element definitions by {@link module:html-support/datafilter~DataFilter#allowElement} method.\n  */\n  _allowedElements;\n  /**\n  * Disallowed element names by {@link module:html-support/datafilter~DataFilter#disallowElement} method.\n  */\n  _disallowedElements;\n  /**\n  * Indicates if {@link module:engine/controller/datacontroller~DataController editor's data controller}\n  * data has been already initialized.\n  */\n  _dataInitialized;\n  /**\n  * Cached map of coupled attributes. Keys are the feature attributes names\n  * and values are arrays with coupled GHS attributes names.\n  */\n  _coupledAttributes;\n  constructor(editor) {\n    super(editor);\n    this._dataSchema = editor.plugins.get('DataSchema');\n    this._allowedAttributes = new Matcher();\n    this._disallowedAttributes = new Matcher();\n    this._allowedElements = new Set();\n    this._disallowedElements = new Set();\n    this._dataInitialized = false;\n    this._coupledAttributes = null;\n    this._registerElementsAfterInit();\n    this._registerElementHandlers();\n    this._registerCoupledAttributesPostFixer();\n    this._registerAssociatedHtmlAttributesPostFixer();\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'DataFilter';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataSchema, Widget];\n  }\n  /**\n  * Load a configuration of one or many elements, where their attributes should be allowed.\n  *\n  * **Note**: Rules will be applied just before next data pipeline data init or set.\n  *\n  * @param config Configuration of elements that should have their attributes accepted in the editor.\n  */\n  loadAllowedConfig(config) {\n    for (const pattern of config) {\n      // MatcherPattern allows omitting `name` to widen the search of elements.\n      // Let's keep it consistent and match every element if a `name` has not been provided.\n      const elementName = pattern.name || /[\\s\\S]+/;\n      const rules = splitRules(pattern);\n      this.allowElement(elementName);\n      rules.forEach(pattern => this.allowAttributes(pattern));\n    }\n  }\n  /**\n  * Load a configuration of one or many elements, where their attributes should be disallowed.\n  *\n  * **Note**: Rules will be applied just before next data pipeline data init or set.\n  *\n  * @param config Configuration of elements that should have their attributes rejected from the editor.\n  */\n  loadDisallowedConfig(config) {\n    for (const pattern of config) {\n      // MatcherPattern allows omitting `name` to widen the search of elements.\n      // Let's keep it consistent and match every element if a `name` has not been provided.\n      const elementName = pattern.name || /[\\s\\S]+/;\n      const rules = splitRules(pattern);\n      // Disallow element itself if there is no other rules.\n      if (rules.length == 0) {\n        this.disallowElement(elementName);\n      } else {\n        rules.forEach(pattern => this.disallowAttributes(pattern));\n      }\n    }\n  }\n  /**\n  * Load a configuration of one or many elements, where when empty should be allowed.\n  *\n  * **Note**: It modifies DataSchema so must be loaded before registering filtering rules.\n  *\n  * @param config Configuration of elements that should be preserved even if empty.\n  */\n  loadAllowedEmptyElementsConfig(config) {\n    for (const elementName of config) {\n      this.allowEmptyElement(elementName);\n    }\n  }\n  /**\n  * Allow the given element in the editor context.\n  *\n  * This method will only allow elements described by the {@link module:html-support/dataschema~DataSchema} used\n  * to create data filter.\n  *\n  * **Note**: Rules will be applied just before next data pipeline data init or set.\n  *\n  * @param viewName String or regular expression matching view name.\n  */\n  allowElement(viewName) {\n    for (const definition of this._dataSchema.getDefinitionsForView(viewName, true)) {\n      this._addAllowedElement(definition);\n      // Reset cached map to recalculate it on the next usage.\n      this._coupledAttributes = null;\n    }\n  }\n  /**\n  * Disallow the given element in the editor context.\n  *\n  * This method will only disallow elements described by the {@link module:html-support/dataschema~DataSchema} used\n  * to create data filter.\n  *\n  * @param viewName String or regular expression matching view name.\n  */\n  disallowElement(viewName) {\n    for (const definition of this._dataSchema.getDefinitionsForView(viewName, false)) {\n      this._disallowedElements.add(definition.view);\n    }\n  }\n  /**\n  * Allow the given empty element in the editor context.\n  *\n  * This method will only allow elements described by the {@link module:html-support/dataschema~DataSchema} used\n  * to create data filter.\n  *\n  * **Note**: It modifies DataSchema so must be called before registering filtering rules.\n  *\n  * @param viewName String or regular expression matching view name.\n  */\n  allowEmptyElement(viewName) {\n    for (const definition of this._dataSchema.getDefinitionsForView(viewName, true)) {\n      if (definition.isInline) {\n        this._dataSchema.extendInlineElement({\n          ...definition,\n          allowEmpty: true\n        });\n      }\n    }\n  }\n  /**\n  * Allow the given attributes for view element allowed by {@link #allowElement} method.\n  *\n  * @param config Pattern matching all attributes which should be allowed.\n  */\n  allowAttributes(config) {\n    this._allowedAttributes.add(config);\n  }\n  /**\n  * Disallow the given attributes for view element allowed by {@link #allowElement} method.\n  *\n  * @param config Pattern matching all attributes which should be disallowed.\n  */\n  disallowAttributes(config) {\n    this._disallowedAttributes.add(config);\n  }\n  /**\n  * Processes all allowed and disallowed attributes on the view element by consuming them and returning the allowed ones.\n  *\n  * This method applies the configuration set up by {@link #allowAttributes `allowAttributes()`}\n  * and {@link #disallowAttributes `disallowAttributes()`} over the given view element by consuming relevant attributes.\n  * It returns the allowed attributes that were found on the given view element for further processing by integration code.\n  *\n  * ```ts\n  * dispatcher.on( 'element:myElement', ( evt, data, conversionApi ) => {\n  * \t// Get rid of disallowed and extract all allowed attributes from a viewElement.\n  * \tconst viewAttributes = dataFilter.processViewAttributes( data.viewItem, conversionApi );\n  * \t// Do something with them, i.e. store inside a model as a dictionary.\n  * \tif ( viewAttributes ) {\n  * \t\tconversionApi.writer.setAttribute( 'htmlAttributesOfMyElement', viewAttributes, data.modelRange );\n  * \t}\n  * } );\n  * ```\n  *\n  * @see module:engine/conversion/viewconsumable~ViewConsumable#consume\n  *\n  * @returns Object with following properties:\n  * - attributes Set with matched attribute names.\n  * - styles Set with matched style names.\n  * - classes Set with matched class names.\n  */\n  processViewAttributes(viewElement, conversionApi) {\n    const {\n      consumable\n    } = conversionApi;\n    // Make sure that the disabled attributes are handled before the allowed attributes are called.\n    // For example, for block images the <figure> converter triggers conversion for <img> first and then for other elements, i.e. <a>.\n    matchAndConsumeAttributes(viewElement, this._disallowedAttributes, consumable);\n    return prepareGHSAttribute(viewElement, matchAndConsumeAttributes(viewElement, this._allowedAttributes, consumable));\n  }\n  /**\n  * Adds allowed element definition and fires registration event.\n  */\n  _addAllowedElement(definition) {\n    if (this._allowedElements.has(definition)) {\n      return;\n    }\n    this._allowedElements.add(definition);\n    // For attribute based integrations (table figure, document lists, etc.) register related element definitions.\n    if ('appliesToBlock' in definition && typeof definition.appliesToBlock == 'string') {\n      for (const relatedDefinition of this._dataSchema.getDefinitionsForModel(definition.appliesToBlock)) {\n        if (relatedDefinition.isBlock) {\n          this._addAllowedElement(relatedDefinition);\n        }\n      }\n    }\n    // We need to wait for all features to be initialized before we can register\n    // element, so we can access existing features model schemas.\n    // If the data has not been initialized yet, _registerElementsAfterInit() method will take care of\n    // registering elements.\n    if (this._dataInitialized) {\n      // Defer registration to the next data pipeline data set so any disallow rules could be applied\n      // even if added after allow rule (disallowElement).\n      this.editor.data.once('set', () => {\n        this._fireRegisterEvent(definition);\n      }, {\n        // With the highest priority listener we are able to register elements right before\n        // running data conversion.\n        priority: priorities.highest + 1\n      });\n    }\n  }\n  /**\n  * Registers elements allowed by {@link module:html-support/datafilter~DataFilter#allowElement} method\n  * once {@link module:engine/controller/datacontroller~DataController editor's data controller} is initialized.\n  */\n  _registerElementsAfterInit() {\n    this.editor.data.on('init', () => {\n      this._dataInitialized = true;\n      for (const definition of this._allowedElements) {\n        this._fireRegisterEvent(definition);\n      }\n    }, {\n      // With highest priority listener we are able to register elements right before\n      // running data conversion. Also:\n      // * Make sure that priority is higher than the one used by `RealTimeCollaborationClient`,\n      // as RTC is stopping event propagation.\n      // * Make sure no other features hook into this event before GHS because otherwise the\n      // downcast conversion (for these features) could run before GHS registered its converters\n      // (https://github.com/ckeditor/ckeditor5/issues/11356).\n      priority: priorities.highest + 1\n    });\n  }\n  /**\n  * Registers default element handlers.\n  */\n  _registerElementHandlers() {\n    this.on('register', (evt, definition) => {\n      const schema = this.editor.model.schema;\n      // Object element should be only registered for new features.\n      // If the model schema is already registered, it should be handled by\n      // #_registerBlockElement() or #_registerObjectElement() attribute handlers.\n      if (definition.isObject && !schema.isRegistered(definition.model)) {\n        this._registerObjectElement(definition);\n      } else if (definition.isBlock) {\n        this._registerBlockElement(definition);\n      } else if (definition.isInline) {\n        this._registerInlineElement(definition);\n      } else {\n        /**\n        * The definition cannot be handled by the data filter.\n        *\n        * Make sure that the registered definition is correct.\n        *\n        * @error data-filter-invalid-definition\n        */\n        throw new CKEditorError('data-filter-invalid-definition', null, definition);\n      }\n      evt.stop();\n    }, {\n      priority: 'lowest'\n    });\n  }\n  /**\n  * Registers a model post-fixer that is removing coupled GHS attributes of inline elements. Those attributes\n  * are removed if a coupled feature attribute is removed.\n  *\n  * For example, consider following HTML:\n  *\n  * ```html\n  * <a href=\"foo.html\" id=\"myId\">bar</a>\n  * ```\n  *\n  * Which would be upcasted to following text node in the model:\n  *\n  * ```html\n  * <$text linkHref=\"foo.html\" htmlA=\"{ attributes: { id: 'myId' } }\">bar</$text>\n  * ```\n  *\n  * When the user removes the link from that text (using UI), only `linkHref` attribute would be removed:\n  *\n  * ```html\n  * <$text htmlA=\"{ attributes: { id: 'myId' } }\">bar</$text>\n  * ```\n  *\n  * The `htmlA` attribute would stay in the model and would cause GHS to generate an `<a>` element.\n  * This is incorrect from UX point of view, as the user wanted to remove the whole link (not only `href`).\n  */\n  _registerCoupledAttributesPostFixer() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    model.document.registerPostFixer(writer => {\n      const changes = model.document.differ.getChanges();\n      let changed = false;\n      const coupledAttributes = this._getCoupledAttributesMap();\n      for (const change of changes) {\n        // Handle only attribute removals.\n        if (change.type != 'attribute' || change.attributeNewValue !== null) {\n          continue;\n        }\n        // Find a list of coupled GHS attributes.\n        const attributeKeys = coupledAttributes.get(change.attributeKey);\n        if (!attributeKeys) {\n          continue;\n        }\n        // Remove the coupled GHS attributes on the same range as the feature attribute was removed.\n        for (const {\n          item\n        } of change.range.getWalker()) {\n          for (const attributeKey of attributeKeys) {\n            if (item.hasAttribute(attributeKey)) {\n              writer.removeAttribute(attributeKey, item);\n              changed = true;\n            }\n          }\n        }\n      }\n      return changed;\n    });\n    this.listenTo(selection, 'change:attribute', (evt, {\n      attributeKeys\n    }) => {\n      const removeAttributes = new Set();\n      const coupledAttributes = this._getCoupledAttributesMap();\n      for (const attributeKey of attributeKeys) {\n        // Handle only attribute removals.\n        if (selection.hasAttribute(attributeKey)) {\n          continue;\n        }\n        // Find a list of coupled GHS attributes.\n        const coupledAttributeKeys = coupledAttributes.get(attributeKey);\n        if (!coupledAttributeKeys) {\n          continue;\n        }\n        for (const coupledAttributeKey of coupledAttributeKeys) {\n          if (selection.hasAttribute(coupledAttributeKey)) {\n            removeAttributes.add(coupledAttributeKey);\n          }\n        }\n      }\n      if (removeAttributes.size == 0) {\n        return;\n      }\n      model.change(writer => {\n        for (const attributeKey of removeAttributes) {\n          writer.removeSelectionAttribute(attributeKey);\n        }\n      });\n    });\n  }\n  /**\n  * Removes `html*Attributes` attributes from incompatible elements.\n  *\n  * For example, consider the following HTML:\n  *\n  * ```html\n  * <heading2 htmlH2Attributes=\"...\">foobar[]</heading2>\n  * ```\n  *\n  * Pressing `enter` creates a new `paragraph` element that inherits\n  * the `htmlH2Attributes` attribute from `heading2`.\n  *\n  * ```html\n  * <heading2 htmlH2Attributes=\"...\">foobar</heading2>\n  * <paragraph htmlH2Attributes=\"...\">[]</paragraph>\n  * ```\n  *\n  * This postfixer ensures that this doesn't happen, and that elements can\n  * only have `html*Attributes` associated with them,\n  * e.g.: `htmlPAttributes` for `<p>`, `htmlDivAttributes` for `<div>`, etc.\n  *\n  * With it enabled, pressing `enter` at the end of `<heading2>` will create\n  * a new paragraph without the `htmlH2Attributes` attribute.\n  *\n  * ```html\n  * <heading2 htmlH2Attributes=\"...\">foobar</heading2>\n  * <paragraph>[]</paragraph>\n  * ```\n  */\n  _registerAssociatedHtmlAttributesPostFixer() {\n    const model = this.editor.model;\n    model.document.registerPostFixer(writer => {\n      const changes = model.document.differ.getChanges();\n      let changed = false;\n      for (const change of changes) {\n        if (change.type !== 'insert' || change.name === '$text') {\n          continue;\n        }\n        for (const attr of change.attributes.keys()) {\n          if (!attr.startsWith('html') || !attr.endsWith('Attributes')) {\n            continue;\n          }\n          if (!model.schema.checkAttribute(change.name, attr)) {\n            writer.removeAttribute(attr, change.position.nodeAfter);\n            changed = true;\n          }\n        }\n      }\n      return changed;\n    });\n  }\n  /**\n  * Collects the map of coupled attributes. The returned map is keyed by the feature attribute name\n  * and coupled GHS attribute names are stored in the value array.\n  */\n  _getCoupledAttributesMap() {\n    if (this._coupledAttributes) {\n      return this._coupledAttributes;\n    }\n    this._coupledAttributes = new Map();\n    for (const definition of this._allowedElements) {\n      if (definition.coupledAttribute && definition.model) {\n        const attributeNames = this._coupledAttributes.get(definition.coupledAttribute);\n        if (attributeNames) {\n          attributeNames.push(definition.model);\n        } else {\n          this._coupledAttributes.set(definition.coupledAttribute, [definition.model]);\n        }\n      }\n    }\n    return this._coupledAttributes;\n  }\n  /**\n  * Fires `register` event for the given element definition.\n  */\n  _fireRegisterEvent(definition) {\n    if (definition.view && this._disallowedElements.has(definition.view)) {\n      return;\n    }\n    this.fire(definition.view ? `register:${definition.view}` : 'register', definition);\n  }\n  /**\n  * Registers object element and attribute converters for the given data schema definition.\n  */\n  _registerObjectElement(definition) {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    const {\n      view: viewName,\n      model: modelName\n    } = definition;\n    schema.register(modelName, definition.modelSchema);\n    /* istanbul ignore next: paranoid check -- @preserve */\n    if (!viewName) {\n      return;\n    }\n    schema.extend(definition.model, {\n      allowAttributes: [getHtmlAttributeName(viewName), 'htmlContent']\n    });\n    // Store element content in special `$rawContent` custom property to\n    // avoid editor's data filtering mechanism.\n    editor.data.registerRawContentMatcher({\n      name: viewName\n    });\n    conversion.for('upcast').elementToElement({\n      view: viewName,\n      model: viewToModelObjectConverter(definition),\n      // With a `low` priority, `paragraph` plugin auto-paragraphing mechanism is executed. Make sure\n      // this listener is called before it. If not, some elements will be transformed into a paragraph.\n      // `+ 2` is used to take priority over `_addDefaultH1Conversion` in the Heading plugin.\n      converterPriority: priorities.low + 2\n    });\n    conversion.for('upcast').add(viewToModelBlockAttributeConverter(definition, this));\n    conversion.for('editingDowncast').elementToStructure({\n      model: {\n        name: modelName,\n        attributes: [getHtmlAttributeName(viewName)]\n      },\n      view: toObjectWidgetConverter(editor, definition)\n    });\n    conversion.for('dataDowncast').elementToElement({\n      model: modelName,\n      view: (modelElement, {\n        writer\n      }) => {\n        return createObjectView(viewName, modelElement, writer);\n      }\n    });\n    conversion.for('dataDowncast').add(modelToViewBlockAttributeConverter(definition));\n  }\n  /**\n  * Registers block element and attribute converters for the given data schema definition.\n  */\n  _registerBlockElement(definition) {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    const {\n      view: viewName,\n      model: modelName\n    } = definition;\n    if (!schema.isRegistered(definition.model)) {\n      // Do not register converters and empty schema for editor existing feature\n      // as empty schema won't allow element anywhere in the model.\n      if (!definition.modelSchema) {\n        return;\n      }\n      schema.register(definition.model, definition.modelSchema);\n      if (!viewName) {\n        return;\n      }\n      conversion.for('upcast').elementToElement({\n        model: modelName,\n        view: viewName,\n        // With a `low` priority, `paragraph` plugin auto-paragraphing mechanism is executed. Make sure\n        // this listener is called before it. If not, some elements will be transformed into a paragraph.\n        // `+ 2` is used to take priority over `_addDefaultH1Conversion` in the Heading plugin.\n        converterPriority: priorities.low + 2\n      });\n      conversion.for('downcast').elementToElement({\n        model: modelName,\n        view: (modelElement, {\n          writer\n        }) => definition.isEmpty ? writer.createEmptyElement(viewName) : writer.createContainerElement(viewName)\n      });\n    }\n    if (!viewName) {\n      return;\n    }\n    schema.extend(definition.model, {\n      allowAttributes: getHtmlAttributeName(viewName)\n    });\n    conversion.for('upcast').add(viewToModelBlockAttributeConverter(definition, this));\n    conversion.for('downcast').add(modelToViewBlockAttributeConverter(definition));\n  }\n  /**\n  * Registers inline element and attribute converters for the given data schema definition.\n  *\n  * Extends `$text` model schema to allow the given definition model attribute and its properties.\n  */\n  _registerInlineElement(definition) {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    const attributeKey = definition.model;\n    // This element is stored in the model as an attribute on a block element, for example DocumentLists.\n    if (definition.appliesToBlock) {\n      return;\n    }\n    schema.extend('$text', {\n      allowAttributes: attributeKey\n    });\n    if (definition.attributeProperties) {\n      schema.setAttributeProperties(attributeKey, definition.attributeProperties);\n    }\n    conversion.for('upcast').add(viewToAttributeInlineConverter(definition, this));\n    conversion.for('downcast').attributeToElement({\n      model: attributeKey,\n      view: attributeToViewInlineConverter(definition)\n    });\n    if (!definition.allowEmpty) {\n      return;\n    }\n    schema.setAttributeProperties(attributeKey, {\n      copyFromObject: false\n    });\n    if (!schema.isRegistered('htmlEmptyElement')) {\n      schema.register('htmlEmptyElement', {\n        inheritAllFrom: '$inlineObject'\n      });\n    }\n    editor.data.htmlProcessor.domConverter.registerInlineObjectMatcher(element => {\n      // Element must be empty and have any attribute.\n      if (element.name == definition.view && element.isEmpty && Array.from(element.getAttributeKeys()).length) {\n        return {\n          name: true\n        };\n      }\n      return null;\n    });\n    conversion.for('editingDowncast').elementToElement({\n      model: 'htmlEmptyElement',\n      view: emptyInlineModelElementToViewConverter(definition, true)\n    });\n    conversion.for('dataDowncast').elementToElement({\n      model: 'htmlEmptyElement',\n      view: emptyInlineModelElementToViewConverter(definition)\n    });\n  }\n}\n/**\n * Matches and consumes matched attributes.\n *\n * @returns Object with following properties:\n * - attributes Array with matched attribute names.\n * - classes Array with matched class names.\n * - styles Array with matched style names.\n */\nfunction matchAndConsumeAttributes(viewElement, matcher, consumable) {\n  const matches = matcher.matchAll(viewElement) || [];\n  const stylesProcessor = viewElement.document.stylesProcessor;\n  return matches.reduce((result, {\n    match\n  }) => {\n    for (const [key, token] of match.attributes || []) {\n      // Verify and consume styles.\n      if (key == 'style') {\n        const style = token;\n        // Check longer forms of the same style as those could be matched\n        // but not present in the element directly.\n        // Consider only longhand (or longer than current notation) so that\n        // we do not include all sides of the box if only one side is allowed.\n        const sortedRelatedStyles = stylesProcessor.getRelatedStyles(style).filter(relatedStyle => relatedStyle.split('-').length > style.split('-').length).sort((a, b) => b.split('-').length - a.split('-').length);\n        for (const relatedStyle of sortedRelatedStyles) {\n          if (consumable.consume(viewElement, {\n            styles: [relatedStyle]\n          })) {\n            result.styles.push(relatedStyle);\n          }\n        }\n        // Verify and consume style as specified in the matcher.\n        if (consumable.consume(viewElement, {\n          styles: [style]\n        })) {\n          result.styles.push(style);\n        }\n      } else if (key == 'class') {\n        const className = token;\n        if (consumable.consume(viewElement, {\n          classes: [className]\n        })) {\n          result.classes.push(className);\n        }\n      } else {\n        // Verify and consume other attributes.\n        if (consumable.consume(viewElement, {\n          attributes: [key]\n        })) {\n          result.attributes.push(key);\n        }\n      }\n    }\n    return result;\n  }, {\n    attributes: [],\n    classes: [],\n    styles: []\n  });\n}\n/**\n * Prepares the GHS attribute value as an object with element attributes' values.\n */\nfunction prepareGHSAttribute(viewElement, {\n  attributes,\n  classes,\n  styles\n}) {\n  if (!attributes.length && !classes.length && !styles.length) {\n    return null;\n  }\n  return {\n    ...(attributes.length && {\n      attributes: getAttributes(viewElement, attributes)\n    }),\n    ...(styles.length && {\n      styles: getReducedStyles(viewElement, styles)\n    }),\n    ...(classes.length && {\n      classes\n    })\n  };\n}\n/**\n * Returns attributes as an object with names and values.\n */\nfunction getAttributes(viewElement, attributes) {\n  const attributesObject = {};\n  for (const key of attributes) {\n    const value = viewElement.getAttribute(key);\n    if (value !== undefined && isValidAttributeName(key)) {\n      attributesObject[key] = value;\n    }\n  }\n  return attributesObject;\n}\n/**\n * Returns styles as an object reduced to shorthand notation without redundant entries.\n */\nfunction getReducedStyles(viewElement, styles) {\n  // Use StyleMap to reduce style value to the minimal form (without shorthand and long-hand notation and duplication).\n  const stylesMap = new StylesMap(viewElement.document.stylesProcessor);\n  for (const key of styles) {\n    const styleValue = viewElement.getStyle(key);\n    if (styleValue !== undefined) {\n      stylesMap.set(key, styleValue);\n    }\n  }\n  return Object.fromEntries(stylesMap.getStylesEntries());\n}\n/**\n * Matcher by default has to match **all** patterns to count it as an actual match. Splitting the pattern\n * into separate patterns means that any matched pattern will be count as a match.\n *\n * @param pattern Pattern to split.\n * @param attributeName Name of the attribute to split (e.g. 'attributes', 'classes', 'styles').\n */\nfunction splitPattern(pattern, attributeName) {\n  const {\n    name\n  } = pattern;\n  const attributeValue = pattern[attributeName];\n  if (isPlainObject(attributeValue)) {\n    return Object.entries(attributeValue).map(([key, value]) => ({\n      name,\n      [attributeName]: {\n        [key]: value\n      }\n    }));\n  }\n  if (Array.isArray(attributeValue)) {\n    return attributeValue.map(value => ({\n      name,\n      [attributeName]: [value]\n    }));\n  }\n  return [pattern];\n}\n/**\n * Rules are matched in conjunction (AND operation), but we want to have a match if *any* of the rules is matched (OR operation).\n * By splitting the rules we force the latter effect.\n */\nfunction splitRules(rules) {\n  const {\n    name,\n    attributes,\n    classes,\n    styles\n  } = rules;\n  const splitRules = [];\n  if (attributes) {\n    splitRules.push(...splitPattern({\n      name,\n      attributes\n    }, 'attributes'));\n  }\n  if (classes) {\n    splitRules.push(...splitPattern({\n      name,\n      classes\n    }, 'classes'));\n  }\n  if (styles) {\n    splitRules.push(...splitPattern({\n      name,\n      styles\n    }, 'styles'));\n  }\n  return splitRules;\n}\n\n/**\n * Provides the General HTML Support integration with {@link module:code-block/codeblock~CodeBlock Code Block} feature.\n */\nclass CodeBlockElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CodeBlockElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    if (!this.editor.plugins.has('CodeBlockEditing')) {\n      return;\n    }\n    const dataFilter = this.editor.plugins.get(DataFilter);\n    dataFilter.on('register:pre', (evt, definition) => {\n      if (definition.model !== 'codeBlock') {\n        return;\n      }\n      const editor = this.editor;\n      const schema = editor.model.schema;\n      const conversion = editor.conversion;\n      // Extend codeBlock to allow attributes required by attribute filtration.\n      schema.extend('codeBlock', {\n        allowAttributes: ['htmlPreAttributes', 'htmlContentAttributes']\n      });\n      conversion.for('upcast').add(viewToModelCodeBlockAttributeConverter(dataFilter));\n      conversion.for('downcast').add(modelToViewCodeBlockAttributeConverter());\n      evt.stop();\n    });\n  }\n}\n/**\n * View-to-model conversion helper preserving allowed attributes on {@link module:code-block/codeblock~CodeBlock Code Block}\n * feature model element.\n *\n * Attributes are preserved as a value of `html*Attributes` model attribute.\n * @param dataFilter\n * @returns Returns a conversion callback.\n */\nfunction viewToModelCodeBlockAttributeConverter(dataFilter) {\n  return dispatcher => {\n    dispatcher.on('element:code', (evt, data, conversionApi) => {\n      const viewCodeElement = data.viewItem;\n      const viewPreElement = viewCodeElement.parent;\n      if (!viewPreElement || !viewPreElement.is('element', 'pre')) {\n        return;\n      }\n      preserveElementAttributes(viewPreElement, 'htmlPreAttributes');\n      preserveElementAttributes(viewCodeElement, 'htmlContentAttributes');\n      function preserveElementAttributes(viewElement, attributeName) {\n        const viewAttributes = dataFilter.processViewAttributes(viewElement, conversionApi);\n        if (viewAttributes) {\n          conversionApi.writer.setAttribute(attributeName, viewAttributes, data.modelRange);\n        }\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * Model-to-view conversion helper applying attributes from {@link module:code-block/codeblock~CodeBlock Code Block}\n * feature model element.\n * @returns Returns a conversion callback.\n */\nfunction modelToViewCodeBlockAttributeConverter() {\n  return dispatcher => {\n    dispatcher.on('attribute:htmlPreAttributes:codeBlock', (evt, data, conversionApi) => {\n      if (!conversionApi.consumable.consume(data.item, evt.name)) {\n        return;\n      }\n      const {\n        attributeOldValue,\n        attributeNewValue\n      } = data;\n      const viewCodeElement = conversionApi.mapper.toViewElement(data.item);\n      const viewPreElement = viewCodeElement.parent;\n      updateViewAttributes(conversionApi.writer, attributeOldValue, attributeNewValue, viewPreElement);\n    });\n    dispatcher.on('attribute:htmlContentAttributes:codeBlock', (evt, data, conversionApi) => {\n      if (!conversionApi.consumable.consume(data.item, evt.name)) {\n        return;\n      }\n      const {\n        attributeOldValue,\n        attributeNewValue\n      } = data;\n      const viewCodeElement = conversionApi.mapper.toViewElement(data.item);\n      updateViewAttributes(conversionApi.writer, attributeOldValue, attributeNewValue, viewCodeElement);\n    });\n  };\n}\n\n/**\n * Provides the General HTML Support integration for elements which can behave like sectioning element (e.g. article) or\n * element accepting only inline content (e.g. paragraph).\n *\n * The distinction between this two content models is important for choosing correct schema model and proper content conversion.\n * As an example, it ensures that:\n *\n * * children elements paragraphing is enabled for sectioning elements only,\n * * element and its content can be correctly handled by editing view (splitting and merging elements),\n * * model element HTML is semantically correct and easier to work with.\n *\n * If element contains any block element, it will be treated as a sectioning element and registered using\n * {@link module:html-support/dataschema~DataSchemaDefinition#model} and\n * {@link module:html-support/dataschema~DataSchemaDefinition#modelSchema} in editor schema.\n * Otherwise, it will be registered under {@link module:html-support/dataschema~DataSchemaBlockElementDefinition#paragraphLikeModel} model\n * name with model schema accepting only inline content (inheriting from `$block`).\n */\nclass DualContentModelElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'DualContentModelElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const dataFilter = this.editor.plugins.get(DataFilter);\n    dataFilter.on('register', (evt, definition) => {\n      const blockDefinition = definition;\n      const editor = this.editor;\n      const schema = editor.model.schema;\n      const conversion = editor.conversion;\n      if (!blockDefinition.paragraphLikeModel) {\n        return;\n      }\n      // Can only apply to newly registered features.\n      if (schema.isRegistered(blockDefinition.model) || schema.isRegistered(blockDefinition.paragraphLikeModel)) {\n        return;\n      }\n      const paragraphLikeModelDefinition = {\n        model: blockDefinition.paragraphLikeModel,\n        view: blockDefinition.view\n      };\n      schema.register(blockDefinition.model, blockDefinition.modelSchema);\n      schema.register(paragraphLikeModelDefinition.model, {\n        inheritAllFrom: '$block'\n      });\n      conversion.for('upcast').elementToElement({\n        view: blockDefinition.view,\n        model: (viewElement, {\n          writer\n        }) => {\n          if (this._hasBlockContent(viewElement)) {\n            return writer.createElement(blockDefinition.model);\n          }\n          return writer.createElement(paragraphLikeModelDefinition.model);\n        },\n        // With a `low` priority, `paragraph` plugin auto-paragraphing mechanism is executed. Make sure\n        // this listener is called before it. If not, some elements will be transformed into a paragraph.\n        converterPriority: priorities.low + 0.5\n      });\n      conversion.for('downcast').elementToElement({\n        view: blockDefinition.view,\n        model: blockDefinition.model\n      });\n      this._addAttributeConversion(blockDefinition);\n      conversion.for('downcast').elementToElement({\n        view: paragraphLikeModelDefinition.view,\n        model: paragraphLikeModelDefinition.model\n      });\n      this._addAttributeConversion(paragraphLikeModelDefinition);\n      evt.stop();\n    });\n  }\n  /**\n  * Checks whether the given view element includes any other block element.\n  */\n  _hasBlockContent(viewElement) {\n    const view = this.editor.editing.view;\n    const blockElements = view.domConverter.blockElements;\n    // Traversing the viewElement subtree looking for block elements.\n    // Especially for the cases like <div><a href=\"#\"><p>foo</p></a></div>.\n    // https://github.com/ckeditor/ckeditor5/issues/11513\n    for (const viewItem of view.createRangeIn(viewElement).getItems()) {\n      if (viewItem.is('element') && blockElements.includes(viewItem.name)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  /**\n  * Adds attribute filtering conversion for the given data schema.\n  */\n  _addAttributeConversion(definition) {\n    const editor = this.editor;\n    const conversion = editor.conversion;\n    const dataFilter = editor.plugins.get(DataFilter);\n    editor.model.schema.extend(definition.model, {\n      allowAttributes: getHtmlAttributeName(definition.view)\n    });\n    conversion.for('upcast').add(viewToModelBlockAttributeConverter(definition, dataFilter));\n    conversion.for('downcast').add(modelToViewBlockAttributeConverter(definition));\n  }\n}\n\n/**\n * Provides the General HTML Support integration with {@link module:heading/heading~Heading Heading} feature.\n */\nclass HeadingElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataSchema, Enter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HeadingElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!editor.plugins.has('HeadingEditing')) {\n      return;\n    }\n    const options = editor.config.get('heading.options');\n    this.registerHeadingElements(editor, options);\n  }\n  /**\n  * Registers all elements supported by HeadingEditing to enable custom attributes for those elements.\n  */\n  registerHeadingElements(editor, options) {\n    const dataSchema = editor.plugins.get(DataSchema);\n    const headerModels = [];\n    for (const option of options) {\n      if ('model' in option && 'view' in option) {\n        dataSchema.registerBlockElement({\n          view: option.view,\n          model: option.model\n        });\n        headerModels.push(option.model);\n      }\n    }\n    dataSchema.extendBlockElement({\n      model: 'htmlHgroup',\n      modelSchema: {\n        allowChildren: headerModels\n      }\n    });\n    dataSchema.extendBlockElement({\n      model: 'htmlSummary',\n      modelSchema: {\n        allowChildren: headerModels\n      }\n    });\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module html-support/integrations/integrationutils\n    */ /**\n       * Returns the first view element descendant matching the given view name.\n       * Includes view element itself.\n       *\n       * @internal\n       */\nfunction getDescendantElement(writer, containerElement, elementName) {\n  const range = writer.createRangeOn(containerElement);\n  for (const {\n    item\n  } of range.getWalker()) {\n    if (item.is('element', elementName)) {\n      return item;\n    }\n  }\n}\n\n/**\n * Provides the General HTML Support integration with the {@link module:image/image~Image Image} feature.\n */\nclass ImageElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // At least one image plugin should be loaded for the integration to work properly.\n    if (!editor.plugins.has('ImageInlineEditing') && !editor.plugins.has('ImageBlockEditing')) {\n      return;\n    }\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    const dataFilter = editor.plugins.get(DataFilter);\n    dataFilter.on('register:figure', () => {\n      conversion.for('upcast').add(viewToModelFigureAttributeConverter$1(dataFilter));\n    });\n    dataFilter.on('register:img', (evt, definition) => {\n      if (definition.model !== 'imageBlock' && definition.model !== 'imageInline') {\n        return;\n      }\n      if (schema.isRegistered('imageBlock')) {\n        schema.extend('imageBlock', {\n          allowAttributes: ['htmlImgAttributes',\n          // Figure and Link don't have model counterpart.\n          // We will preserve attributes on image model element using these attribute keys.\n          'htmlFigureAttributes', 'htmlLinkAttributes']\n        });\n      }\n      if (schema.isRegistered('imageInline')) {\n        schema.extend('imageInline', {\n          allowAttributes: [\n          // `htmlA` is needed for standard GHS link integration.\n          'htmlA', 'htmlImgAttributes']\n        });\n      }\n      conversion.for('upcast').add(viewToModelImageAttributeConverter(dataFilter));\n      conversion.for('downcast').add(modelToViewImageAttributeConverter());\n      if (editor.plugins.has('LinkImage')) {\n        conversion.for('upcast').add(viewToModelLinkImageAttributeConverter(dataFilter, editor));\n      }\n      evt.stop();\n    });\n  }\n}\n/**\n * View-to-model conversion helper preserving allowed attributes on the {@link module:image/image~Image Image}\n * feature model element.\n *\n * @returns Returns a conversion callback.\n */\nfunction viewToModelImageAttributeConverter(dataFilter) {\n  return dispatcher => {\n    dispatcher.on('element:img', (evt, data, conversionApi) => {\n      if (!data.modelRange) {\n        return;\n      }\n      const viewImageElement = data.viewItem;\n      const viewAttributes = dataFilter.processViewAttributes(viewImageElement, conversionApi);\n      if (viewAttributes) {\n        conversionApi.writer.setAttribute('htmlImgAttributes', viewAttributes, data.modelRange);\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * View-to-model conversion helper preserving allowed attributes on {@link module:image/image~Image Image}\n * feature model element from link view element.\n *\n * @returns Returns a conversion callback.\n */\nfunction viewToModelLinkImageAttributeConverter(dataFilter, editor) {\n  const imageUtils = editor.plugins.get('ImageUtils');\n  return dispatcher => {\n    dispatcher.on('element:a', (evt, data, conversionApi) => {\n      const viewLink = data.viewItem;\n      const viewImage = imageUtils.findViewImgElement(viewLink);\n      if (!viewImage) {\n        return;\n      }\n      const modelImage = data.modelCursor.parent;\n      if (!modelImage.is('element', 'imageBlock')) {\n        return;\n      }\n      const viewAttributes = dataFilter.processViewAttributes(viewLink, conversionApi);\n      if (viewAttributes) {\n        conversionApi.writer.setAttribute('htmlLinkAttributes', viewAttributes, modelImage);\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * View-to-model conversion helper preserving allowed attributes on {@link module:image/image~Image Image}\n * feature model element from figure view element.\n *\n * @returns Returns a conversion callback.\n */\nfunction viewToModelFigureAttributeConverter$1(dataFilter) {\n  return dispatcher => {\n    dispatcher.on('element:figure', (evt, data, conversionApi) => {\n      const viewFigureElement = data.viewItem;\n      if (!data.modelRange || !viewFigureElement.hasClass('image')) {\n        return;\n      }\n      const viewAttributes = dataFilter.processViewAttributes(viewFigureElement, conversionApi);\n      if (viewAttributes) {\n        conversionApi.writer.setAttribute('htmlFigureAttributes', viewAttributes, data.modelRange);\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * A model-to-view conversion helper applying attributes from the {@link module:image/image~Image Image}\n * feature.\n * @returns Returns a conversion callback.\n */\nfunction modelToViewImageAttributeConverter() {\n  return dispatcher => {\n    addInlineAttributeConversion('htmlImgAttributes');\n    addBlockAttributeConversion('img', 'htmlImgAttributes');\n    addBlockAttributeConversion('figure', 'htmlFigureAttributes');\n    addBlockAttributeConversion('a', 'htmlLinkAttributes');\n    function addInlineAttributeConversion(attributeName) {\n      dispatcher.on(`attribute:${attributeName}:imageInline`, (evt, data, conversionApi) => {\n        if (!conversionApi.consumable.consume(data.item, evt.name)) {\n          return;\n        }\n        const {\n          attributeOldValue,\n          attributeNewValue\n        } = data;\n        const viewElement = conversionApi.mapper.toViewElement(data.item);\n        updateViewAttributes(conversionApi.writer, attributeOldValue, attributeNewValue, viewElement);\n      }, {\n        priority: 'low'\n      });\n    }\n    function addBlockAttributeConversion(elementName, attributeName) {\n      dispatcher.on(`attribute:${attributeName}:imageBlock`, (evt, data, conversionApi) => {\n        if (!conversionApi.consumable.test(data.item, evt.name)) {\n          return;\n        }\n        const {\n          attributeOldValue,\n          attributeNewValue\n        } = data;\n        const containerElement = conversionApi.mapper.toViewElement(data.item);\n        const viewElement = getDescendantElement(conversionApi.writer, containerElement, elementName);\n        if (viewElement) {\n          updateViewAttributes(conversionApi.writer, attributeOldValue, attributeNewValue, viewElement);\n          conversionApi.consumable.consume(data.item, evt.name);\n        }\n      }, {\n        priority: 'low'\n      });\n      if (elementName === 'a') {\n        // To have a link element in the view, we need to attach a converter to the `linkHref` attribute as well.\n        dispatcher.on('attribute:linkHref:imageBlock', (evt, data, conversionApi) => {\n          if (!conversionApi.consumable.consume(data.item, 'attribute:htmlLinkAttributes:imageBlock')) {\n            return;\n          }\n          const containerElement = conversionApi.mapper.toViewElement(data.item);\n          const viewElement = getDescendantElement(conversionApi.writer, containerElement, 'a');\n          setViewAttributes(conversionApi.writer, data.item.getAttribute('htmlLinkAttributes'), viewElement);\n        }, {\n          priority: 'low'\n        });\n      }\n    }\n  };\n}\n\n/**\n * Provides the General HTML Support integration with {@link module:media-embed/mediaembed~MediaEmbed Media Embed} feature.\n */\nclass MediaEmbedElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'MediaEmbedElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Stop here if MediaEmbed plugin is not provided or the integrator wants to output markup with previews as\n    // we do not support filtering previews.\n    if (!editor.plugins.has('MediaEmbed') || editor.config.get('mediaEmbed.previewsInData')) {\n      return;\n    }\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    const dataFilter = this.editor.plugins.get(DataFilter);\n    const dataSchema = this.editor.plugins.get(DataSchema);\n    const mediaElementName = editor.config.get('mediaEmbed.elementName');\n    // Overwrite GHS schema definition for a given elementName.\n    dataSchema.registerBlockElement({\n      model: 'media',\n      view: mediaElementName\n    });\n    dataFilter.on('register:figure', () => {\n      conversion.for('upcast').add(viewToModelFigureAttributesConverter(dataFilter));\n    });\n    dataFilter.on(`register:${mediaElementName}`, (evt, definition) => {\n      if (definition.model !== 'media') {\n        return;\n      }\n      schema.extend('media', {\n        allowAttributes: [getHtmlAttributeName(mediaElementName), 'htmlFigureAttributes']\n      });\n      conversion.for('upcast').add(viewToModelMediaAttributesConverter(dataFilter, mediaElementName));\n      conversion.for('dataDowncast').add(modelToViewMediaAttributeConverter(mediaElementName));\n      evt.stop();\n    });\n  }\n}\nfunction viewToModelMediaAttributesConverter(dataFilter, mediaElementName) {\n  const upcastMedia = (evt, data, conversionApi) => {\n    const viewMediaElement = data.viewItem;\n    preserveElementAttributes(viewMediaElement, getHtmlAttributeName(mediaElementName));\n    function preserveElementAttributes(viewElement, attributeName) {\n      const viewAttributes = dataFilter.processViewAttributes(viewElement, conversionApi);\n      if (viewAttributes) {\n        conversionApi.writer.setAttribute(attributeName, viewAttributes, data.modelRange);\n      }\n    }\n  };\n  return dispatcher => {\n    dispatcher.on(`element:${mediaElementName}`, upcastMedia, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * View-to-model conversion helper preserving allowed attributes on {@link module:media-embed/mediaembed~MediaEmbed MediaEmbed}\n * feature model element from figure view element.\n *\n * @returns Returns a conversion callback.\n */\nfunction viewToModelFigureAttributesConverter(dataFilter) {\n  return dispatcher => {\n    dispatcher.on('element:figure', (evt, data, conversionApi) => {\n      const viewFigureElement = data.viewItem;\n      if (!data.modelRange || !viewFigureElement.hasClass('media')) {\n        return;\n      }\n      const viewAttributes = dataFilter.processViewAttributes(viewFigureElement, conversionApi);\n      if (viewAttributes) {\n        conversionApi.writer.setAttribute('htmlFigureAttributes', viewAttributes, data.modelRange);\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\nfunction modelToViewMediaAttributeConverter(mediaElementName) {\n  return dispatcher => {\n    addAttributeConversionDispatcherHandler(mediaElementName, getHtmlAttributeName(mediaElementName));\n    addAttributeConversionDispatcherHandler('figure', 'htmlFigureAttributes');\n    function addAttributeConversionDispatcherHandler(elementName, attributeName) {\n      dispatcher.on(`attribute:${attributeName}:media`, (evt, data, conversionApi) => {\n        if (!conversionApi.consumable.consume(data.item, evt.name)) {\n          return;\n        }\n        const {\n          attributeOldValue,\n          attributeNewValue\n        } = data;\n        const containerElement = conversionApi.mapper.toViewElement(data.item);\n        const viewElement = getDescendantElement(conversionApi.writer, containerElement, elementName);\n        updateViewAttributes(conversionApi.writer, attributeOldValue, attributeNewValue, viewElement);\n      });\n    }\n  };\n}\n\n/**\n * Provides the General HTML Support for `script` elements.\n */\nclass ScriptElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ScriptElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const dataFilter = this.editor.plugins.get(DataFilter);\n    dataFilter.on('register:script', (evt, definition) => {\n      const editor = this.editor;\n      const schema = editor.model.schema;\n      const conversion = editor.conversion;\n      schema.register('htmlScript', definition.modelSchema);\n      schema.extend('htmlScript', {\n        allowAttributes: ['htmlScriptAttributes', 'htmlContent'],\n        isContent: true\n      });\n      editor.data.registerRawContentMatcher({\n        name: 'script'\n      });\n      conversion.for('upcast').elementToElement({\n        view: 'script',\n        model: viewToModelObjectConverter(definition)\n      });\n      conversion.for('upcast').add(viewToModelBlockAttributeConverter(definition, dataFilter));\n      conversion.for('downcast').elementToElement({\n        model: 'htmlScript',\n        view: (modelElement, {\n          writer\n        }) => {\n          return createObjectView('script', modelElement, writer);\n        }\n      });\n      conversion.for('downcast').add(modelToViewBlockAttributeConverter(definition));\n      evt.stop();\n    });\n  }\n}\nconst STYLE_ATTRIBUTES_TO_PROPAGATE = ['width', 'max-width', 'min-width', 'height', 'min-height', 'max-height'];\n/**\n * Provides the General HTML Support integration with {@link module:table/table~Table Table} feature.\n */\nclass TableElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!editor.plugins.has('TableEditing')) {\n      return;\n    }\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    const dataFilter = editor.plugins.get(DataFilter);\n    const tableUtils = editor.plugins.get('TableUtils');\n    dataFilter.on('register:figure', () => {\n      conversion.for('upcast').add(viewToModelFigureAttributeConverter(dataFilter));\n    });\n    dataFilter.on('register:table', (evt, definition) => {\n      if (definition.model !== 'table') {\n        return;\n      }\n      schema.extend('table', {\n        allowAttributes: ['htmlTableAttributes',\n        // Figure, thead and tbody elements don't have model counterparts.\n        // We will be preserving attributes on table element using these attribute keys.\n        'htmlFigureAttributes', 'htmlTheadAttributes', 'htmlTbodyAttributes']\n      });\n      conversion.for('upcast').add(viewToModelTableAttributeConverter(dataFilter));\n      conversion.for('downcast').add(modelToViewTableAttributeConverter());\n      editor.model.document.registerPostFixer(createHeadingRowsPostFixer(editor.model, tableUtils));\n      evt.stop();\n    });\n  }\n}\n/**\n * Creates a model post-fixer for thead and tbody GHS related attributes.\n */\nfunction createHeadingRowsPostFixer(model, tableUtils) {\n  return writer => {\n    const changes = model.document.differ.getChanges();\n    let wasFixed = false;\n    for (const change of changes) {\n      if (change.type != 'attribute' || change.attributeKey != 'headingRows') {\n        continue;\n      }\n      const table = change.range.start.nodeAfter;\n      const hasTHeadAttributes = table.getAttribute('htmlTheadAttributes');\n      const hasTBodyAttributes = table.getAttribute('htmlTbodyAttributes');\n      if (hasTHeadAttributes && !change.attributeNewValue) {\n        writer.removeAttribute('htmlTheadAttributes', table);\n        wasFixed = true;\n      } else if (hasTBodyAttributes && change.attributeNewValue == tableUtils.getRows(table)) {\n        writer.removeAttribute('htmlTbodyAttributes', table);\n        wasFixed = true;\n      }\n    }\n    return wasFixed;\n  };\n}\n/**\n * View-to-model conversion helper preserving allowed attributes on {@link module:table/table~Table Table}\n * feature model element.\n *\n * @returns Returns a conversion callback.\n */\nfunction viewToModelTableAttributeConverter(dataFilter) {\n  return dispatcher => {\n    dispatcher.on('element:table', (evt, data, conversionApi) => {\n      if (!data.modelRange) {\n        return;\n      }\n      const viewTableElement = data.viewItem;\n      preserveElementAttributes(viewTableElement, 'htmlTableAttributes');\n      for (const childNode of viewTableElement.getChildren()) {\n        if (childNode.is('element', 'thead')) {\n          preserveElementAttributes(childNode, 'htmlTheadAttributes');\n        }\n        if (childNode.is('element', 'tbody')) {\n          preserveElementAttributes(childNode, 'htmlTbodyAttributes');\n        }\n      }\n      function preserveElementAttributes(viewElement, attributeName) {\n        const viewAttributes = dataFilter.processViewAttributes(viewElement, conversionApi);\n        if (viewAttributes) {\n          conversionApi.writer.setAttribute(attributeName, viewAttributes, data.modelRange);\n        }\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * View-to-model conversion helper preserving allowed attributes on {@link module:table/table~Table Table}\n * feature model element from figure view element.\n *\n * @returns Returns a conversion callback.\n */\nfunction viewToModelFigureAttributeConverter(dataFilter) {\n  return dispatcher => {\n    dispatcher.on('element:figure', (evt, data, conversionApi) => {\n      const viewFigureElement = data.viewItem;\n      if (!data.modelRange || !viewFigureElement.hasClass('table')) {\n        return;\n      }\n      const viewAttributes = dataFilter.processViewAttributes(viewFigureElement, conversionApi);\n      if (viewAttributes) {\n        conversionApi.writer.setAttribute('htmlFigureAttributes', viewAttributes, data.modelRange);\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * Model-to-view conversion helper applying attributes from {@link module:table/table~Table Table}\n * feature.\n *\n * @returns Returns a conversion callback.\n */\nfunction modelToViewTableAttributeConverter() {\n  return dispatcher => {\n    addAttributeConversionDispatcherHandler('table', 'htmlTableAttributes');\n    addAttributeConversionDispatcherHandler('figure', 'htmlFigureAttributes');\n    addAttributeConversionDispatcherHandler('thead', 'htmlTheadAttributes');\n    addAttributeConversionDispatcherHandler('tbody', 'htmlTbodyAttributes');\n    function addAttributeConversionDispatcherHandler(elementName, attributeName) {\n      dispatcher.on(`attribute:${attributeName}:table`, (evt, data, conversionApi) => {\n        if (!conversionApi.consumable.test(data.item, evt.name)) {\n          return;\n        }\n        const containerElement = conversionApi.mapper.toViewElement(data.item);\n        const viewElement = getDescendantElement(conversionApi.writer, containerElement, elementName);\n        if (!viewElement) {\n          return;\n        }\n        conversionApi.consumable.consume(data.item, evt.name);\n        // Downcast selected styles to a figure element instead of a table element.\n        if (attributeName === 'htmlTableAttributes' && containerElement !== viewElement) {\n          const oldAttributes = splitAttributesForFigureAndTable(data.attributeOldValue);\n          const newAttributes = splitAttributesForFigureAndTable(data.attributeNewValue);\n          updateViewAttributes(conversionApi.writer, oldAttributes.tableAttributes, newAttributes.tableAttributes, viewElement);\n          updateViewAttributes(conversionApi.writer, oldAttributes.figureAttributes, newAttributes.figureAttributes, containerElement);\n        } else {\n          updateViewAttributes(conversionApi.writer, data.attributeOldValue, data.attributeNewValue, viewElement);\n        }\n      });\n    }\n  };\n}\n/**\n * Splits styles based on the `STYLE_ATTRIBUTES_TO_PROPAGATE` pattern that should be moved to the parent element\n * and those that should remain on element.\n */\nfunction splitAttributesForFigureAndTable(data) {\n  const figureAttributes = {};\n  const tableAttributes = {\n    ...data\n  };\n  if (!data || !('styles' in data)) {\n    return {\n      figureAttributes,\n      tableAttributes\n    };\n  }\n  tableAttributes.styles = {};\n  for (const [key, value] of Object.entries(data.styles)) {\n    if (STYLE_ATTRIBUTES_TO_PROPAGATE.includes(key)) {\n      figureAttributes.styles = {\n        ...figureAttributes.styles,\n        [key]: value\n      };\n    } else {\n      tableAttributes.styles = {\n        ...tableAttributes.styles,\n        [key]: value\n      };\n    }\n  }\n  return {\n    figureAttributes,\n    tableAttributes\n  };\n}\n\n/**\n * Provides the General HTML Support for `style` elements.\n */\nclass StyleElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'StyleElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const dataFilter = this.editor.plugins.get(DataFilter);\n    dataFilter.on('register:style', (evt, definition) => {\n      const editor = this.editor;\n      const schema = editor.model.schema;\n      const conversion = editor.conversion;\n      schema.register('htmlStyle', definition.modelSchema);\n      schema.extend('htmlStyle', {\n        allowAttributes: ['htmlStyleAttributes', 'htmlContent'],\n        isContent: true\n      });\n      editor.data.registerRawContentMatcher({\n        name: 'style'\n      });\n      conversion.for('upcast').elementToElement({\n        view: 'style',\n        model: viewToModelObjectConverter(definition)\n      });\n      conversion.for('upcast').add(viewToModelBlockAttributeConverter(definition, dataFilter));\n      conversion.for('downcast').elementToElement({\n        model: 'htmlStyle',\n        view: (modelElement, {\n          writer\n        }) => {\n          return createObjectView('style', modelElement, writer);\n        }\n      });\n      conversion.for('downcast').add(modelToViewBlockAttributeConverter(definition));\n      evt.stop();\n    });\n  }\n}\n\n/**\n * Provides the General HTML Support integration with the {@link module:list/list~List List} feature.\n */\nclass ListElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ListElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!editor.plugins.has('ListEditing')) {\n      return;\n    }\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    const dataFilter = editor.plugins.get(DataFilter);\n    const listEditing = editor.plugins.get('ListEditing');\n    const listUtils = editor.plugins.get('ListUtils');\n    const viewElements = ['ul', 'ol', 'li'];\n    // Register downcast strategy.\n    // Note that this must be done before document list editing registers conversion in afterInit.\n    listEditing.registerDowncastStrategy({\n      scope: 'item',\n      attributeName: 'htmlLiAttributes',\n      setAttributeOnDowncast: setViewAttributes\n    });\n    listEditing.registerDowncastStrategy({\n      scope: 'list',\n      attributeName: 'htmlUlAttributes',\n      setAttributeOnDowncast: setViewAttributes\n    });\n    listEditing.registerDowncastStrategy({\n      scope: 'list',\n      attributeName: 'htmlOlAttributes',\n      setAttributeOnDowncast: setViewAttributes\n    });\n    dataFilter.on('register', (evt, definition) => {\n      if (!viewElements.includes(definition.view)) {\n        return;\n      }\n      evt.stop();\n      // Do not register same converters twice.\n      if (schema.checkAttribute('$block', 'htmlLiAttributes')) {\n        return;\n      }\n      const allowAttributes = viewElements.map(element => getHtmlAttributeName(element));\n      schema.extend('$listItem', {\n        allowAttributes\n      });\n      conversion.for('upcast').add(dispatcher => {\n        dispatcher.on('element:ul', viewToModelListAttributeConverter('htmlUlAttributes', dataFilter), {\n          priority: 'low'\n        });\n        dispatcher.on('element:ol', viewToModelListAttributeConverter('htmlOlAttributes', dataFilter), {\n          priority: 'low'\n        });\n        dispatcher.on('element:li', viewToModelListAttributeConverter('htmlLiAttributes', dataFilter), {\n          priority: 'low'\n        });\n      });\n    });\n    // Make sure that all items in a single list (items at the same level & listType) have the same properties.\n    listEditing.on('postFixer', (evt, {\n      listNodes,\n      writer\n    }) => {\n      for (const {\n        node,\n        previousNodeInList\n      } of listNodes) {\n        // This is a first item of a nested list.\n        if (!previousNodeInList) {\n          continue;\n        }\n        if (previousNodeInList.getAttribute('listType') == node.getAttribute('listType')) {\n          const attribute = getAttributeFromListType(previousNodeInList.getAttribute('listType'));\n          const value = previousNodeInList.getAttribute(attribute);\n          if (!isEqual(node.getAttribute(attribute), value) && writer.model.schema.checkAttribute(node, attribute)) {\n            writer.setAttribute(attribute, value, node);\n            evt.return = true;\n          }\n        }\n        if (previousNodeInList.getAttribute('listItemId') == node.getAttribute('listItemId')) {\n          const value = previousNodeInList.getAttribute('htmlLiAttributes');\n          if (!isEqual(node.getAttribute('htmlLiAttributes'), value) && writer.model.schema.checkAttribute(node, 'htmlLiAttributes')) {\n            writer.setAttribute('htmlLiAttributes', value, node);\n            evt.return = true;\n          }\n        }\n      }\n    });\n    // Remove `ol` attributes from `ul` elements and vice versa.\n    listEditing.on('postFixer', (evt, {\n      listNodes,\n      writer\n    }) => {\n      for (const {\n        node\n      } of listNodes) {\n        const listType = node.getAttribute('listType');\n        if (!listUtils.isNumberedListType(listType) && node.getAttribute('htmlOlAttributes')) {\n          writer.removeAttribute('htmlOlAttributes', node);\n          evt.return = true;\n        }\n        if (listUtils.isNumberedListType(listType) && node.getAttribute('htmlUlAttributes')) {\n          writer.removeAttribute('htmlUlAttributes', node);\n          evt.return = true;\n        }\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    if (!editor.commands.get('indentList')) {\n      return;\n    }\n    // Reset list attributes after indenting list items.\n    const indentList = editor.commands.get('indentList');\n    this.listenTo(indentList, 'afterExecute', (evt, changedBlocks) => {\n      editor.model.change(writer => {\n        for (const node of changedBlocks) {\n          const attribute = getAttributeFromListType(node.getAttribute('listType'));\n          if (!editor.model.schema.checkAttribute(node, attribute)) {\n            continue;\n          }\n          // Just reset the attribute.\n          // If there is a previous indented list that this node should be merged into,\n          // the postfixer will unify all the attributes of both sub-lists.\n          writer.setAttribute(attribute, {}, node);\n        }\n      });\n    });\n  }\n}\n/**\n * View-to-model conversion helper preserving allowed attributes on {@link TODO}\n * feature model element.\n *\n * @returns Returns a conversion callback.\n */\nfunction viewToModelListAttributeConverter(attributeName, dataFilter) {\n  return (evt, data, conversionApi) => {\n    const viewElement = data.viewItem;\n    if (!data.modelRange) {\n      Object.assign(data, conversionApi.convertChildren(data.viewItem, data.modelCursor));\n    }\n    const viewAttributes = dataFilter.processViewAttributes(viewElement, conversionApi);\n    for (const item of data.modelRange.getItems({\n      shallow: true\n    })) {\n      // Apply only to list item blocks.\n      if (!item.hasAttribute('listItemId')) {\n        continue;\n      }\n      // Set list attributes only on same level items, those nested deeper are already handled\n      // by the recursive conversion.\n      if (item.hasAttribute('htmlUlAttributes') || item.hasAttribute('htmlOlAttributes')) {\n        continue;\n      }\n      if (conversionApi.writer.model.schema.checkAttribute(item, attributeName)) {\n        conversionApi.writer.setAttribute(attributeName, viewAttributes || {}, item);\n      }\n    }\n  };\n}\n/**\n * Returns HTML attribute name based on provided list type.\n */\nfunction getAttributeFromListType(listType) {\n  return listType === 'numbered' || listType == 'customNumbered' ? 'htmlOlAttributes' : 'htmlUlAttributes';\n}\n\n/**\n * Provides the General HTML Support integration with the {@link module:horizontal-line/horizontalline~HorizontalLine} feature.\n */\nclass HorizontalLineElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HorizontalLineElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!editor.plugins.has('HorizontalLineEditing')) {\n      return;\n    }\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    const dataFilter = editor.plugins.get(DataFilter);\n    dataFilter.on('register:hr', (evt, definition) => {\n      if (definition.model !== 'horizontalLine') {\n        return;\n      }\n      schema.extend('horizontalLine', {\n        allowAttributes: ['htmlHrAttributes']\n      });\n      conversion.for('upcast').add(viewToModelBlockAttributeConverter(definition, dataFilter));\n      conversion.for('downcast').add(modelToViewHorizontalLineAttributeConverter());\n      evt.stop();\n    });\n  }\n}\n/**\n * A model-to-view conversion helper applying attributes from the\n * {@link module:horizontal-line/horizontalline~HorizontalLine HorizontalLine} feature.\n *\n * @returns Returns a conversion callback.\n */\nfunction modelToViewHorizontalLineAttributeConverter() {\n  return dispatcher => {\n    dispatcher.on('attribute:htmlHrAttributes:horizontalLine', (evt, data, conversionApi) => {\n      if (!conversionApi.consumable.test(data.item, evt.name)) {\n        return;\n      }\n      const {\n        attributeOldValue,\n        attributeNewValue\n      } = data;\n      const containerElement = conversionApi.mapper.toViewElement(data.item);\n      const viewElement = getDescendantElement(conversionApi.writer, containerElement, 'hr');\n      if (viewElement) {\n        updateViewAttributes(conversionApi.writer, attributeOldValue, attributeNewValue, viewElement);\n        conversionApi.consumable.consume(data.item, evt.name);\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n\n/**\n * Provides the General HTML Support for custom elements (not registered in the {@link module:html-support/dataschema~DataSchema}).\n */\nclass CustomElementSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter, DataSchema];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'CustomElementSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const dataFilter = this.editor.plugins.get(DataFilter);\n    const dataSchema = this.editor.plugins.get(DataSchema);\n    dataFilter.on('register:$customElement', (evt, definition) => {\n      evt.stop();\n      const editor = this.editor;\n      const schema = editor.model.schema;\n      const conversion = editor.conversion;\n      const unsafeElements = editor.editing.view.domConverter.unsafeElements;\n      const preLikeElements = editor.data.htmlProcessor.domConverter.preElements;\n      schema.register(definition.model, definition.modelSchema);\n      schema.extend(definition.model, {\n        allowAttributes: ['htmlElementName', 'htmlCustomElementAttributes', 'htmlContent'],\n        isContent: true\n      });\n      // For the `<template>` element we use only raw-content because DOM API exposes its content\n      // only as a document fragment in the `content` property (or innerHTML).\n      editor.data.htmlProcessor.domConverter.registerRawContentMatcher({\n        name: 'template'\n      });\n      // Being executed on the low priority, it will catch all elements that were not caught by other converters.\n      conversion.for('upcast').elementToElement({\n        view: /.*/,\n        model: (viewElement, conversionApi) => {\n          // Do not try to convert $comment fake element.\n          if (viewElement.name == '$comment') {\n            return null;\n          }\n          if (!isValidElementName(viewElement.name)) {\n            return null;\n          }\n          // Allow for fallback only if this element is not defined in data schema to make sure\n          // that this will handle only custom elements not registered in the data schema.\n          if (dataSchema.getDefinitionsForView(viewElement.name).size) {\n            return null;\n          }\n          // Make sure that this element will not render in the editing view.\n          if (!unsafeElements.includes(viewElement.name)) {\n            unsafeElements.push(viewElement.name);\n          }\n          // Make sure that whitespaces will not be trimmed or replaced by nbsps while stringify content.\n          if (!preLikeElements.includes(viewElement.name)) {\n            preLikeElements.push(viewElement.name);\n          }\n          const modelElement = conversionApi.writer.createElement(definition.model, {\n            htmlElementName: viewElement.name\n          });\n          const htmlAttributes = dataFilter.processViewAttributes(viewElement, conversionApi);\n          if (htmlAttributes) {\n            conversionApi.writer.setAttribute('htmlCustomElementAttributes', htmlAttributes, modelElement);\n          }\n          let htmlContent;\n          // For the `<template>` element we use only raw-content because DOM API exposes its content\n          // only as a document fragment in the `content` property.\n          if (viewElement.is('element', 'template') && viewElement.getCustomProperty('$rawContent')) {\n            htmlContent = viewElement.getCustomProperty('$rawContent');\n          } else {\n            // Store the whole element in the attribute so that DomConverter will be able to use the pre like element context.\n            const viewWriter = new UpcastWriter(viewElement.document);\n            const documentFragment = viewWriter.createDocumentFragment(viewElement);\n            const domFragment = editor.data.htmlProcessor.domConverter.viewToDom(documentFragment);\n            const domElement = domFragment.firstChild;\n            while (domElement.firstChild) {\n              domFragment.appendChild(domElement.firstChild);\n            }\n            domElement.remove();\n            htmlContent = editor.data.htmlProcessor.htmlWriter.getHtml(domFragment);\n          }\n          conversionApi.writer.setAttribute('htmlContent', htmlContent, modelElement);\n          // Consume the content of the element.\n          for (const {\n            item\n          } of editor.editing.view.createRangeIn(viewElement)) {\n            conversionApi.consumable.consume(item, {\n              name: true\n            });\n          }\n          return modelElement;\n        },\n        converterPriority: 'low'\n      });\n      // Because this element is unsafe (DomConverter#unsafeElements), it will render as a transparent <span> but it must\n      // be rendered anyway for the mapping between the model and the view to exist.\n      conversion.for('editingDowncast').elementToElement({\n        model: {\n          name: definition.model,\n          attributes: ['htmlElementName', 'htmlCustomElementAttributes', 'htmlContent']\n        },\n        view: (modelElement, {\n          writer\n        }) => {\n          const viewName = modelElement.getAttribute('htmlElementName');\n          const viewElement = writer.createRawElement(viewName);\n          if (modelElement.hasAttribute('htmlCustomElementAttributes')) {\n            setViewAttributes(writer, modelElement.getAttribute('htmlCustomElementAttributes'), viewElement);\n          }\n          return viewElement;\n        }\n      });\n      conversion.for('dataDowncast').elementToElement({\n        model: {\n          name: definition.model,\n          attributes: ['htmlElementName', 'htmlCustomElementAttributes', 'htmlContent']\n        },\n        view: (modelElement, {\n          writer\n        }) => {\n          const viewName = modelElement.getAttribute('htmlElementName');\n          const htmlContent = modelElement.getAttribute('htmlContent');\n          const viewElement = writer.createRawElement(viewName, null, (domElement, domConverter) => {\n            domConverter.setContentOf(domElement, htmlContent);\n          });\n          if (modelElement.hasAttribute('htmlCustomElementAttributes')) {\n            setViewAttributes(writer, modelElement.getAttribute('htmlCustomElementAttributes'), viewElement);\n          }\n          return viewElement;\n        }\n      });\n    });\n  }\n}\n/**\n * Returns true if name is valid for a DOM element name.\n */\nfunction isValidElementName(name) {\n  try {\n    document.createElement(name);\n  } catch (error) {\n    return false;\n  }\n  return true;\n}\n\n/**\n * The General HTML Support feature.\n *\n * This is a \"glue\" plugin which initializes the {@link module:html-support/datafilter~DataFilter data filter} configuration\n * and features integration with the General HTML Support.\n */\nclass GeneralHtmlSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'GeneralHtmlSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [DataFilter, CodeBlockElementSupport, DualContentModelElementSupport, HeadingElementSupport, ImageElementSupport, MediaEmbedElementSupport, ScriptElementSupport, TableElementSupport, StyleElementSupport, ListElementSupport, HorizontalLineElementSupport, CustomElementSupport];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const dataFilter = editor.plugins.get(DataFilter);\n    // Load the allowed empty inline elements' configuration.\n    // Note that this modifies DataSchema so must be loaded before registering filtering rules.\n    dataFilter.loadAllowedEmptyElementsConfig(editor.config.get('htmlSupport.allowEmpty') || []);\n    // Load the filtering configuration.\n    dataFilter.loadAllowedConfig(editor.config.get('htmlSupport.allow') || []);\n    dataFilter.loadDisallowedConfig(editor.config.get('htmlSupport.disallow') || []);\n  }\n  /**\n  * Returns a GHS model attribute name related to a given view element name.\n  *\n  * @internal\n  * @param viewElementName A view element name.\n  */\n  getGhsAttributeNameForElement(viewElementName) {\n    const dataSchema = this.editor.plugins.get('DataSchema');\n    const definitions = Array.from(dataSchema.getDefinitionsForView(viewElementName, false));\n    const inlineDefinition = definitions.find(definition => definition.isInline && !definitions[0].isObject);\n    if (inlineDefinition) {\n      return inlineDefinition.model;\n    }\n    return getHtmlAttributeName(viewElementName);\n  }\n  /**\n  * Updates GHS model attribute for a specified view element name, so it includes the given class name.\n  *\n  * @internal\n  * @param viewElementName A view element name.\n  * @param className The css class to add.\n  * @param selectable The selection or element to update.\n  */\n  addModelHtmlClass(viewElementName, className, selectable) {\n    const model = this.editor.model;\n    const ghsAttributeName = this.getGhsAttributeNameForElement(viewElementName);\n    model.change(writer => {\n      for (const item of getItemsToUpdateGhsAttribute(model, selectable, ghsAttributeName)) {\n        modifyGhsAttribute(writer, item, ghsAttributeName, 'classes', classes => {\n          for (const value of toArray(className)) {\n            classes.add(value);\n          }\n        });\n      }\n    });\n  }\n  /**\n  * Updates GHS model attribute for a specified view element name, so it does not include the given class name.\n  *\n  * @internal\n  * @param viewElementName A view element name.\n  * @param className The css class to remove.\n  * @param selectable The selection or element to update.\n  */\n  removeModelHtmlClass(viewElementName, className, selectable) {\n    const model = this.editor.model;\n    const ghsAttributeName = this.getGhsAttributeNameForElement(viewElementName);\n    model.change(writer => {\n      for (const item of getItemsToUpdateGhsAttribute(model, selectable, ghsAttributeName)) {\n        modifyGhsAttribute(writer, item, ghsAttributeName, 'classes', classes => {\n          for (const value of toArray(className)) {\n            classes.delete(value);\n          }\n        });\n      }\n    });\n  }\n  /**\n  * Updates GHS model attribute for a specified view element name, so it includes the given attribute.\n  *\n  * @param viewElementName A view element name.\n  * @param attributes The object with attributes to set.\n  * @param selectable The selection or element to update.\n  */\n  setModelHtmlAttributes(viewElementName, attributes, selectable) {\n    const model = this.editor.model;\n    const ghsAttributeName = this.getGhsAttributeNameForElement(viewElementName);\n    model.change(writer => {\n      for (const item of getItemsToUpdateGhsAttribute(model, selectable, ghsAttributeName)) {\n        modifyGhsAttribute(writer, item, ghsAttributeName, 'attributes', attributesMap => {\n          for (const [key, value] of Object.entries(attributes)) {\n            attributesMap.set(key, value);\n          }\n        });\n      }\n    });\n  }\n  /**\n  * Updates GHS model attribute for a specified view element name, so it does not include the given attribute.\n  *\n  * @param viewElementName A view element name.\n  * @param attributeName The attribute name (or names) to remove.\n  * @param selectable The selection or element to update.\n  */\n  removeModelHtmlAttributes(viewElementName, attributeName, selectable) {\n    const model = this.editor.model;\n    const ghsAttributeName = this.getGhsAttributeNameForElement(viewElementName);\n    model.change(writer => {\n      for (const item of getItemsToUpdateGhsAttribute(model, selectable, ghsAttributeName)) {\n        modifyGhsAttribute(writer, item, ghsAttributeName, 'attributes', attributesMap => {\n          for (const key of toArray(attributeName)) {\n            attributesMap.delete(key);\n          }\n        });\n      }\n    });\n  }\n  /**\n  * Updates GHS model attribute for a specified view element name, so it includes a given style.\n  *\n  * @param viewElementName A view element name.\n  * @param styles The object with styles to set.\n  * @param selectable The selection or element to update.\n  */\n  setModelHtmlStyles(viewElementName, styles, selectable) {\n    const model = this.editor.model;\n    const ghsAttributeName = this.getGhsAttributeNameForElement(viewElementName);\n    model.change(writer => {\n      for (const item of getItemsToUpdateGhsAttribute(model, selectable, ghsAttributeName)) {\n        modifyGhsAttribute(writer, item, ghsAttributeName, 'styles', stylesMap => {\n          for (const [key, value] of Object.entries(styles)) {\n            stylesMap.set(key, value);\n          }\n        });\n      }\n    });\n  }\n  /**\n  * Updates GHS model attribute for a specified view element name, so it does not include a given style.\n  *\n  * @param viewElementName A view element name.\n  * @param properties The style (or styles list) to remove.\n  * @param selectable The selection or element to update.\n  */\n  removeModelHtmlStyles(viewElementName, properties, selectable) {\n    const model = this.editor.model;\n    const ghsAttributeName = this.getGhsAttributeNameForElement(viewElementName);\n    model.change(writer => {\n      for (const item of getItemsToUpdateGhsAttribute(model, selectable, ghsAttributeName)) {\n        modifyGhsAttribute(writer, item, ghsAttributeName, 'styles', stylesMap => {\n          for (const key of toArray(properties)) {\n            stylesMap.delete(key);\n          }\n        });\n      }\n    });\n  }\n}\n/**\n * Returns an iterator over an items in the selectable that accept given GHS attribute.\n */\nfunction* getItemsToUpdateGhsAttribute(model, selectable, ghsAttributeName) {\n  if (!selectable) {\n    return;\n  }\n  if (!(Symbol.iterator in selectable) && selectable.is('documentSelection') && selectable.isCollapsed) {\n    if (model.schema.checkAttributeInSelection(selectable, ghsAttributeName)) {\n      yield selectable;\n    }\n  } else {\n    for (const range of getValidRangesForSelectable(model, selectable, ghsAttributeName)) {\n      yield* range.getItems({\n        shallow: true\n      });\n    }\n  }\n}\n/**\n * Translates a given selectable to an iterable of ranges.\n */\nfunction getValidRangesForSelectable(model, selectable, ghsAttributeName) {\n  if (!(Symbol.iterator in selectable) && (selectable.is('node') || selectable.is('$text') || selectable.is('$textProxy'))) {\n    if (model.schema.checkAttribute(selectable, ghsAttributeName)) {\n      return [model.createRangeOn(selectable)];\n    } else {\n      return [];\n    }\n  } else {\n    return model.schema.getValidRanges(model.createSelection(selectable).getRanges(), ghsAttributeName);\n  }\n}\n\n/**\n * The HTML comment feature. It preserves the HTML comments (`<!-- -->`) in the editor data.\n *\n * For a detailed overview, check the {@glink features/html/html-comments HTML comment feature documentation}.\n */\nclass HtmlComment extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'HtmlComment';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const loadedCommentsContent = new Map();\n    editor.data.processor.skipComments = false;\n    // Allow storing comment's content as the $root attribute with the name `$comment:<unique id>`.\n    editor.model.schema.addAttributeCheck((context, attributeName) => {\n      if (context.endsWith('$root') && attributeName.startsWith('$comment')) {\n        return true;\n      }\n    });\n    // Convert the `$comment` view element to `$comment:<unique id>` marker and store its content (the comment itself) as a $root\n    // attribute. The comment content is needed in the `dataDowncast` pipeline to re-create the comment node.\n    editor.conversion.for('upcast').elementToMarker({\n      view: '$comment',\n      model: viewElement => {\n        const markerUid = uid();\n        const markerName = `$comment:${markerUid}`;\n        const commentContent = viewElement.getCustomProperty('$rawContent');\n        loadedCommentsContent.set(markerName, commentContent);\n        return markerName;\n      }\n    });\n    // Convert the `$comment` marker to `$comment` UI element with `$rawContent` custom property containing the comment content.\n    editor.conversion.for('dataDowncast').markerToElement({\n      model: '$comment',\n      view: (modelElement, {\n        writer\n      }) => {\n        let root = undefined;\n        for (const rootName of this.editor.model.document.getRootNames()) {\n          root = this.editor.model.document.getRoot(rootName);\n          if (root.hasAttribute(modelElement.markerName)) {\n            break;\n          }\n        }\n        const markerName = modelElement.markerName;\n        const commentContent = root.getAttribute(markerName);\n        const comment = writer.createUIElement('$comment');\n        writer.setCustomProperty('$rawContent', commentContent, comment);\n        return comment;\n      }\n    });\n    // Remove comments' markers and their corresponding $root attributes, which are moved to the graveyard.\n    editor.model.document.registerPostFixer(writer => {\n      let changed = false;\n      const markers = editor.model.document.differ.getChangedMarkers().filter(marker => marker.name.startsWith('$comment:'));\n      for (const marker of markers) {\n        const {\n          oldRange,\n          newRange\n        } = marker.data;\n        if (oldRange && newRange && oldRange.root == newRange.root) {\n          continue;\n        }\n        if (oldRange) {\n          // The comment marker was moved from one root to another (most probably to the graveyard).\n          // Remove the related attribute from the previous root.\n          const oldRoot = oldRange.root;\n          if (oldRoot.hasAttribute(marker.name)) {\n            writer.removeAttribute(marker.name, oldRoot);\n            changed = true;\n          }\n        }\n        if (newRange) {\n          const newRoot = newRange.root;\n          if (newRoot.rootName == '$graveyard') {\n            // Comment marker was moved to the graveyard -- remove it entirely.\n            writer.removeMarker(marker.name);\n            changed = true;\n          } else if (!newRoot.hasAttribute(marker.name)) {\n            // Comment marker was just added or was moved to another root - updated roots attributes.\n            //\n            // Added fallback to `''` for the comment content in case if someone incorrectly added just the marker \"by hand\"\n            // and forgot to add the root attribute or add them in different change blocks.\n            //\n            // It caused an infinite loop in one of the unit tests.\n            writer.setAttribute(marker.name, loadedCommentsContent.get(marker.name) || '', newRoot);\n            changed = true;\n          }\n        }\n      }\n      return changed;\n    });\n    // Delete all comment markers from the document before setting new data.\n    editor.data.on('set', () => {\n      for (const commentMarker of editor.model.markers.getMarkersGroup('$comment')) {\n        this.removeHtmlComment(commentMarker.name);\n      }\n    }, {\n      priority: 'high'\n    });\n    // Delete all comment markers that are within a removed range.\n    // Delete all comment markers at the limit element boundaries if the whole content of the limit element is removed.\n    editor.model.on('deleteContent', (evt, [selection]) => {\n      for (const range of selection.getRanges()) {\n        const limitElement = editor.model.schema.getLimitElement(range);\n        const firstPosition = editor.model.createPositionAt(limitElement, 0);\n        const lastPosition = editor.model.createPositionAt(limitElement, 'end');\n        let affectedCommentIDs;\n        if (firstPosition.isTouching(range.start) && lastPosition.isTouching(range.end)) {\n          affectedCommentIDs = this.getHtmlCommentsInRange(editor.model.createRange(firstPosition, lastPosition));\n        } else {\n          affectedCommentIDs = this.getHtmlCommentsInRange(range, {\n            skipBoundaries: true\n          });\n        }\n        for (const commentMarkerID of affectedCommentIDs) {\n          this.removeHtmlComment(commentMarkerID);\n        }\n      }\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Creates an HTML comment on the specified position and returns its ID.\n  *\n  * *Note*: If two comments are created at the same position, the second comment will be inserted before the first one.\n  *\n  * @returns Comment ID. This ID can be later used to e.g. remove the comment from the content.\n  */\n  createHtmlComment(position, content) {\n    const id = uid();\n    const editor = this.editor;\n    const model = editor.model;\n    const root = model.document.getRoot(position.root.rootName);\n    const markerName = `$comment:${id}`;\n    return model.change(writer => {\n      const range = writer.createRange(position);\n      writer.addMarker(markerName, {\n        usingOperation: true,\n        affectsData: true,\n        range\n      });\n      writer.setAttribute(markerName, content, root);\n      return markerName;\n    });\n  }\n  /**\n  * Removes an HTML comment with the given comment ID.\n  *\n  * It does nothing and returns `false` if the comment with the given ID does not exist.\n  * Otherwise it removes the comment and returns `true`.\n  *\n  * Note that a comment can be removed also by removing the content around the comment.\n  *\n  * @param commentID The ID of the comment to be removed.\n  * @returns `true` when the comment with the given ID was removed, `false` otherwise.\n  */\n  removeHtmlComment(commentID) {\n    const editor = this.editor;\n    const marker = editor.model.markers.get(commentID);\n    if (!marker) {\n      return false;\n    }\n    editor.model.change(writer => {\n      writer.removeMarker(marker);\n    });\n    return true;\n  }\n  /**\n  * Gets the HTML comment data for the comment with a given ID.\n  *\n  * Returns `null` if the comment does not exist.\n  */\n  getHtmlCommentData(commentID) {\n    const editor = this.editor;\n    const marker = editor.model.markers.get(commentID);\n    if (!marker) {\n      return null;\n    }\n    let content = '';\n    for (const root of this.editor.model.document.getRoots()) {\n      if (root.hasAttribute(commentID)) {\n        content = root.getAttribute(commentID);\n        break;\n      }\n    }\n    return {\n      content,\n      position: marker.getStart()\n    };\n  }\n  /**\n  * Gets all HTML comments in the given range.\n  *\n  * By default, it includes comments at the range boundaries.\n  *\n  * @param range\n  * @param options.skipBoundaries When set to `true` the range boundaries will be skipped.\n  * @returns HTML comment IDs\n  */\n  getHtmlCommentsInRange(range, {\n    skipBoundaries = false\n  } = {}) {\n    const includeBoundaries = !skipBoundaries;\n    // Unfortunately, MarkerCollection#getMarkersAtPosition() filters out collapsed markers.\n    return Array.from(this.editor.model.markers.getMarkersGroup('$comment')).filter(marker => isCommentMarkerInRange(marker, range)).map(marker => marker.name);\n    function isCommentMarkerInRange(commentMarker, range) {\n      const position = commentMarker.getRange().start;\n      return (position.isAfter(range.start) || includeBoundaries && position.isEqual(range.start)) && (position.isBefore(range.end) || includeBoundaries && position.isEqual(range.end));\n    }\n  }\n}\n\n/**\n * The full page HTML data processor class.\n * This data processor implementation uses HTML as input and output data.\n */\nclass HtmlPageDataProcessor extends HtmlDataProcessor {\n  /**\n  * @inheritDoc\n  */\n  toView(data) {\n    // Ignore content that is not a full page source.\n    if (!/<(?:html|body|head|meta)(?:\\s[^>]*)?>/i.test(data.trim().slice(0, 10_000))) {\n      return super.toView(data);\n    }\n    // Store doctype and xml declaration in a separate properties as they can't be stringified later.\n    let docType = '';\n    let xmlDeclaration = '';\n    data = data.trim().replace(/<\\?xml\\s[^?]*\\?>/i, match => {\n      xmlDeclaration = match;\n      return '';\n    });\n    data = data.trim().replace(/^<!DOCTYPE\\s[^>]*?>/i, match => {\n      docType = match;\n      return '';\n    });\n    // Convert input HTML data to DOM DocumentFragment.\n    const domFragment = this._toDom(data);\n    // Convert DOM DocumentFragment to view DocumentFragment.\n    const viewFragment = this.domConverter.domToView(domFragment, {\n      skipComments: this.skipComments\n    });\n    const writer = new UpcastWriter(viewFragment.document);\n    // Using the DOM document with body content extracted as a skeleton of the page.\n    writer.setCustomProperty('$fullPageDocument', domFragment.ownerDocument.documentElement.outerHTML, viewFragment);\n    // List of `<style>` elements extracted from document's `<head>` element.\n    const headStylesElements = Array.from(domFragment.ownerDocument.querySelectorAll('head style'));\n    writer.setCustomProperty('$fullPageHeadStyles', headStylesElements, viewFragment);\n    if (docType) {\n      writer.setCustomProperty('$fullPageDocType', docType, viewFragment);\n    }\n    if (xmlDeclaration) {\n      writer.setCustomProperty('$fullPageXmlDeclaration', xmlDeclaration, viewFragment);\n    }\n    return viewFragment;\n  }\n  /**\n  * @inheritDoc\n  */\n  toData(viewFragment) {\n    let data = super.toData(viewFragment);\n    const page = viewFragment.getCustomProperty('$fullPageDocument');\n    const docType = viewFragment.getCustomProperty('$fullPageDocType');\n    const xmlDeclaration = viewFragment.getCustomProperty('$fullPageXmlDeclaration');\n    if (page) {\n      data = page.replace(/<\\/body\\s*>/, data + '$&');\n      if (docType) {\n        data = docType + '\\n' + data;\n      }\n      if (xmlDeclaration) {\n        data = xmlDeclaration + '\\n' + data;\n      }\n    }\n    return data;\n  }\n}\n\n/**\n * The full page editing feature. It preserves the whole HTML page in the editor data.\n */\nclass FullPage extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'FullPage';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('htmlSupport.fullPage', {\n      allowRenderStylesFromHead: false,\n      sanitizeCss: rawCss => {\n        /**\n        * When using the Full page with the `config.htmlSupport.fullPage.allowRenderStylesFromHead` set to `true`,\n        * it is strongly recommended to define a sanitize function that will clean up the CSS\n        * which is present in the `<head>` in editors content in order to avoid XSS vulnerability.\n        *\n        * For a detailed overview, check the {@glink features/html/full-page-html Full page HTML feature} documentation.\n        *\n        * @error css-full-page-provide-sanitize-function\n        */\n        logWarning('css-full-page-provide-sanitize-function');\n        return {\n          css: rawCss,\n          hasChanged: false\n        };\n      }\n    });\n    editor.data.processor = new HtmlPageDataProcessor(editor.data.viewDocument);\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const properties = ['$fullPageDocument', '$fullPageDocType', '$fullPageXmlDeclaration', '$fullPageHeadStyles'];\n    editor.model.schema.extend('$root', {\n      allowAttributes: properties\n    });\n    // Apply custom properties from view document fragment to the model root attributes.\n    editor.data.on('toModel', (evt, [viewElementOrFragment]) => {\n      const root = editor.model.document.getRoot();\n      editor.model.change(writer => {\n        for (const name of properties) {\n          const value = viewElementOrFragment.getCustomProperty(name);\n          if (value) {\n            writer.setAttribute(name, value, root);\n          }\n        }\n      });\n      if (isAllowedRenderStylesFromHead(editor)) {\n        this._renderStylesFromHead(root);\n      }\n    }, {\n      priority: 'low'\n    });\n    // Apply root attributes to the view document fragment.\n    editor.data.on('toView', (evt, [modelElementOrFragment]) => {\n      if (!modelElementOrFragment.is('rootElement')) {\n        return;\n      }\n      const root = modelElementOrFragment;\n      const viewFragment = evt.return;\n      if (!root.hasAttribute('$fullPageDocument')) {\n        return;\n      }\n      const writer = new UpcastWriter(viewFragment.document);\n      for (const name of properties) {\n        const value = root.getAttribute(name);\n        if (value) {\n          writer.setCustomProperty(name, value, viewFragment);\n        }\n      }\n    }, {\n      priority: 'low'\n    });\n    // Clear root attributes related to full page editing on editor content reset.\n    editor.data.on('set', () => {\n      const root = editor.model.document.getRoot();\n      editor.model.change(writer => {\n        for (const name of properties) {\n          if (root.hasAttribute(name)) {\n            writer.removeAttribute(name, root);\n          }\n        }\n      });\n    }, {\n      priority: 'high'\n    });\n    // Make sure that document is returned even if there is no content in the page body.\n    editor.data.on('get', (evt, args) => {\n      if (!args[0]) {\n        args[0] = {};\n      }\n      args[0].trim = false;\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    if (isAllowedRenderStylesFromHead(this.editor)) {\n      this._removeStyleElementsFromDom();\n    }\n  }\n  /**\n  * Checks if in the document exists any `<style>` elements injected by the plugin and removes them,\n  * so these could be re-rendered later.\n  * There is used `data-full-page-style-id` attribute to recognize styles injected by the feature.\n  */\n  _removeStyleElementsFromDom() {\n    const existingStyleElements = Array.from(global.document.querySelectorAll(`[data-full-page-style-id=\"${this.editor.id}\"]`));\n    for (const style of existingStyleElements) {\n      style.remove();\n    }\n  }\n  /**\n  * Extracts `<style>` elements from the full page data and renders them in the main document `<head>`.\n  * CSS content is sanitized before rendering.\n  */\n  _renderStyleElementsInDom(root) {\n    const editor = this.editor;\n    // Get `<style>` elements list from the `<head>` from the full page data.\n    const styleElements = root.getAttribute('$fullPageHeadStyles');\n    if (!styleElements) {\n      return;\n    }\n    const sanitizeCss = editor.config.get('htmlSupport.fullPage.sanitizeCss');\n    // Add `data-full-page-style-id` attribute to the `<style>` element and render it in `<head>` in the main document.\n    for (const style of styleElements) {\n      style.setAttribute('data-full-page-style-id', editor.id);\n      // Sanitize the CSS content before rendering it in the editor.\n      const sanitizedCss = sanitizeCss(style.innerText);\n      if (sanitizedCss.hasChanged) {\n        style.innerText = sanitizedCss.css;\n      }\n      global.document.head.append(style);\n    }\n  }\n  /**\n  * Removes existing `<style>` elements injected by the plugin and renders new ones from the full page data.\n  */\n  _renderStylesFromHead(root) {\n    this._removeStyleElementsFromDom();\n    this._renderStyleElementsInDom(root);\n  }\n}\n/**\n * Normalize the Full page configuration option `allowRenderStylesFromHead`.\n */\nfunction isAllowedRenderStylesFromHead(editor) {\n  return editor.config.get('htmlSupport.fullPage.allowRenderStylesFromHead');\n}\nconst EMPTY_BLOCK_MODEL_ATTRIBUTE = 'htmlEmptyBlock';\n/**\n * This plugin allows for preserving empty block elements in the editor content\n * instead of automatically filling them with block fillers (`&nbsp;`).\n *\n * This is useful when you want to:\n *\n * * Preserve empty block elements exactly as they were in the source HTML.\n * * Allow for styling empty blocks with CSS (block fillers can interfere with height/margin).\n * * Maintain compatibility with external systems that expect empty blocks to remain empty.\n *\n * Known limitations:\n *\n * * Empty blocks may not work correctly with revision history features.\n * * Keyboard navigation through the document might behave unexpectedly, especially when\n *   navigating through structures like lists and tables.\n *\n * For example, this allows for HTML like:\n *\n * ```html\n * <p></p>\n * <p class=\"spacer\"></p>\n * <td></td>\n * ```\n * to remain empty instead of being converted to:\n *\n * ```html\n * <p>&nbsp;</p>\n * <p class=\"spacer\">&nbsp;</p>\n * <td>&nbsp;</td>\n * ```\n */\nclass EmptyBlock extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'EmptyBlock';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const {\n      model,\n      conversion,\n      plugins,\n      config\n    } = this.editor;\n    const schema = model.schema;\n    const preserveEmptyBlocksInEditingView = config.get('htmlSupport.preserveEmptyBlocksInEditingView');\n    schema.extend('$block', {\n      allowAttributes: [EMPTY_BLOCK_MODEL_ATTRIBUTE]\n    });\n    schema.extend('$container', {\n      allowAttributes: [EMPTY_BLOCK_MODEL_ATTRIBUTE]\n    });\n    if (schema.isRegistered('tableCell')) {\n      schema.extend('tableCell', {\n        allowAttributes: [EMPTY_BLOCK_MODEL_ATTRIBUTE]\n      });\n    }\n    if (preserveEmptyBlocksInEditingView) {\n      conversion.for('downcast').add(createEmptyBlockDowncastConverter());\n    } else {\n      conversion.for('dataDowncast').add(createEmptyBlockDowncastConverter());\n    }\n    conversion.for('upcast').add(createEmptyBlockUpcastConverter(schema));\n    if (plugins.has('ClipboardPipeline')) {\n      this._registerClipboardPastingHandler();\n    }\n  }\n  /**\n  * Handle clipboard paste events:\n  *\n  * * It does not affect *copying* content from the editor, only *pasting*.\n  * * When content is pasted from another editor instance with `<p></p>`,\n  *   the `&nbsp;` filler is added, so the getData result is `<p>&nbsp;</p>`.\n  * * When content is pasted from the same editor instance with `<p></p>`,\n  *   the `&nbsp;` filler is not added, so the getData result is `<p></p>`.\n  */\n  _registerClipboardPastingHandler() {\n    const clipboardPipeline = this.editor.plugins.get('ClipboardPipeline');\n    this.listenTo(clipboardPipeline, 'contentInsertion', (evt, data) => {\n      if (data.sourceEditorId === this.editor.id) {\n        return;\n      }\n      this.editor.model.change(writer => {\n        for (const {\n          item\n        } of writer.createRangeIn(data.content)) {\n          if (item.is('element') && item.hasAttribute(EMPTY_BLOCK_MODEL_ATTRIBUTE)) {\n            writer.removeAttribute(EMPTY_BLOCK_MODEL_ATTRIBUTE, item);\n          }\n        }\n      });\n    });\n  }\n}\n/**\n * Creates a downcast converter for handling empty blocks.\n * This converter prevents filler elements from being added to elements marked as empty blocks.\n */\nfunction createEmptyBlockDowncastConverter() {\n  return dispatcher => {\n    dispatcher.on(`attribute:${EMPTY_BLOCK_MODEL_ATTRIBUTE}`, (evt, data, conversionApi) => {\n      const {\n        mapper,\n        consumable\n      } = conversionApi;\n      const {\n        item\n      } = data;\n      if (!consumable.consume(item, evt.name)) {\n        return;\n      }\n      const viewElement = mapper.toViewElement(item);\n      if (viewElement && data.attributeNewValue) {\n        viewElement.getFillerOffset = () => null;\n      }\n    });\n  };\n}\n/**\n * Creates an upcast converter for handling empty blocks.\n * The converter detects empty elements and marks them with the empty block attribute.\n */\nfunction createEmptyBlockUpcastConverter(schema) {\n  return dispatcher => {\n    dispatcher.on('element', (evt, data, conversionApi) => {\n      const {\n        viewItem,\n        modelRange\n      } = data;\n      if (!viewItem.is('element') || !viewItem.isEmpty || viewItem.getCustomProperty('$hasBlockFiller')) {\n        return;\n      }\n      // Handle element itself.\n      const modelElement = modelRange && modelRange.start.nodeAfter;\n      if (!modelElement || !schema.checkAttribute(modelElement, EMPTY_BLOCK_MODEL_ATTRIBUTE)) {\n        return;\n      }\n      conversionApi.writer.setAttribute(EMPTY_BLOCK_MODEL_ATTRIBUTE, true, modelElement);\n      // Handle an auto-paragraphed bogus paragraph inside empty element.\n      if (modelElement.childCount != 1) {\n        return;\n      }\n      const firstModelChild = modelElement.getChild(0);\n      if (firstModelChild.is('element', 'paragraph') && schema.checkAttribute(firstModelChild, EMPTY_BLOCK_MODEL_ATTRIBUTE)) {\n        conversionApi.writer.setAttribute(EMPTY_BLOCK_MODEL_ATTRIBUTE, true, firstModelChild);\n      }\n    }, {\n      priority: 'lowest'\n    });\n  };\n}\nexport { DataFilter, DataSchema, EmptyBlock, FullPage, GeneralHtmlSupport, HtmlComment, HtmlPageDataProcessor };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, Command } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Clipboard, ClipboardPipeline } from '@ckeditor/ckeditor5-clipboard/dist/index.js';\nimport { LivePosition, LiveRange, Observer, UpcastWriter, enablePlaceholder, Element } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { Undo } from '@ckeditor/ckeditor5-undo/dist/index.js';\nimport { Delete } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { first, DomEmitterMixin, global, FocusTracker, KeystrokeHandler, logWarning, toArray, env, CKEditorError, Collection, Rect } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { toWidget, isWidget, findOptimalInsertionRange, Widget, toWidgetEditable, WidgetResize, calculateResizeHostAncestorWidth, WidgetToolbarRepository } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { View, FormRowView, ViewCollection, FocusCycler, submitHandler, ButtonView, FormHeaderView, LabeledFieldView, createLabeledInputText, BalloonPanelView, ContextualBalloon, CssTransitionDisablerMixin, clickOutsideHandler, CollapsibleView, SplitButtonView, createDropdown, MenuBarMenuView, MenuBarMenuListView, MenuBarMenuListItemView, FileDialogButtonView, MenuBarMenuListItemFileDialogButtonView, Notification, Dialog, MenuBarMenuListItemButtonView, ViewModel, DropdownButtonView, addListToDropdown, createLabeledInputNumber, addToolbarToDropdown } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconPreviousArrow, IconTextAlternative, IconImage, IconCaption, IconImageUpload, IconImageUrl, IconObjectSizeFull, IconObjectSizeCustom, IconObjectSizeLarge, IconObjectSizeMedium, IconObjectSizeSmall, IconObjectInline, IconObjectInlineRight, IconObjectInlineLeft, IconObjectCenter, IconObjectRight, IconObjectLeft, IconObjectFullWidth } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { FileRepository } from '@ckeditor/ckeditor5-upload/dist/index.js';\nimport { isObject, identity } from 'es-toolkit/compat';\n\n/**\n * Creates a view element representing the inline image.\n *\n * ```html\n * <span class=\"image-inline\"><img></img></span>\n * ```\n *\n * Note that `alt` and `src` attributes are converted separately, so they are not included.\n *\n * @internal\n */\nfunction createInlineImageViewElement(writer) {\n  return writer.createContainerElement('span', {\n    class: 'image-inline'\n  }, writer.createEmptyElement('img'));\n}\n/**\n * Creates a view element representing the block image.\n *\n * ```html\n * <figure class=\"image\"><img></img></figure>\n * ```\n *\n * Note that `alt` and `src` attributes are converted separately, so they are not included.\n *\n * @internal\n */\nfunction createBlockImageViewElement(writer) {\n  return writer.createContainerElement('figure', {\n    class: 'image'\n  }, [writer.createEmptyElement('img'), writer.createSlot('children')]);\n}\n/**\n * A function returning a `MatcherPattern` for a particular type of View images.\n *\n * @internal\n * @param matchImageType The type of created image.\n */\nfunction getImgViewElementMatcher(editor, matchImageType) {\n  const imageUtils = editor.plugins.get('ImageUtils');\n  const areBothImagePluginsLoaded = editor.plugins.has('ImageInlineEditing') && editor.plugins.has('ImageBlockEditing');\n  return element => {\n    // Check if the matched view element is an <img>.\n    if (!imageUtils.isInlineImageView(element)) {\n      return null;\n    }\n    // If just one of the plugins is loaded (block or inline), it will match all kinds of images.\n    if (!areBothImagePluginsLoaded) {\n      return getPositiveMatchPattern(element);\n    }\n    // The <img> can be standalone, wrapped in <figure>...</figure> (ImageBlock plugin) or\n    // wrapped in <figure><a>...</a></figure> (LinkImage plugin).\n    const imageType = element.getStyle('display') == 'block' || element.findAncestor(imageUtils.isBlockImageView) ? 'imageBlock' : 'imageInline';\n    if (imageType !== matchImageType) {\n      return null;\n    }\n    return getPositiveMatchPattern(element);\n  };\n  function getPositiveMatchPattern(element) {\n    const pattern = {\n      name: true\n    };\n    // This will trigger src consumption (See https://github.com/ckeditor/ckeditor5/issues/11530).\n    if (element.hasAttribute('src')) {\n      pattern.attributes = ['src'];\n    }\n    return pattern;\n  }\n}\n/**\n * Considering the current model selection, it returns the name of the model image element\n * (`'imageBlock'` or `'imageInline'`) that will make most sense from the UX perspective if a new\n * image was inserted (also: uploaded, dropped, pasted) at that selection.\n *\n * The assumption is that inserting images into empty blocks or on other block widgets should\n * produce block images. Inline images should be inserted in other cases, e.g. in paragraphs\n * that already contain some text.\n *\n * @internal\n */\nfunction determineImageTypeForInsertionAtSelection(schema, selection) {\n  const firstBlock = first(selection.getSelectedBlocks());\n  // Insert a block image if the selection is not in/on block elements or it's on a block widget.\n  if (!firstBlock || schema.isObject(firstBlock)) {\n    return 'imageBlock';\n  }\n  // A block image should also be inserted into an empty block element\n  // (that is not an empty list item so the list won't get split).\n  if (firstBlock.isEmpty && firstBlock.name != 'listItem') {\n    return 'imageBlock';\n  }\n  // Otherwise insert an inline image.\n  return 'imageInline';\n}\n/**\n * Returns parsed value of the size, but only if it contains unit: px.\n */\nfunction getSizeValueIfInPx(size) {\n  if (size && size.endsWith('px')) {\n    return parseInt(size);\n  }\n  return null;\n}\n/**\n * Returns true if both styles (width and height) are set.\n *\n * If both image styles: width & height are set, they will override the image width & height attributes in the\n * browser. In this case, the image looks the same as if these styles were applied to attributes instead of styles.\n * That's why we can upcast these styles to width & height attributes instead of resizedWidth and resizedHeight.\n */\nfunction widthAndHeightStylesAreBothSet(viewElement) {\n  const widthStyle = getSizeValueIfInPx(viewElement.getStyle('width'));\n  const heightStyle = getSizeValueIfInPx(viewElement.getStyle('height'));\n  return !!(widthStyle && heightStyle);\n}\nconst IMAGE_WIDGETS_CLASSES_MATCH_REGEXP = /^(image|image-inline)$/;\n/**\n * A set of helpers related to images.\n */\nclass ImageUtils extends Plugin {\n  /**\n  * DOM Emitter.\n  */\n  _domEmitter = new (DomEmitterMixin())();\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * Checks if the provided model element is an `image` or `imageInline`.\n  */\n  isImage(modelElement) {\n    return this.isInlineImage(modelElement) || this.isBlockImage(modelElement);\n  }\n  /**\n  * Checks if the provided view element represents an inline image.\n  *\n  * Also, see {@link module:image/imageutils~ImageUtils#isImageWidget}.\n  */\n  isInlineImageView(element) {\n    return !!element && element.is('element', 'img');\n  }\n  /**\n  * Checks if the provided view element represents a block image.\n  *\n  * Also, see {@link module:image/imageutils~ImageUtils#isImageWidget}.\n  */\n  isBlockImageView(element) {\n    return !!element && element.is('element', 'figure') && element.hasClass('image');\n  }\n  /**\n  * Handles inserting single file. This method unifies image insertion using {@link module:widget/utils~findOptimalInsertionRange}\n  * method.\n  *\n  * ```ts\n  * const imageUtils = editor.plugins.get( 'ImageUtils' );\n  *\n  * imageUtils.insertImage( { src: 'path/to/image.jpg' } );\n  * ```\n  *\n  * @param attributes Attributes of the inserted image.\n  * This method filters out the attributes which are disallowed by the {@link module:engine/model/schema~Schema}.\n  * @param selectable Place to insert the image. If not specified,\n  * the {@link module:widget/utils~findOptimalInsertionRange} logic will be applied for the block images\n  * and `model.document.selection` for the inline images.\n  *\n  * **Note**: If `selectable` is passed, this helper will not be able to set selection attributes (such as `linkHref`)\n  * and apply them to the new image. In this case, make sure all selection attributes are passed in `attributes`.\n  *\n  * @param imageType Image type of inserted image. If not specified,\n  * it will be determined automatically depending of editor config or place of the insertion.\n  * @param options.setImageSizes Specifies whether the image `width` and `height` attributes should be set automatically.\n  * The default is `true`.\n  * @return The inserted model image element.\n  */\n  insertImage(attributes = {}, selectable = null, imageType = null, options = {}) {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    const determinedImageType = determineImageTypeForInsertion(editor, selectable || selection, imageType);\n    // Mix declarative attributes with selection attributes because the new image should \"inherit\"\n    // the latter for best UX. For instance, inline images inserted into existing links\n    // should not split them. To do that, they need to have \"linkHref\" inherited from the selection.\n    attributes = {\n      ...Object.fromEntries(selection.getAttributes()),\n      ...attributes\n    };\n    for (const attributeName in attributes) {\n      if (!model.schema.checkAttribute(determinedImageType, attributeName)) {\n        delete attributes[attributeName];\n      }\n    }\n    return model.change(writer => {\n      const {\n        setImageSizes = true\n      } = options;\n      const imageElement = writer.createElement(determinedImageType, attributes);\n      model.insertObject(imageElement, selectable, null, {\n        setSelection: 'on',\n        // If we want to insert a block image (for whatever reason) then we don't want to split text blocks.\n        // This applies only when we don't have the selectable specified (i.e., we insert multiple block images at once).\n        findOptimalPosition: !selectable && determinedImageType != 'imageInline' ? 'auto' : undefined\n      });\n      // Inserting an image might've failed due to schema regulations.\n      if (imageElement.parent) {\n        if (setImageSizes) {\n          this.setImageNaturalSizeAttributes(imageElement);\n        }\n        return imageElement;\n      }\n      return null;\n    });\n  }\n  /**\n  * Reads original image sizes and sets them as `width` and `height`.\n  *\n  * The `src` attribute may not be available if the user is using an upload adapter. In such a case,\n  * this method is called again after the upload process is complete and the `src` attribute is available.\n  */\n  setImageNaturalSizeAttributes(imageElement) {\n    const src = imageElement.getAttribute('src');\n    if (!src) {\n      return;\n    }\n    if (imageElement.getAttribute('width') || imageElement.getAttribute('height')) {\n      return;\n    }\n    this.editor.model.change(writer => {\n      const img = new global.window.Image();\n      this._domEmitter.listenTo(img, 'load', () => {\n        if (!imageElement.getAttribute('width') && !imageElement.getAttribute('height')) {\n          // We use writer.batch to be able to undo (in a single step) width and height setting\n          // along with any change that triggered this action (e.g. image resize or image style change).\n          this.editor.model.enqueueChange(writer.batch, writer => {\n            writer.setAttribute('width', img.naturalWidth, imageElement);\n            writer.setAttribute('height', img.naturalHeight, imageElement);\n          });\n        }\n        this._domEmitter.stopListening(img, 'load');\n      });\n      img.src = src;\n    });\n  }\n  /**\n  * Returns an image widget editing view element if one is selected or is among the selection's ancestors.\n  */\n  getClosestSelectedImageWidget(selection) {\n    const selectionPosition = selection.getFirstPosition();\n    if (!selectionPosition) {\n      return null;\n    }\n    const viewElement = selection.getSelectedElement();\n    if (viewElement && this.isImageWidget(viewElement)) {\n      return viewElement;\n    }\n    let parent = selectionPosition.parent;\n    while (parent) {\n      if (parent.is('element') && this.isImageWidget(parent)) {\n        return parent;\n      }\n      parent = parent.parent;\n    }\n    return null;\n  }\n  /**\n  * Returns a image model element if one is selected or is among the selection's ancestors.\n  */\n  getClosestSelectedImageElement(selection) {\n    const selectedElement = selection.getSelectedElement();\n    return this.isImage(selectedElement) ? selectedElement : selection.getFirstPosition().findAncestor('imageBlock');\n  }\n  /**\n  * Returns an image widget editing view based on the passed image view.\n  */\n  getImageWidgetFromImageView(imageView) {\n    return imageView.findAncestor({\n      classes: IMAGE_WIDGETS_CLASSES_MATCH_REGEXP\n    });\n  }\n  /**\n  * Checks if image can be inserted at current model selection.\n  *\n  * @internal\n  */\n  isImageAllowed() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    return isImageAllowedInParent(this.editor, selection) && isNotInsideImage(selection);\n  }\n  /**\n  * Converts a given {@link module:engine/view/element~Element} to an image widget:\n  * * Adds a {@link module:engine/view/element~Element#_setCustomProperty custom property} allowing to recognize the image widget\n  * element.\n  * * Calls the {@link module:widget/utils~toWidget} function with the proper element's label creator.\n  *\n  * @param writer An instance of the view writer.\n  * @param label The element's label. It will be concatenated with the image `alt` attribute if one is present.\n  */\n  toImageWidget(viewElement, writer, label) {\n    writer.setCustomProperty('image', true, viewElement);\n    const labelCreator = () => {\n      const imgElement = this.findViewImgElement(viewElement);\n      const altText = imgElement.getAttribute('alt');\n      return altText ? `${altText} ${label}` : label;\n    };\n    return toWidget(viewElement, writer, {\n      label: labelCreator\n    });\n  }\n  /**\n  * Checks if a given view element is an image widget.\n  */\n  isImageWidget(viewElement) {\n    return !!viewElement.getCustomProperty('image') && isWidget(viewElement);\n  }\n  /**\n  * Checks if the provided model element is an `image`.\n  */\n  isBlockImage(modelElement) {\n    return !!modelElement && modelElement.is('element', 'imageBlock');\n  }\n  /**\n  * Checks if the provided model element is an `imageInline`.\n  */\n  isInlineImage(modelElement) {\n    return !!modelElement && modelElement.is('element', 'imageInline');\n  }\n  /**\n  * Get the view `<img>` from another view element, e.g. a widget (`<figure class=\"image\">`), a link (`<a>`).\n  *\n  * The `<img>` can be located deep in other elements, so this helper performs a deep tree search.\n  */\n  findViewImgElement(figureView) {\n    if (this.isInlineImageView(figureView)) {\n      return figureView;\n    }\n    const editingView = this.editor.editing.view;\n    for (const {\n      item\n    } of editingView.createRangeIn(figureView)) {\n      if (this.isInlineImageView(item)) {\n        return item;\n      }\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    this._domEmitter.stopListening();\n    return super.destroy();\n  }\n}\n/**\n * Checks if image is allowed by schema in optimal insertion parent.\n */\nfunction isImageAllowedInParent(editor, selection) {\n  const imageType = determineImageTypeForInsertion(editor, selection, null);\n  if (imageType == 'imageBlock') {\n    const parent = getInsertImageParent(selection, editor.model);\n    if (editor.model.schema.checkChild(parent, 'imageBlock')) {\n      return true;\n    }\n  } else if (editor.model.schema.checkChild(selection.focus, 'imageInline')) {\n    return true;\n  }\n  return false;\n}\n/**\n * Checks if selection is not placed inside an image (e.g. its caption).\n */\nfunction isNotInsideImage(selection) {\n  return [...selection.focus.getAncestors()].every(ancestor => !ancestor.is('element', 'imageBlock'));\n}\n/**\n * Returns a node that will be used to insert image with `model.insertContent`.\n */\nfunction getInsertImageParent(selection, model) {\n  const insertionRange = findOptimalInsertionRange(selection, model);\n  const parent = insertionRange.start.parent;\n  if (parent.isEmpty && !parent.is('element', '$root')) {\n    return parent.parent;\n  }\n  return parent;\n}\n/**\n * Determine image element type name depending on editor config or place of insertion.\n *\n * @param imageType Image element type name. Used to force return of provided element name,\n * but only if there is proper plugin enabled.\n */\nfunction determineImageTypeForInsertion(editor, selectable, imageType) {\n  const schema = editor.model.schema;\n  const configImageInsertType = editor.config.get('image.insert.type');\n  if (!editor.plugins.has('ImageBlockEditing')) {\n    return 'imageInline';\n  }\n  if (!editor.plugins.has('ImageInlineEditing')) {\n    return 'imageBlock';\n  }\n  if (imageType) {\n    return imageType;\n  }\n  if (configImageInsertType === 'inline') {\n    return 'imageInline';\n  }\n  if (configImageInsertType !== 'auto') {\n    return 'imageBlock';\n  }\n  // Try to replace the selected widget (e.g. another image).\n  if (selectable.is('selection')) {\n    return determineImageTypeForInsertionAtSelection(schema, selectable);\n  }\n  return schema.checkChild(selectable, 'imageInline') ? 'imageInline' : 'imageBlock';\n}\n\n// Implements the pattern: http(s)://(www.)example.com/path/to/resource.ext?query=params&maybe=too.\nconst IMAGE_URL_REGEXP = new RegExp(String(/^(http(s)?:\\/\\/)?[\\w-]+\\.[\\w.~:/[\\]@!$&'()*+,;=%-]+/.source + /\\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source + /(\\?[\\w.~:/[\\]@!$&'()*+,;=%-]*)?/.source + /(#[\\w.~:/[\\]@!$&'()*+,;=%-]*)?$/.source));\n/**\n * The auto-image plugin. It recognizes image links in the pasted content and embeds\n * them shortly after they are injected into the document.\n */\nclass AutoImage extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Clipboard, ImageUtils, Undo, Delete];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'AutoImage';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * The pasteâ€“toâ€“embed `setTimeout` ID. Stored as a property to allow\n  * cleaning of the timeout.\n  */\n  _timeoutId;\n  /**\n  * The position where the `<imageBlock>` element will be inserted after the timeout,\n  * determined each time a new content is pasted into the document.\n  */\n  _positionToInsert;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._timeoutId = null;\n    this._positionToInsert = null;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const modelDocument = editor.model.document;\n    const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n    // We need to listen on `Clipboard#inputTransformation` because we need to save positions of selection.\n    // After pasting, the content between those positions will be checked for a URL that could be transformed\n    // into an image.\n    this.listenTo(clipboardPipeline, 'inputTransformation', () => {\n      const firstRange = modelDocument.selection.getFirstRange();\n      const leftLivePosition = LivePosition.fromPosition(firstRange.start);\n      leftLivePosition.stickiness = 'toPrevious';\n      const rightLivePosition = LivePosition.fromPosition(firstRange.end);\n      rightLivePosition.stickiness = 'toNext';\n      modelDocument.once('change:data', () => {\n        this._embedImageBetweenPositions(leftLivePosition, rightLivePosition);\n        leftLivePosition.detach();\n        rightLivePosition.detach();\n      }, {\n        priority: 'high'\n      });\n    });\n    editor.commands.get('undo').on('execute', () => {\n      if (this._timeoutId) {\n        global.window.clearTimeout(this._timeoutId);\n        this._positionToInsert.detach();\n        this._timeoutId = null;\n        this._positionToInsert = null;\n      }\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Analyzes the part of the document between provided positions in search for a URL representing an image.\n  * When the URL is found, it is automatically converted into an image.\n  *\n  * @param leftPosition Left position of the selection.\n  * @param rightPosition Right position of the selection.\n  */\n  _embedImageBetweenPositions(leftPosition, rightPosition) {\n    const editor = this.editor;\n    // TODO: Use a marker instead of LiveRange & LivePositions.\n    const urlRange = new LiveRange(leftPosition, rightPosition);\n    const walker = urlRange.getWalker({\n      ignoreElementEnd: true\n    });\n    const selectionAttributes = Object.fromEntries(editor.model.document.selection.getAttributes());\n    const imageUtils = this.editor.plugins.get('ImageUtils');\n    let src = '';\n    for (const node of walker) {\n      if (node.item.is('$textProxy')) {\n        src += node.item.data;\n      }\n    }\n    src = src.trim();\n    // If the URL does not match the image URL regexp, let's skip that.\n    if (!src.match(IMAGE_URL_REGEXP)) {\n      urlRange.detach();\n      return;\n    }\n    // Position will not be available in the `setTimeout` function so let's clone it.\n    this._positionToInsert = LivePosition.fromPosition(leftPosition);\n    // This action mustn't be executed if undo was called between pasting and auto-embedding.\n    this._timeoutId = setTimeout(() => {\n      // Do nothing if image element cannot be inserted at the current position.\n      // See https://github.com/ckeditor/ckeditor5/issues/2763.\n      // Condition must be checked after timeout - pasting may take place on an element, replacing it. The final position matters.\n      const imageCommand = editor.commands.get('insertImage');\n      if (!imageCommand.isEnabled) {\n        urlRange.detach();\n        return;\n      }\n      editor.model.change(writer => {\n        this._timeoutId = null;\n        writer.remove(urlRange);\n        urlRange.detach();\n        let insertionPosition;\n        // Check if the position where the element should be inserted is still valid.\n        // Otherwise leave it as undefined to use the logic of insertImage().\n        if (this._positionToInsert.root.rootName !== '$graveyard') {\n          insertionPosition = this._positionToInsert.toPosition();\n        }\n        imageUtils.insertImage({\n          ...selectionAttributes,\n          src\n        }, insertionPosition);\n        this._positionToInsert.detach();\n        this._positionToInsert = null;\n      });\n      const deletePlugin = editor.plugins.get('Delete');\n      deletePlugin.requestUndoOnBackspace();\n    }, 100);\n  }\n}\n\n/**\n * The image text alternative command. It is used to change the `alt` attribute of `<imageBlock>` and `<imageInline>` model elements.\n */\nclass ImageTextAlternativeCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const element = imageUtils.getClosestSelectedImageElement(this.editor.model.document.selection);\n    this.isEnabled = !!element;\n    if (this.isEnabled && element.hasAttribute('alt')) {\n      this.value = element.getAttribute('alt');\n    } else {\n      this.value = false;\n    }\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options\n  * @param options.newValue The new value of the `alt` attribute to set.\n  */\n  execute(options) {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const model = editor.model;\n    const imageElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n    model.change(writer => {\n      writer.setAttribute('alt', options.newValue, imageElement);\n    });\n  }\n}\n\n/**\n * The image text alternative editing plugin.\n *\n * Registers the `'imageTextAlternative'` command.\n */\nclass ImageTextAlternativeEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageTextAlternativeEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    this.editor.commands.add('imageTextAlternative', new ImageTextAlternativeCommand(this.editor));\n  }\n}\n\n/**\n * The TextAlternativeFormView class.\n */\nclass TextAlternativeFormView extends View {\n  /**\n  * Tracks information about the DOM focus in the form.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * An input with a label.\n  */\n  labeledInput;\n  /**\n  * The Back button view displayed in the header.\n  */\n  backButtonView;\n  /**\n  * A button used to submit the form.\n  */\n  saveButtonView;\n  /**\n  * A collection of child views.\n  */\n  children;\n  /**\n  * A collection of views which can be focused in the form.\n  */\n  _focusables;\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * @inheritDoc\n  */\n  constructor(locale) {\n    super(locale);\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    // Create buttons.\n    this.backButtonView = this._createBackButton();\n    this.saveButtonView = this._createSaveButton();\n    // Create input fields.\n    this.labeledInput = this._createLabeledInputView();\n    this.children = this.createCollection([this._createHeaderView()]);\n    this.children.add(new FormRowView(locale, {\n      children: [this.labeledInput, this.saveButtonView],\n      class: ['ck-form__row_with-submit', 'ck-form__row_large-top-padding']\n    }));\n    this._focusables = new ViewCollection();\n    // Close the panel on esc key press when the **form has focus**.\n    this.keystrokes.set('Esc', (data, cancel) => {\n      this.fire('cancel');\n      cancel();\n    });\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-form', 'ck-text-alternative-form', 'ck-responsive-form'],\n        // https://github.com/ckeditor/ckeditor5-image/issues/40\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    submitHandler({\n      view: this\n    });\n    const childViews = [this.backButtonView, this.labeledInput, this.saveButtonView];\n    childViews.forEach(v => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n    });\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Creates a back button view that cancels the form.\n  */\n  _createBackButton() {\n    const t = this.locale.t;\n    const backButton = new ButtonView(this.locale);\n    backButton.set({\n      class: 'ck-button-back',\n      label: t('Back'),\n      icon: IconPreviousArrow,\n      tooltip: true\n    });\n    backButton.delegate('execute').to(this, 'cancel');\n    return backButton;\n  }\n  /**\n  * Creates a save button view that text alternative the image.\n  */\n  _createSaveButton() {\n    const t = this.locale.t;\n    const saveButton = new ButtonView(this.locale);\n    saveButton.set({\n      label: t('Save'),\n      withText: true,\n      type: 'submit',\n      class: 'ck-button-action ck-button-bold'\n    });\n    return saveButton;\n  }\n  /**\n  * Creates a header view for the form.\n  */\n  _createHeaderView() {\n    const t = this.locale.t;\n    const header = new FormHeaderView(this.locale, {\n      label: t('Text Alternative')\n    });\n    header.children.add(this.backButtonView, 0);\n    return header;\n  }\n  /**\n  * Creates an input with a label.\n  *\n  * @returns Labeled field view instance.\n  */\n  _createLabeledInputView() {\n    const t = this.locale.t;\n    const labeledInput = new LabeledFieldView(this.locale, createLabeledInputText);\n    labeledInput.label = t('Text alternative');\n    labeledInput.class = 'ck-labeled-field-view_full-width';\n    return labeledInput;\n  }\n}\n\n/**\n * A helper utility that positions the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon} instance\n * with respect to the image in the editor content, if one is selected.\n *\n * @param editor The editor instance.\n */\nfunction repositionContextualBalloon(editor) {\n  const balloon = editor.plugins.get('ContextualBalloon');\n  const imageUtils = editor.plugins.get('ImageUtils');\n  if (imageUtils.getClosestSelectedImageWidget(editor.editing.view.document.selection)) {\n    const position = getBalloonPositionData(editor);\n    balloon.updatePosition(position);\n  }\n}\n/**\n * Returns the positioning options that control the geometry of the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon} with respect\n * to the selected element in the editor content.\n *\n * @param editor The editor instance.\n */\nfunction getBalloonPositionData(editor) {\n  const editingView = editor.editing.view;\n  const defaultPositions = BalloonPanelView.defaultPositions;\n  const imageUtils = editor.plugins.get('ImageUtils');\n  return {\n    target: editingView.domConverter.mapViewToDom(imageUtils.getClosestSelectedImageWidget(editingView.document.selection)),\n    positions: [defaultPositions.northArrowSouth, defaultPositions.northArrowSouthWest, defaultPositions.northArrowSouthEast, defaultPositions.southArrowNorth, defaultPositions.southArrowNorthWest, defaultPositions.southArrowNorthEast, defaultPositions.viewportStickyNorth]\n  };\n}\n\n/**\n * The image text alternative UI plugin.\n *\n * The plugin uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon}.\n */\nclass ImageTextAlternativeUI extends Plugin {\n  /**\n  * The contextual balloon plugin instance.\n  */\n  _balloon;\n  /**\n  * A form containing a textarea and buttons, used to change the `alt` text value.\n  */\n  _form;\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ContextualBalloon];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageTextAlternativeUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    this._createButton();\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    // Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n    if (this._form) {\n      this._form.destroy();\n    }\n  }\n  /**\n  * Creates a button showing the balloon panel for changing the image text alternative and\n  * registers it in the editor {@link module:ui/componentfactory~ComponentFactory ComponentFactory}.\n  */\n  _createButton() {\n    const editor = this.editor;\n    const t = editor.t;\n    editor.ui.componentFactory.add('imageTextAlternative', locale => {\n      const command = editor.commands.get('imageTextAlternative');\n      const view = new ButtonView(locale);\n      view.set({\n        label: t('Change image text alternative'),\n        icon: IconTextAlternative,\n        tooltip: true\n      });\n      view.bind('isEnabled').to(command, 'isEnabled');\n      view.bind('isOn').to(command, 'value', value => !!value);\n      this.listenTo(view, 'execute', () => {\n        this._showForm();\n      });\n      return view;\n    });\n  }\n  /**\n  * Creates the {@link module:image/imagetextalternative/ui/textalternativeformview~TextAlternativeFormView}\n  * form.\n  */\n  _createForm() {\n    const editor = this.editor;\n    const view = editor.editing.view;\n    const viewDocument = view.document;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    this._balloon = this.editor.plugins.get('ContextualBalloon');\n    this._form = new (CssTransitionDisablerMixin(TextAlternativeFormView))(editor.locale);\n    // Render the form so its #element is available for clickOutsideHandler.\n    this._form.render();\n    this.listenTo(this._form, 'submit', () => {\n      editor.execute('imageTextAlternative', {\n        newValue: this._form.labeledInput.fieldView.element.value\n      });\n      this._hideForm(true);\n    });\n    this.listenTo(this._form, 'cancel', () => {\n      this._hideForm(true);\n    });\n    // Reposition the balloon or hide the form if an image widget is no longer selected.\n    this.listenTo(editor.ui, 'update', () => {\n      if (!imageUtils.getClosestSelectedImageWidget(viewDocument.selection)) {\n        this._hideForm(true);\n      } else if (this._isVisible) {\n        repositionContextualBalloon(editor);\n      }\n    });\n    // Close on click outside of balloon panel element.\n    clickOutsideHandler({\n      emitter: this._form,\n      activator: () => this._isVisible,\n      contextElements: () => [this._balloon.view.element],\n      callback: () => this._hideForm()\n    });\n  }\n  /**\n  * Shows the {@link #_form} in the {@link #_balloon}.\n  */\n  _showForm() {\n    if (this._isVisible) {\n      return;\n    }\n    if (!this._form) {\n      this._createForm();\n    }\n    const editor = this.editor;\n    const command = editor.commands.get('imageTextAlternative');\n    const labeledInput = this._form.labeledInput;\n    this._form.disableCssTransitions();\n    if (!this._isInBalloon) {\n      this._balloon.add({\n        view: this._form,\n        position: getBalloonPositionData(editor)\n      });\n    }\n    // Make sure that each time the panel shows up, the field remains in sync with the value of\n    // the command. If the user typed in the input, then canceled the balloon (`labeledInput#value`\n    // stays unaltered) and re-opened it without changing the value of the command, they would see the\n    // old value instead of the actual value of the command.\n    // https://github.com/ckeditor/ckeditor5-image/issues/114\n    labeledInput.fieldView.value = labeledInput.fieldView.element.value = command.value || '';\n    this._form.labeledInput.fieldView.select();\n    this._form.enableCssTransitions();\n  }\n  /**\n  * Removes the {@link #_form} from the {@link #_balloon}.\n  *\n  * @param focusEditable Controls whether the editing view is focused afterwards.\n  */\n  _hideForm(focusEditable = false) {\n    if (!this._isInBalloon) {\n      return;\n    }\n    // Blur the input element before removing it from DOM to prevent issues in some browsers.\n    // See https://github.com/ckeditor/ckeditor5/issues/1501.\n    if (this._form.focusTracker.isFocused) {\n      this._form.saveButtonView.focus();\n    }\n    this._balloon.remove(this._form);\n    if (focusEditable) {\n      this.editor.editing.view.focus();\n    }\n  }\n  /**\n  * Returns `true` when the {@link #_form} is the visible view in the {@link #_balloon}.\n  */\n  get _isVisible() {\n    return !!this._balloon && this._balloon.visibleView === this._form;\n  }\n  /**\n  * Returns `true` when the {@link #_form} is in the {@link #_balloon}.\n  */\n  get _isInBalloon() {\n    return !!this._balloon && this._balloon.hasView(this._form);\n  }\n}\n\n/**\n * The image text alternative plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-styles image styles} documentation.\n *\n * This is a \"glue\" plugin which loads the\n *  {@link module:image/imagetextalternative/imagetextalternativeediting~ImageTextAlternativeEditing}\n * and {@link module:image/imagetextalternative/imagetextalternativeui~ImageTextAlternativeUI} plugins.\n */\nclass ImageTextAlternative extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageTextAlternativeEditing, ImageTextAlternativeUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageTextAlternative';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * Returns a function that converts the image view representation:\n *\n * ```html\n * <figure class=\"image\"><img src=\"...\" alt=\"...\"></img></figure>\n * ```\n *\n * to the model representation:\n *\n * ```html\n * <imageBlock src=\"...\" alt=\"...\"></imageBlock>\n * ```\n *\n * The entire content of the `<figure>` element except the first `<img>` is being converted as children\n * of the `<imageBlock>` model element.\n *\n * @internal\n */\nfunction upcastImageFigure(imageUtils) {\n  const converter = (evt, data, conversionApi) => {\n    // Do not convert if this is not an \"image figure\".\n    if (!conversionApi.consumable.test(data.viewItem, {\n      name: true,\n      classes: 'image'\n    })) {\n      return;\n    }\n    // Find an image element inside the figure element.\n    const viewImage = imageUtils.findViewImgElement(data.viewItem);\n    // Do not convert if image element is absent or was already converted.\n    if (!viewImage || !conversionApi.consumable.test(viewImage, {\n      name: true\n    })) {\n      return;\n    }\n    // Consume the figure to prevent other converters from processing it again.\n    conversionApi.consumable.consume(data.viewItem, {\n      name: true,\n      classes: 'image'\n    });\n    // Convert view image to model image.\n    const conversionResult = conversionApi.convertItem(viewImage, data.modelCursor);\n    // Get image element from conversion result.\n    const modelImage = first(conversionResult.modelRange.getItems());\n    // When image wasn't successfully converted then finish conversion.\n    if (!modelImage) {\n      // Revert consumed figure so other features can convert it.\n      conversionApi.consumable.revert(data.viewItem, {\n        name: true,\n        classes: 'image'\n      });\n      return;\n    }\n    // Convert rest of the figure element's children as an image children.\n    conversionApi.convertChildren(data.viewItem, modelImage);\n    conversionApi.updateConversionResult(modelImage, data);\n  };\n  return dispatcher => {\n    dispatcher.on('element:figure', converter);\n  };\n}\n/**\n * Returns a function that converts the image view representation:\n *\n * ```html\n * <picture><source ... /><source ... />...<img ... /></picture>\n * ```\n *\n * to the model representation as the `sources` attribute:\n *\n * ```html\n * <image[Block|Inline] ... sources=\"...\"></image[Block|Inline]>\n * ```\n *\n * @internal\n */\nfunction upcastPicture(imageUtils) {\n  const sourceAttributeNames = ['srcset', 'media', 'type', 'sizes'];\n  const converter = (evt, data, conversionApi) => {\n    const pictureViewElement = data.viewItem;\n    // Do not convert <picture> if already consumed.\n    if (!conversionApi.consumable.test(pictureViewElement, {\n      name: true\n    })) {\n      return;\n    }\n    const sources = new Map();\n    // Collect all <source /> elements attribute values.\n    for (const childSourceElement of pictureViewElement.getChildren()) {\n      if (childSourceElement.is('element', 'source')) {\n        const attributes = {};\n        for (const name of sourceAttributeNames) {\n          if (childSourceElement.hasAttribute(name)) {\n            // Don't collect <source /> attribute if already consumed somewhere else.\n            if (conversionApi.consumable.test(childSourceElement, {\n              attributes: name\n            })) {\n              attributes[name] = childSourceElement.getAttribute(name);\n            }\n          }\n        }\n        if (Object.keys(attributes).length) {\n          sources.set(childSourceElement, attributes);\n        }\n      }\n    }\n    const imgViewElement = imageUtils.findViewImgElement(pictureViewElement);\n    // Don't convert when a picture has no <img/> inside (it is broken).\n    if (!imgViewElement) {\n      return;\n    }\n    let modelImage = data.modelCursor.parent;\n    // - In case of an inline image (cursor parent in a <paragraph>), the <img/> must be converted right away\n    // because no converter handled it yet and otherwise there would be no model element to set the sources attribute on.\n    // - In case of a block image, the <figure class=\"image\"> converter (in ImageBlockEditing) converts the\n    // <img/> right away on its own and the modelCursor is already inside an imageBlock and there's nothing special\n    // to do here.\n    if (!modelImage.is('element', 'imageBlock')) {\n      const conversionResult = conversionApi.convertItem(imgViewElement, data.modelCursor);\n      // Set image range as conversion result.\n      data.modelRange = conversionResult.modelRange;\n      // Continue conversion where image conversion ends.\n      data.modelCursor = conversionResult.modelCursor;\n      modelImage = first(conversionResult.modelRange.getItems());\n    }\n    conversionApi.consumable.consume(pictureViewElement, {\n      name: true\n    });\n    // Consume only these <source/> attributes that were actually collected and will be passed on\n    // to the image model element.\n    for (const [sourceElement, attributes] of sources) {\n      conversionApi.consumable.consume(sourceElement, {\n        attributes: Object.keys(attributes)\n      });\n    }\n    if (sources.size) {\n      conversionApi.writer.setAttribute('sources', Array.from(sources.values()), modelImage);\n    }\n    // Convert rest of the <picture> children as an image children. Other converters may want to consume them.\n    conversionApi.convertChildren(pictureViewElement, modelImage);\n  };\n  return dispatcher => {\n    dispatcher.on('element:picture', converter);\n  };\n}\n/**\n * Converter used to convert the `srcset` model image attribute to the `srcset` and `sizes` attributes in the view.\n *\n * @internal\n * @param imageType The type of the image.\n */\nfunction downcastSrcsetAttribute(imageUtils, imageType) {\n  const converter = (evt, data, conversionApi) => {\n    if (!conversionApi.consumable.consume(data.item, evt.name)) {\n      return;\n    }\n    const writer = conversionApi.writer;\n    const element = conversionApi.mapper.toViewElement(data.item);\n    const img = imageUtils.findViewImgElement(element);\n    if (data.attributeNewValue === null) {\n      writer.removeAttribute('srcset', img);\n      writer.removeAttribute('sizes', img);\n    } else {\n      if (data.attributeNewValue) {\n        writer.setAttribute('srcset', data.attributeNewValue, img);\n        // Always outputting `100vw`. See https://github.com/ckeditor/ckeditor5-image/issues/2.\n        writer.setAttribute('sizes', '100vw', img);\n      }\n    }\n  };\n  return dispatcher => {\n    dispatcher.on(`attribute:srcset:${imageType}`, converter);\n  };\n}\n/**\n * Converts the `source` model attribute to the `<picture><source /><source />...<img /></picture>`\n * view structure.\n *\n * @internal\n */\nfunction downcastSourcesAttribute(imageUtils) {\n  const converter = (evt, data, conversionApi) => {\n    if (!conversionApi.consumable.consume(data.item, evt.name)) {\n      return;\n    }\n    const viewWriter = conversionApi.writer;\n    const element = conversionApi.mapper.toViewElement(data.item);\n    const imgElement = imageUtils.findViewImgElement(element);\n    const attributeNewValue = data.attributeNewValue;\n    if (attributeNewValue && attributeNewValue.length) {\n      // Collect all wrapping attribute elements.\n      const attributeElements = [];\n      let viewElement = imgElement.parent;\n      while (viewElement && viewElement.is('attributeElement')) {\n        const parentElement = viewElement.parent;\n        viewWriter.unwrap(viewWriter.createRangeOn(imgElement), viewElement);\n        attributeElements.unshift(viewElement);\n        viewElement = parentElement;\n      }\n      const hasPictureElement = imgElement.parent.is('element', 'picture');\n      // Reuse existing <picture> element (ckeditor5#17192) or create a new one.\n      const pictureElement = hasPictureElement ? imgElement.parent : viewWriter.createContainerElement('picture', null);\n      if (!hasPictureElement) {\n        viewWriter.insert(viewWriter.createPositionBefore(imgElement), pictureElement);\n      }\n      viewWriter.remove(viewWriter.createRangeIn(pictureElement));\n      viewWriter.insert(viewWriter.createPositionAt(pictureElement, 'end'), attributeNewValue.map(sourceAttributes => {\n        return viewWriter.createEmptyElement('source', sourceAttributes);\n      }));\n      viewWriter.move(viewWriter.createRangeOn(imgElement), viewWriter.createPositionAt(pictureElement, 'end'));\n      // Apply collected attribute elements over the new picture element.\n      for (const attributeElement of attributeElements) {\n        viewWriter.wrap(viewWriter.createRangeOn(pictureElement), attributeElement);\n      }\n    } else if (imgElement.parent.is('element', 'picture')) {\n      const pictureElement = imgElement.parent;\n      viewWriter.move(viewWriter.createRangeOn(imgElement), viewWriter.createPositionBefore(pictureElement));\n      viewWriter.remove(pictureElement);\n    }\n  };\n  return dispatcher => {\n    dispatcher.on('attribute:sources:imageBlock', converter);\n    dispatcher.on('attribute:sources:imageInline', converter);\n  };\n}\n/**\n * Converter used to convert a given image attribute from the model to the view.\n *\n * @internal\n * @param imageType The type of the image.\n * @param attributeKey The name of the attribute to convert.\n */\nfunction downcastImageAttribute(imageUtils, imageType, attributeKey) {\n  const converter = (evt, data, conversionApi) => {\n    if (!conversionApi.consumable.consume(data.item, evt.name)) {\n      return;\n    }\n    const viewWriter = conversionApi.writer;\n    const element = conversionApi.mapper.toViewElement(data.item);\n    const img = imageUtils.findViewImgElement(element);\n    viewWriter.setAttribute(data.attributeKey, data.attributeNewValue || '', img);\n  };\n  return dispatcher => {\n    dispatcher.on(`attribute:${attributeKey}:${imageType}`, converter);\n  };\n}\n\n/**\n * Observes all new images added to the {@link module:engine/view/document~Document},\n * fires {@link module:engine/view/document~Document#event:imageLoaded} and\n * {@link module:engine/view/document~Document#event:layoutChanged} event every time when the new image\n * has been loaded.\n *\n * **Note:** This event is not fired for images that has been added to the document and rendered as `complete` (already loaded).\n */\nclass ImageLoadObserver extends Observer {\n  /**\n  * @inheritDoc\n  */\n  observe(domRoot) {\n    this.listenTo(domRoot, 'load', (event, domEvent) => {\n      const domElement = domEvent.target;\n      if (this.checkShouldIgnoreEventFromTarget(domElement)) {\n        return;\n      }\n      if (domElement.tagName == 'IMG') {\n        this._fireEvents(domEvent);\n      }\n      // Use capture phase for better performance (#4504).\n    }, {\n      useCapture: true\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  stopObserving(domRoot) {\n    this.stopListening(domRoot);\n  }\n  /**\n  * Fires {@link module:engine/view/document~Document#event:layoutChanged} and\n  * {@link module:engine/view/document~Document#event:imageLoaded}\n  * if observer {@link #isEnabled is enabled}.\n  *\n  * @param domEvent The DOM event.\n  */\n  _fireEvents(domEvent) {\n    if (this.isEnabled) {\n      this.document.fire('layoutChanged');\n      this.document.fire('imageLoaded', domEvent);\n    }\n  }\n}\n\n/**\n * Insert image command.\n *\n * The command is registered by the {@link module:image/image/imageediting~ImageEditing} plugin as `insertImage`\n * and it is also available via aliased `imageInsert` name.\n *\n * In order to insert an image at the current selection position\n * (according to the {@link module:widget/utils~findOptimalInsertionRange} algorithm),\n * execute the command and specify the image source:\n *\n * ```ts\n * editor.execute( 'insertImage', { source: 'http://url.to.the/image' } );\n * ```\n *\n * It is also possible to insert multiple images at once:\n *\n * ```ts\n * editor.execute( 'insertImage', {\n * \tsource:  [\n * \t\t'path/to/image.jpg',\n * \t\t'path/to/other-image.jpg'\n * \t]\n * } );\n * ```\n *\n * If you want to take the full control over the process, you can specify individual model attributes:\n *\n * ```ts\n * editor.execute( 'insertImage', {\n * \tsource:  [\n * \t\t{ src: 'path/to/image.jpg', alt: 'First alt text' },\n * \t\t{ src: 'path/to/other-image.jpg', alt: 'Second alt text', customAttribute: 'My attribute value' }\n * \t]\n * } );\n * ```\n */\nclass InsertImageCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    const configImageInsertType = editor.config.get('image.insert.type');\n    if (!editor.plugins.has('ImageBlockEditing')) {\n      if (configImageInsertType === 'block') {\n        /**\n        * The {@link module:image/imageblock~ImageBlock} plugin must be enabled to allow inserting block images. See\n        * {@link module:image/imageconfig~ImageInsertConfig#type} to learn more.\n        *\n        * @error image-block-plugin-required\n        */\n        logWarning('image-block-plugin-required');\n      }\n    }\n    if (!editor.plugins.has('ImageInlineEditing')) {\n      if (configImageInsertType === 'inline') {\n        /**\n        * The {@link module:image/imageinline~ImageInline} plugin must be enabled to allow inserting inline images. See\n        * {@link module:image/imageconfig~ImageInsertConfig#type} to learn more.\n        *\n        * @error image-inline-plugin-required\n        */\n        logWarning('image-inline-plugin-required');\n      }\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const imageUtils = this.editor.plugins.get('ImageUtils');\n    this.isEnabled = imageUtils.isImageAllowed();\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options Options for the executed command.\n  * @param options.imageType The type of the image to insert. If not specified, the type will be determined automatically.\n  * @param options.source The image source or an array of image sources to insert.\n  * @param options.breakBlock If set to `true`, the block at the selection start will be broken before inserting the image.\n  * See the documentation of the command to learn more about accepted formats.\n  */\n  execute(options) {\n    const sourceDefinitions = toArray(options.source);\n    const selection = this.editor.model.document.selection;\n    const imageUtils = this.editor.plugins.get('ImageUtils');\n    // In case of multiple images, each image (starting from the 2nd) will be inserted at a position that\n    // follows the previous one. That will move the selection and, to stay on the safe side and make sure\n    // all images inherit the same selection attributes, they are collected beforehand.\n    //\n    // Applying these attributes ensures, for instance, that inserting an (inline) image into a link does\n    // not split that link but preserves its continuity.\n    //\n    // Note: Selection attributes that do not make sense for images will be filtered out by insertImage() anyway.\n    const selectionAttributes = Object.fromEntries(selection.getAttributes());\n    sourceDefinitions.forEach((sourceDefinition, index) => {\n      const selectedElement = selection.getSelectedElement();\n      if (typeof sourceDefinition === 'string') {\n        sourceDefinition = {\n          src: sourceDefinition\n        };\n      }\n      // Inserting of an inline image replace the selected element and make a selection on the inserted image.\n      // Therefore inserting multiple inline images requires creating position after each element.\n      if (index && selectedElement && imageUtils.isImage(selectedElement)) {\n        const position = this.editor.model.createPositionAfter(selectedElement);\n        imageUtils.insertImage({\n          ...sourceDefinition,\n          ...selectionAttributes\n        }, position, options.imageType);\n      } else if (options.breakBlock) {\n        imageUtils.insertImage({\n          ...sourceDefinition,\n          ...selectionAttributes\n        }, selection.getFirstPosition(), options.imageType);\n      } else {\n        imageUtils.insertImage({\n          ...sourceDefinition,\n          ...selectionAttributes\n        }, null, options.imageType);\n      }\n    });\n  }\n}\n\n/**\n * @module image/image/replaceimagesourcecommand\n */ /**\n    * Replace image source command.\n    *\n    * Changes image source to the one provided. Can be executed as follows:\n    *\n    * ```ts\n    * editor.execute( 'replaceImageSource', { source: 'http://url.to.the/image' } );\n    * ```\n    */\nclass ReplaceImageSourceCommand extends Command {\n  constructor(editor) {\n    super(editor);\n    this.decorate('cleanupImage');\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const element = this.editor.model.document.selection.getSelectedElement();\n    this.isEnabled = imageUtils.isImage(element);\n    this.value = this.isEnabled ? element.getAttribute('src') : null;\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options Options for the executed command.\n  * @param options.source The image source to replace.\n  */\n  execute(options) {\n    const image = this.editor.model.document.selection.getSelectedElement();\n    const imageUtils = this.editor.plugins.get('ImageUtils');\n    this.editor.model.change(writer => {\n      writer.setAttribute('src', options.source, image);\n      this.cleanupImage(writer, image);\n      imageUtils.setImageNaturalSizeAttributes(image);\n    });\n  }\n  /**\n  * Cleanup image attributes that are not relevant to the new source.\n  *\n  * Removed attributes are: 'srcset', 'sizes', 'sources', 'width', 'height', 'alt'.\n  *\n  * This method is decorated, to allow custom cleanup logic.\n  * For example, to remove 'myImageId' attribute after 'src' has changed:\n  *\n  * ```ts\n  * replaceImageSourceCommand.on( 'cleanupImage', ( eventInfo, [ writer, image ] ) => {\n  * \twriter.removeAttribute( 'myImageId', image );\n  * } );\n  * ```\n  */\n  cleanupImage(writer, image) {\n    writer.removeAttribute('srcset', image);\n    writer.removeAttribute('sizes', image);\n    /**\n    * In case responsive images some attributes should be cleaned up.\n    * Check: https://github.com/ckeditor/ckeditor5/issues/15093\n    */\n    writer.removeAttribute('sources', image);\n    writer.removeAttribute('width', image);\n    writer.removeAttribute('height', image);\n    writer.removeAttribute('alt', image);\n  }\n}\n\n/**\n * The image engine plugin. This module loads common code shared between\n * {@link module:image/image/imageinlineediting~ImageInlineEditing} and\n * {@link module:image/image/imageblockediting~ImageBlockEditing} plugins.\n *\n * This plugin registers the {@link module:image/image/insertimagecommand~InsertImageCommand 'insertImage'} command.\n */\nclass ImageEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const conversion = editor.conversion;\n    // See https://github.com/ckeditor/ckeditor5-image/issues/142.\n    editor.editing.view.addObserver(ImageLoadObserver);\n    conversion.for('upcast').attributeToAttribute({\n      view: {\n        name: 'img',\n        key: 'alt'\n      },\n      model: 'alt'\n    }).attributeToAttribute({\n      view: {\n        name: 'img',\n        key: 'srcset'\n      },\n      model: 'srcset'\n    });\n    const insertImageCommand = new InsertImageCommand(editor);\n    const replaceImageSourceCommand = new ReplaceImageSourceCommand(editor);\n    editor.commands.add('insertImage', insertImageCommand);\n    editor.commands.add('replaceImageSource', replaceImageSourceCommand);\n    // `imageInsert` is an alias for backward compatibility.\n    editor.commands.add('imageInsert', insertImageCommand);\n  }\n}\n\n/**\n * This plugin enables `width` and `height` attributes in inline and block image elements.\n */\nclass ImageSizeAttributes extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageSizeAttributes';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    this._registerSchema();\n    this._registerConverters('imageBlock');\n    this._registerConverters('imageInline');\n  }\n  /**\n  * Registers the `width` and `height` attributes for inline and block images.\n  */\n  _registerSchema() {\n    if (this.editor.plugins.has('ImageBlockEditing')) {\n      this.editor.model.schema.extend('imageBlock', {\n        allowAttributes: ['width', 'height']\n      });\n    }\n    if (this.editor.plugins.has('ImageInlineEditing')) {\n      this.editor.model.schema.extend('imageInline', {\n        allowAttributes: ['width', 'height']\n      });\n    }\n  }\n  /**\n  * Registers converters for `width` and `height` attributes.\n  */\n  _registerConverters(imageType) {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const viewElementName = imageType === 'imageBlock' ? 'figure' : 'img';\n    editor.conversion.for('upcast').attributeToAttribute({\n      view: {\n        name: viewElementName,\n        styles: {\n          width: /.+/\n        }\n      },\n      model: {\n        key: 'width',\n        value: viewElement => {\n          if (widthAndHeightStylesAreBothSet(viewElement)) {\n            return getSizeValueIfInPx(viewElement.getStyle('width'));\n          }\n          return null;\n        }\n      }\n    }).attributeToAttribute({\n      view: {\n        name: viewElementName,\n        key: 'width'\n      },\n      model: 'width'\n    }).attributeToAttribute({\n      view: {\n        name: viewElementName,\n        styles: {\n          height: /.+/\n        }\n      },\n      model: {\n        key: 'height',\n        value: viewElement => {\n          if (widthAndHeightStylesAreBothSet(viewElement)) {\n            return getSizeValueIfInPx(viewElement.getStyle('height'));\n          }\n          return null;\n        }\n      }\n    }).attributeToAttribute({\n      view: {\n        name: viewElementName,\n        key: 'height'\n      },\n      model: 'height'\n    });\n    // Dedicated converters to propagate attributes to the <img> element.\n    editor.conversion.for('editingDowncast').add(dispatcher => {\n      attachDowncastConverter(dispatcher, 'width', 'width', true, true);\n      attachDowncastConverter(dispatcher, 'height', 'height', true, true);\n    });\n    editor.conversion.for('dataDowncast').add(dispatcher => {\n      attachDowncastConverter(dispatcher, 'width', 'width', false);\n      attachDowncastConverter(dispatcher, 'height', 'height', false);\n    });\n    function attachDowncastConverter(dispatcher, modelAttributeName, viewAttributeName, setRatioForInlineImage, isEditingDowncast = false) {\n      dispatcher.on(`attribute:${modelAttributeName}:${imageType}`, (evt, data, conversionApi) => {\n        if (!conversionApi.consumable.consume(data.item, evt.name)) {\n          return;\n        }\n        const viewWriter = conversionApi.writer;\n        const viewElement = conversionApi.mapper.toViewElement(data.item);\n        const img = imageUtils.findViewImgElement(viewElement);\n        if (data.attributeNewValue !== null) {\n          viewWriter.setAttribute(viewAttributeName, data.attributeNewValue, img);\n        } else {\n          viewWriter.removeAttribute(viewAttributeName, img);\n        }\n        const width = data.item.getAttribute('width');\n        const height = data.item.getAttribute('height');\n        const hasSizes = width && height;\n        if (hasSizes && isEditingDowncast) {\n          viewWriter.setAttribute('loading', 'lazy', img);\n        }\n        // Do not set aspect-ratio for pictures. See https://github.com/ckeditor/ckeditor5/issues/14579.\n        if (data.item.hasAttribute('sources')) {\n          return;\n        }\n        const isResized = data.item.hasAttribute('resizedWidth');\n        // Do not set aspect ratio for inline images which are not resized (data pipeline).\n        if (imageType === 'imageInline' && !isResized && !setRatioForInlineImage) {\n          return;\n        }\n        if (hasSizes) {\n          viewWriter.setStyle('aspect-ratio', `${width}/${height}`, img);\n        }\n      });\n    }\n  }\n}\n\n/**\n * The image type command. It changes the type of a selected image, depending on the configuration.\n */\nclass ImageTypeCommand extends Command {\n  /**\n  * Model element name the command converts to.\n  */\n  _modelElementName;\n  /**\n  * @inheritDoc\n  *\n  * @param modelElementName Model element name the command converts to.\n  */\n  constructor(editor, modelElementName) {\n    super(editor);\n    this._modelElementName = modelElementName;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const element = imageUtils.getClosestSelectedImageElement(this.editor.model.document.selection);\n    if (this._modelElementName === 'imageBlock') {\n      this.isEnabled = imageUtils.isInlineImage(element);\n    } else {\n      this.isEnabled = imageUtils.isBlockImage(element);\n    }\n  }\n  /**\n  * Executes the command and changes the type of a selected image.\n  *\n  * @fires execute\n  * @param options.setImageSizes Specifies whether the image `width` and `height` attributes should be set automatically.\n  * The default is `true`.\n  * @returns An object containing references to old and new model image elements\n  * (for before and after the change) so external integrations can hook into the decorated\n  * `execute` event and handle this change. `null` if the type change failed.\n  */\n  execute(options = {}) {\n    const editor = this.editor;\n    const model = this.editor.model;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const oldElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n    const attributes = Object.fromEntries(oldElement.getAttributes());\n    // Don't change image type if \"src\" is missing (a broken image), unless there's \"uploadId\" set.\n    // This state may happen during image upload (before it finishes) and it should be possible to change type\n    // of the image in the meantime.\n    if (!attributes.src && !attributes.uploadId) {\n      return null;\n    }\n    return model.change(writer => {\n      const {\n        setImageSizes = true\n      } = options;\n      // Get all markers that contain the old image element.\n      const markers = Array.from(model.markers).filter(marker => marker.getRange().containsItem(oldElement));\n      const newElement = imageUtils.insertImage(attributes, model.createSelection(oldElement, 'on'), this._modelElementName, {\n        setImageSizes\n      });\n      if (!newElement) {\n        return null;\n      }\n      const newElementRange = writer.createRangeOn(newElement);\n      // Expand the previously intersecting markers' ranges to include the new image element.\n      for (const marker of markers) {\n        const markerRange = marker.getRange();\n        // Join the survived part of the old marker range with the new element range\n        // (loosely because there could be some new paragraph or the existing one might got split).\n        const range = markerRange.root.rootName != '$graveyard' ? markerRange.getJoined(newElementRange, true) : newElementRange;\n        writer.updateMarker(marker, {\n          range\n        });\n      }\n      return {\n        oldElement,\n        newElement\n      };\n    });\n  }\n}\n\n/**\n * Adds support for image placeholder that is automatically removed when the image is loaded.\n */\nclass ImagePlaceholder extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImagePlaceholder';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    this._setupSchema();\n    this._setupConversion();\n    this._setupLoadListener();\n  }\n  /**\n  * Extends model schema.\n  */\n  _setupSchema() {\n    const schema = this.editor.model.schema;\n    // Wait for ImageBlockEditing or ImageInlineEditing to register their elements first,\n    // that's why doing this in afterInit() instead of init().\n    if (schema.isRegistered('imageBlock')) {\n      schema.extend('imageBlock', {\n        allowAttributes: ['placeholder']\n      });\n    }\n    if (schema.isRegistered('imageInline')) {\n      schema.extend('imageInline', {\n        allowAttributes: ['placeholder']\n      });\n    }\n  }\n  /**\n  * Registers converters.\n  */\n  _setupConversion() {\n    const editor = this.editor;\n    const conversion = editor.conversion;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    conversion.for('editingDowncast').add(dispatcher => {\n      dispatcher.on('attribute:placeholder', (evt, data, conversionApi) => {\n        if (!conversionApi.consumable.test(data.item, evt.name)) {\n          return;\n        }\n        if (!data.item.is('element', 'imageBlock') && !data.item.is('element', 'imageInline')) {\n          return;\n        }\n        conversionApi.consumable.consume(data.item, evt.name);\n        const viewWriter = conversionApi.writer;\n        const element = conversionApi.mapper.toViewElement(data.item);\n        const img = imageUtils.findViewImgElement(element);\n        if (data.attributeNewValue) {\n          viewWriter.addClass('image_placeholder', img);\n          viewWriter.setStyle('background-image', `url(${data.attributeNewValue})`, img);\n          viewWriter.setCustomProperty('editingPipeline:doNotReuseOnce', true, img);\n        } else {\n          viewWriter.removeClass('image_placeholder', img);\n          viewWriter.removeStyle('background-image', img);\n        }\n      });\n    });\n  }\n  /**\n  * Prepares listener for image load.\n  */\n  _setupLoadListener() {\n    const editor = this.editor;\n    const model = editor.model;\n    const editing = editor.editing;\n    const editingView = editing.view;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    editingView.addObserver(ImageLoadObserver);\n    this.listenTo(editingView.document, 'imageLoaded', (evt, domEvent) => {\n      const imgViewElement = editingView.domConverter.mapDomToView(domEvent.target);\n      if (!imgViewElement) {\n        return;\n      }\n      const viewElement = imageUtils.getImageWidgetFromImageView(imgViewElement);\n      if (!viewElement) {\n        return;\n      }\n      const modelElement = editing.mapper.toModelElement(viewElement);\n      if (!modelElement || !modelElement.hasAttribute('placeholder')) {\n        return;\n      }\n      model.enqueueChange({\n        isUndoable: false\n      }, writer => {\n        writer.removeAttribute('placeholder', modelElement);\n      });\n    });\n  }\n}\n\n/**\n * The image block plugin.\n *\n * It registers:\n *\n * * `<imageBlock>` as a block element in the document schema, and allows `alt`, `src` and `srcset` attributes.\n * * converters for editing and data pipelines.,\n * * {@link module:image/image/imagetypecommand~ImageTypeCommand `'imageTypeBlock'`} command that converts inline images into\n * block images.\n */\nclass ImageBlockEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageEditing, ImageSizeAttributes, ImageUtils, ImagePlaceholder, ClipboardPipeline];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageBlockEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    // Converters 'alt' and 'srcset' are added in 'ImageEditing' plugin.\n    schema.register('imageBlock', {\n      inheritAllFrom: '$blockObject',\n      allowAttributes: ['alt', 'src', 'srcset']\n    });\n    this._setupConversion();\n    if (editor.plugins.has('ImageInlineEditing')) {\n      editor.commands.add('imageTypeBlock', new ImageTypeCommand(this.editor, 'imageBlock'));\n      this._setupClipboardIntegration();\n    }\n  }\n  /**\n  * Configures conversion pipelines to support upcasting and downcasting\n  * block images (block image widgets) and their attributes.\n  */\n  _setupConversion() {\n    const editor = this.editor;\n    const t = editor.t;\n    const conversion = editor.conversion;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    conversion.for('dataDowncast').elementToStructure({\n      model: 'imageBlock',\n      view: (modelElement, {\n        writer\n      }) => createBlockImageViewElement(writer)\n    });\n    conversion.for('editingDowncast').elementToStructure({\n      model: 'imageBlock',\n      view: (modelElement, {\n        writer\n      }) => imageUtils.toImageWidget(createBlockImageViewElement(writer), writer, t('image widget'))\n    });\n    conversion.for('downcast').add(downcastImageAttribute(imageUtils, 'imageBlock', 'src')).add(downcastImageAttribute(imageUtils, 'imageBlock', 'alt')).add(downcastSrcsetAttribute(imageUtils, 'imageBlock'));\n    // More image related upcasts are in 'ImageEditing' plugin.\n    conversion.for('upcast').elementToElement({\n      view: getImgViewElementMatcher(editor, 'imageBlock'),\n      model: (viewImage, {\n        writer\n      }) => writer.createElement('imageBlock', viewImage.hasAttribute('src') ? {\n        src: viewImage.getAttribute('src')\n      } : undefined)\n    }).add(upcastImageFigure(imageUtils));\n  }\n  /**\n  * Integrates the plugin with the clipboard pipeline.\n  *\n  * Idea is that the feature should recognize the user's intent when an **inline** image is\n  * pasted or dropped. If such an image is pasted/dropped:\n  *\n  * * into an empty block (e.g. an empty paragraph),\n  * * on another object (e.g. some block widget).\n  *\n  * it gets converted into a block image on the fly. We assume this is the user's intent\n  * if they decided to put their image there.\n  *\n  * See the `ImageInlineEditing` for the similar integration that works in the opposite direction.\n  *\n  * The feature also sets image `width` and `height` attributes on paste.\n  */\n  _setupClipboardIntegration() {\n    const editor = this.editor;\n    const model = editor.model;\n    const editingView = editor.editing.view;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n    this.listenTo(clipboardPipeline, 'inputTransformation', (evt, data) => {\n      const docFragmentChildren = Array.from(data.content.getChildren());\n      let modelRange;\n      // Make sure only <img> elements are dropped or pasted. Otherwise, if there some other HTML\n      // mixed up, this should be handled as a regular paste.\n      if (!docFragmentChildren.every(imageUtils.isInlineImageView)) {\n        return;\n      }\n      // When drag and dropping, data.targetRanges specifies where to drop because\n      // this is usually a different place than the current model selection (the user\n      // uses a drop marker to specify the drop location).\n      if (data.targetRanges) {\n        modelRange = editor.editing.mapper.toModelRange(data.targetRanges[0]);\n      } else {\n        modelRange = model.document.selection.getFirstRange();\n      }\n      const selection = model.createSelection(modelRange);\n      // Convert inline images into block images only when the currently selected block is empty\n      // (e.g. an empty paragraph) or some object is selected (to replace it).\n      if (determineImageTypeForInsertionAtSelection(model.schema, selection) === 'imageBlock') {\n        const writer = new UpcastWriter(editingView.document);\n        // Wrap <img ... /> -> <figure class=\"image\"><img .../></figure>\n        const blockViewImages = docFragmentChildren.map(inlineViewImage => writer.createElement('figure', {\n          class: 'image'\n        }, inlineViewImage));\n        data.content = writer.createDocumentFragment(blockViewImages);\n      }\n    });\n    this.listenTo(clipboardPipeline, 'contentInsertion', (evt, data) => {\n      if (data.method !== 'paste') {\n        return;\n      }\n      model.change(writer => {\n        const range = writer.createRangeIn(data.content);\n        for (const item of range.getItems()) {\n          if (item.is('element', 'imageBlock')) {\n            imageUtils.setImageNaturalSizeAttributes(item);\n          }\n        }\n      });\n    });\n  }\n}\n\n/**\n * The view displayed in the insert image dropdown.\n *\n * See {@link module:image/imageinsert/imageinsertui~ImageInsertUI}.\n */\nclass ImageInsertFormView extends View {\n  /**\n  * Tracks information about DOM focus in the form.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * A collection of views that can be focused in the form.\n  */\n  _focusables;\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * A collection of the defined integrations for inserting the images.\n  */\n  children;\n  /**\n  * Creates a view for the dropdown panel of {@link module:image/imageinsert/imageinsertui~ImageInsertUI}.\n  *\n  * @param locale The localization services instance.\n  * @param integrations An integrations object that contains components (or tokens for components) to be shown in the panel view.\n  */\n  constructor(locale, integrations = []) {\n    super(locale);\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this._focusables = new ViewCollection();\n    this.children = this.createCollection();\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    for (const view of integrations) {\n      this.children.add(view);\n      this._focusables.add(view);\n      if (view instanceof CollapsibleView) {\n        this._focusables.addMany(view.children);\n      }\n    }\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-image-insert-form'],\n        tabindex: -1\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    submitHandler({\n      view: this\n    });\n    for (const view of this._focusables) {\n      this.focusTracker.add(view.element);\n    }\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n    const stopPropagation = data => data.stopPropagation();\n    // Since the form is in the dropdown panel which is a child of the toolbar, the toolbar's\n    // keystroke handler would take over the key management in the URL input. We need to prevent\n    // this ASAP. Otherwise, the basic caret movement using the arrow keys will be impossible.\n    this.keystrokes.set('arrowright', stopPropagation);\n    this.keystrokes.set('arrowleft', stopPropagation);\n    this.keystrokes.set('arrowup', stopPropagation);\n    this.keystrokes.set('arrowdown', stopPropagation);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the first {@link #_focusables focusable} in the form.\n  */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n}\n\n/**\n * The image insert dropdown plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload Image upload feature}\n * and {@glink features/images/images-inserting Insert images via source URL} documentation.\n *\n * Adds the `'insertImage'` dropdown to the {@link module:ui/componentfactory~ComponentFactory UI component factory}\n * and also the `imageInsert` dropdown as an alias for backward compatibility.\n *\n * Adds the `'menuBar:insertImage'` sub-menu to the {@link module:ui/componentfactory~ComponentFactory UI component factory}, which is\n * by default added to the `'Insert'` menu.\n */\nclass ImageInsertUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageInsertUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUtils];\n  }\n  /**\n  * The dropdown view responsible for displaying the image insert UI.\n  */\n  dropdownView;\n  /**\n  * Registered integrations map.\n  */\n  _integrations = new Map();\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('image.insert.integrations', ['upload', 'assetManager', 'url']);\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    this.set('isImageSelected', false);\n    this.listenTo(editor.model.document, 'change', () => {\n      this.isImageSelected = imageUtils.isImage(selection.getSelectedElement());\n    });\n    const componentCreator = locale => this._createToolbarComponent(locale);\n    const menuBarComponentCreator = locale => this._createMenuBarComponent(locale);\n    // Register `insertImage` dropdown and add `imageInsert` dropdown as an alias for backward compatibility.\n    editor.ui.componentFactory.add('insertImage', componentCreator);\n    editor.ui.componentFactory.add('imageInsert', componentCreator);\n    editor.ui.componentFactory.add('menuBar:insertImage', menuBarComponentCreator);\n  }\n  /**\n  * Registers the insert image dropdown integration.\n  */\n  registerIntegration({\n    name,\n    observable,\n    buttonViewCreator,\n    formViewCreator,\n    menuBarButtonViewCreator,\n    requiresForm = false,\n    override = false\n  }) {\n    if (this._integrations.has(name) && !override) {\n      /**\n      * There are two insert-image integrations registered with the same name.\n      *\n      * Make sure that you do not load multiple asset manager plugins.\n      *\n      * @error image-insert-integration-exists\n      */\n      logWarning('image-insert-integration-exists', {\n        name\n      });\n    }\n    this._integrations.set(name, {\n      observable,\n      buttonViewCreator,\n      menuBarButtonViewCreator,\n      formViewCreator,\n      requiresForm\n    });\n  }\n  /**\n  * Creates the toolbar component.\n  */\n  _createToolbarComponent(locale) {\n    const editor = this.editor;\n    const t = locale.t;\n    const integrations = this._prepareIntegrations();\n    if (!integrations.length) {\n      return null;\n    }\n    let dropdownButton;\n    const firstIntegration = integrations[0];\n    if (integrations.length == 1) {\n      // Do not use dropdown for a single integration button (integration that does not require form view).\n      if (!firstIntegration.requiresForm) {\n        return firstIntegration.buttonViewCreator(true);\n      }\n      dropdownButton = firstIntegration.buttonViewCreator(true);\n    } else {\n      const actionButton = firstIntegration.buttonViewCreator(false);\n      dropdownButton = new SplitButtonView(locale, actionButton);\n      dropdownButton.tooltip = true;\n      dropdownButton.bind('label').to(this, 'isImageSelected', isImageSelected => isImageSelected ? t('Replace image') : t('Insert image'));\n    }\n    const dropdownView = this.dropdownView = createDropdown(locale, dropdownButton);\n    const observables = integrations.map(({\n      observable\n    }) => typeof observable == 'function' ? observable() : observable);\n    dropdownView.bind('isEnabled').toMany(observables, 'isEnabled', (...isEnabled) => isEnabled.some(isEnabled => isEnabled));\n    dropdownView.once('change:isOpen', () => {\n      const integrationViews = integrations.flatMap(({\n        formViewCreator\n      }) => formViewCreator(integrations.length == 1));\n      const imageInsertFormView = new ImageInsertFormView(editor.locale, integrationViews);\n      dropdownView.panelView.children.add(imageInsertFormView);\n    });\n    return dropdownView;\n  }\n  /**\n  * Creates the menu bar component.\n  */\n  _createMenuBarComponent(locale) {\n    const t = locale.t;\n    const integrations = this._prepareIntegrations();\n    if (!integrations.length) {\n      return null;\n    }\n    const integrationViews = integrations.flatMap(({\n      menuBarButtonViewCreator\n    }) => menuBarButtonViewCreator(integrations.length == 1));\n    const resultView = new MenuBarMenuView(locale);\n    const listView = new MenuBarMenuListView(locale);\n    resultView.panelView.children.add(listView);\n    resultView.buttonView.set({\n      icon: IconImage,\n      label: t('Image')\n    });\n    for (const integrationView of integrationViews) {\n      const listItemView = new MenuBarMenuListItemView(locale, resultView);\n      listItemView.children.add(integrationView);\n      listView.items.add(listItemView);\n      integrationView.delegate('execute').to(resultView);\n    }\n    return resultView;\n  }\n  /**\n  * Validates the integrations list.\n  */\n  _prepareIntegrations() {\n    const editor = this.editor;\n    const items = editor.config.get('image.insert.integrations');\n    const result = [];\n    if (!items.length) {\n      /**\n      * The insert image feature requires a list of integrations to be provided in the editor configuration.\n      *\n      * The default list of integrations is `upload`, `assetManager`, `url`. Those integrations are included\n      * in the insert image dropdown if the given feature plugin is loaded. You should omit the `integrations`\n      * configuration key to use the default set or provide a selected list of integrations that should be used.\n      *\n      * @error image-insert-integrations-not-specified\n      */\n      logWarning('image-insert-integrations-not-specified');\n      return result;\n    }\n    for (const item of items) {\n      if (!this._integrations.has(item)) {\n        if (!['upload', 'assetManager', 'url'].includes(item)) {\n          /**\n          * The specified insert image integration name is unknown or the providing plugin is not loaded in the editor.\n          *\n          * @error image-insert-unknown-integration\n          */\n          logWarning('image-insert-unknown-integration', {\n            item\n          });\n        }\n        continue;\n      }\n      result.push(this._integrations.get(item));\n    }\n    if (!result.length) {\n      /**\n      * The image insert feature requires integrations to be registered by separate features.\n      *\n      * The `insertImage` toolbar button requires integrations to be registered by other features.\n      * For example {@link module:image/imageupload~ImageUpload ImageUpload},\n      * {@link module:image/imageinsert~ImageInsert ImageInsert},\n      * {@link module:image/imageinsertviaurl~ImageInsertViaUrl ImageInsertViaUrl},\n      * {@link module:ckbox/ckbox~CKBox CKBox}\n      *\n      * @error image-insert-integrations-not-registered\n      */\n      logWarning('image-insert-integrations-not-registered');\n    }\n    return result;\n  }\n}\n\n/**\n * The image block plugin.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:image/image/imageblockediting~ImageBlockEditing},\n * * {@link module:image/imagetextalternative~ImageTextAlternative}.\n *\n * Usually, it is used in conjunction with other plugins from this package. See the {@glink api/image package page}\n * for more information.\n */\nclass ImageBlock extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageBlockEditing, Widget, ImageTextAlternative, ImageInsertUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageBlock';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The image inline plugin.\n *\n * It registers:\n *\n * * `<imageInline>` as an inline element in the document schema, and allows `alt`, `src` and `srcset` attributes.\n * * converters for editing and data pipelines.\n * * {@link module:image/image/imagetypecommand~ImageTypeCommand `'imageTypeInline'`} command that converts block images into\n * inline images.\n */\nclass ImageInlineEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageEditing, ImageSizeAttributes, ImageUtils, ImagePlaceholder, ClipboardPipeline];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageInlineEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    // Converters 'alt' and 'srcset' are added in 'ImageEditing' plugin.\n    schema.register('imageInline', {\n      inheritAllFrom: '$inlineObject',\n      allowAttributes: ['alt', 'src', 'srcset'],\n      // Disallow inline images in captions (at least for now).\n      // This is the best spot to do that because independent packages can introduce captions (ImageCaption, TableCaption, etc.).\n      disallowIn: ['caption']\n    });\n    this._setupConversion();\n    if (editor.plugins.has('ImageBlockEditing')) {\n      editor.commands.add('imageTypeInline', new ImageTypeCommand(this.editor, 'imageInline'));\n      this._setupClipboardIntegration();\n    }\n  }\n  /**\n  * Configures conversion pipelines to support upcasting and downcasting\n  * inline images (inline image widgets) and their attributes.\n  */\n  _setupConversion() {\n    const editor = this.editor;\n    const t = editor.t;\n    const conversion = editor.conversion;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    conversion.for('dataDowncast').elementToElement({\n      model: 'imageInline',\n      view: (modelElement, {\n        writer\n      }) => writer.createEmptyElement('img')\n    });\n    conversion.for('editingDowncast').elementToStructure({\n      model: 'imageInline',\n      view: (modelElement, {\n        writer\n      }) => imageUtils.toImageWidget(createInlineImageViewElement(writer), writer, t('image widget'))\n    });\n    conversion.for('downcast').add(downcastImageAttribute(imageUtils, 'imageInline', 'src')).add(downcastImageAttribute(imageUtils, 'imageInline', 'alt')).add(downcastSrcsetAttribute(imageUtils, 'imageInline'));\n    // More image related upcasts are in 'ImageEditing' plugin.\n    conversion.for('upcast').elementToElement({\n      view: getImgViewElementMatcher(editor, 'imageInline'),\n      model: (viewImage, {\n        writer\n      }) => writer.createElement('imageInline', viewImage.hasAttribute('src') ? {\n        src: viewImage.getAttribute('src')\n      } : undefined)\n    });\n  }\n  /**\n  * Integrates the plugin with the clipboard pipeline.\n  *\n  * Idea is that the feature should recognize the user's intent when an **block** image is\n  * pasted or dropped. If such an image is pasted/dropped into a non-empty block\n  * (e.g. a paragraph with some text) it gets converted into an inline image on the fly.\n  *\n  * We assume this is the user's intent if they decided to put their image there.\n  *\n  * **Note**: If a block image has a caption, it will not be converted to an inline image\n  * to avoid the confusion. Captions are added on purpose and they should never be lost\n  * in the clipboard pipeline.\n  *\n  * See the `ImageBlockEditing` for the similar integration that works in the opposite direction.\n  *\n  * The feature also sets image `width` and `height` attributes when pasting.\n  */\n  _setupClipboardIntegration() {\n    const editor = this.editor;\n    const model = editor.model;\n    const editingView = editor.editing.view;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n    this.listenTo(clipboardPipeline, 'inputTransformation', (evt, data) => {\n      const docFragmentChildren = Array.from(data.content.getChildren());\n      let modelRange;\n      // Make sure only <figure class=\"image\"></figure> elements are dropped or pasted. Otherwise, if there some other HTML\n      // mixed up, this should be handled as a regular paste.\n      if (!docFragmentChildren.every(imageUtils.isBlockImageView)) {\n        return;\n      }\n      // When drag and dropping, data.targetRanges specifies where to drop because\n      // this is usually a different place than the current model selection (the user\n      // uses a drop marker to specify the drop location).\n      if (data.targetRanges) {\n        modelRange = editor.editing.mapper.toModelRange(data.targetRanges[0]);\n      } else {\n        modelRange = model.document.selection.getFirstRange();\n      }\n      const selection = model.createSelection(modelRange);\n      // Convert block images into inline images only when pasting or dropping into non-empty blocks\n      // and when the block is not an object (e.g. pasting to replace another widget).\n      if (determineImageTypeForInsertionAtSelection(model.schema, selection) === 'imageInline') {\n        const writer = new UpcastWriter(editingView.document);\n        // Unwrap <figure class=\"image\"><img .../></figure> -> <img ... />\n        // but <figure class=\"image\"><img .../><figcaption>...</figcaption></figure> -> stays the same\n        const inlineViewImages = docFragmentChildren.map(blockViewImage => {\n          // If there's just one child, it can be either <img /> or <a><img></a>.\n          // If there are other children than <img>, this means that the block image\n          // has a caption or some other features and this kind of image should be\n          // pasted/dropped without modifications.\n          if (blockViewImage.childCount === 1) {\n            // Pass the attributes which are present only in the <figure> to the <img>\n            // (e.g. the style=\"width:10%\" attribute applied by the ImageResize plugin).\n            Array.from(blockViewImage.getAttributes()).forEach(attribute => writer.setAttribute(...attribute, imageUtils.findViewImgElement(blockViewImage)));\n            return blockViewImage.getChild(0);\n          } else {\n            return blockViewImage;\n          }\n        });\n        data.content = writer.createDocumentFragment(inlineViewImages);\n      }\n    });\n    this.listenTo(clipboardPipeline, 'contentInsertion', (evt, data) => {\n      if (data.method !== 'paste') {\n        return;\n      }\n      model.change(writer => {\n        const range = writer.createRangeIn(data.content);\n        for (const item of range.getItems()) {\n          if (item.is('element', 'imageInline')) {\n            imageUtils.setImageNaturalSizeAttributes(item);\n          }\n        }\n      });\n    });\n  }\n}\n\n/**\n * The image inline plugin.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:image/image/imageinlineediting~ImageInlineEditing},\n * * {@link module:image/imagetextalternative~ImageTextAlternative}.\n *\n * Usually, it is used in conjunction with other plugins from this package. See the {@glink api/image package page}\n * for more information.\n */\nclass ImageInline extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageInlineEditing, Widget, ImageTextAlternative, ImageInsertUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageInline';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The image plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-overview image feature} documentation.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:image/imageblock~ImageBlock},\n * * {@link module:image/imageinline~ImageInline},\n *\n * Usually, it is used in conjunction with other plugins from this package. See the {@glink api/image package page}\n * for more information.\n */\nclass Image extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageBlock, ImageInline];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Image';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The image caption utilities plugin.\n */\nclass ImageCaptionUtils extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageCaptionUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUtils];\n  }\n  /**\n  * Returns the caption model element from a given image element. Returns `null` if no caption is found.\n  */\n  getCaptionFromImageModelElement(imageModelElement) {\n    for (const node of imageModelElement.getChildren()) {\n      if (!!node && node.is('element', 'caption')) {\n        return node;\n      }\n    }\n    return null;\n  }\n  /**\n  * Returns the caption model element for a model selection. Returns `null` if the selection has no caption element ancestor.\n  */\n  getCaptionFromModelSelection(selection) {\n    const imageUtils = this.editor.plugins.get('ImageUtils');\n    const captionElement = selection.getFirstPosition().findAncestor('caption');\n    if (!captionElement) {\n      return null;\n    }\n    if (imageUtils.isBlockImage(captionElement.parent)) {\n      return captionElement;\n    }\n    return null;\n  }\n  /**\n  * {@link module:engine/view/matcher~Matcher} pattern. Checks if a given element is a `<figcaption>` element that is placed\n  * inside the image `<figure>` element.\n  * @returns Returns the object accepted by {@link module:engine/view/matcher~Matcher} or `null` if the element\n  * cannot be matched.\n  */\n  matchImageCaptionViewElement(element) {\n    const imageUtils = this.editor.plugins.get('ImageUtils');\n    // Convert only captions for images.\n    if (element.name == 'figcaption' && imageUtils.isBlockImageView(element.parent)) {\n      return {\n        name: true\n      };\n    }\n    return null;\n  }\n}\n\n/**\n * The toggle image caption command.\n *\n * This command is registered by {@link module:image/imagecaption/imagecaptionediting~ImageCaptionEditing} as the\n * `'toggleImageCaption'` editor command.\n *\n * Executing this command:\n *\n * * either adds or removes the image caption of a selected image (depending on whether the caption is present or not),\n * * removes the image caption if the selection is anchored in one.\n *\n * ```ts\n * // Toggle the presence of the caption.\n * editor.execute( 'toggleImageCaption' );\n * ```\n *\n * **Note**: Upon executing this command, the selection will be set on the image if previously anchored in the caption element.\n *\n * **Note**: You can move the selection to the caption right away as it shows up upon executing this command by using\n * the `focusCaptionOnShow` option:\n *\n * ```ts\n * editor.execute( 'toggleImageCaption', { focusCaptionOnShow: true } );\n * ```\n */\nclass ToggleImageCaptionCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n    const imageUtils = editor.plugins.get('ImageUtils');\n    // Only block images can get captions.\n    if (!editor.plugins.has(ImageBlockEditing)) {\n      this.isEnabled = false;\n      this.value = false;\n      return;\n    }\n    const selection = editor.model.document.selection;\n    const selectedElement = selection.getSelectedElement();\n    if (!selectedElement) {\n      const ancestorCaptionElement = imageCaptionUtils.getCaptionFromModelSelection(selection);\n      this.isEnabled = !!ancestorCaptionElement;\n      this.value = !!ancestorCaptionElement;\n      return;\n    }\n    // Block images support captions by default but the command should also be enabled for inline\n    // images because toggling the caption when one is selected should convert it into a block image.\n    this.isEnabled = imageUtils.isImage(selectedElement);\n    if (!this.isEnabled) {\n      this.value = false;\n    } else {\n      this.value = !!imageCaptionUtils.getCaptionFromImageModelElement(selectedElement);\n    }\n  }\n  /**\n  * Executes the command.\n  *\n  * ```ts\n  * editor.execute( 'toggleImageCaption' );\n  * ```\n  *\n  * @param options Options for the executed command.\n  * @param options.focusCaptionOnShow When true and the caption shows up, the selection will be moved into it straight away.\n  * @fires execute\n  */\n  execute(options = {}) {\n    const {\n      focusCaptionOnShow\n    } = options;\n    this.editor.model.change(writer => {\n      if (this.value) {\n        this._hideImageCaption(writer);\n      } else {\n        this._showImageCaption(writer, focusCaptionOnShow);\n      }\n    });\n  }\n  /**\n  * Shows the caption of the `<imageBlock>` or `<imageInline>`. Also:\n  *\n  * * it converts `<imageInline>` to `<imageBlock>` to show the caption,\n  * * it attempts to restore the caption content from the `ImageCaptionEditing` caption registry,\n  * * it moves the selection to the caption right away, it the `focusCaptionOnShow` option was set.\n  */\n  _showImageCaption(writer, focusCaptionOnShow) {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const imageCaptionEditing = this.editor.plugins.get('ImageCaptionEditing');\n    const imageUtils = this.editor.plugins.get('ImageUtils');\n    let selectedImage = selection.getSelectedElement();\n    const savedCaption = imageCaptionEditing._getSavedCaption(selectedImage);\n    // Convert imageInline -> image first.\n    if (imageUtils.isInlineImage(selectedImage)) {\n      this.editor.execute('imageTypeBlock');\n      // Executing the command created a new model element. Let's pick it again.\n      selectedImage = selection.getSelectedElement();\n    }\n    // Try restoring the caption from the ImageCaptionEditing plugin storage.\n    const newCaptionElement = savedCaption || writer.createElement('caption');\n    writer.append(newCaptionElement, selectedImage);\n    if (focusCaptionOnShow) {\n      writer.setSelection(newCaptionElement, 'in');\n    }\n  }\n  /**\n  * Hides the caption of a selected image (or an image caption the selection is anchored to).\n  *\n  * The content of the caption is stored in the `ImageCaptionEditing` caption registry to make this\n  * a reversible action.\n  */\n  _hideImageCaption(writer) {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    const imageCaptionEditing = editor.plugins.get('ImageCaptionEditing');\n    const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n    let selectedImage = selection.getSelectedElement();\n    let captionElement;\n    if (selectedImage) {\n      captionElement = imageCaptionUtils.getCaptionFromImageModelElement(selectedImage);\n    } else {\n      captionElement = imageCaptionUtils.getCaptionFromModelSelection(selection);\n      selectedImage = captionElement.parent;\n    }\n    // Store the caption content so it can be restored quickly if the user changes their mind even if they toggle image<->imageInline.\n    imageCaptionEditing._saveCaption(selectedImage, captionElement);\n    writer.setSelection(selectedImage, 'on');\n    writer.remove(captionElement);\n  }\n}\n\n/**\n * The image caption engine plugin. It is responsible for:\n *\n * * registering converters for the caption element,\n * * registering converters for the caption model attribute,\n * * registering the {@link module:image/imagecaption/toggleimagecaptioncommand~ToggleImageCaptionCommand `toggleImageCaption`} command.\n */\nclass ImageCaptionEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUtils, ImageCaptionUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageCaptionEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * A map that keeps saved JSONified image captions and image model elements they are\n  * associated with.\n  *\n  * To learn more about this system, see {@link #_saveCaption}.\n  */\n  _savedCaptionsMap;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._savedCaptionsMap = new WeakMap();\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    // Schema configuration.\n    if (!schema.isRegistered('caption')) {\n      schema.register('caption', {\n        allowIn: 'imageBlock',\n        allowContentOf: '$block',\n        isLimit: true\n      });\n    } else {\n      schema.extend('caption', {\n        allowIn: 'imageBlock'\n      });\n    }\n    editor.commands.add('toggleImageCaption', new ToggleImageCaptionCommand(this.editor));\n    this._setupConversion();\n    this._setupImageTypeCommandsIntegration();\n    this._registerCaptionReconversion();\n  }\n  /**\n  * Configures conversion pipelines to support upcasting and downcasting\n  * image captions.\n  */\n  _setupConversion() {\n    const editor = this.editor;\n    const view = editor.editing.view;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n    const t = editor.t;\n    // View -> model converter for the data pipeline.\n    editor.conversion.for('upcast').elementToElement({\n      view: element => imageCaptionUtils.matchImageCaptionViewElement(element),\n      model: 'caption'\n    });\n    // Model -> view converter for the data pipeline.\n    editor.conversion.for('dataDowncast').elementToElement({\n      model: 'caption',\n      view: (modelElement, {\n        writer\n      }) => {\n        if (!imageUtils.isBlockImage(modelElement.parent)) {\n          return null;\n        }\n        return writer.createContainerElement('figcaption');\n      }\n    });\n    // Model -> view converter for the editing pipeline.\n    editor.conversion.for('editingDowncast').elementToElement({\n      model: 'caption',\n      view: (modelElement, {\n        writer\n      }) => {\n        if (!imageUtils.isBlockImage(modelElement.parent)) {\n          return null;\n        }\n        const figcaptionElement = writer.createEditableElement('figcaption');\n        writer.setCustomProperty('imageCaption', true, figcaptionElement);\n        figcaptionElement.placeholder = t('Enter image caption');\n        enablePlaceholder({\n          view,\n          element: figcaptionElement,\n          keepOnFocus: true\n        });\n        const imageAlt = modelElement.parent.getAttribute('alt');\n        const label = imageAlt ? t('Caption for image: %0', [imageAlt]) : t('Caption for the image');\n        return toWidgetEditable(figcaptionElement, writer, {\n          label\n        });\n      }\n    });\n  }\n  /**\n  * Integrates with {@link module:image/image/imagetypecommand~ImageTypeCommand image type commands}\n  * to make sure the caption is preserved when the type of an image changes so it can be restored\n  * in the future if the user decides they want their caption back.\n  */\n  _setupImageTypeCommandsIntegration() {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n    const imageTypeInlineCommand = editor.commands.get('imageTypeInline');\n    const imageTypeBlockCommand = editor.commands.get('imageTypeBlock');\n    const handleImageTypeChange = evt => {\n      // The image type command execution can be unsuccessful.\n      if (!evt.return) {\n        return;\n      }\n      const {\n        oldElement,\n        newElement\n      } = evt.return;\n      /* istanbul ignore if: paranoid check -- @preserve */\n      if (!oldElement) {\n        return;\n      }\n      if (imageUtils.isBlockImage(oldElement)) {\n        const oldCaptionElement = imageCaptionUtils.getCaptionFromImageModelElement(oldElement);\n        // If the old element was a captioned block image (the caption was visible),\n        // simply save it so it can be restored.\n        if (oldCaptionElement) {\n          this._saveCaption(newElement, oldCaptionElement);\n          return;\n        }\n      }\n      const savedOldElementCaption = this._getSavedCaption(oldElement);\n      // If either:\n      //\n      // * the block image didn't have a visible caption,\n      // * the block image caption was hidden (and already saved),\n      // * the inline image was passed\n      //\n      // just try to \"pass\" the saved caption from the old image to the new image\n      // so it can be retrieved in the future if the user wants it back.\n      if (savedOldElementCaption) {\n        // Note: Since we're writing to a WeakMap, we don't bother with removing the\n        // [ oldElement, savedOldElementCaption ] pair from it.\n        this._saveCaption(newElement, savedOldElementCaption);\n      }\n    };\n    // Presence of the commands depends on the Image(Inline|Block)Editing plugins loaded in the editor.\n    if (imageTypeInlineCommand) {\n      this.listenTo(imageTypeInlineCommand, 'execute', handleImageTypeChange, {\n        priority: 'low'\n      });\n    }\n    if (imageTypeBlockCommand) {\n      this.listenTo(imageTypeBlockCommand, 'execute', handleImageTypeChange, {\n        priority: 'low'\n      });\n    }\n  }\n  /**\n  * Returns the saved {@link module:engine/model/element~Element#toJSON JSONified} caption\n  * of an image model element.\n  *\n  * See {@link #_saveCaption}.\n  *\n  * @internal\n  * @param imageModelElement The model element the caption should be returned for.\n  * @returns The model caption element or `null` if there is none.\n  */\n  _getSavedCaption(imageModelElement) {\n    const jsonObject = this._savedCaptionsMap.get(imageModelElement);\n    return jsonObject ? Element.fromJSON(jsonObject) : null;\n  }\n  /**\n  * Saves a {@link module:engine/model/element~Element#toJSON JSONified} caption for\n  * an image element to allow restoring it in the future.\n  *\n  * A caption is saved every time it gets hidden and/or the type of an image changes. The\n  * user should be able to restore it on demand.\n  *\n  * **Note**: The caption cannot be stored in the image model element attribute because,\n  * for instance, when the model state propagates to collaborators, the attribute would get\n  * lost (mainly because it does not convert to anything when the caption is hidden) and\n  * the states of collaborators' models would de-synchronize causing numerous issues.\n  *\n  * See {@link #_getSavedCaption}.\n  *\n  * @internal\n  * @param imageModelElement The model element the caption is saved for.\n  * @param caption The caption model element to be saved.\n  */\n  _saveCaption(imageModelElement, caption) {\n    this._savedCaptionsMap.set(imageModelElement, caption.toJSON());\n  }\n  /**\n  * Reconverts image caption when image alt attribute changes.\n  * The change of alt attribute is reflected in caption's aria-label attribute.\n  */\n  _registerCaptionReconversion() {\n    const editor = this.editor;\n    const model = editor.model;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n    model.document.on('change:data', () => {\n      const changes = model.document.differ.getChanges();\n      for (const change of changes) {\n        if (change.attributeKey !== 'alt') {\n          continue;\n        }\n        const image = change.range.start.nodeAfter;\n        if (imageUtils.isBlockImage(image)) {\n          const caption = imageCaptionUtils.getCaptionFromImageModelElement(image);\n          if (!caption) {\n            return;\n          }\n          editor.editing.reconvertItem(caption);\n        }\n      }\n    });\n  }\n}\n\n/**\n * The image caption UI plugin. It introduces the `'toggleImageCaption'` UI button.\n */\nclass ImageCaptionUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageCaptionUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageCaptionUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n    const t = editor.t;\n    editor.ui.componentFactory.add('toggleImageCaption', locale => {\n      const command = editor.commands.get('toggleImageCaption');\n      const view = new ButtonView(locale);\n      view.set({\n        icon: IconCaption,\n        tooltip: true,\n        isToggleable: true\n      });\n      view.bind('isOn', 'isEnabled').to(command, 'value', 'isEnabled');\n      view.bind('label').to(command, 'value', value => value ? t('Toggle caption off') : t('Toggle caption on'));\n      this.listenTo(view, 'execute', () => {\n        editor.execute('toggleImageCaption', {\n          focusCaptionOnShow: true\n        });\n        // Scroll to the selection and highlight the caption if the caption showed up.\n        const modelCaptionElement = imageCaptionUtils.getCaptionFromModelSelection(editor.model.document.selection);\n        if (modelCaptionElement) {\n          const figcaptionElement = editor.editing.mapper.toViewElement(modelCaptionElement);\n          editingView.scrollToTheSelection();\n          editingView.change(writer => {\n            writer.addClass('image__caption_highlighted', figcaptionElement);\n          });\n        }\n        editor.editing.view.focus();\n      });\n      return view;\n    });\n  }\n}\n\n/**\n * The image caption plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-captions image caption} documentation.\n */\nclass ImageCaption extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageCaptionEditing, ImageCaptionUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageCaption';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * Creates a regular expression used to test for image files.\n *\n * ```ts\n * const imageType = createImageTypeRegExp( [ 'png', 'jpeg', 'svg+xml', 'vnd.microsoft.icon' ] );\n *\n * console.log( 'is supported image', imageType.test( file.type ) );\n * ```\n */\nfunction createImageTypeRegExp(types) {\n  // Sanitize the MIME type name which may include: \"+\", \"-\" or \".\".\n  const regExpSafeNames = types.map(type => type.replace('+', '\\\\+'));\n  return new RegExp(`^image\\\\/(${regExpSafeNames.join('|')})$`);\n}\n/**\n * Creates a promise that fetches the image local source (Base64 or blob) and resolves with a `File` object.\n *\n * @param image Image whose source to fetch.\n * @returns A promise which resolves when an image source is fetched and converted to a `File` instance.\n * It resolves with a `File` object. If there were any errors during file processing, the promise will be rejected.\n */\nfunction fetchLocalImage(image) {\n  return new Promise((resolve, reject) => {\n    const imageSrc = image.getAttribute('src');\n    // Fetch works asynchronously and so does not block browser UI when processing data.\n    fetch(imageSrc).then(resource => resource.blob()).then(blob => {\n      const mimeType = getImageMimeType(blob, imageSrc);\n      const ext = mimeType.replace('image/', '');\n      const filename = `image.${ext}`;\n      const file = new File([blob], filename, {\n        type: mimeType\n      });\n      resolve(file);\n    }).catch(err => {\n      // Fetch fails only, if it can't make a request due to a network failure or if anything prevented the request\n      // from completing, i.e. the Content Security Policy rules. It is not possible to detect the exact cause of failure,\n      // so we are just trying the fallback solution, if general TypeError is thrown.\n      return err && err.name === 'TypeError' ? convertLocalImageOnCanvas(imageSrc).then(resolve).catch(reject) : reject(err);\n    });\n  });\n}\n/**\n * Checks whether a given node is an image element with a local source (Base64 or blob).\n *\n * @param node The node to check.\n */\nfunction isLocalImage(imageUtils, node) {\n  if (!imageUtils.isInlineImageView(node) || !node.getAttribute('src')) {\n    return false;\n  }\n  return !!node.getAttribute('src').match(/^data:image\\/\\w+;base64,/g) || !!node.getAttribute('src').match(/^blob:/g);\n}\n/**\n * Extracts an image type based on its blob representation or its source.\n * @param blob Image blob representation.\n * @param src Image `src` attribute value.\n */\nfunction getImageMimeType(blob, src) {\n  if (blob.type) {\n    return blob.type;\n  } else if (src.match(/data:(image\\/\\w+);base64/)) {\n    return src.match(/data:(image\\/\\w+);base64/)[1].toLowerCase();\n  } else {\n    // Fallback to 'jpeg' as common extension.\n    return 'image/jpeg';\n  }\n}\n/**\n * Creates a promise that converts the image local source (Base64 or blob) to a blob using canvas and resolves\n * with a `File` object.\n * @param imageSrc Image `src` attribute value.\n * @returns A promise which resolves when an image source is converted to a `File` instance.\n * It resolves with a `File` object. If there were any errors during file processing, the promise will be rejected.\n */\nfunction convertLocalImageOnCanvas(imageSrc) {\n  return getBlobFromCanvas(imageSrc).then(blob => {\n    const mimeType = getImageMimeType(blob, imageSrc);\n    const ext = mimeType.replace('image/', '');\n    const filename = `image.${ext}`;\n    return new File([blob], filename, {\n      type: mimeType\n    });\n  });\n}\n/**\n * Creates a promise that resolves with a `Blob` object converted from the image source (Base64 or blob).\n * @param imageSrc Image `src` attribute value.\n */\nfunction getBlobFromCanvas(imageSrc) {\n  return new Promise((resolve, reject) => {\n    const image = global.document.createElement('img');\n    image.addEventListener('load', () => {\n      const canvas = global.document.createElement('canvas');\n      canvas.width = image.width;\n      canvas.height = image.height;\n      const ctx = canvas.getContext('2d');\n      ctx.drawImage(image, 0, 0);\n      canvas.toBlob(blob => blob ? resolve(blob) : reject());\n    });\n    image.addEventListener('error', () => reject());\n    image.src = imageSrc;\n  });\n}\n\n/**\n * The image upload button plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload Image upload feature} documentation.\n *\n * Adds the `'uploadImage'` button to the {@link module:ui/componentfactory~ComponentFactory UI component factory}\n * and also the `imageUpload` button as an alias for backward compatibility.\n *\n * Adds the `'menuBar:uploadImage'` menu button to the {@link module:ui/componentfactory~ComponentFactory UI component factory}.\n *\n * It also integrates with the `insertImage` toolbar component and `menuBar:insertImage` menu component, which are the default components\n * through which image upload is available.\n */\nclass ImageUploadUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageUploadUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Setup `uploadImage` button and add `imageUpload` button as an alias for backward compatibility.\n    editor.ui.componentFactory.add('uploadImage', () => this._createToolbarButton());\n    editor.ui.componentFactory.add('imageUpload', () => this._createToolbarButton());\n    editor.ui.componentFactory.add('menuBar:uploadImage', () => this._createMenuBarButton('standalone'));\n    if (editor.plugins.has('ImageInsertUI')) {\n      editor.plugins.get('ImageInsertUI').registerIntegration({\n        name: 'upload',\n        observable: () => editor.commands.get('uploadImage'),\n        buttonViewCreator: () => this._createToolbarButton(),\n        formViewCreator: () => this._createDropdownButton(),\n        menuBarButtonViewCreator: isOnly => this._createMenuBarButton(isOnly ? 'insertOnly' : 'insertNested')\n      });\n    }\n  }\n  /**\n  * Creates the base for various kinds of the button component provided by this feature.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const command = editor.commands.get('uploadImage');\n    const imageTypes = editor.config.get('image.upload.types');\n    const imageTypesRegExp = createImageTypeRegExp(imageTypes);\n    const view = new ButtonClass(editor.locale);\n    const t = locale.t;\n    view.set({\n      acceptedType: imageTypes.map(type => `image/${type}`).join(','),\n      allowMultipleFiles: true,\n      label: t('Upload from computer'),\n      icon: IconImageUpload\n    });\n    view.bind('isEnabled').to(command);\n    view.on('done', (evt, files) => {\n      const imagesToUpload = Array.from(files).filter(file => imageTypesRegExp.test(file.type));\n      if (imagesToUpload.length) {\n        editor.execute('uploadImage', {\n          file: imagesToUpload\n        });\n        editor.editing.view.focus();\n      }\n    });\n    return view;\n  }\n  /**\n  * Creates a simple toolbar button, with an icon and a tooltip.\n  */\n  _createToolbarButton() {\n    const t = this.editor.locale.t;\n    const imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n    const uploadImageCommand = this.editor.commands.get('uploadImage');\n    const button = this._createButton(FileDialogButtonView);\n    button.tooltip = true;\n    button.bind('label').to(imageInsertUI, 'isImageSelected', uploadImageCommand, 'isAccessAllowed', (isImageSelected, isAccessAllowed) => {\n      if (!isAccessAllowed) {\n        return t('You have no image upload permissions.');\n      }\n      return isImageSelected ? t('Replace image from computer') : t('Upload image from computer');\n    });\n    return button;\n  }\n  /**\n  * Creates a button for the dropdown view, with an icon, text and no tooltip.\n  */\n  _createDropdownButton() {\n    const t = this.editor.locale.t;\n    const imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n    const button = this._createButton(FileDialogButtonView);\n    button.withText = true;\n    button.bind('label').to(imageInsertUI, 'isImageSelected', isImageSelected => isImageSelected ? t('Replace from computer') : t('Upload from computer'));\n    button.on('execute', () => {\n      imageInsertUI.dropdownView.isOpen = false;\n    });\n    return button;\n  }\n  /**\n  * Creates a button for the menu bar.\n  */\n  _createMenuBarButton(type) {\n    const t = this.editor.locale.t;\n    const button = this._createButton(MenuBarMenuListItemFileDialogButtonView);\n    button.withText = true;\n    switch (type) {\n      case 'standalone':\n        button.label = t('Image from computer');\n        break;\n      case 'insertOnly':\n        button.label = t('Image');\n        break;\n      case 'insertNested':\n        button.label = t('From computer');\n        break;\n    }\n    return button;\n  }\n}\n\n/**\n * The image upload progress plugin.\n * It shows a placeholder when the image is read from the disk and a progress bar while the image is uploading.\n */\nclass ImageUploadProgress extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageUploadProgress';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * The image placeholder that is displayed before real image data can be accessed.\n  *\n  * For the record, this image is a 1x1 px GIF with an aspect ratio set by CSS.\n  */\n  placeholder;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this.placeholder = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Upload status change - update image's view according to that status.\n    if (editor.plugins.has('ImageBlockEditing')) {\n      editor.editing.downcastDispatcher.on('attribute:uploadStatus:imageBlock', this.uploadStatusChange);\n    }\n    if (editor.plugins.has('ImageInlineEditing')) {\n      editor.editing.downcastDispatcher.on('attribute:uploadStatus:imageInline', this.uploadStatusChange);\n    }\n  }\n  /**\n  * This method is called each time the image `uploadStatus` attribute is changed.\n  *\n  * @param evt An object containing information about the fired event.\n  * @param data Additional information about the change.\n  */\n  uploadStatusChange = (evt, data, conversionApi) => {\n    const editor = this.editor;\n    const modelImage = data.item;\n    const uploadId = modelImage.getAttribute('uploadId');\n    if (!conversionApi.consumable.consume(data.item, evt.name)) {\n      return;\n    }\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const fileRepository = editor.plugins.get(FileRepository);\n    const status = uploadId ? data.attributeNewValue : null;\n    const placeholder = this.placeholder;\n    const viewFigure = editor.editing.mapper.toViewElement(modelImage);\n    const viewWriter = conversionApi.writer;\n    if (status == 'reading') {\n      // Start \"appearing\" effect and show placeholder with infinite progress bar on the top\n      // while image is read from disk.\n      _startAppearEffect(viewFigure, viewWriter);\n      _showPlaceholder(imageUtils, placeholder, viewFigure, viewWriter);\n      return;\n    }\n    // Show progress bar on the top of the image when image is uploading.\n    if (status == 'uploading') {\n      const loader = fileRepository.loaders.get(uploadId);\n      // Start appear effect if needed - see https://github.com/ckeditor/ckeditor5-image/issues/191.\n      _startAppearEffect(viewFigure, viewWriter);\n      if (!loader) {\n        // There is no loader associated with uploadId - this means that image came from external changes.\n        // In such cases we still want to show the placeholder until image is fully uploaded.\n        // Show placeholder if needed - see https://github.com/ckeditor/ckeditor5-image/issues/191.\n        _showPlaceholder(imageUtils, placeholder, viewFigure, viewWriter);\n      } else {\n        // Hide placeholder and initialize progress bar showing upload progress.\n        _hidePlaceholder(viewFigure, viewWriter);\n        _showProgressBar(viewFigure, viewWriter, loader, editor.editing.view);\n        _displayLocalImage(imageUtils, viewFigure, viewWriter, loader);\n      }\n      return;\n    }\n    if (status == 'complete' && fileRepository.loaders.get(uploadId)) {\n      _showCompleteIcon(viewFigure, viewWriter, editor.editing.view);\n    }\n    // Clean up.\n    _hideProgressBar(viewFigure, viewWriter);\n    _hidePlaceholder(viewFigure, viewWriter);\n    _stopAppearEffect(viewFigure, viewWriter);\n  };\n}\n/**\n * Adds ck-appear class to the image figure if one is not already applied.\n */\nfunction _startAppearEffect(viewFigure, writer) {\n  if (!viewFigure.hasClass('ck-appear')) {\n    writer.addClass('ck-appear', viewFigure);\n  }\n}\n/**\n * Removes ck-appear class to the image figure if one is not already removed.\n */\nfunction _stopAppearEffect(viewFigure, writer) {\n  writer.removeClass('ck-appear', viewFigure);\n}\n/**\n * Shows placeholder together with infinite progress bar on given image figure.\n */\nfunction _showPlaceholder(imageUtils, placeholder, viewFigure, writer) {\n  if (!viewFigure.hasClass('ck-image-upload-placeholder')) {\n    writer.addClass('ck-image-upload-placeholder', viewFigure);\n  }\n  const viewImg = imageUtils.findViewImgElement(viewFigure);\n  if (viewImg.getAttribute('src') !== placeholder) {\n    writer.setAttribute('src', placeholder, viewImg);\n  }\n  if (!_getUIElement(viewFigure, 'placeholder')) {\n    writer.insert(writer.createPositionAfter(viewImg), _createPlaceholder(writer));\n  }\n}\n/**\n * Removes placeholder together with infinite progress bar on given image figure.\n */\nfunction _hidePlaceholder(viewFigure, writer) {\n  if (viewFigure.hasClass('ck-image-upload-placeholder')) {\n    writer.removeClass('ck-image-upload-placeholder', viewFigure);\n  }\n  _removeUIElement(viewFigure, writer, 'placeholder');\n}\n/**\n * Shows progress bar displaying upload progress.\n * Attaches it to the file loader to update when upload percentace is changed.\n */\nfunction _showProgressBar(viewFigure, writer, loader, view) {\n  const progressBar = _createProgressBar(writer);\n  writer.insert(writer.createPositionAt(viewFigure, 'end'), progressBar);\n  // Update progress bar width when uploadedPercent is changed.\n  loader.on('change:uploadedPercent', (evt, name, value) => {\n    view.change(writer => {\n      writer.setStyle('width', value + '%', progressBar);\n    });\n  });\n}\n/**\n * Hides upload progress bar.\n */\nfunction _hideProgressBar(viewFigure, writer) {\n  _removeUIElement(viewFigure, writer, 'progressBar');\n}\n/**\n * Shows complete icon and hides after a certain amount of time.\n */\nfunction _showCompleteIcon(viewFigure, writer, view) {\n  const completeIcon = writer.createUIElement('div', {\n    class: 'ck-image-upload-complete-icon'\n  });\n  writer.insert(writer.createPositionAt(viewFigure, 'end'), completeIcon);\n  setTimeout(() => {\n    view.change(writer => writer.remove(writer.createRangeOn(completeIcon)));\n  }, 3000);\n}\n/**\n * Create progress bar element using {@link module:engine/view/uielement~UIElement}.\n */\nfunction _createProgressBar(writer) {\n  const progressBar = writer.createUIElement('div', {\n    class: 'ck-progress-bar'\n  });\n  writer.setCustomProperty('progressBar', true, progressBar);\n  return progressBar;\n}\n/**\n * Create placeholder element using {@link module:engine/view/uielement~UIElement}.\n */\nfunction _createPlaceholder(writer) {\n  const placeholder = writer.createUIElement('div', {\n    class: 'ck-upload-placeholder-loader'\n  });\n  writer.setCustomProperty('placeholder', true, placeholder);\n  return placeholder;\n}\n/**\n * Returns {@link module:engine/view/uielement~UIElement} of given unique property from image figure element.\n * Returns `undefined` if element is not found.\n */\nfunction _getUIElement(imageFigure, uniqueProperty) {\n  for (const child of imageFigure.getChildren()) {\n    if (child.getCustomProperty(uniqueProperty)) {\n      return child;\n    }\n  }\n}\n/**\n * Removes {@link module:engine/view/uielement~UIElement} of given unique property from image figure element.\n */\nfunction _removeUIElement(viewFigure, writer, uniqueProperty) {\n  const element = _getUIElement(viewFigure, uniqueProperty);\n  if (element) {\n    writer.remove(writer.createRangeOn(element));\n  }\n}\n/**\n * Displays local data from file loader.\n */\nfunction _displayLocalImage(imageUtils, viewFigure, writer, loader) {\n  if (loader.data) {\n    const viewImg = imageUtils.findViewImgElement(viewFigure);\n    writer.setAttribute('src', loader.data, viewImg);\n  }\n}\n\n/**\n * @module image/imageupload/uploadimagecommand\n */ /**\n    * The upload image command.\n    *\n    * The command is registered by the {@link module:image/imageupload/imageuploadediting~ImageUploadEditing} plugin as `uploadImage`\n    * and it is also available via aliased `imageUpload` name.\n    *\n    * In order to upload an image at the current selection position\n    * (according to the {@link module:widget/utils~findOptimalInsertionRange} algorithm),\n    * execute the command and pass the native image file instance:\n    *\n    * ```ts\n    * this.listenTo( editor.editing.view.document, 'clipboardInput', ( evt, data ) => {\n    * \t// Assuming that only images were pasted:\n    * \tconst images = Array.from( data.dataTransfer.files );\n    *\n    * \t// Upload the first image:\n    * \teditor.execute( 'uploadImage', { file: images[ 0 ] } );\n    * } );\n    * ```\n    *\n    * It is also possible to insert multiple images at once:\n    *\n    * ```ts\n    * editor.execute( 'uploadImage', {\n    * \tfile: [\n    * \t\tfile1,\n    * \t\tfile2\n    * \t]\n    * } );\n    * ```\n    */\nclass UploadImageCommand extends Command {\n  /**\n  * Creates an instance of the `imageUlpoad` command. When executed, the command upload one of\n  * the currently selected image from computer.\n  *\n  * @param editor The editor instance.\n  */\n  constructor(editor) {\n    super(editor);\n    this.set('isAccessAllowed', true);\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const selectedElement = editor.model.document.selection.getSelectedElement();\n    // TODO: This needs refactoring.\n    this.isEnabled = imageUtils.isImageAllowed() || imageUtils.isImage(selectedElement);\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options Options for the executed command.\n  * @param options.file The image file or an array of image files to upload.\n  */\n  execute(options) {\n    const files = toArray(options.file);\n    const selection = this.editor.model.document.selection;\n    const imageUtils = this.editor.plugins.get('ImageUtils');\n    // In case of multiple files, each file (starting from the 2nd) will be inserted at a position that\n    // follows the previous one. That will move the selection and, to stay on the safe side and make sure\n    // all images inherit the same selection attributes, they are collected beforehand.\n    //\n    // Applying these attributes ensures, for instance, that inserting an (inline) image into a link does\n    // not split that link but preserves its continuity.\n    //\n    // Note: Selection attributes that do not make sense for images will be filtered out by insertImage() anyway.\n    const selectionAttributes = Object.fromEntries(selection.getAttributes());\n    files.forEach((file, index) => {\n      const selectedElement = selection.getSelectedElement();\n      // Inserting of an inline image replace the selected element and make a selection on the inserted image.\n      // Therefore inserting multiple inline images requires creating position after each element.\n      if (index && selectedElement && imageUtils.isImage(selectedElement)) {\n        const position = this.editor.model.createPositionAfter(selectedElement);\n        this._uploadImage(file, selectionAttributes, position);\n      } else {\n        this._uploadImage(file, selectionAttributes);\n      }\n    });\n  }\n  /**\n  * Handles uploading single file.\n  */\n  _uploadImage(file, attributes, position) {\n    const editor = this.editor;\n    const fileRepository = editor.plugins.get(FileRepository);\n    const loader = fileRepository.createLoader(file);\n    const imageUtils = editor.plugins.get('ImageUtils');\n    // Do not throw when upload adapter is not set. FileRepository will log an error anyway.\n    if (!loader) {\n      return;\n    }\n    imageUtils.insertImage({\n      ...attributes,\n      uploadId: loader.id\n    }, position);\n  }\n}\n\n/**\n * The editing part of the image upload feature. It registers the `'uploadImage'` command\n * and the `imageUpload` command as an aliased name.\n *\n * When an image is uploaded, it fires the {@link ~ImageUploadEditing#event:uploadComplete `uploadComplete`} event\n * that allows adding custom attributes to the {@link module:engine/model/element~Element image element}.\n */\nclass ImageUploadEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [FileRepository, Notification, ClipboardPipeline, ImageUtils];\n  }\n  static get pluginName() {\n    return 'ImageUploadEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * An internal mapping of {@link module:upload/filerepository~FileLoader#id file loader UIDs} and\n  * model elements during the upload.\n  *\n  * Model element of the uploaded image can change, for instance, when {@link module:image/image/imagetypecommand~ImageTypeCommand}\n  * is executed as a result of adding caption or changing image style. As a result, the upload logic must keep track of the model\n  * element (reference) and resolve the upload for the correct model element (instead of the one that landed in the `$graveyard`\n  * after image type changed).\n  */\n  _uploadImageElements;\n  /**\n  * An internal mapping of {@link module:upload/filerepository~FileLoader#id file loader UIDs} and\n  * upload responses for handling images dragged during their upload process. When such images are later\n  * dropped, their original upload IDs no longer exist in the registry (as the original upload completed).\n  * This map preserves the upload responses to properly handle such cases.\n  */\n  _uploadedImages = new Map();\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('image', {\n      upload: {\n        types: ['jpeg', 'png', 'gif', 'bmp', 'webp', 'tiff']\n      }\n    });\n    this._uploadImageElements = new Map();\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const doc = editor.model.document;\n    const conversion = editor.conversion;\n    const fileRepository = editor.plugins.get(FileRepository);\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n    const imageTypes = createImageTypeRegExp(editor.config.get('image.upload.types'));\n    const uploadImageCommand = new UploadImageCommand(editor);\n    // Register `uploadImage` command and add `imageUpload` command as an alias for backward compatibility.\n    editor.commands.add('uploadImage', uploadImageCommand);\n    editor.commands.add('imageUpload', uploadImageCommand);\n    // Register upcast converter for uploadId.\n    conversion.for('upcast').attributeToAttribute({\n      view: {\n        name: 'img',\n        key: 'uploadId'\n      },\n      model: 'uploadId'\n    }) // Handle the case when the image is not fully uploaded yet but it's being moved.\n    // See more: https://github.com/ckeditor/ckeditor5/pull/17327\n    .add(dispatcher => dispatcher.on('element:img', (evt, data, conversionApi) => {\n      if (!conversionApi.consumable.test(data.viewItem, {\n        attributes: ['data-ck-upload-id']\n      })) {\n        return;\n      }\n      const uploadId = data.viewItem.getAttribute('data-ck-upload-id');\n      if (!uploadId) {\n        return;\n      }\n      const [modelElement] = Array.from(data.modelRange.getItems({\n        shallow: true\n      }));\n      const loader = fileRepository.loaders.get(uploadId);\n      if (modelElement) {\n        // Handle case when `uploadId` is set on the image element but the loader is not present in the registry.\n        // It may happen when the image was successfully uploaded and the loader was removed from the registry.\n        // It's still present in the `_uploadedImages` map though. It's why we do not place this line in the condition below.\n        conversionApi.writer.setAttribute('uploadId', uploadId, modelElement);\n        conversionApi.consumable.consume(data.viewItem, {\n          attributes: ['data-ck-upload-id']\n        });\n        if (loader && loader.data) {\n          conversionApi.writer.setAttribute('uploadStatus', loader.status, modelElement);\n        }\n      }\n    }, {\n      priority: 'low'\n    }));\n    // Handle pasted images.\n    // For every image file, a new file loader is created and a placeholder image is\n    // inserted into the content. Then, those images are uploaded once they appear in the model\n    // (see Document#change listener below).\n    this.listenTo(editor.editing.view.document, 'clipboardInput', (evt, data) => {\n      // Skip if non empty HTML data is included.\n      // https://github.com/ckeditor/ckeditor5-upload/issues/68\n      if (isHtmlIncluded(data.dataTransfer)) {\n        return;\n      }\n      const images = Array.from(data.dataTransfer.files).filter(file => {\n        // See https://github.com/ckeditor/ckeditor5-image/pull/254.\n        if (!file) {\n          return false;\n        }\n        return imageTypes.test(file.type);\n      });\n      if (!images.length) {\n        return;\n      }\n      evt.stop();\n      editor.model.change(writer => {\n        // Set selection to paste target.\n        if (data.targetRanges) {\n          writer.setSelection(data.targetRanges.map(viewRange => editor.editing.mapper.toModelRange(viewRange)));\n        }\n        editor.execute('uploadImage', {\n          file: images\n        });\n      });\n      const uploadImageCommand = editor.commands.get('uploadImage');\n      if (!uploadImageCommand.isAccessAllowed) {\n        const notification = editor.plugins.get('Notification');\n        const t = editor.locale.t;\n        // eslint-disable-next-line max-len\n        notification.showWarning(t('You have no image upload permissions.'), {\n          namespace: 'image'\n        });\n      }\n    });\n    // Handle HTML pasted with images with base64 or blob sources.\n    // For every image file, a new file loader is created and a placeholder image is\n    // inserted into the content. Then, those images are uploaded once they appear in the model\n    // (see Document#change listener below).\n    this.listenTo(clipboardPipeline, 'inputTransformation', (evt, data) => {\n      const fetchableImages = Array.from(editor.editing.view.createRangeIn(data.content)).map(value => value.item).filter(viewElement => isLocalImage(imageUtils, viewElement) && !viewElement.getAttribute('uploadProcessed')).map(viewElement => {\n        return {\n          promise: fetchLocalImage(viewElement),\n          imageElement: viewElement\n        };\n      });\n      if (!fetchableImages.length) {\n        return;\n      }\n      const writer = new UpcastWriter(editor.editing.view.document);\n      for (const fetchableImage of fetchableImages) {\n        // Set attribute marking that the image was processed already.\n        writer.setAttribute('uploadProcessed', true, fetchableImage.imageElement);\n        const loader = fileRepository.createLoader(fetchableImage.promise);\n        if (loader) {\n          writer.setAttribute('src', '', fetchableImage.imageElement);\n          writer.setAttribute('uploadId', loader.id, fetchableImage.imageElement);\n        }\n      }\n    });\n    // Prevents from the browser redirecting to the dropped image.\n    editor.editing.view.document.on('dragover', (evt, data) => {\n      data.preventDefault();\n    });\n    // Upload placeholder images that appeared in the model.\n    doc.on('change', () => {\n      // Note: Reversing changes to start with insertions and only then handle removals. If it was the other way around,\n      // loaders for **all** images that land in the $graveyard would abort while in fact only those that were **not** replaced\n      // by other images should be aborted.\n      const changes = doc.differ.getChanges({\n        includeChangesInGraveyard: true\n      }).reverse();\n      const insertedImagesIds = new Set();\n      for (const entry of changes) {\n        if (entry.type == 'insert' && entry.name != '$text') {\n          const item = entry.position.nodeAfter;\n          const isInsertedInGraveyard = entry.position.root.rootName == '$graveyard';\n          for (const imageElement of getImagesFromChangeItem(editor, item)) {\n            // Check if the image element still has upload id.\n            const uploadId = imageElement.getAttribute('uploadId');\n            if (!uploadId) {\n              continue;\n            }\n            // Check if the image is loaded on this client.\n            const loader = fileRepository.loaders.get(uploadId);\n            if (!loader) {\n              // If the loader does not exist, it means that the image was already uploaded\n              // and the loader promise was removed from the registry. In that scenario we need\n              // to restore response object from the internal map.\n              if (!isInsertedInGraveyard && this._uploadedImages.has(uploadId)) {\n                // Fire `uploadComplete` to set proper attributes on the image element.\n                editor.model.enqueueChange({\n                  isUndoable: false\n                }, writer => {\n                  writer.setAttribute('uploadStatus', 'complete', imageElement);\n                  this.fire('uploadComplete', {\n                    data: this._uploadedImages.get(uploadId),\n                    imageElement: imageElement\n                  });\n                });\n                // While it makes sense to remove the image from the `_uploadedImages` map here,\n                // it's counterintuitive for the user that pastes image in uploading several times.\n                // It'll work the first time, but the next time the image will be empty because the\n                // `_uploadedImages` no longer contain the response.\n              }\n              continue;\n            }\n            if (isInsertedInGraveyard) {\n              // If the image was inserted to the graveyard for good (**not** replaced by another image),\n              // only then abort the loading process.\n              if (!insertedImagesIds.has(uploadId)) {\n                // ... but abort it only if all remain images that share the same loader are in the graveyard too.\n                // This is to prevent situation when we have two images in uploading state and one of them is being\n                // placed in the graveyard (e.g. using undo). The other one should not be aborted.\n                const allImagesThatShareUploaderInGraveyard = Array.from(this._uploadImageElements.get(uploadId)).every(element => element.root.rootName == '$graveyard');\n                if (allImagesThatShareUploaderInGraveyard) {\n                  loader.abort();\n                }\n              }\n            } else {\n              // Remember the upload id of the inserted image. If it acted as a replacement for another\n              // image (which landed in the $graveyard), the related loader will not be aborted because\n              // this is still the same image upload.\n              insertedImagesIds.add(uploadId);\n              // Keep the mapping between the upload ID and the image model element so the upload\n              // can later resolve in the context of the correct model element. The model element could\n              // change for the same upload if one image was replaced by another (e.g. image type was changed),\n              // so this may also replace an existing mapping.\n              if (!this._uploadImageElements.has(uploadId)) {\n                this._uploadImageElements.set(uploadId, new Set([imageElement]));\n              } else {\n                this._uploadImageElements.get(uploadId).add(imageElement);\n              }\n              if (loader.status == 'idle') {\n                // If the image was inserted into content and has not been loaded yet, start loading it.\n                this._readAndUpload(loader);\n              }\n            }\n          }\n        }\n      }\n    });\n    // Set the default handler for feeding the image element with `src` and `srcset` attributes.\n    // Also set the natural `width` and `height` attributes (if not already set).\n    this.on('uploadComplete', (evt, {\n      imageElement,\n      data\n    }) => {\n      const urls = data.urls ? data.urls : data;\n      this.editor.model.change(writer => {\n        writer.setAttribute('src', urls.default, imageElement);\n        this._parseAndSetSrcsetAttributeOnImage(urls, imageElement, writer);\n        imageUtils.setImageNaturalSizeAttributes(imageElement);\n      });\n    }, {\n      priority: 'low'\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const schema = this.editor.model.schema;\n    // Setup schema to allow uploadId and uploadStatus for images.\n    // Wait for ImageBlockEditing or ImageInlineEditing to register their elements first,\n    // that's why doing this in afterInit() instead of init().\n    if (this.editor.plugins.has('ImageBlockEditing')) {\n      schema.extend('imageBlock', {\n        allowAttributes: ['uploadId', 'uploadStatus']\n      });\n      this._registerConverters('imageBlock');\n    }\n    if (this.editor.plugins.has('ImageInlineEditing')) {\n      schema.extend('imageInline', {\n        allowAttributes: ['uploadId', 'uploadStatus']\n      });\n      this._registerConverters('imageInline');\n    }\n  }\n  /**\n  * Reads and uploads an image.\n  *\n  * The image is read from the disk and as a Base64-encoded string it is set temporarily to\n  * `image[src]`. When the image is successfully uploaded, the temporary data is replaced with the target\n  * image's URL (the URL to the uploaded image on the server).\n  */\n  _readAndUpload(loader) {\n    const editor = this.editor;\n    const model = editor.model;\n    const t = editor.locale.t;\n    const fileRepository = editor.plugins.get(FileRepository);\n    const notification = editor.plugins.get(Notification);\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const imageUploadElements = this._uploadImageElements;\n    model.enqueueChange({\n      isUndoable: false\n    }, writer => {\n      const elements = imageUploadElements.get(loader.id);\n      for (const element of elements) {\n        writer.setAttribute('uploadStatus', 'reading', element);\n      }\n    });\n    return loader.read().then(() => {\n      const promise = loader.upload();\n      if (editor.ui) {\n        editor.ui.ariaLiveAnnouncer.announce(t('Uploading image'));\n      }\n      for (const imageElement of imageUploadElements.get(loader.id)) {\n        // Force reâ€“paint in Safari. Without it, the image will display with a wrong size.\n        // https://github.com/ckeditor/ckeditor5/issues/1975\n        /* istanbul ignore next -- @preserve */\n        if (env.isSafari) {\n          const viewFigure = editor.editing.mapper.toViewElement(imageElement);\n          const viewImg = imageUtils.findViewImgElement(viewFigure);\n          editor.editing.view.once('render', () => {\n            // Early returns just to be safe. There might be some code ran\n            // in between the outer scope and this callback.\n            if (!viewImg.parent) {\n              return;\n            }\n            const domFigure = editor.editing.view.domConverter.mapViewToDom(viewImg.parent);\n            if (!domFigure) {\n              return;\n            }\n            const originalDisplay = domFigure.style.display;\n            domFigure.style.display = 'none';\n            // Make sure this line will never be removed during minification for having \"no effect\".\n            domFigure._ckHack = domFigure.offsetHeight;\n            domFigure.style.display = originalDisplay;\n          });\n        }\n        model.enqueueChange({\n          isUndoable: false\n        }, writer => {\n          writer.setAttribute('uploadStatus', 'uploading', imageElement);\n        });\n      }\n      return promise;\n    }).then(data => {\n      model.enqueueChange({\n        isUndoable: false\n      }, writer => {\n        for (const imageElement of imageUploadElements.get(loader.id)) {\n          writer.setAttribute('uploadStatus', 'complete', imageElement);\n          this.fire('uploadComplete', {\n            data,\n            imageElement\n          });\n        }\n        if (editor.ui) {\n          editor.ui.ariaLiveAnnouncer.announce(t('Image upload complete'));\n        }\n        this._uploadedImages.set(loader.id, data);\n      });\n      clean();\n    }).catch(error => {\n      if (editor.ui) {\n        editor.ui.ariaLiveAnnouncer.announce(t('Error during image upload'));\n      }\n      // If status is not 'error' nor 'aborted' - throw error because it means that something else went wrong,\n      // it might be generic error and it would be real pain to find what is going on.\n      if (loader.status !== 'error' && loader.status !== 'aborted') {\n        throw error;\n      }\n      // Might be 'aborted'.\n      if (loader.status == 'error' && error) {\n        notification.showWarning(error, {\n          title: t('Upload failed'),\n          namespace: 'upload'\n        });\n      }\n      // Permanently remove image from insertion batch.\n      model.enqueueChange({\n        isUndoable: false\n      }, writer => {\n        for (const imageElement of imageUploadElements.get(loader.id)) {\n          // Handle situation when the image has been removed and then `abort` exception was thrown.\n          // See: https://github.com/cksource/ckeditor5-commercial/issues/6817\n          if (imageElement.root.rootName !== '$graveyard') {\n            writer.remove(imageElement);\n          }\n        }\n      });\n      clean();\n    });\n    function clean() {\n      model.enqueueChange({\n        isUndoable: false\n      }, writer => {\n        for (const imageElement of imageUploadElements.get(loader.id)) {\n          writer.removeAttribute('uploadId', imageElement);\n          writer.removeAttribute('uploadStatus', imageElement);\n        }\n        imageUploadElements.delete(loader.id);\n      });\n      fileRepository.destroyLoader(loader);\n    }\n  }\n  /**\n  * Creates the `srcset` attribute based on a given file upload response and sets it as an attribute to a specific image element.\n  *\n  * @param data Data object from which `srcset` will be created.\n  * @param image The image element on which the `srcset` attribute will be set.\n  */\n  _parseAndSetSrcsetAttributeOnImage(data, image, writer) {\n    // Srcset attribute for responsive images support.\n    let maxWidth = 0;\n    const srcsetAttribute = Object.keys(data) // Filter out keys that are not integers.\n    .filter(key => {\n      const width = parseInt(key, 10);\n      if (!isNaN(width)) {\n        maxWidth = Math.max(maxWidth, width);\n        return true;\n      }\n    }) // Convert each key to srcset entry.\n    .map(key => `${data[key]} ${key}w`) // Join all entries.\n    .join(', ');\n    if (srcsetAttribute != '') {\n      const attributes = {\n        srcset: srcsetAttribute\n      };\n      if (!image.hasAttribute('width') && !image.hasAttribute('height')) {\n        attributes.width = maxWidth;\n      }\n      writer.setAttributes(attributes, image);\n    }\n  }\n  /**\n  * Registers image upload converters.\n  *\n  * @param imageType The type of the image.\n  */\n  _registerConverters(imageType) {\n    const {\n      conversion,\n      plugins\n    } = this.editor;\n    const fileRepository = plugins.get(FileRepository);\n    const imageUtils = plugins.get(ImageUtils);\n    // It sets `data-ck-upload-id` attribute on the view image elements that are not fully uploaded.\n    // It avoids the situation when image disappears when it's being moved and upload is not finished yet.\n    // See more: https://github.com/ckeditor/ckeditor5/issues/16967\n    conversion.for('dataDowncast').add(dispatcher => {\n      dispatcher.on(`attribute:uploadId:${imageType}`, (evt, data, conversionApi) => {\n        if (!conversionApi.consumable.test(data.item, evt.name)) {\n          return;\n        }\n        const loader = fileRepository.loaders.get(data.attributeNewValue);\n        if (!loader || !loader.data) {\n          return null;\n        }\n        const viewElement = conversionApi.mapper.toViewElement(data.item);\n        const img = imageUtils.findViewImgElement(viewElement);\n        if (img) {\n          conversionApi.consumable.consume(data.item, evt.name);\n          conversionApi.writer.setAttribute('data-ck-upload-id', loader.id, img);\n        }\n      });\n    });\n  }\n}\n/**\n * Returns `true` if non-empty `text/html` is included in the data transfer.\n */\nfunction isHtmlIncluded(dataTransfer) {\n  return Array.from(dataTransfer.types).includes('text/html') && dataTransfer.getData('text/html') !== '';\n}\nfunction getImagesFromChangeItem(editor, item) {\n  const imageUtils = editor.plugins.get('ImageUtils');\n  return Array.from(editor.model.createRangeOn(item)).filter(value => imageUtils.isImage(value.item)).map(value => value.item);\n}\n\n/**\n * The image upload plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload image upload feature} documentation.\n *\n * This plugin does not do anything directly, but it loads a set of specific plugins to enable image uploading:\n *\n * * {@link module:image/imageupload/imageuploadediting~ImageUploadEditing},\n * * {@link module:image/imageupload/imageuploadui~ImageUploadUI},\n * * {@link module:image/imageupload/imageuploadprogress~ImageUploadProgress}.\n */\nclass ImageUpload extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageUpload';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUploadEditing, ImageUploadUI, ImageUploadProgress];\n  }\n}\n\n/**\n * The insert an image via URL view.\n *\n * See {@link module:image/imageinsert/imageinsertviaurlui~ImageInsertViaUrlUI}.\n */\nclass ImageInsertUrlView extends View {\n  /**\n  * The URL input field view.\n  */\n  urlInputView;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * Creates a view for the dropdown panel of {@link module:image/imageinsert/imageinsertui~ImageInsertUI}.\n  *\n  * @param locale The localization services instance.\n  */\n  constructor(locale) {\n    super(locale);\n    this.set('imageURLInputValue', '');\n    this.set('isImageSelected', false);\n    this.set('isEnabled', true);\n    this.keystrokes = new KeystrokeHandler();\n    this.urlInputView = this._createUrlInputView();\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-image-insert-url'],\n        tabindex: '-1'\n      },\n      children: [this.urlInputView, {\n        tag: 'div',\n        attributes: {\n          class: ['ck', 'ck-image-insert-url__action-row']\n        }\n      }]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    submitHandler({\n      view: this\n    });\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Creates the {@link #urlInputView}.\n  */\n  _createUrlInputView() {\n    const locale = this.locale;\n    const t = locale.t;\n    const urlInputView = new LabeledFieldView(locale, createLabeledInputText);\n    urlInputView.bind('label').to(this, 'isImageSelected', value => value ? t('Update image URL') : t('Insert image via URL'));\n    urlInputView.bind('isEnabled').to(this);\n    urlInputView.fieldView.inputMode = 'url';\n    urlInputView.fieldView.placeholder = 'https://example.com/image.png';\n    urlInputView.fieldView.bind('value').to(this, 'imageURLInputValue', value => value || '');\n    urlInputView.fieldView.on('input', () => {\n      this.imageURLInputValue = urlInputView.fieldView.element.value.trim();\n    });\n    return urlInputView;\n  }\n  /**\n  * Focuses the view.\n  */\n  focus() {\n    this.urlInputView.focus();\n  }\n}\n\n/**\n * The image insert via URL plugin (UI part).\n *\n * The plugin introduces two UI components to the {@link module:ui/componentfactory~ComponentFactory UI component factory}:\n *\n * * the `'insertImageViaUrl'` toolbar button,\n * * the `'menuBar:insertImageViaUrl'` menu bar component.\n *\n * It also integrates with the `insertImage` toolbar component and `menuBar:insertImage` menu component, which are default components\n * through which inserting image via URL is available.\n */\nclass ImageInsertViaUrlUI extends Plugin {\n  _imageInsertUI;\n  _formView;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageInsertViaUrlUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageInsertUI, Dialog];\n  }\n  init() {\n    this.editor.ui.componentFactory.add('insertImageViaUrl', () => this._createToolbarButton());\n    this.editor.ui.componentFactory.add('menuBar:insertImageViaUrl', () => this._createMenuBarButton('standalone'));\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    this._imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n    this._imageInsertUI.registerIntegration({\n      name: 'url',\n      observable: () => this.editor.commands.get('insertImage'),\n      buttonViewCreator: () => this._createToolbarButton(),\n      formViewCreator: () => this._createDropdownButton(),\n      menuBarButtonViewCreator: isOnly => this._createMenuBarButton(isOnly ? 'insertOnly' : 'insertNested')\n    });\n  }\n  /**\n  * Creates the base for various kinds of the button component provided by this feature.\n  */\n  _createInsertUrlButton(ButtonClass) {\n    const button = new ButtonClass(this.editor.locale);\n    button.icon = IconImageUrl;\n    button.on('execute', () => {\n      this._showModal();\n    });\n    return button;\n  }\n  /**\n  * Creates a simple toolbar button, with an icon and a tooltip.\n  */\n  _createToolbarButton() {\n    const t = this.editor.locale.t;\n    const button = this._createInsertUrlButton(ButtonView);\n    button.tooltip = true;\n    button.bind('label').to(this._imageInsertUI, 'isImageSelected', isImageSelected => isImageSelected ? t('Update image URL') : t('Insert image via URL'));\n    return button;\n  }\n  /**\n  * Creates a button for the dropdown view, with an icon, text and no tooltip.\n  */\n  _createDropdownButton() {\n    const t = this.editor.locale.t;\n    const button = this._createInsertUrlButton(ButtonView);\n    button.withText = true;\n    button.bind('label').to(this._imageInsertUI, 'isImageSelected', isImageSelected => isImageSelected ? t('Update image URL') : t('Insert via URL'));\n    return button;\n  }\n  /**\n  * Creates a button for the menu bar.\n  */\n  _createMenuBarButton(type) {\n    const t = this.editor.locale.t;\n    const button = this._createInsertUrlButton(MenuBarMenuListItemButtonView);\n    button.withText = true;\n    switch (type) {\n      case 'standalone':\n        button.label = t('Image via URL');\n        break;\n      case 'insertOnly':\n        button.label = t('Image');\n        break;\n      case 'insertNested':\n        button.label = t('Via URL');\n        break;\n    }\n    return button;\n  }\n  /**\n  * Creates the form view used to submit the image URL.\n  */\n  _createInsertUrlView() {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const replaceImageSourceCommand = editor.commands.get('replaceImageSource');\n    const insertImageCommand = editor.commands.get('insertImage');\n    const imageInsertUrlView = new ImageInsertUrlView(locale);\n    imageInsertUrlView.bind('isImageSelected').to(this._imageInsertUI);\n    imageInsertUrlView.bind('isEnabled').toMany([insertImageCommand, replaceImageSourceCommand], 'isEnabled', (...isEnabled) => isEnabled.some(isCommandEnabled => isCommandEnabled));\n    return imageInsertUrlView;\n  }\n  /**\n  * Shows the insert image via URL form view in a modal.\n  */\n  _showModal() {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const t = locale.t;\n    const dialog = editor.plugins.get('Dialog');\n    if (!this._formView) {\n      this._formView = this._createInsertUrlView();\n      this._formView.on('submit', () => this._handleSave());\n    }\n    const replaceImageSourceCommand = editor.commands.get('replaceImageSource');\n    this._formView.imageURLInputValue = replaceImageSourceCommand.value || '';\n    dialog.show({\n      id: 'insertImageViaUrl',\n      title: t('Image via URL'),\n      isModal: true,\n      content: this._formView,\n      actionButtons: [{\n        label: t('Cancel'),\n        withText: true,\n        onExecute: () => dialog.hide()\n      }, {\n        label: this._imageInsertUI.isImageSelected ? t('Save') : t('Insert'),\n        class: 'ck-button-action',\n        withText: true,\n        onExecute: () => this._handleSave()\n      }]\n    });\n  }\n  /**\n  * Executes appropriate command depending on selection and form value.\n  */\n  _handleSave() {\n    const replaceImageSourceCommand = this.editor.commands.get('replaceImageSource');\n    // If an image element is currently selected, we want to replace its source attribute (instead of inserting a new image).\n    // We detect if an image is selected by checking `replaceImageSource` command state.\n    if (replaceImageSourceCommand.isEnabled) {\n      this.editor.execute('replaceImageSource', {\n        source: this._formView.imageURLInputValue\n      });\n    } else {\n      this.editor.execute('insertImage', {\n        source: this._formView.imageURLInputValue\n      });\n    }\n    this.editor.plugins.get('Dialog').hide();\n  }\n}\n\n/**\n * The image insert via URL plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-inserting\n * Insert images via source URL} documentation.\n *\n * This plugin does not do anything directly, but it loads a set of specific plugins\n * to enable image inserting via implemented integrations:\n *\n * * {@link module:image/imageinsert/imageinsertui~ImageInsertUI},\n */\nclass ImageInsertViaUrl extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageInsertViaUrl';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageInsertViaUrlUI, ImageInsertUI];\n  }\n}\n\n/**\n * The image insert plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload Image upload feature}\n * and {@glink features/images/images-inserting Insert images via source URL} documentation.\n *\n * This plugin does not do anything directly, but it loads a set of specific plugins\n * to enable image uploading or inserting via implemented integrations:\n *\n * * {@link module:image/imageupload~ImageUpload}\n * * {@link module:image/imageinsert/imageinsertui~ImageInsertUI}\n */\nclass ImageInsert extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageInsert';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUpload, ImageInsertViaUrl, ImageInsertUI];\n  }\n}\n\n/**\n * The resize image command. Currently, it only supports the width attribute.\n */\nclass ResizeImageCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const element = imageUtils.getClosestSelectedImageElement(editor.model.document.selection);\n    this.isEnabled = !!element;\n    if (!element || !element.hasAttribute('resizedWidth')) {\n      this.value = null;\n    } else {\n      this.value = {\n        width: element.getAttribute('resizedWidth'),\n        height: null\n      };\n    }\n  }\n  /**\n  * Executes the command.\n  *\n  * ```ts\n  * // Sets the width to 50%:\n  * editor.execute( 'resizeImage', { width: '50%' } );\n  *\n  * // Removes the width attribute:\n  * editor.execute( 'resizeImage', { width: null } );\n  * ```\n  *\n  * @param options\n  * @param options.width The new width of the image.\n  * @fires execute\n  */\n  execute(options) {\n    const editor = this.editor;\n    const model = editor.model;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const imageElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n    this.value = {\n      width: options.width,\n      height: null\n    };\n    if (imageElement) {\n      model.change(writer => {\n        writer.setAttribute('resizedWidth', options.width, imageElement);\n        writer.removeAttribute('resizedHeight', imageElement);\n        imageUtils.setImageNaturalSizeAttributes(imageElement);\n      });\n    }\n  }\n}\n\n/**\n * The image resize editing feature.\n *\n * It adds the ability to resize each image using handles or manually by\n * {@link module:image/imageresize/imageresizebuttons~ImageResizeButtons} buttons.\n */\nclass ImageResizeEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageResizeEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('image', {\n      resizeUnit: '%',\n      resizeOptions: [{\n        name: 'resizeImage:original',\n        value: null,\n        icon: 'original'\n      }, {\n        name: 'resizeImage:custom',\n        value: 'custom',\n        icon: 'custom'\n      }, {\n        name: 'resizeImage:25',\n        value: '25',\n        icon: 'small'\n      }, {\n        name: 'resizeImage:50',\n        value: '50',\n        icon: 'medium'\n      }, {\n        name: 'resizeImage:75',\n        value: '75',\n        icon: 'large'\n      }]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const resizeImageCommand = new ResizeImageCommand(editor);\n    this._registerConverters('imageBlock');\n    this._registerConverters('imageInline');\n    // Register `resizeImage` command and add `imageResize` command as an alias for backward compatibility.\n    editor.commands.add('resizeImage', resizeImageCommand);\n    editor.commands.add('imageResize', resizeImageCommand);\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    this._registerSchema();\n  }\n  _registerSchema() {\n    if (this.editor.plugins.has('ImageBlockEditing')) {\n      this.editor.model.schema.extend('imageBlock', {\n        allowAttributes: ['resizedWidth', 'resizedHeight']\n      });\n    }\n    if (this.editor.plugins.has('ImageInlineEditing')) {\n      this.editor.model.schema.extend('imageInline', {\n        allowAttributes: ['resizedWidth', 'resizedHeight']\n      });\n    }\n  }\n  /**\n  * Registers image resize converters.\n  *\n  * @param imageType The type of the image.\n  */\n  _registerConverters(imageType) {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    // Dedicated converter to propagate image's attribute to the img tag.\n    editor.conversion.for('downcast').add(dispatcher => dispatcher.on(`attribute:resizedWidth:${imageType}`, (evt, data, conversionApi) => {\n      if (!conversionApi.consumable.consume(data.item, evt.name)) {\n        return;\n      }\n      const viewWriter = conversionApi.writer;\n      const viewImg = conversionApi.mapper.toViewElement(data.item);\n      if (data.attributeNewValue !== null) {\n        viewWriter.setStyle('width', data.attributeNewValue, viewImg);\n        viewWriter.addClass('image_resized', viewImg);\n      } else {\n        viewWriter.removeStyle('width', viewImg);\n        viewWriter.removeClass('image_resized', viewImg);\n      }\n    }));\n    editor.conversion.for('dataDowncast').attributeToAttribute({\n      model: {\n        name: imageType,\n        key: 'resizedHeight'\n      },\n      view: modelAttributeValue => ({\n        key: 'style',\n        value: {\n          'height': modelAttributeValue\n        }\n      })\n    });\n    editor.conversion.for('editingDowncast').add(dispatcher => dispatcher.on(`attribute:resizedHeight:${imageType}`, (evt, data, conversionApi) => {\n      if (!conversionApi.consumable.consume(data.item, evt.name)) {\n        return;\n      }\n      const viewWriter = conversionApi.writer;\n      const viewImg = conversionApi.mapper.toViewElement(data.item);\n      const target = imageType === 'imageInline' ? imageUtils.findViewImgElement(viewImg) : viewImg;\n      if (data.attributeNewValue !== null) {\n        viewWriter.setStyle('height', data.attributeNewValue, target);\n      } else {\n        viewWriter.removeStyle('height', target);\n      }\n    }));\n    editor.conversion.for('upcast').attributeToAttribute({\n      view: {\n        name: imageType === 'imageBlock' ? 'figure' : 'img',\n        styles: {\n          width: /.+/\n        }\n      },\n      model: {\n        key: 'resizedWidth',\n        value: viewElement => {\n          if (widthAndHeightStylesAreBothSet(viewElement)) {\n            return null;\n          }\n          return viewElement.getStyle('width');\n        }\n      }\n    });\n    editor.conversion.for('upcast').attributeToAttribute({\n      view: {\n        name: imageType === 'imageBlock' ? 'figure' : 'img',\n        styles: {\n          height: /.+/\n        }\n      },\n      model: {\n        key: 'resizedHeight',\n        value: viewElement => {\n          if (widthAndHeightStylesAreBothSet(viewElement)) {\n            return null;\n          }\n          return viewElement.getStyle('height');\n        }\n      }\n    });\n  }\n}\nconst RESIZE_ICONS = /* #__PURE__ */(() => ({\n  small: IconObjectSizeSmall,\n  medium: IconObjectSizeMedium,\n  large: IconObjectSizeLarge,\n  custom: IconObjectSizeCustom,\n  original: IconObjectSizeFull\n}))();\n/**\n * The image resize buttons plugin.\n *\n * It adds a possibility to resize images using the toolbar dropdown or individual buttons, depending on the plugin configuration.\n */\nclass ImageResizeButtons extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageResizeEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageResizeButtons';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * The resize unit.\n  * @default '%'\n  */\n  _resizeUnit;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._resizeUnit = editor.config.get('image.resizeUnit');\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const options = editor.config.get('image.resizeOptions');\n    const command = editor.commands.get('resizeImage');\n    this.bind('isEnabled').to(command);\n    for (const option of options) {\n      this._registerImageResizeButton(option);\n    }\n    this._registerImageResizeDropdown(options);\n  }\n  /**\n  * A helper function that creates a standalone button component for the plugin.\n  *\n  * @param resizeOption A model of the resize option.\n  */\n  _registerImageResizeButton(option) {\n    const editor = this.editor;\n    const {\n      name,\n      value,\n      icon\n    } = option;\n    editor.ui.componentFactory.add(name, locale => {\n      const button = new ButtonView(locale);\n      const command = editor.commands.get('resizeImage');\n      const labelText = this._getOptionLabelValue(option, true);\n      if (!RESIZE_ICONS[icon]) {\n        /**\n        * When configuring {@link module:image/imageconfig~ImageConfig#resizeOptions `config.image.resizeOptions`} for standalone\n        * buttons, a valid `icon` token must be set for each option.\n        *\n        * See all valid options described in the\n        * {@link module:image/imageconfig~ImageResizeOption plugin configuration}.\n        *\n        * @error imageresizebuttons-missing-icon\n        * @param option Invalid image resize option.\n        */\n        throw new CKEditorError('imageresizebuttons-missing-icon', editor, option);\n      }\n      button.set({\n        // Use the `label` property for a verbose description (because of ARIA).\n        label: labelText,\n        icon: RESIZE_ICONS[icon],\n        tooltip: labelText,\n        isToggleable: true\n      });\n      // Bind button to the command.\n      button.bind('isEnabled').to(this);\n      if (editor.plugins.has('ImageCustomResizeUI') && isCustomImageResizeOption(option)) {\n        const customResizeUI = editor.plugins.get('ImageCustomResizeUI');\n        this.listenTo(button, 'execute', () => {\n          customResizeUI._showForm(this._resizeUnit);\n        });\n      } else {\n        const optionValueWithUnit = value ? value + this._resizeUnit : null;\n        button.bind('isOn').to(command, 'value', command, 'isEnabled', getIsOnButtonCallback(optionValueWithUnit));\n        this.listenTo(button, 'execute', () => {\n          editor.execute('resizeImage', {\n            width: optionValueWithUnit\n          });\n        });\n      }\n      return button;\n    });\n  }\n  /**\n  * A helper function that creates a dropdown component for the plugin containing all the resize options defined in\n  * the editor configuration.\n  *\n  * @param options An array of configured options.\n  */\n  _registerImageResizeDropdown(options) {\n    const editor = this.editor;\n    const t = editor.t;\n    const originalSizeOption = options.find(option => !option.value);\n    const componentCreator = locale => {\n      const command = editor.commands.get('resizeImage');\n      const dropdownView = createDropdown(locale, DropdownButtonView);\n      const dropdownButton = dropdownView.buttonView;\n      const accessibleLabel = t('Resize image');\n      dropdownButton.set({\n        tooltip: accessibleLabel,\n        commandValue: originalSizeOption.value,\n        icon: RESIZE_ICONS.medium,\n        isToggleable: true,\n        label: this._getOptionLabelValue(originalSizeOption),\n        withText: true,\n        class: 'ck-resize-image-button',\n        ariaLabel: accessibleLabel,\n        ariaLabelledBy: undefined\n      });\n      dropdownButton.bind('label').to(command, 'value', commandValue => {\n        if (commandValue && commandValue.width) {\n          return commandValue.width;\n        } else {\n          return this._getOptionLabelValue(originalSizeOption);\n        }\n      });\n      dropdownView.bind('isEnabled').to(this);\n      addListToDropdown(dropdownView, () => this._getResizeDropdownListItemDefinitions(options, command), {\n        ariaLabel: t('Image resize list'),\n        role: 'menu'\n      });\n      // Execute command when an item from the dropdown is selected.\n      this.listenTo(dropdownView, 'execute', evt => {\n        if ('onClick' in evt.source) {\n          evt.source.onClick();\n        } else {\n          editor.execute(evt.source.commandName, {\n            width: evt.source.commandValue\n          });\n          editor.editing.view.focus();\n        }\n      });\n      return dropdownView;\n    };\n    // Register `resizeImage` dropdown and add `imageResize` dropdown as an alias for backward compatibility.\n    editor.ui.componentFactory.add('resizeImage', componentCreator);\n    editor.ui.componentFactory.add('imageResize', componentCreator);\n  }\n  /**\n  * A helper function for creating an option label value string.\n  *\n  * @param option A resize option object.\n  * @param forTooltip An optional flag for creating a tooltip label.\n  * @returns A user-defined label combined from the numeric value and the resize unit or the default label\n  * for reset options (`Original`).\n  */\n  _getOptionLabelValue(option, forTooltip = false) {\n    const t = this.editor.t;\n    if (option.label) {\n      return option.label;\n    } else if (forTooltip) {\n      if (isCustomImageResizeOption(option)) {\n        return t('Custom image size');\n      } else if (option.value) {\n        return t('Resize image to %0', option.value + this._resizeUnit);\n      } else {\n        return t('Resize image to the original size');\n      }\n    } else {\n      if (isCustomImageResizeOption(option)) {\n        return t('Custom');\n      } else if (option.value) {\n        return option.value + this._resizeUnit;\n      } else {\n        return t('Original');\n      }\n    }\n  }\n  /**\n  * A helper function that parses the resize options and returns list item definitions ready for use in the dropdown.\n  *\n  * @param options The resize options.\n  * @param command The resize image command.\n  * @returns Dropdown item definitions.\n  */\n  _getResizeDropdownListItemDefinitions(options, command) {\n    const {\n      editor\n    } = this;\n    const itemDefinitions = new Collection();\n    const optionsWithSerializedValues = options.map(option => {\n      if (isCustomImageResizeOption(option)) {\n        return {\n          ...option,\n          valueWithUnits: 'custom'\n        };\n      }\n      if (!option.value) {\n        return {\n          ...option,\n          valueWithUnits: null\n        };\n      }\n      return {\n        ...option,\n        valueWithUnits: `${option.value}${this._resizeUnit}`\n      };\n    });\n    for (const option of optionsWithSerializedValues) {\n      let definition = null;\n      if (editor.plugins.has('ImageCustomResizeUI') && isCustomImageResizeOption(option)) {\n        const customResizeUI = editor.plugins.get('ImageCustomResizeUI');\n        definition = {\n          type: 'button',\n          model: new ViewModel({\n            label: this._getOptionLabelValue(option),\n            role: 'menuitemradio',\n            withText: true,\n            icon: null,\n            onClick: () => {\n              customResizeUI._showForm(this._resizeUnit);\n            }\n          })\n        };\n        const allDropdownValues = Object.values(optionsWithSerializedValues).map(option => option.valueWithUnits);\n        definition.model.bind('isOn').to(command, 'value', command, 'isEnabled', getIsOnCustomButtonCallback(allDropdownValues));\n      } else {\n        definition = {\n          type: 'button',\n          model: new ViewModel({\n            commandName: 'resizeImage',\n            commandValue: option.valueWithUnits,\n            label: this._getOptionLabelValue(option),\n            role: 'menuitemradio',\n            withText: true,\n            icon: null\n          })\n        };\n        definition.model.bind('isOn').to(command, 'value', command, 'isEnabled', getIsOnButtonCallback(option.valueWithUnits));\n      }\n      definition.model.bind('isEnabled').to(command, 'isEnabled');\n      itemDefinitions.add(definition);\n    }\n    return itemDefinitions;\n  }\n}\n/**\n * A helper that checks if provided option triggers custom resize balloon.\n */\nfunction isCustomImageResizeOption(option) {\n  return option.value === 'custom';\n}\n/**\n * A helper function for setting the `isOn` state of buttons in value bindings.\n */\nfunction getIsOnButtonCallback(value) {\n  return (commandValue, isEnabled) => {\n    const objectCommandValue = commandValue;\n    if (objectCommandValue === undefined || !isEnabled) {\n      return false;\n    }\n    if (value === null && objectCommandValue === value) {\n      return true;\n    }\n    return objectCommandValue !== null && objectCommandValue.width === value;\n  };\n}\n/**\n * A helper function for setting the `isOn` state of custom size button in value bindings.\n */\nfunction getIsOnCustomButtonCallback(allDropdownValues) {\n  return (commandValue, isEnabled) => !allDropdownValues.some(dropdownValue => getIsOnButtonCallback(dropdownValue)(commandValue, isEnabled));\n}\nconst RESIZABLE_IMAGES_CSS_SELECTOR = 'figure.image.ck-widget > img,' + 'figure.image.ck-widget > picture > img,' + 'figure.image.ck-widget > a > img,' + 'figure.image.ck-widget > a > picture > img,' + 'span.image-inline.ck-widget > img,' + 'span.image-inline.ck-widget > picture > img';\nconst RESIZED_IMAGE_CLASS = 'image_resized';\n/**\n * The image resize by handles feature.\n *\n * It adds the ability to resize each image using handles or manually by\n * {@link module:image/imageresize/imageresizebuttons~ImageResizeButtons} buttons.\n */\nclass ImageResizeHandles extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [WidgetResize, ImageUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageResizeHandles';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const command = this.editor.commands.get('resizeImage');\n    this.bind('isEnabled').to(command);\n    this._setupResizerCreator();\n  }\n  /**\n  * Attaches the listeners responsible for creating a resizer for each image, except for images inside the HTML embed preview.\n  */\n  _setupResizerCreator() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    editingView.addObserver(ImageLoadObserver);\n    this.listenTo(editingView.document, 'imageLoaded', (evt, domEvent) => {\n      // The resizer must be attached only to images loaded by the `ImageInsert`, `ImageUpload` or `LinkImage` plugins.\n      if (!domEvent.target.matches(RESIZABLE_IMAGES_CSS_SELECTOR)) {\n        return;\n      }\n      const domConverter = editor.editing.view.domConverter;\n      const imageView = domConverter.domToView(domEvent.target);\n      const widgetView = imageUtils.getImageWidgetFromImageView(imageView);\n      let resizer = this.editor.plugins.get(WidgetResize).getResizerByViewElement(widgetView);\n      if (resizer) {\n        // There are rare cases when the image will be triggered multiple times for the same widget, e.g. when\n        // the image's source was changed after upload (https://github.com/ckeditor/ckeditor5/pull/8108#issuecomment-708302992).\n        resizer.redraw();\n        return;\n      }\n      const mapper = editor.editing.mapper;\n      const imageModel = mapper.toModelElement(widgetView);\n      resizer = editor.plugins.get(WidgetResize).attachTo({\n        unit: editor.config.get('image.resizeUnit'),\n        modelElement: imageModel,\n        viewElement: widgetView,\n        editor,\n        getHandleHost(domWidgetElement) {\n          return domWidgetElement.querySelector('img');\n        },\n        getResizeHost() {\n          return domConverter.mapViewToDom(mapper.toViewElement(imageModel));\n        },\n        isCentered() {\n          const imageStyle = imageModel.getAttribute('imageStyle');\n          return imageStyle == 'alignCenter';\n        },\n        onCommit(newValue) {\n          // Get rid of the CSS class in case the command execution that follows is unsuccessful\n          // (e.g. Track Changes can override it and the new dimensions will not apply). Otherwise,\n          // the presence of the class and the absence of the width style will cause it to take 100%\n          // of the horizontal space.\n          editingView.change(writer => {\n            writer.removeClass(RESIZED_IMAGE_CLASS, widgetView);\n          });\n          editor.execute('resizeImage', {\n            width: newValue\n          });\n        }\n      });\n      resizer.on('updateSize', () => {\n        if (!widgetView.hasClass(RESIZED_IMAGE_CLASS)) {\n          editingView.change(writer => {\n            writer.addClass(RESIZED_IMAGE_CLASS, widgetView);\n          });\n        }\n        const target = imageModel.name === 'imageInline' ? imageView : widgetView;\n        if (target.getStyle('height')) {\n          editingView.change(writer => {\n            writer.removeStyle('height', target);\n          });\n        }\n      });\n      resizer.bind('isEnabled').to(this);\n    });\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module image/imageresize/utils/tryparsedimensionwithunit\n    */ /**\n       * Parses provided string with dimension value and returns extracted numeric value and unit.\n       *\n       * \t* If non-string dimension is passed then `null` value is returned.\n       * \t* If unit is missing then `null` is returned.\n       * \t* If numeric value part of string is not a number then `null` is returned.\n       *\n       * Example:\n       * \t`\"222px\"` => `{ value: 222, unit: \"px\" }`\n       *\t`\"99%\"` => `{ value: 99, unit: \"%\" }`\n       * @param dimension Unsafe string with dimension.\n       * @returns Parsed dimension with extracted numeric value and units.\n       */\nfunction tryParseDimensionWithUnit(dimension) {\n  if (!dimension) {\n    return null;\n  }\n  const [, rawValue, unit] = dimension.trim().match(/([.,\\d]+)(%|px)$/) || [];\n  const parsedValue = Number.parseFloat(rawValue);\n  if (Number.isNaN(parsedValue)) {\n    return null;\n  }\n  return {\n    value: parsedValue,\n    unit\n  };\n}\n/**\n * Converts dimension between `px` -> `%` and `%` -> `px`.\n *\n * @param parentDimensionPx\tDimension of parent element that contains measured element.\n * @param dimension Measured element dimension.\n * @returns Casted dimension.\n */\nfunction tryCastDimensionsToUnit(parentDimensionPx, dimension, targetUnit) {\n  // \"%\" -> \"px\" conversion\n  if (targetUnit === 'px') {\n    return {\n      value: dimension.value,\n      unit: 'px'\n    };\n  }\n  // \"px\" -> \"%\" conversion\n  return {\n    value: dimension.value / parentDimensionPx * 100,\n    unit: '%'\n  };\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module image/imageresize/utils/getselectedimageeditornodes\n    */ /**\n       * Finds model, view and DOM element for selected image element. Returns `null` if there is no image selected.\n       *\n       * @param editor Editor instance.\n       */\nfunction getSelectedImageEditorNodes(editor) {\n  const {\n    editing\n  } = editor;\n  const imageUtils = editor.plugins.get('ImageUtils');\n  const imageModelElement = imageUtils.getClosestSelectedImageElement(editor.model.document.selection);\n  if (!imageModelElement) {\n    return null;\n  }\n  const imageViewElement = editing.mapper.toViewElement(imageModelElement);\n  const imageDOMElement = editing.view.domConverter.mapViewToDom(imageViewElement);\n  return {\n    model: imageModelElement,\n    view: imageViewElement,\n    dom: imageDOMElement\n  };\n}\n\n/**\n * Returns image width in specified units. It is width of image after resize.\n *\n * \t* If image is not selected or command is disabled then `null` will be returned.\n * \t* If image is not fully loaded (and it is impossible to determine its natural size) then `null` will be returned.\n *\t* If `targetUnit` percentage is passed then it will return width percentage of image related to its accessors.\n *\n * @param editor Editor instance.\n * @param targetUnit Unit in which dimension will be returned.\n * @returns Parsed image width after resize (with unit).\n */\nfunction getSelectedImageWidthInUnits(editor, targetUnit) {\n  const imageNodes = getSelectedImageEditorNodes(editor);\n  if (!imageNodes) {\n    return null;\n  }\n  const parsedResizedWidth = tryParseDimensionWithUnit(imageNodes.model.getAttribute('resizedWidth') || null);\n  if (!parsedResizedWidth) {\n    return null;\n  }\n  if (parsedResizedWidth.unit === targetUnit) {\n    return parsedResizedWidth;\n  }\n  const imageParentWidthPx = calculateResizeHostAncestorWidth(imageNodes.dom);\n  const imageHolderDimension = {\n    value: new Rect(imageNodes.dom).width\n  };\n  return tryCastDimensionsToUnit(imageParentWidthPx, imageHolderDimension, targetUnit);\n}\n\n/**\n * The ImageCustomResizeFormView class.\n */\nclass ImageCustomResizeFormView extends View {\n  /**\n  * Tracks information about the DOM focus in the form.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * Resize unit shortcut.\n  */\n  unit;\n  /**\n  * The Back button view displayed in the header.\n  */\n  backButtonView;\n  /**\n  * A button used to submit the form.\n  */\n  saveButtonView;\n  /**\n  * An input with a label.\n  */\n  labeledInput;\n  /**\n  * A collection of child views.\n  */\n  children;\n  /**\n  * A collection of views which can be focused in the form.\n  */\n  _focusables;\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * An array of form validators used by {@link #isValid}.\n  */\n  _validators;\n  /**\n  * @inheritDoc\n  */\n  constructor(locale, unit, validators) {\n    super(locale);\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this.unit = unit;\n    // Create buttons.\n    this.backButtonView = this._createBackButton();\n    this.saveButtonView = this._createSaveButton();\n    // Create input fields.\n    this.labeledInput = this._createLabeledInputView();\n    this.children = this.createCollection([this._createHeaderView()]);\n    this.children.add(new FormRowView(locale, {\n      children: [this.labeledInput, this.saveButtonView],\n      class: ['ck-form__row_with-submit', 'ck-form__row_large-top-padding']\n    }));\n    this._focusables = new ViewCollection();\n    this._validators = validators;\n    // Close the panel on esc key press when the **form has focus**.\n    this.keystrokes.set('Esc', (data, cancel) => {\n      this.fire('cancel');\n      cancel();\n    });\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-form', 'ck-image-custom-resize-form', 'ck-responsive-form'],\n        // https://github.com/ckeditor/ckeditor5-image/issues/40\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    submitHandler({\n      view: this\n    });\n    const childViews = [this.backButtonView, this.labeledInput, this.saveButtonView];\n    childViews.forEach(v => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n    });\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Creates a back button view that cancels the form.\n  */\n  _createBackButton() {\n    const t = this.locale.t;\n    const backButton = new ButtonView(this.locale);\n    backButton.set({\n      class: 'ck-button-back',\n      label: t('Back'),\n      icon: IconPreviousArrow,\n      tooltip: true\n    });\n    backButton.delegate('execute').to(this, 'cancel');\n    return backButton;\n  }\n  /**\n  * Creates a save button view that resize the image.\n  */\n  _createSaveButton() {\n    const t = this.locale.t;\n    const saveButton = new ButtonView(this.locale);\n    saveButton.set({\n      label: t('Save'),\n      withText: true,\n      type: 'submit',\n      class: 'ck-button-action ck-button-bold'\n    });\n    return saveButton;\n  }\n  /**\n  * Creates a header view for the form.\n  */\n  _createHeaderView() {\n    const t = this.locale.t;\n    const header = new FormHeaderView(this.locale, {\n      label: t('Image Resize')\n    });\n    header.children.add(this.backButtonView, 0);\n    return header;\n  }\n  /**\n  * Creates an input with a label.\n  *\n  * @returns Labeled field view instance.\n  */\n  _createLabeledInputView() {\n    const t = this.locale.t;\n    const labeledInput = new LabeledFieldView(this.locale, createLabeledInputNumber);\n    labeledInput.label = t('Resize image (in %0)', this.unit);\n    labeledInput.class = 'ck-labeled-field-view_full-width';\n    labeledInput.fieldView.set({\n      step: 0.1\n    });\n    return labeledInput;\n  }\n  /**\n  * Validates the form and returns `false` when some fields are invalid.\n  */\n  isValid() {\n    this.resetFormStatus();\n    for (const validator of this._validators) {\n      const errorText = validator(this);\n      // One error per field is enough.\n      if (errorText) {\n        // Apply updated error.\n        this.labeledInput.errorText = errorText;\n        return false;\n      }\n    }\n    return true;\n  }\n  /**\n  * Cleans up the supplementary error and information text of the {@link #labeledInput}\n  * bringing them back to the state when the form has been displayed for the first time.\n  *\n  * See {@link #isValid}.\n  */\n  resetFormStatus() {\n    this.labeledInput.errorText = null;\n  }\n  /**\n  * The native DOM `value` of the input element of {@link #labeledInput}.\n  */\n  get rawSize() {\n    const {\n      element\n    } = this.labeledInput.fieldView;\n    if (!element) {\n      return null;\n    }\n    return element.value;\n  }\n  /**\n  * Get numeric value of size. Returns `null` if value of size input element in {@link #labeledInput}.is not a number.\n  */\n  get parsedSize() {\n    const {\n      rawSize\n    } = this;\n    if (rawSize === null) {\n      return null;\n    }\n    const parsed = Number.parseFloat(rawSize);\n    if (Number.isNaN(parsed)) {\n      return null;\n    }\n    return parsed;\n  }\n  /**\n  * Returns serialized image input size with unit.\n  * Returns `null` if value of size input element in {@link #labeledInput}.is not a number.\n  */\n  get sizeWithUnits() {\n    const {\n      parsedSize,\n      unit\n    } = this;\n    if (parsedSize === null) {\n      return null;\n    }\n    return `${parsedSize}${unit}`;\n  }\n}\n\n/**\n * Returns min and max value of resize image in specified unit.\n *\n * @param editor Editor instance.\n * @param targetUnit Unit in which dimension will be returned.\n * @returns Possible resize range in numeric form.\n */\nfunction getSelectedImagePossibleResizeRange(editor, targetUnit) {\n  const imageNodes = getSelectedImageEditorNodes(editor);\n  if (!imageNodes) {\n    return null;\n  }\n  const imageParentWidthPx = calculateResizeHostAncestorWidth(imageNodes.dom);\n  const minimumImageWidth = tryParseDimensionWithUnit(window.getComputedStyle(imageNodes.dom).minWidth) || {\n    value: 1\n  };\n  const lower = Math.max(0.1, tryCastDimensionsToUnit(imageParentWidthPx, minimumImageWidth, targetUnit).value);\n  const upper = targetUnit === 'px' ? imageParentWidthPx : 100;\n  return {\n    unit: targetUnit,\n    lower,\n    upper\n  };\n}\n\n/**\n * The custom resize image UI plugin.\n *\n * The plugin uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon}.\n */\nclass ImageCustomResizeUI extends Plugin {\n  /**\n  * The contextual balloon plugin instance.\n  */\n  _balloon;\n  /**\n  * A form containing a textarea and buttons, used to change the `alt` text value.\n  */\n  _form;\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ContextualBalloon];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageCustomResizeUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    // Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n    if (this._form) {\n      this._form.destroy();\n    }\n  }\n  /**\n  * Creates the {@link module:image/imageresize/ui/imagecustomresizeformview~ImageCustomResizeFormView}\n  * form.\n  */\n  _createForm(unit) {\n    const editor = this.editor;\n    this._balloon = this.editor.plugins.get('ContextualBalloon');\n    this._form = new (CssTransitionDisablerMixin(ImageCustomResizeFormView))(editor.locale, unit, getFormValidators(editor));\n    // Render the form so its #element is available for clickOutsideHandler.\n    this._form.render();\n    this.listenTo(this._form, 'submit', () => {\n      if (this._form.isValid()) {\n        editor.execute('resizeImage', {\n          width: this._form.sizeWithUnits\n        });\n        this._hideForm(true);\n      }\n    });\n    // Update balloon position when form error label is added .\n    this.listenTo(this._form.labeledInput, 'change:errorText', () => {\n      editor.ui.update();\n    });\n    this.listenTo(this._form, 'cancel', () => {\n      this._hideForm(true);\n    });\n    // Close on click outside of balloon panel element.\n    clickOutsideHandler({\n      emitter: this._form,\n      activator: () => this._isVisible,\n      contextElements: () => [this._balloon.view.element],\n      callback: () => this._hideForm()\n    });\n  }\n  /**\n  * Shows the {@link #_form} in the {@link #_balloon}.\n  *\n  * @internal\n  */\n  _showForm(unit) {\n    if (this._isVisible) {\n      return;\n    }\n    if (!this._form) {\n      this._createForm(unit);\n    }\n    const editor = this.editor;\n    const labeledInput = this._form.labeledInput;\n    this._form.disableCssTransitions();\n    this._form.resetFormStatus();\n    if (!this._isInBalloon) {\n      this._balloon.add({\n        view: this._form,\n        position: getBalloonPositionData(editor)\n      });\n    }\n    // Make sure that each time the panel shows up, the field remains in sync with the value of\n    // the command. If the user typed in the input, then canceled the balloon (`labeledInput#value`\n    // stays unaltered) and re-opened it without changing the value of the command, they would see the\n    // old value instead of the actual value of the command.\n    const currentParsedWidth = getSelectedImageWidthInUnits(editor, unit);\n    const initialInputValue = currentParsedWidth ? currentParsedWidth.value.toFixed(1) : '';\n    const possibleRange = getSelectedImagePossibleResizeRange(editor, unit);\n    labeledInput.fieldView.value = labeledInput.fieldView.element.value = initialInputValue;\n    if (possibleRange) {\n      Object.assign(labeledInput.fieldView, {\n        min: possibleRange.lower.toFixed(1),\n        max: Math.ceil(possibleRange.upper).toFixed(1)\n      });\n    }\n    this._form.labeledInput.fieldView.select();\n    this._form.enableCssTransitions();\n  }\n  /**\n  * Removes the {@link #_form} from the {@link #_balloon}.\n  *\n  * @param focusEditable Controls whether the editing view is focused afterwards.\n  */\n  _hideForm(focusEditable = false) {\n    if (!this._isInBalloon) {\n      return;\n    }\n    // Blur the input element before removing it from DOM to prevent issues in some browsers.\n    // See https://github.com/ckeditor/ckeditor5/issues/1501.\n    if (this._form.focusTracker.isFocused) {\n      this._form.saveButtonView.focus();\n    }\n    this._balloon.remove(this._form);\n    if (focusEditable) {\n      this.editor.editing.view.focus();\n    }\n  }\n  /**\n  * Returns `true` when the {@link #_form} is the visible view in the {@link #_balloon}.\n  */\n  get _isVisible() {\n    return !!this._balloon && this._balloon.visibleView === this._form;\n  }\n  /**\n  * Returns `true` when the {@link #_form} is in the {@link #_balloon}.\n  */\n  get _isInBalloon() {\n    return !!this._balloon && this._balloon.hasView(this._form);\n  }\n}\n/**\n * Returns image resize form validation callbacks.\n *\n * @param editor Editor instance.\n */\nfunction getFormValidators(editor) {\n  const t = editor.t;\n  return [form => {\n    if (form.rawSize.trim() === '') {\n      return t('The value must not be empty.');\n    }\n    if (form.parsedSize === null) {\n      return t('The value should be a plain number.');\n    }\n  }];\n}\n\n/**\n * The image resize plugin.\n *\n * It adds a possibility to resize each image using handles.\n */\nclass ImageResize extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageResizeEditing, ImageResizeHandles, ImageCustomResizeUI, ImageResizeButtons];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageResize';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The image style command. It is used to apply {@link module:image/imageconfig~ImageStyleConfig#options image style option}\n * to a selected image.\n *\n * **Note**: Executing this command may change the image model element if the desired style requires an image of a different\n * type. See {@link module:image/imagestyle/imagestylecommand~ImageStyleCommand#execute} to learn more.\n */\nclass ImageStyleCommand extends Command {\n  /**\n  * An object containing names of default style options for the inline and block images.\n  * If there is no default style option for the given image type in the configuration,\n  * the name will be `false`.\n  */\n  _defaultStyles;\n  /**\n  * The styles handled by this command.\n  */\n  _styles;\n  /**\n  * Creates an instance of the image style command. When executed, the command applies one of\n  * {@link module:image/imageconfig~ImageStyleConfig#options style options} to the currently selected image.\n  *\n  * @param editor The editor instance.\n  * @param styles The style options that this command supports.\n  */\n  constructor(editor, styles) {\n    super(editor);\n    this._defaultStyles = {\n      imageBlock: false,\n      imageInline: false\n    };\n    this._styles = new Map(styles.map(style => {\n      if (style.isDefault) {\n        for (const modelElementName of style.modelElements) {\n          this._defaultStyles[modelElementName] = style.name;\n        }\n      }\n      return [style.name, style];\n    }));\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const element = imageUtils.getClosestSelectedImageElement(this.editor.model.document.selection);\n    this.isEnabled = !!element;\n    if (!this.isEnabled) {\n      this.value = false;\n    } else if (element.hasAttribute('imageStyle')) {\n      this.value = element.getAttribute('imageStyle');\n    } else {\n      this.value = this._defaultStyles[element.name];\n    }\n  }\n  /**\n  * Executes the command and applies the style to the currently selected image:\n  *\n  * ```ts\n  * editor.execute( 'imageStyle', { value: 'side' } );\n  * ```\n  *\n  * **Note**: Executing this command may change the image model element if the desired style requires an image\n  * of a different type. Learn more about {@link module:image/imageconfig~ImageStyleOptionDefinition#modelElements model element}\n  * configuration for the style option.\n  *\n  * @param options.value The name of the style (as configured in {@link module:image/imageconfig~ImageStyleConfig#options}).\n  * @param options.setImageSizes Specifies whether the image `width` and `height` attributes should be set automatically.\n  * The default is `true`.\n  * @fires execute\n  */\n  execute(options = {}) {\n    const editor = this.editor;\n    const model = editor.model;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    model.change(writer => {\n      const requestedStyle = options.value;\n      const {\n        setImageSizes = true\n      } = options;\n      let imageElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n      // Change the image type if a style requires it.\n      if (requestedStyle && this.shouldConvertImageType(requestedStyle, imageElement)) {\n        this.editor.execute(imageUtils.isBlockImage(imageElement) ? 'imageTypeInline' : 'imageTypeBlock', {\n          setImageSizes\n        });\n        // Update the imageElement to the newly created image.\n        imageElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n      }\n      // Default style means that there is no `imageStyle` attribute in the model.\n      // https://github.com/ckeditor/ckeditor5-image/issues/147\n      if (!requestedStyle || this._styles.get(requestedStyle).isDefault) {\n        writer.removeAttribute('imageStyle', imageElement);\n      } else {\n        writer.setAttribute('imageStyle', requestedStyle, imageElement);\n      }\n      if (setImageSizes) {\n        imageUtils.setImageNaturalSizeAttributes(imageElement);\n      }\n    });\n  }\n  /**\n  * Returns `true` if requested style change would trigger the image type change.\n  *\n  * @param requestedStyle The name of the style (as configured in {@link module:image/imageconfig~ImageStyleConfig#options}).\n  * @param imageElement The image model element.\n  */\n  shouldConvertImageType(requestedStyle, imageElement) {\n    const supportedTypes = this._styles.get(requestedStyle).modelElements;\n    return !supportedTypes.includes(imageElement.name);\n  }\n}\n\n/**\n * Default image style options provided by the plugin that can be referred in the {@link module:image/imageconfig~ImageConfig#styles}\n * configuration.\n *\n * There are available 5 styles focused on formatting:\n *\n * * **`'alignLeft'`** aligns the inline or block image to the left and wraps it with the text using the `image-style-align-left` class,\n * * **`'alignRight'`** aligns the inline or block image to the right and wraps it with the text using the `image-style-align-right` class,\n * * **`'alignCenter'`** centers the block image using the `image-style-align-center` class,\n * * **`'alignBlockLeft'`** aligns the block image to the left using the `image-style-block-align-left` class,\n * * **`'alignBlockRight'`** aligns the block image to the right using the `image-style-block-align-right` class,\n *\n * and 3 semantic styles:\n *\n * * **`'inline'`** is an inline image without any CSS class,\n * * **`'block'`** is a block image without any CSS class,\n * * **`'side'`** is a block image styled with the `image-style-side` CSS class.\n */\nconst DEFAULT_OPTIONS = {\n  // This style represents an image placed in the line of text.\n  get inline() {\n    return {\n      name: 'inline',\n      title: 'In line',\n      icon: IconObjectInline,\n      modelElements: ['imageInline'],\n      isDefault: true\n    };\n  },\n  // This style represents an image aligned to the left and wrapped with text.\n  get alignLeft() {\n    return {\n      name: 'alignLeft',\n      title: 'Left aligned image',\n      icon: IconObjectInlineLeft,\n      modelElements: ['imageBlock', 'imageInline'],\n      className: 'image-style-align-left'\n    };\n  },\n  // This style represents an image aligned to the left.\n  get alignBlockLeft() {\n    return {\n      name: 'alignBlockLeft',\n      title: 'Left aligned image',\n      icon: IconObjectLeft,\n      modelElements: ['imageBlock'],\n      className: 'image-style-block-align-left'\n    };\n  },\n  // This style represents a centered image.\n  get alignCenter() {\n    return {\n      name: 'alignCenter',\n      title: 'Centered image',\n      icon: IconObjectCenter,\n      modelElements: ['imageBlock'],\n      className: 'image-style-align-center'\n    };\n  },\n  // This style represents an image aligned to the right and wrapped with text.\n  get alignRight() {\n    return {\n      name: 'alignRight',\n      title: 'Right aligned image',\n      icon: IconObjectInlineRight,\n      modelElements: ['imageBlock', 'imageInline'],\n      className: 'image-style-align-right'\n    };\n  },\n  // This style represents an image aligned to the right.\n  get alignBlockRight() {\n    return {\n      name: 'alignBlockRight',\n      title: 'Right aligned image',\n      icon: IconObjectRight,\n      modelElements: ['imageBlock'],\n      className: 'image-style-block-align-right'\n    };\n  },\n  // This option is equal to the situation when no style is applied.\n  get block() {\n    return {\n      name: 'block',\n      title: 'Centered image',\n      icon: IconObjectCenter,\n      modelElements: ['imageBlock'],\n      isDefault: true\n    };\n  },\n  // This represents a side image.\n  get side() {\n    return {\n      name: 'side',\n      title: 'Side image',\n      icon: IconObjectInlineRight,\n      modelElements: ['imageBlock'],\n      className: 'image-style-side'\n    };\n  }\n};\n/**\n * Default image style icons provided by the plugin that can be referred in the {@link module:image/imageconfig~ImageConfig#styles}\n * configuration.\n *\n * See {@link module:image/imageconfig~ImageStyleOptionDefinition#icon} to learn more.\n *\n * There are 7 default icons available: `'full'`, `'left'`, `'inlineLeft'`, `'center'`, `'right'`, `'inlineRight'`, and `'inline'`.\n */\nconst DEFAULT_ICONS = /* #__PURE__ */(() => ({\n  full: IconObjectFullWidth,\n  left: IconObjectLeft,\n  right: IconObjectRight,\n  center: IconObjectCenter,\n  inlineLeft: IconObjectInlineLeft,\n  inlineRight: IconObjectInlineRight,\n  inline: IconObjectInline\n}))();\n/**\n * Default drop-downs provided by the plugin that can be referred in the {@link module:image/imageconfig~ImageConfig#toolbar}\n * configuration. The drop-downs are containers for the {@link module:image/imageconfig~ImageStyleConfig#options image style options}.\n *\n * If both of the `ImageEditing` plugins are loaded, there are 2 predefined drop-downs available:\n *\n * * **`'imageStyle:wrapText'`**, which contains the `alignLeft` and `alignRight` options, that is,\n * those that wraps the text around the image,\n * * **`'imageStyle:breakText'`**, which contains the `alignBlockLeft`, `alignCenter` and `alignBlockRight` options, that is,\n * those that breaks the text around the image.\n */\nconst DEFAULT_DROPDOWN_DEFINITIONS = [{\n  name: 'imageStyle:wrapText',\n  title: 'Wrap text',\n  defaultItem: 'imageStyle:alignLeft',\n  items: ['imageStyle:alignLeft', 'imageStyle:alignRight']\n}, {\n  name: 'imageStyle:breakText',\n  title: 'Break text',\n  defaultItem: 'imageStyle:block',\n  items: ['imageStyle:alignBlockLeft', 'imageStyle:block', 'imageStyle:alignBlockRight']\n}];\n/**\n * Returns a list of the normalized and validated image style options.\n *\n * @param config\n * @param config.isInlinePluginLoaded\n * Determines whether the {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`} plugin has been loaded.\n * @param config.isBlockPluginLoaded\n * Determines whether the {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`} plugin has been loaded.\n * @param config.configuredStyles\n * The image styles configuration provided in the image styles {@link module:image/imageconfig~ImageConfig#styles configuration}\n * as a default or custom value.\n * @returns\n * * Each of options contains a complete icon markup.\n * * The image style options not supported by any of the loaded plugins are filtered out.\n */\nfunction normalizeStyles(config) {\n  const configuredStyles = config.configuredStyles.options || [];\n  const styles = configuredStyles.map(arrangement => normalizeDefinition(arrangement)).filter(arrangement => isValidOption(arrangement, config));\n  return styles;\n}\n/**\n * Returns the default image styles configuration depending on the loaded image editing plugins.\n *\n * @param isInlinePluginLoaded\n * Determines whether the {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`} plugin has been loaded.\n *\n * @param isBlockPluginLoaded\n * Determines whether the {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`} plugin has been loaded.\n *\n * @returns\n * It returns an object with the lists of the image style options and groups defined as strings related to the\n * {@link module:image/imagestyle/utils#DEFAULT_OPTIONS default options}\n */\nfunction getDefaultStylesConfiguration(isBlockPluginLoaded, isInlinePluginLoaded) {\n  if (isBlockPluginLoaded && isInlinePluginLoaded) {\n    return {\n      options: ['inline', 'alignLeft', 'alignRight', 'alignCenter', 'alignBlockLeft', 'alignBlockRight', 'block', 'side']\n    };\n  } else if (isBlockPluginLoaded) {\n    return {\n      options: ['block', 'side']\n    };\n  } else if (isInlinePluginLoaded) {\n    return {\n      options: ['inline', 'alignLeft', 'alignRight']\n    };\n  }\n  return {};\n}\n/**\n * Returns a list of the available predefined drop-downs' definitions depending on the loaded image editing plugins.\n */\nfunction getDefaultDropdownDefinitions(pluginCollection) {\n  if (pluginCollection.has('ImageBlockEditing') && pluginCollection.has('ImageInlineEditing')) {\n    return [...DEFAULT_DROPDOWN_DEFINITIONS];\n  } else {\n    return [];\n  }\n}\n/**\n * Normalizes an image style option or group provided in the {@link module:image/imageconfig~ImageConfig#styles}\n * and returns it in a {@link module:image/imageconfig~ImageStyleOptionDefinition}/\n */\nfunction normalizeDefinition(definition) {\n  if (typeof definition === 'string') {\n    // Just the name of the style has been passed, but none of the defaults.\n    if (!DEFAULT_OPTIONS[definition]) {\n      // Normalize the style anyway to prevent errors.\n      definition = {\n        name: definition\n      };\n    } else {\n      definition = {\n        ...DEFAULT_OPTIONS[definition]\n      };\n    }\n  } else {\n    // If an object style has been passed and if the name matches one of the defaults,\n    // extend it with defaults â€“ the user wants to customize a default style.\n    // Note: Don't override the userâ€“defined style object, clone it instead.\n    definition = extendStyle(DEFAULT_OPTIONS[definition.name], definition);\n  }\n  // If an icon is defined as a string and correspond with a name\n  // in default icons, use the default icon provided by the plugin.\n  if (typeof definition.icon === 'string') {\n    definition.icon = DEFAULT_ICONS[definition.icon] || definition.icon;\n  }\n  return definition;\n}\n/**\n * Checks if the image style option is valid:\n * * if it has the modelElements fields defined and filled,\n * * if the defined modelElements are supported by any of the loaded image editing plugins.\n * It also displays a console warning these conditions are not met.\n *\n * @param option image style option\n */\nfunction isValidOption(option, {\n  isBlockPluginLoaded,\n  isInlinePluginLoaded\n}) {\n  const {\n    modelElements,\n    name\n  } = option;\n  if (!modelElements || !modelElements.length || !name) {\n    warnInvalidStyle({\n      style: option\n    });\n    return false;\n  } else {\n    const supportedElements = [isBlockPluginLoaded ? 'imageBlock' : null, isInlinePluginLoaded ? 'imageInline' : null];\n    // Check if the option is supported by any of the loaded plugins.\n    if (!modelElements.some(elementName => supportedElements.includes(elementName))) {\n      /**\n      * In order to work correctly, each image style {@link module:image/imageconfig~ImageStyleOptionDefinition option}\n      * requires specific model elements (also: types of images) to be supported by the editor.\n      *\n      * Model element names to which the image style option can be applied are defined in the\n      * {@link module:image/imageconfig~ImageStyleOptionDefinition#modelElements} property of the style option\n      * definition.\n      *\n      * Explore the warning in the console to find out precisely which option is not supported and which editor plugins\n      * are missing. Make sure these plugins are loaded in your editor to get this image style option working.\n      *\n      * @error image-style-missing-dependency\n      * @param {String} [option] The name of the unsupported option.\n      * @param {String} [missingPlugins] The names of the plugins one of which has to be loaded for the particular option.\n      */\n      logWarning('image-style-missing-dependency', {\n        style: option,\n        missingPlugins: modelElements.map(name => name === 'imageBlock' ? 'ImageBlockEditing' : 'ImageInlineEditing')\n      });\n      return false;\n    }\n  }\n  return true;\n}\n/**\n * Extends the default style with a style provided by the developer.\n * Note: Don't override the customâ€“defined style object, clone it instead.\n */\nfunction extendStyle(source, style) {\n  const extendedStyle = {\n    ...style\n  };\n  for (const prop in source) {\n    if (!Object.prototype.hasOwnProperty.call(style, prop)) {\n      extendedStyle[prop] = source[prop];\n    }\n  }\n  return extendedStyle;\n}\n/**\n * Displays a console warning with the 'image-style-configuration-definition-invalid' error.\n */\nfunction warnInvalidStyle(info) {\n  /**\n  * The image style definition provided in the configuration is invalid.\n  *\n  * Please make sure the definition implements properly one of the following:\n  *\n  * * {@link module:image/imageconfig~ImageStyleOptionDefinition image style option definition},\n  * * {@link module:image/imageconfig~ImageStyleDropdownDefinition image style dropdown definition}\n  *\n  * @error image-style-configuration-definition-invalid\n  * @param {String} [dropdown] The name of the invalid drop-down\n  * @param {String} [style] The name of the invalid image style option\n  */\n  logWarning('image-style-configuration-definition-invalid', info);\n}\nvar utils = {\n  normalizeStyles,\n  getDefaultStylesConfiguration,\n  getDefaultDropdownDefinitions,\n  warnInvalidStyle,\n  DEFAULT_OPTIONS,\n  DEFAULT_ICONS,\n  DEFAULT_DROPDOWN_DEFINITIONS\n};\n\n/**\n * @module image/imagestyle/converters\n */ /**\n    * Returns a converter for the `imageStyle` attribute. It can be used for adding, changing and removing the attribute.\n    *\n    * @param styles An array containing available image style options.\n    * @returns A model-to-view attribute converter.\n    */\nfunction modelToViewStyleAttribute(styles) {\n  return (evt, data, conversionApi) => {\n    if (!conversionApi.consumable.consume(data.item, evt.name)) {\n      return;\n    }\n    // Check if there is class name associated with given value.\n    const newStyle = getStyleDefinitionByName(data.attributeNewValue, styles);\n    const oldStyle = getStyleDefinitionByName(data.attributeOldValue, styles);\n    const viewElement = conversionApi.mapper.toViewElement(data.item);\n    const viewWriter = conversionApi.writer;\n    if (oldStyle) {\n      viewWriter.removeClass(oldStyle.className, viewElement);\n    }\n    if (newStyle) {\n      viewWriter.addClass(newStyle.className, viewElement);\n    }\n  };\n}\n/**\n * Returns a view-to-model converter converting image CSS classes to a proper value in the model.\n *\n * @param styles Image style options for which the converter is created.\n * @returns A view-to-model converter.\n */\nfunction viewToModelStyleAttribute(styles) {\n  // Convert only nonâ€“default styles.\n  const nonDefaultStyles = {\n    imageInline: styles.filter(style => !style.isDefault && style.modelElements.includes('imageInline')),\n    imageBlock: styles.filter(style => !style.isDefault && style.modelElements.includes('imageBlock'))\n  };\n  return (evt, data, conversionApi) => {\n    if (!data.modelRange) {\n      return;\n    }\n    const viewElement = data.viewItem;\n    const modelImageElement = first(data.modelRange.getItems());\n    // Run this converter only if an image has been found in the model.\n    // In some cases it may not be found (for example if we run this on a figure with different type than image).\n    if (!modelImageElement) {\n      return;\n    }\n    // ...and the `imageStyle` attribute is allowed for that element, otherwise stop conversion early.\n    if (!conversionApi.schema.checkAttribute(modelImageElement, 'imageStyle')) {\n      return;\n    }\n    // Convert styles one by one.\n    for (const style of nonDefaultStyles[modelImageElement.name]) {\n      // Try to consume class corresponding with the style.\n      if (conversionApi.consumable.consume(viewElement, {\n        classes: style.className\n      })) {\n        // And convert this style to model attribute.\n        conversionApi.writer.setAttribute('imageStyle', style.name, modelImageElement);\n      }\n    }\n  };\n}\n/**\n * Returns the style with a given `name` from an array of styles.\n */\nfunction getStyleDefinitionByName(name, styles) {\n  for (const style of styles) {\n    if (style.name === name) {\n      return style;\n    }\n  }\n}\n\n/**\n * The image style engine plugin. It sets the default configuration, creates converters and registers\n * {@link module:image/imagestyle/imagestylecommand~ImageStyleCommand ImageStyleCommand}.\n */\nclass ImageStyleEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageStyleEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageUtils];\n  }\n  /**\n  * It contains a list of the normalized and validated style options.\n  *\n  * * Each option contains a complete icon markup.\n  * * The style options not supported by any of the loaded image editing plugins (\n  * {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`} or\n  * {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`}) are filtered out.\n  *\n  * @internal\n  * @readonly\n  */\n  normalizedStyles;\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const {\n      normalizeStyles,\n      getDefaultStylesConfiguration\n    } = utils;\n    const editor = this.editor;\n    const isBlockPluginLoaded = editor.plugins.has('ImageBlockEditing');\n    const isInlinePluginLoaded = editor.plugins.has('ImageInlineEditing');\n    editor.config.define('image.styles', getDefaultStylesConfiguration(isBlockPluginLoaded, isInlinePluginLoaded));\n    this.normalizedStyles = normalizeStyles({\n      configuredStyles: editor.config.get('image.styles'),\n      isBlockPluginLoaded,\n      isInlinePluginLoaded\n    });\n    this._setupConversion(isBlockPluginLoaded, isInlinePluginLoaded);\n    this._setupPostFixer();\n    // Register imageStyle command.\n    editor.commands.add('imageStyle', new ImageStyleCommand(editor, this.normalizedStyles));\n  }\n  /**\n  * Sets the editor conversion taking the presence of\n  * {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`}\n  * and {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`} plugins into consideration.\n  */\n  _setupConversion(isBlockPluginLoaded, isInlinePluginLoaded) {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const modelToViewConverter = modelToViewStyleAttribute(this.normalizedStyles);\n    const viewToModelConverter = viewToModelStyleAttribute(this.normalizedStyles);\n    editor.editing.downcastDispatcher.on('attribute:imageStyle', modelToViewConverter);\n    editor.data.downcastDispatcher.on('attribute:imageStyle', modelToViewConverter);\n    // Allow imageStyle attribute in image and imageInline.\n    // We could call it 'style' but https://github.com/ckeditor/ckeditor5-engine/issues/559.\n    if (isBlockPluginLoaded) {\n      schema.extend('imageBlock', {\n        allowAttributes: 'imageStyle'\n      });\n      // Converter for figure element from view to model.\n      editor.data.upcastDispatcher.on('element:figure', viewToModelConverter, {\n        priority: 'low'\n      });\n    }\n    if (isInlinePluginLoaded) {\n      schema.extend('imageInline', {\n        allowAttributes: 'imageStyle'\n      });\n      // Converter for the img element from view to model.\n      editor.data.upcastDispatcher.on('element:img', viewToModelConverter, {\n        priority: 'low'\n      });\n    }\n  }\n  /**\n  * Registers a post-fixer that will make sure that the style attribute value is correct for a specific image type (block vs inline).\n  */\n  _setupPostFixer() {\n    const editor = this.editor;\n    const document = editor.model.document;\n    const imageUtils = editor.plugins.get(ImageUtils);\n    const stylesMap = new Map(this.normalizedStyles.map(style => [style.name, style]));\n    // Make sure that style attribute is valid for the image type.\n    document.registerPostFixer(writer => {\n      let changed = false;\n      for (const change of document.differ.getChanges()) {\n        if (change.type == 'insert' || change.type == 'attribute' && change.attributeKey == 'imageStyle') {\n          let element = change.type == 'insert' ? change.position.nodeAfter : change.range.start.nodeAfter;\n          if (element && element.is('element', 'paragraph') && element.childCount > 0) {\n            element = element.getChild(0);\n          }\n          if (!imageUtils.isImage(element)) {\n            continue;\n          }\n          const imageStyle = element.getAttribute('imageStyle');\n          if (!imageStyle) {\n            continue;\n          }\n          const imageStyleDefinition = stylesMap.get(imageStyle);\n          if (!imageStyleDefinition || !imageStyleDefinition.modelElements.includes(element.name)) {\n            writer.removeAttribute('imageStyle', element);\n            changed = true;\n          }\n        }\n      }\n      return changed;\n    });\n  }\n}\n\n/**\n * The image style UI plugin.\n *\n * It registers buttons corresponding to the {@link module:image/imageconfig~ImageConfig#styles} configuration.\n * It also registers the {@link module:image/imagestyle/utils#DEFAULT_DROPDOWN_DEFINITIONS default drop-downs} and the\n * custom drop-downs defined by the developer in the {@link module:image/imageconfig~ImageConfig#toolbar} configuration.\n */\nclass ImageStyleUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageStyleEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageStyleUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * Returns the default localized style titles provided by the plugin.\n  *\n  * The following localized titles corresponding with\n  * {@link module:image/imagestyle/utils#DEFAULT_OPTIONS} are available:\n  *\n  * * `'Wrap text'`,\n  * * `'Break text'`,\n  * * `'In line'`,\n  * * `'Full size image'`,\n  * * `'Side image'`,\n  * * `'Left aligned image'`,\n  * * `'Centered image'`,\n  * * `'Right aligned image'`\n  */\n  get localizedDefaultStylesTitles() {\n    const t = this.editor.t;\n    return {\n      'Wrap text': t('Wrap text'),\n      'Break text': t('Break text'),\n      'In line': t('In line'),\n      'Full size image': t('Full size image'),\n      'Side image': t('Side image'),\n      'Left aligned image': t('Left aligned image'),\n      'Centered image': t('Centered image'),\n      'Right aligned image': t('Right aligned image')\n    };\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const plugins = this.editor.plugins;\n    const toolbarConfig = this.editor.config.get('image.toolbar') || [];\n    const imageStyleEditing = plugins.get('ImageStyleEditing');\n    const definedStyles = translateStyles(imageStyleEditing.normalizedStyles, this.localizedDefaultStylesTitles);\n    for (const styleConfig of definedStyles) {\n      this._createButton(styleConfig);\n    }\n    const definedDropdowns = translateStyles([...toolbarConfig.filter(isObject), ...utils.getDefaultDropdownDefinitions(plugins)], this.localizedDefaultStylesTitles);\n    for (const dropdownConfig of definedDropdowns) {\n      this._createDropdown(dropdownConfig, definedStyles);\n    }\n  }\n  /**\n  * Creates a dropdown and stores it in the editor {@link module:ui/componentfactory~ComponentFactory}.\n  */\n  _createDropdown(dropdownConfig, definedStyles) {\n    const factory = this.editor.ui.componentFactory;\n    factory.add(dropdownConfig.name, locale => {\n      let defaultButton;\n      const {\n        defaultItem,\n        items,\n        title\n      } = dropdownConfig;\n      const buttonViews = items.filter(itemName => definedStyles.find(({\n        name\n      }) => getUIComponentName(name) === itemName)).map(buttonName => {\n        const button = factory.create(buttonName);\n        if (buttonName === defaultItem) {\n          defaultButton = button;\n        }\n        return button;\n      });\n      if (items.length !== buttonViews.length) {\n        utils.warnInvalidStyle({\n          dropdown: dropdownConfig\n        });\n      }\n      const dropdownView = createDropdown(locale, SplitButtonView);\n      const splitButtonView = dropdownView.buttonView;\n      const splitButtonViewArrow = splitButtonView.arrowView;\n      addToolbarToDropdown(dropdownView, buttonViews, {\n        enableActiveItemFocusOnDropdownOpen: true\n      });\n      splitButtonView.set({\n        label: getDropdownButtonTitle(title, defaultButton.label),\n        class: null,\n        tooltip: true\n      });\n      splitButtonViewArrow.unbind('label');\n      splitButtonViewArrow.set({\n        label: title\n      });\n      splitButtonView.bind('icon').toMany(buttonViews, 'isOn', (...areOn) => {\n        const index = areOn.findIndex(identity);\n        return index < 0 ? defaultButton.icon : buttonViews[index].icon;\n      });\n      splitButtonView.bind('label').toMany(buttonViews, 'isOn', (...areOn) => {\n        const index = areOn.findIndex(identity);\n        return getDropdownButtonTitle(title, index < 0 ? defaultButton.label : buttonViews[index].label);\n      });\n      splitButtonView.bind('isOn').toMany(buttonViews, 'isOn', (...areOn) => areOn.some(identity));\n      splitButtonView.bind('class').toMany(buttonViews, 'isOn', (...areOn) => areOn.some(identity) ? 'ck-splitbutton_flatten' : undefined);\n      splitButtonView.on('execute', () => {\n        if (!buttonViews.some(({\n          isOn\n        }) => isOn)) {\n          defaultButton.fire('execute');\n        } else {\n          dropdownView.isOpen = !dropdownView.isOpen;\n        }\n      });\n      dropdownView.bind('isEnabled').toMany(buttonViews, 'isEnabled', (...areEnabled) => areEnabled.some(identity));\n      // Focus the editable after executing the command.\n      // Overrides a default behaviour where the focus is moved to the dropdown button (#12125).\n      this.listenTo(dropdownView, 'execute', () => {\n        this.editor.editing.view.focus();\n      });\n      return dropdownView;\n    });\n  }\n  /**\n  * Creates a button and stores it in the editor {@link module:ui/componentfactory~ComponentFactory}.\n  */\n  _createButton(buttonConfig) {\n    const buttonName = buttonConfig.name;\n    this.editor.ui.componentFactory.add(getUIComponentName(buttonName), locale => {\n      const command = this.editor.commands.get('imageStyle');\n      const view = new ButtonView(locale);\n      view.set({\n        label: buttonConfig.title,\n        icon: buttonConfig.icon,\n        tooltip: true,\n        isToggleable: true\n      });\n      view.bind('isEnabled').to(command, 'isEnabled');\n      view.bind('isOn').to(command, 'value', value => value === buttonName);\n      view.on('execute', this._executeCommand.bind(this, buttonName));\n      return view;\n    });\n  }\n  _executeCommand(name) {\n    this.editor.execute('imageStyle', {\n      value: name\n    });\n    this.editor.editing.view.focus();\n  }\n}\n/**\n * Returns the translated `title` from the passed styles array.\n */\nfunction translateStyles(styles, titles) {\n  for (const style of styles) {\n    // Localize the titles of the styles, if a title corresponds with\n    // a localized default provided by the plugin.\n    if (titles[style.title]) {\n      style.title = titles[style.title];\n    }\n  }\n  return styles;\n}\n/**\n * Returns the image style component name with the \"imageStyle:\" prefix.\n */\nfunction getUIComponentName(name) {\n  return `imageStyle:${name}`;\n}\n/**\n * Returns title for the splitbutton containing the dropdown title and default action item title.\n */\nfunction getDropdownButtonTitle(dropdownTitle, buttonTitle) {\n  return (dropdownTitle ? dropdownTitle + ': ' : '') + buttonTitle;\n}\n\n/**\n * The image style plugin.\n *\n * For a detailed overview of the image styles feature, check the {@glink features/images/images-styles documentation}.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n * * {@link module:image/imagestyle/imagestyleediting~ImageStyleEditing},\n * * {@link module:image/imagestyle/imagestyleui~ImageStyleUI}\n *\n * It provides a default configuration, which can be extended or overwritten.\n * Read more about the {@link module:image/imageconfig~ImageConfig#styles image styles configuration}.\n */\nclass ImageStyle extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageStyleEditing, ImageStyleUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageStyle';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The image toolbar plugin. It creates and manages the image toolbar (the toolbar displayed when an image is selected).\n *\n * For an overview, check the {@glink features/images/images-overview#image-contextual-toolbar image contextual toolbar} documentation.\n *\n * Instances of toolbar components (e.g. buttons) are created using the editor's\n * {@link module:ui/componentfactory~ComponentFactory component factory}\n * based on the {@link module:image/imageconfig~ImageConfig#toolbar `image.toolbar` configuration option}.\n *\n * The toolbar uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon}.\n */\nclass ImageToolbar extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [WidgetToolbarRepository, ImageUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ImageToolbar';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    const t = editor.t;\n    const widgetToolbarRepository = editor.plugins.get(WidgetToolbarRepository);\n    const imageUtils = editor.plugins.get('ImageUtils');\n    widgetToolbarRepository.register('image', {\n      ariaLabel: t('Image toolbar'),\n      items: normalizeDeclarativeConfig(editor.config.get('image.toolbar') || []),\n      getRelatedElement: selection => imageUtils.getClosestSelectedImageWidget(selection)\n    });\n  }\n}\n/**\n * Convert the dropdown definitions to their keys registered in the ComponentFactory.\n * The registration precess should be handled by the plugin which handles the UI of a particular feature.\n */\nfunction normalizeDeclarativeConfig(config) {\n  return config.map(item => isObject(item) ? item.name : item);\n}\n\n/**\n * This plugin enables the [`<picture>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture) element support in the editor.\n *\n * * It enables the `sources` model attribute on `imageBlock` and `imageInline` model elements\n * (brought by {@link module:image/imageblock~ImageBlock} and {@link module:image/imageinline~ImageInline}, respectively).\n * * It translates the `sources` model element to the view (also: data) structure that may look as follows:\n *\n * ```html\n * <p>Inline image using picture:\n * \t<picture>\n * \t\t<source media=\"(min-width: 800px)\" srcset=\"image-large.webp\" type=\"image/webp\">\n * \t\t<source media=\"(max-width: 800px)\" srcset=\"image-small.webp\" type=\"image/webp\">\n * \t\t<!-- Other sources as specified in the \"sources\" model attribute... -->\n * \t\t<img src=\"image.png\" alt=\"An image using picture\" />\n * \t</picture>\n * </p>\n *\n * <p>Block image using picture:</p>\n * <figure class=\"image\">\n * \t<picture>\n * \t\t<source media=\"(min-width: 800px)\" srcset=\"image-large.webp\" type=\"image/webp\">\n * \t\t<source media=\"(max-width: 800px)\" srcset=\"image-small.webp\" type=\"image/webp\">\n * \t\t<!-- Other sources as specified in the \"sources\" model attribute... -->\n * \t\t<img src=\"image.png\" alt=\"An image using picture\" />\n * \t</picture>\n * \t<figcaption>Caption of the image</figcaption>\n * </figure>\n * ```\n *\n * **Note:** The value of the `sources` {@glink framework/architecture/editing-engine#changing-the-model model attribute}\n * in both examples equals:\n *\n * ```css\n * [\n * \t{\n * \t\tmedia: '(min-width: 800px)',\n * \t\tsrcset: 'image-large.webp',\n * \t\ttype: 'image/webp'\n * \t},\n * \t{\n * \t\tmedia: '(max-width: 800px)',\n * \t\tsrcset: 'image-small.webp',\n * \t\ttype: 'image/webp'\n * \t}\n * ]\n * ```\n *\n * * It integrates with the {@link module:image/imageupload~ImageUpload} plugin so images uploaded in the editor\n * automatically render using `<picture>` if the {@glink features/images/image-upload/image-upload upload adapter}\n * supports image sources and provides neccessary data.\n *\n * @private\n */\nclass PictureEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ImageEditing, ImageUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'PictureEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    if (editor.plugins.has('ImageBlockEditing')) {\n      editor.model.schema.extend('imageBlock', {\n        allowAttributes: ['sources']\n      });\n    }\n    if (editor.plugins.has('ImageInlineEditing')) {\n      editor.model.schema.extend('imageInline', {\n        allowAttributes: ['sources']\n      });\n    }\n    this._setupConversion();\n    this._setupImageUploadEditingIntegration();\n  }\n  /**\n  * Configures conversion pipelines to support upcasting and downcasting images using the `<picture>` view element\n  * and the model `sources` attribute.\n  */\n  _setupConversion() {\n    const editor = this.editor;\n    const conversion = editor.conversion;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    conversion.for('upcast').add(upcastPicture(imageUtils));\n    conversion.for('downcast').add(downcastSourcesAttribute(imageUtils));\n  }\n  /**\n  * Makes it possible for uploaded images to get the `sources` model attribute and the `<picture>...</picture>`\n  * view structure out-of-the-box if relevant data is provided along the\n  * {@link module:image/imageupload/imageuploadediting~ImageUploadEditing#event:uploadComplete} event.\n  */\n  _setupImageUploadEditingIntegration() {\n    const editor = this.editor;\n    if (!editor.plugins.has('ImageUploadEditing')) {\n      return;\n    }\n    const imageUploadEditing = editor.plugins.get('ImageUploadEditing');\n    this.listenTo(imageUploadEditing, 'uploadComplete', (evt, {\n      imageElement,\n      data\n    }) => {\n      const sources = data.sources;\n      if (!sources) {\n        return;\n      }\n      editor.model.change(writer => {\n        writer.setAttributes({\n          sources\n        }, imageElement);\n      });\n    });\n  }\n}\nexport { AutoImage, Image, ImageBlock, ImageBlockEditing, ImageCaption, ImageCaptionEditing, ImageCaptionUI, ImageCaptionUtils, ImageCustomResizeUI, ImageEditing, ImageInline, ImageInsert, ImageInsertUI, ImageInsertViaUrl, ImageResize, ImageResizeButtons, ImageResizeEditing, ImageResizeHandles, ImageSizeAttributes, ImageStyle, ImageStyleEditing, ImageStyleUI, ImageTextAlternative, ImageTextAlternativeEditing, ImageTextAlternativeUI, ImageToolbar, ImageUpload, ImageUploadEditing, ImageUploadProgress, ImageUploadUI, ImageUtils, PictureEditing, createImageTypeRegExp };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, MultiCommand, Command } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconIndent, IconOutdent } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { addMarginRules } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { first } from '@ckeditor/ckeditor5-utils/dist/index.js';\n\n/**\n * The indent editing feature.\n *\n * This plugin registers the `'indent'` and `'outdent'` commands.\n *\n * **Note**: In order for the commands to work, at least one of the compatible features is required. Read more in the\n * {@link module:indent/indent~Indent indent feature} API documentation.\n */\nclass IndentEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'IndentEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.commands.add('indent', new MultiCommand(editor));\n    editor.commands.add('outdent', new MultiCommand(editor));\n  }\n}\n\n/**\n * The indent UI feature.\n *\n * This plugin registers the `'indent'` and `'outdent'` buttons.\n *\n * **Note**: In order for the commands to work, at least one of the compatible features is required. Read more in\n * the {@link module:indent/indent~Indent indent feature} API documentation.\n */\nclass IndentUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'IndentUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const t = editor.t;\n    const localizedIndentIcon = locale.uiLanguageDirection == 'ltr' ? IconIndent : IconOutdent;\n    const localizedOutdentIcon = locale.uiLanguageDirection == 'ltr' ? IconOutdent : IconIndent;\n    this._defineButton('indent', t('Increase indent'), localizedIndentIcon);\n    this._defineButton('outdent', t('Decrease indent'), localizedOutdentIcon);\n  }\n  /**\n  * Defines UI buttons for both toolbar and menu bar.\n  */\n  _defineButton(commandName, label, icon) {\n    const editor = this.editor;\n    editor.ui.componentFactory.add(commandName, () => {\n      const buttonView = this._createButton(ButtonView, commandName, label, icon);\n      buttonView.set({\n        tooltip: true\n      });\n      return buttonView;\n    });\n    editor.ui.componentFactory.add('menuBar:' + commandName, () => {\n      return this._createButton(MenuBarMenuListItemButtonView, commandName, label, icon);\n    });\n  }\n  /**\n  * Creates a button to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass, commandName, label, icon) {\n    const editor = this.editor;\n    const command = editor.commands.get(commandName);\n    const view = new ButtonClass(editor.locale);\n    view.set({\n      label,\n      icon\n    });\n    view.bind('isEnabled').to(command, 'isEnabled');\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.execute(commandName);\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n}\n\n/**\n * The indent feature.\n *\n * This plugin acts as a single entry point plugin for other features that implement indentation of elements like lists or paragraphs.\n *\n * The compatible features are:\n *\n * * The {@link module:list/list~List} or {@link module:list/list/listediting~ListEditing} feature for list indentation.\n * * The {@link module:indent/indentblock~IndentBlock} feature for block indentation.\n *\n * This is a \"glue\" plugin that loads the following plugins:\n *\n * * The {@link module:indent/indentediting~IndentEditing indent editing feature}.\n * * The {@link module:indent/indentui~IndentUI indent UI feature}.\n *\n * The dependent plugins register the `'indent'` and `'outdent'` commands and introduce the `'indent'` and `'outdent'` buttons\n * that allow to increase or decrease text indentation of supported elements.\n *\n * **Note**: In order for the commands and buttons to work, at least one of compatible features is required.\n */\nclass Indent extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Indent';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [IndentEditing, IndentUI];\n  }\n}\n\n/**\n * The indent block command.\n *\n * The command is registered by the {@link module:indent/indentblock~IndentBlock} as `'indentBlock'` for indenting blocks and\n * `'outdentBlock'` for outdenting blocks.\n *\n * To increase block indentation at the current selection, execute the command:\n *\n * ```ts\n * editor.execute( 'indentBlock' );\n * ```\n *\n * To decrease block indentation at the current selection, execute the command:\n *\n * ```ts\n * editor.execute( 'outdentBlock' );\n * ```\n */\nclass IndentBlockCommand extends Command {\n  /**\n  * The command's indentation behavior.\n  */\n  _indentBehavior;\n  /**\n  * Creates an instance of the command.\n  */\n  constructor(editor, indentBehavior) {\n    super(editor);\n    this._indentBehavior = indentBehavior;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const model = editor.model;\n    const block = first(model.document.selection.getSelectedBlocks());\n    if (!block || !this._isIndentationChangeAllowed(block)) {\n      this.isEnabled = false;\n      return;\n    }\n    this.isEnabled = this._indentBehavior.checkEnabled(block.getAttribute('blockIndent'));\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const model = this.editor.model;\n    const blocksToChange = this._getBlocksToChange();\n    model.change(writer => {\n      for (const block of blocksToChange) {\n        const currentIndent = block.getAttribute('blockIndent');\n        const nextIndent = this._indentBehavior.getNextIndent(currentIndent);\n        if (nextIndent) {\n          writer.setAttribute('blockIndent', nextIndent, block);\n        } else {\n          writer.removeAttribute('blockIndent', block);\n        }\n      }\n    });\n  }\n  /**\n  * Returns blocks from selection that should have blockIndent selection set.\n  */\n  _getBlocksToChange() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const blocksInSelection = Array.from(selection.getSelectedBlocks());\n    return blocksInSelection.filter(block => this._isIndentationChangeAllowed(block));\n  }\n  /**\n  * Returns false if indentation cannot be applied, i.e.:\n  * - for blocks disallowed by schema declaration\n  * - for blocks in Document Lists (disallowed forward indentation only). See https://github.com/ckeditor/ckeditor5/issues/14155.\n  * Otherwise returns true.\n  */\n  _isIndentationChangeAllowed(element) {\n    const editor = this.editor;\n    if (!editor.model.schema.checkAttribute(element, 'blockIndent')) {\n      return false;\n    }\n    if (!editor.plugins.has('ListUtils')) {\n      return true;\n    }\n    // Only forward indentation is disallowed in list items. This allows the user to outdent blocks that are already indented.\n    if (!this._indentBehavior.isForward) {\n      return true;\n    }\n    const documentListUtils = editor.plugins.get('ListUtils');\n    return !documentListUtils.isListItemBlock(element);\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module indent/indentcommandbehavior/indentusingoffset\n    */ /**\n       * The block indentation behavior that uses offsets to set indentation.\n       */\nclass IndentUsingOffset {\n  /**\n  * The direction of indentation.\n  */\n  isForward;\n  /**\n  * The offset of the next indentation step.\n  */\n  offset;\n  /**\n  * Indentation unit.\n  */\n  unit;\n  /**\n  * Creates an instance of the indentation behavior.\n  *\n  * @param config.direction The direction of indentation.\n  * @param config.offset The offset of the next indentation step.\n  * @param config.unit Indentation unit.\n  */\n  constructor(config) {\n    this.isForward = config.direction === 'forward';\n    this.offset = config.offset;\n    this.unit = config.unit;\n  }\n  /**\n  * @inheritDoc\n  */\n  checkEnabled(indentAttributeValue) {\n    const currentOffset = parseFloat(indentAttributeValue || '0');\n    // The command is always enabled for forward indentation.\n    return this.isForward || currentOffset > 0;\n  }\n  /**\n  * @inheritDoc\n  */\n  getNextIndent(indentAttributeValue) {\n    const currentOffset = parseFloat(indentAttributeValue || '0');\n    const isSameUnit = !indentAttributeValue || indentAttributeValue.endsWith(this.unit);\n    if (!isSameUnit) {\n      return this.isForward ? this.offset + this.unit : undefined;\n    }\n    const nextOffset = this.isForward ? this.offset : -this.offset;\n    const offsetToSet = currentOffset + nextOffset;\n    return offsetToSet > 0 ? offsetToSet + this.unit : undefined;\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module indent/indentcommandbehavior/indentusingclasses\n    */ /**\n       * The block indentation behavior that uses classes to set indentation.\n       */\nclass IndentUsingClasses {\n  /**\n  * The direction of indentation.\n  */\n  isForward;\n  /**\n  * A list of classes used for indentation.\n  */\n  classes;\n  /**\n  * Creates an instance of the indentation behavior.\n  *\n  * @param config.direction The direction of indentation.\n  * @param config.classes A list of classes used for indentation.\n  */\n  constructor(config) {\n    this.isForward = config.direction === 'forward';\n    this.classes = config.classes;\n  }\n  /**\n  * @inheritDoc\n  */\n  checkEnabled(indentAttributeValue) {\n    const currentIndex = this.classes.indexOf(indentAttributeValue);\n    if (this.isForward) {\n      return currentIndex < this.classes.length - 1;\n    } else {\n      return currentIndex >= 0;\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  getNextIndent(indentAttributeValue) {\n    const currentIndex = this.classes.indexOf(indentAttributeValue);\n    const indexStep = this.isForward ? 1 : -1;\n    return this.classes[currentIndex + indexStep];\n  }\n}\nconst DEFAULT_ELEMENTS = ['paragraph', 'heading1', 'heading2', 'heading3', 'heading4', 'heading5', 'heading6'];\n/**\n * The block indentation feature.\n *\n * It registers the `'indentBlock'` and `'outdentBlock'` commands.\n *\n * If the plugin {@link module:indent/indent~Indent} is defined, it also attaches the `'indentBlock'` and `'outdentBlock'` commands to\n * the `'indent'` and `'outdent'` commands.\n */\nclass IndentBlock extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('indentBlock', {\n      offset: 40,\n      unit: 'px'\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'IndentBlock';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const configuration = editor.config.get('indentBlock');\n    if (configuration.classes && configuration.classes.length) {\n      this._setupConversionUsingClasses(configuration.classes);\n      editor.commands.add('indentBlock', new IndentBlockCommand(editor, new IndentUsingClasses({\n        direction: 'forward',\n        classes: configuration.classes\n      })));\n      editor.commands.add('outdentBlock', new IndentBlockCommand(editor, new IndentUsingClasses({\n        direction: 'backward',\n        classes: configuration.classes\n      })));\n    } else {\n      editor.data.addStyleProcessorRules(addMarginRules);\n      this._setupConversionUsingOffset();\n      editor.commands.add('indentBlock', new IndentBlockCommand(editor, new IndentUsingOffset({\n        direction: 'forward',\n        offset: configuration.offset,\n        unit: configuration.unit\n      })));\n      editor.commands.add('outdentBlock', new IndentBlockCommand(editor, new IndentUsingOffset({\n        direction: 'backward',\n        offset: configuration.offset,\n        unit: configuration.unit\n      })));\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const indentCommand = editor.commands.get('indent');\n    const outdentCommand = editor.commands.get('outdent');\n    // Enable block indentation to heading configuration options. If it is not defined enable in paragraph and default headings.\n    const options = editor.config.get('heading.options');\n    const configuredElements = options && options.map(option => option.model);\n    const knownElements = configuredElements || DEFAULT_ELEMENTS;\n    knownElements.forEach(elementName => {\n      if (schema.isRegistered(elementName)) {\n        schema.extend(elementName, {\n          allowAttributes: 'blockIndent'\n        });\n      }\n    });\n    schema.setAttributeProperties('blockIndent', {\n      isFormatting: true\n    });\n    indentCommand.registerChildCommand(editor.commands.get('indentBlock'));\n    outdentCommand.registerChildCommand(editor.commands.get('outdentBlock'));\n  }\n  /**\n  * Setups conversion for using offset indents.\n  */\n  _setupConversionUsingOffset() {\n    const conversion = this.editor.conversion;\n    const locale = this.editor.locale;\n    const marginProperty = locale.contentLanguageDirection === 'rtl' ? 'margin-right' : 'margin-left';\n    conversion.for('upcast').attributeToAttribute({\n      view: {\n        styles: {\n          [marginProperty]: /[\\s\\S]+/\n        }\n      },\n      model: {\n        key: 'blockIndent',\n        value: viewElement => {\n          // Do not indent block elements in Document Lists. See https://github.com/ckeditor/ckeditor5/issues/12466.\n          if (!viewElement.is('element', 'li')) {\n            return viewElement.getStyle(marginProperty);\n          }\n        }\n      }\n    });\n    conversion.for('downcast').attributeToAttribute({\n      model: 'blockIndent',\n      view: modelAttributeValue => {\n        return {\n          key: 'style',\n          value: {\n            [marginProperty]: modelAttributeValue\n          }\n        };\n      }\n    });\n  }\n  /**\n  * Setups conversion for using classes.\n  */\n  _setupConversionUsingClasses(classes) {\n    const definition = {\n      model: {\n        key: 'blockIndent',\n        values: []\n      },\n      view: {}\n    };\n    for (const className of classes) {\n      definition.model.values.push(className);\n      definition.view[className] = {\n        key: 'class',\n        value: [className]\n      };\n    }\n    this.editor.conversion.attributeToAttribute(definition);\n  }\n}\nexport { Indent, IndentBlock, IndentEditing, IndentUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { getLanguageDirection, Collection } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { createDropdown, addListToDropdown, MenuBarMenuView, MenuBarMenuListView, ListSeparatorView, MenuBarMenuListItemView, MenuBarMenuListItemButtonView, ViewModel } from '@ckeditor/ckeditor5-ui/dist/index.js';\n\n/**\n * Returns the language attribute value in a human-readable text format:\n *\n * ```\n * <languageCode>:<textDirection>\n * ```\n *\n * * `languageCode` - The language code used for the `lang` attribute in the [ISO 639-1](https://en.wikipedia.org/wiki/ISO_639-1) format.\n * * `textDirection` - One of the following values: `rtl` or `ltr`, indicating the reading direction of the language.\n *\n * See the {@link module:core/editor/editorconfig~LanguageConfig#textPartLanguage text part language configuration}\n * for more information about language properties.\n *\n * If the `textDirection` argument is omitted, it will be automatically detected based on `languageCode`.\n *\n * @param languageCode The language code in the ISO 639-1 format.\n * @param textDirection The language text direction. Automatically detected if omitted.\n */\nfunction stringifyLanguageAttribute(languageCode, textDirection) {\n  textDirection = textDirection || getLanguageDirection(languageCode);\n  return `${languageCode}:${textDirection}`;\n}\n/**\n * Retrieves language properties converted to attribute value by the\n * {@link module:language/utils~stringifyLanguageAttribute stringifyLanguageAttribute} function.\n *\n * @param str The attribute value.\n * @returns The object with properties:\n * * languageCode - The language code in the ISO 639 format.\n * * textDirection - The language text direction.\n */\nfunction parseLanguageAttribute(str) {\n  const [languageCode, textDirection] = str.split(':');\n  return {\n    languageCode,\n    textDirection\n  };\n}\n\n/**\n * The text part language command plugin.\n */\nclass TextPartLanguageCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const doc = model.document;\n    this.value = this._getValueFromFirstAllowedNode();\n    this.isEnabled = model.schema.checkAttributeInSelection(doc.selection, 'language');\n  }\n  /**\n  * Executes the command. Applies the attribute to the selection or removes it from the selection.\n  *\n  * If `languageCode` is set to `false` or a `null` value, it will remove attributes. Otherwise, it will set\n  * the attribute in the `{@link #value value}` format.\n  *\n  * The execution result differs, depending on the {@link module:engine/model/document~Document#selection}:\n  *\n  * * If the selection is on a range, the command applies the attribute to all nodes in that range\n  * (if they are allowed to have this attribute by the {@link module:engine/model/schema~Schema schema}).\n  * * If the selection is collapsed in a non-empty node, the command applies the attribute to the\n  * {@link module:engine/model/document~Document#selection} itself (note that typed characters copy attributes from the selection).\n  * * If the selection is collapsed in an empty node, the command applies the attribute to the parent node of the selection (note\n  * that the selection inherits all attributes from a node if it is in an empty node).\n  *\n  * @fires execute\n  * @param options Command options.\n  * @param options.languageCode The language code to be applied to the model.\n  * @param options.textDirection The language text direction.\n  */\n  execute({\n    languageCode,\n    textDirection\n  } = {}) {\n    const model = this.editor.model;\n    const doc = model.document;\n    const selection = doc.selection;\n    const value = languageCode ? stringifyLanguageAttribute(languageCode, textDirection) : false;\n    model.change(writer => {\n      if (selection.isCollapsed) {\n        if (value) {\n          writer.setSelectionAttribute('language', value);\n        } else {\n          writer.removeSelectionAttribute('language');\n        }\n      } else {\n        const ranges = model.schema.getValidRanges(selection.getRanges(), 'language');\n        for (const range of ranges) {\n          if (value) {\n            writer.setAttribute('language', value, range);\n          } else {\n            writer.removeAttribute('language', range);\n          }\n        }\n      }\n    });\n  }\n  /**\n  * Returns the attribute value of the first node in the selection that allows the attribute.\n  * For a collapsed selection it returns the selection attribute.\n  *\n  * @returns The attribute value.\n  */\n  _getValueFromFirstAllowedNode() {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const selection = model.document.selection;\n    if (selection.isCollapsed) {\n      return selection.getAttribute('language') || false;\n    }\n    for (const range of selection.getRanges()) {\n      for (const item of range.getItems()) {\n        if (schema.checkAttribute(item, 'language')) {\n          return item.getAttribute('language') || false;\n        }\n      }\n    }\n    return false;\n  }\n}\n\n/**\n * The text part language editing.\n *\n * Introduces the `'textPartLanguage'` command and the `'language'` model element attribute.\n */\nclass TextPartLanguageEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TextPartLanguageEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    // Text part language options are only used to ensure that the feature works by default.\n    // In the real usage it should be reconfigured by a developer. We are not providing\n    // translations for `title` properties on purpose, as it's only an example configuration.\n    editor.config.define('language', {\n      textPartLanguage: [{\n        title: 'Arabic',\n        languageCode: 'ar'\n      }, {\n        title: 'French',\n        languageCode: 'fr'\n      }, {\n        title: 'Spanish',\n        languageCode: 'es'\n      }]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.model.schema.extend('$text', {\n      allowAttributes: 'language'\n    });\n    editor.model.schema.setAttributeProperties('language', {\n      copyOnEnter: true\n    });\n    this._defineConverters();\n    editor.commands.add('textPartLanguage', new TextPartLanguageCommand(editor));\n  }\n  /**\n  * @private\n  */\n  _defineConverters() {\n    const conversion = this.editor.conversion;\n    conversion.for('upcast').elementToAttribute({\n      model: {\n        key: 'language',\n        value: viewElement => {\n          const languageCode = viewElement.getAttribute('lang');\n          const textDirection = viewElement.getAttribute('dir');\n          return stringifyLanguageAttribute(languageCode, textDirection);\n        }\n      },\n      view: {\n        name: 'span',\n        attributes: {\n          lang: /[\\s\\S]+/\n        }\n      }\n    });\n    conversion.for('downcast').attributeToElement({\n      model: 'language',\n      view: (attributeValue, {\n        writer\n      }, data) => {\n        if (!attributeValue) {\n          return;\n        }\n        if (!data.item.is('$textProxy') && !data.item.is('documentSelection')) {\n          return;\n        }\n        const {\n          languageCode,\n          textDirection\n        } = parseLanguageAttribute(attributeValue);\n        return writer.createAttributeElement('span', {\n          lang: languageCode,\n          dir: textDirection\n        });\n      }\n    });\n  }\n}\n\n/**\n * The text part language UI plugin.\n *\n * It introduces the `'language'` dropdown.\n */\nclass TextPartLanguageUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TextPartLanguageUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const defaultTitle = t('Choose language');\n    const accessibleLabel = t('Language');\n    // Register UI component.\n    editor.ui.componentFactory.add('textPartLanguage', locale => {\n      const {\n        definitions,\n        titles\n      } = this._getItemMetadata();\n      const languageCommand = editor.commands.get('textPartLanguage');\n      const dropdownView = createDropdown(locale);\n      addListToDropdown(dropdownView, definitions, {\n        ariaLabel: accessibleLabel,\n        role: 'menu'\n      });\n      dropdownView.buttonView.set({\n        ariaLabel: accessibleLabel,\n        ariaLabelledBy: undefined,\n        isOn: false,\n        withText: true,\n        tooltip: accessibleLabel\n      });\n      dropdownView.extendTemplate({\n        attributes: {\n          class: ['ck-text-fragment-language-dropdown']\n        }\n      });\n      dropdownView.bind('isEnabled').to(languageCommand, 'isEnabled');\n      dropdownView.buttonView.bind('label').to(languageCommand, 'value', value => {\n        return value && titles[value] || defaultTitle;\n      });\n      dropdownView.buttonView.bind('ariaLabel').to(languageCommand, 'value', value => {\n        const selectedLanguageTitle = value && titles[value];\n        if (!selectedLanguageTitle) {\n          return accessibleLabel;\n        }\n        return `${selectedLanguageTitle}, ${accessibleLabel}`;\n      });\n      // Execute command when an item from the dropdown is selected.\n      this.listenTo(dropdownView, 'execute', evt => {\n        languageCommand.execute({\n          languageCode: evt.source.languageCode,\n          textDirection: evt.source.textDirection\n        });\n        editor.editing.view.focus();\n      });\n      return dropdownView;\n    });\n    // Register menu bar UI component.\n    editor.ui.componentFactory.add('menuBar:textPartLanguage', locale => {\n      const {\n        definitions\n      } = this._getItemMetadata();\n      const languageCommand = editor.commands.get('textPartLanguage');\n      const menuView = new MenuBarMenuView(locale);\n      menuView.buttonView.set({\n        label: accessibleLabel\n      });\n      const listView = new MenuBarMenuListView(locale);\n      listView.set({\n        ariaLabel: t('Language'),\n        role: 'menu'\n      });\n      for (const definition of definitions) {\n        if (definition.type != 'button') {\n          listView.items.add(new ListSeparatorView(locale));\n          continue;\n        }\n        const listItemView = new MenuBarMenuListItemView(locale, menuView);\n        const buttonView = new MenuBarMenuListItemButtonView(locale);\n        buttonView.set({\n          role: 'menuitemradio',\n          isToggleable: true\n        });\n        buttonView.bind(...Object.keys(definition.model)).to(definition.model);\n        buttonView.delegate('execute').to(menuView);\n        listItemView.children.add(buttonView);\n        listView.items.add(listItemView);\n      }\n      menuView.bind('isEnabled').to(languageCommand, 'isEnabled');\n      menuView.panelView.children.add(listView);\n      menuView.on('execute', evt => {\n        languageCommand.execute({\n          languageCode: evt.source.languageCode,\n          textDirection: evt.source.textDirection\n        });\n        editor.editing.view.focus();\n      });\n      return menuView;\n    });\n  }\n  /**\n  * Returns metadata for dropdown and menu items.\n  */\n  _getItemMetadata() {\n    const editor = this.editor;\n    const itemDefinitions = new Collection();\n    const titles = {};\n    const languageCommand = editor.commands.get('textPartLanguage');\n    const options = editor.config.get('language.textPartLanguage');\n    const t = editor.locale.t;\n    const removeTitle = t('Remove language');\n    // Item definition with false `languageCode` will behave as remove lang button.\n    itemDefinitions.add({\n      type: 'button',\n      model: new ViewModel({\n        label: removeTitle,\n        languageCode: false,\n        withText: true\n      })\n    });\n    itemDefinitions.add({\n      type: 'separator'\n    });\n    for (const option of options) {\n      const def = {\n        type: 'button',\n        model: new ViewModel({\n          label: option.title,\n          languageCode: option.languageCode,\n          role: 'menuitemradio',\n          textDirection: option.textDirection,\n          withText: true\n        })\n      };\n      const language = stringifyLanguageAttribute(option.languageCode, option.textDirection);\n      def.model.bind('isOn').to(languageCommand, 'value', value => value === language);\n      itemDefinitions.add(def);\n      titles[language] = option.title;\n    }\n    return {\n      definitions: itemDefinitions,\n      titles\n    };\n  }\n}\n\n/**\n * The text part language feature.\n *\n * This feature allows setting a language of the document's text part to support\n * [WCAG 3.1.2 Language of Parts](https://www.w3.org/TR/UNDERSTANDING-WCAG20/meaning-other-lang-id.html) specification.\n *\n * To change the editor's UI language, refer to the {@glink getting-started/setup/ui-language Setting the UI language} guide.\n *\n * For more information about this feature, check the {@glink api/language package page} as well as the {@glink features/language\n * Text part language} feature guide.\n *\n * This is a \"glue\" plugin which loads the\n * {@link module:language/textpartlanguageediting~TextPartLanguageEditing text part language editing feature}\n * and the {@link module:language/textpartlanguageui~TextPartLanguageUI text part language UI feature}.\n */\nclass TextPartLanguage extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TextPartLanguageEditing, TextPartLanguageUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TextPartLanguage';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { TextPartLanguage, TextPartLanguageEditing, TextPartLanguageUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { findAttributeRange, TwoStepCaretMovement, Input, inlineHighlight, Delete, TextWatcher, getLastTextLine } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { ClipboardPipeline } from '@ckeditor/ckeditor5-clipboard/dist/index.js';\nimport { toMap, Collection, first, diff, ObservableMixin, env, keyCodes, FocusTracker, KeystrokeHandler } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { LivePosition, ClickObserver, Matcher } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { upperFirst } from 'es-toolkit/compat';\nimport { IconPreviousArrow, IconUnlink, IconPencil, IconSettings, IconLink } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { ButtonView, View, ViewCollection, FocusCycler, submitHandler, FormHeaderView, ListView, ListItemView, LabeledFieldView, createLabeledInputText, FormRowView, IconView, ContextualBalloon, ToolbarView, CssTransitionDisablerMixin, SwitchButtonView, MenuBarMenuListItemButtonView, clickOutsideHandler } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { isWidget } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { IconPreviousArrow as IconPreviousArrow$1, IconNextArrow } from '@ckeditor/ckeditor5-icons/dist/index.js';\n\n/**\n * Helper class that ties together all {@link module:link/linkconfig~LinkDecoratorAutomaticDefinition} and provides\n * the {@link module:engine/conversion/downcasthelpers~DowncastHelpers#attributeToElement downcast dispatchers} for them.\n */\nclass AutomaticDecorators {\n  /**\n  * Stores the definition of {@link module:link/linkconfig~LinkDecoratorAutomaticDefinition automatic decorators}.\n  * This data is used as a source for a downcast dispatcher to create a proper conversion to output data.\n  */\n  _definitions = new Set();\n  /**\n  * Gives information about the number of decorators stored in the {@link module:link/utils/automaticdecorators~AutomaticDecorators}\n  * instance.\n  */\n  get length() {\n    return this._definitions.size;\n  }\n  /**\n  * Adds automatic decorator objects or an array with them to be used during downcasting.\n  *\n  * @param item A configuration object of automatic rules for decorating links. It might also be an array of such objects.\n  */\n  add(item) {\n    if (Array.isArray(item)) {\n      item.forEach(item => this._definitions.add(item));\n    } else {\n      this._definitions.add(item);\n    }\n  }\n  /**\n  * Provides the conversion helper used in the {@link module:engine/conversion/downcasthelpers~DowncastHelpers#add} method.\n  *\n  * @returns A dispatcher function used as conversion helper in {@link module:engine/conversion/downcasthelpers~DowncastHelpers#add}.\n  */\n  getDispatcher() {\n    return dispatcher => {\n      dispatcher.on('attribute:linkHref', (evt, data, conversionApi) => {\n        // There is only test as this behavior decorates links and\n        // it is run before dispatcher which actually consumes this node.\n        // This allows on writing own dispatcher with highest priority,\n        // which blocks both native converter and this additional decoration.\n        if (!conversionApi.consumable.test(data.item, 'attribute:linkHref')) {\n          return;\n        }\n        // Automatic decorators for block links are handled e.g. in LinkImageEditing.\n        if (!(data.item.is('selection') || conversionApi.schema.isInline(data.item))) {\n          return;\n        }\n        const viewWriter = conversionApi.writer;\n        const viewSelection = viewWriter.document.selection;\n        for (const item of this._definitions) {\n          const viewElement = viewWriter.createAttributeElement('a', item.attributes, {\n            priority: 5\n          });\n          if (item.classes) {\n            viewWriter.addClass(item.classes, viewElement);\n          }\n          for (const key in item.styles) {\n            viewWriter.setStyle(key, item.styles[key], viewElement);\n          }\n          viewWriter.setCustomProperty('link', true, viewElement);\n          if (item.callback(data.attributeNewValue)) {\n            if (data.item.is('selection')) {\n              viewWriter.wrap(viewSelection.getFirstRange(), viewElement);\n            } else {\n              viewWriter.wrap(conversionApi.mapper.toViewRange(data.range), viewElement);\n            }\n          } else {\n            viewWriter.unwrap(conversionApi.mapper.toViewRange(data.range), viewElement);\n          }\n        }\n      }, {\n        priority: 'high'\n      });\n    };\n  }\n  /**\n  * Provides the conversion helper used in the {@link module:engine/conversion/downcasthelpers~DowncastHelpers#add} method\n  * when linking images.\n  *\n  * @returns A dispatcher function used as conversion helper in {@link module:engine/conversion/downcasthelpers~DowncastHelpers#add}.\n  */\n  getDispatcherForLinkedImage() {\n    return dispatcher => {\n      dispatcher.on('attribute:linkHref:imageBlock', (evt, data, {\n        writer,\n        mapper\n      }) => {\n        const viewFigure = mapper.toViewElement(data.item);\n        const linkInImage = Array.from(viewFigure.getChildren()).find(child => child.is('element', 'a'));\n        // It's not guaranteed that the anchor is present in the image block during execution of this dispatcher.\n        // It might have been removed during the execution of unlink command that runs the image link downcast dispatcher\n        // that is executed before this one and removes the anchor from the image block.\n        if (!linkInImage) {\n          return;\n        }\n        for (const item of this._definitions) {\n          const attributes = toMap(item.attributes);\n          if (item.callback(data.attributeNewValue)) {\n            for (const [key, val] of attributes) {\n              // Left for backward compatibility. Since v30 decorator should\n              // accept `classes` and `styles` separately from `attributes`.\n              if (key === 'class') {\n                writer.addClass(val, linkInImage);\n              } else {\n                writer.setAttribute(key, val, linkInImage);\n              }\n            }\n            if (item.classes) {\n              writer.addClass(item.classes, linkInImage);\n            }\n            for (const key in item.styles) {\n              writer.setStyle(key, item.styles[key], linkInImage);\n            }\n          } else {\n            for (const [key, val] of attributes) {\n              if (key === 'class') {\n                writer.removeClass(val, linkInImage);\n              } else {\n                writer.removeAttribute(key, linkInImage);\n              }\n            }\n            if (item.classes) {\n              writer.removeClass(item.classes, linkInImage);\n            }\n            for (const key in item.styles) {\n              writer.removeStyle(key, linkInImage);\n            }\n          }\n        }\n      });\n    };\n  }\n}\nconst ATTRIBUTE_WHITESPACES = /[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205f\\u3000]/g; // eslint-disable-line no-control-regex\nconst SAFE_URL_TEMPLATE = '^(?:(?:<protocols>):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))';\n// Simplified email test - should be run over previously found URL.\nconst EMAIL_REG_EXP = /^[\\S]+@((?![-_])(?:[-\\w\\u00a1-\\uffff]{0,63}[^-_]\\.))+(?:[a-z\\u00a1-\\uffff]{2,})$/i;\n// The regex checks for the protocol syntax ('xxxx://' or 'xxxx:')\n// or non-word characters at the beginning of the link ('/', '#' etc.).\nconst PROTOCOL_REG_EXP = /^((\\w+:(\\/{2,})?)|(\\W))/i;\nconst DEFAULT_LINK_PROTOCOLS = ['https?', 'ftps?', 'mailto'];\n/**\n * A keystroke used by the {@link module:link/linkui~LinkUI link UI feature}.\n */\nconst LINK_KEYSTROKE = 'Ctrl+K';\n/**\n * Returns `true` if a given view node is the link element.\n */\nfunction isLinkElement(node) {\n  return node.is('attributeElement') && !!node.getCustomProperty('link');\n}\n/**\n * Creates a link {@link module:engine/view/attributeelement~AttributeElement} with the provided `href` attribute.\n */\nfunction createLinkElement(href, {\n  writer\n}) {\n  // Priority 5 - https://github.com/ckeditor/ckeditor5-link/issues/121.\n  const linkElement = writer.createAttributeElement('a', {\n    href\n  }, {\n    priority: 5\n  });\n  writer.setCustomProperty('link', true, linkElement);\n  return linkElement;\n}\n/**\n * Returns a safe URL based on a given value.\n *\n * A URL is considered safe if it is safe for the user (does not contain any malicious code).\n *\n * If a URL is considered unsafe, a simple `\"#\"` is returned.\n *\n * @internal\n */\nfunction ensureSafeUrl(url, allowedProtocols = DEFAULT_LINK_PROTOCOLS) {\n  const urlString = String(url);\n  const protocolsList = allowedProtocols.join('|');\n  const customSafeRegex = new RegExp(`${SAFE_URL_TEMPLATE.replace('<protocols>', protocolsList)}`, 'i');\n  return isSafeUrl(urlString, customSafeRegex) ? urlString : '#';\n}\n/**\n * Checks whether the given URL is safe for the user (does not contain any malicious code).\n */\nfunction isSafeUrl(url, customRegexp) {\n  const normalizedUrl = url.replace(ATTRIBUTE_WHITESPACES, '');\n  return !!normalizedUrl.match(customRegexp);\n}\n/**\n * Returns the {@link module:link/linkconfig~LinkConfig#decorators `config.link.decorators`} configuration processed\n * to respect the locale of the editor, i.e. to display the {@link module:link/linkconfig~LinkDecoratorManualDefinition label}\n * in the correct language.\n *\n * **Note**: Only the few most commonly used labels are translated automatically. Other labels should be manually\n * translated in the {@link module:link/linkconfig~LinkConfig#decorators `config.link.decorators`} configuration.\n *\n * @param t Shorthand for {@link module:utils/locale~Locale#t Locale#t}.\n * @param decorators The decorator reference where the label values should be localized.\n */\nfunction getLocalizedDecorators(t, decorators) {\n  const localizedDecoratorsLabels = {\n    'Open in a new tab': t('Open in a new tab'),\n    'Downloadable': t('Downloadable')\n  };\n  decorators.forEach(decorator => {\n    if ('label' in decorator && localizedDecoratorsLabels[decorator.label]) {\n      decorator.label = localizedDecoratorsLabels[decorator.label];\n    }\n    return decorator;\n  });\n  return decorators;\n}\n/**\n * Converts an object with defined decorators to a normalized array of decorators. The `id` key is added for each decorator and\n * is used as the attribute's name in the model.\n */\nfunction normalizeDecorators(decorators) {\n  const retArray = [];\n  if (decorators) {\n    for (const [key, value] of Object.entries(decorators)) {\n      const decorator = Object.assign({}, value, {\n        id: `link${upperFirst(key)}`\n      });\n      retArray.push(decorator);\n    }\n  }\n  return retArray;\n}\n/**\n * Returns `true` if the specified `element` can be linked (the element allows the `linkHref` attribute).\n */\nfunction isLinkableElement(element, schema) {\n  if (!element) {\n    return false;\n  }\n  return schema.checkAttribute(element.name, 'linkHref');\n}\n/**\n * Returns `true` if the specified `value` is an email.\n */\nfunction isEmail(value) {\n  return EMAIL_REG_EXP.test(value);\n}\n/**\n * Adds the protocol prefix to the specified `link` when:\n *\n * * it does not contain it already, and there is a {@link module:link/linkconfig~LinkConfig#defaultProtocol `defaultProtocol` }\n * configuration value provided,\n * * or the link is an email address.\n */\nfunction addLinkProtocolIfApplicable(link, defaultProtocol) {\n  const protocol = isEmail(link) ? 'mailto:' : defaultProtocol;\n  const isProtocolNeeded = !!protocol && !linkHasProtocol(link);\n  return link && isProtocolNeeded ? protocol + link : link;\n}\n/**\n * Checks if protocol is already included in the link.\n */\nfunction linkHasProtocol(link) {\n  return PROTOCOL_REG_EXP.test(link);\n}\n/**\n * Opens the link in a new browser tab.\n */\nfunction openLink(link) {\n  window.open(link, '_blank', 'noopener');\n}\n/**\n * Returns a text of a link range.\n *\n * If the returned value is `undefined`, the range contains elements other than text nodes.\n */\nfunction extractTextFromLinkRange(range) {\n  let text = '';\n  for (const item of range.getItems()) {\n    if (!item.is('$text') && !item.is('$textProxy')) {\n      return;\n    }\n    text += item.data;\n  }\n  return text;\n}\n\n/**\n * The link command. It is used by the {@link module:link/link~Link link feature}.\n */\nclass LinkCommand extends Command {\n  /**\n  * A collection of {@link module:link/utils/manualdecorator~ManualDecorator manual decorators}\n  * corresponding to the {@link module:link/linkconfig~LinkConfig#decorators decorator configuration}.\n  *\n  * You can consider it a model with states of manual decorators added to the currently selected link.\n  */\n  manualDecorators = new Collection();\n  /**\n  * An instance of the helper that ties together all {@link module:link/linkconfig~LinkDecoratorAutomaticDefinition}\n  * that are used by the {@glink features/link link} and the {@glink features/images/images-linking linking images} features.\n  */\n  automaticDecorators = new AutomaticDecorators();\n  /**\n  * Synchronizes the state of {@link #manualDecorators} with the currently present elements in the model.\n  */\n  restoreManualDecoratorStates() {\n    for (const manualDecorator of this.manualDecorators) {\n      manualDecorator.value = this._getDecoratorStateFromModel(manualDecorator.id);\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedElement = selection.getSelectedElement() || first(selection.getSelectedBlocks());\n    // A check for any integration that allows linking elements (e.g. `LinkImage`).\n    // Currently the selection reads attributes from text nodes only. See #7429 and #7465.\n    if (isLinkableElement(selectedElement, model.schema)) {\n      this.value = selectedElement.getAttribute('linkHref');\n      this.isEnabled = model.schema.checkAttribute(selectedElement, 'linkHref');\n    } else {\n      this.value = selection.getAttribute('linkHref');\n      this.isEnabled = model.schema.checkAttributeInSelection(selection, 'linkHref');\n    }\n    for (const manualDecorator of this.manualDecorators) {\n      manualDecorator.value = this._getDecoratorStateFromModel(manualDecorator.id);\n    }\n  }\n  /**\n  * Executes the command.\n  *\n  * When the selection is non-collapsed, the `linkHref` attribute will be applied to nodes inside the selection, but only to\n  * those nodes where the `linkHref` attribute is allowed (disallowed nodes will be omitted).\n  *\n  * When the selection is collapsed and is not inside the text with the `linkHref` attribute, a\n  * new {@link module:engine/model/text~Text text node} with the `linkHref` attribute will be inserted in place of the caret, but\n  * only if such element is allowed in this place. The `_data` of the inserted text will equal the `href` parameter.\n  * The selection will be updated to wrap the just inserted text node.\n  *\n  * When the selection is collapsed and inside the text with the `linkHref` attribute, the attribute value will be updated.\n  *\n  * # Decorators and model attribute management\n  *\n  * There is an optional argument to this command that applies or removes model\n  * {@glink framework/architecture/editing-engine#text-attributes text attributes} brought by\n  * {@link module:link/utils/manualdecorator~ManualDecorator manual link decorators}.\n  *\n  * Text attribute names in the model correspond to the entries in the {@link module:link/linkconfig~LinkConfig#decorators\n  * configuration}.\n  * For every decorator configured, a model text attribute exists with the \"link\" prefix. For example, a `'linkMyDecorator'` attribute\n  * corresponds to `'myDecorator'` in the configuration.\n  *\n  * To learn more about link decorators, check out the {@link module:link/linkconfig~LinkConfig#decorators `config.link.decorators`}\n  * documentation.\n  *\n  * Here is how to manage decorator attributes with the link command:\n  *\n  * ```ts\n  * const linkCommand = editor.commands.get( 'link' );\n  *\n  * // Adding a new decorator attribute.\n  * linkCommand.execute( 'http://example.com', {\n  * \tlinkIsExternal: true\n  * } );\n  *\n  * // Removing a decorator attribute from the selection.\n  * linkCommand.execute( 'http://example.com', {\n  * \tlinkIsExternal: false\n  * } );\n  *\n  * // Adding multiple decorator attributes at the same time.\n  * linkCommand.execute( 'http://example.com', {\n  * \tlinkIsExternal: true,\n  * \tlinkIsDownloadable: true,\n  * } );\n  *\n  * // Removing and adding decorator attributes at the same time.\n  * linkCommand.execute( 'http://example.com', {\n  * \tlinkIsExternal: false,\n  * \tlinkFoo: true,\n  * \tlinkIsDownloadable: false,\n  * } );\n  * ```\n  *\n  * **Note**: If the decorator attribute name is not specified, its state remains untouched.\n  *\n  * **Note**: {@link module:link/unlinkcommand~UnlinkCommand#execute `UnlinkCommand#execute()`} removes all\n  * decorator attributes.\n  *\n  * An optional parameter called `displayedText` is to add or update text of the link that represents the `href`. For example:\n  *\n  * ```ts\n  * const linkCommand = editor.commands.get( 'link' );\n  *\n  * // Adding a new link with `displayedText` attribute.\n  * linkCommand.execute( 'http://example.com', {}, 'Example' );\n  * ```\n  *\n  * The above code will create an anchor like this:\n  *\n  * ```html\n  * <a href=\"http://example.com\">Example</a>\n  * ```\n  *\n  * @fires execute\n  * @param href Link destination.\n  * @param manualDecoratorIds The information about manual decorator attributes to be applied or removed upon execution.\n  * @param displayedText Text of the link.\n  */\n  execute(href, manualDecoratorIds = {}, displayedText) {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    // Stores information about manual decorators to turn them on/off when command is applied.\n    const truthyManualDecorators = [];\n    const falsyManualDecorators = [];\n    for (const name in manualDecoratorIds) {\n      if (manualDecoratorIds[name]) {\n        truthyManualDecorators.push(name);\n      } else {\n        falsyManualDecorators.push(name);\n      }\n    }\n    model.change(writer => {\n      const updateLinkAttributes = itemOrRange => {\n        writer.setAttribute('linkHref', href, itemOrRange);\n        truthyManualDecorators.forEach(item => writer.setAttribute(item, true, itemOrRange));\n        falsyManualDecorators.forEach(item => writer.removeAttribute(item, itemOrRange));\n      };\n      const updateLinkTextIfNeeded = (range, linkHref) => {\n        const linkText = extractTextFromLinkRange(range);\n        if (!linkText) {\n          return range;\n        }\n        // Make a copy not to override the command param value.\n        let newText = displayedText;\n        if (!newText) {\n          // Replace the link text with the new href if previously href was equal to text.\n          // For example: `<a href=\"http://ckeditor.com/\">http://ckeditor.com/</a>`.\n          newText = linkHref && linkHref == linkText ? href : linkText;\n        }\n        // Only if needed.\n        if (newText != linkText) {\n          const changes = findChanges(linkText, newText);\n          let insertsLength = 0;\n          for (const {\n            offset,\n            actual,\n            expected\n          } of changes) {\n            const updatedOffset = offset + insertsLength;\n            const subRange = writer.createRange(range.start.getShiftedBy(updatedOffset), range.start.getShiftedBy(updatedOffset + actual.length));\n            // Collect formatting attributes from replaced text.\n            const textNode = getLinkPartTextNode(subRange, range);\n            const attributes = textNode.getAttributes();\n            const formattingAttributes = Array.from(attributes).filter(([key]) => model.schema.getAttributeProperties(key).isFormatting);\n            // Create a new text node.\n            const newTextNode = writer.createText(expected, formattingAttributes);\n            // Set link attributes before inserting to document to avoid Differ attributes edge case.\n            updateLinkAttributes(newTextNode);\n            // Replace text with formatting.\n            model.insertContent(newTextNode, subRange);\n            // Sum of all previous inserts.\n            insertsLength += expected.length;\n          }\n          return writer.createRange(range.start, range.start.getShiftedBy(newText.length));\n        }\n      };\n      const collapseSelectionAtLinkEnd = linkRange => {\n        const {\n          plugins\n        } = this.editor;\n        writer.setSelection(linkRange.end);\n        if (plugins.has('TwoStepCaretMovement')) {\n          // After replacing the text of the link, we need to move the caret to the end of the link,\n          // override it's gravity to forward to prevent keeping e.g. bold attribute on the caret\n          // which was previously inside the link.\n          //\n          // If the plugin is not available, the caret will be placed at the end of the link and the\n          // bold attribute will be kept even if command moved caret outside the link.\n          plugins.get('TwoStepCaretMovement')._handleForwardMovement();\n        } else {\n          // Remove the `linkHref` attribute and all link decorators from the selection.\n          // It stops adding a new content into the link element.\n          for (const key of ['linkHref', ...truthyManualDecorators, ...falsyManualDecorators]) {\n            writer.removeSelectionAttribute(key);\n          }\n        }\n      };\n      // If selection is collapsed then update selected link or insert new one at the place of caret.\n      if (selection.isCollapsed) {\n        const position = selection.getFirstPosition();\n        // When selection is inside text with `linkHref` attribute.\n        if (selection.hasAttribute('linkHref')) {\n          const linkHref = selection.getAttribute('linkHref');\n          const linkRange = findAttributeRange(position, 'linkHref', linkHref, model);\n          const newLinkRange = updateLinkTextIfNeeded(linkRange, linkHref);\n          updateLinkAttributes(newLinkRange || linkRange);\n          // Put the selection at the end of the updated link only when text was changed.\n          // When text was not altered we keep the original selection.\n          if (newLinkRange) {\n            collapseSelectionAtLinkEnd(newLinkRange);\n          }\n        } else if (href !== '') {\n          const attributes = toMap(selection.getAttributes());\n          attributes.set('linkHref', href);\n          truthyManualDecorators.forEach(item => {\n            attributes.set(item, true);\n          });\n          const newLinkRange = model.insertContent(writer.createText(displayedText || href, attributes), position);\n          // Put the selection at the end of the inserted link.\n          // Using end of range returned from insertContent in case nodes with the same attributes got merged.\n          collapseSelectionAtLinkEnd(newLinkRange);\n        }\n      } else {\n        // Non-collapsed selection.\n        // If selection has non-collapsed ranges, we change attribute on nodes inside those ranges\n        // omitting nodes where the `linkHref` attribute is disallowed.\n        const selectionRanges = Array.from(selection.getRanges());\n        const ranges = model.schema.getValidRanges(selectionRanges, 'linkHref');\n        // But for the first, check whether the `linkHref` attribute is allowed on selected blocks (e.g. the \"image\" element).\n        const allowedRanges = [];\n        for (const element of selection.getSelectedBlocks()) {\n          if (model.schema.checkAttribute(element, 'linkHref')) {\n            allowedRanges.push(writer.createRangeOn(element));\n          }\n        }\n        // Ranges that accept the `linkHref` attribute. Since we will iterate over `allowedRanges`, let's clone it.\n        const rangesToUpdate = allowedRanges.slice();\n        // For all selection ranges we want to check whether given range is inside an element that accepts the `linkHref` attribute.\n        // If so, we don't want to propagate applying the attribute to its children.\n        for (const range of ranges) {\n          if (this._isRangeToUpdate(range, allowedRanges)) {\n            rangesToUpdate.push(range);\n          }\n        }\n        // Store the selection ranges in a pseudo live range array (stickiness to the outside of the range).\n        const stickyPseudoRanges = selectionRanges.map(range => ({\n          start: LivePosition.fromPosition(range.start, 'toPrevious'),\n          end: LivePosition.fromPosition(range.end, 'toNext')\n        }));\n        // Update or set links (including text update if needed).\n        for (let range of rangesToUpdate) {\n          const linkHref = (range.start.textNode || range.start.nodeAfter).getAttribute('linkHref');\n          range = updateLinkTextIfNeeded(range, linkHref) || range;\n          updateLinkAttributes(range);\n        }\n        // The original selection got trimmed by replacing content so we need to restore it.\n        writer.setSelection(stickyPseudoRanges.map(pseudoRange => {\n          const start = pseudoRange.start.toPosition();\n          const end = pseudoRange.end.toPosition();\n          pseudoRange.start.detach();\n          pseudoRange.end.detach();\n          return model.createRange(start, end);\n        }));\n      }\n    });\n  }\n  /**\n  * Provides information whether a decorator with a given name is present in the currently processed selection.\n  *\n  * @param decoratorName The name of the manual decorator used in the model\n  * @returns The information whether a given decorator is currently present in the selection.\n  */\n  _getDecoratorStateFromModel(decoratorName) {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedElement = selection.getSelectedElement();\n    // A check for the `LinkImage` plugin. If the selection contains an element, get values from the element.\n    // Currently the selection reads attributes from text nodes only. See #7429 and #7465.\n    if (isLinkableElement(selectedElement, model.schema)) {\n      return selectedElement.getAttribute(decoratorName);\n    }\n    return selection.getAttribute(decoratorName);\n  }\n  /**\n  * Checks whether specified `range` is inside an element that accepts the `linkHref` attribute.\n  *\n  * @param range A range to check.\n  * @param allowedRanges An array of ranges created on elements where the attribute is accepted.\n  */\n  _isRangeToUpdate(range, allowedRanges) {\n    for (const allowedRange of allowedRanges) {\n      // A range is inside an element that will have the `linkHref` attribute. Do not modify its nodes.\n      if (allowedRange.containsRange(range)) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n/**\n * Compares two strings and returns an array of changes needed to transform one into another.\n * Uses the diff utility to find the differences and groups them into chunks containing information\n * about the offset and actual/expected content.\n *\n * @param oldText The original text to compare.\n * @param newText The new text to compare against.\n * @returns Array of change objects containing offset and actual/expected content.\n *\n * @example\n * findChanges( 'hello world', 'hi there' );\n *\n * Returns:\n * [\n * \t{\n * \t\t\"offset\": 1,\n * \t\t\"actual\": \"ello\",\n * \t\t\"expected\": \"i\"\n * \t},\n * \t{\n * \t\t\"offset\": 2,\n * \t\t\"actual\": \"wo\",\n * \t\t\"expected\": \"the\"\n * \t},\n * \t{\n * \t\t\"offset\": 3,\n * \t\t\"actual\": \"ld\",\n * \t\t\"expected\": \"e\"\n * \t}\n * ]\n */\nfunction findChanges(oldText, newText) {\n  // Get array of operations (insert/delete/equal) needed to transform oldText into newText.\n  // Example: diff('abc', 'abxc') returns ['equal', 'equal', 'insert', 'equal']\n  const changes = diff(oldText, newText);\n  // Track position in both strings based on operation type.\n  const counter = {\n    equal: 0,\n    insert: 0,\n    delete: 0\n  };\n  const result = [];\n  // Accumulate consecutive changes into slices before creating change objects.\n  let actualSlice = '';\n  let expectedSlice = '';\n  // Adding null as sentinel value to handle final accumulated changes.\n  for (const action of [...changes, null]) {\n    if (action == 'insert') {\n      // Example: for 'abc' -> 'abxc', at insert position, adds 'x' to expectedSlice.\n      expectedSlice += newText[counter.equal + counter.insert];\n    } else if (action == 'delete') {\n      // Example: for 'abc' -> 'ac', at delete position, adds 'b' to actualSlice.\n      actualSlice += oldText[counter.equal + counter.delete];\n    } else if (actualSlice.length || expectedSlice.length) {\n      // On 'equal' or end: bundle accumulated changes into a single change object.\n      // Example: { offset: 2, actual: \"\", expected: \"x\" }\n      result.push({\n        offset: counter.equal,\n        actual: actualSlice,\n        expected: expectedSlice\n      });\n      actualSlice = '';\n      expectedSlice = '';\n    }\n    // Increment appropriate counter for the current operation.\n    if (action) {\n      counter[action]++;\n    }\n  }\n  return result;\n}\n/**\n * Returns text node withing the link range that should be updated.\n *\n * @param range Partial link range.\n * @param linkRange Range of the entire link.\n * @returns Text node.\n */\nfunction getLinkPartTextNode(range, linkRange) {\n  if (!range.isCollapsed) {\n    return first(range.getItems());\n  }\n  const position = range.start;\n  if (position.textNode) {\n    return position.textNode;\n  }\n  // If the range is at the start of a link range then prefer node inside a link range.\n  if (!position.nodeBefore || position.isEqual(linkRange.start)) {\n    return position.nodeAfter;\n  } else {\n    return position.nodeBefore;\n  }\n}\n\n/**\n * The unlink command. It is used by the {@link module:link/link~Link link plugin}.\n */\nclass UnlinkCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedElement = selection.getSelectedElement();\n    // A check for any integration that allows linking elements (e.g. `LinkImage`).\n    // Currently the selection reads attributes from text nodes only. See #7429 and #7465.\n    if (isLinkableElement(selectedElement, model.schema)) {\n      this.isEnabled = model.schema.checkAttribute(selectedElement, 'linkHref');\n    } else {\n      this.isEnabled = model.schema.checkAttributeInSelection(selection, 'linkHref');\n    }\n  }\n  /**\n  * Executes the command.\n  *\n  * When the selection is collapsed, it removes the `linkHref` attribute from each node with the same `linkHref` attribute value.\n  * When the selection is non-collapsed, it removes the `linkHref` attribute from each node in selected ranges.\n  *\n  * # Decorators\n  *\n  * If {@link module:link/linkconfig~LinkConfig#decorators `config.link.decorators`} is specified,\n  * all configured decorators are removed together with the `linkHref` attribute.\n  *\n  * @fires execute\n  */\n  execute() {\n    const editor = this.editor;\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const linkCommand = editor.commands.get('link');\n    model.change(writer => {\n      // Get ranges to unlink.\n      const rangesToUnlink = selection.isCollapsed ? [findAttributeRange(selection.getFirstPosition(), 'linkHref', selection.getAttribute('linkHref'), model)] : model.schema.getValidRanges(selection.getRanges(), 'linkHref');\n      // Remove `linkHref` attribute from specified ranges.\n      for (const range of rangesToUnlink) {\n        writer.removeAttribute('linkHref', range);\n        // If there are registered custom attributes, then remove them during unlink.\n        if (linkCommand) {\n          for (const manualDecorator of linkCommand.manualDecorators) {\n            writer.removeAttribute(manualDecorator.id, range);\n          }\n        }\n      }\n    });\n  }\n}\n\n/**\n * Helper class that stores manual decorators with observable {@link module:link/utils/manualdecorator~ManualDecorator#value}\n * to support integration with the UI state. An instance of this class is a model with the state of individual manual decorators.\n * These decorators are kept as collections in {@link module:link/linkcommand~LinkCommand#manualDecorators}.\n */\nclass ManualDecorator extends /* #__PURE__ */ObservableMixin() {\n  /**\n  * An ID of a manual decorator which is the name of the attribute in the model, for example: 'linkManualDecorator0'.\n  */\n  id;\n  /**\n  * The default value of manual decorator.\n  */\n  defaultValue;\n  /**\n  * The label used in the user interface to toggle the manual decorator.\n  */\n  label;\n  /**\n  * A set of attributes added to downcasted data when the decorator is activated for a specific link.\n  * Attributes should be added in a form of attributes defined in {@link module:engine/view/elementdefinition~ElementDefinition}.\n  */\n  attributes;\n  /**\n  * A set of classes added to downcasted data when the decorator is activated for a specific link.\n  * Classes should be added in a form of classes defined in {@link module:engine/view/elementdefinition~ElementDefinition}.\n  */\n  classes;\n  /**\n  * A set of styles added to downcasted data when the decorator is activated for a specific link.\n  * Styles should be added in a form of styles defined in {@link module:engine/view/elementdefinition~ElementDefinition}.\n  */\n  styles;\n  /**\n  * Creates a new instance of {@link module:link/utils/manualdecorator~ManualDecorator}.\n  *\n  * @param config.id The name of the attribute used in the model that represents a given manual decorator.\n  * For example: `'linkIsExternal'`.\n  * @param config.label The label used in the user interface to toggle the manual decorator.\n  * @param config.attributes A set of attributes added to output data when the decorator is active for a specific link.\n  * Attributes should keep the format of attributes defined in {@link module:engine/view/elementdefinition~ElementDefinition}.\n  * @param [config.defaultValue] Controls whether the decorator is \"on\" by default.\n  */\n  constructor({\n    id,\n    label,\n    attributes,\n    classes,\n    styles,\n    defaultValue\n  }) {\n    super();\n    this.id = id;\n    this.set('value', undefined);\n    this.defaultValue = defaultValue;\n    this.label = label;\n    this.attributes = attributes;\n    this.classes = classes;\n    this.styles = styles;\n  }\n  /**\n  * Returns {@link module:engine/view/matcher~MatcherPattern} with decorator attributes.\n  *\n  * @internal\n  */\n  _createPattern() {\n    return {\n      attributes: this.attributes,\n      classes: this.classes,\n      styles: this.styles\n    };\n  }\n}\nconst HIGHLIGHT_CLASS = 'ck-link_selected';\nconst DECORATOR_AUTOMATIC = 'automatic';\nconst DECORATOR_MANUAL = 'manual';\nconst EXTERNAL_LINKS_REGEXP = /^(https?:)?\\/\\//;\n/**\n * The link engine feature.\n *\n * It introduces the `linkHref=\"url\"` attribute in the model which renders to the view as a `<a href=\"url\">` element\n * as well as `'link'` and `'unlink'` commands.\n */\nclass LinkEditing extends Plugin {\n  /**\n  * A list of functions that handles opening links. If any of them returns `true`, the link is considered to be opened.\n  */\n  _linkOpeners = [];\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LinkEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    // Clipboard is required for handling cut and paste events while typing over the link.\n    return [TwoStepCaretMovement, Input, ClipboardPipeline];\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('link', {\n      allowCreatingEmptyLinks: false,\n      addTargetToExternalLinks: false,\n      toolbar: ['linkPreview', '|', 'editLink', 'linkProperties', 'unlink']\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const allowedProtocols = this.editor.config.get('link.allowedProtocols');\n    // Allow link attribute on all inline nodes.\n    editor.model.schema.extend('$text', {\n      allowAttributes: 'linkHref'\n    });\n    editor.conversion.for('dataDowncast').attributeToElement({\n      model: 'linkHref',\n      view: createLinkElement\n    });\n    editor.conversion.for('editingDowncast').attributeToElement({\n      model: 'linkHref',\n      view: (href, conversionApi) => {\n        return createLinkElement(ensureSafeUrl(href, allowedProtocols), conversionApi);\n      }\n    });\n    editor.conversion.for('upcast').elementToAttribute({\n      view: {\n        name: 'a',\n        attributes: {\n          href: true\n        }\n      },\n      model: {\n        key: 'linkHref',\n        value: viewElement => viewElement.getAttribute('href')\n      }\n    });\n    // Create linking commands.\n    editor.commands.add('link', new LinkCommand(editor));\n    editor.commands.add('unlink', new UnlinkCommand(editor));\n    const linkDecorators = getLocalizedDecorators(editor.t, normalizeDecorators(editor.config.get('link.decorators')));\n    this._enableAutomaticDecorators(linkDecorators.filter(item => item.mode === DECORATOR_AUTOMATIC));\n    this._enableManualDecorators(linkDecorators.filter(item => item.mode === DECORATOR_MANUAL));\n    // Enable two-step caret movement for `linkHref` attribute.\n    const twoStepCaretMovementPlugin = editor.plugins.get(TwoStepCaretMovement);\n    twoStepCaretMovementPlugin.registerAttribute('linkHref');\n    // Setup highlight over selected link.\n    inlineHighlight(editor, 'linkHref', 'a', HIGHLIGHT_CLASS);\n    // Handle link following by CTRL+click or ALT+ENTER\n    this._enableLinkOpen();\n    // Clears the DocumentSelection decorator attributes if the selection is no longer in a link (for example while using 2-SCM).\n    this._enableSelectionAttributesFixer();\n    // Handle adding default protocol to pasted links.\n    this._enableClipboardIntegration();\n  }\n  /**\n  * Registers a function that opens links in a new browser tab.\n  *\n  * @param linkOpener The function that opens a link in a new browser tab.\n  * @internal\n  */\n  _registerLinkOpener(linkOpener) {\n    this._linkOpeners.push(linkOpener);\n  }\n  /**\n  * Processes an array of configured {@link module:link/linkconfig~LinkDecoratorAutomaticDefinition automatic decorators}\n  * and registers a {@link module:engine/conversion/downcastdispatcher~DowncastDispatcher downcast dispatcher}\n  * for each one of them. Downcast dispatchers are obtained using the\n  * {@link module:link/utils/automaticdecorators~AutomaticDecorators#getDispatcher} method.\n  *\n  * **Note**: This method also activates the automatic external link decorator if enabled with\n  * {@link module:link/linkconfig~LinkConfig#addTargetToExternalLinks `config.link.addTargetToExternalLinks`}.\n  */\n  _enableAutomaticDecorators(automaticDecoratorDefinitions) {\n    const editor = this.editor;\n    // Store automatic decorators in the command instance as we do the same with manual decorators.\n    // Thanks to that, `LinkImageEditing` plugin can re-use the same definitions.\n    const command = editor.commands.get('link');\n    const automaticDecorators = command.automaticDecorators;\n    // Adds a default decorator for external links.\n    if (editor.config.get('link.addTargetToExternalLinks')) {\n      automaticDecorators.add({\n        id: 'linkIsExternal',\n        mode: DECORATOR_AUTOMATIC,\n        callback: url => !!url && EXTERNAL_LINKS_REGEXP.test(url),\n        attributes: {\n          target: '_blank',\n          rel: 'noopener noreferrer'\n        }\n      });\n    }\n    automaticDecorators.add(automaticDecoratorDefinitions);\n    if (automaticDecorators.length) {\n      editor.conversion.for('downcast').add(automaticDecorators.getDispatcher());\n    }\n  }\n  /**\n  * Processes an array of configured {@link module:link/linkconfig~LinkDecoratorManualDefinition manual decorators},\n  * transforms them into {@link module:link/utils/manualdecorator~ManualDecorator} instances and stores them in the\n  * {@link module:link/linkcommand~LinkCommand#manualDecorators} collection (a model for manual decorators state).\n  *\n  * Also registers an {@link module:engine/conversion/downcasthelpers~DowncastHelpers#attributeToElement attribute-to-element}\n  * converter for each manual decorator and extends the {@link module:engine/model/schema~Schema model's schema}\n  * with adequate model attributes.\n  */\n  _enableManualDecorators(manualDecoratorDefinitions) {\n    if (!manualDecoratorDefinitions.length) {\n      return;\n    }\n    const editor = this.editor;\n    const command = editor.commands.get('link');\n    const manualDecorators = command.manualDecorators;\n    manualDecoratorDefinitions.forEach(decoratorDefinition => {\n      editor.model.schema.extend('$text', {\n        allowAttributes: decoratorDefinition.id\n      });\n      // Keeps reference to manual decorator to decode its name to attributes during downcast.\n      const decorator = new ManualDecorator(decoratorDefinition);\n      manualDecorators.add(decorator);\n      editor.conversion.for('downcast').attributeToElement({\n        model: decorator.id,\n        view: (manualDecoratorValue, {\n          writer,\n          schema\n        }, {\n          item\n        }) => {\n          // Manual decorators for block links are handled e.g. in LinkImageEditing.\n          if (!(item.is('selection') || schema.isInline(item))) {\n            return;\n          }\n          if (manualDecoratorValue) {\n            const element = writer.createAttributeElement('a', decorator.attributes, {\n              priority: 5\n            });\n            if (decorator.classes) {\n              writer.addClass(decorator.classes, element);\n            }\n            for (const key in decorator.styles) {\n              writer.setStyle(key, decorator.styles[key], element);\n            }\n            writer.setCustomProperty('link', true, element);\n            return element;\n          }\n        }\n      });\n      editor.conversion.for('upcast').elementToAttribute({\n        view: {\n          name: 'a',\n          ...decorator._createPattern()\n        },\n        model: {\n          key: decorator.id\n        }\n      });\n    });\n  }\n  /**\n  * Attaches handlers for {@link module:engine/view/document~Document#event:enter} and\n  * {@link module:engine/view/document~Document#event:click} to enable link following.\n  */\n  _enableLinkOpen() {\n    const editor = this.editor;\n    const view = editor.editing.view;\n    const viewDocument = view.document;\n    const handleLinkOpening = url => {\n      if (!this._linkOpeners.some(opener => opener(url))) {\n        openLink(url);\n      }\n    };\n    this.listenTo(viewDocument, 'click', (evt, data) => {\n      const shouldOpen = env.isMac ? data.domEvent.metaKey : data.domEvent.ctrlKey;\n      if (!shouldOpen) {\n        return;\n      }\n      let clickedElement = data.domTarget;\n      if (clickedElement.tagName.toLowerCase() != 'a') {\n        clickedElement = clickedElement.closest('a');\n      }\n      if (!clickedElement) {\n        return;\n      }\n      const url = clickedElement.getAttribute('href');\n      if (!url) {\n        return;\n      }\n      evt.stop();\n      data.preventDefault();\n      handleLinkOpening(url);\n    }, {\n      context: '$capture'\n    });\n    // Open link on Alt+Enter.\n    this.listenTo(viewDocument, 'keydown', (evt, data) => {\n      const linkCommand = editor.commands.get('link');\n      const url = linkCommand.value;\n      const shouldOpen = !!url && data.keyCode === keyCodes.enter && data.altKey;\n      if (!shouldOpen) {\n        return;\n      }\n      evt.stop();\n      handleLinkOpening(url);\n    });\n  }\n  /**\n  * Watches the DocumentSelection attribute changes and removes link decorator attributes when the linkHref attribute is removed.\n  *\n  * This is to ensure that there is no left-over link decorator attributes on the document selection that is no longer in a link.\n  */\n  _enableSelectionAttributesFixer() {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    this.listenTo(selection, 'change:attribute', (evt, {\n      attributeKeys\n    }) => {\n      if (!attributeKeys.includes('linkHref') || selection.hasAttribute('linkHref')) {\n        return;\n      }\n      model.change(writer => {\n        removeLinkAttributesFromSelection(writer, getLinkAttributesAllowedOnText(model.schema));\n      });\n    });\n  }\n  /**\n  * Enables URL fixing on pasting.\n  */\n  _enableClipboardIntegration() {\n    const editor = this.editor;\n    const model = editor.model;\n    const defaultProtocol = this.editor.config.get('link.defaultProtocol');\n    if (!defaultProtocol) {\n      return;\n    }\n    this.listenTo(editor.plugins.get('ClipboardPipeline'), 'contentInsertion', (evt, data) => {\n      model.change(writer => {\n        const range = writer.createRangeIn(data.content);\n        for (const item of range.getItems()) {\n          if (item.hasAttribute('linkHref')) {\n            const newLink = addLinkProtocolIfApplicable(item.getAttribute('linkHref'), defaultProtocol);\n            writer.setAttribute('linkHref', newLink, item);\n          }\n        }\n      });\n    });\n  }\n}\n/**\n * Make the selection free of link-related model attributes.\n * All link-related model attributes start with \"link\". That includes not only \"linkHref\"\n * but also all decorator attributes (they have dynamic names), or even custom plugins.\n */\nfunction removeLinkAttributesFromSelection(writer, linkAttributes) {\n  writer.removeSelectionAttribute('linkHref');\n  for (const attribute of linkAttributes) {\n    writer.removeSelectionAttribute(attribute);\n  }\n}\n/**\n * Returns an array containing names of the attributes allowed on `$text` that describes the link item.\n */\nfunction getLinkAttributesAllowedOnText(schema) {\n  const textAttributes = schema.getDefinition('$text').allowAttributes;\n  return textAttributes.filter(attribute => attribute.startsWith('link'));\n}\n\n/**\n * The link button class. Rendered as an `<a>` tag with link opening in a new tab.\n *\n * Provides a custom `navigate` cancelable event.\n */\nclass LinkPreviewButtonView extends ButtonView {\n  /**\n  * @inheritDoc\n  */\n  constructor(locale) {\n    super(locale);\n    const bind = this.bindTemplate;\n    this.set({\n      href: undefined,\n      withText: true\n    });\n    this.extendTemplate({\n      attributes: {\n        class: ['ck-link-toolbar__preview'],\n        href: bind.to('href'),\n        target: '_blank',\n        rel: 'noopener noreferrer'\n      },\n      on: {\n        click: bind.to(evt => {\n          if (this.href) {\n            const cancel = () => evt.preventDefault();\n            this.fire('navigate', this.href, cancel);\n          }\n        })\n      }\n    });\n    this.template.tag = 'a';\n  }\n}\n\n/**\n * The link form view.\n */\nclass LinkFormView extends View {\n  /**\n  * Tracks information about DOM focus in the form.\n  */\n  focusTracker = new FocusTracker();\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes = new KeystrokeHandler();\n  /**\n  * The Back button view displayed in the header.\n  */\n  backButtonView;\n  /**\n  * The Save button view.\n  */\n  saveButtonView;\n  /**\n  * The \"Displayed text\" input view.\n  */\n  displayedTextInputView;\n  /**\n  * The URL input view.\n  */\n  urlInputView;\n  /**\n  * A collection of child views.\n  */\n  children;\n  /**\n  * A collection of child views in the providers list.\n  */\n  providersListChildren;\n  /**\n  * An array of form validators used by {@link #isValid}.\n  */\n  _validators;\n  /**\n  * A collection of views that can be focused in the form.\n  */\n  _focusables = new ViewCollection();\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * Creates an instance of the {@link module:link/ui/linkformview~LinkFormView} class.\n  *\n  * Also see {@link #render}.\n  *\n  * @param locale The localization services instance.\n  * @param validators  Form validators used by {@link #isValid}.\n  */\n  constructor(locale, validators) {\n    super(locale);\n    this._validators = validators;\n    // Create buttons.\n    this.backButtonView = this._createBackButton();\n    this.saveButtonView = this._createSaveButton();\n    // Create input fields.\n    this.displayedTextInputView = this._createDisplayedTextInput();\n    this.urlInputView = this._createUrlInput();\n    this.providersListChildren = this.createCollection();\n    this.children = this.createCollection([this._createHeaderView()]);\n    this._createFormChildren();\n    // Add providers list view to the children when the first item is added to the list.\n    // This is to avoid adding the list view when the form is empty.\n    this.listenTo(this.providersListChildren, 'add', () => {\n      this.stopListening(this.providersListChildren, 'add');\n      this.children.add(this._createProvidersListView());\n    });\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-form', 'ck-link-form', 'ck-responsive-form'],\n        // https://github.com/ckeditor/ckeditor5-link/issues/90\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    submitHandler({\n      view: this\n    });\n    const childViews = [this.urlInputView, this.saveButtonView, ...this.providersListChildren, this.backButtonView, this.displayedTextInputView];\n    childViews.forEach(v => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n    });\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the fist {@link #_focusables} in the form.\n  */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n  /**\n  * Validates the form and returns `false` when some fields are invalid.\n  */\n  isValid() {\n    this.resetFormStatus();\n    for (const validator of this._validators) {\n      const errorText = validator(this);\n      // One error per field is enough.\n      if (errorText) {\n        // Apply updated error.\n        this.urlInputView.errorText = errorText;\n        return false;\n      }\n    }\n    return true;\n  }\n  /**\n  * Cleans up the supplementary error and information text of the {@link #urlInputView}\n  * bringing them back to the state when the form has been displayed for the first time.\n  *\n  * See {@link #isValid}.\n  */\n  resetFormStatus() {\n    this.urlInputView.errorText = null;\n  }\n  /**\n  * Creates a back button view that cancels the form.\n  */\n  _createBackButton() {\n    const t = this.locale.t;\n    const backButton = new ButtonView(this.locale);\n    backButton.set({\n      class: 'ck-button-back',\n      label: t('Back'),\n      icon: IconPreviousArrow,\n      tooltip: true\n    });\n    backButton.delegate('execute').to(this, 'cancel');\n    return backButton;\n  }\n  /**\n  * Creates a save button view that inserts the link.\n  */\n  _createSaveButton() {\n    const t = this.locale.t;\n    const saveButton = new ButtonView(this.locale);\n    saveButton.set({\n      label: t('Insert'),\n      tooltip: false,\n      withText: true,\n      type: 'submit',\n      class: 'ck-button-action ck-button-bold'\n    });\n    return saveButton;\n  }\n  /**\n  * Creates a header view for the form.\n  */\n  _createHeaderView() {\n    const t = this.locale.t;\n    const header = new FormHeaderView(this.locale, {\n      label: t('Link')\n    });\n    header.children.add(this.backButtonView, 0);\n    return header;\n  }\n  /**\n  * Creates a view for the providers list.\n  */\n  _createProvidersListView() {\n    const providersListView = new ListView(this.locale);\n    providersListView.extendTemplate({\n      attributes: {\n        class: ['ck-link-form__providers-list']\n      }\n    });\n    providersListView.items.bindTo(this.providersListChildren).using(def => {\n      const listItemView = new ListItemView(this.locale);\n      listItemView.children.add(def);\n      return listItemView;\n    });\n    return providersListView;\n  }\n  /**\n  * Creates a labeled input view for the \"Displayed text\" field.\n  */\n  _createDisplayedTextInput() {\n    const t = this.locale.t;\n    const labeledInput = new LabeledFieldView(this.locale, createLabeledInputText);\n    labeledInput.label = t('Displayed text');\n    labeledInput.class = 'ck-labeled-field-view_full-width';\n    return labeledInput;\n  }\n  /**\n  * Creates a labeled input view for the URL field.\n  *\n  * @returns Labeled field view instance.\n  */\n  _createUrlInput() {\n    const t = this.locale.t;\n    const labeledInput = new LabeledFieldView(this.locale, createLabeledInputText);\n    labeledInput.fieldView.inputMode = 'url';\n    labeledInput.label = t('Link URL');\n    labeledInput.class = 'ck-labeled-field-view_full-width';\n    return labeledInput;\n  }\n  /**\n  * Populates the {@link #children} collection of the form.\n  */\n  _createFormChildren() {\n    this.children.add(new FormRowView(this.locale, {\n      children: [this.displayedTextInputView],\n      class: ['ck-form__row_large-top-padding']\n    }));\n    this.children.add(new FormRowView(this.locale, {\n      children: [this.urlInputView, this.saveButtonView],\n      class: ['ck-form__row_with-submit', 'ck-form__row_large-top-padding', 'ck-form__row_large-bottom-padding']\n    }));\n  }\n  /**\n  * The native DOM `value` of the {@link #urlInputView} element.\n  *\n  * **Note**: Do not confuse it with the {@link module:ui/inputtext/inputtextview~InputTextView#value}\n  * which works one way only and may not represent the actual state of the component in the DOM.\n  */\n  get url() {\n    const {\n      element\n    } = this.urlInputView.fieldView;\n    if (!element) {\n      return null;\n    }\n    return element.value.trim();\n  }\n}\n\n/**\n * The link provider items view.\n */\nclass LinkProviderItemsView extends View {\n  /**\n  * Tracks information about DOM focus in the form.\n  */\n  focusTracker = new FocusTracker();\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes = new KeystrokeHandler();\n  /**\n  * The Back button view displayed in the header.\n  */\n  backButtonView;\n  /**\n  * The List view of links buttons.\n  */\n  listView;\n  /**\n  * The collection of child views, which is bind with the `listView`.\n  */\n  listChildren;\n  /**\n  * The view displayed when the list is empty.\n  */\n  emptyListInformation;\n  /**\n  * A collection of child views.\n  */\n  children;\n  /**\n  * A collection of views that can be focused in the form.\n  */\n  _focusables = new ViewCollection();\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * Creates an instance of the {@link module:link/ui/linkprovideritemsview~LinkProviderItemsView} class.\n  *\n  * Also see {@link #render}.\n  *\n  * @param locale The localization services instance.\n  */\n  constructor(locale) {\n    super(locale);\n    this.listChildren = this.createCollection();\n    this.backButtonView = this._createBackButton();\n    this.listView = this._createListView();\n    this.emptyListInformation = this._createEmptyLinksListItemView();\n    this.children = this.createCollection([this._createHeaderView(), this.emptyListInformation]);\n    this.set('title', '');\n    this.set('emptyListPlaceholder', '');\n    this.set('hasItems', false);\n    this.listenTo(this.listChildren, 'change', () => {\n      this.hasItems = this.listChildren.length > 0;\n    });\n    this.on('change:hasItems', (evt, propName, hasItems) => {\n      if (hasItems) {\n        this.children.remove(this.emptyListInformation);\n        this.children.add(this.listView);\n      } else {\n        this.children.remove(this.listView);\n        this.children.add(this.emptyListInformation);\n      }\n    });\n    // Close the panel on esc key press when the **form has focus**.\n    this.keystrokes.set('Esc', (data, cancel) => {\n      this.fire('cancel');\n      cancel();\n    });\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-link-providers'],\n        // https://github.com/ckeditor/ckeditor5-link/issues/90\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    const childViews = [this.listView, this.backButtonView];\n    childViews.forEach(v => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n    });\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the fist {@link #_focusables} in the form.\n  */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n  /**\n  * Creates a view for the list at the bottom.\n  */\n  _createListView() {\n    const listView = new ListView(this.locale);\n    listView.extendTemplate({\n      attributes: {\n        class: ['ck-link-providers__list']\n      }\n    });\n    listView.items.bindTo(this.listChildren).using(button => {\n      const listItemView = new ListItemView(this.locale);\n      listItemView.children.add(button);\n      return listItemView;\n    });\n    return listView;\n  }\n  /**\n  * Creates a back button view that cancels the form.\n  */\n  _createBackButton() {\n    const t = this.locale.t;\n    const backButton = new ButtonView(this.locale);\n    backButton.set({\n      class: 'ck-button-back',\n      label: t('Back'),\n      icon: IconPreviousArrow$1,\n      tooltip: true\n    });\n    backButton.delegate('execute').to(this, 'cancel');\n    return backButton;\n  }\n  /**\n  * Creates a header view for the form.\n  */\n  _createHeaderView() {\n    const header = new FormHeaderView(this.locale);\n    header.bind('label').to(this, 'title');\n    header.children.add(this.backButtonView, 0);\n    return header;\n  }\n  /**\n  * Creates an info view for an empty list.\n  */\n  _createEmptyLinksListItemView() {\n    const view = new View(this.locale);\n    view.setTemplate({\n      tag: 'p',\n      attributes: {\n        class: ['ck', 'ck-link__empty-list-info']\n      },\n      children: [{\n        text: this.bindTemplate.to('emptyListPlaceholder')\n      }]\n    });\n    return view;\n  }\n}\n\n/**\n * The link properties view controller class.\n *\n * See {@link module:link/ui/linkpropertiesview~LinkPropertiesView}.\n */\nclass LinkPropertiesView extends View {\n  /**\n  * Tracks information about DOM focus in the form.\n  */\n  focusTracker = new FocusTracker();\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes = new KeystrokeHandler();\n  /**\n  * The Back button view displayed in the header.\n  */\n  backButtonView;\n  /**\n  * A collection of child views.\n  */\n  children;\n  /**\n  * A collection of {@link module:ui/button/switchbuttonview~SwitchButtonView},\n  * which corresponds to {@link module:link/linkcommand~LinkCommand#manualDecorators manual decorators}\n  * configured in the editor.\n  */\n  listChildren;\n  /**\n  * A collection of views that can be focused in the form.\n  */\n  _focusables = new ViewCollection();\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * Creates an instance of the {@link module:link/ui/linkpropertiesview~LinkPropertiesView} class.\n  *\n  * Also see {@link #render}.\n  *\n  * @param locale The localization services instance.\n  */\n  constructor(locale) {\n    super(locale);\n    this.backButtonView = this._createBackButton();\n    this.listChildren = this.createCollection();\n    this.children = this.createCollection([this._createHeaderView(), this._createListView()]);\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-link-properties'],\n        // https://github.com/ckeditor/ckeditor5-link/issues/90\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n    // Close the panel on esc key press when the **form has focus**.\n    this.keystrokes.set('Esc', (data, cancel) => {\n      this.fire('back');\n      cancel();\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    const childViews = [...this.listChildren, this.backButtonView];\n    childViews.forEach(v => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n    });\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the fist {@link #_focusables} in the form.\n  */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n  /**\n  * Creates a back button view.\n  */\n  _createBackButton() {\n    const t = this.locale.t;\n    const backButton = new ButtonView(this.locale);\n    // TODO: maybe we should have a dedicated BackButtonView in the UI library.\n    backButton.set({\n      class: 'ck-button-back',\n      label: t('Back'),\n      icon: IconPreviousArrow$1,\n      tooltip: true\n    });\n    backButton.delegate('execute').to(this, 'back');\n    return backButton;\n  }\n  /**\n  * Creates a header view for the form.\n  */\n  _createHeaderView() {\n    const t = this.locale.t;\n    const header = new FormHeaderView(this.locale, {\n      label: t('Link properties')\n    });\n    header.children.add(this.backButtonView, 0);\n    return header;\n  }\n  /**\n  * Creates a form view that displays the {@link #listChildren} collection.\n  */\n  _createListView() {\n    const listView = new ListView(this.locale);\n    listView.extendTemplate({\n      attributes: {\n        class: ['ck-link__list']\n      }\n    });\n    listView.items.bindTo(this.listChildren).using(item => {\n      const listItemView = new ListItemView(this.locale);\n      listItemView.children.add(item);\n      return listItemView;\n    });\n    return listView;\n  }\n}\n\n/**\n * Represents a view for a dropdown menu button.\n */\nclass LinkButtonView extends ButtonView {\n  /**\n  * An icon that displays an arrow to indicate a direction of the menu.\n  */\n  arrowView;\n  /**\n  * Creates an instance of the dropdown menu button view.\n  *\n  * @param locale The localization services instance.\n  */\n  constructor(locale) {\n    super(locale);\n    this.set({\n      withText: true\n    });\n    this.arrowView = this._createArrowView();\n    this.extendTemplate({\n      attributes: {\n        class: ['ck-link__button']\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.children.add(this.arrowView);\n  }\n  /**\n  * Creates the arrow view instance.\n  *\n  * @private\n  */\n  _createArrowView() {\n    const arrowView = new IconView();\n    arrowView.content = IconNextArrow;\n    return arrowView;\n  }\n}\nconst VISUAL_SELECTION_MARKER_NAME = 'link-ui';\n/**\n * The link UI plugin. It introduces the `'link'` and `'unlink'` buttons and support for the <kbd>Ctrl+K</kbd> keystroke.\n *\n * It uses the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon plugin}.\n */\nclass LinkUI extends Plugin {\n  /**\n  * The toolbar view displayed inside of the balloon.\n  */\n  toolbarView = null;\n  /**\n  * The form view displayed inside the balloon.\n  */\n  formView = null;\n  /**\n  * The view displaying links list.\n  */\n  linkProviderItemsView = null;\n  /**\n  * The form view displaying properties link settings.\n  */\n  propertiesView = null;\n  /**\n  * The contextual balloon plugin instance.\n  */\n  _balloon;\n  /**\n  * The collection of the link providers.\n  */\n  _linksProviders = new Collection();\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ContextualBalloon, LinkEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LinkUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = this.editor.t;\n    this.set('selectedLinkableText', undefined);\n    editor.editing.view.addObserver(ClickObserver);\n    this._balloon = editor.plugins.get(ContextualBalloon);\n    // Create toolbar buttons.\n    this._registerComponents();\n    this._registerEditingOpeners();\n    this._enableBalloonActivators();\n    // Renders a fake visual selection marker on an expanded selection.\n    editor.conversion.for('editingDowncast').markerToHighlight({\n      model: VISUAL_SELECTION_MARKER_NAME,\n      view: {\n        classes: ['ck-fake-link-selection']\n      }\n    });\n    // Renders a fake visual selection marker on a collapsed selection.\n    editor.conversion.for('editingDowncast').markerToElement({\n      model: VISUAL_SELECTION_MARKER_NAME,\n      view: (data, {\n        writer\n      }) => {\n        if (!data.markerRange.isCollapsed) {\n          return null;\n        }\n        const markerElement = writer.createUIElement('span');\n        writer.addClass(['ck-fake-link-selection', 'ck-fake-link-selection_collapsed'], markerElement);\n        return markerElement;\n      }\n    });\n    // Add the information about the keystrokes to the accessibility database.\n    editor.accessibility.addKeystrokeInfos({\n      keystrokes: [{\n        label: t('Create link'),\n        keystroke: LINK_KEYSTROKE\n      }, {\n        label: t('Move out of a link'),\n        keystroke: [['arrowleft', 'arrowleft'], ['arrowright', 'arrowright']]\n      }]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    // Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n    if (this.propertiesView) {\n      this.propertiesView.destroy();\n    }\n    if (this.formView) {\n      this.formView.destroy();\n    }\n    if (this.toolbarView) {\n      this.toolbarView.destroy();\n    }\n    if (this.linkProviderItemsView) {\n      this.linkProviderItemsView.destroy();\n    }\n  }\n  /**\n  * Registers list of buttons below the link form view that\n  * open a list of links provided by the clicked provider.\n  */\n  registerLinksListProvider(provider) {\n    const insertIndex = this._linksProviders.filter(existing => (existing.order || 0) <= (provider.order || 0)).length;\n    this._linksProviders.add(provider, insertIndex);\n  }\n  /**\n  * Creates views.\n  */\n  _createViews() {\n    const linkCommand = this.editor.commands.get('link');\n    this.toolbarView = this._createToolbarView();\n    this.formView = this._createFormView();\n    if (linkCommand.manualDecorators.length) {\n      this.propertiesView = this._createPropertiesView();\n    }\n    // Attach lifecycle actions to the the balloon.\n    this._enableUserBalloonInteractions();\n  }\n  /**\n  * Creates the ToolbarView instance.\n  */\n  _createToolbarView() {\n    const editor = this.editor;\n    const toolbarView = new ToolbarView(editor.locale);\n    const linkCommand = editor.commands.get('link');\n    toolbarView.class = 'ck-link-toolbar';\n    // Remove the linkProperties button if there are no manual decorators, as it would be useless.\n    let toolbarItems = editor.config.get('link.toolbar');\n    if (!linkCommand.manualDecorators.length) {\n      toolbarItems = toolbarItems.filter(item => item !== 'linkProperties');\n    }\n    toolbarView.fillFromConfig(toolbarItems, editor.ui.componentFactory);\n    // Close the panel on esc key press when the **link toolbar have focus**.\n    toolbarView.keystrokes.set('Esc', (data, cancel) => {\n      this._hideUI();\n      cancel();\n    });\n    // Open the form view on Ctrl+K when the **link toolbar have focus**..\n    toolbarView.keystrokes.set(LINK_KEYSTROKE, (data, cancel) => {\n      this._addFormView();\n      cancel();\n    });\n    // Register the toolbar, so it becomes available for Alt+F10 and Esc navigation.\n    // TODO this should be registered earlier to be able to open this toolbar without previously opening it by click or Ctrl+K\n    editor.ui.addToolbar(toolbarView, {\n      isContextual: true,\n      beforeFocus: () => {\n        if (this._getSelectedLinkElement() && !this._isToolbarVisible) {\n          this._showUI(true);\n        }\n      },\n      afterBlur: () => {\n        this._hideUI(false);\n      }\n    });\n    return toolbarView;\n  }\n  /**\n  * Creates the {@link module:link/ui/linkformview~LinkFormView} instance.\n  */\n  _createFormView() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const linkCommand = editor.commands.get('link');\n    const defaultProtocol = editor.config.get('link.defaultProtocol');\n    const formView = new (CssTransitionDisablerMixin(LinkFormView))(editor.locale, getFormValidators(editor));\n    formView.displayedTextInputView.bind('isEnabled').to(this, 'selectedLinkableText', value => value !== undefined);\n    // Form elements should be read-only when corresponding commands are disabled.\n    formView.urlInputView.bind('isEnabled').to(linkCommand, 'isEnabled');\n    // Disable the \"save\" button if the command is disabled.\n    formView.saveButtonView.bind('isEnabled').to(linkCommand, 'isEnabled');\n    // Change the \"Save\" button label depending on the command state.\n    formView.saveButtonView.bind('label').to(linkCommand, 'value', value => value ? t('Update') : t('Insert'));\n    // Execute link command after clicking the \"Save\" button.\n    this.listenTo(formView, 'submit', () => {\n      if (formView.isValid()) {\n        const url = formView.urlInputView.fieldView.element.value;\n        const parsedUrl = addLinkProtocolIfApplicable(url, defaultProtocol);\n        const displayedText = formView.displayedTextInputView.fieldView.element.value;\n        editor.execute('link', parsedUrl, this._getDecoratorSwitchesState(), displayedText !== this.selectedLinkableText ? displayedText : undefined);\n        this._closeFormView();\n      }\n    });\n    // Update balloon position when form error changes.\n    this.listenTo(formView.urlInputView, 'change:errorText', () => {\n      editor.ui.update();\n    });\n    // Hide the panel after clicking the \"Cancel\" button.\n    this.listenTo(formView, 'cancel', () => {\n      this._closeFormView();\n    });\n    // Close the panel on esc key press when the **form has focus**.\n    formView.keystrokes.set('Esc', (data, cancel) => {\n      this._closeFormView();\n      cancel();\n    });\n    // Watch adding new link providers and add them to the buttons list.\n    formView.providersListChildren.bindTo(this._linksProviders).using(provider => this._createLinksListProviderButton(provider));\n    return formView;\n  }\n  /**\n  * Creates a sorted array of buttons with link names.\n  */\n  _createLinkProviderListView(provider) {\n    return provider.getListItems().map(({\n      href,\n      label,\n      icon\n    }) => {\n      const buttonView = new ButtonView();\n      buttonView.set({\n        label,\n        icon,\n        tooltip: false,\n        withText: true\n      });\n      buttonView.on('execute', () => {\n        this.formView.resetFormStatus();\n        this.formView.urlInputView.fieldView.value = href;\n        // Set focus to the editing view to prevent from losing it while current view is removed.\n        this.editor.editing.view.focus();\n        this._removeLinksProviderView();\n        // Set the focus to the URL input field.\n        this.formView.focus();\n      });\n      return buttonView;\n    });\n  }\n  /**\n  * Creates a view for links provider.\n  */\n  _createLinkProviderItemsView(provider) {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const view = new LinkProviderItemsView(editor.locale);\n    const {\n      emptyListPlaceholder,\n      label\n    } = provider;\n    view.emptyListPlaceholder = emptyListPlaceholder || t('No links available');\n    view.title = label;\n    // Hide the panel after clicking the \"Cancel\" button.\n    this.listenTo(view, 'cancel', () => {\n      // Set focus to the editing view to prevent from losing it while current view is removed.\n      editor.editing.view.focus();\n      this._removeLinksProviderView();\n      // Set the focus to the URL input field.\n      this.formView.focus();\n    });\n    return view;\n  }\n  /**\n  * Creates the {@link module:link/ui/linkpropertiesview~LinkPropertiesView} instance.\n  */\n  _createPropertiesView() {\n    const editor = this.editor;\n    const linkCommand = this.editor.commands.get('link');\n    const view = new (CssTransitionDisablerMixin(LinkPropertiesView))(editor.locale);\n    // Hide the panel after clicking the back button.\n    this.listenTo(view, 'back', () => {\n      // Move focus back to the editing view to prevent from losing it while current view is removed.\n      editor.editing.view.focus();\n      this._removePropertiesView();\n    });\n    view.listChildren.bindTo(linkCommand.manualDecorators).using(manualDecorator => {\n      const button = new SwitchButtonView(editor.locale);\n      button.set({\n        label: manualDecorator.label,\n        withText: true\n      });\n      button.bind('isOn').toMany([manualDecorator, linkCommand], 'value', (decoratorValue, commandValue) => {\n        return commandValue === undefined && decoratorValue === undefined ? !!manualDecorator.defaultValue : !!decoratorValue;\n      });\n      button.on('execute', () => {\n        manualDecorator.set('value', !button.isOn);\n        editor.execute('link', linkCommand.value, this._getDecoratorSwitchesState());\n      });\n      return button;\n    });\n    return view;\n  }\n  /**\n  * Obtains the state of the manual decorators.\n  */\n  _getDecoratorSwitchesState() {\n    const linkCommand = this.editor.commands.get('link');\n    return Array.from(linkCommand.manualDecorators).reduce((accumulator, manualDecorator) => {\n      const value = linkCommand.value === undefined && manualDecorator.value === undefined ? manualDecorator.defaultValue : manualDecorator.value;\n      return {\n        ...accumulator,\n        [manualDecorator.id]: !!value\n      };\n    }, {});\n  }\n  /**\n  * Registers listeners used in editing plugin, used to open links.\n  */\n  _registerEditingOpeners() {\n    const linkEditing = this.editor.plugins.get(LinkEditing);\n    linkEditing._registerLinkOpener(href => {\n      const match = this._getLinkProviderLinkByHref(href);\n      if (!match) {\n        return false;\n      }\n      const {\n        item,\n        provider\n      } = match;\n      if (provider.navigate) {\n        return provider.navigate(item);\n      }\n      return false;\n    });\n  }\n  /**\n  * Registers components in the ComponentFactory.\n  */\n  _registerComponents() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('link', () => {\n      const button = this._createButton(ButtonView);\n      button.set({\n        tooltip: true\n      });\n      return button;\n    });\n    editor.ui.componentFactory.add('menuBar:link', () => {\n      const button = this._createButton(MenuBarMenuListItemButtonView);\n      button.set({\n        role: 'menuitemcheckbox'\n      });\n      return button;\n    });\n    editor.ui.componentFactory.add('linkPreview', locale => {\n      const button = new LinkPreviewButtonView(locale);\n      const allowedProtocols = editor.config.get('link.allowedProtocols');\n      const linkCommand = editor.commands.get('link');\n      const t = locale.t;\n      button.bind('isEnabled').to(linkCommand, 'value', href => !!href);\n      button.bind('href').to(linkCommand, 'value', href => {\n        return href && ensureSafeUrl(href, allowedProtocols);\n      });\n      const setHref = href => {\n        if (!href) {\n          button.label = undefined;\n          button.icon = undefined;\n          button.tooltip = t('Open link in new tab');\n          return;\n        }\n        const selectedLinksProviderLink = this._getLinkProviderLinkByHref(href);\n        if (selectedLinksProviderLink) {\n          const {\n            label,\n            tooltip,\n            icon\n          } = selectedLinksProviderLink.item;\n          button.label = label;\n          button.tooltip = tooltip || false;\n          button.icon = icon;\n        } else {\n          button.label = href;\n          button.icon = undefined;\n          button.tooltip = t('Open link in new tab');\n        }\n      };\n      setHref(linkCommand.value);\n      this.listenTo(linkCommand, 'change:value', (evt, name, href) => {\n        setHref(href);\n      });\n      this.listenTo(button, 'navigate', (evt, href, cancel) => {\n        const selectedLinksProviderLink = this._getLinkProviderLinkByHref(href);\n        if (!selectedLinksProviderLink) {\n          return;\n        }\n        const {\n          provider,\n          item\n        } = selectedLinksProviderLink;\n        const {\n          navigate\n        } = provider;\n        if (navigate && navigate(item)) {\n          evt.stop();\n          cancel();\n        }\n      });\n      return button;\n    });\n    editor.ui.componentFactory.add('unlink', locale => {\n      const unlinkCommand = editor.commands.get('unlink');\n      const button = new ButtonView(locale);\n      const t = locale.t;\n      button.set({\n        label: t('Unlink'),\n        icon: IconUnlink,\n        tooltip: true\n      });\n      button.bind('isEnabled').to(unlinkCommand);\n      this.listenTo(button, 'execute', () => {\n        editor.execute('unlink');\n        this._hideUI();\n      });\n      return button;\n    });\n    editor.ui.componentFactory.add('editLink', locale => {\n      const linkCommand = editor.commands.get('link');\n      const button = new ButtonView(locale);\n      const t = locale.t;\n      button.set({\n        label: t('Edit link'),\n        icon: IconPencil,\n        tooltip: true\n      });\n      button.bind('isEnabled').to(linkCommand);\n      this.listenTo(button, 'execute', () => {\n        this._addFormView();\n      });\n      return button;\n    });\n    editor.ui.componentFactory.add('linkProperties', locale => {\n      const linkCommand = editor.commands.get('link');\n      const button = new ButtonView(locale);\n      const t = locale.t;\n      button.set({\n        label: t('Link properties'),\n        icon: IconSettings,\n        tooltip: true\n      });\n      button.bind('isEnabled').to(linkCommand, 'isEnabled', linkCommand, 'value', linkCommand, 'manualDecorators', (isEnabled, href, manualDecorators) => isEnabled && !!href && manualDecorators.length > 0);\n      this.listenTo(button, 'execute', () => {\n        this._addPropertiesView();\n      });\n      return button;\n    });\n  }\n  /**\n  * Creates a links button view.\n  */\n  _createLinksListProviderButton(linkProvider) {\n    const locale = this.editor.locale;\n    const linksButton = new LinkButtonView(locale);\n    linksButton.set({\n      label: linkProvider.label\n    });\n    this.listenTo(linksButton, 'execute', () => {\n      this._showLinksProviderView(linkProvider);\n    });\n    return linksButton;\n  }\n  /**\n  * Creates a button for link command to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const command = editor.commands.get('link');\n    const view = new ButtonClass(editor.locale);\n    const t = locale.t;\n    view.set({\n      label: t('Link'),\n      icon: IconLink,\n      keystroke: LINK_KEYSTROKE,\n      isToggleable: true\n    });\n    view.bind('isEnabled').to(command, 'isEnabled');\n    view.bind('isOn').to(command, 'value', value => !!value);\n    // Show the panel on button click.\n    this.listenTo(view, 'execute', () => {\n      editor.editing.view.scrollToTheSelection();\n      this._showUI(true);\n      // Open the form view on-top of the toolbar view if it's already visible.\n      // It should be visible every time the link is selected.\n      if (this._getSelectedLinkElement()) {\n        this._addFormView();\n      }\n    });\n    return view;\n  }\n  /**\n  * Attaches actions that control whether the balloon panel containing the\n  * {@link #formView} should be displayed.\n  */\n  _enableBalloonActivators() {\n    const editor = this.editor;\n    const viewDocument = editor.editing.view.document;\n    // Handle click on view document and show panel when selection is placed inside the link element.\n    // Keep panel open until selection will be inside the same link element.\n    this.listenTo(viewDocument, 'click', () => {\n      const parentLink = this._getSelectedLinkElement();\n      if (parentLink) {\n        // Then show panel but keep focus inside editor editable.\n        this._showUI();\n      }\n    });\n    // Handle the `Ctrl+K` keystroke and show the panel.\n    editor.keystrokes.set(LINK_KEYSTROKE, (keyEvtData, cancel) => {\n      // Prevent focusing the search bar in FF, Chrome and Edge. See https://github.com/ckeditor/ckeditor5/issues/4811.\n      cancel();\n      if (editor.commands.get('link').isEnabled) {\n        editor.editing.view.scrollToTheSelection();\n        this._showUI(true);\n      }\n    });\n  }\n  /**\n  * Attaches actions that control whether the balloon panel containing the\n  * {@link #formView} is visible or not.\n  */\n  _enableUserBalloonInteractions() {\n    // Focus the form if the balloon is visible and the Tab key has been pressed.\n    this.editor.keystrokes.set('Tab', (data, cancel) => {\n      if (this._isToolbarVisible && !this.toolbarView.focusTracker.isFocused) {\n        this.toolbarView.focus();\n        cancel();\n      }\n    }, {\n      // Use the high priority because the link UI navigation is more important\n      // than other feature's actions, e.g. list indentation.\n      // https://github.com/ckeditor/ckeditor5-link/issues/146\n      priority: 'high'\n    });\n    // Close the panel on the Esc key press when the editable has focus and the balloon is visible.\n    this.editor.keystrokes.set('Esc', (data, cancel) => {\n      if (this._isUIVisible) {\n        this._hideUI();\n        cancel();\n      }\n    });\n    // Close on click outside of balloon panel element.\n    clickOutsideHandler({\n      emitter: this.formView,\n      activator: () => this._isUIInPanel,\n      contextElements: () => [this._balloon.view.element],\n      callback: () => {\n        // Focusing on the editable during a click outside the balloon panel might\n        // cause the selection to move to the beginning of the editable, so we avoid\n        // focusing on it during this action.\n        // See: https://github.com/ckeditor/ckeditor5/issues/18253\n        this._hideUI(false);\n      }\n    });\n  }\n  /**\n  * Adds the {@link #toolbarView} to the {@link #_balloon}.\n  *\n  * @internal\n  */\n  _addToolbarView() {\n    if (!this.toolbarView) {\n      this._createViews();\n    }\n    if (this._isToolbarInPanel) {\n      return;\n    }\n    this._balloon.add({\n      view: this.toolbarView,\n      position: this._getBalloonPositionData(),\n      balloonClassName: 'ck-toolbar-container'\n    });\n  }\n  /**\n  * Adds the {@link #formView} to the {@link #_balloon}.\n  */\n  _addFormView() {\n    if (!this.formView) {\n      this._createViews();\n    }\n    if (this._isFormInPanel) {\n      return;\n    }\n    const linkCommand = this.editor.commands.get('link');\n    this.formView.disableCssTransitions();\n    this.formView.resetFormStatus();\n    this.formView.backButtonView.isVisible = linkCommand.isEnabled && !!linkCommand.value;\n    this._balloon.add({\n      view: this.formView,\n      position: this._getBalloonPositionData()\n    });\n    // Make sure that each time the panel shows up, the fields remains in sync with the value of\n    // the command. If the user typed in the input, then canceled the balloon (`urlInputView.fieldView#value` stays\n    // unaltered) and re-opened it without changing the value of the link command (e.g. because they\n    // clicked the same link), they would see the old value instead of the actual value of the command.\n    // https://github.com/ckeditor/ckeditor5-link/issues/78\n    // https://github.com/ckeditor/ckeditor5-link/issues/123\n    this.selectedLinkableText = this._getSelectedLinkableText();\n    this.formView.displayedTextInputView.fieldView.value = this.selectedLinkableText || '';\n    this.formView.urlInputView.fieldView.value = linkCommand.value || '';\n    // Select input when form view is currently visible.\n    if (this._balloon.visibleView === this.formView) {\n      this.formView.urlInputView.fieldView.select();\n    }\n    this.formView.enableCssTransitions();\n  }\n  /**\n  * Adds the {@link #propertiesView} to the {@link #_balloon}.\n  */\n  _addPropertiesView() {\n    if (!this.propertiesView) {\n      this._createViews();\n    }\n    if (this._arePropertiesInPanel) {\n      return;\n    }\n    this.propertiesView.disableCssTransitions();\n    this._balloon.add({\n      view: this.propertiesView,\n      position: this._getBalloonPositionData()\n    });\n    this.propertiesView.enableCssTransitions();\n    this.propertiesView.focus();\n  }\n  /**\n  * Shows the view with links provided by the given provider.\n  */\n  _showLinksProviderView(provider) {\n    if (this.linkProviderItemsView) {\n      this._removeLinksProviderView();\n    }\n    this.linkProviderItemsView = this._createLinkProviderItemsView(provider);\n    this._addLinkProviderItemsView(provider);\n  }\n  /**\n  * Adds the {@link #linkProviderItemsView} to the {@link #_balloon}.\n  */\n  _addLinkProviderItemsView(provider) {\n    // Clear the collection of links.\n    this.linkProviderItemsView.listChildren.clear();\n    // Add links to the collection.\n    this.linkProviderItemsView.listChildren.addMany(this._createLinkProviderListView(provider));\n    this._balloon.add({\n      view: this.linkProviderItemsView,\n      position: this._getBalloonPositionData()\n    });\n    this.linkProviderItemsView.focus();\n  }\n  /**\n  * Closes the form view. Decides whether the balloon should be hidden completely or if the action view should be shown. This is\n  * decided upon the link command value (which has a value if the document selection is in the link).\n  */\n  _closeFormView() {\n    const linkCommand = this.editor.commands.get('link');\n    this.selectedLinkableText = undefined;\n    if (linkCommand.value !== undefined) {\n      this._removeFormView();\n    } else {\n      this._hideUI();\n    }\n  }\n  /**\n  * Removes the {@link #propertiesView} from the {@link #_balloon}.\n  */\n  _removePropertiesView() {\n    if (this._arePropertiesInPanel) {\n      this._balloon.remove(this.propertiesView);\n    }\n  }\n  /**\n  * Removes the {@link #linkProviderItemsView} from the {@link #_balloon}.\n  */\n  _removeLinksProviderView() {\n    if (this._isLinksListInPanel) {\n      this._balloon.remove(this.linkProviderItemsView);\n    }\n  }\n  /**\n  * Removes the {@link #formView} from the {@link #_balloon}.\n  */\n  _removeFormView(updateFocus = true) {\n    if (this._isFormInPanel) {\n      // Blur the input element before removing it from DOM to prevent issues in some browsers.\n      // See https://github.com/ckeditor/ckeditor5/issues/1501.\n      this.formView.saveButtonView.focus();\n      // Reset fields to update the state of the submit button.\n      this.formView.displayedTextInputView.fieldView.reset();\n      this.formView.urlInputView.fieldView.reset();\n      this._balloon.remove(this.formView);\n      // Because the form has an input which has focus, the focus must be brought back\n      // to the editor. Otherwise, it would be lost.\n      if (updateFocus) {\n        this.editor.editing.view.focus();\n      }\n      this._hideFakeVisualSelection();\n    }\n  }\n  /**\n  * Shows the correct UI type. It is either {@link #formView} or {@link #toolbarView}.\n  *\n  * @internal\n  */\n  _showUI(forceVisible = false) {\n    if (!this.formView) {\n      this._createViews();\n    }\n    // When there's no link under the selection, go straight to the editing UI.\n    if (!this._getSelectedLinkElement()) {\n      // Show visual selection on a text without a link when the contextual balloon is displayed.\n      // See https://github.com/ckeditor/ckeditor5/issues/4721.\n      this._showFakeVisualSelection();\n      this._addToolbarView();\n      // Be sure panel with link is visible.\n      if (forceVisible) {\n        this._balloon.showStack('main');\n      }\n      this._addFormView();\n    } else {\n      // Go to the editing UI if toolbar is already visible.\n      if (this._isToolbarVisible) {\n        this._addFormView();\n      } else {\n        this._addToolbarView();\n      }\n      // Be sure panel with link is visible.\n      if (forceVisible) {\n        this._balloon.showStack('main');\n      }\n    }\n    // Begin responding to ui#update once the UI is added.\n    this._startUpdatingUI();\n  }\n  /**\n  * Removes the {@link #formView} from the {@link #_balloon}.\n  *\n  * See {@link #_addFormView}, {@link #_addToolbarView}.\n  */\n  _hideUI(updateFocus = true) {\n    const editor = this.editor;\n    if (!this._isUIInPanel) {\n      return;\n    }\n    this.stopListening(editor.ui, 'update');\n    this.stopListening(this._balloon, 'change:visibleView');\n    // Make sure the focus always gets back to the editable _before_ removing the focused form view.\n    // Doing otherwise causes issues in some browsers. See https://github.com/ckeditor/ckeditor5-link/issues/193.\n    if (updateFocus) {\n      editor.editing.view.focus();\n    }\n    // If the links view is visible, remove it because it can be on top of the stack.\n    this._removeLinksProviderView();\n    // If the properties form view is visible, remove it because it can be on top of the stack.\n    this._removePropertiesView();\n    // Then remove the form view because it's beneath the properties form.\n    this._removeFormView(updateFocus);\n    // Finally, remove the link toolbar view because it's last in the stack.\n    if (this._isToolbarInPanel) {\n      this._balloon.remove(this.toolbarView);\n    }\n    this._hideFakeVisualSelection();\n  }\n  /**\n  * Makes the UI react to the {@link module:ui/editorui/editorui~EditorUI#event:update} event to\n  * reposition itself when the editor UI should be refreshed.\n  *\n  * See: {@link #_hideUI} to learn when the UI stops reacting to the `update` event.\n  */\n  _startUpdatingUI() {\n    const editor = this.editor;\n    const viewDocument = editor.editing.view.document;\n    let prevSelectedLink = this._getSelectedLinkElement();\n    let prevSelectionParent = getSelectionParent();\n    const update = () => {\n      const selectedLink = this._getSelectedLinkElement();\n      const selectionParent = getSelectionParent();\n      // Hide the panel if:\n      //\n      // * the selection went out of the EXISTING link element. E.g. user moved the caret out\n      //   of the link,\n      // * the selection went to a different parent when creating a NEW link. E.g. someone\n      //   else modified the document.\n      // * the selection has expanded (e.g. displaying link toolbar then pressing SHIFT+Right arrow).\n      //\n      // Note: #_getSelectedLinkElement will return a link for a non-collapsed selection only\n      // when fully selected.\n      if (prevSelectedLink && !selectedLink || !prevSelectedLink && selectionParent !== prevSelectionParent) {\n        this._hideUI();\n      } else if (this._isUIVisible) {\n        // If still in a link element, simply update the position of the balloon.\n        // If there was no link (e.g. inserting one), the balloon must be moved\n        // to the new position in the editing view (a new native DOM range).\n        this._balloon.updatePosition(this._getBalloonPositionData());\n      }\n      prevSelectedLink = selectedLink;\n      prevSelectionParent = selectionParent;\n    };\n    function getSelectionParent() {\n      return viewDocument.selection.focus.getAncestors().reverse().find(node => node.is('element'));\n    }\n    this.listenTo(editor.ui, 'update', update);\n    this.listenTo(this._balloon, 'change:visibleView', update);\n  }\n  /**\n  * Returns `true` when {@link #propertiesView} is in the {@link #_balloon}.\n  */\n  get _arePropertiesInPanel() {\n    return !!this.propertiesView && this._balloon.hasView(this.propertiesView);\n  }\n  /**\n  * Returns `true` when {@link #linkProviderItemsView} is in the {@link #_balloon}.\n  */\n  get _isLinksListInPanel() {\n    return !!this.linkProviderItemsView && this._balloon.hasView(this.linkProviderItemsView);\n  }\n  /**\n  * Returns `true` when {@link #formView} is in the {@link #_balloon}.\n  */\n  get _isFormInPanel() {\n    return !!this.formView && this._balloon.hasView(this.formView);\n  }\n  /**\n  * Returns `true` when {@link #toolbarView} is in the {@link #_balloon}.\n  */\n  get _isToolbarInPanel() {\n    return !!this.toolbarView && this._balloon.hasView(this.toolbarView);\n  }\n  /**\n  * Returns `true` when {@link #propertiesView} is in the {@link #_balloon} and it is\n  * currently visible.\n  */\n  get _isPropertiesVisible() {\n    return !!this.propertiesView && this._balloon.visibleView === this.propertiesView;\n  }\n  /**\n  * Returns `true` when {@link #formView} is in the {@link #_balloon} and it is\n  * currently visible.\n  */\n  get _isFormVisible() {\n    return !!this.formView && this._balloon.visibleView == this.formView;\n  }\n  /**\n  * Returns `true` when {@link #toolbarView} is in the {@link #_balloon} and it is\n  * currently visible.\n  */\n  get _isToolbarVisible() {\n    return !!this.toolbarView && this._balloon.visibleView === this.toolbarView;\n  }\n  /**\n  * Returns `true` when {@link #propertiesView}, {@link #toolbarView}, {@link #linkProviderItemsView}\n  * or {@link #formView} is in the {@link #_balloon}.\n  */\n  get _isUIInPanel() {\n    return this._arePropertiesInPanel || this._isLinksListInPanel || this._isFormInPanel || this._isToolbarInPanel;\n  }\n  /**\n  * Returns `true` when {@link #propertiesView}, {@link #linkProviderItemsView}, {@link #toolbarView}\n  * or {@link #formView} is in the {@link #_balloon} and it is currently visible.\n  */\n  get _isUIVisible() {\n    return this._isPropertiesVisible || this._isLinksListInPanel || this._isFormVisible || this._isToolbarVisible;\n  }\n  /**\n  * Returns positioning options for the {@link #_balloon}. They control the way the balloon is attached\n  * to the target element or selection.\n  *\n  * If the selection is collapsed and inside a link element, the panel will be attached to the\n  * entire link element. Otherwise, it will be attached to the selection.\n  */\n  _getBalloonPositionData() {\n    const view = this.editor.editing.view;\n    const viewDocument = view.document;\n    const model = this.editor.model;\n    if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n      // There are cases when we highlight selection using a marker (#7705, #4721).\n      const markerViewElements = this.editor.editing.mapper.markerNameToElements(VISUAL_SELECTION_MARKER_NAME);\n      // Marker could be removed by link text override and end up in the graveyard.\n      if (markerViewElements) {\n        const markerViewElementsArray = Array.from(markerViewElements);\n        const newRange = view.createRange(view.createPositionBefore(markerViewElementsArray[0]), view.createPositionAfter(markerViewElementsArray[markerViewElementsArray.length - 1]));\n        return {\n          target: view.domConverter.viewRangeToDom(newRange)\n        };\n      }\n    }\n    // Make sure the target is calculated on demand at the last moment because a cached DOM range\n    // (which is very fragile) can desynchronize with the state of the editing view if there was\n    // any rendering done in the meantime. This can happen, for instance, when an inline widget\n    // gets unlinked.\n    return {\n      target: () => {\n        const targetLink = this._getSelectedLinkElement();\n        return targetLink ?\n        // When selection is inside link element, then attach panel to this element.\n        view.domConverter.mapViewToDom(targetLink) :\n        // Otherwise attach panel to the selection.\n        view.domConverter.viewRangeToDom(viewDocument.selection.getFirstRange());\n      }\n    };\n  }\n  /**\n  * Returns the link {@link module:engine/view/attributeelement~AttributeElement} under\n  * the {@link module:engine/view/document~Document editing view's} selection or `null`\n  * if there is none.\n  *\n  * **Note**: For a nonâ€“collapsed selection, the link element is returned when **fully**\n  * selected and the **only** element within the selection boundaries, or when\n  * a linked widget is selected.\n  */\n  _getSelectedLinkElement() {\n    const view = this.editor.editing.view;\n    const selection = view.document.selection;\n    const selectedElement = selection.getSelectedElement();\n    // The selection is collapsed or some widget is selected (especially inline widget).\n    if (selection.isCollapsed || selectedElement && isWidget(selectedElement)) {\n      return findLinkElementAncestor(selection.getFirstPosition());\n    } else {\n      // The range for fully selected link is usually anchored in adjacent text nodes.\n      // Trim it to get closer to the actual link element.\n      const range = selection.getFirstRange().getTrimmed();\n      const startLink = findLinkElementAncestor(range.start);\n      const endLink = findLinkElementAncestor(range.end);\n      if (!startLink || startLink != endLink) {\n        return null;\n      }\n      // Check if the link element is fully selected.\n      if (view.createRangeIn(startLink).getTrimmed().isEqual(range)) {\n        return startLink;\n      } else {\n        return null;\n      }\n    }\n  }\n  /**\n  * Returns selected link text content.\n  * If link is not selected it returns the selected text.\n  * If selection or link includes non text node (inline object or block) then returns undefined.\n  */\n  _getSelectedLinkableText() {\n    const model = this.editor.model;\n    const editing = this.editor.editing;\n    const selectedLink = this._getSelectedLinkElement();\n    if (!selectedLink) {\n      return extractTextFromLinkRange(model.document.selection.getFirstRange());\n    }\n    const viewLinkRange = editing.view.createRangeOn(selectedLink);\n    const linkRange = editing.mapper.toModelRange(viewLinkRange);\n    return extractTextFromLinkRange(linkRange);\n  }\n  /**\n  * Returns a provider by its URL.\n  *\n  * @param href URL of the link.\n  * @returns Link provider and item or `null` if not found.\n  */\n  _getLinkProviderLinkByHref(href) {\n    if (!href) {\n      return null;\n    }\n    for (const provider of this._linksProviders) {\n      const item = provider.getItem ? provider.getItem(href) : provider.getListItems().find(item => item.href === href);\n      if (item) {\n        return {\n          provider,\n          item\n        };\n      }\n    }\n    return null;\n  }\n  /**\n  * Displays a fake visual selection when the contextual balloon is displayed.\n  *\n  * This adds a 'link-ui' marker into the document that is rendered as a highlight on selected text fragment.\n  */\n  _showFakeVisualSelection() {\n    const model = this.editor.model;\n    model.change(writer => {\n      const range = model.document.selection.getFirstRange();\n      if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n        writer.updateMarker(VISUAL_SELECTION_MARKER_NAME, {\n          range\n        });\n      } else {\n        if (range.start.isAtEnd) {\n          const startPosition = range.start.getLastMatchingPosition(({\n            item\n          }) => !model.schema.isContent(item), {\n            boundaries: range\n          });\n          writer.addMarker(VISUAL_SELECTION_MARKER_NAME, {\n            usingOperation: false,\n            affectsData: false,\n            range: writer.createRange(startPosition, range.end)\n          });\n        } else {\n          writer.addMarker(VISUAL_SELECTION_MARKER_NAME, {\n            usingOperation: false,\n            affectsData: false,\n            range\n          });\n        }\n      }\n    });\n  }\n  /**\n  * Hides the fake visual selection created in {@link #_showFakeVisualSelection}.\n  */\n  _hideFakeVisualSelection() {\n    const model = this.editor.model;\n    if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n      model.change(writer => {\n        writer.removeMarker(VISUAL_SELECTION_MARKER_NAME);\n      });\n    }\n  }\n}\n/**\n * Returns a link element if there's one among the ancestors of the provided `Position`.\n *\n * @param View position to analyze.\n * @returns Link element at the position or null.\n */\nfunction findLinkElementAncestor(position) {\n  return position.getAncestors().find(ancestor => isLinkElement(ancestor)) || null;\n}\n/**\n * Returns link form validation callbacks.\n *\n * @param editor Editor instance.\n */\nfunction getFormValidators(editor) {\n  const t = editor.t;\n  const allowCreatingEmptyLinks = editor.config.get('link.allowCreatingEmptyLinks');\n  return [form => {\n    if (!allowCreatingEmptyLinks && !form.url.length) {\n      return t('Link URL must not be empty.');\n    }\n  }];\n}\nconst MIN_LINK_LENGTH_WITH_SPACE_AT_END = 4; // Ie: \"t.co \" (length 5).\n// This was a tweak from https://gist.github.com/dperini/729294.\nconst URL_REG_EXP = new RegExp(\n// Group 1: Line start or after a space.\n'(^|\\\\s)' +\n// Group 2: Detected URL (or e-mail).\n'(' +\n// Protocol identifier or short syntax \"//\"\n// a. Full form http://user@foo.bar.baz:8080/foo/bar.html#baz?foo=bar\n'(' + '(?:(?:(?:https?|ftp):)?\\\\/\\\\/)' +\n// BasicAuth using user:pass (optional)\n'(?:\\\\S+(?::\\\\S*)?@)?' + '(?:' +\n// IP address dotted notation octets\n// excludes loopback network 0.0.0.0\n// excludes reserved space >= 224.0.0.0\n// excludes network & broadcast addresses\n// (first & last IP address of each class)\n'(?:[1-9]\\\\d?|1\\\\d\\\\d|2[01]\\\\d|22[0-3])' + '(?:\\\\.(?:1?\\\\d{1,2}|2[0-4]\\\\d|25[0-5])){2}' + '(?:\\\\.(?:[1-9]\\\\d?|1\\\\d\\\\d|2[0-4]\\\\d|25[0-4]))' + '|' + '(' +\n// Do not allow `www.foo` - see https://github.com/ckeditor/ckeditor5/issues/8050.\n'((?!www\\\\.)|(www\\\\.))' +\n// Host & domain names.\n'(?![-_])(?:[-_a-z0-9\\\\u00a1-\\\\uffff]{1,63}\\\\.)+' +\n// TLD identifier name.\n'(?:[a-z\\\\u00a1-\\\\uffff]{2,63})' + ')' + '|' +\n// Allow localhost as a valid hostname\n'localhost' + ')' +\n// port number (optional)\n'(?::\\\\d{2,5})?' +\n// resource path (optional)\n'(?:[/?#]\\\\S*)?' + ')' + '|' +\n// b. Short form (either www.example.com or example@example.com)\n'(' + '(www.|(\\\\S+@))' +\n// Host & domain names.\n'((?![-_])(?:[-_a-z0-9\\\\u00a1-\\\\uffff]{1,63}\\\\.))+' +\n// TLD identifier name.\n'(?:[a-z\\\\u00a1-\\\\uffff]{2,63})' + ')' + ')$', 'i');\nconst URL_GROUP_IN_MATCH = 2;\n/**\n * The autolink plugin.\n */\nclass AutoLink extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Delete, LinkEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'AutoLink';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    selection.on('change:range', () => {\n      // Disable plugin when selection is inside a code block.\n      this.isEnabled = !selection.anchor.parent.is('element', 'codeBlock');\n    });\n    this._enableTypingHandling();\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    this._enableEnterHandling();\n    this._enableShiftEnterHandling();\n    this._enablePasteLinking();\n  }\n  /**\n  * For given position, returns a range that includes the whole link that contains the position.\n  *\n  * If position is not inside a link, returns `null`.\n  */\n  _expandLinkRange(model, position) {\n    if (position.textNode && position.textNode.hasAttribute('linkHref')) {\n      return findAttributeRange(position, 'linkHref', position.textNode.getAttribute('linkHref'), model);\n    } else {\n      return null;\n    }\n  }\n  /**\n  * Extends the document selection to includes all links that intersects with given `selectedRange`.\n  */\n  _selectEntireLinks(writer, selectedRange) {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    const selStart = selection.getFirstPosition();\n    const selEnd = selection.getLastPosition();\n    let updatedSelection = selectedRange.getJoined(this._expandLinkRange(model, selStart) || selectedRange);\n    if (updatedSelection) {\n      updatedSelection = updatedSelection.getJoined(this._expandLinkRange(model, selEnd) || selectedRange);\n    }\n    if (updatedSelection && (updatedSelection.start.isBefore(selStart) || updatedSelection.end.isAfter(selEnd))) {\n      // Only update the selection if it changed.\n      writer.setSelection(updatedSelection);\n    }\n  }\n  /**\n  * Enables autolinking on pasting a URL when some content is selected.\n  */\n  _enablePasteLinking() {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n    const linkCommand = editor.commands.get('link');\n    clipboardPipeline.on('inputTransformation', (evt, data) => {\n      if (!this.isEnabled || !linkCommand.isEnabled || selection.isCollapsed || data.method !== 'paste') {\n        // Abort if we are disabled or the selection is collapsed.\n        return;\n      }\n      if (selection.rangeCount > 1) {\n        // Abort if there are multiple selection ranges.\n        return;\n      }\n      const selectedRange = selection.getFirstRange();\n      const newLink = data.dataTransfer.getData('text/plain');\n      if (!newLink) {\n        // Abort if there is no plain text on the clipboard.\n        return;\n      }\n      const matches = newLink.match(URL_REG_EXP);\n      // If the text in the clipboard has a URL, and that URL is the whole clipboard.\n      if (matches && matches[2] === newLink) {\n        model.change(writer => {\n          this._selectEntireLinks(writer, selectedRange);\n          linkCommand.execute(newLink);\n        });\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Enables autolinking on typing.\n  */\n  _enableTypingHandling() {\n    const editor = this.editor;\n    const watcher = new TextWatcher(editor.model, text => {\n      let mappedText = text;\n      // 1. Detect <kbd>Space</kbd> after a text with a potential link.\n      if (!isSingleSpaceAtTheEnd(mappedText)) {\n        return;\n      }\n      // 2. Remove the last space character.\n      mappedText = mappedText.slice(0, -1);\n      // 3. Remove punctuation at the end of the URL if it exists.\n      if ('!.:,;?'.includes(mappedText[mappedText.length - 1])) {\n        mappedText = mappedText.slice(0, -1);\n      }\n      // 4. Check text before last typed <kbd>Space</kbd> or punctuation.\n      const url = getUrlAtTextEnd(mappedText);\n      if (url) {\n        return {\n          url,\n          removedTrailingCharacters: text.length - mappedText.length\n        };\n      }\n    });\n    watcher.on('matched:data', (evt, data) => {\n      const {\n        batch,\n        range,\n        url,\n        removedTrailingCharacters\n      } = data;\n      if (!batch.isTyping) {\n        return;\n      }\n      const linkEnd = range.end.getShiftedBy(-removedTrailingCharacters); // Executed after a space character or punctuation.\n      const linkStart = linkEnd.getShiftedBy(-url.length);\n      const linkRange = editor.model.createRange(linkStart, linkEnd);\n      this._applyAutoLink(url, linkRange);\n    });\n    watcher.bind('isEnabled').to(this);\n  }\n  /**\n  * Enables autolinking on the <kbd>Enter</kbd> key.\n  */\n  _enableEnterHandling() {\n    const editor = this.editor;\n    const model = editor.model;\n    const enterCommand = editor.commands.get('enter');\n    if (!enterCommand) {\n      return;\n    }\n    enterCommand.on('execute', () => {\n      const position = model.document.selection.getFirstPosition();\n      if (!position.parent.previousSibling) {\n        return;\n      }\n      const rangeToCheck = model.createRangeIn(position.parent.previousSibling);\n      this._checkAndApplyAutoLinkOnRange(rangeToCheck);\n    });\n  }\n  /**\n  * Enables autolinking on the <kbd>Shift</kbd>+<kbd>Enter</kbd> keyboard shortcut.\n  */\n  _enableShiftEnterHandling() {\n    const editor = this.editor;\n    const model = editor.model;\n    const shiftEnterCommand = editor.commands.get('shiftEnter');\n    if (!shiftEnterCommand) {\n      return;\n    }\n    shiftEnterCommand.on('execute', () => {\n      const position = model.document.selection.getFirstPosition();\n      const rangeToCheck = model.createRange(model.createPositionAt(position.parent, 0), position.getShiftedBy(-1));\n      this._checkAndApplyAutoLinkOnRange(rangeToCheck);\n    });\n  }\n  /**\n  * Checks if the passed range contains a linkable text.\n  */\n  _checkAndApplyAutoLinkOnRange(rangeToCheck) {\n    const model = this.editor.model;\n    const {\n      text,\n      range\n    } = getLastTextLine(rangeToCheck, model);\n    const url = getUrlAtTextEnd(text);\n    if (url) {\n      const linkRange = model.createRange(range.end.getShiftedBy(-url.length), range.end);\n      this._applyAutoLink(url, linkRange);\n    }\n  }\n  /**\n  * Applies a link on a given range if the link should be applied.\n  *\n  * @param url The URL to link.\n  * @param range The text range to apply the link attribute to.\n  */\n  _applyAutoLink(url, range) {\n    const model = this.editor.model;\n    const defaultProtocol = this.editor.config.get('link.defaultProtocol');\n    const fullUrl = addLinkProtocolIfApplicable(url, defaultProtocol);\n    if (!this.isEnabled || !isLinkAllowedOnRange(range, model) || !linkHasProtocol(fullUrl) || linkIsAlreadySet(range)) {\n      return;\n    }\n    this._persistAutoLink(fullUrl, range);\n  }\n  /**\n  * Enqueues autolink changes in the model.\n  *\n  * @param url The URL to link.\n  * @param range The text range to apply the link attribute to.\n  */\n  _persistAutoLink(url, range) {\n    const model = this.editor.model;\n    const deletePlugin = this.editor.plugins.get('Delete');\n    // Enqueue change to make undo step.\n    model.enqueueChange(writer => {\n      writer.setAttribute('linkHref', url, range);\n      model.enqueueChange(() => {\n        deletePlugin.requestUndoOnBackspace();\n      });\n    });\n  }\n}\n// Check if text should be evaluated by the plugin in order to reduce number of RegExp checks on whole text.\nfunction isSingleSpaceAtTheEnd(text) {\n  return text.length > MIN_LINK_LENGTH_WITH_SPACE_AT_END && text[text.length - 1] === ' ' && text[text.length - 2] !== ' ';\n}\nfunction getUrlAtTextEnd(text) {\n  const match = URL_REG_EXP.exec(text);\n  return match ? match[URL_GROUP_IN_MATCH] : null;\n}\nfunction isLinkAllowedOnRange(range, model) {\n  return model.schema.checkAttributeInSelection(model.createSelection(range), 'linkHref');\n}\nfunction linkIsAlreadySet(range) {\n  const item = range.start.nodeAfter;\n  return !!item && item.hasAttribute('linkHref');\n}\n\n/**\n * The link plugin.\n *\n * This is a \"glue\" plugin that loads the {@link module:link/linkediting~LinkEditing link editing feature}\n * and {@link module:link/linkui~LinkUI link UI feature}.\n */\nclass Link extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [LinkEditing, LinkUI, AutoLink];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Link';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The link image engine feature.\n *\n * It accepts the `linkHref=\"url\"` attribute in the model for the {@link module:image/image~Image `<imageBlock>`} element\n * which allows linking images.\n */\nclass LinkImageEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return ['ImageEditing', 'ImageUtils', LinkEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LinkImageEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    if (editor.plugins.has('ImageBlockEditing')) {\n      schema.extend('imageBlock', {\n        allowAttributes: ['linkHref']\n      });\n    }\n    editor.conversion.for('upcast').add(upcastLink(editor));\n    editor.conversion.for('downcast').add(downcastImageLink(editor));\n    // Definitions for decorators are provided by the `link` command and the `LinkEditing` plugin.\n    this._enableAutomaticDecorators();\n    this._enableManualDecorators();\n  }\n  /**\n  * Processes {@link module:link/linkconfig~LinkDecoratorAutomaticDefinition automatic decorators} definitions and\n  * attaches proper converters that will work when linking an image.`\n  */\n  _enableAutomaticDecorators() {\n    const editor = this.editor;\n    const command = editor.commands.get('link');\n    const automaticDecorators = command.automaticDecorators;\n    if (automaticDecorators.length) {\n      editor.conversion.for('downcast').add(automaticDecorators.getDispatcherForLinkedImage());\n    }\n  }\n  /**\n  * Processes transformed {@link module:link/utils/manualdecorator~ManualDecorator} instances and attaches proper converters\n  * that will work when linking an image.\n  */\n  _enableManualDecorators() {\n    const editor = this.editor;\n    const command = editor.commands.get('link');\n    for (const decorator of command.manualDecorators) {\n      if (editor.plugins.has('ImageBlockEditing')) {\n        editor.model.schema.extend('imageBlock', {\n          allowAttributes: decorator.id\n        });\n      }\n      if (editor.plugins.has('ImageInlineEditing')) {\n        editor.model.schema.extend('imageInline', {\n          allowAttributes: decorator.id\n        });\n      }\n      editor.conversion.for('downcast').add(downcastImageLinkManualDecorator(decorator));\n      editor.conversion.for('upcast').add(upcastImageLinkManualDecorator(editor, decorator));\n    }\n  }\n}\n/**\n * Returns a converter for linked block images that consumes the \"href\" attribute\n * if a link contains an image.\n *\n * @param editor The editor instance.\n */\nfunction upcastLink(editor) {\n  const isImageInlinePluginLoaded = editor.plugins.has('ImageInlineEditing');\n  const imageUtils = editor.plugins.get('ImageUtils');\n  return dispatcher => {\n    dispatcher.on('element:a', (evt, data, conversionApi) => {\n      const viewLink = data.viewItem;\n      const imageInLink = imageUtils.findViewImgElement(viewLink);\n      if (!imageInLink) {\n        return;\n      }\n      const blockImageView = imageInLink.findAncestor(element => imageUtils.isBlockImageView(element));\n      // There are four possible cases to consider here\n      //\n      // 1. A \"root > ... > figure.image > a > img\" structure.\n      // 2. A \"root > ... > figure.image > a > picture > img\" structure.\n      // 3. A \"root > ... > block > a > img\" structure.\n      // 4. A \"root > ... > block > a > picture > img\" structure.\n      //\n      // but the last 2 cases should only be considered by this converter when the inline image plugin\n      // is NOT loaded in the editor (because otherwise, that would be a plain, linked inline image).\n      if (isImageInlinePluginLoaded && !blockImageView) {\n        return;\n      }\n      // There's an image inside an <a> element - we consume it so it won't be picked up by the Link plugin.\n      const consumableAttributes = {\n        attributes: ['href']\n      };\n      // Consume the `href` attribute so the default one will not convert it to $text attribute.\n      if (!conversionApi.consumable.consume(viewLink, consumableAttributes)) {\n        // Might be consumed by something else - i.e. other converter with priority=highest - a standard check.\n        return;\n      }\n      const linkHref = viewLink.getAttribute('href');\n      // Missing the 'href' attribute.\n      if (!linkHref) {\n        return;\n      }\n      // A full definition of the image feature.\n      // figure > a > img: parent of the view link element is an image element (figure).\n      let modelElement = data.modelCursor.parent;\n      if (!modelElement.is('element', 'imageBlock')) {\n        // a > img: parent of the view link is not the image (figure) element. We need to convert it manually.\n        const conversionResult = conversionApi.convertItem(imageInLink, data.modelCursor);\n        // Set image range as conversion result.\n        data.modelRange = conversionResult.modelRange;\n        // Continue conversion where image conversion ends.\n        data.modelCursor = conversionResult.modelCursor;\n        modelElement = data.modelCursor.nodeBefore;\n      }\n      if (modelElement && modelElement.is('element', 'imageBlock')) {\n        // Set the linkHref attribute from link element on model image element.\n        conversionApi.writer.setAttribute('linkHref', linkHref, modelElement);\n      }\n    }, {\n      priority: 'high'\n    });\n    // Using the same priority that `upcastImageLinkManualDecorator()` converter guarantees\n    // that manual decorators will decorate the proper element.\n  };\n}\n/**\n * Creates a converter that adds `<a>` to linked block image view elements.\n */\nfunction downcastImageLink(editor) {\n  const imageUtils = editor.plugins.get('ImageUtils');\n  return dispatcher => {\n    dispatcher.on('attribute:linkHref:imageBlock', (evt, data, conversionApi) => {\n      if (!conversionApi.consumable.consume(data.item, evt.name)) {\n        return;\n      }\n      // The image will be already converted - so it will be present in the view.\n      const viewFigure = conversionApi.mapper.toViewElement(data.item);\n      const writer = conversionApi.writer;\n      // But we need to check whether the link element exists.\n      const linkInImage = Array.from(viewFigure.getChildren()).find(child => child.is('element', 'a'));\n      const viewImage = imageUtils.findViewImgElement(viewFigure);\n      // <picture>...<img/></picture> or <img/>\n      const viewImgOrPicture = viewImage.parent.is('element', 'picture') ? viewImage.parent : viewImage;\n      // If so, update the attribute if it's defined or remove the entire link if the attribute is empty.\n      if (linkInImage) {\n        if (data.attributeNewValue) {\n          writer.setAttribute('href', data.attributeNewValue, linkInImage);\n        } else {\n          writer.move(writer.createRangeOn(viewImgOrPicture), writer.createPositionAt(viewFigure, 0));\n          writer.remove(linkInImage);\n        }\n      } else {\n        // But if it does not exist. Let's wrap already converted image by newly created link element.\n        // 1. Create an empty link element.\n        const linkElement = writer.createContainerElement('a', {\n          href: data.attributeNewValue\n        });\n        // 2. Insert link inside the associated image.\n        writer.insert(writer.createPositionAt(viewFigure, 0), linkElement);\n        // 3. Move the image to the link.\n        writer.move(writer.createRangeOn(viewImgOrPicture), writer.createPositionAt(linkElement, 0));\n      }\n    }, {\n      priority: 'high'\n    });\n  };\n}\n/**\n * Returns a converter that decorates the `<a>` element when the image is the link label.\n */\nfunction downcastImageLinkManualDecorator(decorator) {\n  return dispatcher => {\n    dispatcher.on(`attribute:${decorator.id}:imageBlock`, (evt, data, conversionApi) => {\n      const viewFigure = conversionApi.mapper.toViewElement(data.item);\n      const linkInImage = Array.from(viewFigure.getChildren()).find(child => child.is('element', 'a'));\n      // The <a> element was removed by the time this converter is executed.\n      // It may happen when the base `linkHref` and decorator attributes are removed\n      // at the same time (see #8401).\n      if (!linkInImage) {\n        return;\n      }\n      // Handle deactivated manual decorator.\n      if (decorator.value === undefined) {\n        for (const key in decorator.attributes) {\n          conversionApi.writer.removeAttribute(key, linkInImage);\n        }\n        if (decorator.classes) {\n          conversionApi.writer.removeClass(decorator.classes, linkInImage);\n        }\n        for (const key in decorator.styles) {\n          conversionApi.writer.removeStyle(key, linkInImage);\n        }\n        return;\n      }\n      // Handle activated manual decorator.\n      for (const [key, val] of toMap(decorator.attributes)) {\n        conversionApi.writer.setAttribute(key, val, linkInImage);\n      }\n      if (decorator.classes) {\n        conversionApi.writer.addClass(decorator.classes, linkInImage);\n      }\n      for (const key in decorator.styles) {\n        conversionApi.writer.setStyle(key, decorator.styles[key], linkInImage);\n      }\n    });\n  };\n}\n/**\n * Returns a converter that checks whether manual decorators should be applied to the link.\n */\nfunction upcastImageLinkManualDecorator(editor, decorator) {\n  const isImageInlinePluginLoaded = editor.plugins.has('ImageInlineEditing');\n  const imageUtils = editor.plugins.get('ImageUtils');\n  return dispatcher => {\n    dispatcher.on('element:a', (evt, data, conversionApi) => {\n      const viewLink = data.viewItem;\n      const imageInLink = imageUtils.findViewImgElement(viewLink);\n      // We need to check whether an image is inside a link because the converter handles\n      // only manual decorators for linked images. See #7975.\n      if (!imageInLink) {\n        return;\n      }\n      const blockImageView = imageInLink.findAncestor(element => imageUtils.isBlockImageView(element));\n      if (isImageInlinePluginLoaded && !blockImageView) {\n        return;\n      }\n      const matcher = new Matcher(decorator._createPattern());\n      const result = matcher.match(viewLink);\n      // The link element does not have required attributes or/and proper values.\n      if (!result) {\n        return;\n      }\n      // Check whether we can consume those attributes.\n      if (!conversionApi.consumable.consume(viewLink, result.match)) {\n        return;\n      }\n      // At this stage we can assume that we have the `<imageBlock>` element.\n      // `nodeBefore` comes after conversion: `<a><img></a>`.\n      // `parent` comes with full image definition: `<figure><a><img></a></figure>.\n      // See the body of the `upcastLink()` function.\n      const modelElement = data.modelCursor.nodeBefore || data.modelCursor.parent;\n      conversionApi.writer.setAttribute(decorator.id, true, modelElement);\n    }, {\n      priority: 'high'\n    });\n    // Using the same priority that `upcastLink()` converter guarantees that the linked image was properly converted.\n  };\n}\n\n/**\n * The link image UI plugin.\n *\n * This plugin provides the `'linkImage'` button that can be displayed in the {@link module:image/imagetoolbar~ImageToolbar}.\n * It can be used to wrap images in links.\n */\nclass LinkImageUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [LinkEditing, LinkUI, 'ImageBlockEditing'];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LinkImageUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const viewDocument = editor.editing.view.document;\n    this.listenTo(viewDocument, 'click', (evt, data) => {\n      if (this._isSelectedLinkedImage(editor.model.document.selection)) {\n        // Prevent browser navigation when clicking a linked image.\n        data.preventDefault();\n        // Block the `LinkUI` plugin when an image was clicked.\n        // In such a case, we'd like to display the image toolbar.\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    this._createToolbarLinkImageButton();\n  }\n  /**\n  * Creates a `LinkImageUI` button view.\n  *\n  * Clicking this button shows a {@link module:link/linkui~LinkUI#_balloon} attached to the selection.\n  * When an image is already linked, the view shows {@link module:link/linkui~LinkUI#toolbarView} or\n  * {@link module:link/linkui~LinkUI#formView} if it is not.\n  */\n  _createToolbarLinkImageButton() {\n    const editor = this.editor;\n    const t = editor.t;\n    editor.ui.componentFactory.add('linkImage', locale => {\n      const button = new ButtonView(locale);\n      const plugin = editor.plugins.get('LinkUI');\n      const linkCommand = editor.commands.get('link');\n      button.set({\n        isEnabled: true,\n        label: t('Link image'),\n        icon: IconLink,\n        keystroke: LINK_KEYSTROKE,\n        tooltip: true,\n        isToggleable: true\n      });\n      // Bind button to the command.\n      button.bind('isEnabled').to(linkCommand, 'isEnabled');\n      button.bind('isOn').to(linkCommand, 'value', value => !!value);\n      // Show the actionsView or formView (both from LinkUI) on button click depending on whether the image is linked already.\n      this.listenTo(button, 'execute', () => {\n        if (this._isSelectedLinkedImage(editor.model.document.selection)) {\n          plugin._addToolbarView();\n        } else {\n          plugin._showUI(true);\n        }\n      });\n      return button;\n    });\n  }\n  /**\n  * Returns true if a linked image (either block or inline) is the only selected element\n  * in the model document.\n  */\n  _isSelectedLinkedImage(selection) {\n    const selectedModelElement = selection.getSelectedElement();\n    const imageUtils = this.editor.plugins.get('ImageUtils');\n    return imageUtils.isImage(selectedModelElement) && selectedModelElement.hasAttribute('linkHref');\n  }\n}\n\n/**\n * The `LinkImage` plugin.\n *\n * This is a \"glue\" plugin that loads the {@link module:link/linkimageediting~LinkImageEditing link image editing feature}\n * and {@link module:link/linkimageui~LinkImageUI link image UI feature}.\n */\nclass LinkImage extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [LinkImageEditing, LinkImageUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LinkImage';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { AutoLink, Link, LinkCommand, LinkEditing, LinkFormView, LinkImage, LinkImageEditing, LinkImageUI, LinkUI, UnlinkCommand, addLinkProtocolIfApplicable, ensureSafeUrl, isLinkableElement };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Delete } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { Enter } from '@ckeditor/ckeditor5-enter/dist/index.js';\nimport { toArray, first, uid, CKEditorError, FocusTracker, KeystrokeHandler, global, getCode, parseKeystroke, getLocalizedArrowKeyCodeDirection, createElement, logWarning } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { ClipboardPipeline } from '@ckeditor/ckeditor5-clipboard/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView, View, ViewCollection, FocusCycler, addKeyboardHandlingForGrid, CollapsibleView, LabeledFieldView, createLabeledInputNumber, SwitchButtonView, createDropdown, SplitButtonView, MenuBarMenuView, focusChildOnDropdownOpen } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconNumberedList, IconBulletedList, IconListStyleDisc, IconListStyleCircle, IconListStyleSquare, IconListStyleDecimal, IconListStyleDecimalLeadingZero, IconListStyleLowerRoman, IconListStyleUpperRoman, IconListStyleLowerLatin, IconListStyleUpperLatin, IconTodoList } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { DomEventObserver, Matcher, TreeWalker, getFillerOffset } from '@ckeditor/ckeditor5-engine/dist/index.js';\n\n/**\n * Document list blocks iterator.\n */\nclass ListWalker {\n  /**\n  * The start list item block element.\n  */\n  _startElement;\n  /**\n  * The reference indent. Initialized by the indent of the start block.\n  */\n  _referenceIndent;\n  /**\n  * The iterating direction.\n  */\n  _isForward;\n  /**\n  * Whether start block should be included in the result (if it's matching other criteria).\n  */\n  _includeSelf;\n  /**\n  * Additional attributes that must be the same for each block.\n  */\n  _sameAttributes;\n  /**\n  * Whether blocks with the same indent level as the start block should be included in the result.\n  */\n  _sameIndent;\n  /**\n  * Whether blocks with a lower indent level than the start block should be included in the result.\n  */\n  _lowerIndent;\n  /**\n  * Whether blocks with a higher indent level than the start block should be included in the result.\n  */\n  _higherIndent;\n  /**\n  * Creates a document list iterator.\n  *\n  * @param startElement The start list item block element.\n  * @param options.direction The iterating direction.\n  * @param options.includeSelf Whether start block should be included in the result (if it's matching other criteria).\n  * @param options.sameAttributes Additional attributes that must be the same for each block.\n  * @param options.sameIndent Whether blocks with the same indent level as the start block should be included\n  * in the result.\n  * @param options.lowerIndent Whether blocks with a lower indent level than the start block should be included\n  * in the result.\n  * @param options.higherIndent Whether blocks with a higher indent level than the start block should be included\n  * in the result.\n  */\n  constructor(startElement, options) {\n    this._startElement = startElement;\n    this._referenceIndent = startElement.getAttribute('listIndent');\n    this._isForward = options.direction == 'forward';\n    this._includeSelf = !!options.includeSelf;\n    this._sameAttributes = toArray(options.sameAttributes || []);\n    this._sameIndent = !!options.sameIndent;\n    this._lowerIndent = !!options.lowerIndent;\n    this._higherIndent = !!options.higherIndent;\n  }\n  /**\n  * Performs only first step of iteration and returns the result.\n  *\n  * @param startElement The start list item block element.\n  * @param options.direction The iterating direction.\n  * @param options.includeSelf Whether start block should be included in the result (if it's matching other criteria).\n  * @param options.sameAttributes Additional attributes that must be the same for each block.\n  * @param options.sameIndent Whether blocks with the same indent level as the start block should be included\n  * in the result.\n  * @param options.lowerIndent Whether blocks with a lower indent level than the start block should be included\n  * in the result.\n  * @param options.higherIndent Whether blocks with a higher indent level than the start block should be included\n  * in the result.\n  */\n  static first(startElement, options) {\n    const walker = new this(startElement, options);\n    const iterator = walker[Symbol.iterator]();\n    return first(iterator);\n  }\n  /**\n  * Iterable interface.\n  */\n  *[Symbol.iterator]() {\n    const nestedItems = [];\n    for (const {\n      node\n    } of new SiblingListBlocksIterator(this._getStartNode(), this._isForward ? 'forward' : 'backward')) {\n      const indent = node.getAttribute('listIndent');\n      // Leaving a nested list.\n      if (indent < this._referenceIndent) {\n        // Abort searching blocks.\n        if (!this._lowerIndent) {\n          break;\n        }\n        // While searching for lower indents, update the reference indent to find another parent in the next step.\n        this._referenceIndent = indent;\n      } else if (indent > this._referenceIndent) {\n        // Ignore nested blocks.\n        if (!this._higherIndent) {\n          continue;\n        }\n        // Collect nested blocks to verify if they are really nested, or it's a different item.\n        if (!this._isForward) {\n          nestedItems.push(node);\n          continue;\n        }\n      } else {\n        // Ignore same indent block.\n        if (!this._sameIndent) {\n          // While looking for nested blocks, stop iterating while encountering first same indent block.\n          if (this._higherIndent) {\n            // No more nested blocks so yield nested items.\n            if (nestedItems.length) {\n              yield* nestedItems;\n              nestedItems.length = 0;\n            }\n            break;\n          }\n          continue;\n        }\n        // Abort if item has any additionally specified attribute different.\n        if (this._sameAttributes.some(attr => node.getAttribute(attr) !== this._startElement.getAttribute(attr))) {\n          break;\n        }\n      }\n      // There is another block for the same list item so the nested items were in the same list item.\n      if (nestedItems.length) {\n        yield* nestedItems;\n        nestedItems.length = 0;\n      }\n      yield node;\n    }\n  }\n  /**\n  * Returns the model element to start iterating.\n  */\n  _getStartNode() {\n    if (this._includeSelf) {\n      return this._startElement;\n    }\n    return this._isForward ? this._startElement.nextSibling : this._startElement.previousSibling;\n  }\n}\n/**\n * Iterates sibling list blocks starting from the given node.\n */\nclass SiblingListBlocksIterator {\n  _node;\n  _isForward;\n  _previousNodesByIndent = [];\n  _previous = null;\n  _previousNodeIndent = null;\n  /**\n  * @param node The model node.\n  * @param direction Iteration direction.\n  */\n  constructor(node, direction = 'forward') {\n    this._node = node;\n    this._isForward = direction === 'forward';\n  }\n  [Symbol.iterator]() {\n    return this;\n  }\n  next() {\n    if (!isListItemBlock(this._node)) {\n      return {\n        done: true,\n        value: undefined\n      };\n    }\n    const nodeIndent = this._node.getAttribute('listIndent');\n    let previousNodeInList = null;\n    if (this._previous) {\n      const previousNodeIndent = this._previousNodeIndent;\n      // Let's find previous node for the same indent.\n      // We're going to need that when we get back to previous indent.\n      if (nodeIndent > previousNodeIndent) {\n        this._previousNodesByIndent[previousNodeIndent] = this._previous;\n      } else if (nodeIndent < previousNodeIndent) {\n        previousNodeInList = this._previousNodesByIndent[nodeIndent] || null;\n        this._previousNodesByIndent.length = nodeIndent;\n      } else {\n        previousNodeInList = this._previous;\n      }\n    }\n    const value = {\n      node: this._node,\n      previous: this._previous,\n      previousNodeInList\n    };\n    this._previous = this._node;\n    this._previousNodeIndent = nodeIndent;\n    this._node = this._isForward ? this._node.nextSibling : this._node.previousSibling;\n    return {\n      value,\n      done: false\n    };\n  }\n}\n/**\n * The iterable protocol over the list elements.\n *\n * @internal\n */\nclass ListBlocksIterable {\n  _listHead;\n  /**\n  * @param listHead The head element of a list.\n  */\n  constructor(listHead) {\n    this._listHead = listHead;\n  }\n  /**\n  * List blocks iterator.\n  *\n  * Iterates over all blocks of a list.\n  */\n  [Symbol.iterator]() {\n    return new SiblingListBlocksIterator(this._listHead);\n  }\n}\n\n/**\n * The list item ID generator.\n *\n * @internal\n */\nclass ListItemUid {\n  /**\n  * Returns the next ID.\n  *\n  * @internal\n  */ /* istanbul ignore next: static function definition -- @preserve */\n  static next() {\n    return uid();\n  }\n}\n/**\n * Returns true if the given model node is a list item block.\n *\n * @internal\n */\nfunction isListItemBlock(node) {\n  return !!node && node.is('element') && node.hasAttribute('listItemId');\n}\n/**\n * Returns an array with all elements that represents the same list item.\n *\n * It means that values for `listIndent`, and `listItemId` for all items are equal.\n *\n * @internal\n * @param listItem Starting list item element.\n * @param options.higherIndent Whether blocks with a higher indent level than the start block should be included\n * in the result.\n */\nfunction getAllListItemBlocks(listItem, options = {}) {\n  return [...getListItemBlocks(listItem, {\n    ...options,\n    direction: 'backward'\n  }), ...getListItemBlocks(listItem, {\n    ...options,\n    direction: 'forward'\n  })];\n}\n/**\n * Returns an array with elements that represents the same list item in the specified direction.\n *\n * It means that values for `listIndent` and `listItemId` for all items are equal.\n *\n * **Note**: For backward search the provided item is not included, but for forward search it is included in the result.\n *\n * @internal\n * @param listItem Starting list item element.\n * @param options.direction Walking direction.\n * @param options.higherIndent Whether blocks with a higher indent level than the start block should be included in the result.\n */\nfunction getListItemBlocks(listItem, options = {}) {\n  const isForward = options.direction == 'forward';\n  const items = Array.from(new ListWalker(listItem, {\n    ...options,\n    includeSelf: isForward,\n    sameIndent: true,\n    sameAttributes: 'listItemId'\n  }));\n  return isForward ? items : items.reverse();\n}\n/**\n * Returns a list items nested inside the given list item.\n *\n * @internal\n */\nfunction getNestedListBlocks(listItem) {\n  return Array.from(new ListWalker(listItem, {\n    direction: 'forward',\n    higherIndent: true\n  }));\n}\n/**\n * Returns array of all blocks/items of the same list as given block (same indent, same type and properties).\n *\n * @internal\n * @param listItem Starting list item element.\n * @param options Additional list walker options to modify the range of returned list items.\n */\nfunction getListItems(listItem, options) {\n  const backwardBlocks = new ListWalker(listItem, {\n    sameIndent: true,\n    sameAttributes: 'listType',\n    ...options\n  });\n  const forwardBlocks = new ListWalker(listItem, {\n    sameIndent: true,\n    sameAttributes: 'listType',\n    includeSelf: true,\n    direction: 'forward',\n    ...options\n  });\n  return [...Array.from(backwardBlocks).reverse(), ...forwardBlocks];\n}\n/**\n * Check if the given block is the first in the list item.\n *\n * @internal\n * @param listBlock The list block element.\n */\nfunction isFirstBlockOfListItem(listBlock) {\n  const previousSibling = ListWalker.first(listBlock, {\n    sameIndent: true,\n    sameAttributes: 'listItemId'\n  });\n  if (!previousSibling) {\n    return true;\n  }\n  return false;\n}\n/**\n * Check if the given block is the last in the list item.\n *\n * @internal\n */\nfunction isLastBlockOfListItem(listBlock) {\n  const nextSibling = ListWalker.first(listBlock, {\n    direction: 'forward',\n    sameIndent: true,\n    sameAttributes: 'listItemId'\n  });\n  if (!nextSibling) {\n    return true;\n  }\n  return false;\n}\n/**\n * Expands the given list of selected blocks to include the leading and tailing blocks of partially selected list items.\n *\n * @internal\n * @param blocks The list of selected blocks.\n * @param options.withNested Whether should include nested list items.\n */\nfunction expandListBlocksToCompleteItems(blocks, options = {}) {\n  blocks = toArray(blocks);\n  const higherIndent = options.withNested !== false;\n  const allBlocks = new Set();\n  for (const block of blocks) {\n    for (const itemBlock of getAllListItemBlocks(block, {\n      higherIndent\n    })) {\n      allBlocks.add(itemBlock);\n    }\n  }\n  return sortBlocks(allBlocks);\n}\n/**\n * Expands the given list of selected blocks to include all the items of the lists they're in.\n *\n * @internal\n * @param blocks The list of selected blocks.\n */\nfunction expandListBlocksToCompleteList(blocks) {\n  blocks = toArray(blocks);\n  const allBlocks = new Set();\n  for (const block of blocks) {\n    for (const itemBlock of getListItems(block)) {\n      allBlocks.add(itemBlock);\n    }\n  }\n  return sortBlocks(allBlocks);\n}\n/**\n * Splits the list item just before the provided list block.\n *\n * @internal\n * @param listBlock The list block element.\n * @param writer The model writer.\n * @returns The array of updated blocks.\n */\nfunction splitListItemBefore(listBlock, writer) {\n  const blocks = getListItemBlocks(listBlock, {\n    direction: 'forward'\n  });\n  const id = ListItemUid.next();\n  for (const block of blocks) {\n    writer.setAttribute('listItemId', id, block);\n  }\n  return blocks;\n}\n/**\n * Merges the list item with the parent list item.\n *\n * @internal\n * @param listBlock The list block element.\n * @param parentBlock The list block element to merge with.\n * @param writer The model writer.\n * @returns The array of updated blocks.\n */\nfunction mergeListItemBefore(listBlock, parentBlock, writer) {\n  const attributes = {};\n  for (const [key, value] of parentBlock.getAttributes()) {\n    if (key.startsWith('list')) {\n      attributes[key] = value;\n    }\n  }\n  const blocks = getListItemBlocks(listBlock, {\n    direction: 'forward'\n  });\n  for (const block of blocks) {\n    writer.setAttributes(attributes, block);\n  }\n  return blocks;\n}\n/**\n * Increases indentation of given list blocks.\n *\n * @internal\n * @param blocks The block or iterable of blocks.\n * @param writer The model writer.\n * @param options.expand Whether should expand the list of blocks to include complete list items.\n * @param options.indentBy The number of levels the indentation should change (could be negative).\n */\nfunction indentBlocks(blocks, writer, {\n  expand,\n  indentBy = 1\n} = {}) {\n  blocks = toArray(blocks);\n  // Expand the selected blocks to contain the whole list items.\n  const allBlocks = expand ? expandListBlocksToCompleteItems(blocks) : blocks;\n  for (const block of allBlocks) {\n    const blockIndent = block.getAttribute('listIndent') + indentBy;\n    if (blockIndent < 0) {\n      removeListAttributes(block, writer);\n    } else {\n      writer.setAttribute('listIndent', blockIndent, block);\n    }\n  }\n  return allBlocks;\n}\n/**\n * Decreases indentation of given list of blocks. If the indentation of some blocks matches the indentation\n * of surrounding blocks, they get merged together.\n *\n * @internal\n * @param blocks The block or iterable of blocks.\n * @param writer The model writer.\n */\nfunction outdentBlocksWithMerge(blocks, writer) {\n  blocks = toArray(blocks);\n  // Expand the selected blocks to contain the whole list items.\n  const allBlocks = expandListBlocksToCompleteItems(blocks);\n  const visited = new Set();\n  const referenceIndent = Math.min(...allBlocks.map(block => block.getAttribute('listIndent')));\n  const parentBlocks = new Map();\n  // Collect parent blocks before the list structure gets altered.\n  for (const block of allBlocks) {\n    parentBlocks.set(block, ListWalker.first(block, {\n      lowerIndent: true\n    }));\n  }\n  for (const block of allBlocks) {\n    if (visited.has(block)) {\n      continue;\n    }\n    visited.add(block);\n    const blockIndent = block.getAttribute('listIndent') - 1;\n    if (blockIndent < 0) {\n      removeListAttributes(block, writer);\n      continue;\n    }\n    // Merge with parent list item while outdenting and indent matches reference indent.\n    if (block.getAttribute('listIndent') == referenceIndent) {\n      const mergedBlocks = mergeListItemIfNotLast(block, parentBlocks.get(block), writer);\n      // All list item blocks are updated while merging so add those to visited set.\n      for (const mergedBlock of mergedBlocks) {\n        visited.add(mergedBlock);\n      }\n      // The indent level was updated while merging so continue to next block.\n      if (mergedBlocks.length) {\n        continue;\n      }\n    }\n    writer.setAttribute('listIndent', blockIndent, block);\n  }\n  return sortBlocks(visited);\n}\n/**\n * Removes all list attributes from the given blocks.\n *\n * @internal\n * @param blocks The block or iterable of blocks.\n * @param writer The model writer.\n * @returns Array of altered blocks.\n */\nfunction removeListAttributes(blocks, writer) {\n  blocks = toArray(blocks);\n  // Convert simple list items to plain paragraphs.\n  for (const block of blocks) {\n    if (block.is('element', 'listItem')) {\n      writer.rename(block, 'paragraph');\n    }\n  }\n  // Remove list attributes.\n  for (const block of blocks) {\n    for (const attributeKey of block.getAttributeKeys()) {\n      if (attributeKey.startsWith('list')) {\n        writer.removeAttribute(attributeKey, block);\n      }\n    }\n  }\n  return blocks;\n}\n/**\n * Checks whether the given blocks are related to a single list item.\n *\n * @internal\n * @param blocks The list block elements.\n */\nfunction isSingleListItem(blocks) {\n  if (!blocks.length) {\n    return false;\n  }\n  const firstItemId = blocks[0].getAttribute('listItemId');\n  if (!firstItemId) {\n    return false;\n  }\n  return !blocks.some(item => item.getAttribute('listItemId') != firstItemId);\n}\n/**\n * Modifies the indents of list blocks following the given list block so the indentation is valid after\n * the given block is no longer a list item.\n *\n * @internal\n * @param lastBlock The last list block that has become a non-list element.\n * @param writer The model writer.\n * @returns Array of altered blocks.\n */\nfunction outdentFollowingItems(lastBlock, writer) {\n  const changedBlocks = [];\n  // Start from the model item that is just after the last turned-off item.\n  let currentIndent = Number.POSITIVE_INFINITY;\n  // Correct indent of all items after the last turned off item.\n  // Rules that should be followed:\n  // 1. All direct sub-items of turned-off item should become indent 0, because the first item after it\n  //    will be the first item of a new list. Other items are at the same level, so should have same 0 index.\n  // 2. All items with indent lower than indent of turned-off item should become indent 0, because they\n  //    should not end up as a child of any of list items that they were not children of before.\n  // 3. All other items should have their indent changed relatively to it's parent.\n  //\n  // For example:\n  // 1  * --------\n  // 2     * --------\n  // 3        * --------\t\t\t<-- this is turned off.\n  // 4           * --------\t\t<-- this has to become indent = 0, because it will be first item on a new list.\n  // 5              * --------\t<-- this should be still be a child of item above, so indent = 1.\n  // 6        * --------\t\t\t<-- this has to become indent = 0, because it should not be a child of any of items above.\n  // 7           * --------\t\t<-- this should be still be a child of item above, so indent = 1.\n  // 8     * --------\t\t\t\t<-- this has to become indent = 0.\n  // 9        * --------\t\t\t<-- this should still be a child of item above, so indent = 1.\n  // 10          * --------\t\t<-- this should still be a child of item above, so indent = 2.\n  // 11          * --------\t\t<-- this should still be at the same level as item above, so indent = 2.\n  // 12 * --------\t\t\t\t<-- this and all below are left unchanged.\n  // 13    * --------\n  // 14       * --------\n  //\n  // After turning off 3 the list becomes:\n  //\n  // 1  * --------\n  // 2     * --------\n  //\n  // 3  --------\n  //\n  // 4  * --------\n  // 5     * --------\n  // 6  * --------\n  // 7     * --------\n  // 8  * --------\n  // 9     * --------\n  // 10       * --------\n  // 11       * --------\n  // 12 * --------\n  // 13    * --------\n  // 14       * --------\n  //\n  // Thanks to this algorithm no lists are mismatched and no items get unexpected children/parent, while\n  // those parent-child connection which are possible to maintain are still maintained. It's worth noting\n  // that this is the same effect that we would be get by multiple use of outdent command. However doing\n  // it like this is much more efficient because it's less operation (less memory usage, easier OT) and\n  // less conversion (faster).\n  for (const {\n    node\n  } of new SiblingListBlocksIterator(lastBlock.nextSibling)) {\n    // Check each next list item, as long as its indent is higher than 0.\n    const indent = node.getAttribute('listIndent');\n    // If the indent is 0 we are not going to change anything anyway.\n    if (indent == 0) {\n      break;\n    }\n    // We check if that's item indent is lower than current relative indent.\n    if (indent < currentIndent) {\n      // If it is, current relative indent becomes that indent.\n      currentIndent = indent;\n    }\n    // Fix indent relatively to current relative indent.\n    // Note, that if we just changed the current relative indent, the newIndent will be equal to 0.\n    const newIndent = indent - currentIndent;\n    writer.setAttribute('listIndent', newIndent, node);\n    changedBlocks.push(node);\n  }\n  return changedBlocks;\n}\n/**\n * Returns the array of given blocks sorted by model indexes (document order).\n *\n * @internal\n */\nfunction sortBlocks(blocks) {\n  return Array.from(blocks).filter(block => block.root.rootName !== '$graveyard').sort((a, b) => a.index - b.index);\n}\n/**\n * Returns a selected block object. If a selected object is inline or when there is no selected\n * object, `null` is returned.\n *\n * @internal\n * @param model The instance of editor model.\n * @returns Selected block object or `null`.\n */\nfunction getSelectedBlockObject(model) {\n  const selectedElement = model.document.selection.getSelectedElement();\n  if (!selectedElement) {\n    return null;\n  }\n  if (model.schema.isObject(selectedElement) && model.schema.isBlock(selectedElement)) {\n    return selectedElement;\n  }\n  return null;\n}\n/**\n * Checks whether the given block can be replaced by a listItem.\n *\n * Note that this is possible only when multiBlock = false option is set in feature config.\n *\n * @param block A block to be tested.\n * @param schema The schema of the document.\n */\nfunction canBecomeSimpleListItem(block, schema) {\n  return schema.checkChild(block.parent, 'listItem') && schema.checkChild(block, '$text') && !schema.isObject(block);\n}\n/**\n * Returns true if listType is of type `numbered` or `customNumbered`.\n */\nfunction isNumberedListType(listType) {\n  return listType == 'numbered' || listType == 'customNumbered';\n}\n/**\n * Merges a given block to the given parent block if parent is a list item and there is no more blocks in the same item.\n */\nfunction mergeListItemIfNotLast(block, parentBlock, writer) {\n  const parentItemBlocks = getListItemBlocks(parentBlock, {\n    direction: 'forward'\n  });\n  // Merge with parent only if outdented item wasn't the last one in its parent.\n  // Merge:\n  // * a\t\t\t->\t\t* a\n  //   * [b]\t\t->\t\t  b\n  //   c\t\t\t->\t\t  c\n  // Don't merge:\n  // * a\t\t\t->\t\t* a\n  //   * [b]\t\t-> \t\t* b\n  // * c\t\t\t->\t\t* c\n  if (parentItemBlocks.pop().index > block.index) {\n    return mergeListItemBefore(block, parentBlock, writer);\n  }\n  return [];\n}\n\n/**\n * The document list indent command. It is used by the {@link module:list/list~List list feature}.\n */\nclass ListIndentCommand extends Command {\n  /**\n  * Determines by how much the command will change the list item's indent attribute.\n  */\n  _direction;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor The editor instance.\n  * @param indentDirection The direction of indent. If it is equal to `backward`, the command\n  * will outdent a list item.\n  */\n  constructor(editor, indentDirection) {\n    super(editor);\n    this._direction = indentDirection;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Indents or outdents (depending on the {@link #constructor}'s `indentDirection` parameter) selected list items.\n  *\n  * @fires execute\n  * @fires afterExecute\n  */\n  execute() {\n    const model = this.editor.model;\n    const blocks = getSelectedListBlocks(model.document.selection);\n    model.change(writer => {\n      const changedBlocks = [];\n      // Handle selection contained in the single list item and starting in the following blocks.\n      if (isSingleListItem(blocks) && !isFirstBlockOfListItem(blocks[0])) {\n        // Allow increasing indent of following list item blocks.\n        if (this._direction == 'forward') {\n          changedBlocks.push(...indentBlocks(blocks, writer));\n        }\n        // For indent make sure that indented blocks have a new ID.\n        // For outdent just split blocks from the list item (give them a new IDs).\n        changedBlocks.push(...splitListItemBefore(blocks[0], writer));\n      } else {\n        // Now just update the attributes of blocks.\n        if (this._direction == 'forward') {\n          changedBlocks.push(...indentBlocks(blocks, writer, {\n            expand: true\n          }));\n        } else {\n          changedBlocks.push(...outdentBlocksWithMerge(blocks, writer));\n        }\n      }\n      // Align the list item type to match the previous list item (from the same list).\n      for (const block of changedBlocks) {\n        // This block become a plain block (for example a paragraph).\n        if (!block.hasAttribute('listType')) {\n          continue;\n        }\n        const previousItemBlock = ListWalker.first(block, {\n          sameIndent: true\n        });\n        if (previousItemBlock) {\n          writer.setAttribute('listType', previousItemBlock.getAttribute('listType'), block);\n        }\n      }\n      this._fireAfterExecute(changedBlocks);\n    });\n  }\n  /**\n  * Fires the `afterExecute` event.\n  *\n  * @param changedBlocks The changed list elements.\n  */\n  _fireAfterExecute(changedBlocks) {\n    this.fire('afterExecute', sortBlocks(new Set(changedBlocks)));\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    // Check whether any of position's ancestor is a list item.\n    let blocks = getSelectedListBlocks(this.editor.model.document.selection);\n    let firstBlock = blocks[0];\n    // If selection is not in a list item, the command is disabled.\n    if (!firstBlock) {\n      return false;\n    }\n    // If we are outdenting it is enough to be in list item. Every list item can always be outdented.\n    if (this._direction == 'backward') {\n      return true;\n    }\n    // A single block of a list item is selected, so it could be indented as a sublist.\n    if (isSingleListItem(blocks) && !isFirstBlockOfListItem(blocks[0])) {\n      return true;\n    }\n    blocks = expandListBlocksToCompleteItems(blocks);\n    firstBlock = blocks[0];\n    // Check if there is any list item before selected items that could become a parent of selected items.\n    const siblingItem = ListWalker.first(firstBlock, {\n      sameIndent: true\n    });\n    if (!siblingItem) {\n      return false;\n    }\n    if (siblingItem.getAttribute('listType') == firstBlock.getAttribute('listType')) {\n      return true;\n    }\n    return false;\n  }\n}\n/**\n * Returns an array of selected blocks truncated to the first non list block element.\n */\nfunction getSelectedListBlocks(selection) {\n  const blocks = Array.from(selection.getSelectedBlocks());\n  const firstNonListBlockIndex = blocks.findIndex(block => !isListItemBlock(block));\n  if (firstNonListBlockIndex != -1) {\n    blocks.length = firstNonListBlockIndex;\n  }\n  return blocks;\n}\n\n/**\n * The list command. It is used by the {@link module:list/list~List list feature}.\n */\nclass ListCommand extends Command {\n  /**\n  * The type of the list created by the command.\n  */\n  type;\n  /**\n  * List Walker options that change the range of the list items to be changed when the selection is collapsed within a list item.\n  *\n  * In a multi-level list, when the selection is collapsed within a list item, instead of changing only the list items of the same list\n  * type and current indent level, the entire list structure is changed (all list items at all indent levels of any list type).\n  */\n  _listWalkerOptions;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor The editor instance.\n  * @param type List type that will be handled by this command.\n  */\n  constructor(editor, type, options = {}) {\n    super(editor);\n    this.type = type;\n    this._listWalkerOptions = options.multiLevel ? {\n      higherIndent: true,\n      lowerIndent: true,\n      sameAttributes: []\n    } : undefined;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.value = this._getValue();\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Executes the list command.\n  *\n  * @fires execute\n  * @fires afterExecute\n  * @param options Command options.\n  * @param options.forceValue If set, it will force the command behavior. If `true`, the command will try to convert the\n  * selected items and potentially the neighbor elements to the proper list items. If set to `false` it will convert selected elements\n  * to paragraphs. If not set, the command will toggle selected elements to list items or paragraphs, depending on the selection.\n  * @param options.additionalAttributes Additional attributes that are set for list items when the command is executed.\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const document = model.document;\n    const selectedBlockObject = getSelectedBlockObject(model);\n    const blocks = Array.from(document.selection.getSelectedBlocks()).filter(block => model.schema.checkAttribute(block, 'listType') || canBecomeSimpleListItem(block, model.schema));\n    // Whether we are turning off some items.\n    const turnOff = options.forceValue !== undefined ? !options.forceValue : this.value;\n    model.change(writer => {\n      if (turnOff) {\n        const lastBlock = blocks[blocks.length - 1];\n        // Split the first block from the list item.\n        const itemBlocks = getListItemBlocks(lastBlock, {\n          direction: 'forward'\n        });\n        const changedBlocks = [];\n        if (itemBlocks.length > 1) {\n          changedBlocks.push(...splitListItemBefore(itemBlocks[1], writer));\n        }\n        // Strip list attributes.\n        changedBlocks.push(...removeListAttributes(blocks, writer));\n        // Outdent items following the selected list item.\n        changedBlocks.push(...outdentFollowingItems(lastBlock, writer));\n        this._fireAfterExecute(changedBlocks);\n      } else if ((selectedBlockObject || document.selection.isCollapsed) && isListItemBlock(blocks[0])) {\n        const changedBlocks = getListItems(selectedBlockObject || blocks[0], this._listWalkerOptions);\n        for (const block of changedBlocks) {\n          writer.setAttributes({\n            ...options.additionalAttributes,\n            listType: this.type\n          }, block);\n        }\n        this._fireAfterExecute(changedBlocks);\n      } else {\n        const changedBlocks = [];\n        for (const block of blocks) {\n          // Promote the given block to the list item.\n          if (!block.hasAttribute('listType')) {\n            // Rename block to a simple list item if this option is enabled.\n            if (!block.is('element', 'listItem') && canBecomeSimpleListItem(block, model.schema)) {\n              writer.rename(block, 'listItem');\n            }\n            writer.setAttributes({\n              ...options.additionalAttributes,\n              listIndent: 0,\n              listItemId: ListItemUid.next(),\n              listType: this.type\n            }, block);\n            changedBlocks.push(block);\n          } else {\n            for (const node of expandListBlocksToCompleteItems(block, {\n              withNested: false\n            })) {\n              if (node.getAttribute('listType') != this.type) {\n                writer.setAttributes({\n                  ...options.additionalAttributes,\n                  listType: this.type\n                }, node);\n                changedBlocks.push(node);\n              }\n            }\n          }\n        }\n        this._fireAfterExecute(changedBlocks);\n      }\n    });\n  }\n  /**\n  * Fires the `afterExecute` event.\n  *\n  * @param changedBlocks The changed list elements.\n  */\n  _fireAfterExecute(changedBlocks) {\n    this.fire('afterExecute', sortBlocks(new Set(changedBlocks)));\n  }\n  /**\n  * Checks the command's {@link #value}.\n  *\n  * @returns The current value.\n  */\n  _getValue() {\n    const selection = this.editor.model.document.selection;\n    const blocks = Array.from(selection.getSelectedBlocks());\n    if (!blocks.length) {\n      return false;\n    }\n    for (const block of blocks) {\n      if (block.getAttribute('listType') != this.type) {\n        return false;\n      }\n    }\n    return true;\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const selection = model.document.selection;\n    const blocks = Array.from(selection.getSelectedBlocks());\n    if (!blocks.length) {\n      return false;\n    }\n    // If command value is true it means that we are in list item, so the command should be enabled.\n    if (this.value) {\n      return true;\n    }\n    for (const block of blocks) {\n      if (schema.checkAttribute(block, 'listType') || canBecomeSimpleListItem(block, schema)) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n\n/**\n * The document list merge command. It is used by the {@link module:list/list~List list feature}.\n */\nclass ListMergeCommand extends Command {\n  /**\n  * Whether list item should be merged before or after the selected block.\n  */\n  _direction;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor The editor instance.\n  * @param direction Whether list item should be merged before or after the selected block.\n  */\n  constructor(editor, direction) {\n    super(editor);\n    this._direction = direction;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Merges list blocks together (depending on the {@link #constructor}'s `direction` parameter).\n  *\n  * @fires execute\n  * @fires afterExecute\n  * @param options Command options.\n  * @param options.shouldMergeOnBlocksContentLevel When set `true`, merging will be performed together\n  * with {@link module:engine/model/model~Model#deleteContent} to get rid of the inline content in the selection or take advantage\n  * of the heuristics in `deleteContent()` that helps convert lists into paragraphs in certain cases.\n  */\n  execute({\n    shouldMergeOnBlocksContentLevel = false\n  } = {}) {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const changedBlocks = [];\n    model.change(writer => {\n      const {\n        firstElement,\n        lastElement\n      } = this._getMergeSubjectElements(selection, shouldMergeOnBlocksContentLevel);\n      const firstIndent = firstElement.getAttribute('listIndent') || 0;\n      const lastIndent = lastElement.getAttribute('listIndent');\n      const lastElementId = lastElement.getAttribute('listItemId');\n      if (firstIndent != lastIndent) {\n        const nestedLastElementBlocks = getNestedListBlocks(lastElement);\n        changedBlocks.push(...indentBlocks([lastElement, ...nestedLastElementBlocks], writer, {\n          indentBy: firstIndent - lastIndent,\n          // If outdenting, the entire sub-tree that follows must be included.\n          expand: firstIndent < lastIndent\n        }));\n      }\n      if (shouldMergeOnBlocksContentLevel) {\n        let sel = selection;\n        if (selection.isCollapsed) {\n          sel = writer.createSelection(writer.createRange(writer.createPositionAt(firstElement, 'end'), writer.createPositionAt(lastElement, 0)));\n        }\n        // Delete selected content. Replace entire content only for non-collapsed selection.\n        model.deleteContent(sel, {\n          doNotResetEntireContent: selection.isCollapsed\n        });\n        // Get the last \"touched\" element after deleteContent call (can't use the lastElement because\n        // it could get merged into the firstElement while deleting content).\n        const lastElementAfterDelete = sel.getLastPosition().parent;\n        // Check if the element after it was in the same list item and adjust it if needed.\n        const nextSibling = lastElementAfterDelete.nextSibling;\n        changedBlocks.push(lastElementAfterDelete);\n        if (nextSibling && nextSibling !== lastElement && nextSibling.getAttribute('listItemId') == lastElementId) {\n          changedBlocks.push(...mergeListItemBefore(nextSibling, lastElementAfterDelete, writer));\n        }\n      } else {\n        changedBlocks.push(...mergeListItemBefore(lastElement, firstElement, writer));\n      }\n      this._fireAfterExecute(changedBlocks);\n    });\n  }\n  /**\n  * Fires the `afterExecute` event.\n  *\n  * @param changedBlocks The changed list elements.\n  */\n  _fireAfterExecute(changedBlocks) {\n    this.fire('afterExecute', sortBlocks(new Set(changedBlocks)));\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedBlockObject = getSelectedBlockObject(model);\n    if (selection.isCollapsed || selectedBlockObject) {\n      const positionParent = selectedBlockObject || selection.getFirstPosition().parent;\n      if (!isListItemBlock(positionParent)) {\n        return false;\n      }\n      const siblingNode = this._direction == 'backward' ? positionParent.previousSibling : positionParent.nextSibling;\n      if (!siblingNode) {\n        return false;\n      }\n      if (isSingleListItem([positionParent, siblingNode])) {\n        return false;\n      }\n    } else {\n      const lastPosition = selection.getLastPosition();\n      const firstPosition = selection.getFirstPosition();\n      // If deleting within a single block of a list item, there's no need to merge anything.\n      // The default delete should be executed instead.\n      if (lastPosition.parent === firstPosition.parent) {\n        return false;\n      }\n      if (!isListItemBlock(lastPosition.parent)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  /**\n  * Returns the boundary elements the merge should be executed for. These are not necessarily selection's first\n  * and last position parents but sometimes sibling or even further blocks depending on the context.\n  *\n  * @param selection The selection the merge is executed for.\n  * @param shouldMergeOnBlocksContentLevel When `true`, merge is performed together with\n  * {@link module:engine/model/model~Model#deleteContent} to remove the inline content within the selection.\n  */\n  _getMergeSubjectElements(selection, shouldMergeOnBlocksContentLevel) {\n    const model = this.editor.model;\n    const selectedBlockObject = getSelectedBlockObject(model);\n    let firstElement, lastElement;\n    if (selection.isCollapsed || selectedBlockObject) {\n      const positionParent = selectedBlockObject || selection.getFirstPosition().parent;\n      const isFirstBlock = isFirstBlockOfListItem(positionParent);\n      if (this._direction == 'backward') {\n        lastElement = positionParent;\n        if (isFirstBlock && !shouldMergeOnBlocksContentLevel) {\n          // For the \"c\" as an anchorElement:\n          //  * a\n          //    * b\n          //  * [c]  <-- this block should be merged with \"a\"\n          // It should find \"a\" element to merge with:\n          //  * a\n          //    * b\n          //    c\n          firstElement = ListWalker.first(positionParent, {\n            sameIndent: true,\n            lowerIndent: true\n          });\n        } else {\n          firstElement = positionParent.previousSibling;\n        }\n      } else {\n        // In case of the forward merge there is no case as above, just merge with next sibling.\n        firstElement = positionParent;\n        lastElement = positionParent.nextSibling;\n      }\n    } else {\n      firstElement = selection.getFirstPosition().parent;\n      lastElement = selection.getLastPosition().parent;\n    }\n    return {\n      firstElement: firstElement,\n      lastElement: lastElement\n    };\n  }\n}\n\n/**\n * The document list split command that splits the list item at the selection.\n *\n * It is used by the {@link module:list/list~List list feature}.\n */\nclass ListSplitCommand extends Command {\n  /**\n  * Whether list item should be split before or after the selected block.\n  */\n  _direction;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor The editor instance.\n  * @param direction Whether list item should be split before or after the selected block.\n  */\n  constructor(editor, direction) {\n    super(editor);\n    this._direction = direction;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Splits the list item at the selection.\n  *\n  * @fires execute\n  * @fires afterExecute\n  */\n  execute() {\n    const editor = this.editor;\n    editor.model.change(writer => {\n      const changedBlocks = splitListItemBefore(this._getStartBlock(), writer);\n      this._fireAfterExecute(changedBlocks);\n    });\n  }\n  /**\n  * Fires the `afterExecute` event.\n  *\n  * @param changedBlocks The changed list elements.\n  */\n  _fireAfterExecute(changedBlocks) {\n    this.fire('afterExecute', sortBlocks(new Set(changedBlocks)));\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    const selection = this.editor.model.document.selection;\n    const block = this._getStartBlock();\n    return selection.isCollapsed && isListItemBlock(block) && !isFirstBlockOfListItem(block);\n  }\n  /**\n  * Returns the model element that is the main focus of the command (according to the current selection and command direction).\n  */\n  _getStartBlock() {\n    const doc = this.editor.model.document;\n    const positionParent = doc.selection.getFirstPosition().parent;\n    return this._direction == 'before' ? positionParent : positionParent.nextSibling;\n  }\n}\n\n/**\n * A set of helpers related to document lists.\n */\nclass ListUtils extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ListUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * Expands the given list of selected blocks to include all the items of the lists they're in.\n  *\n  * @param blocks The list of selected blocks.\n  */\n  expandListBlocksToCompleteList(blocks) {\n    return expandListBlocksToCompleteList(blocks);\n  }\n  /**\n  * Check if the given block is the first in the list item.\n  *\n  * @param listBlock The list block element.\n  */\n  isFirstBlockOfListItem(listBlock) {\n    return isFirstBlockOfListItem(listBlock);\n  }\n  /**\n  * Returns true if the given model node is a list item block.\n  *\n  * @param node A model node.\n  */\n  isListItemBlock(node) {\n    return isListItemBlock(node);\n  }\n  /**\n  * Expands the given list of selected blocks to include the leading and tailing blocks of partially selected list items.\n  *\n  * @param blocks The list of selected blocks.\n  * @param options.withNested Whether should include nested list items.\n  */\n  expandListBlocksToCompleteItems(blocks, options = {}) {\n    return expandListBlocksToCompleteItems(blocks, options);\n  }\n  /**\n  * Returns true if listType is of type `numbered` or `customNumbered`.\n  */\n  isNumberedListType(listType) {\n    return isNumberedListType(listType);\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module list/list/utils/view\n    */ /**\n       * Checks if view element is a list type (ul or ol).\n       *\n       * @internal\n       */\nfunction isListView(viewElement) {\n  return viewElement.is('element', 'ol') || viewElement.is('element', 'ul');\n}\n/**\n * Checks if view element is a list item (li).\n *\n * @internal\n */\nfunction isListItemView(viewElement) {\n  return viewElement.is('element', 'li');\n}\n/**\n * Calculates the indent value for a list item. Handles HTML compliant and non-compliant lists.\n *\n * Also, fixes non HTML compliant lists indents:\n *\n * ```\n * before:                                     fixed list:\n * OL                                          OL\n * |-> LI (parent LIs: 0)                      |-> LI     (indent: 0)\n *     |-> OL                                  |-> OL\n *         |-> OL                                  |\n *         |   |-> OL                              |\n *         |       |-> OL                          |\n *         |           |-> LI (parent LIs: 1)      |-> LI (indent: 1)\n *         |-> LI (parent LIs: 1)                  |-> LI (indent: 1)\n *\n * before:                                     fixed list:\n * OL                                          OL\n * |-> OL                                      |\n *     |-> OL                                  |\n *          |-> OL                             |\n *              |-> LI (parent LIs: 0)         |-> LI        (indent: 0)\n *\n * before:                                     fixed list:\n * OL                                          OL\n * |-> LI (parent LIs: 0)                      |-> LI         (indent: 0)\n * |-> OL                                          |-> OL\n *     |-> LI (parent LIs: 0)                          |-> LI (indent: 1)\n * ```\n *\n * @internal\n */\nfunction getIndent$1(listItem) {\n  let indent = 0;\n  let parent = listItem.parent;\n  while (parent) {\n    // Each LI in the tree will result in an increased indent for HTML compliant lists.\n    if (isListItemView(parent)) {\n      indent++;\n    } else {\n      // If however the list is nested in other list we should check previous sibling of any of the list elements...\n      const previousSibling = parent.previousSibling;\n      // ...because the we might need increase its indent:\n      //\t\tbefore:                           fixed list:\n      //\t\tOL                                OL\n      //\t\t|-> LI (parent LIs: 0)            |-> LI         (indent: 0)\n      //\t\t|-> OL                                |-> OL\n      //\t\t    |-> LI (parent LIs: 0)                |-> LI (indent: 1)\n      if (previousSibling && isListItemView(previousSibling)) {\n        indent++;\n      }\n    }\n    parent = parent.parent;\n  }\n  return indent;\n}\n/**\n * Creates a list attribute element (ol or ul).\n *\n * @internal\n */\nfunction createListElement(writer, indent, type, id = getViewElementIdForListType(type, indent)) {\n  // Negative priorities so that restricted editing attribute won't wrap lists.\n  return writer.createAttributeElement(getViewElementNameForListType(type), null, {\n    priority: 2 * indent / 100 - 100,\n    id\n  });\n}\n/**\n * Creates a list item attribute element (li).\n *\n * @internal\n */\nfunction createListItemElement(writer, indent, id) {\n  // Negative priorities so that restricted editing attribute won't wrap list items.\n  return writer.createAttributeElement('li', null, {\n    priority: (2 * indent + 1) / 100 - 100,\n    id\n  });\n}\n/**\n * Returns a view element name for the given list type.\n *\n * @internal\n */\nfunction getViewElementNameForListType(type) {\n  return type == 'numbered' || type == 'customNumbered' ? 'ol' : 'ul';\n}\n/**\n * Returns a view element ID for the given list type and indent.\n *\n * @internal\n */\nfunction getViewElementIdForListType(type, indent) {\n  return `list-${type}-${indent}`;\n}\n\n/**\n * Based on the provided positions looks for the list head and stores it in the provided map.\n *\n * @internal\n * @param position The search starting position.\n * @param itemToListHead The map from list item element to the list head element.\n * @param visited A set of elements that were already visited.\n */\nfunction findAndAddListHeadToMap(position, itemToListHead, visited) {\n  const previousNode = position.nodeBefore;\n  if (!isListItemBlock(previousNode)) {\n    const item = position.nodeAfter;\n    if (isListItemBlock(item)) {\n      itemToListHead.add(item);\n    }\n  } else {\n    let listHead = previousNode;\n    // Previously, the loop below was defined like this:\n    //\n    // \t\tfor ( { node: listHead } of new SiblingListBlocksIterator( listHead, 'backward' ) )\n    //\n    // Unfortunately, such a destructuring is incorrectly transpiled by Babel and the loop never ends.\n    // See: https://github.com/ckeditor/ckeditor5-react/issues/345.\n    for (const {\n      node\n    } of new SiblingListBlocksIterator(listHead, 'backward')) {\n      listHead = node;\n      if (visited.has(listHead)) {\n        return;\n      }\n      visited.add(listHead);\n      if (itemToListHead.has(previousNode)) {\n        return;\n      }\n    }\n    itemToListHead.add(listHead);\n  }\n}\n/**\n * Scans the list starting from the given list head element and fixes items' indentation.\n *\n * @internal\n * @param listNodes The iterable of list nodes.\n * @param writer The model writer.\n * @returns Whether the model was modified.\n */\nfunction fixListIndents(listNodes, writer) {\n  let maxIndent = 0; // Guards local sublist max indents that need fixing.\n  let prevIndent = -1; // Previous item indent.\n  let fixBy = null;\n  let applied = false;\n  for (const {\n    node\n  } of listNodes) {\n    const itemIndent = node.getAttribute('listIndent');\n    if (itemIndent > maxIndent) {\n      let newIndent;\n      if (fixBy === null) {\n        fixBy = itemIndent - maxIndent;\n        newIndent = maxIndent;\n      } else {\n        if (fixBy > itemIndent) {\n          fixBy = itemIndent;\n        }\n        newIndent = itemIndent - fixBy;\n      }\n      if (newIndent > prevIndent + 1) {\n        newIndent = prevIndent + 1;\n      }\n      writer.setAttribute('listIndent', newIndent, node);\n      applied = true;\n      prevIndent = newIndent;\n    } else {\n      fixBy = null;\n      maxIndent = itemIndent + 1;\n      prevIndent = itemIndent;\n    }\n  }\n  return applied;\n}\n/**\n * Scans the list starting from the given list head element and fixes items' types.\n *\n * @internal\n * @param listNodes The iterable of list nodes.\n * @param seenIds The set of already known IDs.\n * @param writer The model writer.\n * @returns Whether the model was modified.\n */\nfunction fixListItemIds(listNodes, seenIds, writer) {\n  const visited = new Set();\n  let applied = false;\n  for (const {\n    node\n  } of listNodes) {\n    if (visited.has(node)) {\n      continue;\n    }\n    let listType = node.getAttribute('listType');\n    let listItemId = node.getAttribute('listItemId');\n    // Use a new ID if this one was spot earlier (even in other list).\n    if (seenIds.has(listItemId)) {\n      listItemId = ListItemUid.next();\n    }\n    seenIds.add(listItemId);\n    // Make sure that all items in a simple list have unique IDs.\n    if (node.is('element', 'listItem')) {\n      if (node.getAttribute('listItemId') != listItemId) {\n        writer.setAttribute('listItemId', listItemId, node);\n        applied = true;\n      }\n      continue;\n    }\n    for (const block of getListItemBlocks(node, {\n      direction: 'forward'\n    })) {\n      visited.add(block);\n      // Use a new ID if a block of a bigger list item has different type.\n      if (block.getAttribute('listType') != listType) {\n        listItemId = ListItemUid.next();\n        listType = block.getAttribute('listType');\n      }\n      if (block.getAttribute('listItemId') != listItemId) {\n        writer.setAttribute('listItemId', listItemId, block);\n        applied = true;\n      }\n    }\n  }\n  return applied;\n}\n\n/**\n * Returns the upcast converter for list items. It's supposed to work after the block converters (content inside list items) are converted.\n *\n * @internal\n */\nfunction listItemUpcastConverter() {\n  return (evt, data, conversionApi) => {\n    const {\n      writer,\n      schema\n    } = conversionApi;\n    if (!data.modelRange) {\n      return;\n    }\n    const items = Array.from(data.modelRange.getItems({\n      shallow: true\n    })).filter(item => schema.checkAttribute(item, 'listItemId'));\n    if (!items.length) {\n      return;\n    }\n    const listItemId = ListItemUid.next();\n    const listIndent = getIndent$1(data.viewItem);\n    let listType = data.viewItem.parent && data.viewItem.parent.is('element', 'ol') ? 'numbered' : 'bulleted';\n    // Preserve list type if was already set (for example by to-do list feature).\n    const firstItemListType = items[0].getAttribute('listType');\n    if (firstItemListType) {\n      listType = firstItemListType;\n    }\n    const attributes = {\n      listItemId,\n      listIndent,\n      listType\n    };\n    for (const item of items) {\n      // Set list attributes only on same level items, those nested deeper are already handled by the recursive conversion.\n      if (!item.hasAttribute('listItemId')) {\n        writer.setAttributes(attributes, item);\n      }\n    }\n    if (items.length > 1) {\n      // Make sure that list item that contain only nested list will preserve paragraph for itself:\n      //\t<ul>\n      //\t\t<li>\n      //\t\t\t<p></p>  <-- this one must be kept\n      //\t\t\t<ul>\n      //\t\t\t\t<li></li>\n      //\t\t\t</ul>\n      //\t\t</li>\n      //\t</ul>\n      if (items[1].getAttribute('listItemId') != attributes.listItemId) {\n        conversionApi.keepEmptyElement(items[0]);\n      }\n    }\n  };\n}\n/**\n * Returns a model document change:data event listener that triggers conversion of related items if needed.\n *\n * @internal\n * @param model The editor model.\n * @param editing The editing controller.\n * @param attributeNames The list of all model list attributes (including registered strategies).\n * @param listEditing The document list editing plugin.\n */\nfunction reconvertItemsOnDataChange(model, editing, attributeNames, listEditing) {\n  return () => {\n    const changes = model.document.differ.getChanges();\n    const itemsToRefresh = [];\n    const itemToListHead = new Set();\n    const changedItems = new Set();\n    const visited = new Set();\n    for (const entry of changes) {\n      if (entry.type == 'insert' && entry.name != '$text') {\n        findAndAddListHeadToMap(entry.position, itemToListHead, visited);\n        // Insert of a non-list item.\n        if (!entry.attributes.has('listItemId')) {\n          findAndAddListHeadToMap(entry.position.getShiftedBy(entry.length), itemToListHead, visited);\n        } else {\n          changedItems.add(entry.position.nodeAfter);\n        }\n      } else if (entry.type == 'remove' && entry.attributes.has('listItemId')) {\n        findAndAddListHeadToMap(entry.position, itemToListHead, visited);\n      } else if (entry.type == 'attribute') {\n        const item = entry.range.start.nodeAfter;\n        if (attributeNames.includes(entry.attributeKey)) {\n          findAndAddListHeadToMap(entry.range.start, itemToListHead, visited);\n          if (entry.attributeNewValue === null) {\n            findAndAddListHeadToMap(entry.range.start.getShiftedBy(1), itemToListHead, visited);\n            // Check if paragraph should be converted from bogus to plain paragraph.\n            if (doesItemBlockRequiresRefresh(item)) {\n              itemsToRefresh.push(item);\n            }\n          } else {\n            changedItems.add(item);\n          }\n        } else if (isListItemBlock(item)) {\n          // Some other attribute was changed on the list item,\n          // check if paragraph does not need to be converted to bogus or back.\n          if (doesItemBlockRequiresRefresh(item)) {\n            itemsToRefresh.push(item);\n          }\n        }\n      }\n    }\n    for (const listHead of itemToListHead.values()) {\n      itemsToRefresh.push(...collectListItemsToRefresh(listHead, changedItems));\n    }\n    for (const item of new Set(itemsToRefresh)) {\n      editing.reconvertItem(item);\n    }\n  };\n  function collectListItemsToRefresh(listHead, changedItems) {\n    const itemsToRefresh = [];\n    const visited = new Set();\n    const stack = [];\n    for (const {\n      node,\n      previous\n    } of new SiblingListBlocksIterator(listHead)) {\n      if (visited.has(node)) {\n        continue;\n      }\n      const itemIndent = node.getAttribute('listIndent');\n      // Current node is at the lower indent so trim the stack.\n      if (previous && itemIndent < previous.getAttribute('listIndent')) {\n        stack.length = itemIndent + 1;\n      }\n      // Update the stack for the current indent level.\n      stack[itemIndent] = Object.fromEntries(Array.from(node.getAttributes()).filter(([key]) => attributeNames.includes(key)));\n      // Find all blocks of the current node.\n      const blocks = getListItemBlocks(node, {\n        direction: 'forward'\n      });\n      for (const block of blocks) {\n        visited.add(block);\n        // Check if bogus vs plain paragraph needs refresh.\n        if (doesItemBlockRequiresRefresh(block, blocks)) {\n          itemsToRefresh.push(block);\n        } else if (doesItemWrappingRequiresRefresh(block, stack, changedItems)) {\n          itemsToRefresh.push(block);\n        }\n      }\n    }\n    return itemsToRefresh;\n  }\n  function doesItemBlockRequiresRefresh(item, blocks) {\n    const viewElement = editing.mapper.toViewElement(item);\n    if (!viewElement) {\n      return false;\n    }\n    const needsRefresh = listEditing.fire('checkElement', {\n      modelElement: item,\n      viewElement\n    });\n    if (needsRefresh) {\n      return true;\n    }\n    if (!item.is('element', 'paragraph') && !item.is('element', 'listItem')) {\n      return false;\n    }\n    const useBogus = shouldUseBogusParagraph(item, attributeNames, blocks);\n    if (useBogus && viewElement.is('element', 'p')) {\n      return true;\n    } else if (!useBogus && viewElement.is('element', 'span')) {\n      return true;\n    }\n    return false;\n  }\n  function doesItemWrappingRequiresRefresh(item, stack, changedItems) {\n    // Items directly affected by some \"change\" don't need a refresh, they will be converted by their own changes.\n    if (changedItems.has(item)) {\n      return false;\n    }\n    const viewElement = editing.mapper.toViewElement(item);\n    let indent = stack.length - 1;\n    // Traverse down the stack to the root to verify if all ULs, OLs, and LIs are as expected.\n    for (let element = viewElement.parent; !element.is('editableElement'); element = element.parent) {\n      const isListItemElement = isListItemView(element);\n      const isListElement = isListView(element);\n      if (!isListElement && !isListItemElement) {\n        continue;\n      }\n      const eventName = `checkAttributes:${isListItemElement ? 'item' : 'list'}`;\n      const needsRefresh = listEditing.fire(eventName, {\n        viewElement: element,\n        modelAttributes: stack[indent]\n      });\n      if (needsRefresh) {\n        break;\n      }\n      if (isListElement) {\n        indent--;\n        // Don't need to iterate further if we already know that the item is wrapped appropriately.\n        if (indent < 0) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n}\n/**\n * Returns the list item downcast converter.\n *\n * @internal\n * @param attributeNames A list of attribute names that should be converted if they are set.\n * @param strategies The strategies.\n * @param model The model.\n */\nfunction listItemDowncastConverter(attributeNames, strategies, model, {\n  dataPipeline\n} = {}) {\n  const consumer = createAttributesConsumer(attributeNames);\n  return (evt, data, conversionApi) => {\n    const {\n      writer,\n      mapper,\n      consumable\n    } = conversionApi;\n    const listItem = data.item;\n    if (!attributeNames.includes(data.attributeKey)) {\n      return;\n    }\n    // Test if attributes on the converted items are not consumed.\n    if (!consumer(listItem, consumable)) {\n      return;\n    }\n    // Use positions mapping instead of mapper.toViewElement( listItem ) to find outermost view element.\n    // This is for cases when mapping is using inner view element like in the code blocks (pre > code).\n    const viewElement = findMappedViewElement(listItem, mapper, model);\n    // Remove custom item marker.\n    removeCustomMarkerElements(viewElement, writer, mapper);\n    // Unwrap element from current list wrappers.\n    unwrapListItemBlock(viewElement, writer);\n    // Insert custom item marker.\n    const viewRange = insertCustomMarkerElements(listItem, viewElement, strategies, writer, {\n      dataPipeline\n    });\n    // Then wrap them with the new list wrappers (UL, OL, LI).\n    wrapListItemBlock(listItem, viewRange, strategies, writer);\n  };\n}\n/**\n * The 'remove' downcast converter for custom markers.\n */\nfunction listItemDowncastRemoveConverter(schema) {\n  return (evt, data, conversionApi) => {\n    const {\n      writer,\n      mapper\n    } = conversionApi;\n    const elementName = evt.name.split(':')[1];\n    // Do not remove marker if the deleted element is some inline object inside paragraph.\n    // See https://github.com/cksource/ckeditor5-internal/issues/3680.\n    if (!schema.checkAttribute(elementName, 'listItemId')) {\n      return;\n    }\n    // Find the view range start position by mapping the model position at which the remove happened.\n    const viewStart = mapper.toViewPosition(data.position);\n    const modelEnd = data.position.getShiftedBy(data.length);\n    const viewEnd = mapper.toViewPosition(modelEnd, {\n      isPhantom: true\n    });\n    // Trim the range to remove in case some UI elements are on the view range boundaries.\n    const viewRange = writer.createRange(viewStart, viewEnd).getTrimmed();\n    // Use positions mapping instead of mapper.toViewElement( listItem ) to find outermost view element.\n    // This is for cases when mapping is using inner view element like in the code blocks (pre > code).\n    const viewElement = viewRange.end.nodeBefore;\n    /* istanbul ignore next -- @preserve */\n    if (!viewElement) {\n      return;\n    }\n    // Remove custom item marker.\n    removeCustomMarkerElements(viewElement, writer, mapper);\n  };\n}\n/**\n * Returns the bogus paragraph view element creator. A bogus paragraph is used if a list item contains only a single block or nested list.\n *\n * @internal\n * @param attributeNames The list of all model list attributes (including registered strategies).\n */\nfunction bogusParagraphCreator(attributeNames, {\n  dataPipeline\n} = {}) {\n  return (modelElement, {\n    writer\n  }) => {\n    // Convert only if a bogus paragraph should be used.\n    if (!shouldUseBogusParagraph(modelElement, attributeNames)) {\n      return null;\n    }\n    if (!dataPipeline) {\n      return writer.createContainerElement('span', {\n        class: 'ck-list-bogus-paragraph'\n      });\n    }\n    // Using `<p>` in case there are some markers on it and transparentRendering will render it anyway.\n    const viewElement = writer.createContainerElement('p');\n    writer.setCustomProperty('dataPipeline:transparentRendering', true, viewElement);\n    return viewElement;\n  };\n}\n/**\n * Helper for mapping mode to view elements. It's using positions mapping instead of mapper.toViewElement( element )\n * to find outermost view element. This is for cases when mapping is using inner view element like in the code blocks (pre > code).\n *\n * @internal\n * @param element The model element.\n * @param mapper The mapper instance.\n * @param model The model.\n */\nfunction findMappedViewElement(element, mapper, model) {\n  const modelRange = model.createRangeOn(element);\n  const viewRange = mapper.toViewRange(modelRange).getTrimmed();\n  return viewRange.end.nodeBefore;\n}\n/**\n * The model to view custom position mapping for cases when marker is injected at the beginning of a block.\n */\nfunction createModelToViewPositionMapper(strategies, view) {\n  return (evt, data) => {\n    if (data.modelPosition.offset > 0) {\n      return;\n    }\n    const positionParent = data.modelPosition.parent;\n    if (!isListItemBlock(positionParent)) {\n      return;\n    }\n    if (!strategies.some(strategy => strategy.scope == 'itemMarker' && strategy.canInjectMarkerIntoElement && strategy.canInjectMarkerIntoElement(positionParent))) {\n      return;\n    }\n    const viewElement = data.mapper.toViewElement(positionParent);\n    const viewRange = view.createRangeIn(viewElement);\n    const viewWalker = viewRange.getWalker();\n    let positionAfterLastMarker = viewRange.start;\n    for (const {\n      item\n    } of viewWalker) {\n      // Walk only over the non-mapped elements (UIElements, AttributeElements, $text, or any other element without mapping).\n      if (item.is('element') && data.mapper.toModelElement(item) || item.is('$textProxy')) {\n        break;\n      }\n      if (item.is('element') && item.getCustomProperty('listItemMarker')) {\n        positionAfterLastMarker = view.createPositionAfter(item);\n        // Jump over the content of the marker (this is not needed for UIElement but required for other element types).\n        viewWalker.skip(({\n          previousPosition\n        }) => !previousPosition.isEqual(positionAfterLastMarker));\n      }\n    }\n    data.viewPosition = positionAfterLastMarker;\n  };\n}\n/**\n * Removes a custom marker elements and item wrappers related to that marker.\n */\nfunction removeCustomMarkerElements(viewElement, viewWriter, mapper) {\n  // Remove item wrapper.\n  while (viewElement.parent.is('attributeElement') && viewElement.parent.getCustomProperty('listItemWrapper')) {\n    viewWriter.unwrap(viewWriter.createRangeOn(viewElement), viewElement.parent);\n  }\n  // Remove custom item markers.\n  const markersToRemove = [];\n  // Markers before a block.\n  collectMarkersToRemove(viewWriter.createPositionBefore(viewElement).getWalker({\n    direction: 'backward'\n  }));\n  // Markers inside a block.\n  collectMarkersToRemove(viewWriter.createRangeIn(viewElement).getWalker());\n  for (const marker of markersToRemove) {\n    viewWriter.remove(marker);\n  }\n  function collectMarkersToRemove(viewWalker) {\n    for (const {\n      item\n    } of viewWalker) {\n      // Walk only over the non-mapped elements (UIElements, AttributeElements, $text, or any other element without mapping).\n      if (item.is('element') && mapper.toModelElement(item)) {\n        break;\n      }\n      if (item.is('element') && item.getCustomProperty('listItemMarker')) {\n        markersToRemove.push(item);\n      }\n    }\n  }\n}\n/**\n * Inserts a custom marker elements and wraps first block of a list item if marker requires it.\n */\nfunction insertCustomMarkerElements(listItem, viewElement, strategies, writer, {\n  dataPipeline\n}) {\n  let viewRange = writer.createRangeOn(viewElement);\n  // Marker can be inserted only before the first block of a list item.\n  if (!isFirstBlockOfListItem(listItem)) {\n    return viewRange;\n  }\n  for (const strategy of strategies) {\n    if (strategy.scope != 'itemMarker') {\n      continue;\n    }\n    // Create the custom marker element and inject it before the first block of the list item.\n    const markerElement = strategy.createElement(writer, listItem, {\n      dataPipeline\n    });\n    if (!markerElement) {\n      continue;\n    }\n    writer.setCustomProperty('listItemMarker', true, markerElement);\n    if (strategy.canInjectMarkerIntoElement && strategy.canInjectMarkerIntoElement(listItem)) {\n      writer.insert(writer.createPositionAt(viewElement, 0), markerElement);\n    } else {\n      writer.insert(viewRange.start, markerElement);\n      viewRange = writer.createRange(writer.createPositionBefore(markerElement), writer.createPositionAfter(viewElement));\n    }\n    // Wrap the marker and optionally the first block with an attribute element (label for to-do lists).\n    if (!strategy.createWrapperElement || !strategy.canWrapElement) {\n      continue;\n    }\n    const wrapper = strategy.createWrapperElement(writer, listItem, {\n      dataPipeline\n    });\n    writer.setCustomProperty('listItemWrapper', true, wrapper);\n    // The whole block can be wrapped...\n    if (strategy.canWrapElement(listItem)) {\n      viewRange = writer.wrap(viewRange, wrapper);\n    } else {\n      // ... or only the marker element (if the block is downcasted to heading or block widget).\n      viewRange = writer.wrap(writer.createRangeOn(markerElement), wrapper);\n      viewRange = writer.createRange(viewRange.start, writer.createPositionAfter(viewElement));\n    }\n  }\n  return viewRange;\n}\n/**\n * Unwraps all ol, ul, and li attribute elements that are wrapping the provided view element.\n */\nfunction unwrapListItemBlock(viewElement, viewWriter) {\n  let attributeElement = viewElement.parent;\n  while (attributeElement.is('attributeElement') && ['ul', 'ol', 'li'].includes(attributeElement.name)) {\n    const parentElement = attributeElement.parent;\n    viewWriter.unwrap(viewWriter.createRangeOn(viewElement), attributeElement);\n    attributeElement = parentElement;\n  }\n}\n/**\n * Wraps the given list item with appropriate attribute elements for ul, ol, and li.\n */\nfunction wrapListItemBlock(listItem, viewRange, strategies, writer) {\n  if (!listItem.hasAttribute('listIndent')) {\n    return;\n  }\n  const listItemIndent = listItem.getAttribute('listIndent');\n  let currentListItem = listItem;\n  for (let indent = listItemIndent; indent >= 0; indent--) {\n    const listItemViewElement = createListItemElement(writer, indent, currentListItem.getAttribute('listItemId'));\n    const listViewElement = createListElement(writer, indent, currentListItem.getAttribute('listType'));\n    for (const strategy of strategies) {\n      if ((strategy.scope == 'list' || strategy.scope == 'item') && currentListItem.hasAttribute(strategy.attributeName)) {\n        strategy.setAttributeOnDowncast(writer, currentListItem.getAttribute(strategy.attributeName), strategy.scope == 'list' ? listViewElement : listItemViewElement);\n      }\n    }\n    viewRange = writer.wrap(viewRange, listItemViewElement);\n    viewRange = writer.wrap(viewRange, listViewElement);\n    if (indent == 0) {\n      break;\n    }\n    currentListItem = ListWalker.first(currentListItem, {\n      lowerIndent: true\n    });\n    // There is no list item with lower indent, this means this is a document fragment containing\n    // only a part of nested list (like copy to clipboard) so we don't need to try to wrap it further.\n    if (!currentListItem) {\n      break;\n    }\n  }\n}\n// Returns the function that is responsible for consuming attributes that are set on the model node.\nfunction createAttributesConsumer(attributeNames) {\n  return (node, consumable) => {\n    const events = [];\n    // Collect all set attributes that are triggering conversion.\n    for (const attributeName of attributeNames) {\n      if (node.hasAttribute(attributeName)) {\n        events.push(`attribute:${attributeName}`);\n      }\n    }\n    if (!events.every(event => consumable.test(node, event) !== false)) {\n      return false;\n    }\n    events.forEach(event => consumable.consume(node, event));\n    return true;\n  };\n}\n// Whether the given item should be rendered as a bogus paragraph.\nfunction shouldUseBogusParagraph(item, attributeNames, blocks = getAllListItemBlocks(item)) {\n  if (!isListItemBlock(item)) {\n    return false;\n  }\n  for (const attributeKey of item.getAttributeKeys()) {\n    // Ignore selection attributes stored on block elements.\n    if (attributeKey.startsWith('selection:') || attributeKey == 'htmlEmptyBlock') {\n      continue;\n    }\n    // Don't use bogus paragraph if there are attributes from other features.\n    if (!attributeNames.includes(attributeKey)) {\n      return false;\n    }\n  }\n  return blocks.length < 2;\n}\n\n/**\n * A list of base list model attributes.\n */\nconst LIST_BASE_ATTRIBUTES = ['listType', 'listIndent', 'listItemId'];\n/**\n * The editing part of the document-list feature. It handles creating, editing and removing lists and list items.\n */\nclass ListEditing extends Plugin {\n  /**\n  * The list of registered downcast strategies.\n  */\n  _downcastStrategies = [];\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ListEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Enter, Delete, ListUtils, ClipboardPipeline];\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('list.multiBlock', true);\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const model = editor.model;\n    const multiBlock = editor.config.get('list.multiBlock');\n    if (editor.plugins.has('LegacyListEditing')) {\n      /**\n      * The `List` feature can not be loaded together with the `LegacyList` plugin.\n      *\n      * @error list-feature-conflict\n      * @param conflictPlugin Name of the plugin.\n      */\n      throw new CKEditorError('list-feature-conflict', this, {\n        conflictPlugin: 'LegacyListEditing'\n      });\n    }\n    model.schema.register('$listItem', {\n      allowAttributes: LIST_BASE_ATTRIBUTES\n    });\n    if (multiBlock) {\n      model.schema.extend('$container', {\n        allowAttributesOf: '$listItem'\n      });\n      model.schema.extend('$block', {\n        allowAttributesOf: '$listItem'\n      });\n      model.schema.extend('$blockObject', {\n        allowAttributesOf: '$listItem'\n      });\n    } else {\n      model.schema.register('listItem', {\n        inheritAllFrom: '$block',\n        allowAttributesOf: '$listItem'\n      });\n    }\n    for (const attribute of LIST_BASE_ATTRIBUTES) {\n      model.schema.setAttributeProperties(attribute, {\n        copyOnReplace: true\n      });\n    }\n    // Register commands.\n    editor.commands.add('numberedList', new ListCommand(editor, 'numbered'));\n    editor.commands.add('bulletedList', new ListCommand(editor, 'bulleted'));\n    editor.commands.add('customNumberedList', new ListCommand(editor, 'customNumbered', {\n      multiLevel: true\n    }));\n    editor.commands.add('customBulletedList', new ListCommand(editor, 'customBulleted', {\n      multiLevel: true\n    }));\n    editor.commands.add('indentList', new ListIndentCommand(editor, 'forward'));\n    editor.commands.add('outdentList', new ListIndentCommand(editor, 'backward'));\n    editor.commands.add('splitListItemBefore', new ListSplitCommand(editor, 'before'));\n    editor.commands.add('splitListItemAfter', new ListSplitCommand(editor, 'after'));\n    if (multiBlock) {\n      editor.commands.add('mergeListItemBackward', new ListMergeCommand(editor, 'backward'));\n      editor.commands.add('mergeListItemForward', new ListMergeCommand(editor, 'forward'));\n    }\n    this._setupDeleteIntegration();\n    this._setupEnterIntegration();\n    this._setupTabIntegration();\n    this._setupClipboardIntegration();\n    this._setupAccessibilityIntegration();\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    const commands = editor.commands;\n    const indent = commands.get('indent');\n    const outdent = commands.get('outdent');\n    if (indent) {\n      // Priority is high due to integration with `IndentBlock` plugin. We want to indent list first and if it's not possible\n      // user can indent content with `IndentBlock` plugin.\n      indent.registerChildCommand(commands.get('indentList'), {\n        priority: 'high'\n      });\n    }\n    if (outdent) {\n      // Priority is lowest due to integration with `IndentBlock` and `IndentCode` plugins.\n      // First we want to allow user to outdent all indendations from other features then he can oudent list item.\n      outdent.registerChildCommand(commands.get('outdentList'), {\n        priority: 'lowest'\n      });\n    }\n    // Register conversion and model post-fixer after other plugins had a chance to register their attribute strategies.\n    this._setupModelPostFixing();\n    this._setupConversion();\n  }\n  /**\n  * Registers a downcast strategy.\n  *\n  * **Note**: Strategies must be registered in the `Plugin#init()` phase so that it can be applied\n  * in the `ListEditing#afterInit()`.\n  *\n  * @param strategy The downcast strategy to register.\n  */\n  registerDowncastStrategy(strategy) {\n    this._downcastStrategies.push(strategy);\n  }\n  /**\n  * Returns list of model attribute names that should affect downcast conversion.\n  */\n  getListAttributeNames() {\n    return [...LIST_BASE_ATTRIBUTES, ...this._downcastStrategies.map(strategy => strategy.attributeName)];\n  }\n  /**\n  * Attaches the listener to the {@link module:engine/view/document~Document#event:delete} event and handles backspace/delete\n  * keys in and around document lists.\n  */\n  _setupDeleteIntegration() {\n    const editor = this.editor;\n    const mergeBackwardCommand = editor.commands.get('mergeListItemBackward');\n    const mergeForwardCommand = editor.commands.get('mergeListItemForward');\n    this.listenTo(editor.editing.view.document, 'delete', (evt, data) => {\n      const selection = editor.model.document.selection;\n      // Let the Widget plugin take care of block widgets while deleting (https://github.com/ckeditor/ckeditor5/issues/11346).\n      if (getSelectedBlockObject(editor.model)) {\n        return;\n      }\n      editor.model.change(() => {\n        const firstPosition = selection.getFirstPosition();\n        if (selection.isCollapsed && data.direction == 'backward') {\n          if (!firstPosition.isAtStart) {\n            return;\n          }\n          const positionParent = firstPosition.parent;\n          if (!isListItemBlock(positionParent)) {\n            return;\n          }\n          const previousBlock = ListWalker.first(positionParent, {\n            sameAttributes: 'listType',\n            sameIndent: true\n          });\n          // Outdent the first block of a first list item.\n          if (!previousBlock && positionParent.getAttribute('listIndent') === 0) {\n            if (!isLastBlockOfListItem(positionParent)) {\n              editor.execute('splitListItemAfter');\n            }\n            editor.execute('outdentList');\n          } else {\n            if (!mergeBackwardCommand || !mergeBackwardCommand.isEnabled) {\n              return;\n            }\n            mergeBackwardCommand.execute({\n              shouldMergeOnBlocksContentLevel: shouldMergeOnBlocksContentLevel(editor.model, 'backward')\n            });\n          }\n          data.preventDefault();\n          evt.stop();\n        } else {\n          // Collapsed selection should trigger forward merging only if at the end of a block.\n          if (selection.isCollapsed && !selection.getLastPosition().isAtEnd) {\n            return;\n          }\n          if (!mergeForwardCommand || !mergeForwardCommand.isEnabled) {\n            return;\n          }\n          mergeForwardCommand.execute({\n            shouldMergeOnBlocksContentLevel: shouldMergeOnBlocksContentLevel(editor.model, 'forward')\n          });\n          data.preventDefault();\n          evt.stop();\n        }\n      });\n    }, {\n      context: 'li'\n    });\n  }\n  /**\n  * Attaches a listener to the {@link module:engine/view/document~Document#event:enter} event and handles enter key press\n  * in document lists.\n  */\n  _setupEnterIntegration() {\n    const editor = this.editor;\n    const model = editor.model;\n    const commands = editor.commands;\n    const enterCommand = commands.get('enter');\n    // Overwrite the default Enter key behavior: outdent or split the list in certain cases.\n    this.listenTo(editor.editing.view.document, 'enter', (evt, data) => {\n      const doc = model.document;\n      const positionParent = doc.selection.getFirstPosition().parent;\n      if (doc.selection.isCollapsed && isListItemBlock(positionParent) && positionParent.isEmpty && !data.isSoft) {\n        const isFirstBlock = isFirstBlockOfListItem(positionParent);\n        const isLastBlock = isLastBlockOfListItem(positionParent);\n        // * a      â†’      * a\n        // * []     â†’      []\n        if (isFirstBlock && isLastBlock) {\n          editor.execute('outdentList');\n          data.preventDefault();\n          evt.stop();\n        } else if (isFirstBlock && !isLastBlock) {\n          editor.execute('splitListItemAfter');\n          data.preventDefault();\n          evt.stop();\n        } else if (isLastBlock) {\n          editor.execute('splitListItemBefore');\n          data.preventDefault();\n          evt.stop();\n        }\n      }\n    }, {\n      context: 'li'\n    });\n    // In some cases, after the default block splitting, we want to modify the new block to become a new list item\n    // instead of an additional block in the same list item.\n    this.listenTo(enterCommand, 'afterExecute', () => {\n      const splitCommand = commands.get('splitListItemBefore');\n      // The command has not refreshed because the change block related to EnterCommand#execute() is not over yet.\n      // Let's keep it up to date and take advantage of ListSplitCommand#isEnabled.\n      splitCommand.refresh();\n      if (!splitCommand.isEnabled) {\n        return;\n      }\n      const doc = editor.model.document;\n      const positionParent = doc.selection.getLastPosition().parent;\n      const listItemBlocks = getAllListItemBlocks(positionParent);\n      // Keep in mind this split happens after the default enter handler was executed. For instance:\n      //\n      // â”‚       Initial state       â”‚    After default enter    â”‚   Here in #afterExecute   â”‚\n      // â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n      // â”‚          * a[]            â”‚           * a             â”‚           * a             â”‚\n      // â”‚                           â”‚             []            â”‚           * []            â”‚\n      if (listItemBlocks.length === 2) {\n        splitCommand.execute();\n      }\n    });\n  }\n  /**\n  * Attaches a listener to the {@link module:engine/view/document~Document#event:tab} event and handles tab key and tab+shift keys\n  * presses in document lists.\n  */\n  _setupTabIntegration() {\n    const editor = this.editor;\n    this.listenTo(editor.editing.view.document, 'tab', (evt, data) => {\n      const commandName = data.shiftKey ? 'outdentList' : 'indentList';\n      const command = this.editor.commands.get(commandName);\n      if (command.isEnabled) {\n        editor.execute(commandName);\n        data.stopPropagation();\n        data.preventDefault();\n        evt.stop();\n      }\n    }, {\n      context: 'li'\n    });\n  }\n  /**\n  * Registers the conversion helpers for the document-list feature.\n  */\n  _setupConversion() {\n    const editor = this.editor;\n    const model = editor.model;\n    const attributeNames = this.getListAttributeNames();\n    const multiBlock = editor.config.get('list.multiBlock');\n    const elementName = multiBlock ? 'paragraph' : 'listItem';\n    editor.conversion.for('upcast') // Convert <li> to a generic paragraph (or listItem element) so the content of <li> is always inside a block.\n    // Setting the listType attribute to let other features (to-do list) know that this is part of a list item.\n    // This is also important to properly handle simple lists so that paragraphs inside a list item won't break the list item.\n    // <li>  <-- converted to listItem\n    //   <p></p> <-- should be also converted to listItem, so it won't split and replace the listItem generated from the above li.\n    .elementToElement({\n      view: 'li',\n      model: (viewElement, {\n        writer\n      }) => writer.createElement(elementName, {\n        listType: ''\n      })\n    }) // Convert paragraph to the list block (without list type defined yet).\n    // This is important to properly handle bogus paragraph and to-do lists.\n    // Most of the time the bogus paragraph should not appear in the data of to-do list,\n    // but if there is any marker or an attribute on the paragraph then the bogus paragraph\n    // is preserved in the data, and we need to be able to detect this case.\n    .elementToElement({\n      view: 'p',\n      model: (viewElement, {\n        writer\n      }) => {\n        if (viewElement.parent && viewElement.parent.is('element', 'li')) {\n          return writer.createElement(elementName, {\n            listType: ''\n          });\n        }\n        return null;\n      },\n      converterPriority: 'high'\n    }).add(dispatcher => {\n      dispatcher.on('element:li', listItemUpcastConverter());\n    });\n    if (!multiBlock) {\n      editor.conversion.for('downcast').elementToElement({\n        model: 'listItem',\n        view: 'p'\n      });\n    }\n    editor.conversion.for('editingDowncast').elementToElement({\n      model: elementName,\n      view: bogusParagraphCreator(attributeNames),\n      converterPriority: 'high'\n    }).add(dispatcher => {\n      dispatcher.on('attribute', listItemDowncastConverter(attributeNames, this._downcastStrategies, model));\n      dispatcher.on('remove', listItemDowncastRemoveConverter(model.schema));\n    });\n    editor.conversion.for('dataDowncast').elementToElement({\n      model: elementName,\n      view: bogusParagraphCreator(attributeNames, {\n        dataPipeline: true\n      }),\n      converterPriority: 'high'\n    }).add(dispatcher => {\n      dispatcher.on('attribute', listItemDowncastConverter(attributeNames, this._downcastStrategies, model, {\n        dataPipeline: true\n      }));\n    });\n    const modelToViewPositionMapper = createModelToViewPositionMapper(this._downcastStrategies, editor.editing.view);\n    editor.editing.mapper.on('modelToViewPosition', modelToViewPositionMapper);\n    editor.data.mapper.on('modelToViewPosition', modelToViewPositionMapper);\n    this.listenTo(model.document, 'change:data', reconvertItemsOnDataChange(model, editor.editing, attributeNames, this), {\n      priority: 'high'\n    });\n    // For LI verify if an ID of the attribute element is correct.\n    this.on('checkAttributes:item', (evt, {\n      viewElement,\n      modelAttributes\n    }) => {\n      if (viewElement.id != modelAttributes.listItemId) {\n        evt.return = true;\n        evt.stop();\n      }\n    });\n    // For UL and OL check if the name and ID of element is correct.\n    this.on('checkAttributes:list', (evt, {\n      viewElement,\n      modelAttributes\n    }) => {\n      if (viewElement.name != getViewElementNameForListType(modelAttributes.listType) || viewElement.id != getViewElementIdForListType(modelAttributes.listType, modelAttributes.listIndent)) {\n        evt.return = true;\n        evt.stop();\n      }\n    });\n  }\n  /**\n  * Registers model post-fixers.\n  */\n  _setupModelPostFixing() {\n    const model = this.editor.model;\n    const attributeNames = this.getListAttributeNames();\n    // Register list fixing.\n    // First the low level handler.\n    model.document.registerPostFixer(writer => modelChangePostFixer$1(model, writer, attributeNames, this));\n    // Then the callbacks for the specific lists.\n    // The indentation fixing must be the first one...\n    this.on('postFixer', (evt, {\n      listNodes,\n      writer\n    }) => {\n      evt.return = fixListIndents(listNodes, writer) || evt.return;\n    }, {\n      priority: 'high'\n    });\n    // ...then the item ids... and after that other fixers that rely on the correct indentation and ids.\n    this.on('postFixer', (evt, {\n      listNodes,\n      writer,\n      seenIds\n    }) => {\n      evt.return = fixListItemIds(listNodes, seenIds, writer) || evt.return;\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Integrates the feature with the clipboard via {@link module:engine/model/model~Model#insertContent} and\n  * {@link module:engine/model/model~Model#getSelectedContent}.\n  */\n  _setupClipboardIntegration() {\n    const model = this.editor.model;\n    const clipboardPipeline = this.editor.plugins.get('ClipboardPipeline');\n    this.listenTo(model, 'insertContent', createModelIndentPasteFixer(model), {\n      priority: 'high'\n    });\n    // To enhance the UX, the editor should not copy list attributes to the clipboard if the selection\n    // started and ended in the same list item.\n    //\n    // If the selection was enclosed in a single list item, there is a good chance the user did not want it\n    // copied as a list item but plain blocks.\n    //\n    // This avoids pasting orphaned list items instead of paragraphs, for instance, straight into the root.\n    //\n    //\t                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    //\t                       â”‚ Selection           â”‚ Clipboard content â”‚\n    //\t                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n    //\t                       â”‚ [* <Widget />]      â”‚ <Widget />        â”‚\n    //\t                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n    //\t                       â”‚ [* Foo]             â”‚ Foo               â”‚\n    //\t                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n    //\t                       â”‚ * Foo [bar] baz     â”‚ bar               â”‚\n    //\t                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n    //\t                       â”‚ * Fo[o              â”‚ o                 â”‚\n    //\t                       â”‚   ba]r              â”‚ ba                â”‚\n    //\t                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n    //\t                       â”‚ * Fo[o              â”‚ * o               â”‚\n    //\t                       â”‚ * ba]r              â”‚ * ba              â”‚\n    //\t                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n    //\t                       â”‚ [* Foo              â”‚ * Foo             â”‚\n    //\t                       â”‚  * bar]             â”‚ * bar             â”‚\n    //\t                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n    //\n    // See https://github.com/ckeditor/ckeditor5/issues/11608, https://github.com/ckeditor/ckeditor5/issues/14969\n    this.listenTo(clipboardPipeline, 'outputTransformation', (evt, data) => {\n      model.change(writer => {\n        // Remove last block if it's empty.\n        const allContentChildren = Array.from(data.content.getChildren());\n        const lastItem = allContentChildren[allContentChildren.length - 1];\n        if (allContentChildren.length > 1 && lastItem.is('element') && lastItem.isEmpty) {\n          const contentChildrenExceptLastItem = allContentChildren.slice(0, -1);\n          if (contentChildrenExceptLastItem.every(isListItemBlock)) {\n            writer.remove(lastItem);\n          }\n        }\n        // Copy/cut only content of a list item (for drag-drop move the whole list item).\n        if (data.method == 'copy' || data.method == 'cut') {\n          const allChildren = Array.from(data.content.getChildren());\n          const isSingleListItemSelected = isSingleListItem(allChildren);\n          if (isSingleListItemSelected) {\n            removeListAttributes(allChildren, writer);\n          }\n        }\n      });\n    });\n  }\n  /**\n  * Informs editor accessibility features about keystrokes brought by the plugin.\n  */\n  _setupAccessibilityIntegration() {\n    const editor = this.editor;\n    const t = editor.t;\n    editor.accessibility.addKeystrokeInfoGroup({\n      id: 'list',\n      label: t('Keystrokes that can be used in a list'),\n      keystrokes: [{\n        label: t('Increase list item indent'),\n        keystroke: 'Tab'\n      }, {\n        label: t('Decrease list item indent'),\n        keystroke: 'Shift+Tab'\n      }]\n    });\n  }\n}\n/**\n * Post-fixer that reacts to changes on document and fixes incorrect model states (invalid `listItemId` and `listIndent` values).\n *\n * In the example below, there is a correct list structure.\n * Then the middle element is removed so the list structure will become incorrect:\n *\n * ```xml\n * <paragraph listType=\"bulleted\" listItemId=\"a\" listIndent=0>Item 1</paragraph>\n * <paragraph listType=\"bulleted\" listItemId=\"b\" listIndent=1>Item 2</paragraph>   <--- this is removed.\n * <paragraph listType=\"bulleted\" listItemId=\"c\" listIndent=2>Item 3</paragraph>\n * ```\n *\n * The list structure after the middle element is removed:\n *\n * ```xml\n * <paragraph listType=\"bulleted\" listItemId=\"a\" listIndent=0>Item 1</paragraph>\n * <paragraph listType=\"bulleted\" listItemId=\"c\" listIndent=2>Item 3</paragraph>\n * ```\n *\n * Should become:\n *\n * ```xml\n * <paragraph listType=\"bulleted\" listItemId=\"a\" listIndent=0>Item 1</paragraph>\n * <paragraph listType=\"bulleted\" listItemId=\"c\" listIndent=1>Item 3</paragraph>   <--- note that indent got post-fixed.\n * ```\n *\n * @param model The data model.\n * @param writer The writer to do changes with.\n * @param attributeNames The list of all model list attributes (including registered strategies).\n * @param ListEditing The document list editing plugin.\n * @returns `true` if any change has been applied, `false` otherwise.\n */\nfunction modelChangePostFixer$1(model, writer, attributeNames, listEditing) {\n  const changes = model.document.differ.getChanges();\n  const visited = new Set();\n  const itemToListHead = new Set();\n  const multiBlock = listEditing.editor.config.get('list.multiBlock');\n  let applied = false;\n  for (const entry of changes) {\n    if (entry.type == 'insert' && entry.name != '$text') {\n      const item = entry.position.nodeAfter;\n      // Remove attributes in case of renamed element.\n      if (!model.schema.checkAttribute(item, 'listItemId')) {\n        for (const attributeName of Array.from(item.getAttributeKeys())) {\n          if (attributeNames.includes(attributeName)) {\n            writer.removeAttribute(attributeName, item);\n            applied = true;\n          }\n        }\n      }\n      findAndAddListHeadToMap(entry.position, itemToListHead, visited);\n      // Insert of a non-list item - check if there is a list after it.\n      if (!entry.attributes.has('listItemId')) {\n        findAndAddListHeadToMap(entry.position.getShiftedBy(entry.length), itemToListHead, visited);\n      }\n      // Check if there is no nested list.\n      for (const {\n        item: innerItem,\n        previousPosition\n      } of model.createRangeIn(item)) {\n        if (isListItemBlock(innerItem)) {\n          findAndAddListHeadToMap(previousPosition, itemToListHead, visited);\n        }\n      }\n    } else if (entry.type == 'remove') {\n      findAndAddListHeadToMap(entry.position, itemToListHead, visited);\n    } else if (entry.type == 'attribute' && attributeNames.includes(entry.attributeKey)) {\n      findAndAddListHeadToMap(entry.range.start, itemToListHead, visited);\n      if (entry.attributeNewValue === null) {\n        findAndAddListHeadToMap(entry.range.start.getShiftedBy(1), itemToListHead, visited);\n      }\n    }\n    // Make sure that there is no left over listItem element without attributes or a block with list attributes that is not a listItem.\n    if (!multiBlock && entry.type == 'attribute' && LIST_BASE_ATTRIBUTES.includes(entry.attributeKey)) {\n      const element = entry.range.start.nodeAfter;\n      if (entry.attributeNewValue === null && element && element.is('element', 'listItem')) {\n        writer.rename(element, 'paragraph');\n        applied = true;\n      } else if (entry.attributeOldValue === null && element && element.is('element') && element.name != 'listItem') {\n        writer.rename(element, 'listItem');\n        applied = true;\n      }\n    }\n  }\n  // Make sure that IDs are not shared by split list.\n  const seenIds = new Set();\n  for (const listHead of itemToListHead.values()) {\n    applied = listEditing.fire('postFixer', {\n      listNodes: new ListBlocksIterable(listHead),\n      listHead,\n      writer,\n      seenIds\n    }) || applied;\n  }\n  return applied;\n}\n/**\n * A fixer for pasted content that includes list items.\n *\n * It fixes indentation of pasted list items so the pasted items match correctly to the context they are pasted into.\n *\n * Example:\n *\n * ```xml\n * <paragraph listType=\"bulleted\" listItemId=\"a\" listIndent=\"0\">A</paragraph>\n * <paragraph listType=\"bulleted\" listItemId=\"b\" listIndent=\"1\">B^</paragraph>\n * // At ^ paste:  <paragraph listType=\"numbered\" listItemId=\"x\" listIndent=\"0\">X</paragraph>\n * //              <paragraph listType=\"numbered\" listItemId=\"y\" listIndent=\"1\">Y</paragraph>\n * <paragraph listType=\"bulleted\" listItemId=\"c\" listIndent=\"2\">C</paragraph>\n * ```\n *\n * Should become:\n *\n * ```xml\n * <paragraph listType=\"bulleted\" listItemId=\"a\" listIndent=\"0\">A</paragraph>\n * <paragraph listType=\"bulleted\" listItemId=\"b\" listIndent=\"1\">BX</paragraph>\n * <paragraph listType=\"bulleted\" listItemId=\"y\" listIndent=\"2\">Y/paragraph>\n * <paragraph listType=\"bulleted\" listItemId=\"c\" listIndent=\"2\">C</paragraph>\n * ```\n */\nfunction createModelIndentPasteFixer(model) {\n  return (evt, [content, selectable]) => {\n    const items = content.is('documentFragment') ? Array.from(content.getChildren()) : [content];\n    if (!items.length) {\n      return;\n    }\n    const selection = selectable ? model.createSelection(selectable) : model.document.selection;\n    const position = selection.getFirstPosition();\n    // Get a reference list item. Attributes of the inserted list items will be fixed according to that item.\n    let refItem;\n    if (isListItemBlock(position.parent)) {\n      refItem = position.parent;\n    } else if (isListItemBlock(position.nodeBefore) && isListItemBlock(position.nodeAfter)) {\n      refItem = position.nodeBefore;\n    } else {\n      return; // Content is not copied into a list.\n    }\n    model.change(writer => {\n      const refType = refItem.getAttribute('listType');\n      const refIndent = refItem.getAttribute('listIndent');\n      const firstElementIndent = items[0].getAttribute('listIndent') || 0;\n      const indentDiff = Math.max(refIndent - firstElementIndent, 0);\n      for (const item of items) {\n        const isListItem = isListItemBlock(item);\n        if (refItem.is('element', 'listItem') && item.is('element', 'paragraph')) {\n          /**\n          * When paragraphs or a plain text list is pasted into a simple list, convert\n          * the `<paragraphs>' to `<listItem>' to avoid breaking the target list.\n          *\n          * See https://github.com/ckeditor/ckeditor5/issues/13826.\n          */\n          writer.rename(item, 'listItem');\n        }\n        writer.setAttributes({\n          listIndent: (isListItem ? item.getAttribute('listIndent') : 0) + indentDiff,\n          listItemId: isListItem ? item.getAttribute('listItemId') : ListItemUid.next(),\n          listType: refType\n        }, item);\n      }\n    });\n  };\n}\n/**\n * Decides whether the merge should be accompanied by the model's `deleteContent()`, for instance, to get rid of the inline\n * content in the selection or take advantage of the heuristics in `deleteContent()` that helps convert lists into paragraphs\n * in certain cases.\n */\nfunction shouldMergeOnBlocksContentLevel(model, direction) {\n  const selection = model.document.selection;\n  if (!selection.isCollapsed) {\n    return !getSelectedBlockObject(model);\n  }\n  if (direction === 'forward') {\n    return true;\n  }\n  const firstPosition = selection.getFirstPosition();\n  const positionParent = firstPosition.parent;\n  const previousSibling = positionParent.previousSibling;\n  if (model.schema.isObject(previousSibling)) {\n    return false;\n  }\n  if (previousSibling.isEmpty) {\n    return true;\n  }\n  return isSingleListItem([positionParent, previousSibling]);\n}\n\n/**\n * Helper method for creating toolbar and menu buttons and linking them with an appropriate command.\n *\n * @internal\n * @param editor The editor instance to which the UI component will be added.\n * @param commandName The name of the command.\n * @param label The button label.\n * @param icon The source of the icon.\n */\nfunction createUIComponents(editor, commandName, label, icon) {\n  editor.ui.componentFactory.add(commandName, () => {\n    const buttonView = _createButton(ButtonView, editor, commandName, label, icon);\n    buttonView.set({\n      tooltip: true,\n      isToggleable: true\n    });\n    return buttonView;\n  });\n  editor.ui.componentFactory.add(`menuBar:${commandName}`, () => {\n    const buttonView = _createButton(MenuBarMenuListItemButtonView, editor, commandName, label, icon);\n    buttonView.set({\n      role: 'menuitemcheckbox',\n      isToggleable: true\n    });\n    return buttonView;\n  });\n}\n/**\n * Creates a button to use either in toolbar or in menu bar.\n */\nfunction _createButton(ButtonClass, editor, commandName, label, icon) {\n  const command = editor.commands.get(commandName);\n  const view = new ButtonClass(editor.locale);\n  view.set({\n    label,\n    icon\n  });\n  // Bind button model to command.\n  view.bind('isOn', 'isEnabled').to(command, 'value', 'isEnabled');\n  // Execute the command.\n  view.on('execute', () => {\n    editor.execute(commandName);\n    editor.editing.view.focus();\n  });\n  return view;\n}\n\n/**\n * The list UI feature. It introduces the `'numberedList'` and `'bulletedList'` buttons that\n * allow to convert paragraphs to and from list items and indent or outdent them.\n */\nclass ListUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ListUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const t = this.editor.t;\n    // Create button numberedList.\n    if (!this.editor.ui.componentFactory.has('numberedList')) {\n      createUIComponents(this.editor, 'numberedList', t('Numbered List'), IconNumberedList);\n    }\n    // Create button bulletedList.\n    if (!this.editor.ui.componentFactory.has('bulletedList')) {\n      createUIComponents(this.editor, 'bulletedList', t('Bulleted List'), IconBulletedList);\n    }\n  }\n}\n\n/**\n * The list feature.\n *\n * This is a \"glue\" plugin that loads the {@link module:list/list/listediting~ListEditing  list\n * editing feature} and {@link module:list/list/listui~ListUI list UI feature}.\n */\nclass List extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ListEditing, ListUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'List';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The list start index command. It changes the `listStart` attribute of the selected list items,\n * letting the user to choose the starting point of an ordered list.\n * It is used by the {@link module:list/listproperties~ListProperties list properties feature}.\n */\nclass ListStartCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const value = this._getValue();\n    this.value = value;\n    this.isEnabled = value != null;\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options.startIndex The list start index.\n  */\n  execute({\n    startIndex = 1\n  } = {}) {\n    const model = this.editor.model;\n    const document = model.document;\n    let blocks = Array.from(document.selection.getSelectedBlocks()).filter(block => isListItemBlock(block) && isNumberedListType(block.getAttribute('listType')));\n    blocks = expandListBlocksToCompleteList(blocks);\n    model.change(writer => {\n      for (const block of blocks) {\n        writer.setAttribute('listStart', startIndex >= 0 ? startIndex : 1, block);\n      }\n    });\n  }\n  /**\n  * Checks the command's {@link #value}.\n  *\n  * @returns The current value.\n  */\n  _getValue() {\n    const model = this.editor.model;\n    const document = model.document;\n    const block = first(document.selection.getSelectedBlocks());\n    if (block && isListItemBlock(block) && isNumberedListType(block.getAttribute('listType'))) {\n      return block.getAttribute('listStart');\n    }\n    return null;\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module list/listproperties/utils/style\n    */\nconst LIST_STYLE_TO_LIST_TYPE = {};\nconst LIST_STYLE_TO_TYPE_ATTRIBUTE = {};\nconst TYPE_ATTRIBUTE_TO_LIST_STYLE = {};\nconst LIST_STYLE_TYPES = [{\n  listStyle: 'disc',\n  typeAttribute: 'disc',\n  listType: 'bulleted'\n}, {\n  listStyle: 'circle',\n  typeAttribute: 'circle',\n  listType: 'bulleted'\n}, {\n  listStyle: 'square',\n  typeAttribute: 'square',\n  listType: 'bulleted'\n}, {\n  listStyle: 'decimal',\n  typeAttribute: '1',\n  listType: 'numbered'\n}, {\n  listStyle: 'decimal-leading-zero',\n  typeAttribute: null,\n  listType: 'numbered'\n}, {\n  listStyle: 'lower-roman',\n  typeAttribute: 'i',\n  listType: 'numbered'\n}, {\n  listStyle: 'upper-roman',\n  typeAttribute: 'I',\n  listType: 'numbered'\n}, {\n  listStyle: 'lower-alpha',\n  typeAttribute: 'a',\n  listType: 'numbered'\n}, {\n  listStyle: 'upper-alpha',\n  typeAttribute: 'A',\n  listType: 'numbered'\n}, {\n  listStyle: 'lower-latin',\n  typeAttribute: 'a',\n  listType: 'numbered'\n}, {\n  listStyle: 'upper-latin',\n  typeAttribute: 'A',\n  listType: 'numbered'\n}];\nfor (const {\n  listStyle,\n  typeAttribute,\n  listType\n} of LIST_STYLE_TYPES) {\n  LIST_STYLE_TO_LIST_TYPE[listStyle] = listType;\n  LIST_STYLE_TO_TYPE_ATTRIBUTE[listStyle] = typeAttribute;\n  if (typeAttribute) {\n    TYPE_ATTRIBUTE_TO_LIST_STYLE[typeAttribute] = listStyle;\n  }\n}\n/**\n * Gets all the style types supported by given list type.\n */\nfunction getAllSupportedStyleTypes() {\n  return LIST_STYLE_TYPES.map(x => x.listStyle);\n}\n/**\n * Checks whether the given list-style-type is supported by numbered or bulleted list.\n */\nfunction getListTypeFromListStyleType$1(listStyleType) {\n  return LIST_STYLE_TO_LIST_TYPE[listStyleType] || null;\n}\n/**\n * Converts `type` attribute of `<ul>` or `<ol>` elements to `list-style-type` equivalent.\n */\nfunction getListStyleTypeFromTypeAttribute(value) {\n  return TYPE_ATTRIBUTE_TO_LIST_STYLE[value] || null;\n}\n/**\n * Converts `list-style-type` style to `type` attribute of `<ul>` or `<ol>` elements.\n */\nfunction getTypeAttributeFromListStyleType(value) {\n  return LIST_STYLE_TO_TYPE_ATTRIBUTE[value] || null;\n}\n/**\n * Normalizes list style by converting aliases to their canonical form.\n *\n * @param listStyle The list style value to normalize.\n * @returns The canonical form of the list style.\n *\n * @example\n * normalizeListStyle( 'lower-alpha' ); // Returns 'lower-latin'\n * normalizeListStyle( 'upper-alpha' ); // Returns 'upper-latin'\n * normalizeListStyle( 'disc' ); // Returns 'disc'\n */\nfunction normalizeListStyle(listStyle) {\n  switch (listStyle) {\n    case 'lower-alpha':\n      return 'lower-latin';\n    case 'upper-alpha':\n      return 'upper-latin';\n    default:\n      return listStyle;\n  }\n}\n\n/**\n * The list style command. It changes `listStyle` attribute of the selected list items,\n * letting the user choose styles for the list item markers.\n * It is used by the {@link module:list/listproperties~ListProperties list properties feature}.\n */\nclass ListStyleCommand extends Command {\n  /**\n  * The default type of the list style.\n  */\n  defaultType;\n  /**\n  * The list of supported style types by this command.\n  */\n  _supportedTypes;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor The editor instance.\n  * @param defaultType The list type that will be used by default if the value was not specified during\n  * the command execution.\n  * @param supportedTypes The list of supported style types by this command.\n  */\n  constructor(editor, defaultType, supportedTypes) {\n    super(editor);\n    this.defaultType = defaultType;\n    this._supportedTypes = supportedTypes;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.value = this._getValue();\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options.type The type of the list style, e.g. `'disc'` or `'square'`. If `null` is specified, the default\n  * style will be applied.\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const document = model.document;\n    model.change(writer => {\n      this._tryToConvertItemsToList(options);\n      let blocks = Array.from(document.selection.getSelectedBlocks()).filter(block => block.hasAttribute('listType'));\n      if (!blocks.length) {\n        return;\n      }\n      blocks = expandListBlocksToCompleteList(blocks);\n      for (const block of blocks) {\n        writer.setAttribute('listStyle', options.type || this.defaultType, block);\n      }\n    });\n  }\n  /**\n  * Checks if the given style type is supported by this plugin.\n  */\n  isStyleTypeSupported(value) {\n    if (!this._supportedTypes) {\n      return true;\n    }\n    return this._supportedTypes.includes(value);\n  }\n  /**\n  * Checks the command's {@link #value}.\n  *\n  * @returns The current value.\n  */\n  _getValue() {\n    const listItem = first(this.editor.model.document.selection.getSelectedBlocks());\n    if (isListItemBlock(listItem)) {\n      return listItem.getAttribute('listStyle');\n    }\n    return null;\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    const editor = this.editor;\n    const numberedList = editor.commands.get('numberedList');\n    const bulletedList = editor.commands.get('bulletedList');\n    return numberedList.isEnabled || bulletedList.isEnabled;\n  }\n  /**\n  * Check if the provided list style is valid. Also change the selection to a list if it's not set yet.\n  *\n  * @param options.type The type of the list style. If `null` is specified, the function does nothing.\n  */\n  _tryToConvertItemsToList(options) {\n    if (!options.type) {\n      return;\n    }\n    const listType = getListTypeFromListStyleType$1(options.type);\n    if (!listType) {\n      return;\n    }\n    const editor = this.editor;\n    const commandName = `${listType}List`;\n    const command = editor.commands.get(commandName);\n    if (!command.value) {\n      editor.execute(commandName);\n    }\n  }\n}\n\n/**\n * The list reversed command. It changes the `listReversed` attribute of the selected list items,\n * letting the user to choose the order of an ordered list.\n * It is used by the {@link module:list/listproperties~ListProperties list properties feature}.\n */\nclass ListReversedCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const value = this._getValue();\n    this.value = value;\n    this.isEnabled = value != null;\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options.reversed Whether the list should be reversed.\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const document = model.document;\n    let blocks = Array.from(document.selection.getSelectedBlocks()).filter(block => isListItemBlock(block) && block.getAttribute('listType') == 'numbered');\n    blocks = expandListBlocksToCompleteList(blocks);\n    model.change(writer => {\n      for (const block of blocks) {\n        writer.setAttribute('listReversed', !!options.reversed, block);\n      }\n    });\n  }\n  /**\n  * Checks the command's {@link #value}.\n  */\n  _getValue() {\n    const model = this.editor.model;\n    const document = model.document;\n    const block = first(document.selection.getSelectedBlocks());\n    if (isListItemBlock(block) && block.getAttribute('listType') == 'numbered') {\n      return block.getAttribute('listReversed');\n    }\n    return null;\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module list/listproperties/converters\n    */ /**\n       * Returns a converter that consumes the `style`, `reversed`, and `start` attributes.\n       * In `style`, it searches for the `list-style-type` definition.\n       * If not found, the `\"default\"` value will be used.\n       *\n       * @internal\n       * @param strategy\n       */\nfunction listPropertiesUpcastConverter(strategy) {\n  return (evt, data, conversionApi) => {\n    const {\n      writer,\n      schema,\n      consumable\n    } = conversionApi;\n    // If there is no view consumable to consume, set the default attribute value to be able to reconvert nested lists on parent change.\n    // So abort converting if attribute was directly consumed.\n    if (consumable.test(data.viewItem, strategy.viewConsumables) === false) {\n      return;\n    }\n    if (!data.modelRange) {\n      Object.assign(data, conversionApi.convertChildren(data.viewItem, data.modelCursor));\n    }\n    let applied = false;\n    for (const item of data.modelRange.getItems({\n      shallow: true\n    })) {\n      if (!schema.checkAttribute(item, strategy.attributeName)) {\n        continue;\n      }\n      if (!strategy.appliesToListItem(item)) {\n        continue;\n      }\n      // Set list attributes only on same level items, those nested deeper are already handled by the recursive conversion.\n      if (item.hasAttribute(strategy.attributeName)) {\n        continue;\n      }\n      writer.setAttribute(strategy.attributeName, strategy.getAttributeOnUpcast(data.viewItem), item);\n      applied = true;\n    }\n    if (applied) {\n      consumable.consume(data.viewItem, strategy.viewConsumables);\n    }\n  };\n}\n\n/**\n * A set of helpers related to document lists.\n */\nclass ListPropertiesUtils extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ListPropertiesUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * Gets all the style types supported by given list type.\n  */\n  getAllSupportedStyleTypes() {\n    return getAllSupportedStyleTypes();\n  }\n  /**\n  * Checks whether the given list-style-type is supported by numbered or bulleted list.\n  */\n  getListTypeFromListStyleType(listStyleType) {\n    return getListTypeFromListStyleType$1(listStyleType);\n  }\n  /**\n  * Converts `type` attribute of `<ul>` or `<ol>` elements to `list-style-type` equivalent.\n  */\n  getListStyleTypeFromTypeAttribute(value) {\n    return getListStyleTypeFromTypeAttribute(value);\n  }\n  /**\n  * Converts `list-style-type` style to `type` attribute of `<ul>` or `<ol>` elements.\n  */\n  getTypeAttributeFromListStyleType(value) {\n    return getTypeAttributeFromListStyleType(value);\n  }\n}\n\n/**\n * Normalizes {@link module:list/listconfig~ListPropertiesConfig} in the configuration of the list properties feature.\n * The structure of normalized list properties options looks as follows:\n *\n * ```ts\n * {\n * \tstyles: {\n * \t\tlistTypes: [ 'bulleted', 'numbered' ],\n * \t\tuseAttribute: false\n * \t},\n * \tstartIndex: true,\n * \treversed: true\n * }\n * ```\n *\n * @param config The list properties {@link module:list/listconfig~ListPropertiesConfig config}.\n * @returns An object with normalized list properties options.\n */\nfunction getNormalizedConfig(config) {\n  const {\n    startIndex,\n    reversed,\n    styles\n  } = config;\n  return {\n    styles: getNormalizedStylesConfig(styles),\n    startIndex: startIndex || false,\n    reversed: reversed || false\n  };\n}\n/**\n * Normalizes styles in the configuration of the list properties feature.\n * The structure of normalized list properties options looks as follows:\n *\n * ```ts\n * {\n * \tlistTypes: [ 'bulleted', 'numbered' ],\n * \tuseAttribute: false\n * }\n * ```\n *\n * @param styles The list properties styles.\n * @returns An object with normalized list properties styles.\n */\nfunction getNormalizedStylesConfig(styles) {\n  const normalizedConfig = {\n    listTypes: ['bulleted', 'numbered'],\n    useAttribute: false\n  };\n  if (styles === true) {\n    return normalizedConfig;\n  }\n  if (!styles) {\n    normalizedConfig.listTypes = [];\n  } else if (Array.isArray(styles) || typeof styles == 'string') {\n    normalizedConfig.listTypes = toArray(styles);\n  } else {\n    normalizedConfig.listTypes = styles.listTypes ? toArray(styles.listTypes) : normalizedConfig.listTypes;\n    normalizedConfig.useAttribute = !!styles.useAttribute;\n    if (styles.listStyleTypes) {\n      normalizedConfig.listStyleTypes = styles.listStyleTypes;\n    }\n  }\n  return normalizedConfig;\n}\nconst DEFAULT_LIST_TYPE$1 = 'default';\n/**\n * The document list properties engine feature.\n *\n * It registers the `'listStyle'`, `'listReversed'` and `'listStart'` commands if they are enabled in the configuration.\n * Read more in {@link module:list/listconfig~ListPropertiesConfig}.\n */\nclass ListPropertiesEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ListEditing, ListPropertiesUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ListPropertiesEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('list.properties', {\n      styles: true,\n      startIndex: false,\n      reversed: false\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const model = editor.model;\n    const listEditing = editor.plugins.get(ListEditing);\n    const enabledProperties = editor.config.get('list.properties');\n    const strategies = createAttributeStrategies$1(enabledProperties);\n    for (const strategy of strategies) {\n      strategy.addCommand(editor);\n      model.schema.extend('$listItem', {\n        allowAttributes: strategy.attributeName\n      });\n      // Register downcast strategy.\n      listEditing.registerDowncastStrategy({\n        scope: 'list',\n        attributeName: strategy.attributeName,\n        setAttributeOnDowncast(writer, attributeValue, viewElement) {\n          strategy.setAttributeOnDowncast(writer, attributeValue, viewElement);\n        }\n      });\n    }\n    // Set up conversion.\n    editor.conversion.for('upcast').add(dispatcher => {\n      for (const strategy of strategies) {\n        dispatcher.on('element:ol', listPropertiesUpcastConverter(strategy));\n        dispatcher.on('element:ul', listPropertiesUpcastConverter(strategy));\n      }\n    });\n    // Verify if the list view element (ul or ol) requires refreshing.\n    listEditing.on('checkAttributes:list', (evt, {\n      viewElement,\n      modelAttributes\n    }) => {\n      for (const strategy of strategies) {\n        if (strategy.getAttributeOnUpcast(viewElement) != modelAttributes[strategy.attributeName]) {\n          evt.return = true;\n          evt.stop();\n        }\n      }\n    });\n    // Reset list properties after indenting list items.\n    this.listenTo(editor.commands.get('indentList'), 'afterExecute', (evt, changedBlocks) => {\n      model.change(writer => {\n        for (const node of changedBlocks) {\n          for (const strategy of strategies) {\n            if (strategy.appliesToListItem(node)) {\n              // Just reset the attribute.\n              // If there is a previous indented list that this node should be merged into,\n              // the postfixer will unify all the attributes of both sub-lists.\n              writer.setAttribute(strategy.attributeName, strategy.defaultValue, node);\n            }\n          }\n        }\n      });\n    });\n    // Add or remove list properties attributes depending on the list type.\n    listEditing.on('postFixer', (evt, {\n      listNodes,\n      writer\n    }) => {\n      for (const {\n        node\n      } of listNodes) {\n        for (const strategy of strategies) {\n          // Check if attribute is valid.\n          if (strategy.hasValidAttribute(node)) {\n            continue;\n          }\n          // Add missing default property attributes...\n          if (strategy.appliesToListItem(node)) {\n            writer.setAttribute(strategy.attributeName, strategy.defaultValue, node);\n          } else {\n            writer.removeAttribute(strategy.attributeName, node);\n          }\n          evt.return = true;\n        }\n      }\n    });\n    // Make sure that all items in a single list (items at the same level & listType) have the same properties.\n    listEditing.on('postFixer', (evt, {\n      listNodes,\n      writer\n    }) => {\n      for (const {\n        node,\n        previousNodeInList\n      } of listNodes) {\n        // This is a first item of a nested list.\n        if (!previousNodeInList) {\n          continue;\n        }\n        // This is a first block of a list of a different type.\n        if (previousNodeInList.getAttribute('listType') != node.getAttribute('listType')) {\n          continue;\n        }\n        // Copy properties from the previous one.\n        for (const strategy of strategies) {\n          const {\n            attributeName\n          } = strategy;\n          if (!strategy.appliesToListItem(node)) {\n            continue;\n          }\n          const value = previousNodeInList.getAttribute(attributeName);\n          if (node.getAttribute(attributeName) != value) {\n            writer.setAttribute(attributeName, value, node);\n            evt.return = true;\n          }\n        }\n      }\n    });\n  }\n}\n/**\n * Creates an array of strategies for dealing with enabled listItem attributes.\n */\nfunction createAttributeStrategies$1(enabledProperties) {\n  const strategies = [];\n  const normalizedConfig = getNormalizedConfig(enabledProperties);\n  if (enabledProperties.styles) {\n    const useAttribute = normalizedConfig.styles.useAttribute;\n    strategies.push({\n      attributeName: 'listStyle',\n      defaultValue: DEFAULT_LIST_TYPE$1,\n      viewConsumables: {\n        styles: 'list-style-type'\n      },\n      addCommand(editor) {\n        let supportedTypes = getAllSupportedStyleTypes();\n        if (useAttribute) {\n          supportedTypes = supportedTypes.filter(styleType => !!getTypeAttributeFromListStyleType(styleType));\n        }\n        editor.commands.add('listStyle', new ListStyleCommand(editor, DEFAULT_LIST_TYPE$1, supportedTypes));\n      },\n      appliesToListItem(item) {\n        return item.getAttribute('listType') == 'numbered' || item.getAttribute('listType') == 'bulleted';\n      },\n      hasValidAttribute(item) {\n        if (!this.appliesToListItem(item)) {\n          return !item.hasAttribute('listStyle');\n        }\n        if (!item.hasAttribute('listStyle')) {\n          return false;\n        }\n        const value = item.getAttribute('listStyle');\n        if (value == DEFAULT_LIST_TYPE$1) {\n          return true;\n        }\n        return getListTypeFromListStyleType$1(value) == item.getAttribute('listType');\n      },\n      setAttributeOnDowncast(writer, listStyle, element) {\n        if (listStyle && listStyle !== DEFAULT_LIST_TYPE$1) {\n          if (useAttribute) {\n            const value = getTypeAttributeFromListStyleType(listStyle);\n            if (value) {\n              writer.setAttribute('type', value, element);\n              return;\n            }\n          } else {\n            writer.setStyle('list-style-type', listStyle, element);\n            return;\n          }\n        }\n        writer.removeStyle('list-style-type', element);\n        writer.removeAttribute('type', element);\n      },\n      getAttributeOnUpcast(listParent) {\n        const style = listParent.getStyle('list-style-type');\n        if (style) {\n          return normalizeListStyle(style);\n        }\n        const attribute = listParent.getAttribute('type');\n        if (attribute) {\n          return getListStyleTypeFromTypeAttribute(attribute);\n        }\n        return DEFAULT_LIST_TYPE$1;\n      }\n    });\n  }\n  if (enabledProperties.reversed) {\n    strategies.push({\n      attributeName: 'listReversed',\n      defaultValue: false,\n      viewConsumables: {\n        attributes: 'reversed'\n      },\n      addCommand(editor) {\n        editor.commands.add('listReversed', new ListReversedCommand(editor));\n      },\n      appliesToListItem(item) {\n        return item.getAttribute('listType') == 'numbered';\n      },\n      hasValidAttribute(item) {\n        return this.appliesToListItem(item) == item.hasAttribute('listReversed');\n      },\n      setAttributeOnDowncast(writer, listReversed, element) {\n        if (listReversed) {\n          writer.setAttribute('reversed', 'reversed', element);\n        } else {\n          writer.removeAttribute('reversed', element);\n        }\n      },\n      getAttributeOnUpcast(listParent) {\n        return listParent.hasAttribute('reversed');\n      }\n    });\n  }\n  if (enabledProperties.startIndex) {\n    strategies.push({\n      attributeName: 'listStart',\n      defaultValue: 1,\n      viewConsumables: {\n        attributes: 'start'\n      },\n      addCommand(editor) {\n        editor.commands.add('listStart', new ListStartCommand(editor));\n      },\n      appliesToListItem(item) {\n        return isNumberedListType(item.getAttribute('listType'));\n      },\n      hasValidAttribute(item) {\n        return this.appliesToListItem(item) == item.hasAttribute('listStart');\n      },\n      setAttributeOnDowncast(writer, listStart, element) {\n        if (listStart == 0 || listStart > 1) {\n          writer.setAttribute('start', listStart, element);\n        } else {\n          writer.removeAttribute('start', element);\n        }\n      },\n      getAttributeOnUpcast(listParent) {\n        const startAttributeValue = listParent.getAttribute('start');\n        return startAttributeValue >= 0 ? startAttributeValue : 1;\n      }\n    });\n  }\n  return strategies;\n}\n\n/**\n * The list properties view to be displayed in the list dropdown.\n *\n * Contains a grid of available list styles and, for numbered list, also the list start index and reversed fields.\n *\n * @internal\n */\nclass ListPropertiesView extends View {\n  /**\n  * A collection of the child views.\n  */\n  children;\n  /**\n  * A view that renders the grid of list styles.\n  */\n  stylesView = null;\n  /**\n  * A collapsible view that hosts additional list property fields ({@link #startIndexFieldView} and\n  * {@link #reversedSwitchButtonView}) to visually separate them from the {@link #stylesView grid of styles}.\n  *\n  * **Note**: Only present when:\n  * * the view represents **numbered** list properties,\n  * * and the {@link #stylesView} is rendered,\n  * * and either {@link #startIndexFieldView} or {@link #reversedSwitchButtonView} is rendered.\n  *\n  * @readonly\n  */\n  additionalPropertiesCollapsibleView = null;\n  /**\n  * A labeled number field allowing the user to set the start index of the list.\n  *\n  * **Note**: Only present when the view represents **numbered** list properties.\n  *\n  * @readonly\n  */\n  startIndexFieldView = null;\n  /**\n  * A switch button allowing the user to make the edited list reversed.\n  *\n  * **Note**: Only present when the view represents **numbered** list properties.\n  *\n  * @readonly\n  */\n  reversedSwitchButtonView = null;\n  /**\n  * Tracks information about the DOM focus in the view.\n  */\n  focusTracker = new FocusTracker();\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes = new KeystrokeHandler();\n  /**\n  * A collection of views that can be focused in the properties view.\n  */\n  focusables = new ViewCollection();\n  /**\n  * Helps cycling over {@link #focusables} in the view.\n  */\n  focusCycler;\n  /**\n  * Creates an instance of the list properties view.\n  *\n  * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n  * @param options Options of the view.\n  * @param options.enabledProperties An object containing the configuration of enabled list property names.\n  * Allows conditional rendering the sub-components of the properties view.\n  * @param options.styleButtonViews A list of style buttons to be rendered\n  * inside the styles grid. The grid will not be rendered when `enabledProperties` does not include the `'styles'` key.\n  * @param options.styleGridAriaLabel An assistive technologies label set on the grid of styles (if the grid is rendered).\n  */\n  constructor(locale, {\n    enabledProperties,\n    styleButtonViews,\n    styleGridAriaLabel\n  }) {\n    super(locale);\n    const elementCssClasses = ['ck', 'ck-list-properties'];\n    this.children = this.createCollection();\n    this.focusCycler = new FocusCycler({\n      focusables: this.focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate #children backwards using the <kbd>Shift</kbd> + <kbd>Tab</kbd> keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate #children forwards using the <kbd>Tab</kbd> key.\n        focusNext: 'tab'\n      }\n    });\n    // The rendering of the styles grid is conditional. When there is no styles grid, the view will render without collapsible\n    // for numbered list properties, hence simplifying the layout.\n    if (styleButtonViews && styleButtonViews.length) {\n      this.stylesView = this._createStylesView(styleButtonViews, styleGridAriaLabel);\n      this.children.add(this.stylesView);\n    } else {\n      elementCssClasses.push('ck-list-properties_without-styles');\n    }\n    // The rendering of the numbered list property views is also conditional. It only makes sense for the numbered list\n    // dropdown. The unordered list does not have such properties.\n    if (enabledProperties.startIndex || enabledProperties.reversed) {\n      this._addNumberedListPropertyViews(enabledProperties);\n      elementCssClasses.push('ck-list-properties_with-numbered-properties');\n    }\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: elementCssClasses\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    if (this.stylesView) {\n      this.focusables.add(this.stylesView);\n      this.focusTracker.add(this.stylesView.element);\n      // Register the collapsible toggle button to the focus system.\n      if (this.startIndexFieldView || this.reversedSwitchButtonView) {\n        this.focusables.add(this.children.last.buttonView);\n        this.focusTracker.add(this.children.last.buttonView.element);\n      }\n      for (const item of this.stylesView.children) {\n        this.stylesView.focusTracker.add(item.element);\n      }\n      addKeyboardHandlingForGrid({\n        keystrokeHandler: this.stylesView.keystrokes,\n        focusTracker: this.stylesView.focusTracker,\n        gridItems: this.stylesView.children,\n        // Note: The styles view has a different number of columns depending on whether the other properties\n        // are enabled in the dropdown or not (https://github.com/ckeditor/ckeditor5/issues/12340)\n        numberOfColumns: () => global.window.getComputedStyle(this.stylesView.element).getPropertyValue('grid-template-columns').split(' ').length,\n        uiLanguageDirection: this.locale && this.locale.uiLanguageDirection\n      });\n    }\n    if (this.startIndexFieldView) {\n      this.focusables.add(this.startIndexFieldView);\n      this.focusTracker.add(this.startIndexFieldView.element);\n      const stopPropagation = data => data.stopPropagation();\n      // Since the form is in the dropdown panel which is a child of the toolbar, the toolbar's\n      // keystroke handler would take over the key management in the input. We need to prevent\n      // this ASAP. Otherwise, the basic caret movement using the arrow keys will be impossible.\n      this.keystrokes.set('arrowright', stopPropagation);\n      this.keystrokes.set('arrowleft', stopPropagation);\n      this.keystrokes.set('arrowup', stopPropagation);\n      this.keystrokes.set('arrowdown', stopPropagation);\n    }\n    if (this.reversedSwitchButtonView) {\n      this.focusables.add(this.reversedSwitchButtonView);\n      this.focusTracker.add(this.reversedSwitchButtonView.element);\n    }\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  focus() {\n    this.focusCycler.focusFirst();\n  }\n  /**\n  * @inheritDoc\n  */\n  focusLast() {\n    this.focusCycler.focusLast();\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Creates the list styles grid.\n  *\n  * @param styleButtons Buttons to be placed in the grid.\n  * @param styleGridAriaLabel The assistive technology label of the grid.\n  */\n  _createStylesView(styleButtons, styleGridAriaLabel) {\n    const stylesView = new View(this.locale);\n    stylesView.children = stylesView.createCollection();\n    stylesView.children.addMany(styleButtons);\n    stylesView.setTemplate({\n      tag: 'div',\n      attributes: {\n        'aria-label': styleGridAriaLabel,\n        class: ['ck', 'ck-list-styles-list']\n      },\n      children: stylesView.children\n    });\n    stylesView.children.delegate('execute').to(this);\n    stylesView.focus = function () {\n      // If there is a button that is already on, focus it.\n      // It's counterintuitive to focus the first button when there is already a button on.\n      for (const child of this.children) {\n        if (child instanceof ButtonView && child.isOn) {\n          child.focus();\n          return;\n        }\n      }\n      // ... otherwise focus the first button.\n      this.children.first.focus();\n    };\n    stylesView.focusTracker = new FocusTracker();\n    stylesView.keystrokes = new KeystrokeHandler();\n    stylesView.render();\n    stylesView.keystrokes.listenTo(stylesView.element);\n    return stylesView;\n  }\n  /**\n  * Renders {@link #startIndexFieldView} and/or {@link #reversedSwitchButtonView} depending on the configuration of the properties view.\n  *\n  * @param enabledProperties An object containing the configuration of enabled list property names\n  * (see {@link #constructor}).\n  */\n  _addNumberedListPropertyViews(enabledProperties) {\n    const t = this.locale.t;\n    const numberedPropertyViews = [];\n    if (enabledProperties.startIndex) {\n      this.startIndexFieldView = this._createStartIndexField();\n      numberedPropertyViews.push(this.startIndexFieldView);\n    }\n    if (enabledProperties.reversed) {\n      this.reversedSwitchButtonView = this._createReversedSwitchButton();\n      numberedPropertyViews.push(this.reversedSwitchButtonView);\n    }\n    // When there are some style buttons, pack the numbered list properties into a collapsible to separate them.\n    if (this.stylesView) {\n      this.additionalPropertiesCollapsibleView = new CollapsibleView(this.locale, numberedPropertyViews);\n      this.additionalPropertiesCollapsibleView.set({\n        label: t('List properties'),\n        isCollapsed: true\n      });\n      // Don't enable the collapsible view unless either start index or reversed field is enabled (e.g. when no list is selected).\n      this.additionalPropertiesCollapsibleView.buttonView.bind('isEnabled').toMany(numberedPropertyViews, 'isEnabled', (...areEnabled) => areEnabled.some(isEnabled => isEnabled));\n      // Automatically collapse the additional properties collapsible when either start index or reversed field gets disabled.\n      this.additionalPropertiesCollapsibleView.buttonView.on('change:isEnabled', (evt, data, isEnabled) => {\n        if (!isEnabled) {\n          this.additionalPropertiesCollapsibleView.isCollapsed = true;\n        }\n      });\n      this.children.add(this.additionalPropertiesCollapsibleView);\n    } else {\n      this.children.addMany(numberedPropertyViews);\n    }\n  }\n  /**\n  * Creates the list start index labeled field.\n  */\n  _createStartIndexField() {\n    const t = this.locale.t;\n    const startIndexFieldView = new LabeledFieldView(this.locale, createLabeledInputNumber);\n    startIndexFieldView.set({\n      label: t('Start at'),\n      class: 'ck-numbered-list-properties__start-index'\n    });\n    startIndexFieldView.fieldView.set({\n      min: 0,\n      step: 1,\n      value: 1,\n      inputMode: 'numeric'\n    });\n    startIndexFieldView.fieldView.on('input', () => {\n      const inputElement = startIndexFieldView.fieldView.element;\n      const startIndex = inputElement.valueAsNumber;\n      if (Number.isNaN(startIndex)) {\n        // Number inputs allow for the entry of characters that may result in NaN,\n        // such as 'e', '+', '123e', '2-'.\n        startIndexFieldView.errorText = t('Invalid start index value.');\n        return;\n      }\n      if (!inputElement.checkValidity()) {\n        startIndexFieldView.errorText = t('Start index must be greater than 0.');\n      } else {\n        this.fire('listStart', {\n          startIndex\n        });\n      }\n    });\n    return startIndexFieldView;\n  }\n  /**\n  * Creates the reversed list switch button.\n  */\n  _createReversedSwitchButton() {\n    const t = this.locale.t;\n    const reversedButtonView = new SwitchButtonView(this.locale);\n    reversedButtonView.set({\n      withText: true,\n      label: t('Reversed order'),\n      class: 'ck-numbered-list-properties__reversed-order'\n    });\n    reversedButtonView.delegate('execute').to(this, 'listReversed');\n    return reversedButtonView;\n  }\n}\n\n/**\n * The list properties UI plugin. It introduces the extended `'bulletedList'` and `'numberedList'` toolbar\n * buttons that allow users to control such aspects of list as the marker, start index or order.\n *\n * **Note**: Buttons introduced by this plugin override implementations from the {@link module:list/list/listui~ListUI}\n * (because they share the same names).\n */\nclass ListPropertiesUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ListPropertiesUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  init() {\n    const editor = this.editor;\n    const t = editor.locale.t;\n    const propertiesConfig = editor.config.get('list.properties');\n    const normalizedConfig = getNormalizedConfig(propertiesConfig);\n    const stylesListTypes = normalizedConfig.styles.listTypes;\n    // Note: When this plugin does not register the \"bulletedList\" dropdown due to properties configuration,\n    // a simple button will be still registered under the same name by ListUI as a fallback. This should happen\n    // in most editor configuration because the List plugin automatically requires ListUI.\n    if (stylesListTypes.includes('bulleted')) {\n      const styleDefinitions = [{\n        label: t('Toggle the disc list style'),\n        tooltip: t('Disc'),\n        type: 'disc',\n        icon: IconListStyleDisc\n      }, {\n        label: t('Toggle the circle list style'),\n        tooltip: t('Circle'),\n        type: 'circle',\n        icon: IconListStyleCircle\n      }, {\n        label: t('Toggle the square list style'),\n        tooltip: t('Square'),\n        type: 'square',\n        icon: IconListStyleSquare\n      }];\n      const buttonLabel = t('Bulleted List');\n      const styleGridAriaLabel = t('Bulleted list styles toolbar');\n      const commandName = 'bulletedList';\n      editor.ui.componentFactory.add(commandName, getDropdownViewCreator({\n        editor,\n        normalizedConfig,\n        parentCommandName: commandName,\n        buttonLabel,\n        buttonIcon: IconBulletedList,\n        styleGridAriaLabel,\n        styleDefinitions\n      }));\n      // Add the menu bar item for bulleted list.\n      editor.ui.componentFactory.add(`menuBar:${commandName}`, getMenuBarStylesMenuCreator({\n        editor,\n        normalizedConfig,\n        parentCommandName: commandName,\n        buttonLabel,\n        styleGridAriaLabel,\n        styleDefinitions\n      }));\n    }\n    // Note: When this plugin does not register the \"numberedList\" dropdown due to properties configuration,\n    // a simple button will be still registered under the same name by ListUI as a fallback. This should happen\n    // in most editor configuration because the List plugin automatically requires ListUI.\n    if (stylesListTypes.includes('numbered') || propertiesConfig.startIndex || propertiesConfig.reversed) {\n      const styleDefinitions = [{\n        label: t('Toggle the decimal list style'),\n        tooltip: t('Decimal'),\n        type: 'decimal',\n        icon: IconListStyleDecimal\n      }, {\n        label: t('Toggle the decimal with leading zero list style'),\n        tooltip: t('Decimal with leading zero'),\n        type: 'decimal-leading-zero',\n        icon: IconListStyleDecimalLeadingZero\n      }, {\n        label: t('Toggle the lowerâ€“roman list style'),\n        tooltip: t('Lowerâ€“roman'),\n        type: 'lower-roman',\n        icon: IconListStyleLowerRoman\n      }, {\n        label: t('Toggle the upperâ€“roman list style'),\n        tooltip: t('Upper-roman'),\n        type: 'upper-roman',\n        icon: IconListStyleUpperRoman\n      }, {\n        label: t('Toggle the lowerâ€“latin list style'),\n        tooltip: t('Lower-latin'),\n        type: 'lower-latin',\n        icon: IconListStyleLowerLatin\n      }, {\n        label: t('Toggle the upperâ€“latin list style'),\n        tooltip: t('Upper-latin'),\n        type: 'upper-latin',\n        icon: IconListStyleUpperLatin\n      }];\n      const buttonLabel = t('Numbered List');\n      const styleGridAriaLabel = t('Numbered list styles toolbar');\n      const commandName = 'numberedList';\n      editor.ui.componentFactory.add(commandName, getDropdownViewCreator({\n        editor,\n        normalizedConfig,\n        parentCommandName: commandName,\n        buttonLabel,\n        buttonIcon: IconNumberedList,\n        styleGridAriaLabel,\n        styleDefinitions\n      }));\n      // Menu bar menu does not display list start index or reverse UI. If there are no styles enabled,\n      // the menu makes no sense and should be omitted.\n      if (stylesListTypes.includes('numbered')) {\n        editor.ui.componentFactory.add(`menuBar:${commandName}`, getMenuBarStylesMenuCreator({\n          editor,\n          normalizedConfig,\n          parentCommandName: commandName,\n          buttonLabel,\n          styleGridAriaLabel,\n          styleDefinitions\n        }));\n      }\n    }\n  }\n}\n/**\n * A helper that returns a function that creates a split button with a toolbar in the dropdown,\n * which in turn contains buttons allowing users to change list styles in the context of the current selection.\n *\n * @param options.editor\n * @param options.normalizedConfig List properties configuration.\n * @param options.parentCommandName The name of the higher-order editor command associated with\n * the set of particular list styles (e.g. \"bulletedList\" for \"disc\", \"circle\", and \"square\" styles).\n * @param options.buttonLabel Label of the main part of the split button.\n * @param options.buttonIcon The SVG string of an icon for the main part of the split button.\n * @param options.styleGridAriaLabel The ARIA label for the styles grid in the split button dropdown.\n * @param options.styleDefinitions Definitions of the style buttons.\n * @returns A function that can be passed straight into {@link module:ui/componentfactory~ComponentFactory#add}.\n */\nfunction getDropdownViewCreator({\n  editor,\n  normalizedConfig,\n  parentCommandName,\n  buttonLabel,\n  buttonIcon,\n  styleGridAriaLabel,\n  styleDefinitions\n}) {\n  const parentCommand = editor.commands.get(parentCommandName);\n  return locale => {\n    const dropdownView = createDropdown(locale, SplitButtonView);\n    const mainButtonView = dropdownView.buttonView;\n    dropdownView.bind('isEnabled').to(parentCommand);\n    dropdownView.class = 'ck-list-styles-dropdown';\n    // Main button was clicked.\n    mainButtonView.on('execute', () => {\n      editor.execute(parentCommandName);\n      editor.editing.view.focus();\n    });\n    mainButtonView.set({\n      label: buttonLabel,\n      icon: buttonIcon,\n      tooltip: true,\n      isToggleable: true\n    });\n    mainButtonView.bind('isOn').to(parentCommand, 'value', value => !!value);\n    dropdownView.once('change:isOpen', () => {\n      const listPropertiesView = createListPropertiesView({\n        editor,\n        normalizedConfig,\n        dropdownView,\n        parentCommandName,\n        styleGridAriaLabel,\n        styleDefinitions\n      });\n      dropdownView.panelView.children.add(listPropertiesView);\n    });\n    // Focus the editable after executing the command.\n    // Overrides a default behaviour where the focus is moved to the dropdown button (#12125).\n    dropdownView.on('execute', () => {\n      editor.editing.view.focus();\n    });\n    return dropdownView;\n  };\n}\n/**\n * A helper that returns a function (factory) that creates individual buttons used by users to change styles\n * of lists.\n *\n * @param options.editor\n * @param options.listStyleCommand The instance of the `ListStylesCommand` class.\n * @param options.parentCommandName The name of the higher-order command associated with a\n * particular list style (e.g. \"bulletedList\" is associated with \"square\" and \"numberedList\" is associated with \"roman\").\n * @returns A function that can be passed straight into {@link module:ui/componentfactory~ComponentFactory#add}.\n */\nfunction getStyleButtonCreator({\n  editor,\n  listStyleCommand,\n  parentCommandName\n}) {\n  const locale = editor.locale;\n  const parentCommand = editor.commands.get(parentCommandName);\n  return ({\n    label,\n    type,\n    icon,\n    tooltip\n  }) => {\n    const button = new ButtonView(locale);\n    button.set({\n      label,\n      icon,\n      tooltip\n    });\n    button.bind('isOn').to(listStyleCommand, 'value', value => value === type);\n    button.on('execute', () => {\n      // If the content the selection is anchored to is a list, let's change its style.\n      if (parentCommand.value) {\n        // Remove the list when the current list style is the same as the one that would normally be applied.\n        if (listStyleCommand.value === type) {\n          editor.execute(parentCommandName);\n        } else if (listStyleCommand.value !== type) {\n          editor.execute('listStyle', {\n            type\n          });\n        }\n      } else {\n        editor.model.change(() => {\n          editor.execute('listStyle', {\n            type\n          });\n        });\n      }\n    });\n    return button;\n  };\n}\n/**\n * A helper that creates the properties view for the individual style dropdown.\n *\n * @param options.editor Editor instance.\n * @param options.normalizedConfig List properties configuration.\n * @param options.dropdownView Styles dropdown view that hosts the properties view.\n * @param options.parentCommandName The name of the higher-order editor command associated with\n * the set of particular list styles (e.g. \"bulletedList\" for \"disc\", \"circle\", and \"square\" styles).\n * @param options.styleDefinitions Definitions of the style buttons.\n * @param options.styleGridAriaLabel An assistive technologies label set on the grid of styles (if the grid is rendered).\n */\nfunction createListPropertiesView({\n  editor,\n  normalizedConfig,\n  dropdownView,\n  parentCommandName,\n  styleDefinitions,\n  styleGridAriaLabel\n}) {\n  const locale = editor.locale;\n  const enabledProperties = {\n    ...normalizedConfig,\n    ...(parentCommandName != 'numberedList' ? {\n      startIndex: false,\n      reversed: false\n    } : null)\n  };\n  const listType = parentCommandName.replace('List', '');\n  let styleButtonViews = null;\n  if (normalizedConfig.styles.listTypes.includes(listType)) {\n    const listStyleCommand = editor.commands.get('listStyle');\n    const styleButtonCreator = getStyleButtonCreator({\n      editor,\n      parentCommandName,\n      listStyleCommand\n    });\n    const configuredListStylesTypes = normalizedConfig.styles.listStyleTypes;\n    let filteredDefinitions = styleDefinitions;\n    if (configuredListStylesTypes) {\n      const allowedTypes = configuredListStylesTypes[listType];\n      if (allowedTypes) {\n        filteredDefinitions = styleDefinitions.filter(def => allowedTypes.includes(def.type));\n      }\n    }\n    const isStyleTypeSupported = getStyleTypeSupportChecker(listStyleCommand);\n    styleButtonViews = filteredDefinitions.filter(isStyleTypeSupported).map(styleButtonCreator);\n  }\n  const listPropertiesView = new ListPropertiesView(locale, {\n    styleGridAriaLabel,\n    enabledProperties,\n    styleButtonViews\n  });\n  if (normalizedConfig.styles.listTypes.includes(listType)) {\n    // Accessibility: focus the first active style when opening the dropdown.\n    focusChildOnDropdownOpen(dropdownView, () => {\n      return listPropertiesView.stylesView.children.find(child => child.isOn);\n    });\n  }\n  if (enabledProperties.startIndex) {\n    const listStartCommand = editor.commands.get('listStart');\n    listPropertiesView.startIndexFieldView.bind('isEnabled').to(listStartCommand);\n    listPropertiesView.startIndexFieldView.fieldView.bind('value').to(listStartCommand);\n    listPropertiesView.on('listStart', (evt, data) => editor.execute('listStart', data));\n  }\n  if (enabledProperties.reversed) {\n    const listReversedCommand = editor.commands.get('listReversed');\n    listPropertiesView.reversedSwitchButtonView.bind('isEnabled').to(listReversedCommand);\n    listPropertiesView.reversedSwitchButtonView.bind('isOn').to(listReversedCommand, 'value', value => !!value);\n    listPropertiesView.on('listReversed', () => {\n      const isReversed = listReversedCommand.value;\n      editor.execute('listReversed', {\n        reversed: !isReversed\n      });\n    });\n  }\n  // Make sure applying styles closes the dropdown.\n  listPropertiesView.delegate('execute').to(dropdownView);\n  return listPropertiesView;\n}\n/**\n * A helper that creates the list style submenu for menu bar.\n *\n * @param editor Editor instance.\n * @param normalizedConfig List properties configuration.\n * @param parentCommandName Name of the list command.\n * @param buttonLabel Label of the menu button.\n * @param styleGridAriaLabel ARIA label of the styles grid.\n */\nfunction getMenuBarStylesMenuCreator({\n  editor,\n  normalizedConfig,\n  parentCommandName,\n  buttonLabel,\n  styleGridAriaLabel,\n  styleDefinitions\n}) {\n  return locale => {\n    const menuView = new MenuBarMenuView(locale);\n    const listCommand = editor.commands.get(parentCommandName);\n    const listStyleCommand = editor.commands.get('listStyle');\n    const isStyleTypeSupported = getStyleTypeSupportChecker(listStyleCommand);\n    const styleButtonCreator = getStyleButtonCreator({\n      editor,\n      parentCommandName,\n      listStyleCommand\n    });\n    const configuredListStylesTypes = normalizedConfig.styles.listStyleTypes;\n    let filteredDefinitions = styleDefinitions;\n    if (configuredListStylesTypes) {\n      const listType = listCommand.type;\n      const allowedTypes = configuredListStylesTypes[listType];\n      if (allowedTypes) {\n        filteredDefinitions = styleDefinitions.filter(def => allowedTypes.includes(def.type));\n      }\n    }\n    const styleButtonViews = filteredDefinitions.filter(isStyleTypeSupported).map(styleButtonCreator);\n    const listPropertiesView = new ListPropertiesView(locale, {\n      styleGridAriaLabel,\n      enabledProperties: {\n        ...normalizedConfig,\n        // Disable list start index and reversed in the menu bar.\n        startIndex: false,\n        reversed: false\n      },\n      styleButtonViews\n    });\n    listPropertiesView.delegate('execute').to(menuView);\n    menuView.buttonView.set({\n      label: buttonLabel,\n      icon: parentCommandName === 'bulletedList' ? IconBulletedList : IconNumberedList\n    });\n    menuView.panelView.children.add(listPropertiesView);\n    menuView.bind('isEnabled').to(listCommand, 'isEnabled');\n    menuView.on('execute', () => {\n      editor.editing.view.focus();\n    });\n    return menuView;\n  };\n}\nfunction getStyleTypeSupportChecker(listStyleCommand) {\n  if (typeof listStyleCommand.isStyleTypeSupported == 'function') {\n    return styleDefinition => listStyleCommand.isStyleTypeSupported(styleDefinition.type);\n  } else {\n    return () => true;\n  }\n}\n\n/**\n * The list properties feature.\n *\n * This is a \"glue\" plugin that loads the\n * {@link module:list/listproperties/listpropertiesediting~ListPropertiesEditing list properties\n * editing feature} and the {@link module:list/listproperties/listpropertiesui~ListPropertiesUI list properties UI feature}.\n */\nclass ListProperties extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ListPropertiesEditing, ListPropertiesUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ListProperties';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The check to-do command.\n *\n * The command is registered by the {@link module:list/todolist/todolistediting~TodoListEditing} as\n * the `checkTodoList` editor command.\n */\nclass CheckTodoListCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    // Refresh command before executing to be sure all values are up to date.\n    // It is needed when selection has changed before command execution, in the same change block.\n    this.on('execute', () => {\n      this.refresh();\n    }, {\n      priority: 'highest'\n    });\n  }\n  /**\n  * Updates the command's {@link #value} and {@link #isEnabled} properties based on the current selection.\n  */\n  refresh() {\n    const selectedElements = this._getSelectedItems();\n    this.value = this._getValue(selectedElements);\n    this.isEnabled = !!selectedElements.length;\n  }\n  /**\n  * Executes the command.\n  *\n  * @param options.forceValue If set, it will force the command behavior. If `true`, the command will apply\n  * the attribute. Otherwise, the command will remove the attribute. If not set, the command will look for its current\n  * value to decide what it should do.\n  */\n  execute(options = {}) {\n    this.editor.model.change(writer => {\n      const selectedElements = this._getSelectedItems();\n      const value = options.forceValue === undefined ? !this._getValue(selectedElements) : options.forceValue;\n      for (const element of selectedElements) {\n        if (value) {\n          writer.setAttribute('todoListChecked', true, element);\n        } else {\n          writer.removeAttribute('todoListChecked', element);\n        }\n      }\n    });\n  }\n  /**\n  * Returns a value for the command.\n  */\n  _getValue(selectedElements) {\n    return selectedElements.every(element => element.getAttribute('todoListChecked'));\n  }\n  /**\n  * Gets all to-do list items selected by the {@link module:engine/model/selection~Selection}.\n  */\n  _getSelectedItems() {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const selectionRange = model.document.selection.getFirstRange();\n    const startElement = selectionRange.start.parent;\n    const elements = [];\n    if (schema.checkAttribute(startElement, 'todoListChecked')) {\n      elements.push(...getAllListItemBlocks(startElement));\n    }\n    for (const item of selectionRange.getItems({\n      shallow: true\n    })) {\n      if (schema.checkAttribute(item, 'todoListChecked') && !elements.includes(item)) {\n        elements.push(...getAllListItemBlocks(item));\n      }\n    }\n    return elements;\n  }\n}\n\n/**\n * Observes all to-do list checkboxes state changes.\n *\n * Note that this observer is not available by default. To make it available it needs to be added to\n * {@link module:engine/view/view~View} by {@link module:engine/view/view~View#addObserver} method.\n */\nclass TodoCheckboxChangeObserver extends DomEventObserver {\n  /**\n  * @inheritDoc\n  */\n  domEventType = ['change'];\n  /**\n  * @inheritDoc\n  */\n  onDomEvent(domEvent) {\n    if (domEvent.target) {\n      const viewTarget = this.view.domConverter.mapDomToView(domEvent.target);\n      if (viewTarget && viewTarget.is('element', 'input') && viewTarget.getAttribute('type') == 'checkbox' && viewTarget.findAncestor({\n        classes: 'todo-list__label'\n      })) {\n        this.fire('todoCheckboxChange', domEvent);\n      }\n    }\n  }\n}\nconst ITEM_TOGGLE_KEYSTROKE$1 = /* #__PURE__ */parseKeystroke('Ctrl+Enter');\n/**\n * The engine of the to-do list feature. It handles creating, editing and removing to-do lists and their items.\n *\n * It registers the entire functionality of the {@link module:list/list/listediting~ListEditing list editing plugin}\n * and extends it with the commands:\n *\n * - `'todoList'`,\n * - `'checkTodoList'`,\n */\nclass TodoListEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TodoListEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ListEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const model = editor.model;\n    const editing = editor.editing;\n    const listEditing = editor.plugins.get(ListEditing);\n    const multiBlock = editor.config.get('list.multiBlock');\n    const elementName = multiBlock ? 'paragraph' : 'listItem';\n    editor.commands.add('todoList', new ListCommand(editor, 'todo'));\n    editor.commands.add('checkTodoList', new CheckTodoListCommand(editor));\n    editing.view.addObserver(TodoCheckboxChangeObserver);\n    model.schema.extend('$listItem', {\n      allowAttributes: 'todoListChecked'\n    });\n    model.schema.addAttributeCheck(context => {\n      const item = context.last;\n      // Don't allow `todoListChecked` attribute on elements which are not todo list items.\n      if (!item.getAttribute('listItemId') || item.getAttribute('listType') != 'todo') {\n        return false;\n      }\n    }, 'todoListChecked');\n    editor.conversion.for('upcast').add(dispatcher => {\n      // Upcast of to-do list item is based on a checkbox at the beginning of a <li> to keep compatibility with markdown input.\n      dispatcher.on('element:input', todoItemInputConverter());\n      // Priority is set to low to allow generic list item converter to run first.\n      dispatcher.on('element:li', todoListItemUpcastConverter(), {\n        priority: 'low'\n      });\n      // Consume other elements that are normally generated in data downcast, so they won't get captured by GHS.\n      dispatcher.on('element:label', elementUpcastConsumingConverter({\n        name: 'label',\n        classes: 'todo-list__label'\n      }));\n      dispatcher.on('element:label', elementUpcastConsumingConverter({\n        name: 'label',\n        classes: ['todo-list__label', 'todo-list__label_without-description']\n      }));\n      dispatcher.on('element:span', elementUpcastConsumingConverter({\n        name: 'span',\n        classes: 'todo-list__label__description'\n      }));\n      dispatcher.on('element:ul', attributeUpcastConsumingConverter({\n        name: 'ul',\n        classes: 'todo-list'\n      }));\n    });\n    editor.conversion.for('downcast').elementToElement({\n      model: elementName,\n      view: (element, {\n        writer\n      }) => {\n        if (isDescriptionBlock(element, listEditing.getListAttributeNames())) {\n          return writer.createContainerElement('span', {\n            class: 'todo-list__label__description'\n          });\n        }\n      },\n      converterPriority: 'highest'\n    });\n    listEditing.registerDowncastStrategy({\n      scope: 'list',\n      attributeName: 'listType',\n      setAttributeOnDowncast(writer, value, element) {\n        if (value == 'todo') {\n          writer.addClass('todo-list', element);\n        } else {\n          writer.removeClass('todo-list', element);\n        }\n      }\n    });\n    listEditing.registerDowncastStrategy({\n      scope: 'itemMarker',\n      attributeName: 'todoListChecked',\n      createElement(writer, modelElement, {\n        dataPipeline\n      }) {\n        if (modelElement.getAttribute('listType') != 'todo') {\n          return null;\n        }\n        const viewElement = writer.createUIElement('input', {\n          type: 'checkbox',\n          ...(modelElement.getAttribute('todoListChecked') ? {\n            checked: 'checked'\n          } : null),\n          ...(dataPipeline ? {\n            disabled: 'disabled'\n          } : {\n            tabindex: '-1'\n          })\n        });\n        if (dataPipeline) {\n          return viewElement;\n        }\n        const wrapper = writer.createContainerElement('span', {\n          contenteditable: 'false'\n        }, viewElement);\n        wrapper.getFillerOffset = () => null;\n        return wrapper;\n      },\n      canWrapElement(modelElement) {\n        return isDescriptionBlock(modelElement, listEditing.getListAttributeNames());\n      },\n      createWrapperElement(writer, modelElement, {\n        dataPipeline\n      }) {\n        const classes = ['todo-list__label'];\n        if (!isDescriptionBlock(modelElement, listEditing.getListAttributeNames())) {\n          classes.push('todo-list__label_without-description');\n        }\n        return writer.createAttributeElement(dataPipeline ? 'label' : 'span', {\n          class: classes.join(' ')\n        });\n      }\n    });\n    // Verifies if a to-do list block requires reconversion of a first item downcasted as an item description.\n    listEditing.on('checkElement', (evt, {\n      modelElement,\n      viewElement\n    }) => {\n      const isFirstTodoModelParagraphBlock = isDescriptionBlock(modelElement, listEditing.getListAttributeNames());\n      const hasViewClass = viewElement.hasClass('todo-list__label__description');\n      if (hasViewClass != isFirstTodoModelParagraphBlock) {\n        evt.return = true;\n        evt.stop();\n      }\n    });\n    // Verifies if a to-do list block requires reconversion of a checkbox element\n    // (for example there is a new paragraph inserted as a first block of a list item).\n    listEditing.on('checkElement', (evt, {\n      modelElement,\n      viewElement\n    }) => {\n      const isFirstTodoModelItemBlock = modelElement.getAttribute('listType') == 'todo' && isFirstBlockOfListItem(modelElement);\n      let hasViewItemMarker = false;\n      const viewWalker = editor.editing.view.createPositionBefore(viewElement).getWalker({\n        direction: 'backward'\n      });\n      for (const {\n        item\n      } of viewWalker) {\n        if (item.is('element') && editor.editing.mapper.toModelElement(item)) {\n          break;\n        }\n        if (item.is('element', 'input') && item.getAttribute('type') == 'checkbox') {\n          hasViewItemMarker = true;\n        }\n      }\n      if (hasViewItemMarker != isFirstTodoModelItemBlock) {\n        evt.return = true;\n        evt.stop();\n      }\n    });\n    // Make sure that all blocks of the same list item have the same todoListChecked attribute.\n    listEditing.on('postFixer', (evt, {\n      listNodes,\n      writer\n    }) => {\n      for (const {\n        node,\n        previousNodeInList\n      } of listNodes) {\n        // This is a first item of a nested list.\n        if (!previousNodeInList) {\n          continue;\n        }\n        if (previousNodeInList.getAttribute('listItemId') != node.getAttribute('listItemId')) {\n          continue;\n        }\n        const previousHasAttribute = previousNodeInList.hasAttribute('todoListChecked');\n        const nodeHasAttribute = node.hasAttribute('todoListChecked');\n        if (nodeHasAttribute && !previousHasAttribute) {\n          writer.removeAttribute('todoListChecked', node);\n          evt.return = true;\n        } else if (!nodeHasAttribute && previousHasAttribute) {\n          writer.setAttribute('todoListChecked', true, node);\n          evt.return = true;\n        }\n      }\n    });\n    // Make sure that todoListChecked attribute is only present for to-do list items.\n    model.document.registerPostFixer(writer => {\n      const changes = model.document.differ.getChanges();\n      let wasFixed = false;\n      for (const change of changes) {\n        if (change.type == 'attribute' && change.attributeKey == 'listType') {\n          const element = change.range.start.nodeAfter;\n          if (change.attributeOldValue == 'todo' && element.hasAttribute('todoListChecked')) {\n            writer.removeAttribute('todoListChecked', element);\n            wasFixed = true;\n          }\n        } else if (change.type == 'insert' && change.name != '$text') {\n          for (const {\n            item\n          } of writer.createRangeOn(change.position.nodeAfter)) {\n            if (item.is('element') && item.getAttribute('listType') != 'todo' && item.hasAttribute('todoListChecked')) {\n              writer.removeAttribute('todoListChecked', item);\n              wasFixed = true;\n            }\n          }\n        }\n      }\n      return wasFixed;\n    });\n    // Toggle check state of selected to-do list items on keystroke.\n    this.listenTo(editing.view.document, 'keydown', (evt, data) => {\n      if (getCode(data) === ITEM_TOGGLE_KEYSTROKE$1) {\n        editor.execute('checkTodoList');\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    // Toggle check state of a to-do list item clicked on the checkbox.\n    this.listenTo(editing.view.document, 'todoCheckboxChange', (evt, data) => {\n      const viewTarget = data.target;\n      if (!viewTarget || !viewTarget.is('element', 'input')) {\n        return;\n      }\n      const viewPositionAfter = editing.view.createPositionAfter(viewTarget);\n      const modelPositionAfter = editing.mapper.toModelPosition(viewPositionAfter);\n      const modelElement = modelPositionAfter.parent;\n      if (modelElement && isListItemBlock(modelElement) && modelElement.getAttribute('listType') == 'todo') {\n        this._handleCheckmarkChange(modelElement);\n      }\n    });\n    // Jump at the start/end of the next node on right arrow key press, when selection is before the checkbox.\n    //\n    // <blockquote><p>Foo{}</p></blockquote>\n    // <ul><li><checkbox/>Bar</li></ul>\n    //\n    // press: `->`\n    //\n    // <blockquote><p>Foo</p></blockquote>\n    // <ul><li><checkbox/>{}Bar</li></ul>\n    //\n    this.listenTo(editing.view.document, 'arrowKey', jumpOverCheckmarkOnSideArrowKeyPress$1(model, editor.locale), {\n      context: '$text'\n    });\n    // Map view positions inside the checkbox and wrappers to the position in the first block of the list item.\n    this.listenTo(editing.mapper, 'viewToModelPosition', (evt, data) => {\n      const viewParent = data.viewPosition.parent;\n      const isStartOfListItem = viewParent.is('attributeElement', 'li') && data.viewPosition.offset == 0;\n      const isStartOfListLabel = isLabelElement(viewParent) && data.viewPosition.offset <= 1;\n      const isInInputWrapper = viewParent.is('element', 'span') && viewParent.getAttribute('contenteditable') == 'false' && isLabelElement(viewParent.parent);\n      if (!isStartOfListItem && !isStartOfListLabel && !isInInputWrapper) {\n        return;\n      }\n      const nodeAfter = data.modelPosition.nodeAfter;\n      if (nodeAfter && nodeAfter.getAttribute('listType') == 'todo') {\n        data.modelPosition = model.createPositionAt(nodeAfter, 0);\n      }\n    }, {\n      priority: 'low'\n    });\n    this._initAriaAnnouncements();\n  }\n  /**\n  * Handles the checkbox element change, moves the selection to the corresponding model item to make it possible\n  * to toggle the `todoListChecked` attribute using the command, and restores the selection position.\n  *\n  * Some say it's a hack :) Moving the selection only for executing the command on a certain node and restoring it after,\n  * is not a clear solution. We need to design an API for using commands beyond the selection range.\n  * See https://github.com/ckeditor/ckeditor5/issues/1954.\n  */\n  _handleCheckmarkChange(listItem) {\n    const editor = this.editor;\n    const model = editor.model;\n    const previousSelectionRanges = Array.from(model.document.selection.getRanges());\n    model.change(writer => {\n      writer.setSelection(listItem, 'end');\n      editor.execute('checkTodoList');\n      writer.setSelection(previousSelectionRanges);\n    });\n  }\n  /**\n  * Observe when user enters or leaves todo list and set proper aria value in global live announcer.\n  * This allows screen readers to indicate when the user has entered and left the specified todo list.\n  *\n  * @internal\n  */\n  _initAriaAnnouncements() {\n    const {\n      model,\n      ui,\n      t\n    } = this.editor;\n    let lastFocusedCodeBlock = null;\n    if (!ui) {\n      return;\n    }\n    model.document.selection.on('change:range', () => {\n      const focusParent = model.document.selection.focus.parent;\n      const lastElementIsTodoList = isTodoListItemElement(lastFocusedCodeBlock);\n      const currentElementIsTodoList = isTodoListItemElement(focusParent);\n      if (lastElementIsTodoList && !currentElementIsTodoList) {\n        ui.ariaLiveAnnouncer.announce(t('Leaving a to-do list'));\n      } else if (!lastElementIsTodoList && currentElementIsTodoList) {\n        ui.ariaLiveAnnouncer.announce(t('Entering a to-do list'));\n      }\n      lastFocusedCodeBlock = focusParent;\n    });\n  }\n}\n/**\n * Returns an upcast converter for to-do list items.\n */\nfunction todoListItemUpcastConverter() {\n  return (evt, data, conversionApi) => {\n    const {\n      writer,\n      schema\n    } = conversionApi;\n    if (!data.modelRange) {\n      return;\n    }\n    // Group to-do list items by their listItemId attribute to ensure that all items of the same list item have the same checked state.\n    const groupedItems = Array.from(data.modelRange.getItems({\n      shallow: true\n    })).filter(item => item.getAttribute('listType') === 'todo' && schema.checkAttribute(item, 'listItemId')).reduce((acc, item) => {\n      const listItemId = item.getAttribute('listItemId');\n      if (!acc.has(listItemId)) {\n        acc.set(listItemId, getAllListItemBlocks(item));\n      }\n      return acc;\n    }, new Map());\n    // During the upcast, we need to ensure that all items of the same list have the same checked state. From time to time\n    // the checked state of the items can be different when the user pastes content from the clipboard with <input type=\"checkbox\">\n    // that has checked state set to true. In such cases, we need to ensure that all items of the same list have the same checked state.\n    // See more: https://github.com/ckeditor/ckeditor5/issues/15602\n    for (const [, items] of groupedItems.entries()) {\n      if (items.some(item => item.getAttribute('todoListChecked'))) {\n        for (const item of items) {\n          writer.setAttribute('todoListChecked', true, item);\n        }\n      }\n    }\n  };\n}\n/**\n * Returns an upcast converter that detects a to-do list checkbox and marks the list item as a to-do list.\n */\nfunction todoItemInputConverter() {\n  return (evt, data, conversionApi) => {\n    const modelCursor = data.modelCursor;\n    const modelItem = modelCursor.parent;\n    const viewItem = data.viewItem;\n    if (!conversionApi.consumable.test(viewItem, {\n      name: true\n    })) {\n      return;\n    }\n    if (viewItem.getAttribute('type') != 'checkbox' || !modelCursor.isAtStart || !modelItem.hasAttribute('listType')) {\n      return;\n    }\n    conversionApi.consumable.consume(viewItem, {\n      name: true\n    });\n    const writer = conversionApi.writer;\n    writer.setAttribute('listType', 'todo', modelItem);\n    if (data.viewItem.hasAttribute('checked')) {\n      writer.setAttribute('todoListChecked', true, modelItem);\n    }\n    data.modelRange = writer.createRange(modelCursor);\n  };\n}\n/**\n * Returns an upcast converter that consumes element matching the given matcher pattern.\n */\nfunction elementUpcastConsumingConverter(matcherPattern) {\n  const matcher = new Matcher(matcherPattern);\n  return (evt, data, conversionApi) => {\n    const matcherResult = matcher.match(data.viewItem);\n    if (!matcherResult) {\n      return;\n    }\n    if (!conversionApi.consumable.consume(data.viewItem, matcherResult.match)) {\n      return;\n    }\n    Object.assign(data, conversionApi.convertChildren(data.viewItem, data.modelCursor));\n  };\n}\n/**\n * Returns an upcast converter that consumes attributes matching the given matcher pattern.\n */\nfunction attributeUpcastConsumingConverter(matcherPattern) {\n  const matcher = new Matcher(matcherPattern);\n  return (evt, data, conversionApi) => {\n    const matcherResult = matcher.match(data.viewItem);\n    if (!matcherResult) {\n      return;\n    }\n    const match = matcherResult.match;\n    match.name = false;\n    conversionApi.consumable.consume(data.viewItem, match);\n  };\n}\n/**\n * Returns true if the given list item block should be converted as a description block of a to-do list item.\n */\nfunction isDescriptionBlock(modelElement, listAttributeNames) {\n  return (modelElement.is('element', 'paragraph') || modelElement.is('element', 'listItem')) && modelElement.getAttribute('listType') == 'todo' && isFirstBlockOfListItem(modelElement) && hasOnlyListAttributes(modelElement, listAttributeNames);\n}\n/**\n * Returns true if only attributes from the given list are present on the model element.\n */\nfunction hasOnlyListAttributes(modelElement, attributeNames) {\n  for (const attributeKey of modelElement.getAttributeKeys()) {\n    // Ignore selection attributes stored on block elements.\n    if (attributeKey.startsWith('selection:')) {\n      continue;\n    }\n    if (!attributeNames.includes(attributeKey)) {\n      return false;\n    }\n  }\n  return true;\n}\n/**\n * Jump at the start and end of a to-do list item.\n */\nfunction jumpOverCheckmarkOnSideArrowKeyPress$1(model, locale) {\n  return (eventInfo, domEventData) => {\n    const direction = getLocalizedArrowKeyCodeDirection(domEventData.keyCode, locale.contentLanguageDirection);\n    const schema = model.schema;\n    const selection = model.document.selection;\n    if (!selection.isCollapsed) {\n      return;\n    }\n    const position = selection.getFirstPosition();\n    const parent = position.parent;\n    // Right arrow before a to-do list item.\n    if (direction == 'right' && position.isAtEnd) {\n      const newRange = schema.getNearestSelectionRange(model.createPositionAfter(parent), 'forward');\n      if (!newRange) {\n        return;\n      }\n      const newRangeParent = newRange.start.parent;\n      if (newRangeParent && isListItemBlock(newRangeParent) && newRangeParent.getAttribute('listType') == 'todo') {\n        model.change(writer => writer.setSelection(newRange));\n        domEventData.preventDefault();\n        domEventData.stopPropagation();\n        eventInfo.stop();\n      }\n    } else if (direction == 'left' && position.isAtStart && isListItemBlock(parent) && parent.getAttribute('listType') == 'todo') {\n      const newRange = schema.getNearestSelectionRange(model.createPositionBefore(parent), 'backward');\n      if (!newRange) {\n        return;\n      }\n      model.change(writer => writer.setSelection(newRange));\n      domEventData.preventDefault();\n      domEventData.stopPropagation();\n      eventInfo.stop();\n    }\n  };\n}\n/**\n * Returns true if the given element is a label element of a to-do list item.\n */\nfunction isLabelElement(viewElement) {\n  return !!viewElement && viewElement.is('attributeElement') && viewElement.hasClass('todo-list__label');\n}\n/**\n * Returns true if the given element is a list item model element of a to-do list.\n */\nfunction isTodoListItemElement(element) {\n  if (!element) {\n    return false;\n  }\n  if (!element.is('element', 'paragraph') && !element.is('element', 'listItem')) {\n    return false;\n  }\n  return element.getAttribute('listType') == 'todo';\n}\n\n/**\n * The to-do list UI feature. It introduces the `'todoList'` button that\n * allows to convert elements to and from to-do list items and to indent or outdent them.\n */\nclass TodoListUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TodoListUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const t = this.editor.t;\n    createUIComponents(this.editor, 'todoList', t('To-do List'), IconTodoList);\n  }\n}\n\n/**\n * The to-do list feature.\n *\n * This is a \"glue\" plugin that loads the {@link module:list/todolist/todolistediting~TodoListEditing to-do list\n * editing feature} and the {@link module:list/todolist/todolistui~TodoListUI to-do list UI feature}.\n */\nclass TodoList extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TodoListEditing, TodoListUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TodoList';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The list command. It is used by the {@link module:list/legacylist~LegacyList legacy list feature}.\n */\nclass LegacyListCommand extends Command {\n  /**\n  * The type of the list created by the command.\n  */\n  type;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor The editor instance.\n  * @param type List type that will be handled by this command.\n  */\n  constructor(editor, type) {\n    super(editor);\n    this.type = type;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.value = this._getValue();\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Executes the list command.\n  *\n  * @fires execute\n  * @param options Command options.\n  * @param options.forceValue If set, it will force the command behavior. If `true`, the command will try to convert the\n  * selected items and potentially the neighbor elements to the proper list items. If set to `false`, it will convert selected elements\n  * to paragraphs. If not set, the command will toggle selected elements to list items or paragraphs, depending on the selection.\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const document = model.document;\n    const blocks = Array.from(document.selection.getSelectedBlocks()).filter(block => checkCanBecomeListItem(block, model.schema));\n    // Whether we are turning off some items.\n    const turnOff = options.forceValue !== undefined ? !options.forceValue : this.value;\n    // If we are turning off items, we are going to rename them to paragraphs.\n    model.change(writer => {\n      // If part of a list got turned off, we need to handle (outdent) all of sub-items of the last turned-off item.\n      // To be sure that model is all the time in a good state, we first fix items below turned-off item.\n      if (turnOff) {\n        // Start from the model item that is just after the last turned-off item.\n        let next = blocks[blocks.length - 1].nextSibling;\n        let currentIndent = Number.POSITIVE_INFINITY;\n        let changes = [];\n        // Correct indent of all items after the last turned off item.\n        // Rules that should be followed:\n        // 1. All direct sub-items of turned-off item should become indent 0, because the first item after it\n        //    will be the first item of a new list. Other items are at the same level, so should have same 0 index.\n        // 2. All items with indent lower than indent of turned-off item should become indent 0, because they\n        //    should not end up as a child of any of list items that they were not children of before.\n        // 3. All other items should have their indent changed relatively to it's parent.\n        //\n        // For example:\n        // 1  * --------\n        // 2     * --------\n        // 3        * --------\t\t\t<-- this is turned off.\n        // 4           * --------\t\t<-- this has to become indent = 0, because it will be first item on a new list.\n        // 5              * --------\t<-- this should be still be a child of item above, so indent = 1.\n        // 6        * --------\t\t\t<-- this has to become indent = 0, because it should not be a child of any of items above.\n        // 7           * --------\t\t<-- this should be still be a child of item above, so indent = 1.\n        // 8     * --------\t\t\t\t<-- this has to become indent = 0.\n        // 9        * --------\t\t\t<-- this should still be a child of item above, so indent = 1.\n        // 10          * --------\t\t<-- this should still be a child of item above, so indent = 2.\n        // 11          * --------\t\t<-- this should still be at the same level as item above, so indent = 2.\n        // 12 * --------\t\t\t\t<-- this and all below are left unchanged.\n        // 13    * --------\n        // 14       * --------\n        //\n        // After turning off 3 the list becomes:\n        //\n        // 1  * --------\n        // 2     * --------\n        //\n        // 3  --------\n        //\n        // 4  * --------\n        // 5     * --------\n        // 6  * --------\n        // 7     * --------\n        // 8  * --------\n        // 9     * --------\n        // 10       * --------\n        // 11       * --------\n        // 12 * --------\n        // 13    * --------\n        // 14       * --------\n        //\n        // Thanks to this algorithm no lists are mismatched and no items get unexpected children/parent, while\n        // those parent-child connection which are possible to maintain are still maintained. It's worth noting\n        // that this is the same effect that we would be get by multiple use of outdent command. However doing\n        // it like this is much more efficient because it's less operation (less memory usage, easier OT) and\n        // less conversion (faster).\n        while (next && next.name == 'listItem' && next.getAttribute('listIndent') !== 0) {\n          // Check each next list item, as long as its indent is bigger than 0.\n          // If the indent is 0 we are not going to change anything anyway.\n          const indent = next.getAttribute('listIndent');\n          // We check if that's item indent is lower as current relative indent.\n          if (indent < currentIndent) {\n            // If it is, current relative indent becomes that indent.\n            currentIndent = indent;\n          }\n          // Fix indent relatively to current relative indent.\n          // Note, that if we just changed the current relative indent, the newIndent will be equal to 0.\n          const newIndent = indent - currentIndent;\n          // Save the entry in changes array. We do not apply it at the moment, because we will need to\n          // reverse the changes so the last item is changed first.\n          // This is to keep model in correct state all the time.\n          changes.push({\n            element: next,\n            listIndent: newIndent\n          });\n          // Find next item.\n          next = next.nextSibling;\n        }\n        changes = changes.reverse();\n        for (const item of changes) {\n          writer.setAttribute('listIndent', item.listIndent, item.element);\n        }\n      }\n      // If we are turning on, we might change some items that are already `listItem`s but with different type.\n      // Changing one nested list item to other type should also trigger changing all its siblings so the\n      // whole nested list is of the same type.\n      // Example (assume changing to numbered list):\n      // * ------\t\t\t\t<-- do not fix, top level item\n      //   * ------\t\t\t<-- fix, because latter list item of this item's list is changed\n      //      * ------\t\t<-- do not fix, item is not affected (different list)\n      //   * ------\t\t\t<-- fix, because latter list item of this item's list is changed\n      //      * ------\t\t<-- fix, because latter list item of this item's list is changed\n      //      * ---[--\t\t<-- already in selection\n      //   * ------\t\t\t<-- already in selection\n      //   * ------\t\t\t<-- already in selection\n      // * ------\t\t\t\t<-- already in selection, but does not cause other list items to change because is top-level\n      //   * ---]--\t\t\t<-- already in selection\n      //   * ------\t\t\t<-- fix, because preceding list item of this item's list is changed\n      //      * ------\t\t<-- do not fix, item is not affected (different list)\n      // * ------\t\t\t\t<-- do not fix, top level item\n      if (!turnOff) {\n        // Find lowest indent among selected items. This will be indicator what is the indent of\n        // top-most list affected by the command.\n        let lowestIndent = Number.POSITIVE_INFINITY;\n        for (const item of blocks) {\n          if (item.is('element', 'listItem') && item.getAttribute('listIndent') < lowestIndent) {\n            lowestIndent = item.getAttribute('listIndent');\n          }\n        }\n        // Do not execute the fix for top-level lists.\n        lowestIndent = lowestIndent === 0 ? 1 : lowestIndent;\n        // Fix types of list items that are \"before\" the selected blocks.\n        _fixType(blocks, true, lowestIndent);\n        // Fix types of list items that are \"after\" the selected blocks.\n        _fixType(blocks, false, lowestIndent);\n      }\n      // Phew! Now it will be easier :).\n      // For each block element that was in the selection, we will either: turn it to list item,\n      // turn it to paragraph, or change it's type. Or leave it as it is.\n      // Do it in reverse as there might be multiple blocks (same as with changing indents).\n      for (const element of blocks.reverse()) {\n        if (turnOff && element.name == 'listItem') {\n          // We are turning off and the element is a `listItem` - it should be converted to `paragraph`.\n          // List item specific attributes are removed by post fixer.\n          writer.rename(element, 'paragraph');\n        } else if (!turnOff && element.name != 'listItem') {\n          // We are turning on and the element is not a `listItem` - it should be converted to `listItem`.\n          // The order of operations is important to keep model in correct state.\n          writer.setAttributes({\n            listType: this.type,\n            listIndent: 0\n          }, element);\n          writer.rename(element, 'listItem');\n        } else if (!turnOff && element.name == 'listItem' && element.getAttribute('listType') != this.type) {\n          // We are turning on and the element is a `listItem` but has different type - change it's type and\n          // type of it's all siblings that have same indent.\n          writer.setAttribute('listType', this.type, element);\n        }\n      }\n      /**\n      * Event fired by the {@link #execute} method.\n      *\n      * It allows to execute an action after executing the {@link ~ListCommand#execute} method, for example adjusting\n      * attributes of changed blocks.\n      *\n      * @protected\n      * @event _executeCleanup\n      */\n      this.fire('_executeCleanup', blocks);\n    });\n  }\n  /**\n  * Checks the command's {@link #value}.\n  *\n  * @returns The current value.\n  */\n  _getValue() {\n    // Check whether closest `listItem` ancestor of the position has a correct type.\n    const listItem = first(this.editor.model.document.selection.getSelectedBlocks());\n    return !!listItem && listItem.is('element', 'listItem') && listItem.getAttribute('listType') == this.type;\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    // If command value is true it means that we are in list item, so the command should be enabled.\n    if (this.value) {\n      return true;\n    }\n    const selection = this.editor.model.document.selection;\n    const schema = this.editor.model.schema;\n    const firstBlock = first(selection.getSelectedBlocks());\n    if (!firstBlock) {\n      return false;\n    }\n    // Otherwise, check if list item can be inserted at the position start.\n    return checkCanBecomeListItem(firstBlock, schema);\n  }\n}\n/**\n * Helper function used when one or more list item have their type changed. Fixes type of other list items\n * that are affected by the change (are in same lists) but are not directly in selection. The function got extracted\n * not to duplicated code, as same fix has to be performed before and after selection.\n *\n * @param blocks Blocks that are in selection.\n * @param isBackward Specified whether fix will be applied for blocks before first selected block (`true`)\n * or blocks after last selected block (`false`).\n * @param lowestIndent Lowest indent among selected blocks.\n */\nfunction _fixType(blocks, isBackward, lowestIndent) {\n  // We need to check previous sibling of first changed item and next siblings of last changed item.\n  const startingItem = isBackward ? blocks[0] : blocks[blocks.length - 1];\n  if (startingItem.is('element', 'listItem')) {\n    let item = startingItem[isBackward ? 'previousSibling' : 'nextSibling'];\n    // During processing items, keeps the lowest indent of already processed items.\n    // This saves us from changing too many items.\n    // Following example is for going forward as it is easier to read, however same applies to going backward.\n    // * ------\n    //   * ------\n    //     * --[---\n    //   * ------\t\t<-- `lowestIndent` should be 1\n    //     * --]---\t\t<-- `startingItem`, `currentIndent` = 2, `lowestIndent` == 1\n    //     * ------\t\t<-- should be fixed, `indent` == 2 == `currentIndent`\n    //   * ------\t\t<-- should be fixed, set `currentIndent` to 1, `indent` == 1 == `currentIndent`\n    //     * ------\t\t<-- should not be fixed, item is in different list, `indent` = 2, `indent` != `currentIndent`\n    //   * ------\t\t<-- should be fixed, `indent` == 1 == `currentIndent`\n    // * ------\t\t\t<-- break loop (`indent` < `lowestIndent`)\n    let currentIndent = startingItem.getAttribute('listIndent');\n    // Look back until a list item with indent lower than reference `lowestIndent`.\n    // That would be the parent of nested sublist which contains item having `lowestIndent`.\n    while (item && item.is('element', 'listItem') && item.getAttribute('listIndent') >= lowestIndent) {\n      if (currentIndent > item.getAttribute('listIndent')) {\n        currentIndent = item.getAttribute('listIndent');\n      }\n      // Found an item that is in the same nested sublist.\n      if (item.getAttribute('listIndent') == currentIndent) {\n        // Just add the item to selected blocks like it was selected by the user.\n        blocks[isBackward ? 'unshift' : 'push'](item);\n      }\n      item = item[isBackward ? 'previousSibling' : 'nextSibling'];\n    }\n  }\n}\n/**\n * Checks whether the given block can be replaced by a listItem.\n *\n * @param block A block to be tested.\n * @param schema The schema of the document.\n */\nfunction checkCanBecomeListItem(block, schema) {\n  return schema.checkChild(block.parent, 'listItem') && !schema.isObject(block);\n}\n\n/**\n * The list indent command. It is used by the {@link module:list/legacylist~LegacyList legacy list feature}.\n */\nclass LegacyIndentCommand extends Command {\n  /**\n  * Determines by how much the command will change the list item's indent attribute.\n  */\n  _indentBy;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor The editor instance.\n  * @param indentDirection The direction of indent. If it is equal to `backward`, the command will outdent a list item.\n  */\n  constructor(editor, indentDirection) {\n    super(editor);\n    this._indentBy = indentDirection == 'forward' ? 1 : -1;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Indents or outdents (depending on the {@link #constructor}'s `indentDirection` parameter) selected list items.\n  *\n  * @fires execute\n  */\n  execute() {\n    const model = this.editor.model;\n    const doc = model.document;\n    let itemsToChange = Array.from(doc.selection.getSelectedBlocks());\n    model.change(writer => {\n      const lastItem = itemsToChange[itemsToChange.length - 1];\n      // Indenting a list item should also indent all the items that are already sub-items of indented item.\n      let next = lastItem.nextSibling;\n      // Check all items after last indented item, as long as their indent is bigger than indent of that item.\n      while (next && next.name == 'listItem' && next.getAttribute('listIndent') > lastItem.getAttribute('listIndent')) {\n        itemsToChange.push(next);\n        next = next.nextSibling;\n      }\n      // We need to be sure to keep model in correct state after each small change, because converters\n      // bases on that state and assumes that model is correct.\n      // Because of that, if the command outdents items, we will outdent them starting from the last item, as\n      // it is safer.\n      if (this._indentBy < 0) {\n        itemsToChange = itemsToChange.reverse();\n      }\n      for (const item of itemsToChange) {\n        const indent = item.getAttribute('listIndent') + this._indentBy;\n        // If indent is lower than 0, it means that the item got outdented when it was not indented.\n        // This means that we need to convert that list item to paragraph.\n        if (indent < 0) {\n          // To keep the model as correct as possible, first rename listItem, then remove attributes,\n          // as listItem without attributes is very incorrect and will cause problems in converters.\n          // No need to remove attributes, will be removed by post fixer.\n          writer.rename(item, 'paragraph');\n        } else {\n          writer.setAttribute('listIndent', indent, item);\n        }\n      }\n      // It allows to execute an action after executing the `~IndentCommand#execute` method, for example adjusting\n      // attributes of changed list items.\n      this.fire('_executeCleanup', itemsToChange);\n    });\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    // Check whether any of position's ancestor is a list item.\n    const listItem = first(this.editor.model.document.selection.getSelectedBlocks());\n    // If selection is not in a list item, the command is disabled.\n    if (!listItem || !listItem.is('element', 'listItem')) {\n      return false;\n    }\n    if (this._indentBy > 0) {\n      // Cannot indent first item in it's list. Check if before `listItem` is a list item that is in same list.\n      // To be in the same list, the item has to have same attributes and cannot be \"split\" by an item with lower indent.\n      const indent = listItem.getAttribute('listIndent');\n      const type = listItem.getAttribute('listType');\n      let prev = listItem.previousSibling;\n      while (prev && prev.is('element', 'listItem') && prev.getAttribute('listIndent') >= indent) {\n        if (prev.getAttribute('listIndent') == indent) {\n          // The item is on the same level.\n          // If it has same type, it means that we found a preceding sibling from the same list.\n          // If it does not have same type, it means that `listItem` is on different list (this can happen only\n          // on top level lists, though).\n          return prev.getAttribute('listType') == type;\n        }\n        prev = prev.previousSibling;\n      }\n      // Could not find similar list item, this means that `listItem` is first in its list.\n      return false;\n    }\n    // If we are outdenting it is enough to be in list item. Every list item can always be outdented.\n    return true;\n  }\n}\n\n/**\n * Creates a list item {@link module:engine/view/containerelement~ContainerElement}.\n *\n * @param writer The writer instance.\n */\nfunction createViewListItemElement(writer) {\n  const viewItem = writer.createContainerElement('li');\n  viewItem.getFillerOffset = getListItemFillerOffset;\n  return viewItem;\n}\n/**\n * Helper function that creates a `<ul><li></li></ul>` or (`<ol>`) structure out of the given `modelItem` model `listItem` element.\n * Then, it binds the created view list item (`<li>`) with the model `listItem` element.\n * The function then returns the created view list item (`<li>`).\n *\n * @param modelItem Model list item.\n * @param conversionApi Conversion interface.\n * @returns View list element.\n */\nfunction generateLiInUl(modelItem, conversionApi) {\n  const mapper = conversionApi.mapper;\n  const viewWriter = conversionApi.writer;\n  const listType = modelItem.getAttribute('listType') == 'numbered' ? 'ol' : 'ul';\n  const viewItem = createViewListItemElement(viewWriter);\n  const viewList = viewWriter.createContainerElement(listType, null);\n  viewWriter.insert(viewWriter.createPositionAt(viewList, 0), viewItem);\n  mapper.bindElements(modelItem, viewItem);\n  return viewItem;\n}\n/**\n * Helper function that inserts a view list at a correct place and merges it with its siblings.\n * It takes a model list item element (`modelItem`) and a corresponding view list item element (`injectedItem`). The view list item\n * should be in a view list element (`<ul>` or `<ol>`) and should be its only child.\n * See comments below to better understand the algorithm.\n *\n * @param modelItem Model list item.\n * @param injectedItem\n * @param conversionApi Conversion interface.\n * @param model The model instance.\n */\nfunction injectViewList(modelItem, injectedItem, conversionApi, model) {\n  const injectedList = injectedItem.parent;\n  const mapper = conversionApi.mapper;\n  const viewWriter = conversionApi.writer;\n  // The position where the view list will be inserted.\n  let insertPosition = mapper.toViewPosition(model.createPositionBefore(modelItem));\n  // 1. Find the previous list item that has the same or smaller indent. Basically we are looking for the first model item\n  // that is a \"parent\" or \"sibling\" of the injected model item.\n  // If there is no such list item, it means that the injected list item is the first item in \"its list\".\n  const refItem = getSiblingListItem(modelItem.previousSibling, {\n    sameIndent: true,\n    smallerIndent: true,\n    listIndent: modelItem.getAttribute('listIndent')\n  });\n  const prevItem = modelItem.previousSibling;\n  if (refItem && refItem.getAttribute('listIndent') == modelItem.getAttribute('listIndent')) {\n    // There is a list item with the same indent - we found the same-level sibling.\n    // Break the list after it. The inserted view item will be added in the broken space.\n    const viewItem = mapper.toViewElement(refItem);\n    insertPosition = viewWriter.breakContainer(viewWriter.createPositionAfter(viewItem));\n  } else {\n    // There is no list item with the same indent. Check the previous model item.\n    if (prevItem && prevItem.name == 'listItem') {\n      // If it is a list item, it has to have a lower indent.\n      // It means that the inserted item should be added to it as its nested item.\n      insertPosition = mapper.toViewPosition(model.createPositionAt(prevItem, 'end'));\n      // There could be some not mapped elements (eg. span in to-do list) but we need to insert\n      // a nested list directly inside the li element.\n      const mappedViewAncestor = mapper.findMappedViewAncestor(insertPosition);\n      const nestedList = findNestedList(mappedViewAncestor);\n      // If there already is some nested list, then use it's position.\n      if (nestedList) {\n        insertPosition = viewWriter.createPositionBefore(nestedList);\n      } else {\n        // Else just put new list on the end of list item content.\n        insertPosition = viewWriter.createPositionAt(mappedViewAncestor, 'end');\n      }\n    } else {\n      // The previous item is not a list item (or does not exist at all).\n      // Just map the position and insert the view item at the mapped position.\n      insertPosition = mapper.toViewPosition(model.createPositionBefore(modelItem));\n    }\n  }\n  insertPosition = positionAfterUiElements(insertPosition);\n  // Insert the view item.\n  viewWriter.insert(insertPosition, injectedList);\n  // 2. Handle possible children of the injected model item.\n  if (prevItem && prevItem.name == 'listItem') {\n    const prevView = mapper.toViewElement(prevItem);\n    const walkerBoundaries = viewWriter.createRange(viewWriter.createPositionAt(prevView, 0), insertPosition);\n    const walker = walkerBoundaries.getWalker({\n      ignoreElementEnd: true\n    });\n    for (const value of walker) {\n      if (value.item.is('element', 'li')) {\n        const breakPosition = viewWriter.breakContainer(viewWriter.createPositionBefore(value.item));\n        const viewList = value.item.parent;\n        const targetPosition = viewWriter.createPositionAt(injectedItem, 'end');\n        mergeViewLists(viewWriter, targetPosition.nodeBefore, targetPosition.nodeAfter);\n        viewWriter.move(viewWriter.createRangeOn(viewList), targetPosition);\n        // This is bad, but those lists will be removed soon anyway.\n        walker._position = breakPosition;\n      }\n    }\n  } else {\n    const nextViewList = injectedList.nextSibling;\n    if (nextViewList && (nextViewList.is('element', 'ul') || nextViewList.is('element', 'ol'))) {\n      let lastSubChild = null;\n      for (const child of nextViewList.getChildren()) {\n        const modelChild = mapper.toModelElement(child);\n        if (modelChild && modelChild.getAttribute('listIndent') > modelItem.getAttribute('listIndent')) {\n          lastSubChild = child;\n        } else {\n          break;\n        }\n      }\n      if (lastSubChild) {\n        viewWriter.breakContainer(viewWriter.createPositionAfter(lastSubChild));\n        viewWriter.move(viewWriter.createRangeOn(lastSubChild.parent), viewWriter.createPositionAt(injectedItem, 'end'));\n      }\n    }\n  }\n  // Merge the inserted view list with its possible neighbor lists.\n  mergeViewLists(viewWriter, injectedList, injectedList.nextSibling);\n  mergeViewLists(viewWriter, injectedList.previousSibling, injectedList);\n}\nfunction mergeViewLists(viewWriter, firstList, secondList) {\n  // Check if two lists are going to be merged.\n  if (!firstList || !secondList || firstList.name != 'ul' && firstList.name != 'ol') {\n    return null;\n  }\n  // Both parameters are list elements, so compare types now.\n  if (firstList.name != secondList.name || firstList.getAttribute('class') !== secondList.getAttribute('class')) {\n    return null;\n  }\n  return viewWriter.mergeContainers(viewWriter.createPositionAfter(firstList));\n}\n/**\n * Helper function that for a given `view.Position`, returns a `view.Position` that is after all `view.UIElement`s that\n * are after the given position.\n *\n * For example:\n * `<container:p>foo^<ui:span></ui:span><ui:span></ui:span>bar</container:p>`\n * For position ^, the position before \"bar\" will be returned.\n *\n */\nfunction positionAfterUiElements(viewPosition) {\n  return viewPosition.getLastMatchingPosition(value => value.item.is('uiElement'));\n}\n/**\n * Helper function that searches for a previous list item sibling of a given model item that meets the given criteria\n * passed by the options object.\n *\n * @param options Search criteria.\n * @param options.sameIndent Whether the sought sibling should have the same indentation.\n * @param options.smallerIndent Whether the sought sibling should have a smaller indentation.\n * @param options.listIndent The reference indentation.\n * @param options.direction Walking direction.\n */\nfunction getSiblingListItem(modelItem, options) {\n  const sameIndent = !!options.sameIndent;\n  const smallerIndent = !!options.smallerIndent;\n  const indent = options.listIndent;\n  let item = modelItem;\n  while (item && item.name == 'listItem') {\n    const itemIndent = item.getAttribute('listIndent');\n    if (sameIndent && indent == itemIndent || smallerIndent && indent > itemIndent) {\n      return item;\n    }\n    if (options.direction === 'forward') {\n      item = item.nextSibling;\n    } else {\n      item = item.previousSibling;\n    }\n  }\n  return null;\n}\n/**\n * Returns a first list view element that is direct child of the given view element.\n */\nfunction findNestedList(viewElement) {\n  for (const node of viewElement.getChildren()) {\n    if (node.name == 'ul' || node.name == 'ol') {\n      return node;\n    }\n  }\n  return null;\n}\n/**\n * Returns an array with all `listItem` elements that represent the same list.\n *\n * It means that values of `listIndent`, `listType`, `listStyle`, `listReversed` and `listStart` for all items are equal.\n *\n * Additionally, if the `position` is inside a list item, that list item will be returned as well.\n *\n * @param position Starting position.\n * @param direction Walking direction.\n */\nfunction getSiblingNodes(position, direction) {\n  const items = [];\n  const listItem = position.parent;\n  const walkerOptions = {\n    ignoreElementEnd: false,\n    startPosition: position,\n    shallow: true,\n    direction\n  };\n  const limitIndent = listItem.getAttribute('listIndent');\n  const nodes = [...new TreeWalker(walkerOptions)].filter(value => value.item.is('element')).map(value => value.item);\n  for (const element of nodes) {\n    // If found something else than `listItem`, we're out of the list scope.\n    if (!element.is('element', 'listItem')) {\n      break;\n    }\n    // If current parsed item has lower indent that element that the element that was a starting point,\n    // it means we left a nested list. Abort searching items.\n    //\n    // â–  List item 1.       [listIndent=0]\n    //     â—‹ List item 2.[] [listIndent=1], limitIndent = 1,\n    //     â—‹ List item 3.   [listIndent=1]\n    // â–  List item 4.       [listIndent=0]\n    //\n    // Abort searching when leave nested list.\n    if (element.getAttribute('listIndent') < limitIndent) {\n      break;\n    }\n    // â–  List item 1.[]     [listIndent=0] limitIndent = 0,\n    //     â—‹ List item 2.   [listIndent=1]\n    //     â—‹ List item 3.   [listIndent=1]\n    // â–  List item 4.       [listIndent=0]\n    //\n    // Ignore nested lists.\n    if (element.getAttribute('listIndent') > limitIndent) {\n      continue;\n    }\n    // â–  List item 1.[]  [listType=bulleted]\n    // 1. List item 2.   [listType=numbered]\n    // 2.List item 3.    [listType=numbered]\n    //\n    // Abort searching when found a different kind of a list.\n    if (element.getAttribute('listType') !== listItem.getAttribute('listType')) {\n      break;\n    }\n    // â–  List item 1.[]  [listType=bulleted]\n    // â–  List item 2.    [listType=bulleted]\n    // â—‹ List item 3.    [listType=bulleted]\n    // â—‹ List item 4.    [listType=bulleted]\n    //\n    // Abort searching when found a different list style,\n    if (element.getAttribute('listStyle') !== listItem.getAttribute('listStyle')) {\n      break;\n    }\n    // ... different direction\n    if (element.getAttribute('listReversed') !== listItem.getAttribute('listReversed')) {\n      break;\n    }\n    // ... and different start index\n    if (element.getAttribute('listStart') !== listItem.getAttribute('listStart')) {\n      break;\n    }\n    if (direction === 'backward') {\n      items.unshift(element);\n    } else {\n      items.push(element);\n    }\n  }\n  return items;\n}\n/**\n * Returns an array with all `listItem` elements in the model selection.\n *\n * It returns all the items even if only a part of the list is selected, including items that belong to nested lists.\n * If no list is selected, it returns an empty array.\n * The order of the elements is not specified.\n *\n * @internal\n */\nfunction getSelectedListItems(model) {\n  const document = model.document;\n  // For all selected blocks find all list items that are being selected\n  // and update the `listStyle` attribute in those lists.\n  let listItems = [...document.selection.getSelectedBlocks()].filter(element => element.is('element', 'listItem')).map(element => {\n    const position = model.change(writer => writer.createPositionAt(element, 0));\n    return [...getSiblingNodes(position, 'backward'), ...getSiblingNodes(position, 'forward')];\n  }).flat();\n  // Since `getSelectedBlocks()` can return items that belong to the same list, and\n  // `getSiblingNodes()` returns the entire list, we need to remove duplicated items.\n  listItems = [...new Set(listItems)];\n  return listItems;\n}\nconst BULLETED_LIST_STYLE_TYPES = ['disc', 'circle', 'square'];\n// There's a lot of them (https://www.w3.org/TR/css-counter-styles-3/#typedef-counter-style).\n// Let's support only those that can be selected by ListPropertiesUI.\nconst NUMBERED_LIST_STYLE_TYPES = ['decimal', 'decimal-leading-zero', 'lower-roman', 'upper-roman', 'lower-latin', 'upper-latin'];\n/**\n * Checks whether the given list-style-type is supported by numbered or bulleted list.\n */\nfunction getListTypeFromListStyleType(listStyleType) {\n  if (BULLETED_LIST_STYLE_TYPES.includes(listStyleType)) {\n    return 'bulleted';\n  }\n  if (NUMBERED_LIST_STYLE_TYPES.includes(listStyleType)) {\n    return 'numbered';\n  }\n  return null;\n}\n/**\n * Implementation of getFillerOffset for view list item element.\n *\n * @returns Block filler offset or `null` if block filler is not needed.\n */\nfunction getListItemFillerOffset() {\n  const hasOnlyLists = !this.isEmpty && (this.getChild(0).name == 'ul' || this.getChild(0).name == 'ol');\n  if (this.isEmpty || hasOnlyLists) {\n    return 0;\n  }\n  return getFillerOffset.call(this);\n}\n\n/**\n * A set of helpers related to legacy lists.\n */\nclass LegacyListUtils extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LegacyListUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * Checks whether the given list-style-type is supported by numbered or bulleted list.\n  */\n  getListTypeFromListStyleType(listStyleType) {\n    return getListTypeFromListStyleType(listStyleType);\n  }\n  /**\n  * Returns an array with all `listItem` elements in the model selection.\n  *\n  * It returns all the items even if only a part of the list is selected, including items that belong to nested lists.\n  * If no list is selected, it returns an empty array.\n  * The order of the elements is not specified.\n  */\n  getSelectedListItems(model) {\n    return getSelectedListItems(model);\n  }\n  /**\n  * Returns an array with all `listItem` elements that represent the same list.\n  *\n  * It means that values of `listIndent`, `listType`, `listStyle`, `listReversed` and `listStart` for all items are equal.\n  *\n  * Additionally, if the `position` is inside a list item, that list item will be returned as well.\n  *\n  * @param position Starting position.\n  * @param direction Walking direction.\n  */\n  getSiblingNodes(position, direction) {\n    return getSiblingNodes(position, direction);\n  }\n}\n\n/**\n * A model-to-view converter for the `listItem` model element insertion.\n *\n * It creates a `<ul><li></li><ul>` (or `<ol>`) view structure out of a `listItem` model element, inserts it at the correct\n * position, and merges the list with surrounding lists (if available).\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:insert\n * @param model Model instance.\n */\nfunction modelViewInsertion$1(model) {\n  return (evt, data, conversionApi) => {\n    const consumable = conversionApi.consumable;\n    if (!consumable.test(data.item, 'insert') || !consumable.test(data.item, 'attribute:listType') || !consumable.test(data.item, 'attribute:listIndent')) {\n      return;\n    }\n    consumable.consume(data.item, 'insert');\n    consumable.consume(data.item, 'attribute:listType');\n    consumable.consume(data.item, 'attribute:listIndent');\n    const modelItem = data.item;\n    const viewItem = generateLiInUl(modelItem, conversionApi);\n    injectViewList(modelItem, viewItem, conversionApi, model);\n  };\n}\n/**\n * A model-to-view converter for the `listItem` model element removal.\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:remove\n * @param model Model instance.\n * @returns Returns a conversion callback.\n */\nfunction modelViewRemove(model) {\n  return (evt, data, conversionApi) => {\n    const viewPosition = conversionApi.mapper.toViewPosition(data.position);\n    const viewStart = viewPosition.getLastMatchingPosition(value => !value.item.is('element', 'li'));\n    const viewItem = viewStart.nodeAfter;\n    const viewWriter = conversionApi.writer;\n    // 1. Break the container after and before the list item.\n    // This will create a view list with one view list item - the one to remove.\n    viewWriter.breakContainer(viewWriter.createPositionBefore(viewItem));\n    viewWriter.breakContainer(viewWriter.createPositionAfter(viewItem));\n    // 2. Remove the list with the item to remove.\n    const viewList = viewItem.parent;\n    const viewListPrev = viewList.previousSibling;\n    const removeRange = viewWriter.createRangeOn(viewList);\n    const removed = viewWriter.remove(removeRange);\n    // 3. Merge the whole created by breaking and removing the list.\n    if (viewListPrev && viewListPrev.nextSibling) {\n      mergeViewLists(viewWriter, viewListPrev, viewListPrev.nextSibling);\n    }\n    // 4. Bring back nested list that was in the removed <li>.\n    const modelItem = conversionApi.mapper.toModelElement(viewItem);\n    hoistNestedLists(modelItem.getAttribute('listIndent') + 1, data.position, removeRange.start, viewItem, conversionApi, model);\n    // 5. Unbind removed view item and all children.\n    for (const child of viewWriter.createRangeIn(removed).getItems()) {\n      conversionApi.mapper.unbindViewElement(child);\n    }\n    evt.stop();\n  };\n}\n/**\n * A model-to-view converter for the `type` attribute change on the `listItem` model element.\n *\n * This change means that the `<li>` element parent changes from `<ul>` to `<ol>` (or vice versa). This is accomplished\n * by breaking view elements and changing their name. The next {@link module:list/legacylist/legacyconverters~modelViewMergeAfterChangeType}\n * converter will attempt to merge split nodes.\n *\n * Splitting this conversion into 2 steps makes it possible to add an additional conversion in the middle.\n * Check {@link module:list/legacytodolist/legacytodolistconverters~modelViewChangeType} to see an example of it.\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:attribute\n */\nconst modelViewChangeType$1 = (evt, data, conversionApi) => {\n  if (!conversionApi.consumable.test(data.item, evt.name)) {\n    return;\n  }\n  const viewItem = conversionApi.mapper.toViewElement(data.item);\n  const viewWriter = conversionApi.writer;\n  // Break the container after and before the list item.\n  // This will create a view list with one view list item -- the one that changed type.\n  viewWriter.breakContainer(viewWriter.createPositionBefore(viewItem));\n  viewWriter.breakContainer(viewWriter.createPositionAfter(viewItem));\n  // Change name of the view list that holds the changed view item.\n  // We cannot just change name property, because that would not render properly.\n  const viewList = viewItem.parent;\n  const listName = data.attributeNewValue == 'numbered' ? 'ol' : 'ul';\n  viewWriter.rename(listName, viewList);\n};\n/**\n * A model-to-view converter that attempts to merge nodes split by {@link module:list/legacylist/legacyconverters~modelViewChangeType}.\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:attribute\n */\nconst modelViewMergeAfterChangeType = (evt, data, conversionApi) => {\n  conversionApi.consumable.consume(data.item, evt.name);\n  const viewItem = conversionApi.mapper.toViewElement(data.item);\n  const viewList = viewItem.parent;\n  const viewWriter = conversionApi.writer;\n  // Merge the changed view list with other lists, if possible.\n  mergeViewLists(viewWriter, viewList, viewList.nextSibling);\n  mergeViewLists(viewWriter, viewList.previousSibling, viewList);\n};\n/**\n * A model-to-view converter for the `listIndent` attribute change on the `listItem` model element.\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:attribute\n * @param model Model instance.\n * @returns Returns a conversion callback.\n */\nfunction modelViewChangeIndent(model) {\n  return (evt, data, conversionApi) => {\n    if (!conversionApi.consumable.consume(data.item, 'attribute:listIndent')) {\n      return;\n    }\n    const viewItem = conversionApi.mapper.toViewElement(data.item);\n    const viewWriter = conversionApi.writer;\n    // 1. Break the container after and before the list item.\n    // This will create a view list with one view list item -- the one that changed type.\n    viewWriter.breakContainer(viewWriter.createPositionBefore(viewItem));\n    viewWriter.breakContainer(viewWriter.createPositionAfter(viewItem));\n    // 2. Extract view list with changed view list item and merge \"hole\" possibly created by breaking and removing elements.\n    const viewList = viewItem.parent;\n    const viewListPrev = viewList.previousSibling;\n    const removeRange = viewWriter.createRangeOn(viewList);\n    viewWriter.remove(removeRange);\n    if (viewListPrev && viewListPrev.nextSibling) {\n      mergeViewLists(viewWriter, viewListPrev, viewListPrev.nextSibling);\n    }\n    // 3. Bring back nested list that was in the removed <li>.\n    hoistNestedLists(data.attributeOldValue + 1, data.range.start, removeRange.start, viewItem, conversionApi, model);\n    // 4. Inject view list like it is newly inserted.\n    injectViewList(data.item, viewItem, conversionApi, model);\n    // 5. Consume insertion of children inside the item. They are already handled by re-building the item in view.\n    for (const child of data.item.getChildren()) {\n      conversionApi.consumable.consume(child, 'insert');\n    }\n  };\n}\n/**\n * A special model-to-view converter introduced by the {@link module:list/legacylist~LegacyList list feature}. This converter is fired for\n * insert change of every model item, and should be fired before the actual converter. The converter checks whether the inserted\n * model item is a non-`listItem` element. If it is, and it is inserted inside a view list, the converter breaks the\n * list so the model element is inserted to the view parent element corresponding to its model parent element.\n *\n * The converter prevents such situations:\n *\n * ```xml\n * // Model:                        // View:\n * <listItem>foo</listItem>         <ul>\n * <listItem>bar</listItem>             <li>foo</li>\n *                                      <li>bar</li>\n *                                  </ul>\n *\n * // After change:                 // Correct view guaranteed by this converter:\n * <listItem>foo</listItem>         <ul><li>foo</li></ul><p>xxx</p><ul><li>bar</li></ul>\n * <paragraph>xxx</paragraph>       // Instead of this wrong view state:\n * <listItem>bar</listItem>         <ul><li>foo</li><p>xxx</p><li>bar</li></ul>\n * ```\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:insert\n */\nconst modelViewSplitOnInsert = (evt, data, conversionApi) => {\n  if (!conversionApi.consumable.test(data.item, evt.name)) {\n    return;\n  }\n  if (data.item.name != 'listItem') {\n    let viewPosition = conversionApi.mapper.toViewPosition(data.range.start);\n    const viewWriter = conversionApi.writer;\n    const lists = [];\n    // Break multiple ULs/OLs if there are.\n    //\n    // Imagine following list:\n    //\n    // 1 --------\n    //   1.1 --------\n    //     1.1.1 --------\n    //     1.1.2 --------\n    //     1.1.3 --------\n    //       1.1.3.1 --------\n    //   1.2 --------\n    //     1.2.1 --------\n    // 2 --------\n    //\n    // Insert paragraph after item 1.1.1:\n    //\n    // 1 --------\n    //   1.1 --------\n    //     1.1.1 --------\n    //\n    // Lorem ipsum.\n    //\n    //     1.1.2 --------\n    //     1.1.3 --------\n    //       1.1.3.1 --------\n    //   1.2 --------\n    //     1.2.1 --------\n    // 2 --------\n    //\n    // In this case 1.1.2 has to become beginning of a new list.\n    // We need to break list before 1.1.2 (obvious), then we need to break list also before 1.2.\n    // Then we need to move those broken pieces one after another and merge:\n    //\n    // 1 --------\n    //   1.1 --------\n    //     1.1.1 --------\n    //\n    // Lorem ipsum.\n    //\n    // 1.1.2 --------\n    //   1.1.3 --------\n    //     1.1.3.1 --------\n    // 1.2 --------\n    //   1.2.1 --------\n    // 2 --------\n    //\n    while (viewPosition.parent.name == 'ul' || viewPosition.parent.name == 'ol') {\n      viewPosition = viewWriter.breakContainer(viewPosition);\n      if (viewPosition.parent.name != 'li') {\n        break;\n      }\n      // Remove lists that are after inserted element.\n      // They will be brought back later, below the inserted element.\n      const removeStart = viewPosition;\n      const removeEnd = viewWriter.createPositionAt(viewPosition.parent, 'end');\n      // Don't remove if there is nothing to remove.\n      if (!removeStart.isEqual(removeEnd)) {\n        const removed = viewWriter.remove(viewWriter.createRange(removeStart, removeEnd));\n        lists.push(removed);\n      }\n      viewPosition = viewWriter.createPositionAfter(viewPosition.parent);\n    }\n    // Bring back removed lists.\n    if (lists.length > 0) {\n      for (let i = 0; i < lists.length; i++) {\n        const previousList = viewPosition.nodeBefore;\n        const insertedRange = viewWriter.insert(viewPosition, lists[i]);\n        viewPosition = insertedRange.end;\n        // Don't merge first list! We want a split in that place (this is why this converter is introduced).\n        if (i > 0) {\n          const mergePos = mergeViewLists(viewWriter, previousList, previousList.nextSibling);\n          // If `mergePos` is in `previousList` it means that the lists got merged.\n          // In this case, we need to fix insert position.\n          if (mergePos && mergePos.parent == previousList) {\n            viewPosition.offset--;\n          }\n        }\n      }\n      // Merge last inserted list with element after it.\n      mergeViewLists(viewWriter, viewPosition.nodeBefore, viewPosition.nodeAfter);\n    }\n  }\n};\n/**\n * A special model-to-view converter introduced by the {@link module:list/legacylist~LegacyList list feature}. This converter takes care of\n * merging view lists after something is removed or moved from near them.\n *\n * Example:\n *\n * ```xml\n * // Model:                        // View:\n * <listItem>foo</listItem>         <ul><li>foo</li></ul>\n * <paragraph>xxx</paragraph>       <p>xxx</p>\n * <listItem>bar</listItem>         <ul><li>bar</li></ul>\n *\n * // After change:                 // Correct view guaranteed by this converter:\n * <listItem>foo</listItem>         <ul>\n * <listItem>bar</listItem>             <li>foo</li>\n *                                      <li>bar</li>\n *                                  </ul>\n * ```\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:remove\n */\nconst modelViewMergeAfter = (evt, data, conversionApi) => {\n  const viewPosition = conversionApi.mapper.toViewPosition(data.position);\n  const viewItemPrev = viewPosition.nodeBefore;\n  const viewItemNext = viewPosition.nodeAfter;\n  // Merge lists if something (remove, move) was done from inside of list.\n  // Merging will be done only if both items are view lists of the same type.\n  // The check is done inside the helper function.\n  mergeViewLists(conversionApi.writer, viewItemPrev, viewItemNext);\n};\n/**\n * A view-to-model converter that converts the `<li>` view elements into the `listItem` model elements.\n *\n * To set correct values of the `listType` and `listIndent` attributes the converter:\n * * checks `<li>`'s parent,\n * * stores and increases the `conversionApi.store.indent` value when `<li>`'s sub-items are converted.\n *\n * @see module:engine/conversion/upcastdispatcher~UpcastDispatcher#event:element\n */\nconst viewModelConverter = (evt, data, conversionApi) => {\n  if (conversionApi.consumable.consume(data.viewItem, {\n    name: true\n  })) {\n    const writer = conversionApi.writer;\n    // 1. Create `listItem` model element.\n    const listItem = writer.createElement('listItem');\n    // 2. Handle `listItem` model element attributes.\n    const indent = getIndent(data.viewItem);\n    writer.setAttribute('listIndent', indent, listItem);\n    // Set 'bulleted' as default. If this item is pasted into a context,\n    const type = data.viewItem.parent && data.viewItem.parent.name == 'ol' ? 'numbered' : 'bulleted';\n    writer.setAttribute('listType', type, listItem);\n    if (!conversionApi.safeInsert(listItem, data.modelCursor)) {\n      return;\n    }\n    const nextPosition = viewToModelListItemChildrenConverter(listItem, data.viewItem.getChildren(), conversionApi);\n    // Result range starts before the first item and ends after the last.\n    data.modelRange = writer.createRange(data.modelCursor, nextPosition);\n    conversionApi.updateConversionResult(listItem, data);\n  }\n};\n/**\n * A view-to-model converter for the `<ul>` and `<ol>` view elements that cleans the input view of garbage.\n * This is mostly to clean whitespaces from between the `<li>` view elements inside the view list element, however, also\n * incorrect data can be cleared if the view was incorrect.\n *\n * @see module:engine/conversion/upcastdispatcher~UpcastDispatcher#event:element\n */\nconst cleanList = (evt, data, conversionApi) => {\n  if (conversionApi.consumable.test(data.viewItem, {\n    name: true\n  })) {\n    // Caching children because when we start removing them iterating fails.\n    const children = Array.from(data.viewItem.getChildren());\n    for (const child of children) {\n      const isWrongElement = !(child.is('element', 'li') || isList(child));\n      if (isWrongElement) {\n        child._remove();\n      }\n    }\n  }\n};\n/**\n * A view-to-model converter for the `<li>` elements that cleans whitespace formatting from the input view.\n *\n * @see module:engine/conversion/upcastdispatcher~UpcastDispatcher#event:element\n */\nconst cleanListItem = (evt, data, conversionApi) => {\n  if (conversionApi.consumable.test(data.viewItem, {\n    name: true\n  })) {\n    if (data.viewItem.childCount === 0) {\n      return;\n    }\n    const children = [...data.viewItem.getChildren()];\n    let foundList = false;\n    for (const child of children) {\n      if (foundList && !isList(child)) {\n        child._remove();\n      }\n      if (isList(child)) {\n        // If this is a <ul> or <ol>, do not process it, just mark that we already visited list element.\n        foundList = true;\n      }\n    }\n  }\n};\n/**\n * Returns a callback for model position to view position mapping for {@link module:engine/conversion/mapper~Mapper}. The callback fixes\n * positions between the `listItem` elements that would be incorrectly mapped because of how list items are represented in the model\n * and in the view.\n */\nfunction modelToViewPosition(view) {\n  return (evt, data) => {\n    if (data.isPhantom) {\n      return;\n    }\n    const modelItem = data.modelPosition.nodeBefore;\n    if (modelItem && modelItem.is('element', 'listItem')) {\n      const viewItem = data.mapper.toViewElement(modelItem);\n      const topmostViewList = viewItem.getAncestors().find(isList);\n      const walker = view.createPositionAt(viewItem, 0).getWalker();\n      for (const value of walker) {\n        if (value.type == 'elementStart' && value.item.is('element', 'li')) {\n          data.viewPosition = value.previousPosition;\n          break;\n        } else if (value.type == 'elementEnd' && value.item == topmostViewList) {\n          data.viewPosition = value.nextPosition;\n          break;\n        }\n      }\n    }\n  };\n}\n/**\n * The callback for view position to model position mapping for {@link module:engine/conversion/mapper~Mapper}. The callback fixes\n * positions between the `<li>` elements that would be incorrectly mapped because of how list items are represented in the model\n * and in the view.\n *\n * @see module:engine/conversion/mapper~Mapper#event:viewToModelPosition\n * @param model Model instance.\n * @returns Returns a conversion callback.\n */\nfunction viewToModelPosition(model) {\n  return (evt, data) => {\n    const viewPos = data.viewPosition;\n    const viewParent = viewPos.parent;\n    const mapper = data.mapper;\n    if (viewParent.name == 'ul' || viewParent.name == 'ol') {\n      // Position is directly in <ul> or <ol>.\n      if (!viewPos.isAtEnd) {\n        // If position is not at the end, it must be before <li>.\n        // Get that <li>, map it to `listItem` and set model position before that `listItem`.\n        const modelNode = mapper.toModelElement(viewPos.nodeAfter);\n        data.modelPosition = model.createPositionBefore(modelNode);\n      } else {\n        // Position is at the end of <ul> or <ol>, so there is no <li> after it to be mapped.\n        // There is <li> before the position, but we cannot just map it to `listItem` and set model position after it,\n        // because that <li> may contain nested items.\n        // We will check \"model length\" of that <li>, in other words - how many `listItem`s are in that <li>.\n        const modelNode = mapper.toModelElement(viewPos.nodeBefore);\n        const modelLength = mapper.getModelLength(viewPos.nodeBefore);\n        // Then we get model position before mapped `listItem` and shift it accordingly.\n        data.modelPosition = model.createPositionBefore(modelNode).getShiftedBy(modelLength);\n      }\n      evt.stop();\n    } else if (viewParent.name == 'li' && viewPos.nodeBefore && (viewPos.nodeBefore.name == 'ul' || viewPos.nodeBefore.name == 'ol')) {\n      // In most cases when view position is in <li> it is in text and this is a correct position.\n      // However, if position is after <ul> or <ol> we have to fix it -- because in model <ul>/<ol> are not in the `listItem`.\n      const modelNode = mapper.toModelElement(viewParent);\n      // Check all <ul>s and <ol>s that are in the <li> but before mapped position.\n      // Get model length of those elements and then add it to the offset of `listItem` mapped to the original <li>.\n      let modelLength = 1; // Starts from 1 because the original <li> has to be counted in too.\n      let viewList = viewPos.nodeBefore;\n      while (viewList && isList(viewList)) {\n        modelLength += mapper.getModelLength(viewList);\n        viewList = viewList.previousSibling;\n      }\n      data.modelPosition = model.createPositionBefore(modelNode).getShiftedBy(modelLength);\n      evt.stop();\n    }\n  };\n}\n/**\n * Post-fixer that reacts to changes on document and fixes incorrect model states.\n *\n * In the example below, there is a correct list structure.\n * Then the middle element is removed so the list structure will become incorrect:\n *\n * ```xml\n * <listItem listType=\"bulleted\" listIndent=0>Item 1</listItem>\n * <listItem listType=\"bulleted\" listIndent=1>Item 2</listItem>   <--- this is removed.\n * <listItem listType=\"bulleted\" listIndent=2>Item 3</listItem>\n * ```\n *\n * The list structure after the middle element is removed:\n *\n * ```xml\n * <listItem listType=\"bulleted\" listIndent=0>Item 1</listItem>\n * <listItem listType=\"bulleted\" listIndent=2>Item 3</listItem>\n * ```\n *\n * Should become:\n *\n * ```xml\n * <listItem listType=\"bulleted\" listIndent=0>Item 1</listItem>\n * <listItem listType=\"bulleted\" listIndent=1>Item 3</listItem>   <--- note that indent got post-fixed.\n * ```\n *\n * @param model The data model.\n * @param writer The writer to do changes with.\n * @returns `true` if any change has been applied, `false` otherwise.\n */\nfunction modelChangePostFixer(model, writer) {\n  const changes = model.document.differ.getChanges();\n  const itemToListHead = new Map();\n  let applied = false;\n  for (const entry of changes) {\n    if (entry.type == 'insert' && entry.name == 'listItem') {\n      _addListToFix(entry.position);\n    } else if (entry.type == 'insert' && entry.name != 'listItem') {\n      if (entry.name != '$text') {\n        // In case of renamed element.\n        const item = entry.position.nodeAfter;\n        if (item.hasAttribute('listIndent')) {\n          writer.removeAttribute('listIndent', item);\n          applied = true;\n        }\n        if (item.hasAttribute('listType')) {\n          writer.removeAttribute('listType', item);\n          applied = true;\n        }\n        if (item.hasAttribute('listStyle')) {\n          writer.removeAttribute('listStyle', item);\n          applied = true;\n        }\n        if (item.hasAttribute('listReversed')) {\n          writer.removeAttribute('listReversed', item);\n          applied = true;\n        }\n        if (item.hasAttribute('listStart')) {\n          writer.removeAttribute('listStart', item);\n          applied = true;\n        }\n        for (const innerItem of Array.from(model.createRangeIn(item)).filter(e => e.item.is('element', 'listItem'))) {\n          _addListToFix(innerItem.previousPosition);\n        }\n      }\n      const posAfter = entry.position.getShiftedBy(entry.length);\n      _addListToFix(posAfter);\n    } else if (entry.type == 'remove' && entry.name == 'listItem') {\n      _addListToFix(entry.position);\n    } else if (entry.type == 'attribute' && entry.attributeKey == 'listIndent') {\n      _addListToFix(entry.range.start);\n    } else if (entry.type == 'attribute' && entry.attributeKey == 'listType') {\n      _addListToFix(entry.range.start);\n    }\n  }\n  for (const listHead of itemToListHead.values()) {\n    _fixListIndents(listHead);\n    _fixListTypes(listHead);\n  }\n  return applied;\n  function _addListToFix(position) {\n    const previousNode = position.nodeBefore;\n    if (!previousNode || !previousNode.is('element', 'listItem')) {\n      const item = position.nodeAfter;\n      if (item && item.is('element', 'listItem')) {\n        itemToListHead.set(item, item);\n      }\n    } else {\n      let listHead = previousNode;\n      if (itemToListHead.has(listHead)) {\n        return;\n      }\n      for (\n      // Cache previousSibling and reuse for performance reasons. See #6581.\n      let previousSibling = listHead.previousSibling; previousSibling && previousSibling.is('element', 'listItem'); previousSibling = listHead.previousSibling) {\n        listHead = previousSibling;\n        if (itemToListHead.has(listHead)) {\n          return;\n        }\n      }\n      itemToListHead.set(previousNode, listHead);\n    }\n  }\n  function _fixListIndents(item) {\n    let maxIndent = 0;\n    let fixBy = null;\n    while (item && item.is('element', 'listItem')) {\n      const itemIndent = item.getAttribute('listIndent');\n      if (itemIndent > maxIndent) {\n        let newIndent;\n        if (fixBy === null) {\n          fixBy = itemIndent - maxIndent;\n          newIndent = maxIndent;\n        } else {\n          if (fixBy > itemIndent) {\n            fixBy = itemIndent;\n          }\n          newIndent = itemIndent - fixBy;\n        }\n        writer.setAttribute('listIndent', newIndent, item);\n        applied = true;\n      } else {\n        fixBy = null;\n        maxIndent = item.getAttribute('listIndent') + 1;\n      }\n      item = item.nextSibling;\n    }\n  }\n  function _fixListTypes(item) {\n    let typesStack = [];\n    let prev = null;\n    while (item && item.is('element', 'listItem')) {\n      const itemIndent = item.getAttribute('listIndent');\n      if (prev && prev.getAttribute('listIndent') > itemIndent) {\n        typesStack = typesStack.slice(0, itemIndent + 1);\n      }\n      if (itemIndent != 0) {\n        if (typesStack[itemIndent]) {\n          const type = typesStack[itemIndent];\n          if (item.getAttribute('listType') != type) {\n            writer.setAttribute('listType', type, item);\n            applied = true;\n          }\n        } else {\n          typesStack[itemIndent] = item.getAttribute('listType');\n        }\n      }\n      prev = item;\n      item = item.nextSibling;\n    }\n  }\n}\n/**\n * A fixer for pasted content that includes list items.\n *\n * It fixes indentation of pasted list items so the pasted items match correctly to the context they are pasted into.\n *\n * Example:\n *\n * ```xml\n * <listItem listType=\"bulleted\" listIndent=0>A</listItem>\n * <listItem listType=\"bulleted\" listIndent=1>B^</listItem>\n * // At ^ paste:  <listItem listType=\"bulleted\" listIndent=4>X</listItem>\n * //              <listItem listType=\"bulleted\" listIndent=5>Y</listItem>\n * <listItem listType=\"bulleted\" listIndent=2>C</listItem>\n * ```\n *\n * Should become:\n *\n * ```xml\n * <listItem listType=\"bulleted\" listIndent=0>A</listItem>\n * <listItem listType=\"bulleted\" listIndent=1>BX</listItem>\n * <listItem listType=\"bulleted\" listIndent=2>Y/listItem>\n * <listItem listType=\"bulleted\" listIndent=2>C</listItem>\n * ```\n */\nconst modelIndentPasteFixer = function (evt, [content, selectable]) {\n  const model = this;\n  // Check whether inserted content starts from a `listItem`. If it does not, it means that there are some other\n  // elements before it and there is no need to fix indents, because even if we insert that content into a list,\n  // that list will be broken.\n  // Note: we also need to handle singular elements because inserting item with indent 0 into 0,1,[],2\n  // would create incorrect model.\n  let item = content.is('documentFragment') ? content.getChild(0) : content;\n  let selection;\n  if (!selectable) {\n    selection = model.document.selection;\n  } else {\n    selection = model.createSelection(selectable);\n  }\n  if (item && item.is('element', 'listItem')) {\n    // Get a reference list item. Inserted list items will be fixed according to that item.\n    const pos = selection.getFirstPosition();\n    let refItem = null;\n    if (pos.parent.is('element', 'listItem')) {\n      refItem = pos.parent;\n    } else if (pos.nodeBefore && pos.nodeBefore.is('element', 'listItem')) {\n      refItem = pos.nodeBefore;\n    }\n    // If there is `refItem` it means that we do insert list items into an existing list.\n    if (refItem) {\n      // First list item in `data` has indent equal to 0 (it is a first list item). It should have indent equal\n      // to the indent of reference item. We have to fix the first item and all of it's children and following siblings.\n      // Indent of all those items has to be adjusted to reference item.\n      const indentChange = refItem.getAttribute('listIndent');\n      // Fix only if there is anything to fix.\n      if (indentChange > 0) {\n        // Adjust indent of all \"first\" list items in inserted data.\n        while (item && item.is('element', 'listItem')) {\n          item._setAttribute('listIndent', item.getAttribute('listIndent') + indentChange);\n          item = item.nextSibling;\n        }\n      }\n    }\n  }\n};\n/**\n * Helper function that converts children of a given `<li>` view element into corresponding model elements.\n * The function maintains proper order of elements if model `listItem` is split during the conversion\n * due to block children conversion.\n *\n * @param listItemModel List item model element to which converted children will be inserted.\n * @param viewChildren View elements which will be converted.\n * @param conversionApi Conversion interface to be used by the callback.\n * @returns Position on which next elements should be inserted after children conversion.\n */\nfunction viewToModelListItemChildrenConverter(listItemModel, viewChildren, conversionApi) {\n  const {\n    writer,\n    schema\n  } = conversionApi;\n  // A position after the last inserted `listItem`.\n  let nextPosition = writer.createPositionAfter(listItemModel);\n  // Check all children of the converted `<li>`. At this point we assume there are no \"whitespace\" view text nodes\n  // in view list, between view list items. This should be handled by `<ul>` and `<ol>` converters.\n  for (const child of viewChildren) {\n    if (child.name == 'ul' || child.name == 'ol') {\n      // If the children is a list, we will insert its conversion result after currently handled `listItem`.\n      // Then, next insertion position will be set after all the new list items (and maybe other elements if\n      // something split list item).\n      //\n      // If this is a list, we expect that some `listItem`s and possibly other blocks will be inserted, however `.modelCursor`\n      // should be set after last `listItem` (or block). This is why it feels safe to use it as `nextPosition`\n      nextPosition = conversionApi.convertItem(child, nextPosition).modelCursor;\n    } else {\n      // If this is not a list, try inserting content at the end of the currently handled `listItem`.\n      const result = conversionApi.convertItem(child, writer.createPositionAt(listItemModel, 'end'));\n      // It may end up that the current `listItem` becomes split (if that content cannot be inside `listItem`). For example:\n      //\n      // <li><p>Foo</p></li>\n      //\n      // will be converted to:\n      //\n      // <listItem></listItem><paragraph>Foo</paragraph><listItem></listItem>\n      //\n      const convertedChild = result.modelRange.start.nodeAfter;\n      const wasSplit = convertedChild && convertedChild.is('element') && !schema.checkChild(listItemModel, convertedChild.name);\n      if (wasSplit) {\n        // As `lastListItem` got split, we need to update it to the second part of the split `listItem` element.\n        //\n        // `modelCursor` should be set to a position where the conversion should continue. There are multiple possible scenarios\n        // that may happen. Usually, `modelCursor` (marked as `#` below) would point to the second list item after conversion:\n        //\n        //\t\t`<li><p>Foo</p></li>` -> `<listItem></listItem><paragraph>Foo</paragraph><listItem>#</listItem>`\n        //\n        // However, in some cases, like auto-paragraphing, the position is placed at the end of the block element:\n        //\n        //\t\t`<li><div>Foo</div></li>` -> `<listItem></listItem><paragraph>Foo#</paragraph><listItem></listItem>`\n        //\n        // or after an element if another element broken auto-paragraphed element:\n        //\n        //\t\t`<li><div><h2>Foo</h2></div></li>` -> `<listItem></listItem><heading1>Foo</heading1>#<listItem></listItem>`\n        //\n        // We need to check for such cases and use proper list item and position based on it.\n        //\n        if (result.modelCursor.parent.is('element', 'listItem')) {\n          // (1).\n          listItemModel = result.modelCursor.parent;\n        } else {\n          // (2), (3).\n          listItemModel = findNextListItem(result.modelCursor);\n        }\n        nextPosition = writer.createPositionAfter(listItemModel);\n      }\n    }\n  }\n  return nextPosition;\n}\n/**\n * Helper function that seeks for a next list item starting from given `startPosition`.\n */\nfunction findNextListItem(startPosition) {\n  const treeWalker = new TreeWalker({\n    startPosition\n  });\n  let value;\n  do {\n    value = treeWalker.next();\n  } while (!value.value.item.is('element', 'listItem'));\n  return value.value.item;\n}\n/**\n * Helper function that takes all children of given `viewRemovedItem` and moves them in a correct place, according\n * to other given parameters.\n */\nfunction hoistNestedLists(nextIndent, modelRemoveStartPosition, viewRemoveStartPosition, viewRemovedItem, conversionApi, model) {\n  // Find correct previous model list item element.\n  // The element has to have either same or smaller indent than given reference indent.\n  // This will be the model element which will get nested items (if it has smaller indent) or sibling items (if it has same indent).\n  // Keep in mind that such element might not be found, if removed item was the first item.\n  const prevModelItem = getSiblingListItem(modelRemoveStartPosition.nodeBefore, {\n    sameIndent: true,\n    smallerIndent: true,\n    listIndent: nextIndent\n  });\n  const mapper = conversionApi.mapper;\n  const viewWriter = conversionApi.writer;\n  // Indent of found element or `null` if the element has not been found.\n  const prevIndent = prevModelItem ? prevModelItem.getAttribute('listIndent') : null;\n  let insertPosition;\n  if (!prevModelItem) {\n    // If element has not been found, simply insert lists at the position where the removed item was:\n    //\n    // Lorem ipsum.\n    // 1 --------           <--- this is removed, no previous list item, put nested items in place of removed item.\n    //   1.1 --------       <--- this is reference indent.\n    //     1.1.1 --------\n    //     1.1.2 --------\n    //   1.2 --------\n    //\n    // Becomes:\n    //\n    // Lorem ipsum.\n    // 1.1 --------\n    //   1.1.1 --------\n    //   1.1.2 --------\n    // 1.2 --------\n    insertPosition = viewRemoveStartPosition;\n  } else if (prevIndent == nextIndent) {\n    // If element has been found and has same indent as reference indent it means that nested items should\n    // become siblings of found element:\n    //\n    // 1 --------\n    //   1.1 --------\n    //   1.2 --------       <--- this is `prevModelItem`.\n    // 2 --------           <--- this is removed, previous list item has indent same as reference indent.\n    //   2.1 --------       <--- this is reference indent, this and 2.2 should become siblings of 1.2.\n    //   2.2 --------\n    //\n    // Becomes:\n    //\n    // 1 --------\n    //   1.1 --------\n    //   1.2 --------\n    //   2.1 --------\n    //   2.2 --------\n    const prevViewList = mapper.toViewElement(prevModelItem).parent;\n    insertPosition = viewWriter.createPositionAfter(prevViewList);\n  } else {\n    // If element has been found and has smaller indent as reference indent it means that nested items\n    // should become nested items of found item:\n    //\n    // 1 --------           <--- this is `prevModelItem`.\n    //   1.1 --------       <--- this is removed, previous list item has indent smaller than reference indent.\n    //     1.1.1 --------   <--- this is reference indent, this and 1.1.1 should become nested items of 1.\n    //     1.1.2 --------\n    //   1.2 --------\n    //\n    // Becomes:\n    //\n    // 1 --------\n    //   1.1.1 --------\n    //   1.1.2 --------\n    //   1.2 --------\n    //\n    // Note: in this case 1.1.1 have indent 2 while 1 have indent 0. In model that should not be possible,\n    // because following item may have indent bigger only by one. But this is fixed by postfixer.\n    const modelPosition = model.createPositionAt(prevModelItem, 'end');\n    insertPosition = mapper.toViewPosition(modelPosition);\n  }\n  insertPosition = positionAfterUiElements(insertPosition);\n  // Handle multiple lists. This happens if list item has nested numbered and bulleted lists. Following lists\n  // are inserted after the first list (no need to recalculate insertion position for them).\n  for (const child of [...viewRemovedItem.getChildren()]) {\n    if (isList(child)) {\n      insertPosition = viewWriter.move(viewWriter.createRangeOn(child), insertPosition).end;\n      mergeViewLists(viewWriter, child, child.nextSibling);\n      mergeViewLists(viewWriter, child.previousSibling, child);\n    }\n  }\n}\n/**\n * Checks if view element is a list type (ul or ol).\n */\nfunction isList(viewElement) {\n  return viewElement.is('element', 'ol') || viewElement.is('element', 'ul');\n}\n/**\n * Calculates the indent value for a list item. Handles HTML compliant and non-compliant lists.\n *\n * Also, fixes non HTML compliant lists indents:\n *\n * ```\n * before:                                     fixed list:\n * OL                                          OL\n * |-> LI (parent LIs: 0)                      |-> LI     (indent: 0)\n *     |-> OL                                  |-> OL\n *         |-> OL                                  |\n *         |   |-> OL                              |\n *         |       |-> OL                          |\n *         |           |-> LI (parent LIs: 1)      |-> LI (indent: 1)\n *         |-> LI (parent LIs: 1)                  |-> LI (indent: 1)\n *\n * before:                                     fixed list:\n * OL                                          OL\n * |-> OL                                      |\n *     |-> OL                                  |\n *          |-> OL                             |\n *              |-> LI (parent LIs: 0)         |-> LI        (indent: 0)\n *\n * before:                                     fixed list:\n * OL                                          OL\n * |-> LI (parent LIs: 0)                      |-> LI         (indent: 0)\n * |-> OL                                          |-> OL\n *     |-> LI (parent LIs: 0)                          |-> LI (indent: 1)\n * ```\n */\nfunction getIndent(listItem) {\n  let indent = 0;\n  let parent = listItem.parent;\n  while (parent) {\n    // Each LI in the tree will result in an increased indent for HTML compliant lists.\n    if (parent.is('element', 'li')) {\n      indent++;\n    } else {\n      // If however the list is nested in other list we should check previous sibling of any of the list elements...\n      const previousSibling = parent.previousSibling;\n      // ...because the we might need increase its indent:\n      //\t\tbefore:                           fixed list:\n      //\t\tOL                                OL\n      //\t\t|-> LI (parent LIs: 0)            |-> LI         (indent: 0)\n      //\t\t|-> OL                                |-> OL\n      //\t\t    |-> LI (parent LIs: 0)                |-> LI (indent: 1)\n      if (previousSibling && previousSibling.is('element', 'li')) {\n        indent++;\n      }\n    }\n    parent = parent.parent;\n  }\n  return indent;\n}\n\n/**\n * The engine of the list feature. It handles creating, editing and removing lists and list items.\n *\n * It registers the `'numberedList'`, `'bulletedList'`, `'indentList'` and `'outdentList'` commands.\n */\nclass LegacyListEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LegacyListEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Enter, Delete, LegacyListUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Schema.\n    // Note: in case `$block` will ever be allowed in `listItem`, keep in mind that this feature\n    // uses `Selection#getSelectedBlocks()` without any additional processing to obtain all selected list items.\n    // If there are blocks allowed inside list item, algorithms using `getSelectedBlocks()` will have to be modified.\n    editor.model.schema.register('listItem', {\n      inheritAllFrom: '$block',\n      allowAttributes: ['listType', 'listIndent']\n    });\n    // Converters.\n    const data = editor.data;\n    const editing = editor.editing;\n    editor.model.document.registerPostFixer(writer => modelChangePostFixer(editor.model, writer));\n    editing.mapper.registerViewToModelLength('li', getViewListItemLength);\n    data.mapper.registerViewToModelLength('li', getViewListItemLength);\n    editing.mapper.on('modelToViewPosition', modelToViewPosition(editing.view));\n    editing.mapper.on('viewToModelPosition', viewToModelPosition(editor.model));\n    data.mapper.on('modelToViewPosition', modelToViewPosition(editing.view));\n    editor.conversion.for('editingDowncast').add(dispatcher => {\n      dispatcher.on('insert', modelViewSplitOnInsert, {\n        priority: 'high'\n      });\n      dispatcher.on('insert:listItem', modelViewInsertion$1(editor.model));\n      dispatcher.on('attribute:listType:listItem', modelViewChangeType$1, {\n        priority: 'high'\n      });\n      dispatcher.on('attribute:listType:listItem', modelViewMergeAfterChangeType, {\n        priority: 'low'\n      });\n      dispatcher.on('attribute:listIndent:listItem', modelViewChangeIndent(editor.model));\n      dispatcher.on('remove:listItem', modelViewRemove(editor.model));\n      dispatcher.on('remove', modelViewMergeAfter, {\n        priority: 'low'\n      });\n    });\n    editor.conversion.for('dataDowncast').add(dispatcher => {\n      dispatcher.on('insert', modelViewSplitOnInsert, {\n        priority: 'high'\n      });\n      dispatcher.on('insert:listItem', modelViewInsertion$1(editor.model));\n    });\n    editor.conversion.for('upcast').add(dispatcher => {\n      dispatcher.on('element:ul', cleanList, {\n        priority: 'high'\n      });\n      dispatcher.on('element:ol', cleanList, {\n        priority: 'high'\n      });\n      dispatcher.on('element:li', cleanListItem, {\n        priority: 'high'\n      });\n      dispatcher.on('element:li', viewModelConverter);\n    });\n    // Fix indentation of pasted items.\n    editor.model.on('insertContent', modelIndentPasteFixer, {\n      priority: 'high'\n    });\n    // Register commands for numbered and bulleted list.\n    editor.commands.add('numberedList', new LegacyListCommand(editor, 'numbered'));\n    editor.commands.add('bulletedList', new LegacyListCommand(editor, 'bulleted'));\n    // Register commands for indenting.\n    editor.commands.add('indentList', new LegacyIndentCommand(editor, 'forward'));\n    editor.commands.add('outdentList', new LegacyIndentCommand(editor, 'backward'));\n    const viewDocument = editing.view.document;\n    // Overwrite default Enter key behavior.\n    // If Enter key is pressed with selection collapsed in empty list item, outdent it instead of breaking it.\n    this.listenTo(viewDocument, 'enter', (evt, data) => {\n      const doc = this.editor.model.document;\n      const positionParent = doc.selection.getLastPosition().parent;\n      if (doc.selection.isCollapsed && positionParent.name == 'listItem' && positionParent.isEmpty) {\n        this.editor.execute('outdentList');\n        data.preventDefault();\n        evt.stop();\n      }\n    }, {\n      context: 'li'\n    });\n    // Overwrite default Backspace key behavior.\n    // If Backspace key is pressed with selection collapsed on first position in first list item, outdent it. #83\n    this.listenTo(viewDocument, 'delete', (evt, data) => {\n      // Check conditions from those that require less computations like those immediately available.\n      if (data.direction !== 'backward') {\n        return;\n      }\n      const selection = this.editor.model.document.selection;\n      if (!selection.isCollapsed) {\n        return;\n      }\n      const firstPosition = selection.getFirstPosition();\n      if (!firstPosition.isAtStart) {\n        return;\n      }\n      const positionParent = firstPosition.parent;\n      if (positionParent.name !== 'listItem') {\n        return;\n      }\n      const previousIsAListItem = positionParent.previousSibling && positionParent.previousSibling.name === 'listItem';\n      if (previousIsAListItem) {\n        return;\n      }\n      this.editor.execute('outdentList');\n      data.preventDefault();\n      evt.stop();\n    }, {\n      context: 'li'\n    });\n    this.listenTo(editor.editing.view.document, 'tab', (evt, data) => {\n      const commandName = data.shiftKey ? 'outdentList' : 'indentList';\n      const command = this.editor.commands.get(commandName);\n      if (command.isEnabled) {\n        editor.execute(commandName);\n        data.stopPropagation();\n        data.preventDefault();\n        evt.stop();\n      }\n    }, {\n      context: 'li'\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const commands = this.editor.commands;\n    const indent = commands.get('indent');\n    const outdent = commands.get('outdent');\n    if (indent) {\n      indent.registerChildCommand(commands.get('indentList'));\n    }\n    if (outdent) {\n      outdent.registerChildCommand(commands.get('outdentList'));\n    }\n  }\n}\nfunction getViewListItemLength(element) {\n  let length = 1;\n  for (const child of element.getChildren()) {\n    if (child.name == 'ul' || child.name == 'ol') {\n      for (const item of child.getChildren()) {\n        length += getViewListItemLength(item);\n      }\n    }\n  }\n  return length;\n}\n\n/**\n * The legacy list feature.\n *\n * This is a \"glue\" plugin that loads the {@link module:list/legacylist/legacylistediting~LegacyListEditing legacy list editing feature}\n * and {@link module:list/list/listui~ListUI list UI feature}.\n */\nclass LegacyList extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [LegacyListEditing, ListUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LegacyList';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The list style command. It changes the `listStyle` attribute of the selected list items.\n *\n * If the list type (numbered or bulleted) can be inferred from the passed style type,\n * the command tries to convert selected items to a list of that type.\n * It is used by the {@link module:list/legacylistproperties~LegacyListProperties legacy list properties feature}.\n */\nclass LegacyListStyleCommand extends Command {\n  /**\n  * The default type of the list style.\n  */\n  defaultType;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor The editor instance.\n  * @param defaultType The list type that will be used by default if the value was not specified during\n  * the command execution.\n  */\n  constructor(editor, defaultType) {\n    super(editor);\n    this.defaultType = defaultType;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.value = this._getValue();\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options.type The type of the list style, e.g. `'disc'` or `'square'`. If `null` is specified, the default\n  * style will be applied.\n  */\n  execute(options = {}) {\n    this._tryToConvertItemsToList(options);\n    const model = this.editor.model;\n    const listItems = getSelectedListItems(model);\n    if (!listItems.length) {\n      return;\n    }\n    model.change(writer => {\n      for (const item of listItems) {\n        writer.setAttribute('listStyle', options.type || this.defaultType, item);\n      }\n    });\n  }\n  /**\n  * Checks the command's {@link #value}.\n  *\n  * @returns The current value.\n  */\n  _getValue() {\n    const listItem = this.editor.model.document.selection.getFirstPosition().parent;\n    if (listItem && listItem.is('element', 'listItem')) {\n      return listItem.getAttribute('listStyle');\n    }\n    return null;\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    const editor = this.editor;\n    const numberedList = editor.commands.get('numberedList');\n    const bulletedList = editor.commands.get('bulletedList');\n    return numberedList.isEnabled || bulletedList.isEnabled;\n  }\n  /**\n  * Checks if the provided list style is valid. Also changes the selection to a list if it's not set yet.\n  *\n  * @param The type of the list style. If `null` is specified, the function does nothing.\n  */\n  _tryToConvertItemsToList(options) {\n    if (!options.type) {\n      return;\n    }\n    const listType = getListTypeFromListStyleType(options.type);\n    /* istanbul ignore next -- @preserve */\n    if (!listType) {\n      return;\n    }\n    const editor = this.editor;\n    const commandName = `${listType}List`;\n    const command = editor.commands.get(commandName);\n    if (!command.value) {\n      editor.execute(commandName);\n    }\n  }\n}\n\n/**\n * The reversed list command. It changes the `listReversed` attribute of the selected list items. As a result, the list order will be\n * reversed.\n * It is used by the {@link module:list/legacylistproperties~LegacyListProperties legacy list properties feature}.\n */\nclass LegacyListReversedCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const value = this._getValue();\n    this.value = value;\n    this.isEnabled = value != null;\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options.reversed Whether the list should be reversed.\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const listItems = getSelectedListItems(model).filter(item => item.getAttribute('listType') == 'numbered');\n    model.change(writer => {\n      for (const item of listItems) {\n        writer.setAttribute('listReversed', !!options.reversed, item);\n      }\n    });\n  }\n  /**\n  * Checks the command's {@link #value}.\n  *\n  * @returns The current value.\n  */\n  _getValue() {\n    const listItem = this.editor.model.document.selection.getFirstPosition().parent;\n    if (listItem && listItem.is('element', 'listItem') && listItem.getAttribute('listType') == 'numbered') {\n      return listItem.getAttribute('listReversed');\n    }\n    return null;\n  }\n}\n\n/**\n * The list start index command. It changes the `listStart` attribute of the selected list items.\n * It is used by the {@link module:list/legacylistproperties~LegacyListProperties legacy list properties feature}.\n */\nclass LegacyListStartCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const value = this._getValue();\n    this.value = value;\n    this.isEnabled = value != null;\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options.startIndex The list start index.\n  */\n  execute({\n    startIndex = 1\n  } = {}) {\n    const model = this.editor.model;\n    const listItems = getSelectedListItems(model).filter(item => item.getAttribute('listType') == 'numbered');\n    model.change(writer => {\n      for (const item of listItems) {\n        writer.setAttribute('listStart', startIndex >= 0 ? startIndex : 1, item);\n      }\n    });\n  }\n  /**\n  * Checks the command's {@link #value}.\n  *\n  * @returns The current value.\n  */\n  _getValue() {\n    const listItem = this.editor.model.document.selection.getFirstPosition().parent;\n    if (listItem && listItem.is('element', 'listItem') && listItem.getAttribute('listType') == 'numbered') {\n      return listItem.getAttribute('listStart');\n    }\n    return null;\n  }\n}\nconst DEFAULT_LIST_TYPE = 'default';\n/**\n * The engine of the list properties feature.\n *\n * It sets the value for the `listItem` attribute of the {@link module:list/legacylist~LegacyList `<listItem>`} element that\n * allows modifying the list style type.\n *\n * It registers the `'listStyle'`, `'listReversed'` and `'listStart'` commands if they are enabled in the configuration.\n * Read more in {@link module:list/listconfig~ListPropertiesConfig}.\n */\nclass LegacyListPropertiesEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [LegacyListEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LegacyListPropertiesEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('list', {\n      properties: {\n        styles: true,\n        startIndex: false,\n        reversed: false\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const model = editor.model;\n    const enabledProperties = editor.config.get('list.properties');\n    const strategies = createAttributeStrategies(enabledProperties);\n    // Extend schema.\n    model.schema.extend('listItem', {\n      allowAttributes: strategies.map(s => s.attributeName)\n    });\n    for (const strategy of strategies) {\n      strategy.addCommand(editor);\n    }\n    // Fix list attributes when modifying their nesting levels (the `listIndent` attribute).\n    this.listenTo(editor.commands.get('indentList'), '_executeCleanup', fixListAfterIndentListCommand(editor, strategies));\n    this.listenTo(editor.commands.get('outdentList'), '_executeCleanup', fixListAfterOutdentListCommand(editor, strategies));\n    this.listenTo(editor.commands.get('bulletedList'), '_executeCleanup', restoreDefaultListStyle(editor));\n    this.listenTo(editor.commands.get('numberedList'), '_executeCleanup', restoreDefaultListStyle(editor));\n    // Register a post-fixer that ensures that the attributes is specified in each `listItem` element.\n    model.document.registerPostFixer(fixListAttributesOnListItemElements(editor, strategies));\n    // Set up conversion.\n    editor.conversion.for('upcast').add(upcastListItemAttributes(strategies));\n    editor.conversion.for('downcast').add(downcastListItemAttributes(strategies));\n    // Handle merging two separated lists into the single one.\n    this._mergeListAttributesWhileMergingLists(strategies);\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    // Enable post-fixer that removes the attributes from to-do list items only if the \"TodoList\" plugin is on.\n    // We need to registry the hook here since the `TodoList` plugin can be added after the `ListPropertiesEditing`.\n    if (editor.commands.get('todoList')) {\n      editor.model.document.registerPostFixer(removeListItemAttributesFromTodoList(editor));\n    }\n  }\n  /**\n  * Starts listening to {@link module:engine/model/model~Model#deleteContent} and checks whether two lists will be merged into a single\n  * one after deleting the content.\n  *\n  * The purpose of this action is to adjust the `listStyle`, `listReversed` and `listStart` values\n  * for the list that was merged.\n  *\n  * Consider the following model's content:\n  *\n  * ```xml\n  * <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 1</listItem>\n  * <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 2</listItem>\n  * <paragraph>[A paragraph.]</paragraph>\n  * <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"circle\">UL List item 1</listItem>\n  * <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"circle\">UL List item 2</listItem>\n  * ```\n  *\n  * After removing the paragraph element, the second list will be merged into the first one.\n  * We want to inherit the `listStyle` attribute for the second list from the first one.\n  *\n  * ```xml\n  * <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 1</listItem>\n  * <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 2</listItem>\n  * <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 1</listItem>\n  * <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 2</listItem>\n  * ```\n  *\n  * See https://github.com/ckeditor/ckeditor5/issues/7879.\n  *\n  * @param attributeStrategies Strategies for the enabled attributes.\n  */\n  _mergeListAttributesWhileMergingLists(attributeStrategies) {\n    const editor = this.editor;\n    const model = editor.model;\n    // First the outer-most`listItem` in the first list reference.\n    // If found, the lists should be merged and this `listItem` provides the attributes\n    // and it is also a starting point when searching for items in the second list.\n    let firstMostOuterItem;\n    // Check whether the removed content is between two lists.\n    this.listenTo(model, 'deleteContent', (evt, [selection]) => {\n      const firstPosition = selection.getFirstPosition();\n      const lastPosition = selection.getLastPosition();\n      // Typing or removing content in a single item. Aborting.\n      if (firstPosition.parent === lastPosition.parent) {\n        return;\n      }\n      // An element before the content that will be removed is not a list.\n      if (!firstPosition.parent.is('element', 'listItem')) {\n        return;\n      }\n      const nextSibling = lastPosition.parent.nextSibling;\n      // An element after the content that will be removed is not a list.\n      if (!nextSibling || !nextSibling.is('element', 'listItem')) {\n        return;\n      }\n      // Find the outermost list item based on the `listIndent` attribute. We can't assume that `listIndent=0`\n      // because the selection can be hooked in nested lists.\n      //\n      // <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 1</listItem>\n      // <listItem listIndent=\"1\" listType=\"bulleted\" listStyle=\"square\">UL List [item 1.1</listItem>\n      // <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"circle\">[]UL List item 1.</listItem>\n      // <listItem listIndent=\"1\" listType=\"bulleted\" listStyle=\"circle\">UL List ]item 1.1</listItem>\n      //\n      // After deleting the content, we would like to inherit the \"square\" attribute for the last element:\n      //\n      // <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 1</listItem>\n      // <listItem listIndent=\"1\" listType=\"bulleted\" listStyle=\"square\">UL List []item 1.1</listItem>\n      const mostOuterItemList = getSiblingListItem(firstPosition.parent, {\n        sameIndent: true,\n        listIndent: nextSibling.getAttribute('listIndent')\n      });\n      // The outermost list item may not exist while removing elements between lists with different value\n      // of the `listIndent` attribute. In such a case we don't want to update anything. See: #8073.\n      if (!mostOuterItemList) {\n        return;\n      }\n      if (mostOuterItemList.getAttribute('listType') === nextSibling.getAttribute('listType')) {\n        firstMostOuterItem = mostOuterItemList;\n      }\n    }, {\n      priority: 'high'\n    });\n    // If so, update the `listStyle` attribute for the second list.\n    this.listenTo(model, 'deleteContent', () => {\n      if (!firstMostOuterItem) {\n        return;\n      }\n      model.change(writer => {\n        // Find the first most-outer item list in the merged list.\n        // A case when the first list item in the second list was merged into the last item in the first list.\n        //\n        // <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 1</listItem>\n        // <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"square\">UL List item 2</listItem>\n        // <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"circle\">[]UL List item 1</listItem>\n        // <listItem listIndent=\"0\" listType=\"bulleted\" listStyle=\"circle\">UL List item 2</listItem>\n        const secondListMostOuterItem = getSiblingListItem(firstMostOuterItem.nextSibling, {\n          sameIndent: true,\n          listIndent: firstMostOuterItem.getAttribute('listIndent'),\n          direction: 'forward'\n        });\n        // If the selection ends in a non-list element, there are no <listItem>s that would require adjustments.\n        // See: #8642.\n        if (!secondListMostOuterItem) {\n          firstMostOuterItem = null;\n          return;\n        }\n        const items = [secondListMostOuterItem, ...getSiblingNodes(writer.createPositionAt(secondListMostOuterItem, 0), 'forward')];\n        for (const listItem of items) {\n          for (const strategy of attributeStrategies) {\n            if (strategy.appliesToListItem(listItem)) {\n              const attributeName = strategy.attributeName;\n              const value = firstMostOuterItem.getAttribute(attributeName);\n              writer.setAttribute(attributeName, value, listItem);\n            }\n          }\n        }\n      });\n      firstMostOuterItem = null;\n    }, {\n      priority: 'low'\n    });\n  }\n}\n/**\n * Creates an array of strategies for dealing with enabled listItem attributes.\n */\nfunction createAttributeStrategies(enabledProperties) {\n  const strategies = [];\n  if (enabledProperties.styles) {\n    strategies.push({\n      attributeName: 'listStyle',\n      defaultValue: DEFAULT_LIST_TYPE,\n      addCommand(editor) {\n        editor.commands.add('listStyle', new LegacyListStyleCommand(editor, DEFAULT_LIST_TYPE));\n      },\n      appliesToListItem() {\n        return true;\n      },\n      setAttributeOnDowncast(writer, listStyle, element) {\n        if (listStyle && listStyle !== DEFAULT_LIST_TYPE) {\n          writer.setStyle('list-style-type', listStyle, element);\n        } else {\n          writer.removeStyle('list-style-type', element);\n        }\n      },\n      getAttributeOnUpcast(listParent) {\n        return normalizeListStyle(listParent.getStyle('list-style-type')) || DEFAULT_LIST_TYPE;\n      }\n    });\n  }\n  if (enabledProperties.reversed) {\n    strategies.push({\n      attributeName: 'listReversed',\n      defaultValue: false,\n      addCommand(editor) {\n        editor.commands.add('listReversed', new LegacyListReversedCommand(editor));\n      },\n      appliesToListItem(item) {\n        return item.getAttribute('listType') == 'numbered';\n      },\n      setAttributeOnDowncast(writer, listReversed, element) {\n        if (listReversed) {\n          writer.setAttribute('reversed', 'reversed', element);\n        } else {\n          writer.removeAttribute('reversed', element);\n        }\n      },\n      getAttributeOnUpcast(listParent) {\n        return listParent.hasAttribute('reversed');\n      }\n    });\n  }\n  if (enabledProperties.startIndex) {\n    strategies.push({\n      attributeName: 'listStart',\n      defaultValue: 1,\n      addCommand(editor) {\n        editor.commands.add('listStart', new LegacyListStartCommand(editor));\n      },\n      appliesToListItem(item) {\n        return item.getAttribute('listType') == 'numbered';\n      },\n      setAttributeOnDowncast(writer, listStart, element) {\n        if (listStart == 0 || listStart > 1) {\n          writer.setAttribute('start', listStart, element);\n        } else {\n          writer.removeAttribute('start', element);\n        }\n      },\n      getAttributeOnUpcast(listParent) {\n        const startAttributeValue = listParent.getAttribute('start');\n        return startAttributeValue >= 0 ? startAttributeValue : 1;\n      }\n    });\n  }\n  return strategies;\n}\n/**\n * Returns a converter consumes the `style`, `reversed` and `start` attribute.\n * In `style` it searches for the `list-style-type` definition.\n * If not found, the `\"default\"` value will be used.\n */\nfunction upcastListItemAttributes(attributeStrategies) {\n  return dispatcher => {\n    dispatcher.on('element:li', (evt, data, conversionApi) => {\n      // https://github.com/ckeditor/ckeditor5/issues/13858\n      if (!data.modelRange) {\n        return;\n      }\n      const listParent = data.viewItem.parent;\n      const listItem = data.modelRange.start.nodeAfter || data.modelRange.end.nodeBefore;\n      for (const strategy of attributeStrategies) {\n        if (strategy.appliesToListItem(listItem)) {\n          const listStyle = strategy.getAttributeOnUpcast(listParent);\n          conversionApi.writer.setAttribute(strategy.attributeName, listStyle, listItem);\n        }\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * Returns a converter that adds `reversed`, `start` attributes and adds `list-style-type` definition as a value for the `style` attribute.\n * The `\"default\"` values are removed and not present in the view/data.\n */\nfunction downcastListItemAttributes(attributeStrategies) {\n  return dispatcher => {\n    for (const strategy of attributeStrategies) {\n      dispatcher.on(`attribute:${strategy.attributeName}:listItem`, (evt, data, conversionApi) => {\n        const viewWriter = conversionApi.writer;\n        const currentElement = data.item;\n        const previousElement = getSiblingListItem(currentElement.previousSibling, {\n          sameIndent: true,\n          listIndent: currentElement.getAttribute('listIndent'),\n          direction: 'backward'\n        });\n        const viewItem = conversionApi.mapper.toViewElement(currentElement);\n        // A case when elements represent different lists. We need to separate their container.\n        if (!areRepresentingSameList(currentElement, previousElement)) {\n          viewWriter.breakContainer(viewWriter.createPositionBefore(viewItem));\n        }\n        strategy.setAttributeOnDowncast(viewWriter, data.attributeNewValue, viewItem.parent);\n      }, {\n        priority: 'low'\n      });\n    }\n  };\n  /**\n  * Checks whether specified list items belong to the same list.\n  */\n  function areRepresentingSameList(listItem1, listItem2) {\n    return listItem2 && listItem1.getAttribute('listType') === listItem2.getAttribute('listType') && listItem1.getAttribute('listIndent') === listItem2.getAttribute('listIndent') && listItem1.getAttribute('listStyle') === listItem2.getAttribute('listStyle') && listItem1.getAttribute('listReversed') === listItem2.getAttribute('listReversed') && listItem1.getAttribute('listStart') === listItem2.getAttribute('listStart');\n  }\n}\n/**\n * When indenting list, nested list should clear its value for the attributes or inherit from nested lists.\n *\n * â–  List item 1.\n * â–  List item 2.[]\n * â–  List item 3.\n * editor.execute( 'indentList' );\n *\n * â–  List item 1.\n *     â—‹ List item 2.[]\n * â–  List item 3.\n */\nfunction fixListAfterIndentListCommand(editor, attributeStrategies) {\n  return (evt, changedItems) => {\n    const root = changedItems[0];\n    const rootIndent = root.getAttribute('listIndent');\n    const itemsToUpdate = changedItems.filter(item => item.getAttribute('listIndent') === rootIndent);\n    // A case where a few list items are indented must be checked separately\n    // since `getSiblingListItem()` returns the first changed element.\n    // â–  List item 1.\n    //     â—‹ [List item 2.\n    //     â—‹ List item 3.]\n    // â–  List item 4.\n    //\n    // List items: `2` and `3` should be adjusted.\n    let previousSibling = null;\n    if (root.previousSibling.getAttribute('listIndent') + 1 !== rootIndent) {\n      previousSibling = getSiblingListItem(root.previousSibling, {\n        sameIndent: true,\n        direction: 'backward',\n        listIndent: rootIndent\n      });\n    }\n    editor.model.change(writer => {\n      for (const item of itemsToUpdate) {\n        for (const strategy of attributeStrategies) {\n          if (strategy.appliesToListItem(item)) {\n            const valueToSet = previousSibling == null ? strategy.defaultValue : previousSibling.getAttribute(strategy.attributeName);\n            writer.setAttribute(strategy.attributeName, valueToSet, item);\n          }\n        }\n      }\n    });\n  };\n}\n/**\n * When outdenting a list, a nested list should copy attribute values\n * from the previous sibling list item including the same value for the `listIndent` value.\n *\n * â–  List item 1.\n *     â—‹ List item 2.[]\n * â–  List item 3.\n *\n * editor.execute( 'outdentList' );\n *\n * â–  List item 1.\n * â–  List item 2.[]\n * â–  List item 3.\n */\nfunction fixListAfterOutdentListCommand(editor, attributeStrategies) {\n  return (evt, changedItems) => {\n    changedItems = changedItems.reverse().filter(item => item.is('element', 'listItem'));\n    if (!changedItems.length) {\n      return;\n    }\n    const indent = changedItems[0].getAttribute('listIndent');\n    const listType = changedItems[0].getAttribute('listType');\n    let listItem = changedItems[0].previousSibling;\n    // â–  List item 1.\n    //     â—‹ List item 2.\n    //     â—‹ List item 3.[]\n    // â–  List item 4.\n    //\n    // After outdenting a list, `List item 3` should inherit the `listStyle` attribute from `List item 1`.\n    //\n    // â–  List item 1.\n    //     â—‹ List item 2.\n    // â–  List item 3.[]\n    // â–  List item 4.\n    if (listItem.is('element', 'listItem')) {\n      while (listItem.getAttribute('listIndent') !== indent) {\n        listItem = listItem.previousSibling;\n      }\n    } else {\n      listItem = null;\n    }\n    // Outdenting such a list should restore values based on `List item 4`.\n    // â–  List item 1.[]\n    //     â—‹ List item 2.\n    //     â—‹ List item 3.\n    // â–  List item 4.\n    if (!listItem) {\n      listItem = changedItems[changedItems.length - 1].nextSibling;\n    }\n    // And such a list should not modify anything.\n    // However, `listItem` can indicate a node below the list. Be sure that we have the `listItem` element.\n    // â–  List item 1.[]\n    //     â—‹ List item 2.\n    //     â—‹ List item 3.\n    // <paragraph>The later if check.</paragraph>\n    if (!listItem || !listItem.is('element', 'listItem')) {\n      return;\n    }\n    // Do not modify the list if found `listItem` represents other type of list than outdented list items.\n    if (listItem.getAttribute('listType') !== listType) {\n      return;\n    }\n    editor.model.change(writer => {\n      const itemsToUpdate = changedItems.filter(item => item.getAttribute('listIndent') === indent);\n      for (const item of itemsToUpdate) {\n        for (const strategy of attributeStrategies) {\n          if (strategy.appliesToListItem(item)) {\n            const attributeName = strategy.attributeName;\n            const valueToSet = listItem.getAttribute(attributeName);\n            writer.setAttribute(attributeName, valueToSet, item);\n          }\n        }\n      }\n    });\n  };\n}\n/**\n * Each `listItem` element must have specified the `listStyle`, `listReversed` and `listStart` attributes\n * if they are enabled and supported by its `listType`.\n * This post-fixer checks whether inserted elements `listItem` elements should inherit the attribute values from\n * their sibling nodes or should use the default values.\n *\n * Paragraph[]\n * â–  List item 1. // [listStyle=\"square\", listType=\"bulleted\"]\n * â–  List item 2. // ...\n * â–  List item 3. // ...\n *\n * editor.execute( 'bulletedList' )\n *\n * â–  Paragraph[]  // [listStyle=\"square\", listType=\"bulleted\"]\n * â–  List item 1. // [listStyle=\"square\", listType=\"bulleted\"]\n * â–  List item 2.\n * â–  List item 3.\n *\n * It also covers a such change:\n *\n * [Paragraph 1\n * Paragraph 2]\n * â–  List item 1. // [listStyle=\"square\", listType=\"bulleted\"]\n * â–  List item 2. // ...\n * â–  List item 3. // ...\n *\n * editor.execute( 'numberedList' )\n *\n * 1. [Paragraph 1 // [listStyle=\"default\", listType=\"numbered\"]\n * 2. Paragraph 2] // [listStyle=\"default\", listType=\"numbered\"]\n * â–  List item 1.  // [listStyle=\"square\", listType=\"bulleted\"]\n * â–  List item 2.  // ...\n * â–  List item 3.  // ...\n */\nfunction fixListAttributesOnListItemElements(editor, attributeStrategies) {\n  return writer => {\n    let wasFixed = false;\n    const insertedListItems = getChangedListItems(editor.model.document.differ.getChanges()).filter(item => {\n      // Don't touch todo lists. They are handled in another post-fixer.\n      return item.getAttribute('listType') !== 'todo';\n    });\n    if (!insertedListItems.length) {\n      return wasFixed;\n    }\n    // Check whether the last inserted element is next to the `listItem` element.\n    //\n    // â–  Paragraph[]  // <-- The inserted item.\n    // â–  List item 1.\n    let existingListItem = insertedListItems[insertedListItems.length - 1].nextSibling;\n    // If it doesn't, maybe the `listItem` was inserted at the end of the list.\n    //\n    // â–  List item 1.\n    // â–  Paragraph[]  // <-- The inserted item.\n    if (!existingListItem || !existingListItem.is('element', 'listItem')) {\n      existingListItem = insertedListItems[0].previousSibling;\n      if (existingListItem) {\n        const indent = insertedListItems[0].getAttribute('listIndent');\n        // But we need to find a `listItem` with the `listIndent=0` attribute.\n        // If doesn't, maybe the `listItem` was inserted at the end of the list.\n        //\n        // â–  List item 1.\n        //     â—‹ List item 2.\n        // â–  Paragraph[]  // <-- The inserted item.\n        while (existingListItem.is('element', 'listItem') && existingListItem.getAttribute('listIndent') !== indent) {\n          existingListItem = existingListItem.previousSibling;\n          // If the item does not exist, most probably there is no other content in the editor. See: #8072.\n          if (!existingListItem) {\n            break;\n          }\n        }\n      }\n    }\n    for (const strategy of attributeStrategies) {\n      const attributeName = strategy.attributeName;\n      for (const item of insertedListItems) {\n        if (!strategy.appliesToListItem(item)) {\n          writer.removeAttribute(attributeName, item);\n          continue;\n        }\n        if (!item.hasAttribute(attributeName)) {\n          if (shouldInheritListType(existingListItem, item, strategy)) {\n            writer.setAttribute(attributeName, existingListItem.getAttribute(attributeName), item);\n          } else {\n            writer.setAttribute(attributeName, strategy.defaultValue, item);\n          }\n          wasFixed = true;\n        } else {\n          // Adjust the `listStyle`, `listReversed` and `listStart`\n          // attributes for inserted (pasted) items. See #8160.\n          //\n          // â–  List item 1. // [listStyle=\"square\", listType=\"bulleted\"]\n          //     â—‹ List item 1.1. // [listStyle=\"circle\", listType=\"bulleted\"]\n          //     â—‹ [] (selection is here)\n          //\n          // Then, pasting a list with different attributes (listStyle, listType):\n          //\n          // 1. First. // [listStyle=\"decimal\", listType=\"numbered\"]\n          // 2. Second // [listStyle=\"decimal\", listType=\"numbered\"]\n          //\n          // The `listType` attribute will be corrected by the `ListEditing` converters.\n          // We need to adjust the `listStyle` attribute. Expected structure:\n          //\n          // â–  List item 1. // [listStyle=\"square\", listType=\"bulleted\"]\n          //     â—‹ List item 1.1. // [listStyle=\"circle\", listType=\"bulleted\"]\n          //     â—‹ First. // [listStyle=\"circle\", listType=\"bulleted\"]\n          //     â—‹ Second // [listStyle=\"circle\", listType=\"bulleted\"]\n          const previousSibling = item.previousSibling;\n          if (shouldInheritListTypeFromPreviousItem(previousSibling, item, strategy.attributeName)) {\n            writer.setAttribute(attributeName, previousSibling.getAttribute(attributeName), item);\n            wasFixed = true;\n          }\n        }\n      }\n    }\n    return wasFixed;\n  };\n}\n/**\n * Checks whether the `listStyle`, `listReversed` and `listStart` attributes\n * should be copied from the `baseItem` element.\n *\n * The attribute should be copied if the inserted element does not have defined it and\n * the value for the element is other than default in the base element.\n */\nfunction shouldInheritListType(baseItem, itemToChange, attributeStrategy) {\n  if (!baseItem) {\n    return false;\n  }\n  const baseListAttribute = baseItem.getAttribute(attributeStrategy.attributeName);\n  if (!baseListAttribute) {\n    return false;\n  }\n  if (baseListAttribute == attributeStrategy.defaultValue) {\n    return false;\n  }\n  if (baseItem.getAttribute('listType') !== itemToChange.getAttribute('listType')) {\n    return false;\n  }\n  return true;\n}\n/**\n * Checks whether the `listStyle`, `listReversed` and `listStart` attributes\n * should be copied from previous list item.\n *\n * The attribute should be copied if there's a mismatch of styles of the pasted list into a nested list.\n * Top-level lists are not normalized as we allow side-by-side list of different types.\n */\nfunction shouldInheritListTypeFromPreviousItem(previousItem, itemToChange, attributeName) {\n  if (!previousItem || !previousItem.is('element', 'listItem')) {\n    return false;\n  }\n  if (itemToChange.getAttribute('listType') !== previousItem.getAttribute('listType')) {\n    return false;\n  }\n  const previousItemIndent = previousItem.getAttribute('listIndent');\n  if (previousItemIndent < 1 || previousItemIndent !== itemToChange.getAttribute('listIndent')) {\n    return false;\n  }\n  const previousItemListAttribute = previousItem.getAttribute(attributeName);\n  if (!previousItemListAttribute || previousItemListAttribute === itemToChange.getAttribute(attributeName)) {\n    return false;\n  }\n  return true;\n}\n/**\n * Removes the `listStyle`, `listReversed` and `listStart` attributes from \"todo\" list items.\n */\nfunction removeListItemAttributesFromTodoList(editor) {\n  return writer => {\n    const todoListItems = getChangedListItems(editor.model.document.differ.getChanges()).filter(item => {\n      // Handle the todo lists only. The rest is handled in another post-fixer.\n      return item.getAttribute('listType') === 'todo' && (item.hasAttribute('listStyle') || item.hasAttribute('listReversed') || item.hasAttribute('listStart'));\n    });\n    if (!todoListItems.length) {\n      return false;\n    }\n    for (const item of todoListItems) {\n      writer.removeAttribute('listStyle', item);\n      writer.removeAttribute('listReversed', item);\n      writer.removeAttribute('listStart', item);\n    }\n    return true;\n  };\n}\n/**\n * Restores the `listStyle` attribute after changing the list type.\n */\nfunction restoreDefaultListStyle(editor) {\n  return (evt, changedItems) => {\n    changedItems = changedItems.filter(item => item.is('element', 'listItem'));\n    editor.model.change(writer => {\n      for (const item of changedItems) {\n        // Remove the attribute. Post-fixer will restore the proper value.\n        writer.removeAttribute('listStyle', item);\n      }\n    });\n  };\n}\n/**\n * Returns the `listItem` that was inserted or changed.\n *\n * @param changes The changes list returned by the differ.\n */\nfunction getChangedListItems(changes) {\n  const items = [];\n  for (const change of changes) {\n    const item = getItemFromChange(change);\n    if (item && item.is('element', 'listItem')) {\n      items.push(item);\n    }\n  }\n  return items;\n}\nfunction getItemFromChange(change) {\n  if (change.type === 'attribute') {\n    return change.range.start.nodeAfter;\n  }\n  if (change.type === 'insert') {\n    return change.position.nodeAfter;\n  }\n  return null;\n}\n\n/**\n * The legacy list properties feature.\n *\n * This is a \"glue\" plugin that loads the {@link module:list/legacylistproperties/legacylistpropertiesediting~LegacyListPropertiesEditing\n * legacy list properties editing feature} and the\n * {@link module:list/listproperties/listpropertiesui~ListPropertiesUI list properties UI feature}.\n */\nclass LegacyListProperties extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [LegacyListPropertiesEditing, ListPropertiesUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LegacyListProperties';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nconst attributeKey = 'todoListChecked';\n/**\n * The check to-do command.\n *\n * The command is registered by the {@link module:list/legacytodolist/legacytodolistediting~LegacyTodoListEditing} as\n * the `checkTodoList` editor command and it is also available via aliased `todoListCheck` name.\n */\nclass LegacyCheckTodoListCommand extends Command {\n  /**\n  * A list of to-do list items selected by the {@link module:engine/model/selection~Selection}.\n  *\n  * @internal\n  */\n  _selectedElements;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._selectedElements = [];\n    // Refresh command before executing to be sure all values are up to date.\n    // It is needed when selection has changed before command execution, in the same change block.\n    this.on('execute', () => {\n      this.refresh();\n    }, {\n      priority: 'highest'\n    });\n  }\n  /**\n  * Updates the command's {@link #value} and {@link #isEnabled} properties based on the current selection.\n  */\n  refresh() {\n    this._selectedElements = this._getSelectedItems();\n    this.value = this._selectedElements.every(element => !!element.getAttribute(attributeKey));\n    this.isEnabled = !!this._selectedElements.length;\n  }\n  /**\n  * Gets all to-do list items selected by the {@link module:engine/model/selection~Selection}.\n  */\n  _getSelectedItems() {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const selectionRange = model.document.selection.getFirstRange();\n    const startElement = selectionRange.start.parent;\n    const elements = [];\n    if (schema.checkAttribute(startElement, attributeKey)) {\n      elements.push(startElement);\n    }\n    for (const item of selectionRange.getItems()) {\n      if (schema.checkAttribute(item, attributeKey) && !elements.includes(item)) {\n        elements.push(item);\n      }\n    }\n    return elements;\n  }\n  /**\n  * Executes the command.\n  *\n  * @param options.forceValue If set, it will force the command behavior. If `true`, the command will apply\n  * the attribute. Otherwise, the command will remove the attribute. If not set, the command will look for its current\n  * value to decide what it should do.\n  */\n  execute(options = {}) {\n    this.editor.model.change(writer => {\n      for (const element of this._selectedElements) {\n        const value = options.forceValue === undefined ? !this.value : options.forceValue;\n        if (value) {\n          writer.setAttribute(attributeKey, true, element);\n        } else {\n          writer.removeAttribute(attributeKey, element);\n        }\n      }\n    });\n  }\n}\n\n/**\n * A model-to-view converter for the `listItem` model element insertion.\n *\n * It converts the `listItem` model element to an unordered list with a {@link module:engine/view/uielement~UIElement checkbox element}\n * at the beginning of each list item. It also merges the list with surrounding lists (if available).\n *\n * It is used by {@link module:engine/controller/editingcontroller~EditingController}.\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:insert\n * @param model Model instance.\n * @param onCheckboxChecked Callback function.\n * @returns Returns a conversion callback.\n */\nfunction modelViewInsertion(model, onCheckboxChecked) {\n  return (evt, data, conversionApi) => {\n    const consumable = conversionApi.consumable;\n    if (!consumable.test(data.item, 'insert') || !consumable.test(data.item, 'attribute:listType') || !consumable.test(data.item, 'attribute:listIndent')) {\n      return;\n    }\n    if (data.item.getAttribute('listType') != 'todo') {\n      return;\n    }\n    const modelItem = data.item;\n    consumable.consume(modelItem, 'insert');\n    consumable.consume(modelItem, 'attribute:listType');\n    consumable.consume(modelItem, 'attribute:listIndent');\n    consumable.consume(modelItem, 'attribute:todoListChecked');\n    const viewWriter = conversionApi.writer;\n    const viewItem = generateLiInUl(modelItem, conversionApi);\n    const isChecked = !!modelItem.getAttribute('todoListChecked');\n    const checkmarkElement = createCheckmarkElement(modelItem, viewWriter, isChecked, onCheckboxChecked);\n    const span = viewWriter.createContainerElement('span', {\n      class: 'todo-list__label__description'\n    });\n    viewWriter.addClass('todo-list', viewItem.parent);\n    viewWriter.insert(viewWriter.createPositionAt(viewItem, 0), checkmarkElement);\n    viewWriter.insert(viewWriter.createPositionAfter(checkmarkElement), span);\n    injectViewList(modelItem, viewItem, conversionApi, model);\n  };\n}\n/**\n * A model-to-view converter for the `listItem` model element insertion.\n *\n * It is used by {@link module:engine/controller/datacontroller~DataController}.\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:insert\n * @param model Model instance.\n * @returns Returns a conversion callback.\n */\nfunction dataModelViewInsertion(model) {\n  return (evt, data, conversionApi) => {\n    const consumable = conversionApi.consumable;\n    if (!consumable.test(data.item, 'insert') || !consumable.test(data.item, 'attribute:listType') || !consumable.test(data.item, 'attribute:listIndent')) {\n      return;\n    }\n    if (data.item.getAttribute('listType') != 'todo') {\n      return;\n    }\n    const modelItem = data.item;\n    consumable.consume(modelItem, 'insert');\n    consumable.consume(modelItem, 'attribute:listType');\n    consumable.consume(modelItem, 'attribute:listIndent');\n    consumable.consume(modelItem, 'attribute:todoListChecked');\n    const viewWriter = conversionApi.writer;\n    const viewItem = generateLiInUl(modelItem, conversionApi);\n    viewWriter.addClass('todo-list', viewItem.parent);\n    const label = viewWriter.createContainerElement('label', {\n      class: 'todo-list__label'\n    });\n    const checkbox = viewWriter.createEmptyElement('input', {\n      type: 'checkbox',\n      disabled: 'disabled'\n    });\n    const span = viewWriter.createContainerElement('span', {\n      class: 'todo-list__label__description'\n    });\n    if (modelItem.getAttribute('todoListChecked')) {\n      viewWriter.setAttribute('checked', 'checked', checkbox);\n    }\n    viewWriter.insert(viewWriter.createPositionAt(viewItem, 0), label);\n    viewWriter.insert(viewWriter.createPositionAt(label, 0), checkbox);\n    viewWriter.insert(viewWriter.createPositionAfter(checkbox), span);\n    injectViewList(modelItem, viewItem, conversionApi, model);\n  };\n}\n/**\n * A view-to-model converter for the checkbox element inside a view list item.\n *\n * It changes the `listType` of the model `listItem` to a `todo` value.\n * When a view checkbox element is marked as checked, an additional `todoListChecked=\"true\"` attribute is added to the model item.\n *\n * It is used by {@link module:engine/controller/datacontroller~DataController}.\n *\n * @see module:engine/conversion/upcastdispatcher~UpcastDispatcher#event:element\n */\nconst dataViewModelCheckmarkInsertion = (evt, data, conversionApi) => {\n  const modelCursor = data.modelCursor;\n  const modelItem = modelCursor.parent;\n  const viewItem = data.viewItem;\n  if (viewItem.getAttribute('type') != 'checkbox' || modelItem.name != 'listItem' || !modelCursor.isAtStart) {\n    return;\n  }\n  if (!conversionApi.consumable.consume(viewItem, {\n    name: true\n  })) {\n    return;\n  }\n  const writer = conversionApi.writer;\n  writer.setAttribute('listType', 'todo', modelItem);\n  if (data.viewItem.hasAttribute('checked')) {\n    writer.setAttribute('todoListChecked', true, modelItem);\n  }\n  data.modelRange = writer.createRange(modelCursor);\n};\n/**\n * A model-to-view converter for the `listType` attribute change on the `listItem` model element.\n *\n * This change means that the `<li>` element parent changes to `<ul class=\"todo-list\">` and a\n * {@link module:engine/view/uielement~UIElement checkbox UI element} is added at the beginning\n * of the list item element (or vice versa).\n *\n * This converter is preceded by {@link module:list/legacylist/legacyconverters~modelViewChangeType} and followed by\n * {@link module:list/legacylist/legacyconverters~modelViewMergeAfterChangeType} to handle splitting and merging surrounding lists\n * of the same type.\n *\n * It is used by {@link module:engine/controller/editingcontroller~EditingController}.\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:attribute\n * @param onCheckedChange Callback fired after clicking the checkbox UI element.\n * @param view Editing view controller.\n * @returns Returns a conversion callback.\n */\nfunction modelViewChangeType(onCheckedChange, view) {\n  return (evt, data, conversionApi) => {\n    if (!conversionApi.consumable.consume(data.item, evt.name)) {\n      return;\n    }\n    const viewItem = conversionApi.mapper.toViewElement(data.item);\n    const viewWriter = conversionApi.writer;\n    const labelElement = findLabel(viewItem, view);\n    if (data.attributeNewValue == 'todo') {\n      const isChecked = !!data.item.getAttribute('todoListChecked');\n      const checkmarkElement = createCheckmarkElement(data.item, viewWriter, isChecked, onCheckedChange);\n      const span = viewWriter.createContainerElement('span', {\n        class: 'todo-list__label__description'\n      });\n      const itemRange = viewWriter.createRangeIn(viewItem);\n      const nestedList = findNestedList(viewItem);\n      const descriptionStart = positionAfterUiElements(itemRange.start);\n      const descriptionEnd = nestedList ? viewWriter.createPositionBefore(nestedList) : itemRange.end;\n      const descriptionRange = viewWriter.createRange(descriptionStart, descriptionEnd);\n      viewWriter.addClass('todo-list', viewItem.parent);\n      viewWriter.move(descriptionRange, viewWriter.createPositionAt(span, 0));\n      viewWriter.insert(viewWriter.createPositionAt(viewItem, 0), checkmarkElement);\n      viewWriter.insert(viewWriter.createPositionAfter(checkmarkElement), span);\n    } else if (data.attributeOldValue == 'todo') {\n      const descriptionSpan = findDescription(viewItem, view);\n      viewWriter.removeClass('todo-list', viewItem.parent);\n      viewWriter.remove(labelElement);\n      viewWriter.move(viewWriter.createRangeIn(descriptionSpan), viewWriter.createPositionBefore(descriptionSpan));\n      viewWriter.remove(descriptionSpan);\n    }\n  };\n}\n/**\n * A model-to-view converter for the `todoListChecked` attribute change on the `listItem` model element.\n *\n * It marks the {@link module:engine/view/uielement~UIElement checkbox UI element} as checked.\n *\n * It is used by {@link module:engine/controller/editingcontroller~EditingController}.\n *\n * @see module:engine/conversion/downcastdispatcher~DowncastDispatcher#event:attribute\n * @param onCheckedChange Callback fired after clicking the checkbox UI element.\n * @returns Returns a conversion callback.\n */\nfunction modelViewChangeChecked(onCheckedChange) {\n  return (evt, data, conversionApi) => {\n    // Do not convert `todoListChecked` attribute when to-do list item has changed to other list item.\n    // This attribute will be removed by the model post fixer.\n    if (data.item.getAttribute('listType') != 'todo') {\n      return;\n    }\n    if (!conversionApi.consumable.consume(data.item, 'attribute:todoListChecked')) {\n      return;\n    }\n    const {\n      mapper,\n      writer: viewWriter\n    } = conversionApi;\n    const isChecked = !!data.item.getAttribute('todoListChecked');\n    const viewItem = mapper.toViewElement(data.item);\n    // Because of m -> v position mapper we can be sure checkbox is always at the beginning.\n    const oldCheckmarkElement = viewItem.getChild(0);\n    const newCheckmarkElement = createCheckmarkElement(data.item, viewWriter, isChecked, onCheckedChange);\n    viewWriter.insert(viewWriter.createPositionAfter(oldCheckmarkElement), newCheckmarkElement);\n    viewWriter.remove(oldCheckmarkElement);\n  };\n}\n/**\n * A model-to-view position at zero offset mapper.\n *\n * This helper ensures that position inside todo-list in the view is mapped after the checkbox.\n *\n * It only handles the position at the beginning of a list item as other positions are properly mapped be the default mapper.\n */\nfunction mapModelToViewPosition(view) {\n  return (evt, data) => {\n    const modelPosition = data.modelPosition;\n    const parent = modelPosition.parent;\n    if (!parent.is('element', 'listItem') || parent.getAttribute('listType') != 'todo') {\n      return;\n    }\n    const viewLi = data.mapper.toViewElement(parent);\n    const descSpan = findDescription(viewLi, view);\n    if (descSpan) {\n      data.viewPosition = data.mapper.findPositionIn(descSpan, modelPosition.offset);\n    }\n  };\n}\n/**\n * Creates a checkbox UI element.\n */\nfunction createCheckmarkElement(modelItem, viewWriter, isChecked, onChange) {\n  const uiElement = viewWriter.createUIElement('label', {\n    class: 'todo-list__label',\n    contenteditable: false\n  }, function (domDocument) {\n    const checkbox = createElement(document, 'input', {\n      type: 'checkbox',\n      tabindex: '-1'\n    });\n    if (isChecked) {\n      checkbox.setAttribute('checked', 'checked');\n    }\n    checkbox.addEventListener('change', () => onChange(modelItem));\n    const domElement = this.toDomElement(domDocument);\n    domElement.appendChild(checkbox);\n    return domElement;\n  });\n  return uiElement;\n}\n// Helper method to find label element inside li.\nfunction findLabel(viewItem, view) {\n  const range = view.createRangeIn(viewItem);\n  for (const value of range) {\n    if (value.item.is('uiElement', 'label')) {\n      return value.item;\n    }\n  }\n}\nfunction findDescription(viewItem, view) {\n  const range = view.createRangeIn(viewItem);\n  for (const value of range) {\n    if (value.item.is('containerElement', 'span') && value.item.hasClass('todo-list__label__description')) {\n      return value.item;\n    }\n  }\n}\nconst ITEM_TOGGLE_KEYSTROKE = /* #__PURE__ */parseKeystroke('Ctrl+Enter');\n/**\n * The engine of the to-do list feature. It handles creating, editing and removing to-do lists and their items.\n *\n * It registers the entire functionality of the {@link module:list/legacylist/legacylistediting~LegacyListEditing legacy list editing\n * plugin} and extends it with the commands:\n *\n * - `'todoList'`,\n * - `'checkTodoList'`,\n * - `'todoListCheck'` as an alias for `checkTodoList` command.\n */\nclass LegacyTodoListEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LegacyTodoListEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [LegacyListEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const {\n      editing,\n      data,\n      model\n    } = editor;\n    // Extend schema.\n    model.schema.extend('listItem', {\n      allowAttributes: ['todoListChecked']\n    });\n    // Disallow todoListChecked attribute on other nodes than listItem with to-do listType.\n    model.schema.addAttributeCheck((context, attributeName) => {\n      const item = context.last;\n      if (attributeName == 'todoListChecked' && item.name == 'listItem' && item.getAttribute('listType') != 'todo') {\n        return false;\n      }\n    });\n    // Register `todoList` command.\n    editor.commands.add('todoList', new LegacyListCommand(editor, 'todo'));\n    const checkTodoListCommand = new LegacyCheckTodoListCommand(editor);\n    // Register `checkTodoList` command and add `todoListCheck` command as an alias for backward compatibility.\n    editor.commands.add('checkTodoList', checkTodoListCommand);\n    editor.commands.add('todoListCheck', checkTodoListCommand);\n    // Define converters.\n    data.downcastDispatcher.on('insert:listItem', dataModelViewInsertion(model), {\n      priority: 'high'\n    });\n    data.upcastDispatcher.on('element:input', dataViewModelCheckmarkInsertion, {\n      priority: 'high'\n    });\n    editing.downcastDispatcher.on('insert:listItem', modelViewInsertion(model, listItem => this._handleCheckmarkChange(listItem)), {\n      priority: 'high'\n    });\n    editing.downcastDispatcher.on('attribute:listType:listItem', modelViewChangeType(listItem => this._handleCheckmarkChange(listItem), editing.view));\n    editing.downcastDispatcher.on('attribute:todoListChecked:listItem', modelViewChangeChecked(listItem => this._handleCheckmarkChange(listItem)));\n    editing.mapper.on('modelToViewPosition', mapModelToViewPosition(editing.view));\n    data.mapper.on('modelToViewPosition', mapModelToViewPosition(editing.view));\n    // Jump at the end of the previous node on left arrow key press, when selection is after the checkbox.\n    //\n    // <blockquote><p>Foo</p></blockquote>\n    // <ul><li><checkbox/>{}Bar</li></ul>\n    //\n    // press: `<-`\n    //\n    // <blockquote><p>Foo{}</p></blockquote>\n    // <ul><li><checkbox/>Bar</li></ul>\n    //\n    this.listenTo(editing.view.document, 'arrowKey', jumpOverCheckmarkOnSideArrowKeyPress(model, editor.locale), {\n      context: 'li'\n    });\n    // Toggle check state of selected to-do list items on keystroke.\n    this.listenTo(editing.view.document, 'keydown', (evt, data) => {\n      if (getCode(data) === ITEM_TOGGLE_KEYSTROKE) {\n        editor.execute('checkTodoList');\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    // Remove `todoListChecked` attribute when a host element is no longer a to-do list item.\n    const listItemsToFix = new Set();\n    this.listenTo(model, 'applyOperation', (evt, args) => {\n      const operation = args[0];\n      if (operation.type == 'rename' && operation.oldName == 'listItem') {\n        const item = operation.position.nodeAfter;\n        if (item.hasAttribute('todoListChecked')) {\n          listItemsToFix.add(item);\n        }\n      } else if (operation.type == 'changeAttribute' && operation.key == 'listType' && operation.oldValue === 'todo') {\n        for (const item of operation.range.getItems()) {\n          if (item.hasAttribute('todoListChecked') && item.getAttribute('listType') !== 'todo') {\n            listItemsToFix.add(item);\n          }\n        }\n      }\n    });\n    model.document.registerPostFixer(writer => {\n      let hasChanged = false;\n      for (const listItem of listItemsToFix) {\n        writer.removeAttribute('todoListChecked', listItem);\n        hasChanged = true;\n      }\n      listItemsToFix.clear();\n      return hasChanged;\n    });\n    this._initAriaAnnouncements();\n  }\n  /**\n  * Handles the checkbox element change, moves the selection to the corresponding model item to make it possible\n  * to toggle the `todoListChecked` attribute using the command, and restores the selection position.\n  *\n  * Some say it's a hack :) Moving the selection only for executing the command on a certain node and restoring it after,\n  * is not a clear solution. We need to design an API for using commands beyond the selection range.\n  * See https://github.com/ckeditor/ckeditor5/issues/1954.\n  */\n  _handleCheckmarkChange(listItem) {\n    const editor = this.editor;\n    const model = editor.model;\n    const previousSelectionRanges = Array.from(model.document.selection.getRanges());\n    model.change(writer => {\n      writer.setSelection(listItem, 'end');\n      editor.execute('checkTodoList');\n      writer.setSelection(previousSelectionRanges);\n    });\n  }\n  /**\n  * Observe when user enters or leaves todo list and set proper aria value in global live announcer.\n  * This allows screen readers to indicate when the user has entered and left the specified todo list.\n  *\n  * @internal\n  */\n  _initAriaAnnouncements() {\n    const {\n      model,\n      ui,\n      t\n    } = this.editor;\n    let lastFocusedCodeBlock = null;\n    if (!ui) {\n      return;\n    }\n    model.document.selection.on('change:range', () => {\n      const focusParent = model.document.selection.focus.parent;\n      const lastElementIsTodoList = isLegacyTodoListItemElement(lastFocusedCodeBlock);\n      const currentElementIsTodoList = isLegacyTodoListItemElement(focusParent);\n      if (lastElementIsTodoList && !currentElementIsTodoList) {\n        ui.ariaLiveAnnouncer.announce(t('Leaving a to-do list'));\n      } else if (!lastElementIsTodoList && currentElementIsTodoList) {\n        ui.ariaLiveAnnouncer.announce(t('Entering a to-do list'));\n      }\n      lastFocusedCodeBlock = focusParent;\n    });\n  }\n}\n/**\n * Handles the left/right (LTR/RTL content) arrow key and moves the selection at the end of the previous block element\n * if the selection is just after the checkbox element. In other words, it jumps over the checkbox element when\n * moving the selection to the left/right (LTR/RTL).\n *\n * @returns Callback for 'keydown' events.\n */\nfunction jumpOverCheckmarkOnSideArrowKeyPress(model, locale) {\n  return (eventInfo, domEventData) => {\n    const direction = getLocalizedArrowKeyCodeDirection(domEventData.keyCode, locale.contentLanguageDirection);\n    if (direction != 'left') {\n      return;\n    }\n    const schema = model.schema;\n    const selection = model.document.selection;\n    if (!selection.isCollapsed) {\n      return;\n    }\n    const position = selection.getFirstPosition();\n    const parent = position.parent;\n    if (parent.name === 'listItem' && parent.getAttribute('listType') == 'todo' && position.isAtStart) {\n      const newRange = schema.getNearestSelectionRange(model.createPositionBefore(parent), 'backward');\n      if (newRange) {\n        model.change(writer => writer.setSelection(newRange));\n      }\n      domEventData.preventDefault();\n      domEventData.stopPropagation();\n      eventInfo.stop();\n    }\n  };\n}\n/**\n * Returns true if the given element is a list item model element of a to-do list.\n */\nfunction isLegacyTodoListItemElement(element) {\n  return !!element && element.is('element', 'listItem') && element.getAttribute('listType') === 'todo';\n}\n\n/**\n * The legacy to-do list feature.\n *\n * This is a \"glue\" plugin that loads the {@link module:list/legacytodolist/legacytodolistediting~LegacyTodoListEditing legacy to-do list\n * editing feature} and the {@link module:list/todolist/todolistui~TodoListUI to-do list UI feature}.\n */\nclass LegacyTodoList extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [LegacyTodoListEditing, TodoListUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LegacyTodoList';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nclass AdjacentListsSupport extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'AdjacentListsSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const model = editor.model;\n    model.schema.register('listSeparator', {\n      allowWhere: '$block',\n      isBlock: true\n    });\n    editor.conversion.for('upcast') // Add a list separator element between similar list elements on upcast.\n    .add(dispatcher => {\n      dispatcher.on('element:ol', listSeparatorUpcastConverter());\n      dispatcher.on('element:ul', listSeparatorUpcastConverter());\n    }) // View-to-model transformation.\n    .elementToElement({\n      model: 'listSeparator',\n      view: 'ck-list-separator'\n    });\n    // The list separator element should exist in the view, but should be invisible (hidden).\n    editor.conversion.for('editingDowncast').elementToElement({\n      model: 'listSeparator',\n      view: {\n        name: 'div',\n        classes: ['ck-list-separator', 'ck-hidden']\n      }\n    });\n    // The list separator element should not exist in the output data.\n    editor.conversion.for('dataDowncast').elementToElement({\n      model: 'listSeparator',\n      view: (modelElement, conversionApi) => {\n        const viewElement = conversionApi.writer.createContainerElement('ck-list-separator');\n        conversionApi.writer.setCustomProperty('dataPipeline:transparentRendering', true, viewElement);\n        viewElement.getFillerOffset = () => null;\n        return viewElement;\n      }\n    });\n  }\n}\n/**\n * Inserts a list separator element between two lists of the same type (`ol` + `ol` or `ul` + `ul`).\n */\nfunction listSeparatorUpcastConverter() {\n  return (evt, data, conversionApi) => {\n    const element = data.viewItem;\n    const nextSibling = element.nextSibling;\n    if (!nextSibling) {\n      return;\n    }\n    if (element.name !== nextSibling.name) {\n      return;\n    }\n    if (!data.modelRange) {\n      Object.assign(data, conversionApi.convertChildren(data.viewItem, data.modelCursor));\n    }\n    const writer = conversionApi.writer;\n    const modelElement = writer.createElement('listSeparator');\n    // Try to insert a list separator element on the current model cursor position.\n    if (!conversionApi.safeInsert(modelElement, data.modelCursor)) {\n      return;\n    }\n    const parts = conversionApi.getSplitParts(modelElement);\n    // Extend the model range with the range of the created list separator element.\n    data.modelRange = writer.createRange(data.modelRange.start, writer.createPositionAfter(parts[parts.length - 1]));\n    conversionApi.updateConversionResult(modelElement, data);\n  };\n}\n\n/**\n * The document list feature.\n *\n * This is an obsolete plugin that exists for backward compatibility only.\n * Use the {@link module:list/list~List `List`} instead.\n *\n * @deprecated\n */\nclass DocumentList extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [List];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'DocumentList';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  constructor(editor) {\n    super(editor);\n    /**\n    * The `DocumentList` plugin is obsolete. Use `List` instead.\n    *\n    * @error plugin-obsolete-documentlist\n    */\n    logWarning('plugin-obsolete-documentlist', {\n      pluginName: 'DocumentList'\n    });\n  }\n}\n\n/**\n * The document list properties feature.\n *\n * This is an obsolete plugin that exists for backward compatibility only.\n * Use the {@link module:list/listproperties~ListProperties `ListProperties`} instead.\n *\n * @deprecated\n */\nclass DocumentListProperties extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ListProperties];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'DocumentListProperties';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  constructor(editor) {\n    super(editor);\n    /**\n    * The `DocumentListProperties` plugin is obsolete. Use `ListProperties` instead.\n    *\n    * @error plugin-obsolete-documentlistproperties\n    */\n    logWarning('plugin-obsolete-documentlistproperties', {\n      pluginName: 'DocumentListProperties'\n    });\n  }\n}\n\n/**\n * The to-do list feature.\n *\n * This is an obsolete plugin that exists for backward compatibility only.\n * Use the {@link module:list/todolist~TodoList `TodoList`} instead.\n *\n * @deprecated\n */\nclass TodoDocumentList extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TodoList];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TodoDocumentList';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  constructor(editor) {\n    super(editor);\n    /**\n    * The `TodoDocumentList` plugin is obsolete. Use `TodoList` instead.\n    *\n    * @error plugin-obsolete-tododocumentlist\n    */\n    logWarning('plugin-obsolete-tododocumentlist', {\n      pluginName: 'TodoDocumentList'\n    });\n  }\n}\nexport { AdjacentListsSupport, DocumentList, DocumentListProperties, LegacyIndentCommand, LegacyList, LegacyListEditing, LegacyListProperties, LegacyListPropertiesEditing, LegacyListUtils, LegacyTodoList, LegacyTodoListEditing, List, ListCommand, ListEditing, ListIndentCommand, ListProperties, ListPropertiesEditing, ListPropertiesUI, ListPropertiesUtils, ListUI, ListUtils, TodoDocumentList, TodoList, TodoListEditing, TodoListUI };\n", "/**\n * marked - a markdown parser\n * Copyright (c) 2011-2022, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * DO NOT EDIT THIS FILE\n * The code in this file is generated from files in ./src/\n */\n\nfunction getDefaults() {\n  return {\n    baseUrl: null,\n    breaks: false,\n    extensions: null,\n    gfm: true,\n    headerIds: true,\n    headerPrefix: '',\n    highlight: null,\n    langPrefix: 'language-',\n    mangle: true,\n    pedantic: false,\n    renderer: null,\n    sanitize: false,\n    sanitizer: null,\n    silent: false,\n    smartLists: false,\n    smartypants: false,\n    tokenizer: null,\n    walkTokens: null,\n    xhtml: false\n  };\n}\nlet defaults = getDefaults();\nfunction changeDefaults(newDefaults) {\n  defaults = newDefaults;\n}\n\n/**\n * Helpers\n */\nconst escapeTest = /[&<>\"']/;\nconst escapeReplace = /[&<>\"']/g;\nconst escapeTestNoEncode = /[<>\"']|&(?!#?\\w+;)/;\nconst escapeReplaceNoEncode = /[<>\"']|&(?!#?\\w+;)/g;\nconst escapeReplacements = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\nconst getEscapeReplacement = ch => escapeReplacements[ch];\nfunction escape(html, encode) {\n  if (encode) {\n    if (escapeTest.test(html)) {\n      return html.replace(escapeReplace, getEscapeReplacement);\n    }\n  } else {\n    if (escapeTestNoEncode.test(html)) {\n      return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n    }\n  }\n  return html;\n}\nconst unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\nfunction unescape(html) {\n  // explicitly match decimal, hex, and named HTML entities\n  return html.replace(unescapeTest, (_, n) => {\n    n = n.toLowerCase();\n    if (n === 'colon') return ':';\n    if (n.charAt(0) === '#') {\n      return n.charAt(1) === 'x' ? String.fromCharCode(parseInt(n.substring(2), 16)) : String.fromCharCode(+n.substring(1));\n    }\n    return '';\n  });\n}\nconst caret = /(^|[^\\[])\\^/g;\nfunction edit(regex, opt) {\n  regex = regex.source || regex;\n  opt = opt || '';\n  const obj = {\n    replace: (name, val) => {\n      val = val.source || val;\n      val = val.replace(caret, '$1');\n      regex = regex.replace(name, val);\n      return obj;\n    },\n    getRegex: () => {\n      return new RegExp(regex, opt);\n    }\n  };\n  return obj;\n}\nconst nonWordAndColonTest = /[^\\w:]/g;\nconst originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;\nfunction cleanUrl(sanitize, base, href) {\n  if (sanitize) {\n    let prot;\n    try {\n      prot = decodeURIComponent(unescape(href)).replace(nonWordAndColonTest, '').toLowerCase();\n    } catch (e) {\n      return null;\n    }\n    if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {\n      return null;\n    }\n  }\n  if (base && !originIndependentUrl.test(href)) {\n    href = resolveUrl(base, href);\n  }\n  try {\n    href = encodeURI(href).replace(/%25/g, '%');\n  } catch (e) {\n    return null;\n  }\n  return href;\n}\nconst baseUrls = {};\nconst justDomain = /^[^:]+:\\/*[^/]*$/;\nconst protocol = /^([^:]+:)[\\s\\S]*$/;\nconst domain = /^([^:]+:\\/*[^/]*)[\\s\\S]*$/;\nfunction resolveUrl(base, href) {\n  if (!baseUrls[' ' + base]) {\n    // we can ignore everything in base after the last slash of its path component,\n    // but we might need to add _that_\n    // https://tools.ietf.org/html/rfc3986#section-3\n    if (justDomain.test(base)) {\n      baseUrls[' ' + base] = base + '/';\n    } else {\n      baseUrls[' ' + base] = rtrim(base, '/', true);\n    }\n  }\n  base = baseUrls[' ' + base];\n  const relativeBase = base.indexOf(':') === -1;\n  if (href.substring(0, 2) === '//') {\n    if (relativeBase) {\n      return href;\n    }\n    return base.replace(protocol, '$1') + href;\n  } else if (href.charAt(0) === '/') {\n    if (relativeBase) {\n      return href;\n    }\n    return base.replace(domain, '$1') + href;\n  } else {\n    return base + href;\n  }\n}\nconst noopTest = {\n  exec: function noopTest() {}\n};\nfunction merge(obj) {\n  let i = 1,\n    target,\n    key;\n  for (; i < arguments.length; i++) {\n    target = arguments[i];\n    for (key in target) {\n      if (Object.prototype.hasOwnProperty.call(target, key)) {\n        obj[key] = target[key];\n      }\n    }\n  }\n  return obj;\n}\nfunction splitCells(tableRow, count) {\n  // ensure that every cell-delimiting pipe has a space\n  // before it to distinguish it from an escaped pipe\n  const row = tableRow.replace(/\\|/g, (match, offset, str) => {\n      let escaped = false,\n        curr = offset;\n      while (--curr >= 0 && str[curr] === '\\\\') escaped = !escaped;\n      if (escaped) {\n        // odd number of slashes means | is escaped\n        // so we leave it alone\n        return '|';\n      } else {\n        // add space before unescaped |\n        return ' |';\n      }\n    }),\n    cells = row.split(/ \\|/);\n  let i = 0;\n\n  // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n  if (!cells[0].trim()) {\n    cells.shift();\n  }\n  if (cells.length > 0 && !cells[cells.length - 1].trim()) {\n    cells.pop();\n  }\n  if (cells.length > count) {\n    cells.splice(count);\n  } else {\n    while (cells.length < count) cells.push('');\n  }\n  for (; i < cells.length; i++) {\n    // leading or trailing whitespace is ignored per the gfm spec\n    cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n  }\n  return cells;\n}\n\n// Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n// /c*$/ is vulnerable to REDOS.\n// invert: Remove suffix of non-c chars instead. Default falsey.\nfunction rtrim(str, c, invert) {\n  const l = str.length;\n  if (l === 0) {\n    return '';\n  }\n\n  // Length of suffix matching the invert condition.\n  let suffLen = 0;\n\n  // Step left until we fail to match the invert condition.\n  while (suffLen < l) {\n    const currChar = str.charAt(l - suffLen - 1);\n    if (currChar === c && !invert) {\n      suffLen++;\n    } else if (currChar !== c && invert) {\n      suffLen++;\n    } else {\n      break;\n    }\n  }\n  return str.substr(0, l - suffLen);\n}\nfunction findClosingBracket(str, b) {\n  if (str.indexOf(b[1]) === -1) {\n    return -1;\n  }\n  const l = str.length;\n  let level = 0,\n    i = 0;\n  for (; i < l; i++) {\n    if (str[i] === '\\\\') {\n      i++;\n    } else if (str[i] === b[0]) {\n      level++;\n    } else if (str[i] === b[1]) {\n      level--;\n      if (level < 0) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\nfunction checkSanitizeDeprecation(opt) {\n  if (opt && opt.sanitize && !opt.silent) {\n    console.warn('marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options');\n  }\n}\n\n// copied from https://stackoverflow.com/a/5450113/806777\nfunction repeatString(pattern, count) {\n  if (count < 1) {\n    return '';\n  }\n  let result = '';\n  while (count > 1) {\n    if (count & 1) {\n      result += pattern;\n    }\n    count >>= 1;\n    pattern += pattern;\n  }\n  return result + pattern;\n}\nfunction outputLink(cap, link, raw, lexer) {\n  const href = link.href;\n  const title = link.title ? escape(link.title) : null;\n  const text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n  if (cap[0].charAt(0) !== '!') {\n    lexer.state.inLink = true;\n    const token = {\n      type: 'link',\n      raw,\n      href,\n      title,\n      text,\n      tokens: lexer.inlineTokens(text, [])\n    };\n    lexer.state.inLink = false;\n    return token;\n  } else {\n    return {\n      type: 'image',\n      raw,\n      href,\n      title,\n      text: escape(text)\n    };\n  }\n}\nfunction indentCodeCompensation(raw, text) {\n  const matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n  if (matchIndentToCode === null) {\n    return text;\n  }\n  const indentToCode = matchIndentToCode[1];\n  return text.split('\\n').map(node => {\n    const matchIndentInNode = node.match(/^\\s+/);\n    if (matchIndentInNode === null) {\n      return node;\n    }\n    const [indentInNode] = matchIndentInNode;\n    if (indentInNode.length >= indentToCode.length) {\n      return node.slice(indentToCode.length);\n    }\n    return node;\n  }).join('\\n');\n}\n\n/**\n * Tokenizer\n */\nclass Tokenizer {\n  constructor(options) {\n    this.options = options || defaults;\n  }\n  space(src) {\n    const cap = this.rules.block.newline.exec(src);\n    if (cap && cap[0].length > 0) {\n      return {\n        type: 'space',\n        raw: cap[0]\n      };\n    }\n  }\n  code(src) {\n    const cap = this.rules.block.code.exec(src);\n    if (cap) {\n      const text = cap[0].replace(/^ {1,4}/gm, '');\n      return {\n        type: 'code',\n        raw: cap[0],\n        codeBlockStyle: 'indented',\n        text: !this.options.pedantic ? rtrim(text, '\\n') : text\n      };\n    }\n  }\n  fences(src) {\n    const cap = this.rules.block.fences.exec(src);\n    if (cap) {\n      const raw = cap[0];\n      const text = indentCodeCompensation(raw, cap[3] || '');\n      return {\n        type: 'code',\n        raw,\n        lang: cap[2] ? cap[2].trim() : cap[2],\n        text\n      };\n    }\n  }\n  heading(src) {\n    const cap = this.rules.block.heading.exec(src);\n    if (cap) {\n      let text = cap[2].trim();\n\n      // remove trailing #s\n      if (/#$/.test(text)) {\n        const trimmed = rtrim(text, '#');\n        if (this.options.pedantic) {\n          text = trimmed.trim();\n        } else if (!trimmed || / $/.test(trimmed)) {\n          // CommonMark requires space before trailing #s\n          text = trimmed.trim();\n        }\n      }\n      const token = {\n        type: 'heading',\n        raw: cap[0],\n        depth: cap[1].length,\n        text: text,\n        tokens: []\n      };\n      this.lexer.inline(token.text, token.tokens);\n      return token;\n    }\n  }\n  hr(src) {\n    const cap = this.rules.block.hr.exec(src);\n    if (cap) {\n      return {\n        type: 'hr',\n        raw: cap[0]\n      };\n    }\n  }\n  blockquote(src) {\n    const cap = this.rules.block.blockquote.exec(src);\n    if (cap) {\n      const text = cap[0].replace(/^ *> ?/gm, '');\n      return {\n        type: 'blockquote',\n        raw: cap[0],\n        tokens: this.lexer.blockTokens(text, []),\n        text\n      };\n    }\n  }\n  list(src) {\n    let cap = this.rules.block.list.exec(src);\n    if (cap) {\n      let raw, istask, ischecked, indent, i, blankLine, endsWithBlankLine, line, nextLine, rawLine, itemContents, endEarly;\n      let bull = cap[1].trim();\n      const isordered = bull.length > 1;\n      const list = {\n        type: 'list',\n        raw: '',\n        ordered: isordered,\n        start: isordered ? +bull.slice(0, -1) : '',\n        loose: false,\n        items: []\n      };\n      bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\n      if (this.options.pedantic) {\n        bull = isordered ? bull : '[*+-]';\n      }\n\n      // Get next list item\n      const itemRegex = new RegExp(`^( {0,3}${bull})((?: [^\\\\n]*)?(?:\\\\n|$))`);\n\n      // Check if current bullet point can start a new List Item\n      while (src) {\n        endEarly = false;\n        if (!(cap = itemRegex.exec(src))) {\n          break;\n        }\n        if (this.rules.block.hr.test(src)) {\n          // End list if bullet was actually HR (possibly move into itemRegex?)\n          break;\n        }\n        raw = cap[0];\n        src = src.substring(raw.length);\n        line = cap[2].split('\\n', 1)[0];\n        nextLine = src.split('\\n', 1)[0];\n        if (this.options.pedantic) {\n          indent = 2;\n          itemContents = line.trimLeft();\n        } else {\n          indent = cap[2].search(/[^ ]/); // Find first non-space char\n          indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n          itemContents = line.slice(indent);\n          indent += cap[1].length;\n        }\n        blankLine = false;\n        if (!line && /^ *$/.test(nextLine)) {\n          // Items begin with at most one blank line\n          raw += nextLine + '\\n';\n          src = src.substring(nextLine.length + 1);\n          endEarly = true;\n        }\n        if (!endEarly) {\n          const nextBulletRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])`);\n\n          // Check if following lines should be included in List Item\n          while (src) {\n            rawLine = src.split('\\n', 1)[0];\n            line = rawLine;\n\n            // Re-align to follow commonmark nesting rules\n            if (this.options.pedantic) {\n              line = line.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');\n            }\n\n            // End list item if found start of new bullet\n            if (nextBulletRegex.test(line)) {\n              break;\n            }\n            if (line.search(/[^ ]/) >= indent || !line.trim()) {\n              // Dedent if possible\n              itemContents += '\\n' + line.slice(indent);\n            } else if (!blankLine) {\n              // Until blank line, item doesn't need indentation\n              itemContents += '\\n' + line;\n            } else {\n              // Otherwise, improper indentation ends this item\n              break;\n            }\n            if (!blankLine && !line.trim()) {\n              // Check if current line is blank\n              blankLine = true;\n            }\n            raw += rawLine + '\\n';\n            src = src.substring(rawLine.length + 1);\n          }\n        }\n        if (!list.loose) {\n          // If the previous item ended with a blank line, the list is loose\n          if (endsWithBlankLine) {\n            list.loose = true;\n          } else if (/\\n *\\n *$/.test(raw)) {\n            endsWithBlankLine = true;\n          }\n        }\n\n        // Check for task list items\n        if (this.options.gfm) {\n          istask = /^\\[[ xX]\\] /.exec(itemContents);\n          if (istask) {\n            ischecked = istask[0] !== '[ ] ';\n            itemContents = itemContents.replace(/^\\[[ xX]\\] +/, '');\n          }\n        }\n        list.items.push({\n          type: 'list_item',\n          raw: raw,\n          task: !!istask,\n          checked: ischecked,\n          loose: false,\n          text: itemContents\n        });\n        list.raw += raw;\n      }\n\n      // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic\n      list.items[list.items.length - 1].raw = raw.trimRight();\n      list.items[list.items.length - 1].text = itemContents.trimRight();\n      list.raw = list.raw.trimRight();\n      const l = list.items.length;\n\n      // Item child tokens handled here at end because we needed to have the final item to trim it first\n      for (i = 0; i < l; i++) {\n        this.lexer.state.top = false;\n        list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n        const spacers = list.items[i].tokens.filter(t => t.type === 'space');\n        const hasMultipleLineBreaks = spacers.every(t => {\n          const chars = t.raw.split('');\n          let lineBreaks = 0;\n          for (const char of chars) {\n            if (char === '\\n') {\n              lineBreaks += 1;\n            }\n            if (lineBreaks > 1) {\n              return true;\n            }\n          }\n          return false;\n        });\n        if (!list.loose && spacers.length && hasMultipleLineBreaks) {\n          // Having a single line break doesn't mean a list is loose. A single line break is terminating the last list item\n          list.loose = true;\n          list.items[i].loose = true;\n        }\n      }\n      return list;\n    }\n  }\n  html(src) {\n    const cap = this.rules.block.html.exec(src);\n    if (cap) {\n      const token = {\n        type: 'html',\n        raw: cap[0],\n        pre: !this.options.sanitizer && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),\n        text: cap[0]\n      };\n      if (this.options.sanitize) {\n        token.type = 'paragraph';\n        token.text = this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]);\n        token.tokens = [];\n        this.lexer.inline(token.text, token.tokens);\n      }\n      return token;\n    }\n  }\n  def(src) {\n    const cap = this.rules.block.def.exec(src);\n    if (cap) {\n      if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n      const tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n      return {\n        type: 'def',\n        tag,\n        raw: cap[0],\n        href: cap[2],\n        title: cap[3]\n      };\n    }\n  }\n  table(src) {\n    const cap = this.rules.block.table.exec(src);\n    if (cap) {\n      const item = {\n        type: 'table',\n        header: splitCells(cap[1]).map(c => {\n          return {\n            text: c\n          };\n        }),\n        align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n        rows: cap[3] && cap[3].trim() ? cap[3].replace(/\\n[ \\t]*$/, '').split('\\n') : []\n      };\n      if (item.header.length === item.align.length) {\n        item.raw = cap[0];\n        let l = item.align.length;\n        let i, j, k, row;\n        for (i = 0; i < l; i++) {\n          if (/^ *-+: *$/.test(item.align[i])) {\n            item.align[i] = 'right';\n          } else if (/^ *:-+: *$/.test(item.align[i])) {\n            item.align[i] = 'center';\n          } else if (/^ *:-+ *$/.test(item.align[i])) {\n            item.align[i] = 'left';\n          } else {\n            item.align[i] = null;\n          }\n        }\n        l = item.rows.length;\n        for (i = 0; i < l; i++) {\n          item.rows[i] = splitCells(item.rows[i], item.header.length).map(c => {\n            return {\n              text: c\n            };\n          });\n        }\n\n        // parse child tokens inside headers and cells\n\n        // header child tokens\n        l = item.header.length;\n        for (j = 0; j < l; j++) {\n          item.header[j].tokens = [];\n          this.lexer.inlineTokens(item.header[j].text, item.header[j].tokens);\n        }\n\n        // cell child tokens\n        l = item.rows.length;\n        for (j = 0; j < l; j++) {\n          row = item.rows[j];\n          for (k = 0; k < row.length; k++) {\n            row[k].tokens = [];\n            this.lexer.inlineTokens(row[k].text, row[k].tokens);\n          }\n        }\n        return item;\n      }\n    }\n  }\n  lheading(src) {\n    const cap = this.rules.block.lheading.exec(src);\n    if (cap) {\n      const token = {\n        type: 'heading',\n        raw: cap[0],\n        depth: cap[2].charAt(0) === '=' ? 1 : 2,\n        text: cap[1],\n        tokens: []\n      };\n      this.lexer.inline(token.text, token.tokens);\n      return token;\n    }\n  }\n  paragraph(src) {\n    const cap = this.rules.block.paragraph.exec(src);\n    if (cap) {\n      const token = {\n        type: 'paragraph',\n        raw: cap[0],\n        text: cap[1].charAt(cap[1].length - 1) === '\\n' ? cap[1].slice(0, -1) : cap[1],\n        tokens: []\n      };\n      this.lexer.inline(token.text, token.tokens);\n      return token;\n    }\n  }\n  text(src) {\n    const cap = this.rules.block.text.exec(src);\n    if (cap) {\n      const token = {\n        type: 'text',\n        raw: cap[0],\n        text: cap[0],\n        tokens: []\n      };\n      this.lexer.inline(token.text, token.tokens);\n      return token;\n    }\n  }\n  escape(src) {\n    const cap = this.rules.inline.escape.exec(src);\n    if (cap) {\n      return {\n        type: 'escape',\n        raw: cap[0],\n        text: escape(cap[1])\n      };\n    }\n  }\n  tag(src) {\n    const cap = this.rules.inline.tag.exec(src);\n    if (cap) {\n      if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {\n        this.lexer.state.inLink = true;\n      } else if (this.lexer.state.inLink && /^<\\/a>/i.test(cap[0])) {\n        this.lexer.state.inLink = false;\n      }\n      if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n        this.lexer.state.inRawBlock = true;\n      } else if (this.lexer.state.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n        this.lexer.state.inRawBlock = false;\n      }\n      return {\n        type: this.options.sanitize ? 'text' : 'html',\n        raw: cap[0],\n        inLink: this.lexer.state.inLink,\n        inRawBlock: this.lexer.state.inRawBlock,\n        text: this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0]\n      };\n    }\n  }\n  link(src) {\n    const cap = this.rules.inline.link.exec(src);\n    if (cap) {\n      const trimmedUrl = cap[2].trim();\n      if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n        // commonmark requires matching angle brackets\n        if (!/>$/.test(trimmedUrl)) {\n          return;\n        }\n\n        // ending angle bracket cannot be escaped\n        const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n        if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n          return;\n        }\n      } else {\n        // find closing parenthesis\n        const lastParenIndex = findClosingBracket(cap[2], '()');\n        if (lastParenIndex > -1) {\n          const start = cap[0].indexOf('!') === 0 ? 5 : 4;\n          const linkLen = start + cap[1].length + lastParenIndex;\n          cap[2] = cap[2].substring(0, lastParenIndex);\n          cap[0] = cap[0].substring(0, linkLen).trim();\n          cap[3] = '';\n        }\n      }\n      let href = cap[2];\n      let title = '';\n      if (this.options.pedantic) {\n        // split pedantic href and title\n        const link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n        if (link) {\n          href = link[1];\n          title = link[3];\n        }\n      } else {\n        title = cap[3] ? cap[3].slice(1, -1) : '';\n      }\n      href = href.trim();\n      if (/^</.test(href)) {\n        if (this.options.pedantic && !/>$/.test(trimmedUrl)) {\n          // pedantic allows starting angle bracket without ending angle bracket\n          href = href.slice(1);\n        } else {\n          href = href.slice(1, -1);\n        }\n      }\n      return outputLink(cap, {\n        href: href ? href.replace(this.rules.inline._escapes, '$1') : href,\n        title: title ? title.replace(this.rules.inline._escapes, '$1') : title\n      }, cap[0], this.lexer);\n    }\n  }\n  reflink(src, links) {\n    let cap;\n    if ((cap = this.rules.inline.reflink.exec(src)) || (cap = this.rules.inline.nolink.exec(src))) {\n      let link = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n      link = links[link.toLowerCase()];\n      if (!link || !link.href) {\n        const text = cap[0].charAt(0);\n        return {\n          type: 'text',\n          raw: text,\n          text\n        };\n      }\n      return outputLink(cap, link, cap[0], this.lexer);\n    }\n  }\n  emStrong(src, maskedSrc, prevChar = '') {\n    let match = this.rules.inline.emStrong.lDelim.exec(src);\n    if (!match) return;\n\n    // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n    if (match[3] && prevChar.match(/[\\p{L}\\p{N}]/u)) return;\n    const nextChar = match[1] || match[2] || '';\n    if (!nextChar || nextChar && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))) {\n      const lLength = match[0].length - 1;\n      let rDelim,\n        rLength,\n        delimTotal = lLength,\n        midDelimTotal = 0;\n      const endReg = match[0][0] === '*' ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd;\n      endReg.lastIndex = 0;\n\n      // Clip maskedSrc to same section of string as src (move to lexer?)\n      maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n      while ((match = endReg.exec(maskedSrc)) != null) {\n        rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n        if (!rDelim) continue; // skip single * in __abc*abc__\n\n        rLength = rDelim.length;\n        if (match[3] || match[4]) {\n          // found another Left Delim\n          delimTotal += rLength;\n          continue;\n        } else if (match[5] || match[6]) {\n          // either Left or Right Delim\n          if (lLength % 3 && !((lLength + rLength) % 3)) {\n            midDelimTotal += rLength;\n            continue; // CommonMark Emphasis Rules 9-10\n          }\n        }\n        delimTotal -= rLength;\n        if (delimTotal > 0) continue; // Haven't found enough closing delimiters\n\n        // Remove extra characters. *a*** -> *a*\n        rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\n\n        // Create `em` if smallest delimiter has odd char count. *a***\n        if (Math.min(lLength, rLength) % 2) {\n          const text = src.slice(1, lLength + match.index + rLength);\n          return {\n            type: 'em',\n            raw: src.slice(0, lLength + match.index + rLength + 1),\n            text,\n            tokens: this.lexer.inlineTokens(text, [])\n          };\n        }\n\n        // Create 'strong' if smallest delimiter has even char count. **a***\n        const text = src.slice(2, lLength + match.index + rLength - 1);\n        return {\n          type: 'strong',\n          raw: src.slice(0, lLength + match.index + rLength + 1),\n          text,\n          tokens: this.lexer.inlineTokens(text, [])\n        };\n      }\n    }\n  }\n  codespan(src) {\n    const cap = this.rules.inline.code.exec(src);\n    if (cap) {\n      let text = cap[2].replace(/\\n/g, ' ');\n      const hasNonSpaceChars = /[^ ]/.test(text);\n      const hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n      if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n        text = text.substring(1, text.length - 1);\n      }\n      text = escape(text, true);\n      return {\n        type: 'codespan',\n        raw: cap[0],\n        text\n      };\n    }\n  }\n  br(src) {\n    const cap = this.rules.inline.br.exec(src);\n    if (cap) {\n      return {\n        type: 'br',\n        raw: cap[0]\n      };\n    }\n  }\n  del(src) {\n    const cap = this.rules.inline.del.exec(src);\n    if (cap) {\n      return {\n        type: 'del',\n        raw: cap[0],\n        text: cap[2],\n        tokens: this.lexer.inlineTokens(cap[2], [])\n      };\n    }\n  }\n  autolink(src, mangle) {\n    const cap = this.rules.inline.autolink.exec(src);\n    if (cap) {\n      let text, href;\n      if (cap[2] === '@') {\n        text = escape(this.options.mangle ? mangle(cap[1]) : cap[1]);\n        href = 'mailto:' + text;\n      } else {\n        text = escape(cap[1]);\n        href = text;\n      }\n      return {\n        type: 'link',\n        raw: cap[0],\n        text,\n        href,\n        tokens: [{\n          type: 'text',\n          raw: text,\n          text\n        }]\n      };\n    }\n  }\n  url(src, mangle) {\n    let cap;\n    if (cap = this.rules.inline.url.exec(src)) {\n      let text, href;\n      if (cap[2] === '@') {\n        text = escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n        href = 'mailto:' + text;\n      } else {\n        // do extended autolink path validation\n        let prevCapZero;\n        do {\n          prevCapZero = cap[0];\n          cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];\n        } while (prevCapZero !== cap[0]);\n        text = escape(cap[0]);\n        if (cap[1] === 'www.') {\n          href = 'http://' + text;\n        } else {\n          href = text;\n        }\n      }\n      return {\n        type: 'link',\n        raw: cap[0],\n        text,\n        href,\n        tokens: [{\n          type: 'text',\n          raw: text,\n          text\n        }]\n      };\n    }\n  }\n  inlineText(src, smartypants) {\n    const cap = this.rules.inline.text.exec(src);\n    if (cap) {\n      let text;\n      if (this.lexer.state.inRawBlock) {\n        text = this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0];\n      } else {\n        text = escape(this.options.smartypants ? smartypants(cap[0]) : cap[0]);\n      }\n      return {\n        type: 'text',\n        raw: cap[0],\n        text\n      };\n    }\n  }\n}\n\n/**\n * Block-Level Grammar\n */\nconst block = {\n  newline: /^(?: *(?:\\n|$))+/,\n  code: /^( {4}[^\\n]+(?:\\n(?: *(?:\\n|$))*)?)+/,\n  fences: /^ {0,3}(`{3,}(?=[^`\\n]*\\n)|~{3,})([^\\n]*)\\n(?:|([\\s\\S]*?)\\n)(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/,\n  hr: /^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)/,\n  heading: /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/,\n  blockquote: /^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/,\n  list: /^( {0,3}bull)( [^\\n]+?)?(?:\\n|$)/,\n  html: '^ {0,3}(?:' // optional indentation\n  + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n  + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n  + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n  + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n  + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n  + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (6)\n  + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) open tag\n  + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) closing tag\n  + ')',\n  def: /^ {0,3}\\[(label)\\]: *(?:\\n *)?<?([^\\s>]+)>?(?:(?: +(?:\\n *)?| *\\n *)(title))? *(?:\\n+|$)/,\n  table: noopTest,\n  lheading: /^([^\\n]+)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n  // regex template, placeholders will be replaced according to different paragraph\n  // interruption rules of commonmark and the original markdown spec:\n  _paragraph: /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/,\n  text: /^[^\\n]+/\n};\nblock._label = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\nblock._title = /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/;\nblock.def = edit(block.def).replace('label', block._label).replace('title', block._title).getRegex();\nblock.bullet = /(?:[*+-]|\\d{1,9}[.)])/;\nblock.listItemStart = edit(/^( *)(bull) */).replace('bull', block.bullet).getRegex();\nblock.list = edit(block.list).replace(/bull/g, block.bullet).replace('hr', '\\\\n+(?=\\\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$))').replace('def', '\\\\n+(?=' + block.def.source + ')').getRegex();\nblock._tag = 'address|article|aside|base|basefont|blockquote|body|caption' + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption' + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe' + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option' + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr' + '|track|ul';\nblock._comment = /<!--(?!-?>)[\\s\\S]*?(?:-->|$)/;\nblock.html = edit(block.html, 'i').replace('comment', block._comment).replace('tag', block._tag).replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/).getRegex();\nblock.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n.replace('|table', '').replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n.replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n.getRegex();\nblock.blockquote = edit(block.blockquote).replace('paragraph', block.paragraph).getRegex();\n\n/**\n * Normal Block Grammar\n */\n\nblock.normal = merge({}, block);\n\n/**\n * GFM Block Grammar\n */\n\nblock.gfm = merge({}, block.normal, {\n  table: '^ *([^\\\\n ].*\\\\|.*)\\\\n' // Header\n  + ' {0,3}(?:\\\\| *)?(:?-+:? *(?:\\\\| *:?-+:? *)*)(?:\\\\| *)?' // Align\n  + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)' // Cells\n});\nblock.gfm.table = edit(block.gfm.table).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('blockquote', ' {0,3}>').replace('code', ' {4}[^\\\\n]').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n.replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // tables can be interrupted by type (6) html blocks\n.getRegex();\nblock.gfm.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n.replace('table', block.gfm.table) // interrupt paragraphs with table\n.replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n.replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n.getRegex();\n/**\n * Pedantic grammar (original John Gruber's loose markdown specification)\n */\n\nblock.pedantic = merge({}, block.normal, {\n  html: edit('^ *(?:comment *(?:\\\\n|\\\\s*$)' + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n  + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))').replace('comment', block._comment).replace(/tag/g, '(?!(?:' + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub' + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)' + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b').getRegex(),\n  def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n  heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n  fences: noopTest,\n  // fences not supported\n  paragraph: edit(block.normal._paragraph).replace('hr', block.hr).replace('heading', ' *#{1,6} *[^\\n]').replace('lheading', block.lheading).replace('blockquote', ' {0,3}>').replace('|fences', '').replace('|list', '').replace('|html', '').getRegex()\n});\n\n/**\n * Inline-Level Grammar\n */\nconst inline = {\n  escape: /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/,\n  autolink: /^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/,\n  url: noopTest,\n  tag: '^comment' + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n  + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n  + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n  + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n  + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>',\n  // CDATA section\n  link: /^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/,\n  reflink: /^!?\\[(label)\\]\\[(ref)\\]/,\n  nolink: /^!?\\[(ref)\\](?:\\[\\])?/,\n  reflinkSearch: 'reflink|nolink(?!\\\\()',\n  emStrong: {\n    lDelim: /^(?:\\*+(?:([punct_])|[^\\s*]))|^_+(?:([punct*])|([^\\s_]))/,\n    //        (1) and (2) can only be a Right Delimiter. (3) and (4) can only be Left.  (5) and (6) can be either Left or Right.\n    //        () Skip orphan delim inside strong    (1) #***                (2) a***#, a***                   (3) #***a, ***a                 (4) ***#              (5) #***#                 (6) a***a\n    rDelimAst: /^[^_*]*?\\_\\_[^_*]*?\\*[^_*]*?(?=\\_\\_)|[punct_](\\*+)(?=[\\s]|$)|[^punct*_\\s](\\*+)(?=[punct_\\s]|$)|[punct_\\s](\\*+)(?=[^punct*_\\s])|[\\s](\\*+)(?=[punct_])|[punct_](\\*+)(?=[punct_])|[^punct*_\\s](\\*+)(?=[^punct*_\\s])/,\n    rDelimUnd: /^[^_*]*?\\*\\*[^_*]*?\\_[^_*]*?(?=\\*\\*)|[punct*](\\_+)(?=[\\s]|$)|[^punct*_\\s](\\_+)(?=[punct*\\s]|$)|[punct*\\s](\\_+)(?=[^punct*_\\s])|[\\s](\\_+)(?=[punct*])|[punct*](\\_+)(?=[punct*])/ // ^- Not allowed for _\n  },\n  code: /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/,\n  br: /^( {2,}|\\\\)\\n(?!\\s*$)/,\n  del: noopTest,\n  text: /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/,\n  punctuation: /^([\\spunctuation])/\n};\n\n// list of punctuation marks from CommonMark spec\n// without * and _ to handle the different emphasis markers * and _\ninline._punctuation = '!\"#$%&\\'()+\\\\-.,/:;<=>?@\\\\[\\\\]`^{|}~';\ninline.punctuation = edit(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex();\n\n// sequences em should skip over [title](link), `code`, <html>\ninline.blockSkip = /\\[[^\\]]*?\\]\\([^\\)]*?\\)|`[^`]*?`|<[^>]*?>/g;\ninline.escapedEmSt = /\\\\\\*|\\\\_/g;\ninline._comment = edit(block._comment).replace('(?:-->|$)', '-->').getRegex();\ninline.emStrong.lDelim = edit(inline.emStrong.lDelim).replace(/punct/g, inline._punctuation).getRegex();\ninline.emStrong.rDelimAst = edit(inline.emStrong.rDelimAst, 'g').replace(/punct/g, inline._punctuation).getRegex();\ninline.emStrong.rDelimUnd = edit(inline.emStrong.rDelimUnd, 'g').replace(/punct/g, inline._punctuation).getRegex();\ninline._escapes = /\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/g;\ninline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;\ninline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;\ninline.autolink = edit(inline.autolink).replace('scheme', inline._scheme).replace('email', inline._email).getRegex();\ninline._attribute = /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/;\ninline.tag = edit(inline.tag).replace('comment', inline._comment).replace('attribute', inline._attribute).getRegex();\ninline._label = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\ninline._href = /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/;\ninline._title = /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/;\ninline.link = edit(inline.link).replace('label', inline._label).replace('href', inline._href).replace('title', inline._title).getRegex();\ninline.reflink = edit(inline.reflink).replace('label', inline._label).replace('ref', block._label).getRegex();\ninline.nolink = edit(inline.nolink).replace('ref', block._label).getRegex();\ninline.reflinkSearch = edit(inline.reflinkSearch, 'g').replace('reflink', inline.reflink).replace('nolink', inline.nolink).getRegex();\n\n/**\n * Normal Inline Grammar\n */\n\ninline.normal = merge({}, inline);\n\n/**\n * Pedantic Inline Grammar\n */\n\ninline.pedantic = merge({}, inline.normal, {\n  strong: {\n    start: /^__|\\*\\*/,\n    middle: /^__(?=\\S)([\\s\\S]*?\\S)__(?!_)|^\\*\\*(?=\\S)([\\s\\S]*?\\S)\\*\\*(?!\\*)/,\n    endAst: /\\*\\*(?!\\*)/g,\n    endUnd: /__(?!_)/g\n  },\n  em: {\n    start: /^_|\\*/,\n    middle: /^()\\*(?=\\S)([\\s\\S]*?\\S)\\*(?!\\*)|^_(?=\\S)([\\s\\S]*?\\S)_(?!_)/,\n    endAst: /\\*(?!\\*)/g,\n    endUnd: /_(?!_)/g\n  },\n  link: edit(/^!?\\[(label)\\]\\((.*?)\\)/).replace('label', inline._label).getRegex(),\n  reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/).replace('label', inline._label).getRegex()\n});\n\n/**\n * GFM Inline Grammar\n */\n\ninline.gfm = merge({}, inline.normal, {\n  escape: edit(inline.escape).replace('])', '~|])').getRegex(),\n  _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,\n  url: /^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/,\n  _backpedal: /(?:[^?!.,:;*_~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,\n  del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n  text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/\n});\ninline.gfm.url = edit(inline.gfm.url, 'i').replace('email', inline.gfm._extended_email).getRegex();\n/**\n * GFM + Line Breaks Inline Grammar\n */\n\ninline.breaks = merge({}, inline.gfm, {\n  br: edit(inline.br).replace('{2,}', '*').getRegex(),\n  text: edit(inline.gfm.text).replace('\\\\b_', '\\\\b_| {2,}\\\\n').replace(/\\{2,\\}/g, '*').getRegex()\n});\n\n/**\n * smartypants text replacement\n */\nfunction smartypants(text) {\n  return text\n  // em-dashes\n  .replace(/---/g, '\\u2014')\n  // en-dashes\n  .replace(/--/g, '\\u2013')\n  // opening singles\n  .replace(/(^|[-\\u2014/(\\[{\"\\s])'/g, '$1\\u2018')\n  // closing singles & apostrophes\n  .replace(/'/g, '\\u2019')\n  // opening doubles\n  .replace(/(^|[-\\u2014/(\\[{\\u2018\\s])\"/g, '$1\\u201c')\n  // closing doubles\n  .replace(/\"/g, '\\u201d')\n  // ellipses\n  .replace(/\\.{3}/g, '\\u2026');\n}\n\n/**\n * mangle email addresses\n */\nfunction mangle(text) {\n  let out = '',\n    i,\n    ch;\n  const l = text.length;\n  for (i = 0; i < l; i++) {\n    ch = text.charCodeAt(i);\n    if (Math.random() > 0.5) {\n      ch = 'x' + ch.toString(16);\n    }\n    out += '&#' + ch + ';';\n  }\n  return out;\n}\n\n/**\n * Block Lexer\n */\nclass Lexer {\n  constructor(options) {\n    this.tokens = [];\n    this.tokens.links = Object.create(null);\n    this.options = options || defaults;\n    this.options.tokenizer = this.options.tokenizer || new Tokenizer();\n    this.tokenizer = this.options.tokenizer;\n    this.tokenizer.options = this.options;\n    this.tokenizer.lexer = this;\n    this.inlineQueue = [];\n    this.state = {\n      inLink: false,\n      inRawBlock: false,\n      top: true\n    };\n    const rules = {\n      block: block.normal,\n      inline: inline.normal\n    };\n    if (this.options.pedantic) {\n      rules.block = block.pedantic;\n      rules.inline = inline.pedantic;\n    } else if (this.options.gfm) {\n      rules.block = block.gfm;\n      if (this.options.breaks) {\n        rules.inline = inline.breaks;\n      } else {\n        rules.inline = inline.gfm;\n      }\n    }\n    this.tokenizer.rules = rules;\n  }\n\n  /**\n   * Expose Rules\n   */\n  static get rules() {\n    return {\n      block,\n      inline\n    };\n  }\n\n  /**\n   * Static Lex Method\n   */\n  static lex(src, options) {\n    const lexer = new Lexer(options);\n    return lexer.lex(src);\n  }\n\n  /**\n   * Static Lex Inline Method\n   */\n  static lexInline(src, options) {\n    const lexer = new Lexer(options);\n    return lexer.inlineTokens(src);\n  }\n\n  /**\n   * Preprocessing\n   */\n  lex(src) {\n    src = src.replace(/\\r\\n|\\r/g, '\\n').replace(/\\t/g, '    ');\n    this.blockTokens(src, this.tokens);\n    let next;\n    while (next = this.inlineQueue.shift()) {\n      this.inlineTokens(next.src, next.tokens);\n    }\n    return this.tokens;\n  }\n\n  /**\n   * Lexing\n   */\n  blockTokens(src, tokens = []) {\n    if (this.options.pedantic) {\n      src = src.replace(/^ +$/gm, '');\n    }\n    let token, lastToken, cutSrc, lastParagraphClipped;\n    while (src) {\n      if (this.options.extensions && this.options.extensions.block && this.options.extensions.block.some(extTokenizer => {\n        if (token = extTokenizer.call({\n          lexer: this\n        }, src, tokens)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          return true;\n        }\n        return false;\n      })) {\n        continue;\n      }\n\n      // newline\n      if (token = this.tokenizer.space(src)) {\n        src = src.substring(token.raw.length);\n        if (token.raw.length === 1 && tokens.length > 0) {\n          // if there's a single \\n as a spacer, it's terminating the last line,\n          // so move it there so that we don't get unecessary paragraph tags\n          tokens[tokens.length - 1].raw += '\\n';\n        } else {\n          tokens.push(token);\n        }\n        continue;\n      }\n\n      // code\n      if (token = this.tokenizer.code(src)) {\n        src = src.substring(token.raw.length);\n        lastToken = tokens[tokens.length - 1];\n        // An indented code block cannot interrupt a paragraph.\n        if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n          lastToken.raw += '\\n' + token.raw;\n          lastToken.text += '\\n' + token.text;\n          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n        } else {\n          tokens.push(token);\n        }\n        continue;\n      }\n\n      // fences\n      if (token = this.tokenizer.fences(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // heading\n      if (token = this.tokenizer.heading(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // hr\n      if (token = this.tokenizer.hr(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // blockquote\n      if (token = this.tokenizer.blockquote(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // list\n      if (token = this.tokenizer.list(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // html\n      if (token = this.tokenizer.html(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // def\n      if (token = this.tokenizer.def(src)) {\n        src = src.substring(token.raw.length);\n        lastToken = tokens[tokens.length - 1];\n        if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n          lastToken.raw += '\\n' + token.raw;\n          lastToken.text += '\\n' + token.raw;\n          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n        } else if (!this.tokens.links[token.tag]) {\n          this.tokens.links[token.tag] = {\n            href: token.href,\n            title: token.title\n          };\n        }\n        continue;\n      }\n\n      // table (gfm)\n      if (token = this.tokenizer.table(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // lheading\n      if (token = this.tokenizer.lheading(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // top-level paragraph\n      // prevent paragraph consuming extensions by clipping 'src' to extension start\n      cutSrc = src;\n      if (this.options.extensions && this.options.extensions.startBlock) {\n        let startIndex = Infinity;\n        const tempSrc = src.slice(1);\n        let tempStart;\n        this.options.extensions.startBlock.forEach(function (getStartIndex) {\n          tempStart = getStartIndex.call({\n            lexer: this\n          }, tempSrc);\n          if (typeof tempStart === 'number' && tempStart >= 0) {\n            startIndex = Math.min(startIndex, tempStart);\n          }\n        });\n        if (startIndex < Infinity && startIndex >= 0) {\n          cutSrc = src.substring(0, startIndex + 1);\n        }\n      }\n      if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n        lastToken = tokens[tokens.length - 1];\n        if (lastParagraphClipped && lastToken.type === 'paragraph') {\n          lastToken.raw += '\\n' + token.raw;\n          lastToken.text += '\\n' + token.text;\n          this.inlineQueue.pop();\n          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n        } else {\n          tokens.push(token);\n        }\n        lastParagraphClipped = cutSrc.length !== src.length;\n        src = src.substring(token.raw.length);\n        continue;\n      }\n\n      // text\n      if (token = this.tokenizer.text(src)) {\n        src = src.substring(token.raw.length);\n        lastToken = tokens[tokens.length - 1];\n        if (lastToken && lastToken.type === 'text') {\n          lastToken.raw += '\\n' + token.raw;\n          lastToken.text += '\\n' + token.text;\n          this.inlineQueue.pop();\n          this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n        } else {\n          tokens.push(token);\n        }\n        continue;\n      }\n      if (src) {\n        const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n        if (this.options.silent) {\n          console.error(errMsg);\n          break;\n        } else {\n          throw new Error(errMsg);\n        }\n      }\n    }\n    this.state.top = true;\n    return tokens;\n  }\n  inline(src, tokens) {\n    this.inlineQueue.push({\n      src,\n      tokens\n    });\n  }\n\n  /**\n   * Lexing/Compiling\n   */\n  inlineTokens(src, tokens = []) {\n    let token, lastToken, cutSrc;\n\n    // String with links masked to avoid interference with em and strong\n    let maskedSrc = src;\n    let match;\n    let keepPrevChar, prevChar;\n\n    // Mask out reflinks\n    if (this.tokens.links) {\n      const links = Object.keys(this.tokens.links);\n      if (links.length > 0) {\n        while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n          if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n          }\n        }\n      }\n    }\n    // Mask out other blocks\n    while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n      maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n    }\n\n    // Mask out escaped em & strong delimiters\n    while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) {\n      maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);\n    }\n    while (src) {\n      if (!keepPrevChar) {\n        prevChar = '';\n      }\n      keepPrevChar = false;\n\n      // extensions\n      if (this.options.extensions && this.options.extensions.inline && this.options.extensions.inline.some(extTokenizer => {\n        if (token = extTokenizer.call({\n          lexer: this\n        }, src, tokens)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          return true;\n        }\n        return false;\n      })) {\n        continue;\n      }\n\n      // escape\n      if (token = this.tokenizer.escape(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // tag\n      if (token = this.tokenizer.tag(src)) {\n        src = src.substring(token.raw.length);\n        lastToken = tokens[tokens.length - 1];\n        if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n          lastToken.raw += token.raw;\n          lastToken.text += token.text;\n        } else {\n          tokens.push(token);\n        }\n        continue;\n      }\n\n      // link\n      if (token = this.tokenizer.link(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // reflink, nolink\n      if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n        src = src.substring(token.raw.length);\n        lastToken = tokens[tokens.length - 1];\n        if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n          lastToken.raw += token.raw;\n          lastToken.text += token.text;\n        } else {\n          tokens.push(token);\n        }\n        continue;\n      }\n\n      // em & strong\n      if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // code\n      if (token = this.tokenizer.codespan(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // br\n      if (token = this.tokenizer.br(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // del (gfm)\n      if (token = this.tokenizer.del(src)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // autolink\n      if (token = this.tokenizer.autolink(src, mangle)) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // url (gfm)\n      if (!this.state.inLink && (token = this.tokenizer.url(src, mangle))) {\n        src = src.substring(token.raw.length);\n        tokens.push(token);\n        continue;\n      }\n\n      // text\n      // prevent inlineText consuming extensions by clipping 'src' to extension start\n      cutSrc = src;\n      if (this.options.extensions && this.options.extensions.startInline) {\n        let startIndex = Infinity;\n        const tempSrc = src.slice(1);\n        let tempStart;\n        this.options.extensions.startInline.forEach(function (getStartIndex) {\n          tempStart = getStartIndex.call({\n            lexer: this\n          }, tempSrc);\n          if (typeof tempStart === 'number' && tempStart >= 0) {\n            startIndex = Math.min(startIndex, tempStart);\n          }\n        });\n        if (startIndex < Infinity && startIndex >= 0) {\n          cutSrc = src.substring(0, startIndex + 1);\n        }\n      }\n      if (token = this.tokenizer.inlineText(cutSrc, smartypants)) {\n        src = src.substring(token.raw.length);\n        if (token.raw.slice(-1) !== '_') {\n          // Track prevChar before string of ____ started\n          prevChar = token.raw.slice(-1);\n        }\n        keepPrevChar = true;\n        lastToken = tokens[tokens.length - 1];\n        if (lastToken && lastToken.type === 'text') {\n          lastToken.raw += token.raw;\n          lastToken.text += token.text;\n        } else {\n          tokens.push(token);\n        }\n        continue;\n      }\n      if (src) {\n        const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n        if (this.options.silent) {\n          console.error(errMsg);\n          break;\n        } else {\n          throw new Error(errMsg);\n        }\n      }\n    }\n    return tokens;\n  }\n}\n\n/**\n * Renderer\n */\nclass Renderer {\n  constructor(options) {\n    this.options = options || defaults;\n  }\n  code(code, infostring, escaped) {\n    const lang = (infostring || '').match(/\\S*/)[0];\n    if (this.options.highlight) {\n      const out = this.options.highlight(code, lang);\n      if (out != null && out !== code) {\n        escaped = true;\n        code = out;\n      }\n    }\n    code = code.replace(/\\n$/, '') + '\\n';\n    if (!lang) {\n      return '<pre><code>' + (escaped ? code : escape(code, true)) + '</code></pre>\\n';\n    }\n    return '<pre><code class=\"' + this.options.langPrefix + escape(lang, true) + '\">' + (escaped ? code : escape(code, true)) + '</code></pre>\\n';\n  }\n  blockquote(quote) {\n    return '<blockquote>\\n' + quote + '</blockquote>\\n';\n  }\n  html(html) {\n    return html;\n  }\n  heading(text, level, raw, slugger) {\n    if (this.options.headerIds) {\n      return '<h' + level + ' id=\"' + this.options.headerPrefix + slugger.slug(raw) + '\">' + text + '</h' + level + '>\\n';\n    }\n    // ignore IDs\n    return '<h' + level + '>' + text + '</h' + level + '>\\n';\n  }\n  hr() {\n    return this.options.xhtml ? '<hr/>\\n' : '<hr>\\n';\n  }\n  list(body, ordered, start) {\n    const type = ordered ? 'ol' : 'ul',\n      startatt = ordered && start !== 1 ? ' start=\"' + start + '\"' : '';\n    return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n  }\n  listitem(text) {\n    return '<li>' + text + '</li>\\n';\n  }\n  checkbox(checked) {\n    return '<input ' + (checked ? 'checked=\"\" ' : '') + 'disabled=\"\" type=\"checkbox\"' + (this.options.xhtml ? ' /' : '') + '> ';\n  }\n  paragraph(text) {\n    return '<p>' + text + '</p>\\n';\n  }\n  table(header, body) {\n    if (body) body = '<tbody>' + body + '</tbody>';\n    return '<table>\\n' + '<thead>\\n' + header + '</thead>\\n' + body + '</table>\\n';\n  }\n  tablerow(content) {\n    return '<tr>\\n' + content + '</tr>\\n';\n  }\n  tablecell(content, flags) {\n    const type = flags.header ? 'th' : 'td';\n    const tag = flags.align ? '<' + type + ' align=\"' + flags.align + '\">' : '<' + type + '>';\n    return tag + content + '</' + type + '>\\n';\n  }\n\n  // span level renderer\n  strong(text) {\n    return '<strong>' + text + '</strong>';\n  }\n  em(text) {\n    return '<em>' + text + '</em>';\n  }\n  codespan(text) {\n    return '<code>' + text + '</code>';\n  }\n  br() {\n    return this.options.xhtml ? '<br/>' : '<br>';\n  }\n  del(text) {\n    return '<del>' + text + '</del>';\n  }\n  link(href, title, text) {\n    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n    if (href === null) {\n      return text;\n    }\n    let out = '<a href=\"' + escape(href) + '\"';\n    if (title) {\n      out += ' title=\"' + title + '\"';\n    }\n    out += '>' + text + '</a>';\n    return out;\n  }\n  image(href, title, text) {\n    href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n    if (href === null) {\n      return text;\n    }\n    let out = '<img src=\"' + href + '\" alt=\"' + text + '\"';\n    if (title) {\n      out += ' title=\"' + title + '\"';\n    }\n    out += this.options.xhtml ? '/>' : '>';\n    return out;\n  }\n  text(text) {\n    return text;\n  }\n}\n\n/**\n * TextRenderer\n * returns only the textual part of the token\n */\nclass TextRenderer {\n  // no need for block level renderers\n  strong(text) {\n    return text;\n  }\n  em(text) {\n    return text;\n  }\n  codespan(text) {\n    return text;\n  }\n  del(text) {\n    return text;\n  }\n  html(text) {\n    return text;\n  }\n  text(text) {\n    return text;\n  }\n  link(href, title, text) {\n    return '' + text;\n  }\n  image(href, title, text) {\n    return '' + text;\n  }\n  br() {\n    return '';\n  }\n}\n\n/**\n * Slugger generates header id\n */\nclass Slugger {\n  constructor() {\n    this.seen = {};\n  }\n  serialize(value) {\n    return value.toLowerCase().trim()\n    // remove html tags\n    .replace(/<[!\\/a-z].*?>/ig, '')\n    // remove unwanted chars\n    .replace(/[\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,./:;<=>?@[\\]^`{|}~]/g, '').replace(/\\s/g, '-');\n  }\n\n  /**\n   * Finds the next safe (unique) slug to use\n   */\n  getNextSafeSlug(originalSlug, isDryRun) {\n    let slug = originalSlug;\n    let occurenceAccumulator = 0;\n    if (this.seen.hasOwnProperty(slug)) {\n      occurenceAccumulator = this.seen[originalSlug];\n      do {\n        occurenceAccumulator++;\n        slug = originalSlug + '-' + occurenceAccumulator;\n      } while (this.seen.hasOwnProperty(slug));\n    }\n    if (!isDryRun) {\n      this.seen[originalSlug] = occurenceAccumulator;\n      this.seen[slug] = 0;\n    }\n    return slug;\n  }\n\n  /**\n   * Convert string to unique id\n   * @param {object} options\n   * @param {boolean} options.dryrun Generates the next unique slug without updating the internal accumulator.\n   */\n  slug(value, options = {}) {\n    const slug = this.serialize(value);\n    return this.getNextSafeSlug(slug, options.dryrun);\n  }\n}\n\n/**\n * Parsing & Compiling\n */\nclass Parser {\n  constructor(options) {\n    this.options = options || defaults;\n    this.options.renderer = this.options.renderer || new Renderer();\n    this.renderer = this.options.renderer;\n    this.renderer.options = this.options;\n    this.textRenderer = new TextRenderer();\n    this.slugger = new Slugger();\n  }\n\n  /**\n   * Static Parse Method\n   */\n  static parse(tokens, options) {\n    const parser = new Parser(options);\n    return parser.parse(tokens);\n  }\n\n  /**\n   * Static Parse Inline Method\n   */\n  static parseInline(tokens, options) {\n    const parser = new Parser(options);\n    return parser.parseInline(tokens);\n  }\n\n  /**\n   * Parse Loop\n   */\n  parse(tokens, top = true) {\n    let out = '',\n      i,\n      j,\n      k,\n      l2,\n      l3,\n      row,\n      cell,\n      header,\n      body,\n      token,\n      ordered,\n      start,\n      loose,\n      itemBody,\n      item,\n      checked,\n      task,\n      checkbox,\n      ret;\n    const l = tokens.length;\n    for (i = 0; i < l; i++) {\n      token = tokens[i];\n\n      // Run any renderer extensions\n      if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n        ret = this.options.extensions.renderers[token.type].call({\n          parser: this\n        }, token);\n        if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(token.type)) {\n          out += ret || '';\n          continue;\n        }\n      }\n      switch (token.type) {\n        case 'space':\n          {\n            continue;\n          }\n        case 'hr':\n          {\n            out += this.renderer.hr();\n            continue;\n          }\n        case 'heading':\n          {\n            out += this.renderer.heading(this.parseInline(token.tokens), token.depth, unescape(this.parseInline(token.tokens, this.textRenderer)), this.slugger);\n            continue;\n          }\n        case 'code':\n          {\n            out += this.renderer.code(token.text, token.lang, token.escaped);\n            continue;\n          }\n        case 'table':\n          {\n            header = '';\n\n            // header\n            cell = '';\n            l2 = token.header.length;\n            for (j = 0; j < l2; j++) {\n              cell += this.renderer.tablecell(this.parseInline(token.header[j].tokens), {\n                header: true,\n                align: token.align[j]\n              });\n            }\n            header += this.renderer.tablerow(cell);\n            body = '';\n            l2 = token.rows.length;\n            for (j = 0; j < l2; j++) {\n              row = token.rows[j];\n              cell = '';\n              l3 = row.length;\n              for (k = 0; k < l3; k++) {\n                cell += this.renderer.tablecell(this.parseInline(row[k].tokens), {\n                  header: false,\n                  align: token.align[k]\n                });\n              }\n              body += this.renderer.tablerow(cell);\n            }\n            out += this.renderer.table(header, body);\n            continue;\n          }\n        case 'blockquote':\n          {\n            body = this.parse(token.tokens);\n            out += this.renderer.blockquote(body);\n            continue;\n          }\n        case 'list':\n          {\n            ordered = token.ordered;\n            start = token.start;\n            loose = token.loose;\n            l2 = token.items.length;\n            body = '';\n            for (j = 0; j < l2; j++) {\n              item = token.items[j];\n              checked = item.checked;\n              task = item.task;\n              itemBody = '';\n              if (item.task) {\n                checkbox = this.renderer.checkbox(checked);\n                if (loose) {\n                  if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {\n                    item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                      item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                    }\n                  } else {\n                    item.tokens.unshift({\n                      type: 'text',\n                      text: checkbox\n                    });\n                  }\n                } else {\n                  itemBody += checkbox;\n                }\n              }\n              itemBody += this.parse(item.tokens, loose);\n              body += this.renderer.listitem(itemBody, task, checked);\n            }\n            out += this.renderer.list(body, ordered, start);\n            continue;\n          }\n        case 'html':\n          {\n            // TODO parse inline content if parameter markdown=1\n            out += this.renderer.html(token.text);\n            continue;\n          }\n        case 'paragraph':\n          {\n            out += this.renderer.paragraph(this.parseInline(token.tokens));\n            continue;\n          }\n        case 'text':\n          {\n            body = token.tokens ? this.parseInline(token.tokens) : token.text;\n            while (i + 1 < l && tokens[i + 1].type === 'text') {\n              token = tokens[++i];\n              body += '\\n' + (token.tokens ? this.parseInline(token.tokens) : token.text);\n            }\n            out += top ? this.renderer.paragraph(body) : body;\n            continue;\n          }\n        default:\n          {\n            const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n            if (this.options.silent) {\n              console.error(errMsg);\n              return;\n            } else {\n              throw new Error(errMsg);\n            }\n          }\n      }\n    }\n    return out;\n  }\n\n  /**\n   * Parse Inline Tokens\n   */\n  parseInline(tokens, renderer) {\n    renderer = renderer || this.renderer;\n    let out = '',\n      i,\n      token,\n      ret;\n    const l = tokens.length;\n    for (i = 0; i < l; i++) {\n      token = tokens[i];\n\n      // Run any renderer extensions\n      if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n        ret = this.options.extensions.renderers[token.type].call({\n          parser: this\n        }, token);\n        if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {\n          out += ret || '';\n          continue;\n        }\n      }\n      switch (token.type) {\n        case 'escape':\n          {\n            out += renderer.text(token.text);\n            break;\n          }\n        case 'html':\n          {\n            out += renderer.html(token.text);\n            break;\n          }\n        case 'link':\n          {\n            out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));\n            break;\n          }\n        case 'image':\n          {\n            out += renderer.image(token.href, token.title, token.text);\n            break;\n          }\n        case 'strong':\n          {\n            out += renderer.strong(this.parseInline(token.tokens, renderer));\n            break;\n          }\n        case 'em':\n          {\n            out += renderer.em(this.parseInline(token.tokens, renderer));\n            break;\n          }\n        case 'codespan':\n          {\n            out += renderer.codespan(token.text);\n            break;\n          }\n        case 'br':\n          {\n            out += renderer.br();\n            break;\n          }\n        case 'del':\n          {\n            out += renderer.del(this.parseInline(token.tokens, renderer));\n            break;\n          }\n        case 'text':\n          {\n            out += renderer.text(token.text);\n            break;\n          }\n        default:\n          {\n            const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n            if (this.options.silent) {\n              console.error(errMsg);\n              return;\n            } else {\n              throw new Error(errMsg);\n            }\n          }\n      }\n    }\n    return out;\n  }\n}\n\n/**\n * Marked\n */\nfunction marked(src, opt, callback) {\n  // throw error in case of non string input\n  if (typeof src === 'undefined' || src === null) {\n    throw new Error('marked(): input parameter is undefined or null');\n  }\n  if (typeof src !== 'string') {\n    throw new Error('marked(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');\n  }\n  if (typeof opt === 'function') {\n    callback = opt;\n    opt = null;\n  }\n  opt = merge({}, marked.defaults, opt || {});\n  checkSanitizeDeprecation(opt);\n  if (callback) {\n    const highlight = opt.highlight;\n    let tokens;\n    try {\n      tokens = Lexer.lex(src, opt);\n    } catch (e) {\n      return callback(e);\n    }\n    const done = function (err) {\n      let out;\n      if (!err) {\n        try {\n          if (opt.walkTokens) {\n            marked.walkTokens(tokens, opt.walkTokens);\n          }\n          out = Parser.parse(tokens, opt);\n        } catch (e) {\n          err = e;\n        }\n      }\n      opt.highlight = highlight;\n      return err ? callback(err) : callback(null, out);\n    };\n    if (!highlight || highlight.length < 3) {\n      return done();\n    }\n    delete opt.highlight;\n    if (!tokens.length) return done();\n    let pending = 0;\n    marked.walkTokens(tokens, function (token) {\n      if (token.type === 'code') {\n        pending++;\n        setTimeout(() => {\n          highlight(token.text, token.lang, function (err, code) {\n            if (err) {\n              return done(err);\n            }\n            if (code != null && code !== token.text) {\n              token.text = code;\n              token.escaped = true;\n            }\n            pending--;\n            if (pending === 0) {\n              done();\n            }\n          });\n        }, 0);\n      }\n    });\n    if (pending === 0) {\n      done();\n    }\n    return;\n  }\n  try {\n    const tokens = Lexer.lex(src, opt);\n    if (opt.walkTokens) {\n      marked.walkTokens(tokens, opt.walkTokens);\n    }\n    return Parser.parse(tokens, opt);\n  } catch (e) {\n    e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n    if (opt.silent) {\n      return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';\n    }\n    throw e;\n  }\n}\n\n/**\n * Options\n */\n\nmarked.options = marked.setOptions = function (opt) {\n  merge(marked.defaults, opt);\n  changeDefaults(marked.defaults);\n  return marked;\n};\nmarked.getDefaults = getDefaults;\nmarked.defaults = defaults;\n\n/**\n * Use Extension\n */\n\nmarked.use = function (...args) {\n  const opts = merge({}, ...args);\n  const extensions = marked.defaults.extensions || {\n    renderers: {},\n    childTokens: {}\n  };\n  let hasExtensions;\n  args.forEach(pack => {\n    // ==-- Parse \"addon\" extensions --== //\n    if (pack.extensions) {\n      hasExtensions = true;\n      pack.extensions.forEach(ext => {\n        if (!ext.name) {\n          throw new Error('extension name required');\n        }\n        if (ext.renderer) {\n          // Renderer extensions\n          const prevRenderer = extensions.renderers ? extensions.renderers[ext.name] : null;\n          if (prevRenderer) {\n            // Replace extension with func to run new extension but fall back if false\n            extensions.renderers[ext.name] = function (...args) {\n              let ret = ext.renderer.apply(this, args);\n              if (ret === false) {\n                ret = prevRenderer.apply(this, args);\n              }\n              return ret;\n            };\n          } else {\n            extensions.renderers[ext.name] = ext.renderer;\n          }\n        }\n        if (ext.tokenizer) {\n          // Tokenizer Extensions\n          if (!ext.level || ext.level !== 'block' && ext.level !== 'inline') {\n            throw new Error(\"extension level must be 'block' or 'inline'\");\n          }\n          if (extensions[ext.level]) {\n            extensions[ext.level].unshift(ext.tokenizer);\n          } else {\n            extensions[ext.level] = [ext.tokenizer];\n          }\n          if (ext.start) {\n            // Function to check for start of token\n            if (ext.level === 'block') {\n              if (extensions.startBlock) {\n                extensions.startBlock.push(ext.start);\n              } else {\n                extensions.startBlock = [ext.start];\n              }\n            } else if (ext.level === 'inline') {\n              if (extensions.startInline) {\n                extensions.startInline.push(ext.start);\n              } else {\n                extensions.startInline = [ext.start];\n              }\n            }\n          }\n        }\n        if (ext.childTokens) {\n          // Child tokens to be visited by walkTokens\n          extensions.childTokens[ext.name] = ext.childTokens;\n        }\n      });\n    }\n\n    // ==-- Parse \"overwrite\" extensions --== //\n    if (pack.renderer) {\n      const renderer = marked.defaults.renderer || new Renderer();\n      for (const prop in pack.renderer) {\n        const prevRenderer = renderer[prop];\n        // Replace renderer with func to run extension, but fall back if false\n        renderer[prop] = (...args) => {\n          let ret = pack.renderer[prop].apply(renderer, args);\n          if (ret === false) {\n            ret = prevRenderer.apply(renderer, args);\n          }\n          return ret;\n        };\n      }\n      opts.renderer = renderer;\n    }\n    if (pack.tokenizer) {\n      const tokenizer = marked.defaults.tokenizer || new Tokenizer();\n      for (const prop in pack.tokenizer) {\n        const prevTokenizer = tokenizer[prop];\n        // Replace tokenizer with func to run extension, but fall back if false\n        tokenizer[prop] = (...args) => {\n          let ret = pack.tokenizer[prop].apply(tokenizer, args);\n          if (ret === false) {\n            ret = prevTokenizer.apply(tokenizer, args);\n          }\n          return ret;\n        };\n      }\n      opts.tokenizer = tokenizer;\n    }\n\n    // ==-- Parse WalkTokens extensions --== //\n    if (pack.walkTokens) {\n      const walkTokens = marked.defaults.walkTokens;\n      opts.walkTokens = function (token) {\n        pack.walkTokens.call(this, token);\n        if (walkTokens) {\n          walkTokens.call(this, token);\n        }\n      };\n    }\n    if (hasExtensions) {\n      opts.extensions = extensions;\n    }\n    marked.setOptions(opts);\n  });\n};\n\n/**\n * Run callback for every token\n */\n\nmarked.walkTokens = function (tokens, callback) {\n  for (const token of tokens) {\n    callback.call(marked, token);\n    switch (token.type) {\n      case 'table':\n        {\n          for (const cell of token.header) {\n            marked.walkTokens(cell.tokens, callback);\n          }\n          for (const row of token.rows) {\n            for (const cell of row) {\n              marked.walkTokens(cell.tokens, callback);\n            }\n          }\n          break;\n        }\n      case 'list':\n        {\n          marked.walkTokens(token.items, callback);\n          break;\n        }\n      default:\n        {\n          if (marked.defaults.extensions && marked.defaults.extensions.childTokens && marked.defaults.extensions.childTokens[token.type]) {\n            // Walk any extensions\n            marked.defaults.extensions.childTokens[token.type].forEach(function (childTokens) {\n              marked.walkTokens(token[childTokens], callback);\n            });\n          } else if (token.tokens) {\n            marked.walkTokens(token.tokens, callback);\n          }\n        }\n    }\n  }\n};\n\n/**\n * Parse Inline\n */\nmarked.parseInline = function (src, opt) {\n  // throw error in case of non string input\n  if (typeof src === 'undefined' || src === null) {\n    throw new Error('marked.parseInline(): input parameter is undefined or null');\n  }\n  if (typeof src !== 'string') {\n    throw new Error('marked.parseInline(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');\n  }\n  opt = merge({}, marked.defaults, opt || {});\n  checkSanitizeDeprecation(opt);\n  try {\n    const tokens = Lexer.lexInline(src, opt);\n    if (opt.walkTokens) {\n      marked.walkTokens(tokens, opt.walkTokens);\n    }\n    return Parser.parseInline(tokens, opt);\n  } catch (e) {\n    e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n    if (opt.silent) {\n      return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';\n    }\n    throw e;\n  }\n};\n\n/**\n * Expose\n */\nmarked.Parser = Parser;\nmarked.parser = Parser.parse;\nmarked.Renderer = Renderer;\nmarked.TextRenderer = TextRenderer;\nmarked.Lexer = Lexer;\nmarked.lexer = Lexer.lex;\nmarked.Tokenizer = Tokenizer;\nmarked.Slugger = Slugger;\nmarked.parse = marked;\nconst options = marked.options;\nconst setOptions = marked.setOptions;\nconst use = marked.use;\nconst walkTokens = marked.walkTokens;\nconst parseInline = marked.parseInline;\nconst parse = marked;\nconst parser = Parser.parse;\nconst lexer = Lexer.lex;\nexport { Lexer, Parser, Renderer, Slugger, TextRenderer, Tokenizer, defaults, getDefaults, lexer, marked, options, parse, parseInline, parser, setOptions, use, walkTokens };", "function extend(destination) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      if (source.hasOwnProperty(key)) destination[key] = source[key];\n    }\n  }\n  return destination;\n}\nfunction repeat(character, count) {\n  return Array(count + 1).join(character);\n}\nfunction trimLeadingNewlines(string) {\n  return string.replace(/^\\n*/, '');\n}\nfunction trimTrailingNewlines(string) {\n  // avoid match-at-end regexp bottleneck, see #370\n  var indexEnd = string.length;\n  while (indexEnd > 0 && string[indexEnd - 1] === '\\n') indexEnd--;\n  return string.substring(0, indexEnd);\n}\nvar blockElements = ['ADDRESS', 'ARTICLE', 'ASIDE', 'AUDIO', 'BLOCKQUOTE', 'BODY', 'CANVAS', 'CENTER', 'DD', 'DIR', 'DIV', 'DL', 'DT', 'FIELDSET', 'FIGCAPTION', 'FIGURE', 'FOOTER', 'FORM', 'FRAMESET', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'HEADER', 'HGROUP', 'HR', 'HTML', 'ISINDEX', 'LI', 'MAIN', 'MENU', 'NAV', 'NOFRAMES', 'NOSCRIPT', 'OL', 'OUTPUT', 'P', 'PRE', 'SECTION', 'TABLE', 'TBODY', 'TD', 'TFOOT', 'TH', 'THEAD', 'TR', 'UL'];\nfunction isBlock(node) {\n  return is(node, blockElements);\n}\nvar voidElements = ['AREA', 'BASE', 'BR', 'COL', 'COMMAND', 'EMBED', 'HR', 'IMG', 'INPUT', 'KEYGEN', 'LINK', 'META', 'PARAM', 'SOURCE', 'TRACK', 'WBR'];\nfunction isVoid(node) {\n  return is(node, voidElements);\n}\nfunction hasVoid(node) {\n  return has(node, voidElements);\n}\nvar meaningfulWhenBlankElements = ['A', 'TABLE', 'THEAD', 'TBODY', 'TFOOT', 'TH', 'TD', 'IFRAME', 'SCRIPT', 'AUDIO', 'VIDEO'];\nfunction isMeaningfulWhenBlank(node) {\n  return is(node, meaningfulWhenBlankElements);\n}\nfunction hasMeaningfulWhenBlank(node) {\n  return has(node, meaningfulWhenBlankElements);\n}\nfunction is(node, tagNames) {\n  return tagNames.indexOf(node.nodeName) >= 0;\n}\nfunction has(node, tagNames) {\n  return node.getElementsByTagName && tagNames.some(function (tagName) {\n    return node.getElementsByTagName(tagName).length;\n  });\n}\nvar rules = {};\nrules.paragraph = {\n  filter: 'p',\n  replacement: function (content) {\n    return '\\n\\n' + content + '\\n\\n';\n  }\n};\nrules.lineBreak = {\n  filter: 'br',\n  replacement: function (content, node, options) {\n    return options.br + '\\n';\n  }\n};\nrules.heading = {\n  filter: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n  replacement: function (content, node, options) {\n    var hLevel = Number(node.nodeName.charAt(1));\n    if (options.headingStyle === 'setext' && hLevel < 3) {\n      var underline = repeat(hLevel === 1 ? '=' : '-', content.length);\n      return '\\n\\n' + content + '\\n' + underline + '\\n\\n';\n    } else {\n      return '\\n\\n' + repeat('#', hLevel) + ' ' + content + '\\n\\n';\n    }\n  }\n};\nrules.blockquote = {\n  filter: 'blockquote',\n  replacement: function (content) {\n    content = content.replace(/^\\n+|\\n+$/g, '');\n    content = content.replace(/^/gm, '> ');\n    return '\\n\\n' + content + '\\n\\n';\n  }\n};\nrules.list = {\n  filter: ['ul', 'ol'],\n  replacement: function (content, node) {\n    var parent = node.parentNode;\n    if (parent.nodeName === 'LI' && parent.lastElementChild === node) {\n      return '\\n' + content;\n    } else {\n      return '\\n\\n' + content + '\\n\\n';\n    }\n  }\n};\nrules.listItem = {\n  filter: 'li',\n  replacement: function (content, node, options) {\n    content = content.replace(/^\\n+/, '') // remove leading newlines\n    .replace(/\\n+$/, '\\n') // replace trailing newlines with just a single one\n    .replace(/\\n/gm, '\\n    '); // indent\n    var prefix = options.bulletListMarker + '   ';\n    var parent = node.parentNode;\n    if (parent.nodeName === 'OL') {\n      var start = parent.getAttribute('start');\n      var index = Array.prototype.indexOf.call(parent.children, node);\n      prefix = (start ? Number(start) + index : index + 1) + '.  ';\n    }\n    return prefix + content + (node.nextSibling && !/\\n$/.test(content) ? '\\n' : '');\n  }\n};\nrules.indentedCodeBlock = {\n  filter: function (node, options) {\n    return options.codeBlockStyle === 'indented' && node.nodeName === 'PRE' && node.firstChild && node.firstChild.nodeName === 'CODE';\n  },\n  replacement: function (content, node, options) {\n    return '\\n\\n    ' + node.firstChild.textContent.replace(/\\n/g, '\\n    ') + '\\n\\n';\n  }\n};\nrules.fencedCodeBlock = {\n  filter: function (node, options) {\n    return options.codeBlockStyle === 'fenced' && node.nodeName === 'PRE' && node.firstChild && node.firstChild.nodeName === 'CODE';\n  },\n  replacement: function (content, node, options) {\n    var className = node.firstChild.getAttribute('class') || '';\n    var language = (className.match(/language-(\\S+)/) || [null, ''])[1];\n    var code = node.firstChild.textContent;\n    var fenceChar = options.fence.charAt(0);\n    var fenceSize = 3;\n    var fenceInCodeRegex = new RegExp('^' + fenceChar + '{3,}', 'gm');\n    var match;\n    while (match = fenceInCodeRegex.exec(code)) {\n      if (match[0].length >= fenceSize) {\n        fenceSize = match[0].length + 1;\n      }\n    }\n    var fence = repeat(fenceChar, fenceSize);\n    return '\\n\\n' + fence + language + '\\n' + code.replace(/\\n$/, '') + '\\n' + fence + '\\n\\n';\n  }\n};\nrules.horizontalRule = {\n  filter: 'hr',\n  replacement: function (content, node, options) {\n    return '\\n\\n' + options.hr + '\\n\\n';\n  }\n};\nrules.inlineLink = {\n  filter: function (node, options) {\n    return options.linkStyle === 'inlined' && node.nodeName === 'A' && node.getAttribute('href');\n  },\n  replacement: function (content, node) {\n    var href = node.getAttribute('href');\n    if (href) href = href.replace(/([()])/g, '\\\\$1');\n    var title = cleanAttribute(node.getAttribute('title'));\n    if (title) title = ' \"' + title.replace(/\"/g, '\\\\\"') + '\"';\n    return '[' + content + '](' + href + title + ')';\n  }\n};\nrules.referenceLink = {\n  filter: function (node, options) {\n    return options.linkStyle === 'referenced' && node.nodeName === 'A' && node.getAttribute('href');\n  },\n  replacement: function (content, node, options) {\n    var href = node.getAttribute('href');\n    var title = cleanAttribute(node.getAttribute('title'));\n    if (title) title = ' \"' + title + '\"';\n    var replacement;\n    var reference;\n    switch (options.linkReferenceStyle) {\n      case 'collapsed':\n        replacement = '[' + content + '][]';\n        reference = '[' + content + ']: ' + href + title;\n        break;\n      case 'shortcut':\n        replacement = '[' + content + ']';\n        reference = '[' + content + ']: ' + href + title;\n        break;\n      default:\n        var id = this.references.length + 1;\n        replacement = '[' + content + '][' + id + ']';\n        reference = '[' + id + ']: ' + href + title;\n    }\n    this.references.push(reference);\n    return replacement;\n  },\n  references: [],\n  append: function (options) {\n    var references = '';\n    if (this.references.length) {\n      references = '\\n\\n' + this.references.join('\\n') + '\\n\\n';\n      this.references = []; // Reset references\n    }\n    return references;\n  }\n};\nrules.emphasis = {\n  filter: ['em', 'i'],\n  replacement: function (content, node, options) {\n    if (!content.trim()) return '';\n    return options.emDelimiter + content + options.emDelimiter;\n  }\n};\nrules.strong = {\n  filter: ['strong', 'b'],\n  replacement: function (content, node, options) {\n    if (!content.trim()) return '';\n    return options.strongDelimiter + content + options.strongDelimiter;\n  }\n};\nrules.code = {\n  filter: function (node) {\n    var hasSiblings = node.previousSibling || node.nextSibling;\n    var isCodeBlock = node.parentNode.nodeName === 'PRE' && !hasSiblings;\n    return node.nodeName === 'CODE' && !isCodeBlock;\n  },\n  replacement: function (content) {\n    if (!content) return '';\n    content = content.replace(/\\r?\\n|\\r/g, ' ');\n    var extraSpace = /^`|^ .*?[^ ].* $|`$/.test(content) ? ' ' : '';\n    var delimiter = '`';\n    var matches = content.match(/`+/gm) || [];\n    while (matches.indexOf(delimiter) !== -1) delimiter = delimiter + '`';\n    return delimiter + extraSpace + content + extraSpace + delimiter;\n  }\n};\nrules.image = {\n  filter: 'img',\n  replacement: function (content, node) {\n    var alt = cleanAttribute(node.getAttribute('alt'));\n    var src = node.getAttribute('src') || '';\n    var title = cleanAttribute(node.getAttribute('title'));\n    var titlePart = title ? ' \"' + title + '\"' : '';\n    return src ? '![' + alt + ']' + '(' + src + titlePart + ')' : '';\n  }\n};\nfunction cleanAttribute(attribute) {\n  return attribute ? attribute.replace(/(\\n+\\s*)+/g, '\\n') : '';\n}\n\n/**\n * Manages a collection of rules used to convert HTML to Markdown\n */\n\nfunction Rules(options) {\n  this.options = options;\n  this._keep = [];\n  this._remove = [];\n  this.blankRule = {\n    replacement: options.blankReplacement\n  };\n  this.keepReplacement = options.keepReplacement;\n  this.defaultRule = {\n    replacement: options.defaultReplacement\n  };\n  this.array = [];\n  for (var key in options.rules) this.array.push(options.rules[key]);\n}\nRules.prototype = {\n  add: function (key, rule) {\n    this.array.unshift(rule);\n  },\n  keep: function (filter) {\n    this._keep.unshift({\n      filter: filter,\n      replacement: this.keepReplacement\n    });\n  },\n  remove: function (filter) {\n    this._remove.unshift({\n      filter: filter,\n      replacement: function () {\n        return '';\n      }\n    });\n  },\n  forNode: function (node) {\n    if (node.isBlank) return this.blankRule;\n    var rule;\n    if (rule = findRule(this.array, node, this.options)) return rule;\n    if (rule = findRule(this._keep, node, this.options)) return rule;\n    if (rule = findRule(this._remove, node, this.options)) return rule;\n    return this.defaultRule;\n  },\n  forEach: function (fn) {\n    for (var i = 0; i < this.array.length; i++) fn(this.array[i], i);\n  }\n};\nfunction findRule(rules, node, options) {\n  for (var i = 0; i < rules.length; i++) {\n    var rule = rules[i];\n    if (filterValue(rule, node, options)) return rule;\n  }\n  return void 0;\n}\nfunction filterValue(rule, node, options) {\n  var filter = rule.filter;\n  if (typeof filter === 'string') {\n    if (filter === node.nodeName.toLowerCase()) return true;\n  } else if (Array.isArray(filter)) {\n    if (filter.indexOf(node.nodeName.toLowerCase()) > -1) return true;\n  } else if (typeof filter === 'function') {\n    if (filter.call(rule, node, options)) return true;\n  } else {\n    throw new TypeError('`filter` needs to be a string, array, or function');\n  }\n}\n\n/**\n * The collapseWhitespace function is adapted from collapse-whitespace\n * by Luc Thevenard.\n *\n * The MIT License (MIT)\n *\n * Copyright (c) 2014 Luc Thevenard <lucthevenard@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * collapseWhitespace(options) removes extraneous whitespace from an the given element.\n *\n * @param {Object} options\n */\nfunction collapseWhitespace(options) {\n  var element = options.element;\n  var isBlock = options.isBlock;\n  var isVoid = options.isVoid;\n  var isPre = options.isPre || function (node) {\n    return node.nodeName === 'PRE';\n  };\n  if (!element.firstChild || isPre(element)) return;\n  var prevText = null;\n  var keepLeadingWs = false;\n  var prev = null;\n  var node = next(prev, element, isPre);\n  while (node !== element) {\n    if (node.nodeType === 3 || node.nodeType === 4) {\n      // Node.TEXT_NODE or Node.CDATA_SECTION_NODE\n      var text = node.data.replace(/[ \\r\\n\\t]+/g, ' ');\n      if ((!prevText || / $/.test(prevText.data)) && !keepLeadingWs && text[0] === ' ') {\n        text = text.substr(1);\n      }\n\n      // `text` might be empty at this point.\n      if (!text) {\n        node = remove(node);\n        continue;\n      }\n      node.data = text;\n      prevText = node;\n    } else if (node.nodeType === 1) {\n      // Node.ELEMENT_NODE\n      if (isBlock(node) || node.nodeName === 'BR') {\n        if (prevText) {\n          prevText.data = prevText.data.replace(/ $/, '');\n        }\n        prevText = null;\n        keepLeadingWs = false;\n      } else if (isVoid(node) || isPre(node)) {\n        // Avoid trimming space around non-block, non-BR void elements and inline PRE.\n        prevText = null;\n        keepLeadingWs = true;\n      } else if (prevText) {\n        // Drop protection if set previously.\n        keepLeadingWs = false;\n      }\n    } else {\n      node = remove(node);\n      continue;\n    }\n    var nextNode = next(prev, node, isPre);\n    prev = node;\n    node = nextNode;\n  }\n  if (prevText) {\n    prevText.data = prevText.data.replace(/ $/, '');\n    if (!prevText.data) {\n      remove(prevText);\n    }\n  }\n}\n\n/**\n * remove(node) removes the given node from the DOM and returns the\n * next node in the sequence.\n *\n * @param {Node} node\n * @return {Node} node\n */\nfunction remove(node) {\n  var next = node.nextSibling || node.parentNode;\n  node.parentNode.removeChild(node);\n  return next;\n}\n\n/**\n * next(prev, current, isPre) returns the next node in the sequence, given the\n * current and previous nodes.\n *\n * @param {Node} prev\n * @param {Node} current\n * @param {Function} isPre\n * @return {Node}\n */\nfunction next(prev, current, isPre) {\n  if (prev && prev.parentNode === current || isPre(current)) {\n    return current.nextSibling || current.parentNode;\n  }\n  return current.firstChild || current.nextSibling || current.parentNode;\n}\n\n/*\n * Set up window for Node.js\n */\n\nvar root = typeof window !== 'undefined' ? window : {};\n\n/*\n * Parsing HTML strings\n */\n\nfunction canParseHTMLNatively() {\n  var Parser = root.DOMParser;\n  var canParse = false;\n\n  // Adapted from https://gist.github.com/1129031\n  // Firefox/Opera/IE throw errors on unsupported types\n  try {\n    // WebKit returns null on unsupported types\n    if (new Parser().parseFromString('', 'text/html')) {\n      canParse = true;\n    }\n  } catch (e) {}\n  return canParse;\n}\nfunction createHTMLParser() {\n  var Parser = function () {};\n  {\n    if (shouldUseActiveX()) {\n      Parser.prototype.parseFromString = function (string) {\n        var doc = new window.ActiveXObject('htmlfile');\n        doc.designMode = 'on'; // disable on-page scripts\n        doc.open();\n        doc.write(string);\n        doc.close();\n        return doc;\n      };\n    } else {\n      Parser.prototype.parseFromString = function (string) {\n        var doc = document.implementation.createHTMLDocument('');\n        doc.open();\n        doc.write(string);\n        doc.close();\n        return doc;\n      };\n    }\n  }\n  return Parser;\n}\nfunction shouldUseActiveX() {\n  var useActiveX = false;\n  try {\n    document.implementation.createHTMLDocument('').open();\n  } catch (e) {\n    if (root.ActiveXObject) useActiveX = true;\n  }\n  return useActiveX;\n}\nvar HTMLParser = canParseHTMLNatively() ? root.DOMParser : createHTMLParser();\nfunction RootNode(input, options) {\n  var root;\n  if (typeof input === 'string') {\n    var doc = htmlParser().parseFromString(\n    // DOM parsers arrange elements in the <head> and <body>.\n    // Wrapping in a custom element ensures elements are reliably arranged in\n    // a single element.\n    '<x-turndown id=\"turndown-root\">' + input + '</x-turndown>', 'text/html');\n    root = doc.getElementById('turndown-root');\n  } else {\n    root = input.cloneNode(true);\n  }\n  collapseWhitespace({\n    element: root,\n    isBlock: isBlock,\n    isVoid: isVoid,\n    isPre: options.preformattedCode ? isPreOrCode : null\n  });\n  return root;\n}\nvar _htmlParser;\nfunction htmlParser() {\n  _htmlParser = _htmlParser || new HTMLParser();\n  return _htmlParser;\n}\nfunction isPreOrCode(node) {\n  return node.nodeName === 'PRE' || node.nodeName === 'CODE';\n}\nfunction Node(node, options) {\n  node.isBlock = isBlock(node);\n  node.isCode = node.nodeName === 'CODE' || node.parentNode.isCode;\n  node.isBlank = isBlank(node);\n  node.flankingWhitespace = flankingWhitespace(node, options);\n  return node;\n}\nfunction isBlank(node) {\n  return !isVoid(node) && !isMeaningfulWhenBlank(node) && /^\\s*$/i.test(node.textContent) && !hasVoid(node) && !hasMeaningfulWhenBlank(node);\n}\nfunction flankingWhitespace(node, options) {\n  if (node.isBlock || options.preformattedCode && node.isCode) {\n    return {\n      leading: '',\n      trailing: ''\n    };\n  }\n  var edges = edgeWhitespace(node.textContent);\n\n  // abandon leading ASCII WS if left-flanked by ASCII WS\n  if (edges.leadingAscii && isFlankedByWhitespace('left', node, options)) {\n    edges.leading = edges.leadingNonAscii;\n  }\n\n  // abandon trailing ASCII WS if right-flanked by ASCII WS\n  if (edges.trailingAscii && isFlankedByWhitespace('right', node, options)) {\n    edges.trailing = edges.trailingNonAscii;\n  }\n  return {\n    leading: edges.leading,\n    trailing: edges.trailing\n  };\n}\nfunction edgeWhitespace(string) {\n  var m = string.match(/^(([ \\t\\r\\n]*)(\\s*))(?:(?=\\S)[\\s\\S]*\\S)?((\\s*?)([ \\t\\r\\n]*))$/);\n  return {\n    leading: m[1],\n    // whole string for whitespace-only strings\n    leadingAscii: m[2],\n    leadingNonAscii: m[3],\n    trailing: m[4],\n    // empty for whitespace-only strings\n    trailingNonAscii: m[5],\n    trailingAscii: m[6]\n  };\n}\nfunction isFlankedByWhitespace(side, node, options) {\n  var sibling;\n  var regExp;\n  var isFlanked;\n  if (side === 'left') {\n    sibling = node.previousSibling;\n    regExp = / $/;\n  } else {\n    sibling = node.nextSibling;\n    regExp = /^ /;\n  }\n  if (sibling) {\n    if (sibling.nodeType === 3) {\n      isFlanked = regExp.test(sibling.nodeValue);\n    } else if (options.preformattedCode && sibling.nodeName === 'CODE') {\n      isFlanked = false;\n    } else if (sibling.nodeType === 1 && !isBlock(sibling)) {\n      isFlanked = regExp.test(sibling.textContent);\n    }\n  }\n  return isFlanked;\n}\nvar reduce = Array.prototype.reduce;\nvar escapes = [[/\\\\/g, '\\\\\\\\'], [/\\*/g, '\\\\*'], [/^-/g, '\\\\-'], [/^\\+ /g, '\\\\+ '], [/^(=+)/g, '\\\\$1'], [/^(#{1,6}) /g, '\\\\$1 '], [/`/g, '\\\\`'], [/^~~~/g, '\\\\~~~'], [/\\[/g, '\\\\['], [/\\]/g, '\\\\]'], [/^>/g, '\\\\>'], [/_/g, '\\\\_'], [/^(\\d+)\\. /g, '$1\\\\. ']];\nfunction TurndownService(options) {\n  if (!(this instanceof TurndownService)) return new TurndownService(options);\n  var defaults = {\n    rules: rules,\n    headingStyle: 'setext',\n    hr: '* * *',\n    bulletListMarker: '*',\n    codeBlockStyle: 'indented',\n    fence: '```',\n    emDelimiter: '_',\n    strongDelimiter: '**',\n    linkStyle: 'inlined',\n    linkReferenceStyle: 'full',\n    br: '  ',\n    preformattedCode: false,\n    blankReplacement: function (content, node) {\n      return node.isBlock ? '\\n\\n' : '';\n    },\n    keepReplacement: function (content, node) {\n      return node.isBlock ? '\\n\\n' + node.outerHTML + '\\n\\n' : node.outerHTML;\n    },\n    defaultReplacement: function (content, node) {\n      return node.isBlock ? '\\n\\n' + content + '\\n\\n' : content;\n    }\n  };\n  this.options = extend({}, defaults, options);\n  this.rules = new Rules(this.options);\n}\nTurndownService.prototype = {\n  /**\n   * The entry point for converting a string or DOM node to Markdown\n   * @public\n   * @param {String|HTMLElement} input The string or DOM node to convert\n   * @returns A Markdown representation of the input\n   * @type String\n   */\n\n  turndown: function (input) {\n    if (!canConvert(input)) {\n      throw new TypeError(input + ' is not a string, or an element/document/fragment node.');\n    }\n    if (input === '') return '';\n    var output = process.call(this, new RootNode(input, this.options));\n    return postProcess.call(this, output);\n  },\n  /**\n   * Add one or more plugins\n   * @public\n   * @param {Function|Array} plugin The plugin or array of plugins to add\n   * @returns The Turndown instance for chaining\n   * @type Object\n   */\n\n  use: function (plugin) {\n    if (Array.isArray(plugin)) {\n      for (var i = 0; i < plugin.length; i++) this.use(plugin[i]);\n    } else if (typeof plugin === 'function') {\n      plugin(this);\n    } else {\n      throw new TypeError('plugin must be a Function or an Array of Functions');\n    }\n    return this;\n  },\n  /**\n   * Adds a rule\n   * @public\n   * @param {String} key The unique key of the rule\n   * @param {Object} rule The rule\n   * @returns The Turndown instance for chaining\n   * @type Object\n   */\n\n  addRule: function (key, rule) {\n    this.rules.add(key, rule);\n    return this;\n  },\n  /**\n   * Keep a node (as HTML) that matches the filter\n   * @public\n   * @param {String|Array|Function} filter The unique key of the rule\n   * @returns The Turndown instance for chaining\n   * @type Object\n   */\n\n  keep: function (filter) {\n    this.rules.keep(filter);\n    return this;\n  },\n  /**\n   * Remove a node that matches the filter\n   * @public\n   * @param {String|Array|Function} filter The unique key of the rule\n   * @returns The Turndown instance for chaining\n   * @type Object\n   */\n\n  remove: function (filter) {\n    this.rules.remove(filter);\n    return this;\n  },\n  /**\n   * Escapes Markdown syntax\n   * @public\n   * @param {String} string The string to escape\n   * @returns A string with Markdown syntax escaped\n   * @type String\n   */\n\n  escape: function (string) {\n    return escapes.reduce(function (accumulator, escape) {\n      return accumulator.replace(escape[0], escape[1]);\n    }, string);\n  }\n};\n\n/**\n * Reduces a DOM node down to its Markdown string equivalent\n * @private\n * @param {HTMLElement} parentNode The node to convert\n * @returns A Markdown representation of the node\n * @type String\n */\n\nfunction process(parentNode) {\n  var self = this;\n  return reduce.call(parentNode.childNodes, function (output, node) {\n    node = new Node(node, self.options);\n    var replacement = '';\n    if (node.nodeType === 3) {\n      replacement = node.isCode ? node.nodeValue : self.escape(node.nodeValue);\n    } else if (node.nodeType === 1) {\n      replacement = replacementForNode.call(self, node);\n    }\n    return join(output, replacement);\n  }, '');\n}\n\n/**\n * Appends strings as each rule requires and trims the output\n * @private\n * @param {String} output The conversion output\n * @returns A trimmed version of the ouput\n * @type String\n */\n\nfunction postProcess(output) {\n  var self = this;\n  this.rules.forEach(function (rule) {\n    if (typeof rule.append === 'function') {\n      output = join(output, rule.append(self.options));\n    }\n  });\n  return output.replace(/^[\\t\\r\\n]+/, '').replace(/[\\t\\r\\n\\s]+$/, '');\n}\n\n/**\n * Converts an element node to its Markdown equivalent\n * @private\n * @param {HTMLElement} node The node to convert\n * @returns A Markdown representation of the node\n * @type String\n */\n\nfunction replacementForNode(node) {\n  var rule = this.rules.forNode(node);\n  var content = process.call(this, node);\n  var whitespace = node.flankingWhitespace;\n  if (whitespace.leading || whitespace.trailing) content = content.trim();\n  return whitespace.leading + rule.replacement(content, node, this.options) + whitespace.trailing;\n}\n\n/**\n * Joins replacement to the current output with appropriate number of new lines\n * @private\n * @param {String} output The current conversion output\n * @param {String} replacement The string to append to the output\n * @returns Joined output\n * @type String\n */\n\nfunction join(output, replacement) {\n  var s1 = trimTrailingNewlines(output);\n  var s2 = trimLeadingNewlines(replacement);\n  var nls = Math.max(output.length - s1.length, replacement.length - s2.length);\n  var separator = '\\n\\n'.substring(0, nls);\n  return s1 + separator + s2;\n}\n\n/**\n * Determines whether an input can be converted\n * @private\n * @param {String|HTMLElement} input Describe this parameter\n * @returns Describe what it returns\n * @type String|Object|Array|Boolean|Number\n */\n\nfunction canConvert(input) {\n  return input != null && (typeof input === 'string' || input.nodeType && (input.nodeType === 1 || input.nodeType === 9 || input.nodeType === 11));\n}\nexport default TurndownService;", "var highlightRegExp = /highlight-(?:text|source)-([a-z0-9]+)/;\nfunction highlightedCodeBlock(turndownService) {\n  turndownService.addRule('highlightedCodeBlock', {\n    filter: function (node) {\n      var firstChild = node.firstChild;\n      return node.nodeName === 'DIV' && highlightRegExp.test(node.className) && firstChild && firstChild.nodeName === 'PRE';\n    },\n    replacement: function (content, node, options) {\n      var className = node.className || '';\n      var language = (className.match(highlightRegExp) || [null, ''])[1];\n      return '\\n\\n' + options.fence + language + '\\n' + node.firstChild.textContent + '\\n' + options.fence + '\\n\\n';\n    }\n  });\n}\nfunction strikethrough(turndownService) {\n  turndownService.addRule('strikethrough', {\n    filter: ['del', 's', 'strike'],\n    replacement: function (content) {\n      return '~' + content + '~';\n    }\n  });\n}\nvar indexOf = Array.prototype.indexOf;\nvar every = Array.prototype.every;\nvar rules = {};\nrules.tableCell = {\n  filter: ['th', 'td'],\n  replacement: function (content, node) {\n    return cell(content, node);\n  }\n};\nrules.tableRow = {\n  filter: 'tr',\n  replacement: function (content, node) {\n    var borderCells = '';\n    var alignMap = {\n      left: ':--',\n      right: '--:',\n      center: ':-:'\n    };\n    if (isHeadingRow(node)) {\n      for (var i = 0; i < node.childNodes.length; i++) {\n        var border = '---';\n        var align = (node.childNodes[i].getAttribute('align') || '').toLowerCase();\n        if (align) border = alignMap[align] || border;\n        borderCells += cell(border, node.childNodes[i]);\n      }\n    }\n    return '\\n' + content + (borderCells ? '\\n' + borderCells : '');\n  }\n};\nrules.table = {\n  // Only convert tables with a heading row.\n  // Tables with no heading row are kept using `keep` (see below).\n  filter: function (node) {\n    return node.nodeName === 'TABLE' && isHeadingRow(node.rows[0]);\n  },\n  replacement: function (content) {\n    // Ensure there are no blank lines\n    content = content.replace('\\n\\n', '\\n');\n    return '\\n\\n' + content + '\\n\\n';\n  }\n};\nrules.tableSection = {\n  filter: ['thead', 'tbody', 'tfoot'],\n  replacement: function (content) {\n    return content;\n  }\n};\n\n// A tr is a heading row if:\n// - the parent is a THEAD\n// - or if its the first child of the TABLE or the first TBODY (possibly\n//   following a blank THEAD)\n// - and every cell is a TH\nfunction isHeadingRow(tr) {\n  var parentNode = tr.parentNode;\n  return parentNode.nodeName === 'THEAD' || parentNode.firstChild === tr && (parentNode.nodeName === 'TABLE' || isFirstTbody(parentNode)) && every.call(tr.childNodes, function (n) {\n    return n.nodeName === 'TH';\n  });\n}\nfunction isFirstTbody(element) {\n  var previousSibling = element.previousSibling;\n  return element.nodeName === 'TBODY' && (!previousSibling || previousSibling.nodeName === 'THEAD' && /^\\s*$/i.test(previousSibling.textContent));\n}\nfunction cell(content, node) {\n  var index = indexOf.call(node.parentNode.childNodes, node);\n  var prefix = ' ';\n  if (index === 0) prefix = '| ';\n  return prefix + content + ' |';\n}\nfunction tables(turndownService) {\n  turndownService.keep(function (node) {\n    return node.nodeName === 'TABLE' && !isHeadingRow(node.rows[0]);\n  });\n  for (var key in rules) turndownService.addRule(key, rules[key]);\n}\nfunction taskListItems(turndownService) {\n  turndownService.addRule('taskListItems', {\n    filter: function (node) {\n      return node.type === 'checkbox' && node.parentNode.nodeName === 'LI';\n    },\n    replacement: function (content, node) {\n      return (node.checked ? '[x]' : '[ ]') + ' ';\n    }\n  });\n}\nfunction gfm(turndownService) {\n  turndownService.use([highlightedCodeBlock, strikethrough, tables, taskListItems]);\n}\nexport { gfm, highlightedCodeBlock, strikethrough, tables, taskListItems };", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { HtmlDataProcessor } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { marked } from 'marked';\nimport Turndown from 'turndown';\nimport { gfm } from 'turndown-plugin-gfm';\nimport { ClipboardPipeline } from '@ckeditor/ckeditor5-clipboard/dist/index.js';\n\n/**\n * This is a helper class used by the {@link module:markdown-gfm/markdown Markdown feature} to convert Markdown to HTML.\n */\nclass MarkdownToHtml {\n  _parser;\n  _options = {\n    gfm: true,\n    breaks: true,\n    tables: true,\n    xhtml: true,\n    headerIds: false\n  };\n  constructor() {\n    // Overrides.\n    marked.use({\n      tokenizer: {\n        // Disable the autolink rule in the lexer.\n        autolink: () => null,\n        url: () => null\n      },\n      renderer: {\n        checkbox(...args) {\n          // Remove bogus space after <input type=\"checkbox\"> because it would be preserved\n          // by DomConverter as it's next to an inline object.\n          return Object.getPrototypeOf(this).checkbox.call(this, ...args).trimRight();\n        },\n        code(...args) {\n          // Since marked v1.2.8, every <code> gets a trailing \"\\n\" whether it originally\n          // ended with one or not (see https://github.com/markedjs/marked/issues/1884 to learn why).\n          // This results in a redundant soft break in the model when loaded into the editor, which\n          // is best prevented at this stage. See https://github.com/ckeditor/ckeditor5/issues/11124.\n          return Object.getPrototypeOf(this).code.call(this, ...args).replace('\\n</code>', '</code>');\n        }\n      }\n    });\n    this._parser = marked;\n  }\n  parse(markdown) {\n    return this._parser.parse(markdown, this._options);\n  }\n}\nconst autolinkRegex = /* #__PURE__ */new RegExp(\n// Prefix.\n/\\b(?:(?:https?|ftp):\\/\\/|www\\.)/.source +\n// Domain name.\n/(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})/.source +\n// The rest.\n/(?:[^\\s<>]*)/.source, 'gi');\nclass UpdatedTurndown extends Turndown {\n  escape(string) {\n    const originalEscape = super.escape;\n    function escape(string) {\n      string = originalEscape(string);\n      // Escape \"<\".\n      string = string.replace(/</g, '\\\\<');\n      return string;\n    }\n    // Urls should not be escaped. Our strategy is using a regex to find them and escape everything\n    // which is out of the matches parts.\n    let escaped = '';\n    let lastLinkEnd = 0;\n    for (const match of this._matchAutolink(string)) {\n      const index = match.index;\n      // Append the substring between the last match and the current one (if anything).\n      if (index > lastLinkEnd) {\n        escaped += escape(string.substring(lastLinkEnd, index));\n      }\n      const matchedURL = match[0];\n      escaped += matchedURL;\n      lastLinkEnd = index + matchedURL.length;\n    }\n    // Add text after the last link or at the string start if no matches.\n    if (lastLinkEnd < string.length) {\n      escaped += escape(string.substring(lastLinkEnd, string.length));\n    }\n    return escaped;\n  }\n  /**\n  * Trimming end of link.\n  * https://github.github.com/gfm/#autolinks-extension-\n  */\n  *_matchAutolink(string) {\n    for (const match of string.matchAll(autolinkRegex)) {\n      const matched = match[0];\n      const length = this._autolinkFindEnd(matched);\n      yield Object.assign([matched.substring(0, length)], {\n        index: match.index\n      });\n      // We could adjust regex.lastIndex but it's not needed because what we skipped is for sure not a valid URL.\n    }\n  }\n  /**\n  * Returns the new length of the link (after it would trim trailing characters).\n  */\n  _autolinkFindEnd(string) {\n    let length = string.length;\n    while (length > 0) {\n      const char = string[length - 1];\n      if ('?!.,:*_~\\'\"'.includes(char)) {\n        length--;\n      } else if (char == ')') {\n        let openBrackets = 0;\n        for (let i = 0; i < length; i++) {\n          if (string[i] == '(') {\n            openBrackets++;\n          } else if (string[i] == ')') {\n            openBrackets--;\n          }\n        }\n        // If there is fewer opening brackets then closing ones we should remove a closing bracket.\n        if (openBrackets < 0) {\n          length--;\n        } else {\n          break;\n        }\n      } else {\n        break;\n      }\n    }\n    return length;\n  }\n}\n/**\n * This is a helper class used by the {@link module:markdown-gfm/markdown Markdown feature} to convert HTML to Markdown.\n */\nclass HtmlToMarkdown {\n  _parser;\n  constructor() {\n    this._parser = this._createParser();\n  }\n  parse(html) {\n    return this._parser.turndown(html);\n  }\n  keep(elements) {\n    this._parser.keep(elements);\n  }\n  _createParser() {\n    const parser = new UpdatedTurndown({\n      codeBlockStyle: 'fenced',\n      hr: '---',\n      headingStyle: 'atx'\n    });\n    parser.use([gfm, this._todoList]);\n    return parser;\n  }\n  // This is a copy of the original taskListItems rule from turndown-plugin-gfm, with minor changes.\n  _todoList(turndown) {\n    turndown.addRule('taskListItems', {\n      filter(node) {\n        return node.type === 'checkbox' && (\n        // Changes here as CKEditor outputs a deeper structure.\n        node.parentNode.nodeName === 'LI' || node.parentNode.parentNode.nodeName === 'LI');\n      },\n      replacement(content, node) {\n        return (node.checked ? '[x]' : '[ ]') + ' ';\n      }\n    });\n  }\n}\n\n/**\n * This data processor implementation uses GitHub Flavored Markdown as input/output data.\n *\n * See the {@glink features/markdown Markdown output} guide to learn more on how to enable it.\n */\nclass GFMDataProcessor {\n  /**\n  * HTML data processor used to process HTML produced by the Markdown-to-HTML converter and the other way.\n  */\n  _htmlDP;\n  /**\n  * Helper for converting Markdown to HTML.\n  */\n  _markdown2html;\n  /**\n  * Helper for converting HTML to Markdown.\n  */\n  _html2markdown;\n  /**\n  * Creates a new instance of the Markdown data processor class.\n  */\n  constructor(document) {\n    this._htmlDP = new HtmlDataProcessor(document);\n    this._markdown2html = new MarkdownToHtml();\n    this._html2markdown = new HtmlToMarkdown();\n  }\n  /**\n  * Keeps the specified element in the output as HTML. This is useful if the editor contains\n  * features producing HTML that is not a part of the Markdown standard.\n  *\n  * By default, all HTML tags are removed.\n  *\n  * @param element The element name to be kept.\n  */\n  keepHtml(element) {\n    this._html2markdown.keep([element]);\n  }\n  /**\n  * Converts the provided Markdown string to a view tree.\n  *\n  * @param data A Markdown string.\n  * @returns The converted view element.\n  */\n  toView(data) {\n    const html = this._markdown2html.parse(data);\n    return this._htmlDP.toView(html);\n  }\n  /**\n  * Converts the provided {@link module:engine/view/documentfragment~DocumentFragment} to data format &ndash; in this\n  * case to a Markdown string.\n  *\n  * @returns Markdown string.\n  */\n  toData(viewFragment) {\n    const html = this._htmlDP.toData(viewFragment);\n    return this._html2markdown.parse(html);\n  }\n  /**\n  * Registers a {@link module:engine/view/matcher~MatcherPattern} for view elements whose content should be treated as raw data\n  * and not processed during the conversion from Markdown to view elements.\n  *\n  * The raw data can be later accessed by a\n  * {@link module:engine/view/element~Element#getCustomProperty custom property of a view element} called `\"$rawContent\"`.\n  *\n  * @param pattern The pattern matching all view elements whose content should\n  * be treated as raw data.\n  */\n  registerRawContentMatcher(pattern) {\n    this._htmlDP.registerRawContentMatcher(pattern);\n  }\n  /**\n  * This method does not have any effect on the data processor result. It exists for compatibility with the\n  * {@link module:engine/dataprocessor/dataprocessor~DataProcessor `DataProcessor` interface}.\n  */\n  useFillerType() {}\n}\n\n/**\n * The GitHub Flavored Markdown (GFM) plugin.\n *\n * For a detailed overview, check the {@glink features/markdown Markdown feature} guide.\n */\nclass Markdown extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.data.processor = new GFMDataProcessor(editor.data.viewDocument);\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Markdown';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nconst ALLOWED_MARKDOWN_FIRST_LEVEL_TAGS = ['SPAN', 'BR', 'PRE', 'CODE'];\n/**\n * The GitHub Flavored Markdown (GFM) paste plugin.\n *\n * For a detailed overview, check the {@glink features/pasting/paste-markdown Paste Markdown feature} guide.\n */\nclass PasteFromMarkdownExperimental extends Plugin {\n  /**\n  * @internal\n  */\n  _gfmDataProcessor;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._gfmDataProcessor = new GFMDataProcessor(editor.data.viewDocument);\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'PasteFromMarkdownExperimental';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ClipboardPipeline];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const view = editor.editing.view;\n    const viewDocument = view.document;\n    const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n    let shiftPressed = false;\n    this.listenTo(viewDocument, 'keydown', (evt, data) => {\n      shiftPressed = data.shiftKey;\n    });\n    this.listenTo(clipboardPipeline, 'inputTransformation', (evt, data) => {\n      if (shiftPressed) {\n        return;\n      }\n      const dataAsTextHtml = data.dataTransfer.getData('text/html');\n      if (!dataAsTextHtml) {\n        const dataAsTextPlain = data.dataTransfer.getData('text/plain');\n        data.content = this._gfmDataProcessor.toView(dataAsTextPlain);\n        return;\n      }\n      const markdownFromHtml = this._parseMarkdownFromHtml(dataAsTextHtml);\n      if (markdownFromHtml) {\n        data.content = this._gfmDataProcessor.toView(markdownFromHtml);\n      }\n    });\n  }\n  /**\n  * Determines if the code copied from a website in the `text/html` type can be parsed as Markdown.\n  * It removes any OS-specific HTML tags, for example, <meta> on macOS and <!--StartFragment--> on Windows.\n  * Then removes a single wrapper HTML tag or wrappers for sibling tags, and if there are no more tags left,\n  * returns the remaining text. Returns null if there are any remaining HTML tags detected.\n  *\n  * @param htmlString Clipboard content in the `text/html` type format.\n  */\n  _parseMarkdownFromHtml(htmlString) {\n    const withoutOsSpecificTags = this._removeOsSpecificTags(htmlString);\n    if (!this._containsOnlyAllowedFirstLevelTags(withoutOsSpecificTags)) {\n      return null;\n    }\n    const withoutWrapperTag = this._removeFirstLevelWrapperTagsAndBrs(withoutOsSpecificTags);\n    if (this._containsAnyRemainingHtmlTags(withoutWrapperTag)) {\n      return null;\n    }\n    return this._replaceHtmlReservedEntitiesWithCharacters(withoutWrapperTag);\n  }\n  /**\n  * Removes OS-specific tags.\n  *\n  * @param htmlString Clipboard content in the `text/html` type format.\n  */\n  _removeOsSpecificTags(htmlString) {\n    // Removing the <meta> tag present on Mac.\n    const withoutMetaTag = htmlString.replace(/^<meta\\b[^>]*>/, '').trim();\n    // Removing the <html> tag present on Windows.\n    const withoutHtmlTag = withoutMetaTag.replace(/^<html>/, '').replace(/<\\/html>$/, '').trim();\n    // Removing the <body> tag present on Windows.\n    const withoutBodyTag = withoutHtmlTag.replace(/^<body>/, '').replace(/<\\/body>$/, '').trim();\n    // Removing the <!--StartFragment--> tag present on Windows.\n    return withoutBodyTag.replace(/^<!--StartFragment-->/, '').replace(/<!--EndFragment-->$/, '').trim();\n  }\n  /**\n  * If the input HTML string contains any first-level formatting tags\n  * like <b>, <strong>, or <i>, we should not treat it as Markdown.\n  *\n  * @param htmlString Clipboard content.\n  */\n  _containsOnlyAllowedFirstLevelTags(htmlString) {\n    const parser = new DOMParser();\n    const {\n      body: tempElement\n    } = parser.parseFromString(htmlString, 'text/html');\n    const tagNames = Array.from(tempElement.children).map(el => el.tagName);\n    return tagNames.every(el => ALLOWED_MARKDOWN_FIRST_LEVEL_TAGS.includes(el));\n  }\n  /**\n  * Removes multiple HTML wrapper tags from a list of sibling HTML tags.\n  *\n  * @param htmlString Clipboard content without any OS-specific tags.\n  */\n  _removeFirstLevelWrapperTagsAndBrs(htmlString) {\n    const parser = new DOMParser();\n    const {\n      body: tempElement\n    } = parser.parseFromString(htmlString, 'text/html');\n    const brElements = tempElement.querySelectorAll('br');\n    for (const br of brElements) {\n      br.replaceWith('\\n');\n    }\n    const outerElements = tempElement.querySelectorAll(':scope > *');\n    for (const element of outerElements) {\n      const elementClone = element.cloneNode(true);\n      element.replaceWith(...elementClone.childNodes);\n    }\n    return tempElement.innerHTML;\n  }\n  /**\n  * Determines if a string contains any HTML tags.\n  */\n  _containsAnyRemainingHtmlTags(str) {\n    return str.includes('<');\n  }\n  /**\n  * Replaces the reserved HTML entities with the actual characters.\n  *\n  * @param htmlString Clipboard content without any tags.\n  */\n  _replaceHtmlReservedEntitiesWithCharacters(htmlString) {\n    return htmlString.replace(/&gt;/g, '>').replace(/&lt;/g, '<').replace(/&nbsp;/g, ' ');\n  }\n}\nexport { GFMDataProcessor, Markdown, MarkdownToHtml, PasteFromMarkdownExperimental };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { toWidget, isWidget, findOptimalInsertionRange, Widget, WidgetToolbarRepository } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { logWarning, toArray, first, global, FocusTracker, KeystrokeHandler } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { IconView, Template, View, submitHandler, LabeledFieldView, createLabeledInputText, Dialog, ButtonView, MenuBarMenuListItemButtonView, CssTransitionDisablerMixin } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconMediaPlaceholder, IconMedia } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { LivePosition, LiveRange } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { Clipboard } from '@ckeditor/ckeditor5-clipboard/dist/index.js';\nimport { Delete } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { Undo } from '@ckeditor/ckeditor5-undo/dist/index.js';\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module media-embed/converters\n    */ /**\n       * Returns a function that converts the model \"url\" attribute to the view representation.\n       *\n       * Depending on the configuration, the view representation can be \"semantic\" (for the data pipeline):\n       *\n       * ```html\n       * <figure class=\"media\">\n       * \t<oembed url=\"foo\"></oembed>\n       * </figure>\n       * ```\n       *\n       * or \"non-semantic\" (for the editing view pipeline):\n       *\n       * ```html\n       * <figure class=\"media\">\n       * \t<div data-oembed-url=\"foo\">[ non-semantic media preview for \"foo\" ]</div>\n       * </figure>\n       * ```\n       *\n       * **Note:** Changing the model \"url\" attribute replaces the entire content of the\n       * `<figure>` in the view.\n       *\n       * @param registry The registry providing\n       * the media and their content.\n       * @param options options object with following properties:\n       * - elementName When set, overrides the default element name for semantic media embeds.\n       * - renderMediaPreview When `true`, the converter will create the view in the non-semantic form.\n       * - renderForEditingView When `true`, the converter will create a view specific for the\n       * editing pipeline (e.g. including CSS classes, content placeholders).\n       */\nfunction modelToViewUrlAttributeConverter(registry, options) {\n  const converter = (evt, data, conversionApi) => {\n    if (!conversionApi.consumable.consume(data.item, evt.name)) {\n      return;\n    }\n    const url = data.attributeNewValue;\n    const viewWriter = conversionApi.writer;\n    const figure = conversionApi.mapper.toViewElement(data.item);\n    const mediaContentElement = [...figure.getChildren()].find(child => child.getCustomProperty('media-content'));\n    // TODO: removing the wrapper and creating it from scratch is a hack. We can do better than that.\n    viewWriter.remove(mediaContentElement);\n    const mediaViewElement = registry.getMediaViewElement(viewWriter, url, options);\n    viewWriter.insert(viewWriter.createPositionAt(figure, 0), mediaViewElement);\n  };\n  return dispatcher => {\n    dispatcher.on('attribute:url:media', converter);\n  };\n}\n\n/**\n * Converts a given {@link module:engine/view/element~Element} to a media embed widget:\n * * Adds a {@link module:engine/view/element~Element#_setCustomProperty custom property} allowing to recognize the media widget element.\n * * Calls the {@link module:widget/utils~toWidget} function with the proper element's label creator.\n *\n * @param writer An instance of the view writer.\n * @param label The element's label.\n */\nfunction toMediaWidget(viewElement, writer, label) {\n  writer.setCustomProperty('media', true, viewElement);\n  return toWidget(viewElement, writer, {\n    label\n  });\n}\n/**\n * Returns a media widget editing view element if one is selected.\n */\nfunction getSelectedMediaViewWidget(selection) {\n  const viewElement = selection.getSelectedElement();\n  if (viewElement && isMediaWidget(viewElement)) {\n    return viewElement;\n  }\n  return null;\n}\n/**\n * Checks if a given view element is a media widget.\n */\nfunction isMediaWidget(viewElement) {\n  return !!viewElement.getCustomProperty('media') && isWidget(viewElement);\n}\n/**\n * Creates a view element representing the media. Either a \"semantic\" one for the data pipeline:\n *\n * ```html\n * <figure class=\"media\">\n * \t<oembed url=\"foo\"></oembed>\n * </figure>\n * ```\n *\n * or a \"non-semantic\" (for the editing view pipeline):\n *\n * ```html\n * <figure class=\"media\">\n * \t<div data-oembed-url=\"foo\">[ non-semantic media preview for \"foo\" ]</div>\n * </figure>\n * ```\n */\nfunction createMediaFigureElement(writer, registry, url, options) {\n  return writer.createContainerElement('figure', {\n    class: 'media'\n  }, [registry.getMediaViewElement(writer, url, options), writer.createSlot()]);\n}\n/**\n * Returns a selected media element in the model, if any.\n */\nfunction getSelectedMediaModelWidget(selection) {\n  const selectedElement = selection.getSelectedElement();\n  if (selectedElement && selectedElement.is('element', 'media')) {\n    return selectedElement;\n  }\n  return null;\n}\n/**\n * Creates a media element and inserts it into the model.\n *\n * **Note**: This method will use {@link module:engine/model/model~Model#insertContent `model.insertContent()`} logic of inserting content\n * if no `insertPosition` is passed.\n *\n * @param url An URL of an embeddable media.\n * @param findOptimalPosition If true it will try to find optimal position to insert media without breaking content\n * in which a selection is.\n */\nfunction insertMedia(model, url, selectable, findOptimalPosition) {\n  model.change(writer => {\n    const mediaElement = writer.createElement('media', {\n      url\n    });\n    model.insertObject(mediaElement, selectable, null, {\n      setSelection: 'on',\n      findOptimalPosition: findOptimalPosition ? 'auto' : undefined\n    });\n  });\n}\n\n/**\n * The insert media command.\n *\n * The command is registered by the {@link module:media-embed/mediaembedediting~MediaEmbedEditing} as `'mediaEmbed'`.\n *\n * To insert media at the current selection, execute the command and specify the URL:\n *\n * ```ts\n * editor.execute( 'mediaEmbed', 'http://url.to.the/media' );\n * ```\n */\nclass MediaEmbedCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedMedia = getSelectedMediaModelWidget(selection);\n    this.value = selectedMedia ? selectedMedia.getAttribute('url') : undefined;\n    this.isEnabled = isMediaSelected(selection) || isAllowedInParent(selection, model);\n  }\n  /**\n  * Executes the command, which either:\n  *\n  * * updates the URL of the selected media,\n  * * inserts the new media into the editor and puts the selection around it.\n  *\n  * @fires execute\n  * @param url The URL of the media.\n  */\n  execute(url) {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedMedia = getSelectedMediaModelWidget(selection);\n    if (selectedMedia) {\n      model.change(writer => {\n        writer.setAttribute('url', url, selectedMedia);\n      });\n    } else {\n      insertMedia(model, url, selection, true);\n    }\n  }\n}\n/**\n * Checks if the media embed is allowed in the parent.\n */\nfunction isAllowedInParent(selection, model) {\n  const insertionRange = findOptimalInsertionRange(selection, model);\n  let parent = insertionRange.start.parent;\n  // The model.insertContent() will remove empty parent (unless it is a $root or a limit).\n  if (parent.isEmpty && !model.schema.isLimit(parent)) {\n    parent = parent.parent;\n  }\n  return model.schema.checkChild(parent, 'media');\n}\n/**\n * Checks if the media object is selected.\n */\nfunction isMediaSelected(selection) {\n  const element = selection.getSelectedElement();\n  return !!element && element.name === 'media';\n}\nconst mediaPlaceholderIconViewBox = '0 0 64 42';\n/**\n * A bridge between the raw media content provider definitions and the editor view content.\n *\n * It helps translating media URLs to corresponding {@link module:engine/view/element~Element view elements}.\n *\n * Mostly used by the {@link module:media-embed/mediaembedediting~MediaEmbedEditing} plugin.\n */\nclass MediaRegistry {\n  /**\n  * The {@link module:utils/locale~Locale} instance.\n  */\n  locale;\n  /**\n  * The media provider definitions available for the registry. Usually corresponding with the\n  * {@link module:media-embed/mediaembedconfig~MediaEmbedConfig media configuration}.\n  */\n  providerDefinitions;\n  /**\n  * Creates an instance of the {@link module:media-embed/mediaregistry~MediaRegistry} class.\n  *\n  * @param locale The localization services instance.\n  * @param config The configuration of the media embed feature.\n  */\n  constructor(locale, config) {\n    const providers = config.providers;\n    const extraProviders = config.extraProviders || [];\n    const removedProviders = new Set(config.removeProviders);\n    const providerDefinitions = providers.concat(extraProviders).filter(provider => {\n      const name = provider.name;\n      if (!name) {\n        /**\n        * One of the providers (or extra providers) specified in the media embed configuration\n        * has no name and will not be used by the editor. In order to get this media\n        * provider working, double check your editor configuration.\n        *\n        * @error media-embed-no-provider-name\n        */\n        logWarning('media-embed-no-provider-name', {\n          provider\n        });\n        return false;\n      }\n      return !removedProviders.has(name);\n    });\n    this.locale = locale;\n    this.providerDefinitions = providerDefinitions;\n  }\n  /**\n  * Checks whether the passed URL is representing a certain media type allowed in the editor.\n  *\n  * @param url The URL to be checked\n  */\n  hasMedia(url) {\n    return !!this._getMedia(url);\n  }\n  /**\n  * For the given media URL string and options, it returns the {@link module:engine/view/element~Element view element}\n  * representing that media.\n  *\n  * **Note:** If no URL is specified, an empty view element is returned.\n  *\n  * @param writer The view writer used to produce a view element.\n  * @param url The URL to be translated into a view element.\n  */\n  getMediaViewElement(writer, url, options) {\n    return this._getMedia(url).getViewElement(writer, options);\n  }\n  /**\n  * Returns a `Media` instance for the given URL.\n  *\n  * @param url The URL of the media.\n  * @returns The `Media` instance or `null` when there is none.\n  */\n  _getMedia(url) {\n    if (!url) {\n      return new Media(this.locale);\n    }\n    url = url.trim();\n    for (const definition of this.providerDefinitions) {\n      const previewRenderer = definition.html;\n      const pattern = toArray(definition.url);\n      for (const subPattern of pattern) {\n        const match = this._getUrlMatches(url, subPattern);\n        if (match) {\n          return new Media(this.locale, url, match, previewRenderer);\n        }\n      }\n    }\n    return null;\n  }\n  /**\n  * Tries to match `url` to `pattern`.\n  *\n  * @param url The URL of the media.\n  * @param pattern The pattern that should accept the media URL.\n  */\n  _getUrlMatches(url, pattern) {\n    // 1. Try to match without stripping the protocol and \"www\" subdomain.\n    let match = url.match(pattern);\n    if (match) {\n      return match;\n    }\n    // 2. Try to match after stripping the protocol.\n    let rawUrl = url.replace(/^https?:\\/\\//, '');\n    match = rawUrl.match(pattern);\n    if (match) {\n      return match;\n    }\n    // 3. Try to match after stripping the \"www\" subdomain.\n    rawUrl = rawUrl.replace(/^www\\./, '');\n    match = rawUrl.match(pattern);\n    if (match) {\n      return match;\n    }\n    return null;\n  }\n}\n/**\n * Represents media defined by the provider configuration.\n *\n * It can be rendered to the {@link module:engine/view/element~Element view element} and used in the editing or data pipeline.\n */\nclass Media {\n  /**\n  * The URL this Media instance represents.\n  */\n  url;\n  /**\n  * Shorthand for {@link module:utils/locale~Locale#t}.\n  *\n  * @see module:utils/locale~Locale#t\n  */\n  _locale;\n  /**\n  * The output of the `RegExp.match` which validated the {@link #url} of this media.\n  */\n  _match;\n  /**\n  * The function returning the HTML string preview of this media.\n  */\n  _previewRenderer;\n  constructor(locale, url, match, previewRenderer) {\n    this.url = this._getValidUrl(url);\n    this._locale = locale;\n    this._match = match;\n    this._previewRenderer = previewRenderer;\n  }\n  /**\n  * Returns the view element representation of the media.\n  *\n  * @param writer The view writer used to produce a view element.\n  */\n  getViewElement(writer, options) {\n    const attributes = {};\n    let viewElement;\n    if (options.renderForEditingView || options.renderMediaPreview && this.url && this._previewRenderer) {\n      if (this.url) {\n        attributes['data-oembed-url'] = this.url;\n      }\n      if (options.renderForEditingView) {\n        attributes.class = 'ck-media__wrapper';\n      }\n      const mediaHtml = this._getPreviewHtml(options);\n      viewElement = writer.createRawElement('div', attributes, (domElement, domConverter) => {\n        domConverter.setContentOf(domElement, mediaHtml);\n      });\n    } else {\n      if (this.url) {\n        attributes.url = this.url;\n      }\n      viewElement = writer.createEmptyElement(options.elementName, attributes);\n    }\n    writer.setCustomProperty('media-content', true, viewElement);\n    return viewElement;\n  }\n  /**\n  * Returns the HTML string of the media content preview.\n  */\n  _getPreviewHtml(options) {\n    if (this._previewRenderer) {\n      return this._previewRenderer(this._match);\n    } else {\n      // The placeholder only makes sense for editing view and media which have URLs.\n      // Placeholder is never displayed in data and URL-less media have no content.\n      if (this.url && options.renderForEditingView) {\n        return this._getPlaceholderHtml();\n      }\n      return '';\n    }\n  }\n  /**\n  * Returns the placeholder HTML when the media has no content preview.\n  */\n  _getPlaceholderHtml() {\n    const icon = new IconView();\n    const t = this._locale.t;\n    icon.content = IconMediaPlaceholder;\n    icon.viewBox = mediaPlaceholderIconViewBox;\n    const placeholder = new Template({\n      tag: 'div',\n      attributes: {\n        class: 'ck ck-reset_all ck-media__placeholder'\n      },\n      children: [{\n        tag: 'div',\n        attributes: {\n          class: 'ck-media__placeholder__icon'\n        },\n        children: [icon]\n      }, {\n        tag: 'a',\n        attributes: {\n          class: 'ck-media__placeholder__url',\n          target: '_blank',\n          rel: 'noopener noreferrer',\n          href: this.url,\n          'data-cke-tooltip-text': t('Open media in new tab')\n        },\n        children: [{\n          tag: 'span',\n          attributes: {\n            class: 'ck-media__placeholder__url__text'\n          },\n          children: [this.url]\n        }]\n      }]\n    }).render();\n    return placeholder.outerHTML;\n  }\n  /**\n  * Returns the full URL to the specified media.\n  *\n  * @param url The URL of the media.\n  */\n  _getValidUrl(url) {\n    if (!url) {\n      return null;\n    }\n    if (url.match(/^https?/)) {\n      return url;\n    }\n    return 'https://' + url;\n  }\n}\n\n/**\n * The media embed editing feature.\n */\nclass MediaEmbedEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'MediaEmbedEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * The media registry managing the media providers in the editor.\n  */\n  registry;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('mediaEmbed', {\n      elementName: 'oembed',\n      providers: [{\n        name: 'dailymotion',\n        url: [/^dailymotion\\.com\\/video\\/(\\w+)/, /^dai.ly\\/(\\w+)/],\n        html: match => {\n          const id = match[1];\n          return '<div style=\"position: relative; padding-bottom: 100%; height: 0; \">' + `<iframe src=\"https://www.dailymotion.com/embed/video/${id}\" ` + 'style=\"position: absolute; width: 100%; height: 100%; top: 0; left: 0;\" ' + 'frameborder=\"0\" width=\"480\" height=\"270\" allowfullscreen allow=\"autoplay\">' + '</iframe>' + '</div>';\n        }\n      }, {\n        name: 'spotify',\n        url: [/^open\\.spotify\\.com\\/(artist\\/\\w+)/, /^open\\.spotify\\.com\\/(album\\/\\w+)/, /^open\\.spotify\\.com\\/(track\\/\\w+)/],\n        html: match => {\n          const id = match[1];\n          return '<div style=\"position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;\">' + `<iframe src=\"https://open.spotify.com/embed/${id}\" ` + 'style=\"position: absolute; width: 100%; height: 100%; top: 0; left: 0;\" ' + 'frameborder=\"0\" allowtransparency=\"true\" allow=\"encrypted-media\">' + '</iframe>' + '</div>';\n        }\n      }, {\n        name: 'youtube',\n        url: [/^(?:m\\.)?youtube\\.com\\/watch\\?v=([\\w-]+)(?:&t=(\\d+))?/, /^(?:m\\.)?youtube\\.com\\/shorts\\/([\\w-]+)(?:\\?t=(\\d+))?/, /^(?:m\\.)?youtube\\.com\\/v\\/([\\w-]+)(?:\\?t=(\\d+))?/, /^youtube\\.com\\/embed\\/([\\w-]+)(?:\\?start=(\\d+))?/, /^youtu\\.be\\/([\\w-]+)(?:\\?t=(\\d+))?/],\n        html: match => {\n          const id = match[1];\n          const time = match[2];\n          return '<div style=\"position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;\">' + `<iframe src=\"https://www.youtube.com/embed/${id}${time ? `?start=${time}` : ''}\" ` + 'style=\"position: absolute; width: 100%; height: 100%; top: 0; left: 0;\" ' + 'frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen>' + '</iframe>' + '</div>';\n        }\n      }, {\n        name: 'vimeo',\n        url: [/^vimeo\\.com\\/(\\d+)/, /^vimeo\\.com\\/[^/]+\\/[^/]+\\/video\\/(\\d+)/, /^vimeo\\.com\\/album\\/[^/]+\\/video\\/(\\d+)/, /^vimeo\\.com\\/channels\\/[^/]+\\/(\\d+)/, /^vimeo\\.com\\/groups\\/[^/]+\\/videos\\/(\\d+)/, /^vimeo\\.com\\/ondemand\\/[^/]+\\/(\\d+)/, /^player\\.vimeo\\.com\\/video\\/(\\d+)/],\n        html: match => {\n          const id = match[1];\n          return '<div style=\"position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;\">' + `<iframe src=\"https://player.vimeo.com/video/${id}\" ` + 'style=\"position: absolute; width: 100%; height: 100%; top: 0; left: 0;\" ' + 'frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen>' + '</iframe>' + '</div>';\n        }\n      }, {\n        name: 'instagram',\n        url: [/^instagram\\.com\\/p\\/(\\w+)/, /^instagram\\.com\\/reel\\/(\\w+)/]\n      }, {\n        name: 'twitter',\n        url: [/^twitter\\.com/, /^x\\.com/]\n      }, {\n        name: 'googleMaps',\n        url: [/^google\\.com\\/maps/, /^goo\\.gl\\/maps/, /^maps\\.google\\.com/, /^maps\\.app\\.goo\\.gl/]\n      }, {\n        name: 'flickr',\n        url: /^flickr\\.com/\n      }, {\n        name: 'facebook',\n        url: /^facebook\\.com/\n      }]\n    });\n    this.registry = new MediaRegistry(editor.locale, editor.config.get('mediaEmbed'));\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const t = editor.t;\n    const conversion = editor.conversion;\n    const renderMediaPreview = editor.config.get('mediaEmbed.previewsInData');\n    const elementName = editor.config.get('mediaEmbed.elementName');\n    const registry = this.registry;\n    editor.commands.add('mediaEmbed', new MediaEmbedCommand(editor));\n    // Configure the schema.\n    schema.register('media', {\n      inheritAllFrom: '$blockObject',\n      allowAttributes: ['url']\n    });\n    // Model -> Data\n    conversion.for('dataDowncast').elementToStructure({\n      model: 'media',\n      view: (modelElement, {\n        writer\n      }) => {\n        const url = modelElement.getAttribute('url');\n        return createMediaFigureElement(writer, registry, url, {\n          elementName,\n          renderMediaPreview: !!url && renderMediaPreview\n        });\n      }\n    });\n    // Model -> Data (url -> data-oembed-url)\n    conversion.for('dataDowncast').add(modelToViewUrlAttributeConverter(registry, {\n      elementName,\n      renderMediaPreview\n    }));\n    // Model -> View (element)\n    conversion.for('editingDowncast').elementToStructure({\n      model: 'media',\n      view: (modelElement, {\n        writer\n      }) => {\n        const url = modelElement.getAttribute('url');\n        const figure = createMediaFigureElement(writer, registry, url, {\n          elementName,\n          renderForEditingView: true\n        });\n        return toMediaWidget(figure, writer, t('media widget'));\n      }\n    });\n    // Model -> View (url -> data-oembed-url)\n    conversion.for('editingDowncast').add(modelToViewUrlAttributeConverter(registry, {\n      elementName,\n      renderForEditingView: true\n    }));\n    // View -> Model (data-oembed-url -> url)\n    conversion.for('upcast') // Upcast semantic media.\n    .elementToElement({\n      view: element => ['oembed', elementName].includes(element.name) && element.getAttribute('url') ? {\n        name: true\n      } : null,\n      model: (viewMedia, {\n        writer\n      }) => {\n        const url = viewMedia.getAttribute('url');\n        if (registry.hasMedia(url)) {\n          return writer.createElement('media', {\n            url\n          });\n        }\n        return null;\n      }\n    }) // Upcast non-semantic media.\n    .elementToElement({\n      view: {\n        name: 'div',\n        attributes: {\n          'data-oembed-url': true\n        }\n      },\n      model: (viewMedia, {\n        writer\n      }) => {\n        const url = viewMedia.getAttribute('data-oembed-url');\n        if (registry.hasMedia(url)) {\n          return writer.createElement('media', {\n            url\n          });\n        }\n        return null;\n      }\n    }) // Consume `<figure class=\"media\">` elements, that were left after upcast.\n    .add(dispatcher => {\n      const converter = (evt, data, conversionApi) => {\n        if (!conversionApi.consumable.consume(data.viewItem, {\n          name: true,\n          classes: 'media'\n        })) {\n          return;\n        }\n        const {\n          modelRange,\n          modelCursor\n        } = conversionApi.convertChildren(data.viewItem, data.modelCursor);\n        data.modelRange = modelRange;\n        data.modelCursor = modelCursor;\n        const modelElement = first(modelRange.getItems());\n        if (!modelElement) {\n          // Revert consumed figure so other features can convert it.\n          conversionApi.consumable.revert(data.viewItem, {\n            name: true,\n            classes: 'media'\n          });\n        }\n      };\n      dispatcher.on('element:figure', converter);\n    });\n  }\n}\nconst URL_REGEXP = /^(?:http(s)?:\\/\\/)?[\\w-]+\\.[\\w-.~:/?#[\\]@!$&'()*+,;=%]+$/;\n/**\n * The auto-media embed plugin. It recognizes media links in the pasted content and embeds\n * them shortly after they are injected into the document.\n */\nclass AutoMediaEmbed extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Clipboard, Delete, Undo];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'AutoMediaEmbed';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * The pasteâ€“toâ€“embed `setTimeout` ID. Stored as a property to allow\n  * cleaning of the timeout.\n  */\n  _timeoutId;\n  /**\n  * The position where the `<media>` element will be inserted after the timeout,\n  * determined each time the new content is pasted into the document.\n  */\n  _positionToInsert;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._timeoutId = null;\n    this._positionToInsert = null;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const modelDocument = editor.model.document;\n    // We need to listen on `Clipboard#inputTransformation` because we need to save positions of selection.\n    // After pasting, the content between those positions will be checked for a URL that could be transformed\n    // into media.\n    const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n    this.listenTo(clipboardPipeline, 'inputTransformation', () => {\n      const firstRange = modelDocument.selection.getFirstRange();\n      const leftLivePosition = LivePosition.fromPosition(firstRange.start);\n      leftLivePosition.stickiness = 'toPrevious';\n      const rightLivePosition = LivePosition.fromPosition(firstRange.end);\n      rightLivePosition.stickiness = 'toNext';\n      modelDocument.once('change:data', () => {\n        this._embedMediaBetweenPositions(leftLivePosition, rightLivePosition);\n        leftLivePosition.detach();\n        rightLivePosition.detach();\n      }, {\n        priority: 'high'\n      });\n    });\n    const undoCommand = editor.commands.get('undo');\n    undoCommand.on('execute', () => {\n      if (this._timeoutId) {\n        global.window.clearTimeout(this._timeoutId);\n        this._positionToInsert.detach();\n        this._timeoutId = null;\n        this._positionToInsert = null;\n      }\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Analyzes the part of the document between provided positions in search for a URL representing media.\n  * When the URL is found, it is automatically converted into media.\n  *\n  * @param leftPosition Left position of the selection.\n  * @param rightPosition Right position of the selection.\n  */\n  _embedMediaBetweenPositions(leftPosition, rightPosition) {\n    const editor = this.editor;\n    const mediaRegistry = editor.plugins.get(MediaEmbedEditing).registry;\n    // TODO: Use marker instead of LiveRange & LivePositions.\n    const urlRange = new LiveRange(leftPosition, rightPosition);\n    const walker = urlRange.getWalker({\n      ignoreElementEnd: true\n    });\n    let url = '';\n    for (const node of walker) {\n      if (node.item.is('$textProxy')) {\n        url += node.item.data;\n      }\n    }\n    url = url.trim();\n    // If the URL does not match to universal URL regexp, let's skip that.\n    if (!url.match(URL_REGEXP)) {\n      urlRange.detach();\n      return;\n    }\n    // If the URL represents a media, let's use it.\n    if (!mediaRegistry.hasMedia(url)) {\n      urlRange.detach();\n      return;\n    }\n    const mediaEmbedCommand = editor.commands.get('mediaEmbed');\n    // Do not anything if media element cannot be inserted at the current position (#47).\n    if (!mediaEmbedCommand.isEnabled) {\n      urlRange.detach();\n      return;\n    }\n    // Position won't be available in the `setTimeout` function so let's clone it.\n    this._positionToInsert = LivePosition.fromPosition(leftPosition);\n    // This action mustn't be executed if undo was called between pasting and auto-embedding.\n    this._timeoutId = global.window.setTimeout(() => {\n      editor.model.change(writer => {\n        this._timeoutId = null;\n        writer.remove(urlRange);\n        urlRange.detach();\n        let insertionPosition = null;\n        // Check if position where the media element should be inserted is still valid.\n        // Otherwise leave it as undefined to use document.selection - default behavior of model.insertContent().\n        if (this._positionToInsert.root.rootName !== '$graveyard') {\n          insertionPosition = this._positionToInsert;\n        }\n        insertMedia(editor.model, url, insertionPosition, false);\n        this._positionToInsert.detach();\n        this._positionToInsert = null;\n      });\n      editor.plugins.get(Delete).requestUndoOnBackspace();\n    }, 100);\n  }\n}\n\n/**\n * The media form view controller class.\n *\n * See {@link module:media-embed/ui/mediaformview~MediaFormView}.\n */\nclass MediaFormView extends View {\n  /**\n  * Tracks information about the DOM focus in the form.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * The URL input view.\n  */\n  urlInputView;\n  /**\n  * An array of form validators used by {@link #isValid}.\n  */\n  _validators;\n  /**\n  * The default info text for the {@link #urlInputView}.\n  */\n  _urlInputViewInfoDefault;\n  /**\n  * The info text with an additional tip for the {@link #urlInputView},\n  * displayed when the input has some value.\n  */\n  _urlInputViewInfoTip;\n  /**\n  * @param validators Form validators used by {@link #isValid}.\n  * @param locale The localization services instance.\n  */\n  constructor(validators, locale) {\n    super(locale);\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this.set('mediaURLInputValue', '');\n    this.urlInputView = this._createUrlInput();\n    this._validators = validators;\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-media-form', 'ck-responsive-form'],\n        tabindex: '-1'\n      },\n      children: [this.urlInputView]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    submitHandler({\n      view: this\n    });\n    // Register the view in the focus tracker.\n    this.focusTracker.add(this.urlInputView.element);\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the {@link #urlInputView}.\n  */\n  focus() {\n    this.urlInputView.focus();\n  }\n  /**\n  * The native DOM `value` of the {@link #urlInputView} element.\n  *\n  * **Note**: Do not confuse it with the {@link module:ui/inputtext/inputtextview~InputTextView#value}\n  * which works one way only and may not represent the actual state of the component in the DOM.\n  */\n  get url() {\n    return this.urlInputView.fieldView.element.value.trim();\n  }\n  set url(url) {\n    this.urlInputView.fieldView.value = url.trim();\n  }\n  /**\n  * Validates the form and returns `false` when some fields are invalid.\n  */\n  isValid() {\n    this.resetFormStatus();\n    for (const validator of this._validators) {\n      const errorText = validator(this);\n      // One error per field is enough.\n      if (errorText) {\n        // Apply updated error.\n        this.urlInputView.errorText = errorText;\n        return false;\n      }\n    }\n    return true;\n  }\n  /**\n  * Cleans up the supplementary error and information text of the {@link #urlInputView}\n  * bringing them back to the state when the form has been displayed for the first time.\n  *\n  * See {@link #isValid}.\n  */\n  resetFormStatus() {\n    this.urlInputView.errorText = null;\n    this.urlInputView.infoText = this._urlInputViewInfoDefault;\n  }\n  /**\n  * Creates a labeled input view.\n  *\n  * @returns Labeled input view instance.\n  */\n  _createUrlInput() {\n    const t = this.locale.t;\n    const labeledInput = new LabeledFieldView(this.locale, createLabeledInputText);\n    const inputField = labeledInput.fieldView;\n    this._urlInputViewInfoDefault = t('Paste the media URL in the input.');\n    this._urlInputViewInfoTip = t('Tip: Paste the URL into the content to embed faster.');\n    labeledInput.label = t('Media URL');\n    labeledInput.infoText = this._urlInputViewInfoDefault;\n    inputField.inputMode = 'url';\n    inputField.on('input', () => {\n      // Display the tip text only when there is some value. Otherwise fall back to the default info text.\n      labeledInput.infoText = inputField.element.value ? this._urlInputViewInfoTip : this._urlInputViewInfoDefault;\n      this.mediaURLInputValue = inputField.element.value.trim();\n    });\n    return labeledInput;\n  }\n}\n\n/**\n * The media embed UI plugin.\n */\nclass MediaEmbedUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [MediaEmbedEditing, Dialog];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'MediaEmbedUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  _formView;\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('mediaEmbed', () => {\n      const t = this.editor.locale.t;\n      const button = this._createDialogButton(ButtonView);\n      button.tooltip = true;\n      button.label = t('Insert media');\n      return button;\n    });\n    editor.ui.componentFactory.add('menuBar:mediaEmbed', () => {\n      const t = this.editor.locale.t;\n      const button = this._createDialogButton(MenuBarMenuListItemButtonView);\n      button.label = t('Media');\n      return button;\n    });\n  }\n  /**\n  * Creates a button for menu bar that will show media embed dialog.\n  */\n  _createDialogButton(ButtonClass) {\n    const editor = this.editor;\n    const buttonView = new ButtonClass(editor.locale);\n    const command = editor.commands.get('mediaEmbed');\n    const dialogPlugin = this.editor.plugins.get('Dialog');\n    buttonView.icon = IconMedia;\n    buttonView.bind('isEnabled').to(command, 'isEnabled');\n    buttonView.on('execute', () => {\n      if (dialogPlugin.id === 'mediaEmbed') {\n        dialogPlugin.hide();\n      } else {\n        this._showDialog();\n      }\n    });\n    return buttonView;\n  }\n  _showDialog() {\n    const editor = this.editor;\n    const dialog = editor.plugins.get('Dialog');\n    const command = editor.commands.get('mediaEmbed');\n    const t = editor.locale.t;\n    const isMediaSelected = command.value !== undefined;\n    if (!this._formView) {\n      const registry = editor.plugins.get(MediaEmbedEditing).registry;\n      this._formView = new (CssTransitionDisablerMixin(MediaFormView))(getFormValidators(editor.t, registry), editor.locale);\n      this._formView.on('submit', () => this._handleSubmitForm());\n    }\n    dialog.show({\n      id: 'mediaEmbed',\n      title: t('Media embed'),\n      content: this._formView,\n      isModal: true,\n      onShow: () => {\n        this._formView.url = command.value || '';\n        this._formView.resetFormStatus();\n        this._formView.urlInputView.fieldView.select();\n      },\n      actionButtons: [{\n        label: t('Cancel'),\n        withText: true,\n        onExecute: () => dialog.hide()\n      }, {\n        label: isMediaSelected ? t('Save') : t('Insert'),\n        class: 'ck-button-action',\n        withText: true,\n        onExecute: () => this._handleSubmitForm()\n      }]\n    });\n  }\n  _handleSubmitForm() {\n    const editor = this.editor;\n    const dialog = editor.plugins.get('Dialog');\n    if (this._formView.isValid()) {\n      editor.execute('mediaEmbed', this._formView.url);\n      dialog.hide();\n      editor.editing.view.focus();\n    }\n  }\n}\nfunction getFormValidators(t, registry) {\n  return [form => {\n    if (!form.url.length) {\n      return t('The URL must not be empty.');\n    }\n  }, form => {\n    if (!registry.hasMedia(form.url)) {\n      return t('This media URL is not supported.');\n    }\n  }];\n}\n\n/**\n * The media embed plugin.\n *\n * For a detailed overview, check the {@glink features/media-embed Media Embed feature documentation}.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * The {@link module:media-embed/mediaembedediting~MediaEmbedEditing media embed editing feature},\n * * The {@link module:media-embed/mediaembedui~MediaEmbedUI media embed UI feature} and\n * * The {@link module:media-embed/automediaembed~AutoMediaEmbed auto-media embed feature}.\n */\nclass MediaEmbed extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [MediaEmbedEditing, MediaEmbedUI, AutoMediaEmbed, Widget];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'MediaEmbed';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The media embed toolbar plugin. It creates a toolbar for media embed that shows up when the media element is selected.\n *\n * Instances of toolbar components (e.g. buttons) are created based on the\n * {@link module:media-embed/mediaembedconfig~MediaEmbedConfig#toolbar `media.toolbar` configuration option}.\n */\nclass MediaEmbedToolbar extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [WidgetToolbarRepository];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'MediaEmbedToolbar';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    const t = editor.t;\n    const widgetToolbarRepository = editor.plugins.get(WidgetToolbarRepository);\n    widgetToolbarRepository.register('mediaEmbed', {\n      ariaLabel: t('Media toolbar'),\n      items: editor.config.get('mediaEmbed.toolbar') || [],\n      getRelatedElement: getSelectedMediaViewWidget\n    });\n  }\n}\nexport { AutoMediaEmbed, MediaEmbed, MediaEmbedEditing, MediaEmbedToolbar, MediaEmbedUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { CKEditorError, toMap, uid, Rect, keyCodes, Collection, logWarning, env } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { ListView, View, ListItemView, ContextualBalloon, clickOutsideHandler, ButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { TextWatcher } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { debounce } from 'es-toolkit/compat';\nconst BRACKET_PAIRS = {\n  '(': ')',\n  '[': ']',\n  '{': '}'\n};\n/**\n * The mention command.\n *\n * The command is registered by {@link module:mention/mentionediting~MentionEditing} as `'mention'`.\n *\n * To insert a mention into a range, execute the command and specify a mention object with a range to replace:\n *\n * ```ts\n * const focus = editor.model.document.selection.focus;\n *\n * // It will replace one character before the selection focus with the '#1234' text\n * // with the mention attribute filled with passed attributes.\n * editor.execute( 'mention', {\n * \tmarker: '#',\n * \tmention: {\n * \t\tid: '#1234',\n * \t\tname: 'Foo',\n * \t\ttitle: 'Big Foo'\n * \t},\n * \trange: editor.model.createRange( focus.getShiftedBy( -1 ), focus )\n * } );\n *\n * // It will replace one character before the selection focus with the 'The \"Big Foo\"' text\n * // with the mention attribute filled with passed attributes.\n * editor.execute( 'mention', {\n * \tmarker: '#',\n * \tmention: {\n * \t\tid: '#1234',\n * \t\tname: 'Foo',\n * \t\ttitle: 'Big Foo'\n * \t},\n * \ttext: 'The \"Big Foo\"',\n * \trange: editor.model.createRange( focus.getShiftedBy( -1 ), focus )\n * } );\n *\t```\n */\nclass MentionCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    // Since this command may pass range in execution parameters, it should be checked directly in execute block.\n    this._isEnabledBasedOnSelection = false;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const doc = model.document;\n    this.isEnabled = model.schema.checkAttributeInSelection(doc.selection, 'mention');\n  }\n  /**\n  * Executes the command.\n  *\n  * @param options Options for the executed command.\n  * @param options.mention The mention object to insert. When a string is passed, it will be used to create a plain\n  * object with the name attribute that equals the passed string.\n  * @param options.marker The marker character (e.g. `'@'`).\n  * @param options.text The text of the inserted mention. Defaults to the full mention string composed from `marker` and\n  * `mention` string or `mention.id` if an object is passed.\n  * @param options.range The range to replace.\n  * Note that the replaced range might be shorter than the inserted text with the mention attribute.\n  * @fires execute\n  */\n  execute(options) {\n    const model = this.editor.model;\n    const document = model.document;\n    const selection = document.selection;\n    const mentionData = typeof options.mention == 'string' ? {\n      id: options.mention\n    } : options.mention;\n    const mentionID = mentionData.id;\n    const range = options.range || selection.getFirstRange();\n    // Don't execute command if range is in non-editable place.\n    if (!model.canEditAt(range)) {\n      return;\n    }\n    const mentionText = options.text || mentionID;\n    const mention = _addMentionAttributes({\n      _text: mentionText,\n      id: mentionID\n    }, mentionData);\n    if (!mentionID.startsWith(options.marker)) {\n      /**\n      * The feed item ID must start with the marker character(s).\n      *\n      * Correct mention feed setting:\n      *\n      * ```ts\n      * mentions: [\n      * \t{\n      * \t\tmarker: '@',\n      * \t\tfeed: [ '@Ann', '@Barney', ... ]\n      * \t}\n      * ]\n      * ```\n      *\n      * Incorrect mention feed setting:\n      *\n      * ```ts\n      * mentions: [\n      * \t{\n      * \t\tmarker: '@',\n      * \t\tfeed: [ 'Ann', 'Barney', ... ]\n      * \t}\n      * ]\n      * ```\n      *\n      * See {@link module:mention/mentionconfig~MentionConfig}.\n      *\n      * @error mentioncommand-incorrect-id\n      */\n      throw new CKEditorError('mentioncommand-incorrect-id', this);\n    }\n    model.change(writer => {\n      const currentAttributes = toMap(selection.getAttributes());\n      const attributesWithMention = new Map(currentAttributes.entries());\n      attributesWithMention.set('mention', mention);\n      // Replace a range with the text with a mention.\n      const insertionRange = model.insertContent(writer.createText(mentionText, attributesWithMention), range);\n      const nodeBefore = insertionRange.start.nodeBefore;\n      const nodeAfter = insertionRange.end.nodeAfter;\n      const isFollowedByWhiteSpace = nodeAfter && nodeAfter.is('$text') && nodeAfter.data.startsWith(' ');\n      let isInsertedInBrackets = false;\n      if (nodeBefore && nodeAfter && nodeBefore.is('$text') && nodeAfter.is('$text')) {\n        const precedingCharacter = nodeBefore.data.slice(-1);\n        const isPrecededByOpeningBracket = precedingCharacter in BRACKET_PAIRS;\n        const isFollowedByBracketClosure = isPrecededByOpeningBracket && nodeAfter.data.startsWith(BRACKET_PAIRS[precedingCharacter]);\n        isInsertedInBrackets = isPrecededByOpeningBracket && isFollowedByBracketClosure;\n      }\n      // Don't add a white space if either of the following is true:\n      // * there's already one after the mention;\n      // * the mention was inserted in the empty matching brackets.\n      // https://github.com/ckeditor/ckeditor5/issues/4651\n      if (!isInsertedInBrackets && !isFollowedByWhiteSpace) {\n        model.insertContent(writer.createText(' ', currentAttributes), range.start.getShiftedBy(mentionText.length));\n      }\n    });\n  }\n}\n\n/**\n * The mention editing feature.\n *\n * It introduces the {@link module:mention/mentioncommand~MentionCommand command} and the `mention`\n * attribute in the {@link module:engine/model/model~Model model} which renders in the {@link module:engine/view/view view}\n * as a `<span class=\"mention\" data-mention=\"@mention\">`.\n */\nclass MentionEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'MentionEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const model = editor.model;\n    const doc = model.document;\n    // Allow the mention attribute on all text nodes.\n    model.schema.extend('$text', {\n      allowAttributes: 'mention'\n    });\n    // Upcast conversion.\n    editor.conversion.for('upcast').elementToAttribute({\n      view: {\n        name: 'span',\n        attributes: 'data-mention',\n        classes: 'mention'\n      },\n      model: {\n        key: 'mention',\n        value: viewElement => _toMentionAttribute(viewElement)\n      }\n    });\n    // Downcast conversion.\n    editor.conversion.for('downcast').attributeToElement({\n      model: 'mention',\n      view: createViewMentionElement\n    });\n    editor.conversion.for('downcast').add(preventPartialMentionDowncast);\n    doc.registerPostFixer(writer => removePartialMentionPostFixer(writer, doc, model.schema));\n    doc.registerPostFixer(writer => extendAttributeOnMentionPostFixer(writer, doc));\n    doc.registerPostFixer(writer => selectionMentionAttributePostFixer(writer, doc));\n    editor.commands.add('mention', new MentionCommand(editor));\n  }\n}\n/**\n * @internal\n */\nfunction _addMentionAttributes(baseMentionData, data) {\n  return Object.assign({\n    uid: uid()\n  }, baseMentionData, data || {});\n}\n/**\n * Creates a mention attribute value from the provided view element and optional data.\n *\n * This function is exposed as\n * {@link module:mention/mention~Mention#toMentionAttribute `editor.plugins.get( 'Mention' ).toMentionAttribute()`}.\n *\n * @internal\n */\nfunction _toMentionAttribute(viewElementOrMention, data) {\n  const dataMention = viewElementOrMention.getAttribute('data-mention');\n  const textNode = viewElementOrMention.getChild(0);\n  // Do not convert empty mentions.\n  if (!textNode) {\n    return;\n  }\n  const baseMentionData = {\n    id: dataMention,\n    _text: textNode.data\n  };\n  return _addMentionAttributes(baseMentionData, data);\n}\n/**\n * A converter that blocks partial mention from being converted.\n *\n * This converter is registered with 'highest' priority in order to consume mention attribute before it is converted by\n * any other converters. This converter only consumes partial mention - those whose `_text` attribute is not equal to text with mention\n * attribute. This may happen when copying part of mention text.\n */\nfunction preventPartialMentionDowncast(dispatcher) {\n  dispatcher.on('attribute:mention', (evt, data, conversionApi) => {\n    const mention = data.attributeNewValue;\n    if (!data.item.is('$textProxy') || !mention) {\n      return;\n    }\n    const start = data.range.start;\n    const textNode = start.textNode || start.nodeAfter;\n    if (textNode.data != mention._text) {\n      // Consume item to prevent partial mention conversion.\n      conversionApi.consumable.consume(data.item, evt.name);\n    }\n  }, {\n    priority: 'highest'\n  });\n}\n/**\n * Creates a mention element from the mention data.\n */\nfunction createViewMentionElement(mention, {\n  writer\n}) {\n  if (!mention) {\n    return;\n  }\n  const attributes = {\n    class: 'mention',\n    'data-mention': mention.id\n  };\n  const options = {\n    id: mention.uid,\n    priority: 20\n  };\n  return writer.createAttributeElement('span', attributes, options);\n}\n/**\n * Model post-fixer that disallows typing with selection when the selection is placed after the text node with the mention attribute or\n * before a text node with mention attribute.\n */\nfunction selectionMentionAttributePostFixer(writer, doc) {\n  const selection = doc.selection;\n  const focus = selection.focus;\n  if (selection.isCollapsed && selection.hasAttribute('mention') && shouldNotTypeWithMentionAt(focus)) {\n    writer.removeSelectionAttribute('mention');\n    return true;\n  }\n  return false;\n}\n/**\n * Helper function to detect if mention attribute should be removed from selection.\n * This check makes only sense if the selection has mention attribute.\n *\n * The mention attribute should be removed from a selection when selection focus is placed:\n * a) after a text node\n * b) the position is at parents start - the selection will set attributes from node after.\n */\nfunction shouldNotTypeWithMentionAt(position) {\n  const isAtStart = position.isAtStart;\n  const isAfterAMention = position.nodeBefore && position.nodeBefore.is('$text');\n  return isAfterAMention || isAtStart;\n}\n/**\n * Model post-fixer that removes the mention attribute from the modified text node.\n */\nfunction removePartialMentionPostFixer(writer, doc, schema) {\n  const changes = doc.differ.getChanges();\n  let wasChanged = false;\n  for (const change of changes) {\n    if (change.type == 'attribute') {\n      continue;\n    }\n    // Checks the text node on the current position.\n    const position = change.position;\n    if (change.name == '$text') {\n      const nodeAfterInsertedTextNode = position.textNode && position.textNode.nextSibling;\n      // Checks the text node where the change occurred.\n      wasChanged = checkAndFix(position.textNode, writer) || wasChanged;\n      // Occurs on paste inside a text node with mention.\n      wasChanged = checkAndFix(nodeAfterInsertedTextNode, writer) || wasChanged;\n      wasChanged = checkAndFix(position.nodeBefore, writer) || wasChanged;\n      wasChanged = checkAndFix(position.nodeAfter, writer) || wasChanged;\n    }\n    // Checks text nodes in inserted elements (might occur when splitting a paragraph or pasting content inside text with mention).\n    if (change.name != '$text' && change.type == 'insert') {\n      const insertedNode = position.nodeAfter;\n      for (const item of writer.createRangeIn(insertedNode).getItems()) {\n        wasChanged = checkAndFix(item, writer) || wasChanged;\n      }\n    }\n    // Inserted inline elements might break mention.\n    if (change.type == 'insert' && schema.isInline(change.name)) {\n      const nodeAfterInserted = position.nodeAfter && position.nodeAfter.nextSibling;\n      wasChanged = checkAndFix(position.nodeBefore, writer) || wasChanged;\n      wasChanged = checkAndFix(nodeAfterInserted, writer) || wasChanged;\n    }\n  }\n  return wasChanged;\n}\n/**\n * This post-fixer will extend the attribute applied on the part of the mention so the whole text node of the mention will have\n * the added attribute.\n */\nfunction extendAttributeOnMentionPostFixer(writer, doc) {\n  const changes = doc.differ.getChanges();\n  let wasChanged = false;\n  for (const change of changes) {\n    if (change.type === 'attribute' && change.attributeKey != 'mention') {\n      // Checks the node on the left side of the range...\n      const nodeBefore = change.range.start.nodeBefore;\n      // ... and on the right side of the range.\n      const nodeAfter = change.range.end.nodeAfter;\n      for (const node of [nodeBefore, nodeAfter]) {\n        if (isBrokenMentionNode(node) && node.getAttribute(change.attributeKey) != change.attributeNewValue) {\n          writer.setAttribute(change.attributeKey, change.attributeNewValue, node);\n          wasChanged = true;\n        }\n      }\n    }\n  }\n  return wasChanged;\n}\n/**\n * Checks if a node has a correct mention attribute if present.\n * Returns `true` if the node is text and has a mention attribute whose text does not match the expected mention text.\n */\nfunction isBrokenMentionNode(node) {\n  if (!node || !(node.is('$text') || node.is('$textProxy')) || !node.hasAttribute('mention')) {\n    return false;\n  }\n  const text = node.data;\n  const mention = node.getAttribute('mention');\n  const expectedText = mention._text;\n  return text != expectedText;\n}\n/**\n * Fixes a mention on a text node if it needs a fix.\n */\nfunction checkAndFix(textNode, writer) {\n  if (isBrokenMentionNode(textNode)) {\n    writer.removeAttribute('mention', textNode);\n    return true;\n  }\n  return false;\n}\n\n/**\n * The mention ui view.\n */\nclass MentionsView extends ListView {\n  selected;\n  position;\n  /**\n  * @inheritDoc\n  */\n  constructor(locale) {\n    super(locale);\n    this.extendTemplate({\n      attributes: {\n        class: ['ck-mentions'],\n        tabindex: '-1'\n      }\n    });\n  }\n  /**\n  * {@link #select Selects} the first item.\n  */\n  selectFirst() {\n    this.select(0);\n  }\n  /**\n  * Selects next item to the currently {@link #select selected}.\n  *\n  * If the last item is already selected, it will select the first item.\n  */\n  selectNext() {\n    const item = this.selected;\n    const index = this.items.getIndex(item);\n    this.select(index + 1);\n  }\n  /**\n  * Selects previous item to the currently {@link #select selected}.\n  *\n  * If the first item is already selected, it will select the last item.\n  */\n  selectPrevious() {\n    const item = this.selected;\n    const index = this.items.getIndex(item);\n    this.select(index - 1);\n  }\n  /**\n  * Marks item at a given index as selected.\n  *\n  * Handles selection cycling when passed index is out of bounds:\n  * - if the index is lower than 0, it will select the last item,\n  * - if the index is higher than the last item index, it will select the first item.\n  *\n  * @param index Index of an item to be marked as selected.\n  */\n  select(index) {\n    let indexToGet = 0;\n    if (index > 0 && index < this.items.length) {\n      indexToGet = index;\n    } else if (index < 0) {\n      indexToGet = this.items.length - 1;\n    }\n    const item = this.items.get(indexToGet);\n    // Return early if item is already selected.\n    if (this.selected === item) {\n      return;\n    }\n    // Remove highlight of previously selected item.\n    if (this.selected) {\n      this.selected.removeHighlight();\n    }\n    item.highlight();\n    this.selected = item;\n    // Scroll the mentions view to the selected element.\n    if (!this._isItemVisibleInScrolledArea(item)) {\n      this.element.scrollTop = item.element.offsetTop;\n    }\n  }\n  /**\n  * Triggers the `execute` event on the {@link #select selected} item.\n  */\n  executeSelected() {\n    this.selected.fire('execute');\n  }\n  /**\n  * Checks if an item is visible in the scrollable area.\n  *\n  * The item is considered visible when:\n  * - its top boundary is inside the scrollable rect\n  * - its bottom boundary is inside the scrollable rect (the whole item must be visible)\n  */\n  _isItemVisibleInScrolledArea(item) {\n    return new Rect(this.element).contains(new Rect(item.element));\n  }\n}\n\n/**\n * This class wraps DOM element as a CKEditor5 UI View.\n *\n * It allows to render any DOM element and use it in mentions list.\n */\nclass DomWrapperView extends View {\n  /**\n  * The DOM element for which wrapper was created.\n  */\n  domElement;\n  /**\n  * Creates an instance of {@link module:mention/ui/domwrapperview~DomWrapperView} class.\n  *\n  * Also see {@link #render}.\n  */\n  constructor(locale, domElement) {\n    super(locale);\n    // Disable template rendering on this view.\n    this.template = undefined;\n    this.domElement = domElement;\n    // Render dom wrapper as a button.\n    this.domElement.classList.add('ck-button');\n    this.set('isOn', false);\n    // Handle isOn state as in buttons.\n    this.on('change:isOn', (evt, name, isOn) => {\n      if (isOn) {\n        this.domElement.classList.add('ck-on');\n        this.domElement.classList.remove('ck-off');\n      } else {\n        this.domElement.classList.add('ck-off');\n        this.domElement.classList.remove('ck-on');\n      }\n    });\n    // Pass click event as execute event.\n    this.listenTo(this.domElement, 'click', () => {\n      this.fire('execute');\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.element = this.domElement;\n  }\n  /**\n  * Focuses the DOM element.\n  */\n  focus() {\n    this.domElement.focus();\n  }\n}\nclass MentionListItemView extends ListItemView {\n  item;\n  marker;\n  highlight() {\n    const child = this.children.first;\n    child.isOn = true;\n  }\n  removeHighlight() {\n    const child = this.children.first;\n    child.isOn = false;\n  }\n}\nconst VERTICAL_SPACING = 3;\n// The key codes that mention UI handles when it is open (without commit keys).\nconst defaultHandledKeyCodes = [keyCodes.arrowup, keyCodes.arrowdown, keyCodes.esc];\n// Dropdown commit key codes.\nconst defaultCommitKeyCodes = [keyCodes.enter, keyCodes.tab];\n/**\n * The mention UI feature.\n */\nclass MentionUI extends Plugin {\n  /**\n  * The mention view.\n  */\n  _mentionsView;\n  /**\n  * Stores mention feeds configurations.\n  */\n  _mentionsConfigurations;\n  /**\n  * The contextual balloon plugin instance.\n  */\n  _balloon;\n  _items = new Collection();\n  _lastRequested;\n  /**\n  * Debounced feed requester. It uses `es-toolkit#debounce` method to delay function call.\n  */\n  _requestFeedDebounced;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'MentionUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ContextualBalloon];\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._mentionsView = this._createMentionView();\n    this._mentionsConfigurations = new Map();\n    this._requestFeedDebounced = debounce(this._requestFeed, 100);\n    editor.config.define('mention', {\n      feeds: []\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const commitKeys = editor.config.get('mention.commitKeys') || defaultCommitKeyCodes;\n    const handledKeyCodes = defaultHandledKeyCodes.concat(commitKeys);\n    this._balloon = editor.plugins.get(ContextualBalloon);\n    // Key listener that handles navigation in mention view.\n    editor.editing.view.document.on('keydown', (evt, data) => {\n      if (isHandledKey(data.keyCode) && this._isUIVisible) {\n        data.preventDefault();\n        evt.stop(); // Required for Enter key overriding.\n        if (data.keyCode == keyCodes.arrowdown) {\n          this._mentionsView.selectNext();\n        }\n        if (data.keyCode == keyCodes.arrowup) {\n          this._mentionsView.selectPrevious();\n        }\n        if (commitKeys.includes(data.keyCode)) {\n          this._mentionsView.executeSelected();\n        }\n        if (data.keyCode == keyCodes.esc) {\n          this._hideUIAndRemoveMarker();\n        }\n      }\n    }, {\n      priority: 'highest'\n    }); // Required to override the Enter key.\n    // Close the dropdown upon clicking outside of the plugin UI.\n    clickOutsideHandler({\n      emitter: this._mentionsView,\n      activator: () => this._isUIVisible,\n      contextElements: () => [this._balloon.view.element],\n      callback: () => this._hideUIAndRemoveMarker()\n    });\n    const feeds = editor.config.get('mention.feeds');\n    for (const mentionDescription of feeds) {\n      const {\n        feed,\n        marker,\n        dropdownLimit\n      } = mentionDescription;\n      if (!isValidMentionMarker(marker)) {\n        /**\n        * The marker must be a single character.\n        *\n        * Correct markers: `'@'`, `'#'`.\n        *\n        * Incorrect markers: `'$$'`, `'[@'`.\n        *\n        * See {@link module:mention/mentionconfig~MentionConfig}.\n        *\n        * @error mentionconfig-incorrect-marker\n        * @param marker Configured marker\n        */\n        throw new CKEditorError('mentionconfig-incorrect-marker', null, {\n          marker\n        });\n      }\n      const feedCallback = typeof feed == 'function' ? feed.bind(this.editor) : createFeedCallback(feed);\n      const itemRenderer = mentionDescription.itemRenderer;\n      const definition = {\n        marker,\n        feedCallback,\n        itemRenderer,\n        dropdownLimit\n      };\n      this._mentionsConfigurations.set(marker, definition);\n    }\n    this._setupTextWatcher(feeds);\n    this.listenTo(editor, 'change:isReadOnly', () => {\n      this._hideUIAndRemoveMarker();\n    });\n    this.on('requestFeed:response', (evt, data) => this._handleFeedResponse(data));\n    this.on('requestFeed:error', () => this._hideUIAndRemoveMarker());\n    /**\n    * Checks if a given key code is handled by the mention UI.\n    */\n    function isHandledKey(keyCode) {\n      return handledKeyCodes.includes(keyCode);\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    // Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n    this._mentionsView.destroy();\n  }\n  /**\n  * Returns true when {@link #_mentionsView} is in the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon} and it is\n  * currently visible.\n  */\n  get _isUIVisible() {\n    return this._balloon.visibleView === this._mentionsView;\n  }\n  /**\n  * Creates the {@link #_mentionsView}.\n  */\n  _createMentionView() {\n    const locale = this.editor.locale;\n    const mentionsView = new MentionsView(locale);\n    mentionsView.items.bindTo(this._items).using(data => {\n      const {\n        item,\n        marker\n      } = data;\n      const {\n        dropdownLimit: markerDropdownLimit\n      } = this._mentionsConfigurations.get(marker);\n      // Set to 10 by default for backwards compatibility. See: #10479\n      const dropdownLimit = markerDropdownLimit || this.editor.config.get('mention.dropdownLimit') || 10;\n      if (mentionsView.items.length >= dropdownLimit) {\n        return null;\n      }\n      const listItemView = new MentionListItemView(locale);\n      const view = this._renderItem(item, marker);\n      view.delegate('execute').to(listItemView);\n      listItemView.children.add(view);\n      listItemView.item = item;\n      listItemView.marker = marker;\n      listItemView.on('execute', () => {\n        mentionsView.fire('execute', {\n          item,\n          marker\n        });\n      });\n      return listItemView;\n    });\n    mentionsView.on('execute', (evt, data) => {\n      const editor = this.editor;\n      const model = editor.model;\n      const item = data.item;\n      const marker = data.marker;\n      const mentionMarker = editor.model.markers.get('mention');\n      // Create a range on matched text.\n      const end = model.createPositionAt(model.document.selection.focus);\n      const start = model.createPositionAt(mentionMarker.getStart());\n      const range = model.createRange(start, end);\n      this._hideUIAndRemoveMarker();\n      editor.execute('mention', {\n        mention: item,\n        text: item.text,\n        marker,\n        range\n      });\n      editor.editing.view.focus();\n    });\n    return mentionsView;\n  }\n  /**\n  * Returns item renderer for the marker.\n  */\n  _getItemRenderer(marker) {\n    const {\n      itemRenderer\n    } = this._mentionsConfigurations.get(marker);\n    return itemRenderer;\n  }\n  /**\n  * Requests a feed from a configured callbacks.\n  */\n  _requestFeed(marker, feedText) {\n    // @if CK_DEBUG_MENTION // console.log( '%c[Feed]%c Requesting for', 'color: blue', 'color: black', `\"${ feedText }\"` );\n    // Store the last requested feed - it is used to discard any out-of order requests.\n    this._lastRequested = feedText;\n    const {\n      feedCallback\n    } = this._mentionsConfigurations.get(marker);\n    const feedResponse = feedCallback(feedText);\n    const isAsynchronous = feedResponse instanceof Promise;\n    // For synchronous feeds (e.g. callbacks, arrays) fire the response event immediately.\n    if (!isAsynchronous) {\n      this.fire('requestFeed:response', {\n        feed: feedResponse,\n        marker,\n        feedText\n      });\n      return;\n    }\n    // Handle the asynchronous responses.\n    feedResponse.then(response => {\n      // Check the feed text of this response with the last requested one so either:\n      if (this._lastRequested == feedText) {\n        // It is the same and fire the response event.\n        this.fire('requestFeed:response', {\n          feed: response,\n          marker,\n          feedText\n        });\n      } else {\n        // It is different - most probably out-of-order one, so fire the discarded event.\n        this.fire('requestFeed:discarded', {\n          feed: response,\n          marker,\n          feedText\n        });\n      }\n    }).catch(error => {\n      this.fire('requestFeed:error', {\n        error\n      });\n      /**\n      * The callback used for obtaining mention autocomplete feed thrown and error and the mention UI was hidden or\n      * not displayed at all.\n      *\n      * @error mention-feed-callback-error\n      */\n      logWarning('mention-feed-callback-error', {\n        marker\n      });\n    });\n  }\n  /**\n  * Registers a text watcher for the marker.\n  */\n  _setupTextWatcher(feeds) {\n    const editor = this.editor;\n    const feedsWithPattern = feeds.map(feed => ({\n      ...feed,\n      pattern: createRegExp(feed.marker, feed.minimumCharacters || 0)\n    }));\n    const watcher = new TextWatcher(editor.model, createTestCallback(feedsWithPattern));\n    watcher.on('matched', (evt, data) => {\n      const markerDefinition = getLastValidMarkerInText(feedsWithPattern, data.text);\n      const selection = editor.model.document.selection;\n      const focus = selection.focus;\n      const markerPosition = editor.model.createPositionAt(focus.parent, markerDefinition.position);\n      if (isPositionInExistingMention(focus) || isMarkerInExistingMention(markerPosition)) {\n        this._hideUIAndRemoveMarker();\n        return;\n      }\n      const feedText = requestFeedText(markerDefinition, data.text);\n      const matchedTextLength = markerDefinition.marker.length + feedText.length;\n      // Create a marker range.\n      const start = focus.getShiftedBy(-matchedTextLength);\n      const end = focus.getShiftedBy(-feedText.length);\n      const markerRange = editor.model.createRange(start, end);\n      // @if CK_DEBUG_MENTION // console.group( '%c[TextWatcher]%c matched', 'color: red', 'color: black', `\"${ feedText }\"` );\n      // @if CK_DEBUG_MENTION // console.log( 'data#text', `\"${ data.text }\"` );\n      // @if CK_DEBUG_MENTION // console.log( 'data#range', data.range.start.path, data.range.end.path );\n      // @if CK_DEBUG_MENTION // console.log( 'marker definition', markerDefinition );\n      // @if CK_DEBUG_MENTION // console.log( 'marker range', markerRange.start.path, markerRange.end.path );\n      if (checkIfStillInCompletionMode(editor)) {\n        const mentionMarker = editor.model.markers.get('mention');\n        // Update the marker - user might've moved the selection to other mention trigger.\n        editor.model.change(writer => {\n          // @if CK_DEBUG_MENTION // console.log( '%c[Editing]%c Updating the marker.', 'color: purple', 'color: black' );\n          writer.updateMarker(mentionMarker, {\n            range: markerRange\n          });\n        });\n      } else {\n        editor.model.change(writer => {\n          // @if CK_DEBUG_MENTION // console.log( '%c[Editing]%c Adding the marker.', 'color: purple', 'color: black' );\n          writer.addMarker('mention', {\n            range: markerRange,\n            usingOperation: false,\n            affectsData: false\n          });\n        });\n      }\n      this._requestFeedDebounced(markerDefinition.marker, feedText);\n      // @if CK_DEBUG_MENTION // console.groupEnd();\n    });\n    watcher.on('unmatched', () => {\n      this._hideUIAndRemoveMarker();\n    });\n    const mentionCommand = editor.commands.get('mention');\n    watcher.bind('isEnabled').to(mentionCommand);\n    return watcher;\n  }\n  /**\n  * Handles the feed response event data.\n  */\n  _handleFeedResponse(data) {\n    const {\n      feed,\n      marker\n    } = data;\n    // eslint-disable-next-line max-len\n    // @if CK_DEBUG_MENTION // console.log( `%c[Feed]%c Response for \"${ data.feedText }\" (${ feed.length })`, 'color: blue', 'color: black', feed );\n    // If the marker is not in the document happens when the selection had changed and the 'mention' marker was removed.\n    if (!checkIfStillInCompletionMode(this.editor)) {\n      return;\n    }\n    // Reset the view.\n    this._items.clear();\n    for (const feedItem of feed) {\n      const item = typeof feedItem != 'object' ? {\n        id: feedItem,\n        text: feedItem\n      } : feedItem;\n      this._items.add({\n        item,\n        marker\n      });\n    }\n    const mentionMarker = this.editor.model.markers.get('mention');\n    if (this._items.length) {\n      this._showOrUpdateUI(mentionMarker);\n    } else {\n      // Do not show empty mention UI.\n      this._hideUIAndRemoveMarker();\n    }\n  }\n  /**\n  * Shows the mentions balloon. If the panel is already visible, it will reposition it.\n  */\n  _showOrUpdateUI(markerMarker) {\n    if (this._isUIVisible) {\n      // @if CK_DEBUG_MENTION // console.log( '%c[UI]%c Updating position.', 'color: green', 'color: black' );\n      // Update balloon position as the mention list view may change its size.\n      this._balloon.updatePosition(this._getBalloonPanelPositionData(markerMarker, this._mentionsView.position));\n    } else {\n      // @if CK_DEBUG_MENTION // console.log( '%c[UI]%c Showing the UI.', 'color: green', 'color: black' );\n      this._balloon.add({\n        view: this._mentionsView,\n        position: this._getBalloonPanelPositionData(markerMarker, this._mentionsView.position),\n        singleViewMode: true,\n        balloonClassName: 'ck-mention-balloon'\n      });\n    }\n    this._mentionsView.position = this._balloon.view.position;\n    this._mentionsView.selectFirst();\n  }\n  /**\n  * Hides the mentions balloon and removes the 'mention' marker from the markers collection.\n  */\n  _hideUIAndRemoveMarker() {\n    // Remove the mention view from balloon before removing marker - it is used by balloon position target().\n    if (this._balloon.hasView(this._mentionsView)) {\n      // @if CK_DEBUG_MENTION // console.log( '%c[UI]%c Hiding the UI.', 'color: green', 'color: black' );\n      this._balloon.remove(this._mentionsView);\n    }\n    if (checkIfStillInCompletionMode(this.editor)) {\n      // @if CK_DEBUG_MENTION // console.log( '%c[Editing]%c Removing marker.', 'color: purple', 'color: black' );\n      this.editor.model.change(writer => writer.removeMarker('mention'));\n    }\n    // Make the last matched position on panel view undefined so the #_getBalloonPanelPositionData() method will return all positions\n    // on the next call.\n    this._mentionsView.position = undefined;\n  }\n  /**\n  * Renders a single item in the autocomplete list.\n  */\n  _renderItem(item, marker) {\n    const editor = this.editor;\n    let view;\n    let label = item.id;\n    const renderer = this._getItemRenderer(marker);\n    if (renderer) {\n      const renderResult = renderer(item);\n      if (typeof renderResult != 'string') {\n        view = new DomWrapperView(editor.locale, renderResult);\n      } else {\n        label = renderResult;\n      }\n    }\n    if (!view) {\n      const buttonView = new ButtonView(editor.locale);\n      buttonView.label = label;\n      buttonView.withText = true;\n      view = buttonView;\n    }\n    return view;\n  }\n  /**\n  * Creates a position options object used to position the balloon panel.\n  *\n  * @param mentionMarker\n  * @param preferredPosition The name of the last matched position name.\n  */\n  _getBalloonPanelPositionData(mentionMarker, preferredPosition) {\n    const editor = this.editor;\n    const editing = editor.editing;\n    const domConverter = editing.view.domConverter;\n    const mapper = editing.mapper;\n    const uiLanguageDirection = editor.locale.uiLanguageDirection;\n    return {\n      target: () => {\n        let modelRange = mentionMarker.getRange();\n        // Target the UI to the model selection range - the marker has been removed so probably the UI will not be shown anyway.\n        // The logic is used by ContextualBalloon to display another panel in the same place.\n        if (modelRange.start.root.rootName == '$graveyard') {\n          modelRange = editor.model.document.selection.getFirstRange();\n        }\n        const viewRange = mapper.toViewRange(modelRange);\n        const rangeRects = Rect.getDomRangeRects(domConverter.viewRangeToDom(viewRange));\n        return rangeRects.pop();\n      },\n      limiter: () => {\n        const view = this.editor.editing.view;\n        const viewDocument = view.document;\n        const editableElement = viewDocument.selection.editableElement;\n        if (editableElement) {\n          return view.domConverter.mapViewToDom(editableElement.root);\n        }\n        return null;\n      },\n      positions: getBalloonPanelPositions(preferredPosition, uiLanguageDirection)\n    };\n  }\n}\n/**\n * Returns the balloon positions data callbacks.\n */\nfunction getBalloonPanelPositions(preferredPosition, uiLanguageDirection) {\n  const positions = {\n    // Positions the panel to the southeast of the caret rectangle.\n    'caret_se': targetRect => {\n      return {\n        top: targetRect.bottom + VERTICAL_SPACING,\n        left: targetRect.right,\n        name: 'caret_se',\n        config: {\n          withArrow: false\n        }\n      };\n    },\n    // Positions the panel to the northeast of the caret rectangle.\n    'caret_ne': (targetRect, balloonRect) => {\n      return {\n        top: targetRect.top - balloonRect.height - VERTICAL_SPACING,\n        left: targetRect.right,\n        name: 'caret_ne',\n        config: {\n          withArrow: false\n        }\n      };\n    },\n    // Positions the panel to the southwest of the caret rectangle.\n    'caret_sw': (targetRect, balloonRect) => {\n      return {\n        top: targetRect.bottom + VERTICAL_SPACING,\n        left: targetRect.right - balloonRect.width,\n        name: 'caret_sw',\n        config: {\n          withArrow: false\n        }\n      };\n    },\n    // Positions the panel to the northwest of the caret rect.\n    'caret_nw': (targetRect, balloonRect) => {\n      return {\n        top: targetRect.top - balloonRect.height - VERTICAL_SPACING,\n        left: targetRect.right - balloonRect.width,\n        name: 'caret_nw',\n        config: {\n          withArrow: false\n        }\n      };\n    }\n  };\n  // Returns only the last position if it was matched to prevent the panel from jumping after the first match.\n  if (Object.prototype.hasOwnProperty.call(positions, preferredPosition)) {\n    return [positions[preferredPosition]];\n  }\n  // By default, return all position callbacks ordered depending on the UI language direction.\n  return uiLanguageDirection !== 'rtl' ? [positions.caret_se, positions.caret_sw, positions.caret_ne, positions.caret_nw] : [positions.caret_sw, positions.caret_se, positions.caret_nw, positions.caret_ne];\n}\n/**\n * Returns a marker definition of the last valid occurring marker in a given string.\n * If there is no valid marker in a string, it returns undefined.\n *\n * Example of returned object:\n *\n * ```ts\n * {\n * \tmarker: '@',\n * \tposition: 4,\n * \tminimumCharacters: 0\n * }\n * ````\n *\n * @param feedsWithPattern Registered feeds in editor for mention plugin with created RegExp for matching marker.\n * @param text String to find the marker in\n * @returns Matched marker's definition\n */\nfunction getLastValidMarkerInText(feedsWithPattern, text) {\n  let lastValidMarker;\n  for (const feed of feedsWithPattern) {\n    const currentMarkerLastIndex = text.lastIndexOf(feed.marker);\n    if (currentMarkerLastIndex > 0 && !text.substring(currentMarkerLastIndex - 1).match(feed.pattern)) {\n      continue;\n    }\n    if (!lastValidMarker || currentMarkerLastIndex >= lastValidMarker.position) {\n      lastValidMarker = {\n        marker: feed.marker,\n        position: currentMarkerLastIndex,\n        minimumCharacters: feed.minimumCharacters,\n        pattern: feed.pattern\n      };\n    }\n  }\n  return lastValidMarker;\n}\n/**\n * Creates a RegExp pattern for the marker.\n *\n * Function has to be exported to achieve 100% code coverage.\n */\nfunction createRegExp(marker, minimumCharacters) {\n  const numberOfCharacters = minimumCharacters == 0 ? '*' : `{${minimumCharacters},}`;\n  const openAfterCharacters = env.features.isRegExpUnicodePropertySupported ? '\\\\p{Ps}\\\\p{Pi}\"\\'' : '\\\\(\\\\[{\"\\'';\n  const mentionCharacters = '.';\n  // I wanted to make an util out of it, but since this regexp uses \"u\" flag, it became difficult.\n  // When \"u\" flag is used, the regexp has \"strict\" escaping rules, i.e. if you try to escape a character that does not need\n  // to be escaped, RegExp() will throw. It made it difficult to write a generic util, because different characters are\n  // allowed in different context. For example, escaping \"-\" sometimes was correct, but sometimes it threw an error.\n  marker = marker.replace(/[.*+?^${}()\\-|[\\]\\\\]/g, '\\\\$&');\n  // The pattern consists of 3 groups:\n  //\n  // - 0 (non-capturing): Opening sequence - start of the line, space or an opening punctuation character like \"(\" or \"\\\"\",\n  // - 1: The marker character(s),\n  // - 2: Mention input (taking the minimal length into consideration to trigger the UI),\n  //\n  // The pattern matches up to the caret (end of string switch - $).\n  //               (0:      opening sequence       )(1: marker  )(2:                typed mention              )$\n  const pattern = `(?:^|[ ${openAfterCharacters}])(${marker})(${mentionCharacters}${numberOfCharacters})$`;\n  return new RegExp(pattern, 'u');\n}\n/**\n * Creates a test callback for the marker to be used in the text watcher instance.\n *\n * @param feedsWithPattern Feeds of mention plugin configured in editor with RegExp to match marker in text\n */\nfunction createTestCallback(feedsWithPattern) {\n  const textMatcher = text => {\n    const markerDefinition = getLastValidMarkerInText(feedsWithPattern, text);\n    if (!markerDefinition) {\n      return false;\n    }\n    let splitStringFrom = 0;\n    if (markerDefinition.position !== 0) {\n      splitStringFrom = markerDefinition.position - 1;\n    }\n    const textToTest = text.substring(splitStringFrom);\n    return markerDefinition.pattern.test(textToTest);\n  };\n  return textMatcher;\n}\n/**\n * Creates a text matcher from the marker.\n */\nfunction requestFeedText(markerDefinition, text) {\n  let splitStringFrom = 0;\n  if (markerDefinition.position !== 0) {\n    splitStringFrom = markerDefinition.position - 1;\n  }\n  const regExp = createRegExp(markerDefinition.marker, 0);\n  const textToMatch = text.substring(splitStringFrom);\n  const match = textToMatch.match(regExp);\n  return match[2];\n}\n/**\n * The default feed callback.\n */\nfunction createFeedCallback(feedItems) {\n  return feedText => {\n    const filteredItems = feedItems // Make the default mention feed case-insensitive.\n    .filter(item => {\n      // Item might be defined as object.\n      const itemId = typeof item == 'string' ? item : String(item.id);\n      // The default feed is case insensitive.\n      return itemId.toLowerCase().includes(feedText.toLowerCase());\n    });\n    return filteredItems;\n  };\n}\n/**\n * Checks if position in inside or right after a text with a mention.\n */\nfunction isPositionInExistingMention(position) {\n  // The text watcher listens only to changed range in selection - so the selection attributes are not yet available\n  // and you cannot use selection.hasAttribute( 'mention' ) just yet.\n  // See https://github.com/ckeditor/ckeditor5-engine/issues/1723.\n  const hasMention = position.textNode && position.textNode.hasAttribute('mention');\n  const nodeBefore = position.nodeBefore;\n  return hasMention || nodeBefore && nodeBefore.is('$text') && nodeBefore.hasAttribute('mention');\n}\n/**\n * Checks if the closest marker offset is at the beginning of a mention.\n *\n * See https://github.com/ckeditor/ckeditor5/issues/11400.\n */\nfunction isMarkerInExistingMention(markerPosition) {\n  const nodeAfter = markerPosition.nodeAfter;\n  return nodeAfter && nodeAfter.is('$text') && nodeAfter.hasAttribute('mention');\n}\n/**\n * Checks if string is a valid mention marker.\n */\nfunction isValidMentionMarker(marker) {\n  return !!marker;\n}\n/**\n * Checks the mention plugins is in completion mode (e.g. when typing is after a valid mention string like @foo).\n */\nfunction checkIfStillInCompletionMode(editor) {\n  return editor.model.markers.has('mention');\n}\n\n/**\n * The mention plugin.\n *\n * For a detailed overview, check the {@glink features/mentions Mention feature} guide.\n */\nclass Mention extends Plugin {\n  toMentionAttribute(viewElement, data) {\n    return _toMentionAttribute(viewElement, data);\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Mention';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [MentionEditing, MentionUI];\n  }\n}\nexport { DomWrapperView, Mention, MentionEditing, MentionListItemView, MentionUI, MentionsView };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { toUnit, global, Rect, findClosestScrollableAncestor } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { IframeView, View } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { DomConverter, Renderer } from '@ckeditor/ckeditor5-engine/dist/index.js';\nconst toPx$1 = /* #__PURE__ */toUnit('px');\n/**\n * The internal `<iframe>` view that hosts the minimap content.\n *\n * @internal\n */\nclass MinimapIframeView extends IframeView {\n  /**\n  * Cached view constructor options for re-use in other methods.\n  */\n  _options;\n  /**\n  * Creates an instance of the internal minimap iframe.\n  */\n  constructor(locale, options) {\n    super(locale);\n    const bind = this.bindTemplate;\n    this.set('top', 0);\n    this.set('height', 0);\n    this._options = options;\n    this.extendTemplate({\n      attributes: {\n        tabindex: -1,\n        'aria-hidden': 'true',\n        class: ['ck-minimap__iframe'],\n        style: {\n          top: bind.to('top', top => toPx$1(top)),\n          height: bind.to('height', height => toPx$1(height))\n        }\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    return super.render().then(() => {\n      this._prepareDocument();\n    });\n  }\n  /**\n  * Sets the new height of the iframe.\n  */\n  setHeight(newHeight) {\n    this.height = newHeight;\n  }\n  /**\n  * Sets the top offset of the iframe to move it around vertically.\n  */\n  setTopOffset(newOffset) {\n    this.top = newOffset;\n  }\n  /**\n  * Sets the internal structure of the `<iframe>` readying it to display the\n  * minimap element.\n  */\n  _prepareDocument() {\n    const iframeDocument = this.element.contentWindow.document;\n    const domRootClone = iframeDocument.adoptNode(this._options.domRootClone);\n    const boxStyles = this._options.useSimplePreview ? `\n\t\t\t.ck.ck-editor__editable_inline img {\n\t\t\t\tfilter: contrast( 0 );\n\t\t\t}\n\n\t\t\tp, li, a, figcaption, span {\n\t\t\t\tbackground: hsl(0, 0%, 80%) !important;\n\t\t\t\tcolor: hsl(0, 0%, 80%) !important;\n\t\t\t}\n\n\t\t\th1, h2, h3, h4 {\n\t\t\t\tbackground: hsl(0, 0%, 60%) !important;\n\t\t\t\tcolor: hsl(0, 0%, 60%) !important;\n\t\t\t}\n\t\t` : '';\n    const pageStyles = this._options.pageStyles.map(definition => {\n      if (typeof definition === 'string') {\n        return `<style>${definition}</style>`;\n      } else {\n        return `<link rel=\"stylesheet\" type=\"text/css\" href=\"${definition.href}\">`;\n      }\n    }).join('\\n');\n    const html = `<!DOCTYPE html><html lang=\"en\">\n\t\t\t<head>\n\t\t\t\t<meta charset=\"utf-8\">\n\t\t\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\t\t\t\t${pageStyles}\n\t\t\t\t<style>\n\t\t\t\t\thtml, body {\n\t\t\t\t\t\tmargin: 0 !important;\n\t\t\t\t\t\tpadding: 0 !important;\n\t\t\t\t\t}\n\n\t\t\t\t\thtml {\n\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t}\n\n\t\t\t\t\tbody {\n\t\t\t\t\t\ttransform: scale( ${this._options.scaleRatio} );\n\t\t\t\t\t\ttransform-origin: 0 0;\n\t\t\t\t\t\toverflow: visible;\n\t\t\t\t\t}\n\n\t\t\t\t\t.ck.ck-editor__editable_inline {\n\t\t\t\t\t\tmargin: 0 !important;\n\t\t\t\t\t\tborder-color: transparent !important;\n\t\t\t\t\t\toutline-color: transparent !important;\n\t\t\t\t\t\tbox-shadow: none !important;\n\t\t\t\t\t}\n\n\t\t\t\t\t.ck.ck-content {\n\t\t\t\t\t\tbackground: white;\n\t\t\t\t\t}\n\n\t\t\t\t\t${boxStyles}\n\t\t\t\t</style>\n\t\t\t</head>\n\t\t\t<body class=\"${this._options.extraClasses || ''}\"></body>\n\t\t</html>`;\n    iframeDocument.open();\n    iframeDocument.write(html);\n    iframeDocument.close();\n    iframeDocument.body.appendChild(domRootClone);\n  }\n}\nconst toPx = /* #__PURE__ */toUnit('px');\n/**\n * The position tracker visualizing the visible subset of the content. Displayed over the minimap.\n *\n * @internal\n */\nclass MinimapPositionTrackerView extends View {\n  constructor(locale) {\n    super(locale);\n    const bind = this.bindTemplate;\n    this.set('height', 0);\n    this.set('top', 0);\n    this.set('scrollProgress', 0);\n    this.set('_isDragging', false);\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-minimap__position-tracker', bind.if('_isDragging', 'ck-minimap__position-tracker_dragging')],\n        style: {\n          top: bind.to('top', top => toPx(top)),\n          height: bind.to('height', height => toPx(height))\n        },\n        'data-progress': bind.to('scrollProgress')\n      },\n      on: {\n        mousedown: bind.to(() => {\n          this._isDragging = true;\n        })\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.listenTo(global.document, 'mousemove', (evt, data) => {\n      if (!this._isDragging) {\n        return;\n      }\n      this.fire('drag', data.movementY);\n    }, {\n      useCapture: true\n    });\n    this.listenTo(global.document, 'mouseup', () => {\n      this._isDragging = false;\n    }, {\n      useCapture: true\n    });\n  }\n  /**\n  * Sets the new height of the tracker to visualize the subset of the content visible to the user.\n  */\n  setHeight(newHeight) {\n    this.height = newHeight;\n  }\n  /**\n  * Sets the top offset of the tracker to move it around vertically.\n  */\n  setTopOffset(newOffset) {\n    this.top = newOffset;\n  }\n  /**\n  * Sets the scroll progress (in %) to inform the user using a label when the tracker is being dragged.\n  */\n  setScrollProgress(newProgress) {\n    this.scrollProgress = newProgress;\n  }\n}\n\n/**\n * The main view of the minimap. It renders the original content but scaled down with a tracker element\n * visualizing the subset of the content visible to the user and allowing interactions (scrolling, dragging).\n *\n * @internal\n */\nclass MinimapView extends View {\n  /**\n  * An instance of the tracker view displayed over the minimap.\n  */\n  _positionTrackerView;\n  /**\n  * The scale ratio of the minimap relative to the original editing DOM root with the content.\n  */\n  _scaleRatio;\n  /**\n  * An instance of the iframe view that hosts the minimap.\n  */\n  _minimapIframeView;\n  /**\n  * Creates an instance of the minimap view.\n  */\n  constructor({\n    locale,\n    scaleRatio,\n    pageStyles,\n    extraClasses,\n    useSimplePreview,\n    domRootClone\n  }) {\n    super(locale);\n    const bind = this.bindTemplate;\n    this._positionTrackerView = new MinimapPositionTrackerView(locale);\n    this._positionTrackerView.delegate('drag').to(this);\n    this._scaleRatio = scaleRatio;\n    this._minimapIframeView = new MinimapIframeView(locale, {\n      useSimplePreview,\n      pageStyles,\n      extraClasses,\n      scaleRatio,\n      domRootClone\n    });\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-minimap']\n      },\n      children: [this._positionTrackerView],\n      on: {\n        click: bind.to(this._handleMinimapClick.bind(this)),\n        wheel: bind.to(this._handleMinimapMouseWheel.bind(this))\n      }\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    this._minimapIframeView.destroy();\n    super.destroy();\n  }\n  /**\n  * Returns the DOM {@link module:utils/dom/rect~Rect} height of the minimap.\n  */\n  get height() {\n    return new Rect(this.element).height;\n  }\n  /**\n  * Returns the number of available space (pixels) the position tracker (visible subset of the content) can use to scroll vertically.\n  */\n  get scrollHeight() {\n    return Math.max(0, Math.min(this.height, this._minimapIframeView.height) - this._positionTrackerView.height);\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this._minimapIframeView.render();\n    this.element.appendChild(this._minimapIframeView.element);\n  }\n  /**\n  * Sets the new height of the minimap (in px) to respond to the changes in the original editing DOM root.\n  *\n  * **Note**:The provided value should be the `offsetHeight` of the original editing DOM root.\n  */\n  setContentHeight(newHeight) {\n    this._minimapIframeView.setHeight(newHeight * this._scaleRatio);\n  }\n  /**\n  * Sets the minimap scroll progress.\n  *\n  * The minimap scroll progress is linked to the original editing DOM root and its scrollable container (ancestor).\n  * Changing the progress will alter the vertical position of the minimap (and its position tracker) and give the user an accurate\n  * overview of the visible document.\n  *\n  * **Note**: The value should be between 0 and 1. 0 when the DOM root has not been scrolled, 1 when the\n  * scrolling has reached the end.\n  */\n  setScrollProgress(newScrollProgress) {\n    const iframeView = this._minimapIframeView;\n    const positionTrackerView = this._positionTrackerView;\n    // The scrolling should end when the bottom edge of the iframe touches the bottom edge of the minimap.\n    if (iframeView.height < this.height) {\n      iframeView.setTopOffset(0);\n      positionTrackerView.setTopOffset((iframeView.height - positionTrackerView.height) * newScrollProgress);\n    } else {\n      const totalOffset = iframeView.height - this.height;\n      iframeView.setTopOffset(-totalOffset * newScrollProgress);\n      positionTrackerView.setTopOffset((this.height - positionTrackerView.height) * newScrollProgress);\n    }\n    positionTrackerView.setScrollProgress(Math.round(newScrollProgress * 100));\n  }\n  /**\n  * Sets the new height of the tracker (in px) to visualize the subset of the content visible to the user.\n  */\n  setPositionTrackerHeight(trackerHeight) {\n    this._positionTrackerView.setHeight(trackerHeight * this._scaleRatio);\n  }\n  /**\n  * @param data DOM event data\n  */\n  _handleMinimapClick(data) {\n    const positionTrackerView = this._positionTrackerView;\n    if (data.target === positionTrackerView.element) {\n      return;\n    }\n    const trackerViewRect = new Rect(positionTrackerView.element);\n    const diff = data.clientY - trackerViewRect.top - trackerViewRect.height / 2;\n    const percentage = diff / this._minimapIframeView.height;\n    this.fire('click', percentage);\n  }\n  /**\n  * @param data DOM event data\n  */\n  _handleMinimapMouseWheel(data) {\n    this.fire('drag', data.deltaY * this._scaleRatio);\n  }\n}\n\n/**\n * Clones the editing view DOM root by using a dedicated pair of {@link module:engine/view/renderer~Renderer} and\n * {@link module:engine/view/domconverter~DomConverter}. The DOM root clone updates incrementally to stay in sync with the\n * source root.\n *\n * @internal\n * @param editor The editor instance the original editing root belongs to.\n * @param rootName The name of the root to clone.\n * @returns The editing root DOM clone element.\n */\nfunction cloneEditingViewDomRoot(editor, rootName) {\n  const viewDocument = editor.editing.view.document;\n  const viewRoot = viewDocument.getRoot(rootName);\n  const domConverter = new DomConverter(viewDocument);\n  const renderer = new Renderer(domConverter, viewDocument.selection);\n  const domRootClone = editor.editing.view.getDomRoot().cloneNode();\n  domConverter.bindElements(domRootClone, viewRoot);\n  renderer.markToSync('children', viewRoot);\n  renderer.markToSync('attributes', viewRoot);\n  viewRoot.on('change:children', (evt, node) => renderer.markToSync('children', node));\n  viewRoot.on('change:attributes', (evt, node) => renderer.markToSync('attributes', node));\n  viewRoot.on('change:text', (evt, node) => renderer.markToSync('text', node));\n  renderer.render();\n  editor.editing.view.on('render', () => renderer.render());\n  // TODO: Cleanup after destruction.\n  editor.on('destroy', () => {\n    domConverter.unbindDomElement(domRootClone);\n  });\n  return domRootClone;\n}\n/**\n * Harvests all web page styles, for instance, to allow re-using them in an `<iframe>` preserving the look of the content.\n *\n * The returned data format is as follows:\n *\n * ```ts\n * [\n * \t'p { color: red; ... } h2 { font-size: 2em; ... } ...',\n * \t'.spacing { padding: 1em; ... }; ...',\n * \t'...',\n * \t{ href: 'http://link.to.external.stylesheet' },\n * \t{ href: '...' }\n * ]\n * ```\n *\n * **Note**: For stylesheets with `href` different than window origin, an object is returned because\n * accessing rules of these styles may cause CORS errors (depending on the configuration of the web page).\n *\n * @internal\n */\nfunction getPageStyles() {\n  return Array.from(global.document.styleSheets).map(styleSheet => {\n    // CORS\n    if (styleSheet.href && !styleSheet.href.startsWith(global.window.location.origin)) {\n      return {\n        href: styleSheet.href\n      };\n    }\n    return Array.from(styleSheet.cssRules).filter(rule => !(rule instanceof CSSMediaRule)).map(rule => rule.cssText).join(' \\n');\n  });\n}\n/**\n * Gets dimensions rectangle according to passed DOM element. Returns whole window's size for `body` element.\n *\n * @internal\n */\nfunction getDomElementRect(domElement) {\n  return new Rect(domElement === global.document.body ? global.window : domElement);\n}\n/**\n * Gets client height according to passed DOM element. Returns window's height for `body` element.\n *\n * @internal\n */\nfunction getClientHeight(domElement) {\n  return domElement === global.document.body ? global.window.innerHeight : domElement.clientHeight;\n}\n/**\n * Returns the DOM element itself if it's not a `body` element, whole window otherwise.\n *\n * @internal\n */\nfunction getScrollable(domElement) {\n  return domElement === global.document.body ? global.window : domElement;\n}\n\n/**\n * The content minimap feature.\n */\nclass Minimap extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Minimap';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * The reference to the view of the minimap.\n  */\n  _minimapView;\n  /**\n  * The DOM element closest to the editable element of the editor as returned\n  * by {@link module:ui/editorui/editorui~EditorUI#getEditableElement}.\n  */\n  _scrollableRootAncestor;\n  /**\n  * The DOM element closest to the editable element of the editor as returned\n  * by {@link module:ui/editorui/editorui~EditorUI#getEditableElement}.\n  */\n  _editingRootElement;\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    this._minimapView = null;\n    this._scrollableRootAncestor = null;\n    this.listenTo(editor.ui, 'ready', this._onUiReady.bind(this));\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this._minimapView.destroy();\n    this._minimapView.element.remove();\n  }\n  /**\n  * Initializes the minimap view element and starts the layout synchronization\n  * on the editing view `render` event.\n  */\n  _onUiReady() {\n    const editor = this.editor;\n    // TODO: This will not work with the multi-root editor.\n    const editingRootElement = this._editingRootElement = editor.ui.getEditableElement();\n    this._scrollableRootAncestor = findClosestScrollableAncestor(editingRootElement);\n    // DOM root element is not yet attached to the document.\n    if (!editingRootElement.ownerDocument.body.contains(editingRootElement)) {\n      editor.ui.once('update', this._onUiReady.bind(this));\n      return;\n    }\n    this._initializeMinimapView();\n    this.listenTo(editor.editing.view, 'render', () => {\n      if (editor.state !== 'ready') {\n        return;\n      }\n      this._syncMinimapToEditingRootScrollPosition();\n    });\n    this._syncMinimapToEditingRootScrollPosition();\n  }\n  /**\n  * Initializes the minimap view and attaches listeners that make it responsive to the environment (document)\n  * but also allow the minimap to control the document (scroll position).\n  */\n  _initializeMinimapView() {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const useSimplePreview = editor.config.get('minimap.useSimplePreview');\n    // TODO: Throw an error if there is no `minimap` in config.\n    const minimapContainerElement = editor.config.get('minimap.container');\n    const scrollableRootAncestor = this._scrollableRootAncestor;\n    // TODO: This should be dynamic, the root width could change as the viewport scales if not fixed unit.\n    const editingRootElementWidth = getDomElementRect(this._editingRootElement).width;\n    const minimapContainerWidth = getDomElementRect(minimapContainerElement).width;\n    const minimapScaleRatio = minimapContainerWidth / editingRootElementWidth;\n    const minimapView = this._minimapView = new MinimapView({\n      locale,\n      scaleRatio: minimapScaleRatio,\n      pageStyles: getPageStyles(),\n      extraClasses: editor.config.get('minimap.extraClasses'),\n      useSimplePreview,\n      domRootClone: cloneEditingViewDomRoot(editor)\n    });\n    minimapView.render();\n    // Scrollable ancestor scroll -> minimap position update.\n    minimapView.listenTo(global.document, 'scroll', (evt, data) => {\n      if (scrollableRootAncestor === global.document.body) {\n        if (data.target !== global.document) {\n          return;\n        }\n      } else if (data.target !== scrollableRootAncestor) {\n        return;\n      }\n      this._syncMinimapToEditingRootScrollPosition();\n    }, {\n      useCapture: true,\n      usePassive: true\n    });\n    // Viewport resize -> minimap position update.\n    minimapView.listenTo(global.window, 'resize', () => {\n      this._syncMinimapToEditingRootScrollPosition();\n    });\n    // Dragging the visible content area -> document (scrollable) position update.\n    minimapView.on('drag', (evt, movementY) => {\n      let movementYPercentage;\n      if (minimapView.scrollHeight === 0) {\n        movementYPercentage = 0;\n      } else {\n        movementYPercentage = movementY / minimapView.scrollHeight;\n      }\n      const absoluteScrollProgress = movementYPercentage * (scrollableRootAncestor.scrollHeight - getClientHeight(scrollableRootAncestor));\n      const scrollable = getScrollable(scrollableRootAncestor);\n      scrollable.scrollBy(0, Math.round(absoluteScrollProgress));\n    });\n    // Clicking the minimap -> center the document (scrollable) to the corresponding position.\n    minimapView.on('click', (evt, percentage) => {\n      const absoluteScrollProgress = percentage * scrollableRootAncestor.scrollHeight;\n      const scrollable = getScrollable(scrollableRootAncestor);\n      scrollable.scrollBy(0, Math.round(absoluteScrollProgress));\n    });\n    minimapContainerElement.appendChild(minimapView.element);\n  }\n  /**\n  * @private\n  */\n  _syncMinimapToEditingRootScrollPosition() {\n    const editingRootElement = this._editingRootElement;\n    const minimapView = this._minimapView;\n    minimapView.setContentHeight(editingRootElement.offsetHeight);\n    const editingRootRect = getDomElementRect(editingRootElement);\n    const scrollableRootAncestorRect = getDomElementRect(this._scrollableRootAncestor);\n    let scrollProgress;\n    // @if CK_DEBUG_MINIMAP // RectDrawer.clear();\n    // @if CK_DEBUG_MINIMAP // RectDrawer.draw( scrollableRootAncestorRect, { outlineColor: 'red' }, 'scrollableRootAncestor' );\n    // @if CK_DEBUG_MINIMAP // RectDrawer.draw( editingRootRect, { outlineColor: 'green' }, 'editingRoot' );\n    // The root is completely visible in the scrollable ancestor.\n    if (scrollableRootAncestorRect.contains(editingRootRect)) {\n      scrollProgress = 0;\n    } else {\n      if (editingRootRect.top > scrollableRootAncestorRect.top) {\n        scrollProgress = 0;\n      } else {\n        scrollProgress = (editingRootRect.top - scrollableRootAncestorRect.top) / (scrollableRootAncestorRect.height - editingRootRect.height);\n        scrollProgress = Math.max(0, Math.min(scrollProgress, 1));\n      }\n    }\n    // The intersection helps to change the tracker height when there is a lot of padding around the root.\n    // Note: It is **essential** that the height is set first because the progress depends on the correct tracker height.\n    minimapView.setPositionTrackerHeight(scrollableRootAncestorRect.getIntersection(editingRootRect).height);\n    minimapView.setScrollProgress(scrollProgress);\n  }\n}\nexport { Minimap };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { findOptimalInsertionRange, toWidget, Widget } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { IconPageBreak } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\n\n/**\n * The page break command.\n *\n * The command is registered by {@link module:page-break/pagebreakediting~PageBreakEditing} as `'pageBreak'`.\n *\n * To insert a page break at the current selection, execute the command:\n *\n *\t\teditor.execute( 'pageBreak' );\n */\nclass PageBreakCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const schema = model.schema;\n    const selection = model.document.selection;\n    this.isEnabled = isPageBreakAllowedInParent(selection, schema, model);\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  */\n  execute() {\n    const model = this.editor.model;\n    model.change(writer => {\n      const pageBreakElement = writer.createElement('pageBreak');\n      model.insertObject(pageBreakElement, null, null, {\n        setSelection: 'after'\n      });\n    });\n  }\n}\n/**\n * Checks if a page break is allowed by the schema in the optimal insertion parent.\n */\nfunction isPageBreakAllowedInParent(selection, schema, model) {\n  const parent = getInsertPageBreakParent(selection, model);\n  return schema.checkChild(parent, 'pageBreak');\n}\n/**\n * Returns a node that will be used to insert a page break with `model.insertContent` to check if the page break can be placed there.\n */\nfunction getInsertPageBreakParent(selection, model) {\n  const insertionRange = findOptimalInsertionRange(selection, model);\n  const parent = insertionRange.start.parent;\n  if (parent.isEmpty && !parent.is('element', '$root')) {\n    return parent.parent;\n  }\n  return parent;\n}\n\n/**\n * The page break editing feature.\n */\nclass PageBreakEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'PageBreakEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const t = editor.t;\n    const conversion = editor.conversion;\n    schema.register('pageBreak', {\n      inheritAllFrom: '$blockObject'\n    });\n    conversion.for('dataDowncast').elementToStructure({\n      model: 'pageBreak',\n      view: (modelElement, {\n        writer\n      }) => {\n        const divElement = writer.createContainerElement('div', {\n          class: 'page-break',\n          // If user has no `.ck-content` styles, it should always break a page during print.\n          style: 'page-break-after: always'\n        },\n        // For a rationale of using span inside a div see:\n        // https://github.com/ckeditor/ckeditor5-page-break/pull/1#discussion_r328934062.\n        writer.createContainerElement('span', {\n          style: 'display: none'\n        }));\n        return divElement;\n      }\n    });\n    conversion.for('editingDowncast').elementToStructure({\n      model: 'pageBreak',\n      view: (modelElement, {\n        writer\n      }) => {\n        const label = t('Page break');\n        const viewWrapper = writer.createContainerElement('div');\n        const viewLabelElement = writer.createRawElement('span', {\n          class: 'page-break__label'\n        }, function (domElement) {\n          domElement.innerText = t('Page break');\n        });\n        writer.addClass('page-break', viewWrapper);\n        writer.insert(writer.createPositionAt(viewWrapper, 0), viewLabelElement);\n        return toPageBreakWidget(viewWrapper, writer, label);\n      }\n    });\n    conversion.for('upcast').elementToElement({\n      view: element => {\n        // For upcast conversion it's enough if we check for element style and verify if it's empty\n        // or contains only hidden span element.\n        const hasPageBreakBefore = element.getStyle('page-break-before') == 'always';\n        const hasPageBreakAfter = element.getStyle('page-break-after') == 'always';\n        if (!hasPageBreakBefore && !hasPageBreakAfter) {\n          return null;\n        }\n        // The \"page break\" div accepts only single child or no child at all.\n        if (element.childCount == 1) {\n          const viewSpan = element.getChild(0);\n          // The child must be the \"span\" element that is not displayed.\n          if (!viewSpan.is('element', 'span') || viewSpan.getStyle('display') != 'none') {\n            return null;\n          }\n        } else if (element.childCount > 1) {\n          return null;\n        }\n        return {\n          name: true\n        };\n      },\n      model: 'pageBreak',\n      // This conversion must be checked before <br> conversion because some editors use\n      // <br style=\"page-break-before:always\"> as a page break marker.\n      converterPriority: 'high'\n    });\n    editor.commands.add('pageBreak', new PageBreakCommand(editor));\n  }\n}\n/**\n * Converts a given {@link module:engine/view/element~Element} to a page break widget:\n * * Adds a {@link module:engine/view/element~Element#_setCustomProperty custom property} allowing to\n *   recognize the page break widget element.\n * * Calls the {@link module:widget/utils~toWidget} function with the proper element's label creator.\n */\nfunction toPageBreakWidget(viewElement, writer, label) {\n  writer.setCustomProperty('pageBreak', true, viewElement);\n  return toWidget(viewElement, writer, {\n    label\n  });\n}\n\n/**\n * The page break UI plugin.\n */\nclass PageBreakUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'PageBreakUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Add pageBreak button to feature components.\n    editor.ui.componentFactory.add('pageBreak', () => {\n      const view = this._createButton(ButtonView);\n      view.set({\n        tooltip: true\n      });\n      return view;\n    });\n    editor.ui.componentFactory.add('menuBar:pageBreak', () => this._createButton(MenuBarMenuListItemButtonView));\n  }\n  /**\n  * Creates a button for page break command to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const command = editor.commands.get('pageBreak');\n    const view = new ButtonClass(editor.locale);\n    const t = locale.t;\n    view.set({\n      label: t('Page break'),\n      icon: IconPageBreak\n    });\n    view.bind('isEnabled').to(command, 'isEnabled');\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.execute('pageBreak');\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n}\n\n/**\n * The page break feature.\n *\n * It provides the possibility to insert a page break into the rich-text editor.\n *\n * For a detailed overview, check the {@glink features/page-break Page break feature} documentation.\n */\nclass PageBreak extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [PageBreakEditing, PageBreakUI, Widget];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'PageBreak';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { PageBreak, PageBreakEditing, PageBreakUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, Command } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { IconRemoveFormat } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { first } from '@ckeditor/ckeditor5-utils/dist/index.js';\nconst REMOVE_FORMAT = 'removeFormat';\n/**\n * The remove format UI plugin. It registers the `'removeFormat'` button which can be\n * used in the toolbar.\n */\nclass RemoveFormatUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'RemoveFormatUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add(REMOVE_FORMAT, () => {\n      const view = this._createButton(ButtonView);\n      view.set({\n        tooltip: true\n      });\n      return view;\n    });\n    editor.ui.componentFactory.add(`menuBar:${REMOVE_FORMAT}`, () => this._createButton(MenuBarMenuListItemButtonView));\n  }\n  /**\n  * Creates a button for remove format command to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const command = editor.commands.get(REMOVE_FORMAT);\n    const view = new ButtonClass(editor.locale);\n    const t = locale.t;\n    view.set({\n      label: t('Remove Format'),\n      icon: IconRemoveFormat\n    });\n    view.bind('isEnabled').to(command, 'isEnabled');\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.execute(REMOVE_FORMAT);\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n}\n\n/**\n * The remove format command.\n *\n * It is used by the {@link module:remove-format/removeformat~RemoveFormat remove format feature}\n * to clear the formatting in the selection.\n *\n * ```ts\n * editor.execute( 'removeFormat' );\n * ```\n */\nclass RemoveFormatCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    this.isEnabled = !!first(this._getFormattingItems(model.document.selection, model.schema));\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const model = this.editor.model;\n    const schema = model.schema;\n    model.change(writer => {\n      for (const item of this._getFormattingItems(model.document.selection, schema)) {\n        if (item.is('selection')) {\n          for (const attributeName of this._getFormattingAttributes(item, schema)) {\n            writer.removeSelectionAttribute(attributeName);\n          }\n        } else {\n          // Workaround for items with multiple removable attributes. See\n          // https://github.com/ckeditor/ckeditor5-remove-format/pull/1#pullrequestreview-220515609\n          const itemRange = writer.createRangeOn(item);\n          for (const attributeName of this._getFormattingAttributes(item, schema)) {\n            writer.removeAttribute(attributeName, itemRange);\n          }\n        }\n      }\n    });\n  }\n  /**\n  * Returns an iterable of items in a selection (including the selection itself) that have formatting model\n  * attributes to be removed by the feature.\n  *\n  * @param schema The schema describing the item.\n  */\n  *_getFormattingItems(selection, schema) {\n    const itemHasRemovableFormatting = item => {\n      return !!first(this._getFormattingAttributes(item, schema));\n    };\n    // Check formatting on selected items that are not blocks.\n    for (const curRange of selection.getRanges()) {\n      for (const item of curRange.getItems()) {\n        if (!schema.isBlock(item) && itemHasRemovableFormatting(item)) {\n          yield item;\n        }\n      }\n    }\n    // Check formatting from selected blocks.\n    for (const block of selection.getSelectedBlocks()) {\n      if (itemHasRemovableFormatting(block)) {\n        yield block;\n      }\n    }\n    // Finally the selection might be formatted as well, so make sure to check it.\n    if (itemHasRemovableFormatting(selection)) {\n      yield selection;\n    }\n  }\n  /**\n  * Returns an iterable of formatting attributes of a given model item.\n  *\n  * **Note:** Formatting items have the `isFormatting` property set to `true`.\n  *\n  * @param schema The schema describing the item.\n  * @returns The names of formatting attributes found in a given item.\n  */\n  *_getFormattingAttributes(item, schema) {\n    for (const [attributeName] of item.getAttributes()) {\n      const attributeProperties = schema.getAttributeProperties(attributeName);\n      if (attributeProperties && attributeProperties.isFormatting) {\n        yield attributeName;\n      }\n    }\n  }\n}\n\n/**\n * The remove format editing plugin.\n *\n * It registers the {@link module:remove-format/removeformatcommand~RemoveFormatCommand removeFormat} command.\n */\nclass RemoveFormatEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'RemoveFormatEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.commands.add('removeFormat', new RemoveFormatCommand(editor));\n  }\n}\n\n/**\n * The remove format plugin.\n *\n * This is a \"glue\" plugin which loads the {@link module:remove-format/removeformatediting~RemoveFormatEditing}\n * and {@link module:remove-format/removeformatui~RemoveFormatUI} plugins.\n *\n * For a detailed overview, check out the {@glink features/remove-format remove format} feature documentation.\n */\nclass RemoveFormat extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [RemoveFormatEditing, RemoveFormatUI];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'RemoveFormat';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\nexport { RemoveFormat, RemoveFormatEditing, RemoveFormatUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Matcher } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { IconContentLock, IconContentUnlock } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { createDropdown, addListToDropdown, MenuBarMenuView, MenuBarMenuListView, MenuBarMenuListItemView, MenuBarMenuListItemButtonView, ViewModel, ButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { Collection } from '@ckeditor/ckeditor5-utils/dist/index.js';\n\n/**\n * The command that allows navigation across the exceptions in the edited document.\n */\nclass RestrictedEditingModeNavigationCommand extends Command {\n  /**\n  * The direction of the command.\n  */\n  _direction;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor The editor instance.\n  * @param direction The direction that the command works.\n  */\n  constructor(editor, direction) {\n    super(editor);\n    // It does not affect data so should be enabled in read-only mode and in restricted editing mode.\n    this.affectsData = false;\n    this._direction = direction;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    this.isEnabled = this._checkEnabled();\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  */\n  execute() {\n    const position = getNearestExceptionRange(this.editor.model, this._direction);\n    if (!position) {\n      return;\n    }\n    this.editor.model.change(writer => {\n      writer.setSelection(position);\n    });\n  }\n  /**\n  * Checks whether the command can be enabled in the current context.\n  *\n  * @returns Whether the command should be enabled.\n  */\n  _checkEnabled() {\n    return !!getNearestExceptionRange(this.editor.model, this._direction);\n  }\n}\n/**\n * Returns the range of the exception marker closest to the last position of the model selection.\n */\nfunction getNearestExceptionRange(model, direction) {\n  const selection = model.document.selection;\n  const selectionPosition = selection.getFirstPosition();\n  const markerRanges = [];\n  // Get all exception marker positions that start after/before the selection position.\n  for (const marker of model.markers.getMarkersGroup('restrictedEditingException')) {\n    const markerRange = marker.getRange();\n    // Checking parent because there two positions <paragraph>foo^</paragraph><paragraph>^bar</paragraph>\n    // are touching but they will represent different markers.\n    const isMarkerRangeTouching = selectionPosition.isTouching(markerRange.start) && selectionPosition.hasSameParentAs(markerRange.start) || selectionPosition.isTouching(markerRange.end) && selectionPosition.hasSameParentAs(markerRange.end);\n    // <paragraph>foo <markerâ‰¥b[]ar</marker> baz</paragraph>\n    // <paragraph>foo <markerâ‰¥b[ar</marker> ba]z</paragraph>\n    // <paragraph>foo <markerâ‰¥bar</marker>[] baz</paragraph>\n    // <paragraph>foo []<markerâ‰¥bar</marker> baz</paragraph>\n    if (markerRange.containsPosition(selectionPosition) || isMarkerRangeTouching) {\n      continue;\n    }\n    if (direction === 'forward' && markerRange.start.isAfter(selectionPosition)) {\n      markerRanges.push(markerRange);\n    } else if (direction === 'backward' && markerRange.end.isBefore(selectionPosition)) {\n      markerRanges.push(markerRange);\n    }\n  }\n  if (!markerRanges.length) {\n    return;\n  }\n  // Get the marker closest to the selection position among many. To know that, we need to sort\n  // them first.\n  return markerRanges.sort((rangeA, rangeB) => {\n    if (direction === 'forward') {\n      return rangeA.start.isAfter(rangeB.start) ? 1 : -1;\n    } else {\n      return rangeA.start.isBefore(rangeB.start) ? 1 : -1;\n    }\n  }).shift();\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module restricted-editing/restrictededitingmode/utils\n    */ /**\n       * Returns a single \"restricted-editing-exception\" marker at a given position. Contrary to\n       * {@link module:engine/model/markercollection~MarkerCollection#getMarkersAtPosition}, it returnd a marker also when the postion is\n       * equal to one of the marker's start or end positions.\n       */\nfunction getMarkerAtPosition(editor, position) {\n  for (const marker of editor.model.markers) {\n    const markerRange = marker.getRange();\n    if (isPositionInRangeBoundaries(markerRange, position)) {\n      if (marker.name.startsWith('restrictedEditingException:')) {\n        return marker;\n      }\n    }\n  }\n}\n/**\n * Checks if the position is fully contained in the range. Positions equal to range start or end are considered \"in\".\n */\nfunction isPositionInRangeBoundaries(range, position) {\n  return range.containsPosition(position) || range.end.isEqual(position) || range.start.isEqual(position);\n}\n/**\n * Checks if the selection is fully contained in the marker. Positions on marker boundaries are considered \"in\".\n *\n * ```xml\n * <marker>[]foo</marker> -> true\n * <marker>f[oo]</marker> -> true\n * <marker>f[oo</marker> ba]r -> false\n * <marker>foo</marker> []bar -> false\n * ```\n */\nfunction isSelectionInMarker(selection, marker) {\n  if (!marker) {\n    return false;\n  }\n  const markerRange = marker.getRange();\n  if (selection.isCollapsed) {\n    return isPositionInRangeBoundaries(markerRange, selection.focus);\n  }\n  return markerRange.containsRange(selection.getFirstRange(), true);\n}\nconst HIGHLIGHT_CLASS = 'restricted-editing-exception_selected';\n/**\n * Adds a visual highlight style to a restricted editing exception that the selection is anchored to.\n *\n * The highlight is turned on by adding the `.restricted-editing-exception_selected` class to the\n * exception in the view:\n *\n * * The class is removed before the conversion starts, as callbacks added with the `'highest'` priority\n * to {@link module:engine/conversion/downcastdispatcher~DowncastDispatcher} events.\n * * The class is added in the view post-fixer, after other changes in the model tree are converted to the view.\n *\n * This way, adding and removing the highlight does not interfere with conversion.\n */\nfunction setupExceptionHighlighting(editor) {\n  const view = editor.editing.view;\n  const model = editor.model;\n  const highlightedMarkers = new Set();\n  // Adding the class.\n  view.document.registerPostFixer(writer => {\n    const modelSelection = model.document.selection;\n    const marker = getMarkerAtPosition(editor, modelSelection.anchor);\n    if (!marker) {\n      return false;\n    }\n    for (const viewElement of editor.editing.mapper.markerNameToElements(marker.name)) {\n      writer.addClass(HIGHLIGHT_CLASS, viewElement);\n      highlightedMarkers.add(viewElement);\n    }\n    return false;\n  });\n  // Removing the class.\n  editor.conversion.for('editingDowncast').add(dispatcher => {\n    // Make sure the highlight is removed on every possible event, before conversion is started.\n    dispatcher.on('insert', removeHighlight, {\n      priority: 'highest'\n    });\n    dispatcher.on('remove', removeHighlight, {\n      priority: 'highest'\n    });\n    dispatcher.on('attribute', removeHighlight, {\n      priority: 'highest'\n    });\n    dispatcher.on('cleanSelection', removeHighlight);\n    function removeHighlight() {\n      view.change(writer => {\n        for (const item of highlightedMarkers.values()) {\n          writer.removeClass(HIGHLIGHT_CLASS, item);\n          highlightedMarkers.delete(item);\n        }\n      });\n    }\n  });\n}\n/**\n * A post-fixer that prevents removing a collapsed marker from the document.\n */\nfunction resurrectCollapsedMarkerPostFixer(editor) {\n  // This post-fixer shouldn't be necessary after https://github.com/ckeditor/ckeditor5/issues/5778.\n  return writer => {\n    let changeApplied = false;\n    for (const {\n      name,\n      data\n    } of editor.model.document.differ.getChangedMarkers()) {\n      if (name.startsWith('restrictedEditingException') && data.newRange && data.newRange.root.rootName == '$graveyard') {\n        writer.updateMarker(name, {\n          range: writer.createRange(writer.createPositionAt(data.oldRange.start))\n        });\n        changeApplied = true;\n      }\n    }\n    return changeApplied;\n  };\n}\n/**\n * A post-fixer that extends a marker when the user types on its boundaries.\n */\nfunction extendMarkerOnTypingPostFixer(editor) {\n  // This post-fixer shouldn't be necessary after https://github.com/ckeditor/ckeditor5/issues/5778.\n  return writer => {\n    let changeApplied = false;\n    const schema = editor.model.schema;\n    for (const change of editor.model.document.differ.getChanges()) {\n      if (change.type == 'insert' && schema.checkChild('$block', change.name)) {\n        changeApplied = _tryExtendMarkerStart(editor, change.position, change.length, writer) || changeApplied;\n        changeApplied = _tryExtendMarkedEnd(editor, change.position, change.length, writer) || changeApplied;\n      }\n    }\n    return changeApplied;\n  };\n}\n/**\n * A view highlight-to-marker conversion helper.\n *\n * @param config Conversion configuration.\n */\nfunction upcastHighlightToMarker(config) {\n  return dispatcher => dispatcher.on('element:span', (evt, data, conversionApi) => {\n    const {\n      writer\n    } = conversionApi;\n    const matcher = new Matcher(config.view);\n    const matcherResult = matcher.match(data.viewItem);\n    // If there is no match, this callback should not do anything.\n    if (!matcherResult) {\n      return;\n    }\n    const match = matcherResult.match;\n    // Force consuming element's name (taken from upcast helpers elementToElement converter).\n    match.name = true;\n    const {\n      modelRange: convertedChildrenRange\n    } = conversionApi.convertChildren(data.viewItem, data.modelCursor);\n    conversionApi.consumable.consume(data.viewItem, match);\n    const markerName = config.model();\n    const fakeMarkerStart = writer.createElement('$marker', {\n      'data-name': markerName\n    });\n    const fakeMarkerEnd = writer.createElement('$marker', {\n      'data-name': markerName\n    });\n    // Insert in reverse order to use converter content positions directly (without recalculating).\n    writer.insert(fakeMarkerEnd, convertedChildrenRange.end);\n    writer.insert(fakeMarkerStart, convertedChildrenRange.start);\n    data.modelRange = writer.createRange(writer.createPositionBefore(fakeMarkerStart), writer.createPositionAfter(fakeMarkerEnd));\n    data.modelCursor = data.modelRange.end;\n  });\n}\n/**\n * Extend marker if change detected on marker's start position.\n */\nfunction _tryExtendMarkerStart(editor, position, length, writer) {\n  const markerAtStart = getMarkerAtPosition(editor, position.getShiftedBy(length));\n  if (markerAtStart && markerAtStart.getStart().isEqual(position.getShiftedBy(length))) {\n    writer.updateMarker(markerAtStart, {\n      range: writer.createRange(markerAtStart.getStart().getShiftedBy(-length), markerAtStart.getEnd())\n    });\n    return true;\n  }\n  return false;\n}\n/**\n * Extend marker if change detected on marker's end position.\n */\nfunction _tryExtendMarkedEnd(editor, position, length, writer) {\n  const markerAtEnd = getMarkerAtPosition(editor, position);\n  if (markerAtEnd && markerAtEnd.getEnd().isEqual(position)) {\n    writer.updateMarker(markerAtEnd, {\n      range: writer.createRange(markerAtEnd.getStart(), markerAtEnd.getEnd().getShiftedBy(length))\n    });\n    return true;\n  }\n  return false;\n}\nconst COMMAND_FORCE_DISABLE_ID = 'RestrictedEditingMode';\n/**\n * The restricted editing mode editing feature.\n *\n * * It introduces the exception marker group that renders to `<span>` elements with the `restricted-editing-exception` CSS class.\n * * It registers the `'goToPreviousRestrictedEditingException'` and `'goToNextRestrictedEditingException'` commands.\n * * It also enables highlighting exception markers that are selected.\n */\nclass RestrictedEditingModeEditing extends Plugin {\n  /**\n  * Command names that are enabled outside the non-restricted regions.\n  */\n  _alwaysEnabled;\n  /**\n  * Commands allowed in non-restricted areas.\n  *\n  * Commands always enabled combine typing feature commands: `'input'`, `'insertText'`, `'delete'`, and `'deleteForward'` with\n  * commands defined in the feature configuration.\n  */\n  _allowedInException;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'RestrictedEditingModeEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('restrictedEditing', {\n      allowedCommands: ['bold', 'italic', 'link', 'unlink'],\n      allowedAttributes: ['bold', 'italic', 'linkHref']\n    });\n    this._alwaysEnabled = new Set(['undo', 'redo']);\n    this._allowedInException = new Set(['input', 'insertText', 'delete', 'deleteForward']);\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const allowedCommands = editor.config.get('restrictedEditing.allowedCommands');\n    allowedCommands.forEach(commandName => this._allowedInException.add(commandName));\n    this._setupConversion();\n    this._setupCommandsToggling();\n    this._setupRestrictions();\n    // Commands & keystrokes that allow navigation in the content.\n    editor.commands.add('goToPreviousRestrictedEditingException', new RestrictedEditingModeNavigationCommand(editor, 'backward'));\n    editor.commands.add('goToNextRestrictedEditingException', new RestrictedEditingModeNavigationCommand(editor, 'forward'));\n    this.listenTo(editingView.document, 'tab', (evt, data) => {\n      const commandName = !data.shiftKey ? 'goToNextRestrictedEditingException' : 'goToPreviousRestrictedEditingException';\n      const command = editor.commands.get(commandName);\n      if (command.isEnabled) {\n        editor.execute(commandName);\n        // Stop the event in the DOM: no listener in the web page will be triggered by this event.\n        data.preventDefault();\n        data.stopPropagation();\n      }\n      // Stop the event bubbling in the editor: no more callbacks will be executed for this keystroke.\n      evt.stop();\n    }, {\n      context: '$capture'\n    });\n    editor.keystrokes.set('Ctrl+A', getSelectAllHandler(editor));\n    editingView.change(writer => {\n      for (const root of editingView.document.roots) {\n        writer.addClass('ck-restricted-editing_mode_restricted', root);\n      }\n    });\n    // Remove existing restricted editing markers when setting new data to prevent marker resurrection.\n    // Without this, markers from removed content would be incorrectly restored due to the resurrection mechanism.\n    // See more: https://github.com/ckeditor/ckeditor5/issues/9646#issuecomment-843064995\n    editor.data.on('set', () => {\n      editor.model.change(writer => {\n        for (const marker of editor.model.markers.getMarkersGroup('restrictedEditingException')) {\n          writer.removeMarker(marker.name);\n        }\n      });\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Makes the given command always enabled in the restricted editing mode (regardless\n  * of selection location).\n  *\n  * To enable some commands in non-restricted areas of the content use\n  * {@link module:restricted-editing/restrictededitingconfig~RestrictedEditingConfig#allowedCommands} configuration option.\n  *\n  * @param commandName Name of the command to enable.\n  */\n  enableCommand(commandName) {\n    const command = this.editor.commands.get(commandName);\n    command.clearForceDisabled(COMMAND_FORCE_DISABLE_ID);\n    this._alwaysEnabled.add(commandName);\n  }\n  /**\n  * Sets up the restricted mode editing conversion:\n  *\n  * * ucpast & downcast converters,\n  * * marker highlighting in the edting area,\n  * * marker post-fixers.\n  */\n  _setupConversion() {\n    const editor = this.editor;\n    const model = editor.model;\n    const doc = model.document;\n    // The restricted editing does not attach additional data to the zones so there's no need for smarter markers managing.\n    // Also, the markers will only be created when loading the data.\n    let markerNumber = 0;\n    editor.conversion.for('upcast').add(upcastHighlightToMarker({\n      view: {\n        name: 'span',\n        classes: 'restricted-editing-exception'\n      },\n      model: () => {\n        markerNumber++; // Starting from restrictedEditingException:1 marker.\n        return `restrictedEditingException:${markerNumber}`;\n      }\n    }));\n    // Currently the marker helpers are tied to other use-cases and do not render a collapsed marker as highlight.\n    // Also, markerToHighlight can not convert marker on an inline object. It handles only text and widgets,\n    // but it is not a case in the data pipeline. That's why there are 3 downcast converters for them:\n    //\n    // 1. The custom inline item (text or inline object) converter (but not the selection).\n    editor.conversion.for('downcast').add(dispatcher => {\n      dispatcher.on('addMarker:restrictedEditingException', (evt, data, conversionApi) => {\n        // Only convert per-item conversion.\n        if (!data.item) {\n          return;\n        }\n        // Do not convert the selection or non-inline items.\n        if (data.item.is('selection') || !conversionApi.schema.isInline(data.item)) {\n          return;\n        }\n        if (!conversionApi.consumable.consume(data.item, evt.name)) {\n          return;\n        }\n        const viewWriter = conversionApi.writer;\n        const viewElement = viewWriter.createAttributeElement('span', {\n          class: 'restricted-editing-exception'\n        }, {\n          id: data.markerName,\n          priority: -10\n        });\n        const viewRange = conversionApi.mapper.toViewRange(data.range);\n        const rangeAfterWrap = viewWriter.wrap(viewRange, viewElement);\n        for (const element of rangeAfterWrap.getItems()) {\n          if (element.is('attributeElement') && element.isSimilar(viewElement)) {\n            conversionApi.mapper.bindElementToMarker(element, data.markerName);\n            break;\n          }\n        }\n      });\n    });\n    // 2. The marker-to-highlight converter for the document selection.\n    editor.conversion.for('downcast').markerToHighlight({\n      model: 'restrictedEditingException',\n      // Use callback to return new object every time new marker instance is created - otherwise it will be seen as the same marker.\n      view: () => {\n        return {\n          name: 'span',\n          classes: 'restricted-editing-exception',\n          priority: -10\n        };\n      }\n    });\n    // 3. And for collapsed marker we need to render it as an element.\n    // Additionally, the editing pipeline should always display a collapsed marker.\n    editor.conversion.for('editingDowncast').markerToElement({\n      model: 'restrictedEditingException',\n      view: (markerData, {\n        writer\n      }) => {\n        return writer.createUIElement('span', {\n          class: 'restricted-editing-exception restricted-editing-exception_collapsed'\n        });\n      }\n    });\n    editor.conversion.for('dataDowncast').markerToElement({\n      model: 'restrictedEditingException',\n      view: (markerData, {\n        writer\n      }) => {\n        return writer.createEmptyElement('span', {\n          class: 'restricted-editing-exception'\n        });\n      }\n    });\n    doc.registerPostFixer(extendMarkerOnTypingPostFixer(editor));\n    doc.registerPostFixer(resurrectCollapsedMarkerPostFixer(editor));\n    doc.registerPostFixer(ensureNewMarkerIsFlatPostFixer(editor));\n    setupExceptionHighlighting(editor);\n  }\n  /**\n  * Setups additional editing restrictions beyond command toggling:\n  *\n  * * delete content range trimming\n  * * disabling input command outside exception marker\n  * * restricting clipboard holder to text only\n  * * restricting text attributes in content\n  */\n  _setupRestrictions() {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    const viewDoc = editor.editing.view.document;\n    const clipboard = editor.plugins.get('ClipboardPipeline');\n    this.listenTo(model, 'deleteContent', restrictDeleteContent(editor), {\n      priority: 'high'\n    });\n    const insertTextCommand = editor.commands.get('insertText');\n    // The restricted editing might be configured without insert text support - ie allow only bolding or removing text.\n    // This check is bit synthetic since only tests are used this way.\n    if (insertTextCommand) {\n      this.listenTo(insertTextCommand, 'execute', disallowInputExecForWrongRange(editor), {\n        priority: 'high'\n      });\n    }\n    // Block clipboard outside exception marker on paste and drop.\n    this.listenTo(clipboard, 'contentInsertion', evt => {\n      if (!isRangeInsideSingleMarker(editor, selection.getFirstRange())) {\n        evt.stop();\n      }\n    });\n    // Block clipboard outside exception marker on cut.\n    this.listenTo(viewDoc, 'clipboardOutput', (evt, data) => {\n      if (data.method == 'cut' && !isRangeInsideSingleMarker(editor, selection.getFirstRange())) {\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    const allowedAttributes = editor.config.get('restrictedEditing.allowedAttributes');\n    model.schema.addAttributeCheck(onlyAllowAttributesFromList(allowedAttributes));\n    model.schema.addChildCheck(allowTextOnlyInClipboardHolder());\n  }\n  /**\n  * Sets up the command toggling which enables or disables commands based on the user selection.\n  */\n  _setupCommandsToggling() {\n    const editor = this.editor;\n    const model = editor.model;\n    const doc = model.document;\n    this._disableCommands();\n    this.listenTo(doc.selection, 'change', this._checkCommands.bind(this));\n    this.listenTo(doc, 'change:data', this._checkCommands.bind(this));\n  }\n  /**\n  * Checks if commands should be enabled or disabled based on the current selection.\n  */\n  _checkCommands() {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    if (selection.rangeCount > 1) {\n      this._disableCommands();\n      return;\n    }\n    const marker = getMarkerAtPosition(editor, selection.focus);\n    this._disableCommands();\n    if (isSelectionInMarker(selection, marker)) {\n      this._enableCommands(marker);\n    }\n  }\n  /**\n  * Enables commands in non-restricted regions.\n  */\n  _enableCommands(marker) {\n    const editor = this.editor;\n    for (const [commandName, command] of editor.commands) {\n      if (!command.affectsData || this._alwaysEnabled.has(commandName)) {\n        continue;\n      }\n      // Enable ony those commands that are allowed in the exception marker.\n      if (!this._allowedInException.has(commandName)) {\n        continue;\n      }\n      // Do not enable 'delete' and 'deleteForward' commands on the exception marker boundaries.\n      if (isDeleteCommandOnMarkerBoundaries(commandName, editor.model.document.selection, marker.getRange())) {\n        continue;\n      }\n      command.clearForceDisabled(COMMAND_FORCE_DISABLE_ID);\n    }\n  }\n  /**\n  * Disables commands outside non-restricted regions.\n  */\n  _disableCommands() {\n    const editor = this.editor;\n    for (const [commandName, command] of editor.commands) {\n      if (!command.affectsData || this._alwaysEnabled.has(commandName)) {\n        continue;\n      }\n      command.forceDisabled(COMMAND_FORCE_DISABLE_ID);\n    }\n  }\n}\n/**\n * Helper for handling Ctrl+A keydown behaviour.\n */\nfunction getSelectAllHandler(editor) {\n  return (_, cancel) => {\n    const model = editor.model;\n    const selection = editor.model.document.selection;\n    const marker = getMarkerAtPosition(editor, selection.focus);\n    if (!marker) {\n      return;\n    }\n    // If selection range is inside a restricted editing exception, select text only within the exception.\n    //\n    // Note: Second Ctrl+A press is also blocked and it won't select the entire text in the editor.\n    const selectionRange = selection.getFirstRange();\n    const markerRange = marker.getRange();\n    if (markerRange.containsRange(selectionRange, true) || selection.isCollapsed) {\n      cancel();\n      model.change(writer => {\n        writer.setSelection(marker.getRange());\n      });\n    }\n  };\n}\n/**\n * Additional rule for enabling \"delete\" and \"deleteForward\" commands if selection is on range boundaries:\n *\n * Does not allow to enable command when selection focus is:\n * - is on marker start - \"delete\" - to prevent removing content before marker\n * - is on marker end - \"deleteForward\" - to prevent removing content after marker\n */\nfunction isDeleteCommandOnMarkerBoundaries(commandName, selection, markerRange) {\n  if (commandName == 'delete' && markerRange.start.isEqual(selection.focus)) {\n    return true;\n  }\n  // Only for collapsed selection - non-collapsed selection that extends over a marker is handled elsewhere.\n  if (commandName == 'deleteForward' && selection.isCollapsed && markerRange.end.isEqual(selection.focus)) {\n    return true;\n  }\n  return false;\n}\n/**\n * Ensures that model.deleteContent() does not delete outside exception markers ranges.\n *\n * The enforced restrictions are:\n * - only execute deleteContent() inside exception markers\n * - restrict passed selection to exception marker\n */\nfunction restrictDeleteContent(editor) {\n  return (evt, args) => {\n    const [selection] = args;\n    const marker = getMarkerAtPosition(editor, selection.focus) || getMarkerAtPosition(editor, selection.anchor);\n    // Stop method execution if marker was not found at selection focus.\n    if (!marker) {\n      evt.stop();\n      return;\n    }\n    // Collapsed selection inside exception marker does not require fixing.\n    if (selection.isCollapsed) {\n      return;\n    }\n    // Shrink the selection to the range inside exception marker.\n    const allowedToDelete = marker.getRange().getIntersection(selection.getFirstRange());\n    // Some features uses selection passed to model.deleteContent() to set the selection afterwards. For this we need to properly modify\n    // either the document selection using change block...\n    if (selection.is('documentSelection')) {\n      editor.model.change(writer => {\n        writer.setSelection(allowedToDelete);\n      });\n    } else {\n      selection.setTo(allowedToDelete);\n    }\n  };\n}\n/**\n * Ensures that input command is executed with a range that is inside exception marker.\n *\n * This restriction is due to fact that using native spell check changes text outside exception marker.\n */\nfunction disallowInputExecForWrongRange(editor) {\n  return (evt, args) => {\n    const [options] = args;\n    const {\n      range\n    } = options;\n    // Only check \"input\" command executed with a range value.\n    // Selection might be set in exception marker but passed range might point elsewhere.\n    if (!range) {\n      return;\n    }\n    if (!isRangeInsideSingleMarker(editor, range)) {\n      evt.stop();\n    }\n  };\n}\nfunction isRangeInsideSingleMarker(editor, range) {\n  const markerAtStart = getMarkerAtPosition(editor, range.start);\n  const markerAtEnd = getMarkerAtPosition(editor, range.end);\n  return markerAtStart && markerAtEnd && markerAtEnd === markerAtStart;\n}\n/**\n * Checks if new marker range is flat. Non-flat ranges might appear during upcast conversion in nested structures, ie tables.\n *\n * Note: This marker fixer only consider case which is possible to create using StandardEditing mode plugin.\n * Markers created by developer in the data might break in many other ways.\n *\n * See #6003.\n */\nfunction ensureNewMarkerIsFlatPostFixer(editor) {\n  return writer => {\n    let changeApplied = false;\n    const changedMarkers = editor.model.document.differ.getChangedMarkers();\n    for (const {\n      data,\n      name\n    } of changedMarkers) {\n      if (!name.startsWith('restrictedEditingException')) {\n        continue;\n      }\n      const newRange = data.newRange;\n      if (!data.oldRange && !newRange.isFlat) {\n        const start = newRange.start;\n        const end = newRange.end;\n        const startIsHigherInTree = start.path.length > end.path.length;\n        const fixedStart = startIsHigherInTree ? newRange.start : writer.createPositionAt(end.parent, 0);\n        const fixedEnd = startIsHigherInTree ? writer.createPositionAt(start.parent, 'end') : newRange.end;\n        writer.updateMarker(name, {\n          range: writer.createRange(fixedStart, fixedEnd)\n        });\n        changeApplied = true;\n      }\n    }\n    return changeApplied;\n  };\n}\nfunction onlyAllowAttributesFromList(allowedAttributes) {\n  return (context, attributeName) => {\n    if (context.startsWith('$clipboardHolder')) {\n      return allowedAttributes.includes(attributeName);\n    }\n  };\n}\nfunction allowTextOnlyInClipboardHolder() {\n  return (context, childDefinition) => {\n    if (context.startsWith('$clipboardHolder')) {\n      return childDefinition.name === '$text';\n    }\n  };\n}\n\n/**\n * The restricted editing mode UI feature.\n *\n * It introduces the `'restrictedEditing'` dropdown that offers tools to navigate between exceptions across\n * the document.\n */\nclass RestrictedEditingModeUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'RestrictedEditingModeUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    editor.ui.componentFactory.add('restrictedEditing', locale => {\n      const dropdownView = createDropdown(locale);\n      const listItems = new Collection();\n      this._getButtonDefinitions().forEach(({\n        commandName,\n        label,\n        keystroke\n      }) => {\n        listItems.add(this._getButtonDefinition(commandName, label, keystroke));\n      });\n      addListToDropdown(dropdownView, listItems, {\n        role: 'menu'\n      });\n      dropdownView.buttonView.set({\n        label: t('Navigate editable regions'),\n        icon: IconContentLock,\n        tooltip: true,\n        isEnabled: true,\n        isOn: false\n      });\n      this.listenTo(dropdownView, 'execute', evt => {\n        const {\n          _commandName\n        } = evt.source;\n        editor.execute(_commandName);\n        editor.editing.view.focus();\n      });\n      return dropdownView;\n    });\n    editor.ui.componentFactory.add('menuBar:restrictedEditing', locale => {\n      const menuView = new MenuBarMenuView(locale);\n      const listView = new MenuBarMenuListView(locale);\n      listView.set({\n        ariaLabel: t('Navigate editable regions'),\n        role: 'menu'\n      });\n      menuView.buttonView.set({\n        label: t('Navigate editable regions'),\n        icon: IconContentLock\n      });\n      menuView.panelView.children.add(listView);\n      this._getButtonDefinitions().forEach(({\n        commandName,\n        label,\n        keystroke\n      }) => {\n        const listItemView = new MenuBarMenuListItemView(locale, menuView);\n        const buttonView = this._createMenuBarButton(label, commandName, keystroke);\n        buttonView.delegate('execute').to(menuView);\n        listItemView.children.add(buttonView);\n        listView.items.add(listItemView);\n      });\n      return menuView;\n    });\n  }\n  /**\n  * Creates a button for restricted editing command to use in menu bar.\n  */\n  _createMenuBarButton(label, commandName, keystroke) {\n    const editor = this.editor;\n    const command = editor.commands.get(commandName);\n    const view = new MenuBarMenuListItemButtonView(editor.locale);\n    view.set({\n      label,\n      keystroke,\n      isEnabled: true,\n      isOn: false\n    });\n    view.bind('isEnabled').to(command);\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.execute(commandName);\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n  /**\n  * Returns a definition of the navigation button to be used in the dropdown.\n  *\n  * @param commandName The name of the command that the button represents.\n  * @param label The translated label of the button.\n  * @param keystroke The button keystroke.\n  */\n  _getButtonDefinition(commandName, label, keystroke) {\n    const editor = this.editor;\n    const command = editor.commands.get(commandName);\n    const definition = {\n      type: 'button',\n      model: new ViewModel({\n        label,\n        withText: true,\n        keystroke,\n        withKeystroke: true,\n        role: 'menuitem',\n        _commandName: commandName\n      })\n    };\n    definition.model.bind('isEnabled').to(command, 'isEnabled');\n    return definition;\n  }\n  /**\n  * Returns definitions for UI buttons.\n  *\n  * @internal\n  */\n  _getButtonDefinitions() {\n    const t = this.editor.locale.t;\n    return [{\n      commandName: 'goToPreviousRestrictedEditingException',\n      label: t('Previous editable region'),\n      keystroke: 'Shift+Tab'\n    }, {\n      commandName: 'goToNextRestrictedEditingException',\n      label: t('Next editable region'),\n      keystroke: 'Tab'\n    }];\n  }\n}\n\n/**\n * The restricted editing mode plugin.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * The {@link module:restricted-editing/restrictededitingmodeediting~RestrictedEditingModeEditing restricted mode editing feature}.\n * * The {@link module:restricted-editing/restrictededitingmodeui~RestrictedEditingModeUI restricted mode UI feature}.\n */\nclass RestrictedEditingMode extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'RestrictedEditingMode';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [RestrictedEditingModeEditing, RestrictedEditingModeUI];\n  }\n}\n\n/**\n * The command that toggles exceptions from the restricted editing on text.\n */\nclass RestrictedEditingExceptionCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const doc = model.document;\n    this.value = !!doc.selection.getAttribute('restrictedEditingException');\n    this.isEnabled = model.schema.checkAttributeInSelection(doc.selection, 'restrictedEditingException');\n  }\n  /**\n  * @inheritDoc\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const document = model.document;\n    const selection = document.selection;\n    const valueToSet = options.forceValue === undefined ? !this.value : options.forceValue;\n    model.change(writer => {\n      const ranges = model.schema.getValidRanges(selection.getRanges(), 'restrictedEditingException');\n      if (selection.isCollapsed) {\n        if (valueToSet) {\n          writer.setSelectionAttribute('restrictedEditingException', valueToSet);\n        } else {\n          const isSameException = value => {\n            return value.item.getAttribute('restrictedEditingException') === this.value;\n          };\n          const focus = selection.focus;\n          const exceptionStart = focus.getLastMatchingPosition(isSameException, {\n            direction: 'backward'\n          });\n          const exceptionEnd = focus.getLastMatchingPosition(isSameException);\n          writer.removeSelectionAttribute('restrictedEditingException');\n          if (!(focus.isEqual(exceptionStart) || focus.isEqual(exceptionEnd))) {\n            writer.removeAttribute('restrictedEditingException', writer.createRange(exceptionStart, exceptionEnd));\n          }\n        }\n      } else {\n        for (const range of ranges) {\n          if (valueToSet) {\n            writer.setAttribute('restrictedEditingException', valueToSet, range);\n          } else {\n            writer.removeAttribute('restrictedEditingException', range);\n          }\n        }\n      }\n    });\n  }\n}\n\n/**\n * The standard editing mode editing feature.\n *\n * * It introduces the `restrictedEditingException` text attribute that is rendered as\n * a `<span>` element with the `restricted-editing-exception` CSS class.\n * * It registers the `'restrictedEditingException'` command.\n */\nclass StandardEditingModeEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'StandardEditingModeEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.model.schema.extend('$text', {\n      allowAttributes: ['restrictedEditingException']\n    });\n    editor.conversion.for('upcast').elementToAttribute({\n      model: 'restrictedEditingException',\n      view: {\n        name: 'span',\n        classes: 'restricted-editing-exception'\n      }\n    });\n    editor.conversion.for('downcast').attributeToElement({\n      model: 'restrictedEditingException',\n      view: (modelAttributeValue, {\n        writer\n      }) => {\n        if (modelAttributeValue) {\n          // Make the restricted editing <span> outer-most in the view.\n          return writer.createAttributeElement('span', {\n            class: 'restricted-editing-exception'\n          }, {\n            priority: -10\n          });\n        }\n      }\n    });\n    editor.commands.add('restrictedEditingException', new RestrictedEditingExceptionCommand(editor));\n    editor.editing.view.change(writer => {\n      for (const root of editor.editing.view.document.roots) {\n        writer.addClass('ck-restricted-editing_mode_standard', root);\n      }\n    });\n  }\n}\n\n/**\n * The standard editing mode UI feature.\n *\n * It introduces the `'restrictedEditingException'` button that marks text as unrestricted for editing.\n */\nclass StandardEditingModeUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'StandardEditingModeUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('restrictedEditingException', () => {\n      const button = this._createButton(ButtonView);\n      button.set({\n        tooltip: true,\n        isToggleable: true\n      });\n      return button;\n    });\n    editor.ui.componentFactory.add('menuBar:restrictedEditingException', () => {\n      return this._createButton(MenuBarMenuListItemButtonView);\n    });\n  }\n  /**\n  * Creates a button for restricted editing exception command to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const command = this.editor.commands.get('restrictedEditingException');\n    const view = new ButtonClass(locale);\n    const t = locale.t;\n    view.icon = IconContentUnlock;\n    view.bind('isOn', 'isEnabled').to(command, 'value', 'isEnabled');\n    view.bind('label').to(command, 'value', value => {\n      return value ? t('Disable editing') : t('Enable editing');\n    });\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.execute('restrictedEditingException');\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n}\n\n/**\n * The standard editing mode plugin.\n *\n * This is a \"glue\" plugin that loads the following plugins:\n *\n * * The {@link module:restricted-editing/standardeditingmodeediting~StandardEditingModeEditing standard mode editing feature}.\n * * The {@link module:restricted-editing/standardeditingmodeui~StandardEditingModeUI standard mode UI feature}.\n */\nclass StandardEditingMode extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'StandardEditingMode';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  static get requires() {\n    return [StandardEditingModeEditing, StandardEditingModeUI];\n  }\n}\nexport { RestrictedEditingMode, RestrictedEditingModeEditing, RestrictedEditingModeUI, StandardEditingMode, StandardEditingModeEditing, StandardEditingModeUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { IconShowBlocks } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\n\n/**\n * The show blocks command.\n *\n * Displays the HTML element names for content blocks.\n */\nclass ShowBlocksCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    // It does not affect data so should be enabled in read-only mode.\n    this.affectsData = false;\n    this.value = false;\n  }\n  /**\n  * Toggles the visibility of content blocks.\n  */\n  execute() {\n    const CLASS_NAME = 'ck-show-blocks';\n    const view = this.editor.editing.view;\n    view.change(writer => {\n      // Multiroot support.\n      for (const root of view.document.roots) {\n        if (!root.hasClass(CLASS_NAME)) {\n          writer.addClass(CLASS_NAME, root);\n          this.value = true;\n        } else {\n          writer.removeClass(CLASS_NAME, root);\n          this.value = false;\n        }\n      }\n    });\n  }\n}\n\n/**\n * The show blocks editing plugin.\n */\nclass ShowBlocksEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ShowBlocksEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const {\n      editor\n    } = this;\n    editor.commands.add('showBlocks', new ShowBlocksCommand(editor));\n  }\n}\n\n/**\n * The UI plugin of the show blocks feature.\n *\n * It registers the `'showBlocks'` UI button in the editor's {@link module:ui/componentfactory~ComponentFactory component factory}\n * that toggles the visibility of the HTML element names of content blocks.\n */\nclass ShowBlocksUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ShowBlocksUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('showBlocks', () => {\n      const buttonView = this._createButton(ButtonView);\n      buttonView.set({\n        tooltip: true,\n        icon: IconShowBlocks\n      });\n      return buttonView;\n    });\n    editor.ui.componentFactory.add('menuBar:showBlocks', () => {\n      return this._createButton(MenuBarMenuListItemButtonView);\n    });\n  }\n  /**\n  * Creates a button for show blocks command to use either in toolbar or in menu bar.\n  */\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const command = editor.commands.get('showBlocks');\n    const view = new ButtonClass(locale);\n    const t = locale.t;\n    view.set({\n      label: t('Show blocks'),\n      isToggleable: true,\n      role: 'menuitemcheckbox'\n    });\n    view.bind('isEnabled').to(command);\n    view.bind('isOn').to(command, 'value', command, 'isEnabled', (value, isEnabled) => value && isEnabled);\n    // Execute the command.\n    this.listenTo(view, 'execute', () => {\n      editor.execute('showBlocks');\n      editor.editing.view.focus();\n    });\n    return view;\n  }\n}\n\n/**\n * The show blocks feature.\n *\n * For a detailed overview, check the {@glink features/show-blocks Show blocks} feature guide.\n */\nclass ShowBlocks extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ShowBlocks';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ShowBlocksEditing, ShowBlocksUI];\n  }\n}\nexport { ShowBlocks, ShowBlocksCommand, ShowBlocksEditing, ShowBlocksUI };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, PendingActions } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { IconSource } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { ButtonView, MenuBarMenuListItemButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { ElementReplacer, CKEditorError, createElement } from '@ckeditor/ckeditor5-utils/dist/index.js';\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module source-editing/utils/formathtml\n    */ /**\n       * A simple (and naive) HTML code formatter that returns a formatted HTML markup that can be easily\n       * parsed by human eyes. It beautifies the HTML code by adding new lines between elements that behave like block elements\n       * (https://developer.mozilla.org/en-US/docs/Web/HTML/Block-level_elements\n       * and a few more like `tr`, `td`, and similar ones) and inserting indents for nested content.\n       *\n       * WARNING: This function works only on a text that does not contain any indentations or new lines.\n       * Calling this function on the already formatted text will damage the formatting.\n       *\n       * @param input An HTML string to format.\n       */\nfunction formatHtml(input) {\n  // A list of block-like elements around which the new lines should be inserted, and within which\n  // the indentation of their children should be increased.\n  // The list is partially based on https://developer.mozilla.org/en-US/docs/Web/HTML/Block-level_elements that contains\n  // a full list of HTML block-level elements.\n  // A void element is an element that cannot have any child - https://html.spec.whatwg.org/multipage/syntax.html#void-elements.\n  // Note that <pre> element is not listed on this list to avoid breaking whitespace formatting.\n  // Note that <br> element is not listed and handled separately so no additional white spaces are injected.\n  const elementsToFormat = [{\n    name: 'address',\n    isVoid: false\n  }, {\n    name: 'article',\n    isVoid: false\n  }, {\n    name: 'aside',\n    isVoid: false\n  }, {\n    name: 'blockquote',\n    isVoid: false\n  }, {\n    name: 'details',\n    isVoid: false\n  }, {\n    name: 'dialog',\n    isVoid: false\n  }, {\n    name: 'dd',\n    isVoid: false\n  }, {\n    name: 'div',\n    isVoid: false\n  }, {\n    name: 'dl',\n    isVoid: false\n  }, {\n    name: 'dt',\n    isVoid: false\n  }, {\n    name: 'fieldset',\n    isVoid: false\n  }, {\n    name: 'figcaption',\n    isVoid: false\n  }, {\n    name: 'figure',\n    isVoid: false\n  }, {\n    name: 'footer',\n    isVoid: false\n  }, {\n    name: 'form',\n    isVoid: false\n  }, {\n    name: 'h1',\n    isVoid: false\n  }, {\n    name: 'h2',\n    isVoid: false\n  }, {\n    name: 'h3',\n    isVoid: false\n  }, {\n    name: 'h4',\n    isVoid: false\n  }, {\n    name: 'h5',\n    isVoid: false\n  }, {\n    name: 'h6',\n    isVoid: false\n  }, {\n    name: 'header',\n    isVoid: false\n  }, {\n    name: 'hgroup',\n    isVoid: false\n  }, {\n    name: 'hr',\n    isVoid: true\n  }, {\n    name: 'li',\n    isVoid: false\n  }, {\n    name: 'main',\n    isVoid: false\n  }, {\n    name: 'nav',\n    isVoid: false\n  }, {\n    name: 'ol',\n    isVoid: false\n  }, {\n    name: 'p',\n    isVoid: false\n  }, {\n    name: 'section',\n    isVoid: false\n  }, {\n    name: 'table',\n    isVoid: false\n  }, {\n    name: 'tbody',\n    isVoid: false\n  }, {\n    name: 'td',\n    isVoid: false\n  }, {\n    name: 'th',\n    isVoid: false\n  }, {\n    name: 'thead',\n    isVoid: false\n  }, {\n    name: 'tr',\n    isVoid: false\n  }, {\n    name: 'ul',\n    isVoid: false\n  }];\n  const elementNamesToFormat = elementsToFormat.map(element => element.name).join('|');\n  // It is not the fastest way to format the HTML markup but the performance should be good enough.\n  const lines = input // Add new line before and after `<tag>` and `</tag>`.\n  // It may separate individual elements with two new lines, but this will be fixed below.\n  .replace(new RegExp(`</?(${elementNamesToFormat})( .*?)?>`, 'g'), '\\n$&\\n') // Keep `<br>`s at the end of line to avoid adding additional whitespaces before `<br>`.\n  .replace(/<br[^>]*>/g, '$&\\n') // Divide input string into lines, which start with either an opening tag, a closing tag, or just a text.\n  .split('\\n');\n  let indentCount = 0;\n  let isPreformattedLine = false;\n  return lines.filter(line => line.length).map(line => {\n    isPreformattedLine = isPreformattedBlockLine(line, isPreformattedLine);\n    if (isNonVoidOpeningTag(line, elementsToFormat)) {\n      return indentLine(line, indentCount++);\n    }\n    if (isClosingTag(line, elementsToFormat)) {\n      return indentLine(line, --indentCount);\n    }\n    if (isPreformattedLine === 'middle' || isPreformattedLine === 'last') {\n      return line;\n    }\n    return indentLine(line, indentCount);\n  }).join('\\n');\n}\n/**\n * Checks, if an argument is an opening tag of a non-void element to be formatted.\n *\n * @param line String to check.\n * @param elementsToFormat Elements to be formatted.\n */\nfunction isNonVoidOpeningTag(line, elementsToFormat) {\n  return elementsToFormat.some(element => {\n    if (element.isVoid) {\n      return false;\n    }\n    if (!new RegExp(`<${element.name}( .*?)?>`).test(line)) {\n      return false;\n    }\n    return true;\n  });\n}\n/**\n * Checks, if an argument is a closing tag.\n *\n * @param line String to check.\n * @param elementsToFormat Elements to be formatted.\n */\nfunction isClosingTag(line, elementsToFormat) {\n  return elementsToFormat.some(element => {\n    return new RegExp(`</${element.name}>`).test(line);\n  });\n}\n/**\n * Indents a line by a specified number of characters.\n *\n * @param line Line to indent.\n * @param indentCount Number of characters to use for indentation.\n * @param indentChar Indentation character(s). 4 spaces by default.\n */\nfunction indentLine(line, indentCount, indentChar = '    ') {\n  // More about Math.max() here in https://github.com/ckeditor/ckeditor5/issues/10698.\n  return `${indentChar.repeat(Math.max(0, indentCount))}${line}`;\n}\n/**\n * Checks whether a line belongs to a preformatted (`<pre>`) block.\n *\n * @param line Line to check.\n * @param isPreviousLinePreFormatted Information on whether the previous line was preformatted (and how).\n */\nfunction isPreformattedBlockLine(line, isPreviousLinePreFormatted) {\n  if (new RegExp('<pre( .*?)?>').test(line)) {\n    return 'first';\n  } else if (new RegExp('</pre>').test(line)) {\n    return 'last';\n  } else if (isPreviousLinePreFormatted === 'first' || isPreviousLinePreFormatted === 'middle') {\n    return 'middle';\n  } else {\n    return false;\n  }\n}\nconst COMMAND_FORCE_DISABLE_ID = 'SourceEditingMode';\n/**\n * The source editing feature.\n *\n * It provides the possibility to view and edit the source of the document.\n *\n * For a detailed overview, check the {@glink features/source-editing/source-editing source editing feature documentation} and the\n * {@glink api/source-editing package page}.\n */\nclass SourceEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SourceEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [PendingActions];\n  }\n  /**\n  * The element replacer instance used to replace the editing roots with the wrapper elements containing the document source.\n  */\n  _elementReplacer;\n  /**\n  * Maps all root names to wrapper elements containing the document source.\n  */\n  _replacedRoots;\n  /**\n  * Maps all root names to their document data.\n  */\n  _dataFromRoots;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this.set('isSourceEditingMode', false);\n    this._elementReplacer = new ElementReplacer();\n    this._replacedRoots = new Map();\n    this._dataFromRoots = new Map();\n    editor.config.define('sourceEditing.allowCollaborationFeatures', false);\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    this._checkCompatibility();\n    const editor = this.editor;\n    const t = editor.locale.t;\n    editor.ui.componentFactory.add('sourceEditing', () => {\n      const buttonView = this._createButton(ButtonView);\n      buttonView.set({\n        label: t('Source'),\n        icon: IconSource,\n        tooltip: true,\n        class: 'ck-source-editing-button'\n      });\n      return buttonView;\n    });\n    editor.ui.componentFactory.add('menuBar:sourceEditing', () => {\n      const buttonView = this._createButton(MenuBarMenuListItemButtonView);\n      buttonView.set({\n        label: t('Show source'),\n        role: 'menuitemcheckbox'\n      });\n      return buttonView;\n    });\n    // Currently, the plugin handles the source editing mode by itself only for the classic editor. To use this plugin with other\n    // integrations, listen to the `change:isSourceEditingMode` event and act accordingly.\n    if (this._isAllowedToHandleSourceEditingMode()) {\n      this.on('change:isSourceEditingMode', (evt, name, isSourceEditingMode) => {\n        if (isSourceEditingMode) {\n          this._hideVisibleDialog();\n          this._showSourceEditing();\n          this._disableCommands();\n        } else {\n          this._hideSourceEditing();\n          this._enableCommands();\n        }\n      });\n      this.on('change:isEnabled', (evt, name, isEnabled) => this._handleReadOnlyMode(!isEnabled));\n      this.listenTo(editor, 'change:isReadOnly', (evt, name, isReadOnly) => this._handleReadOnlyMode(isReadOnly));\n    }\n    // Update the editor data while calling editor.getData() in the source editing mode.\n    editor.data.on('get', () => {\n      if (this.isSourceEditingMode) {\n        this.updateEditorData();\n      }\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Updates the source data in all hidden editing roots.\n  */\n  updateEditorData() {\n    const editor = this.editor;\n    const data = {};\n    for (const [rootName, domSourceEditingElementWrapper] of this._replacedRoots) {\n      const oldData = this._dataFromRoots.get(rootName);\n      const newData = domSourceEditingElementWrapper.dataset.value;\n      // Do not set the data unless some changes have been made in the meantime.\n      // This prevents empty undo steps after switching to the normal editor.\n      if (oldData !== newData) {\n        data[rootName] = newData;\n        this._dataFromRoots.set(rootName, newData);\n      }\n    }\n    if (Object.keys(data).length) {\n      editor.data.set(data, {\n        batchType: {\n          isUndoable: true\n        },\n        suppressErrorInCollaboration: true\n      });\n    }\n  }\n  _checkCompatibility() {\n    const editor = this.editor;\n    const allowCollaboration = editor.config.get('sourceEditing.allowCollaborationFeatures');\n    if (!allowCollaboration && editor.plugins.has('RealTimeCollaborativeEditing')) {\n      /**\n      * Source editing feature is not fully compatible with real-time collaboration,\n      * and using it may lead to data loss. Please read\n      * {@glink features/source-editing/source-editing#limitations-and-incompatibilities source editing feature guide} to learn more.\n      *\n      * If you understand the possible risk of data loss, you can enable the source editing\n      * by setting the\n      * {@link module:source-editing/sourceeditingconfig~SourceEditingConfig#allowCollaborationFeatures}\n      * configuration flag to `true`.\n      *\n      * @error source-editing-incompatible-with-real-time-collaboration\n      */\n      throw new CKEditorError('source-editing-incompatible-with-real-time-collaboration', null);\n    }\n    const collaborationPluginNamesToWarn = ['CommentsEditing', 'TrackChangesEditing', 'RevisionHistory'];\n    // Currently, the basic integration with Collaboration Features is to display a warning in the console.\n    //\n    // If `allowCollaboration` flag is set, do not show these warnings. If the flag is set, we assume that the integrator read\n    // appropriate section of the guide so there's no use to spam the console with warnings.\n    //\n    if (!allowCollaboration && collaborationPluginNamesToWarn.some(pluginName => editor.plugins.has(pluginName))) {\n      console.warn('You initialized the editor with the source editing feature and at least one of the collaboration features. ' + 'Please be advised that the source editing feature may not work, and be careful when editing document source ' + 'that contains markers created by the collaboration features.');\n    }\n    // Restricted Editing integration can also lead to problems. Warn the user accordingly.\n    if (editor.plugins.has('RestrictedEditingModeEditing')) {\n      console.warn('You initialized the editor with the source editing feature and restricted editing feature. ' + 'Please be advised that the source editing feature may not work, and be careful when editing document source ' + 'that contains markers created by the restricted editing feature.');\n    }\n  }\n  /**\n  * Creates source editing wrappers that replace each editing root. Each wrapper contains the document source from the corresponding\n  * root.\n  *\n  * The wrapper element contains a textarea and it solves the problem, that the textarea element cannot auto expand its height based on\n  * the content it contains. The solution is to make the textarea more like a plain div element, which expands in height as much as it\n  * needs to, in order to display the whole document source without scrolling. The wrapper element is a parent for the textarea and for\n  * the pseudo-element `::after`, that replicates the look, content, and position of the textarea. The pseudo-element replica is hidden,\n  * but it is styled to be an identical visual copy of the textarea with the same content. Then, the wrapper is a grid container and both\n  * of its children (the textarea and the `::after` pseudo-element) are positioned within a CSS grid to occupy the same grid cell. The\n  * content in the pseudo-element `::after` is set in CSS and it stretches the grid to the appropriate size based on the textarea value.\n  * Since both children occupy the same grid cell, both have always the same height.\n  */\n  _showSourceEditing() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const model = editor.model;\n    model.change(writer => {\n      writer.setSelection(null);\n      writer.removeSelectionAttribute(model.document.selection.getAttributeKeys());\n    });\n    // It is not needed to iterate through all editing roots, as currently the plugin supports only the Classic Editor with a single\n    // main root, but this code may help understand and use this feature in external integrations.\n    for (const [rootName, domRootElement] of editingView.domRoots) {\n      const data = formatSource(editor.data.get({\n        rootName\n      }));\n      const domSourceEditingElementTextarea = createElement(domRootElement.ownerDocument, 'textarea', {\n        rows: '1',\n        'aria-label': 'Source code editing area'\n      });\n      const domSourceEditingElementWrapper = createElement(domRootElement.ownerDocument, 'div', {\n        class: 'ck-source-editing-area',\n        'data-value': data\n      }, [domSourceEditingElementTextarea]);\n      domSourceEditingElementTextarea.value = data;\n      // Setting a value to textarea moves the input cursor to the end. We want the selection at the beginning.\n      domSourceEditingElementTextarea.setSelectionRange(0, 0);\n      // Bind the textarea's value to the wrapper's `data-value` property. Each change of the textarea's value updates the\n      // wrapper's `data-value` property.\n      domSourceEditingElementTextarea.addEventListener('input', () => {\n        domSourceEditingElementWrapper.dataset.value = domSourceEditingElementTextarea.value;\n        editor.ui.update();\n      });\n      editingView.change(writer => {\n        const viewRoot = editingView.document.getRoot(rootName);\n        writer.addClass('ck-hidden', viewRoot);\n      });\n      // Register the element so it becomes available for Alt+F10 and Esc navigation.\n      editor.ui.setEditableElement('sourceEditing:' + rootName, domSourceEditingElementTextarea);\n      this._replacedRoots.set(rootName, domSourceEditingElementWrapper);\n      this._elementReplacer.replace(domRootElement, domSourceEditingElementWrapper);\n      this._dataFromRoots.set(rootName, data);\n    }\n    this._hideDocumentOutline();\n    this._refreshAnnotationsVisibility();\n    this._focusSourceEditing();\n  }\n  /**\n  * Restores all hidden editing roots and sets the source data in them.\n  */\n  _hideSourceEditing() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    this.updateEditorData();\n    editingView.change(writer => {\n      for (const [rootName] of this._replacedRoots) {\n        writer.removeClass('ck-hidden', editingView.document.getRoot(rootName));\n      }\n    });\n    this._elementReplacer.restore();\n    this._replacedRoots.clear();\n    this._dataFromRoots.clear();\n    this._showDocumentOutline();\n    this._refreshAnnotationsVisibility();\n    editingView.focus();\n  }\n  /**\n  * Hides the document outline if it is configured.\n  */\n  _hideDocumentOutline() {\n    if (this.editor.plugins.has('DocumentOutlineUI')) {\n      this.editor.plugins.get('DocumentOutlineUI').view.element.style.display = 'none';\n    }\n  }\n  /**\n  * Shows the document outline if it was hidden when entering the source editing.\n  */\n  _showDocumentOutline() {\n    if (this.editor.plugins.has('DocumentOutlineUI')) {\n      this.editor.plugins.get('DocumentOutlineUI').view.element.style.display = '';\n    }\n  }\n  /**\n  * Hides the annotations when entering the source editing mode and shows back them after leaving it.\n  */\n  _refreshAnnotationsVisibility() {\n    if (this.editor.plugins.has('Annotations')) {\n      this.editor.plugins.get('Annotations').refreshVisibility();\n    }\n  }\n  /**\n  * Focuses the textarea containing document source from the first editing root.\n  */\n  _focusSourceEditing() {\n    const editor = this.editor;\n    const [domSourceEditingElementWrapper] = this._replacedRoots.values();\n    const textarea = domSourceEditingElementWrapper.querySelector('textarea');\n    // The FocusObserver was disabled by View.render() while the DOM root was getting hidden and the replacer\n    // revealed the textarea. So it couldn't notice that the DOM root got blurred in the process.\n    // Let's sync this state manually here because otherwise Renderer will attempt to render selection\n    // in an invisible DOM root.\n    editor.editing.view.document.isFocused = false;\n    textarea.focus();\n  }\n  /**\n  * Disables all commands.\n  */\n  _disableCommands() {\n    const editor = this.editor;\n    for (const command of editor.commands.commands()) {\n      command.forceDisabled(COMMAND_FORCE_DISABLE_ID);\n    }\n    // Comments archive UI plugin will be disabled manually too.\n    if (editor.plugins.has('CommentsArchiveUI')) {\n      editor.plugins.get('CommentsArchiveUI').forceDisabled(COMMAND_FORCE_DISABLE_ID);\n    }\n  }\n  /**\n  * Clears forced disable for all commands, that was previously set through {@link #_disableCommands}.\n  */\n  _enableCommands() {\n    const editor = this.editor;\n    for (const command of editor.commands.commands()) {\n      command.clearForceDisabled(COMMAND_FORCE_DISABLE_ID);\n    }\n    // Comments archive UI plugin will be enabled manually too.\n    if (editor.plugins.has('CommentsArchiveUI')) {\n      editor.plugins.get('CommentsArchiveUI').clearForceDisabled(COMMAND_FORCE_DISABLE_ID);\n    }\n  }\n  /**\n  * Adds or removes the `readonly` attribute from the textarea from all roots, if document source mode is active.\n  *\n  * @param isReadOnly Indicates whether all textarea elements should be read-only.\n  */\n  _handleReadOnlyMode(isReadOnly) {\n    if (!this.isSourceEditingMode) {\n      return;\n    }\n    for (const [, domSourceEditingElementWrapper] of this._replacedRoots) {\n      domSourceEditingElementWrapper.querySelector('textarea').readOnly = isReadOnly;\n    }\n  }\n  /**\n  * Checks, if the plugin is allowed to handle the source editing mode by itself. Currently, the source editing mode is supported only\n  * for the {@link module:editor-classic/classiceditor~ClassicEditor classic editor}.\n  */\n  _isAllowedToHandleSourceEditingMode() {\n    const editor = this.editor;\n    const editable = editor.ui.view.editable;\n    // Checks, if the editor's editable belongs to the editor's DOM tree.\n    return editable && !editable.hasExternalElement;\n  }\n  /**\n  * If any {@link module:ui/dialog/dialogview~DialogView editor dialog} is currently visible, hide it.\n  */\n  _hideVisibleDialog() {\n    if (this.editor.plugins.has('Dialog')) {\n      const dialogPlugin = this.editor.plugins.get('Dialog');\n      if (dialogPlugin.isOpen) {\n        dialogPlugin.hide();\n      }\n    }\n  }\n  _createButton(ButtonClass) {\n    const editor = this.editor;\n    const buttonView = new ButtonClass(editor.locale);\n    buttonView.set({\n      withText: true,\n      isToggleable: true\n    });\n    buttonView.bind('isOn').to(this, 'isSourceEditingMode');\n    // The button should be disabled if one of the following conditions is met:\n    buttonView.bind('isEnabled').to(this, 'isEnabled', editor, 'isReadOnly', editor.plugins.get(PendingActions), 'hasAny', (isEnabled, isEditorReadOnly, hasAnyPendingActions) => {\n      // (1) The plugin itself is disabled.\n      if (!isEnabled) {\n        return false;\n      }\n      // (2) The editor is in read-only mode.\n      if (isEditorReadOnly) {\n        return false;\n      }\n      // (3) Any pending action is scheduled. It may change the model, so modifying the document source should be prevented\n      // until the model is finally set.\n      if (hasAnyPendingActions) {\n        return false;\n      }\n      return true;\n    });\n    this.listenTo(buttonView, 'execute', () => {\n      this.isSourceEditingMode = !this.isSourceEditingMode;\n    });\n    return buttonView;\n  }\n}\n/**\n * Formats the content for a better readability.\n *\n * For a non-HTML source the unchanged input string is returned.\n *\n * @param input Input string to check.\n */\nfunction formatSource(input) {\n  if (!isHtml(input)) {\n    return input;\n  }\n  return formatHtml(input);\n}\n/**\n * Checks, if the document source is HTML. It is sufficient to just check the first character from the document data.\n *\n * @param input Input string to check.\n */\nfunction isHtml(input) {\n  return input.startsWith('<');\n}\nexport { SourceEditing };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Typing } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { IconSpecialCharacters } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { View, addKeyboardHandlingForGrid, ButtonView, FocusCycler, LabeledFieldView, createLabeledDropdown, ViewModel, addListToDropdown, Dialog, MenuBarMenuListItemButtonView, DialogViewPosition } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { FocusTracker, KeystrokeHandler, global, Collection, CKEditorError } from '@ckeditor/ckeditor5-utils/dist/index.js';\n\n/**\n * A grid of character tiles. It allows browsing special characters and selecting the character to\n * be inserted into the content.\n */\nclass CharacterGridView extends View {\n  /**\n  * A collection of the child tile views. Each tile represents a particular character.\n  */\n  tiles;\n  /**\n  * Tracks information about the DOM focus in the grid.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * Creates an instance of a character grid containing tiles representing special characters.\n  *\n  * @param locale The localization services instance.\n  */\n  constructor(locale) {\n    super(locale);\n    this.tiles = this.createCollection();\n    this.setTemplate({\n      tag: 'div',\n      children: [{\n        tag: 'div',\n        attributes: {\n          class: ['ck', 'ck-character-grid__tiles']\n        },\n        children: this.tiles\n      }],\n      attributes: {\n        class: ['ck', 'ck-character-grid']\n      }\n    });\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    addKeyboardHandlingForGrid({\n      keystrokeHandler: this.keystrokes,\n      focusTracker: this.focusTracker,\n      gridItems: this.tiles,\n      numberOfColumns: () => global.window.getComputedStyle(this.element.firstChild) // Responsive .ck-character-grid__tiles\n      .getPropertyValue('grid-template-columns').split(' ').length,\n      uiLanguageDirection: this.locale && this.locale.uiLanguageDirection\n    });\n  }\n  /**\n  * Creates a new tile for the grid.\n  *\n  * @param character A human-readable character displayed as the label (e.g. \"Îµ\").\n  * @param name The name of the character (e.g. \"greek small letter epsilon\").\n  */\n  createTile(character, name) {\n    const tile = new ButtonView(this.locale);\n    tile.set({\n      label: character,\n      withText: true,\n      class: 'ck-character-grid__tile'\n    });\n    // Labels are vital for the users to understand what character they're looking at.\n    // For now we're using native title attribute for that, see #5817.\n    tile.extendTemplate({\n      attributes: {\n        title: name\n      },\n      on: {\n        mouseover: tile.bindTemplate.to('mouseover'),\n        focus: tile.bindTemplate.to('focus')\n      }\n    });\n    tile.on('mouseover', () => {\n      this.fire('tileHover', {\n        name,\n        character\n      });\n    });\n    tile.on('focus', () => {\n      this.fire('tileFocus', {\n        name,\n        character\n      });\n    });\n    tile.on('execute', () => {\n      this.fire('execute', {\n        name,\n        character\n      });\n    });\n    return tile;\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    for (const item of this.tiles) {\n      this.focusTracker.add(item.element);\n    }\n    this.tiles.on('change', (eventInfo, {\n      added,\n      removed\n    }) => {\n      if (added.length > 0) {\n        for (const item of added) {\n          this.focusTracker.add(item.element);\n        }\n      }\n      if (removed.length > 0) {\n        for (const item of removed) {\n          this.focusTracker.remove(item.element);\n        }\n      }\n    });\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the first focusable in {@link ~CharacterGridView#tiles}.\n  */\n  focus() {\n    this.tiles.first.focus();\n  }\n}\n\n/**\n * The view displaying detailed information about a special character glyph, e.g. upon\n * hovering it with a mouse.\n */\nclass CharacterInfoView extends View {\n  constructor(locale) {\n    super(locale);\n    const bind = this.bindTemplate;\n    this.set('character', null);\n    this.set('name', null);\n    this.bind('code').to(this, 'character', characterToUnicodeString);\n    this.setTemplate({\n      tag: 'div',\n      children: [{\n        tag: 'span',\n        attributes: {\n          class: ['ck-character-info__name']\n        },\n        children: [{\n          // Note: ZWSP to prevent vertical collapsing.\n          text: bind.to('name', name => name ? name : '\\u200B')\n        }]\n      }, {\n        tag: 'span',\n        attributes: {\n          class: ['ck-character-info__code']\n        },\n        children: [{\n          text: bind.to('code')\n        }]\n      }],\n      attributes: {\n        class: ['ck', 'ck-character-info']\n      }\n    });\n  }\n}\n/**\n * Converts a character into a \"Unicode string\", for instance:\n *\n * \"$\" -> \"U+0024\"\n *\n * Returns an empty string when the character is `null`.\n */\nfunction characterToUnicodeString(character) {\n  if (character === null) {\n    return '';\n  }\n  const hexCode = character.codePointAt(0).toString(16);\n  return 'U+' + ('0000' + hexCode).slice(-4);\n}\n\n/**\n * A view that glues pieces of the special characters dropdown panel together:\n *\n * * the navigation view (allows selecting the category),\n * * the grid view (displays characters as a grid),\n * * and the info view (displays detailed info about a specific character).\n */\nclass SpecialCharactersView extends View {\n  /**\n  * A collection of the focusable children of the view.\n  */\n  items;\n  /**\n  * Tracks information about the DOM focus in the view.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * Helps cycling over focusable {@link #items} in the view.\n  */\n  _focusCycler;\n  /**\n  * An instance of the `SpecialCharactersCategoriesView`.\n  */\n  categoriesView;\n  /**\n  * An instance of the `CharacterGridView`.\n  */\n  gridView;\n  /**\n  * An instance of the `CharacterInfoView`.\n  */\n  infoView;\n  /**\n  * Creates an instance of the `SpecialCharactersView`.\n  */\n  constructor(locale, categoriesView, gridView, infoView) {\n    super(locale);\n    this.categoriesView = categoriesView;\n    this.gridView = gridView;\n    this.infoView = infoView;\n    this.items = this.createCollection();\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this._focusCycler = new FocusCycler({\n      focusables: this.items,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        focusPrevious: 'shift + tab',\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'div',\n      children: [this.categoriesView, this.gridView, this.infoView],\n      attributes: {\n        // Avoid focus loss when the user clicks the area of the grid that is not a button.\n        // https://github.com/ckeditor/ckeditor5/pull/12319#issuecomment-1231779819\n        tabindex: '-1'\n      }\n    });\n    this.items.add(this.categoriesView);\n    this.items.add(this.gridView);\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this.focusTracker.add(this.categoriesView.element);\n    this.focusTracker.add(this.gridView.element);\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the first focusable in {@link #items}.\n  */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n}\n\n/**\n * A class representing the navigation part of the special characters UI. It is responsible\n * for describing the feature and allowing the user to select a particular character group.\n */\nclass SpecialCharactersCategoriesView extends View {\n  _groupNames;\n  _dropdownView;\n  /**\n  * Creates an instance of the {@link module:special-characters/ui/specialcharacterscategoriesview~SpecialCharactersCategoriesView}\n  * class.\n  *\n  * @param locale The localization services instance.\n  * @param groupNames The names of the character groups.\n  */\n  constructor(locale, groupNames) {\n    super(locale);\n    this.set('currentGroupName', Array.from(groupNames.entries())[0][0]);\n    this._groupNames = groupNames;\n    this._dropdownView = new LabeledFieldView(locale, createLabeledDropdown);\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-character-categories']\n      },\n      children: [this._dropdownView]\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    this._setupDropdown();\n  }\n  /**\n  * @inheritDoc\n  */\n  focus() {\n    this._dropdownView.focus();\n  }\n  /**\n  * Creates dropdown item list, sets up bindings and fills properties.\n  */\n  _setupDropdown() {\n    const items = new Collection();\n    for (const [name, label] of this._groupNames) {\n      const item = {\n        type: 'button',\n        model: new ViewModel({\n          name,\n          label,\n          role: 'menuitemradio',\n          withText: true\n        })\n      };\n      item.model.bind('isOn').to(this, 'currentGroupName', value => {\n        return value === name;\n      });\n      items.add(item);\n    }\n    const t = this.locale.t;\n    const accessibleLabel = t('Category');\n    this._dropdownView.set({\n      label: accessibleLabel,\n      isEmpty: false\n    });\n    this._dropdownView.fieldView.panelPosition = this.locale.uiLanguageDirection === 'rtl' ? 'se' : 'sw';\n    this._dropdownView.fieldView.buttonView.set({\n      withText: true,\n      tooltip: accessibleLabel,\n      ariaLabel: accessibleLabel,\n      ariaLabelledBy: undefined,\n      isOn: false\n    });\n    this._dropdownView.fieldView.buttonView.bind('label').to(this, 'currentGroupName', value => this._groupNames.get(value));\n    this._dropdownView.fieldView.on('execute', ({\n      source\n    }) => {\n      this.currentGroupName = source.name;\n    });\n    addListToDropdown(this._dropdownView.fieldView, items, {\n      ariaLabel: accessibleLabel,\n      role: 'menu'\n    });\n  }\n}\nconst ALL_SPECIAL_CHARACTERS_GROUP = 'All';\n/**\n * The special characters feature.\n *\n * Introduces the `'specialCharacters'` dropdown.\n */\nclass SpecialCharacters extends Plugin {\n  /**\n  * Registered characters. A pair of a character name and its symbol.\n  */\n  _characters;\n  /**\n  * Registered groups. Each group contains a displayed label and a collection with symbol names.\n  */\n  _groups;\n  /**\n  * A label describing the \"All\" special characters category.\n  */\n  _allSpecialCharactersGroupLabel;\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Typing, Dialog];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SpecialCharacters';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    const t = editor.t;\n    this._characters = new Map();\n    this._groups = new Map();\n    this._allSpecialCharactersGroupLabel = t('All');\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.ui.componentFactory.add('specialCharacters', () => {\n      const button = this._createDialogButton(ButtonView);\n      button.set({\n        tooltip: true\n      });\n      return button;\n    });\n    editor.ui.componentFactory.add('menuBar:specialCharacters', () => {\n      return this._createDialogButton(MenuBarMenuListItemButtonView);\n    });\n  }\n  /**\n  * Adds a collection of special characters to the specified group. The title of a special character must be unique.\n  *\n  * **Note:** The \"All\" category name is reserved by the plugin and cannot be used as a new name for a special\n  * characters category.\n  */\n  addItems(groupName, items, options = {\n    label: groupName\n  }) {\n    if (groupName === ALL_SPECIAL_CHARACTERS_GROUP) {\n      /**\n      * The name \"All\" for a special category group cannot be used because it is a special category that displays all\n      * available special characters.\n      *\n      * @error special-character-invalid-group-name\n      */\n      throw new CKEditorError('special-character-invalid-group-name', null);\n    }\n    const group = this._getGroup(groupName, options.label);\n    for (const item of items) {\n      group.items.add(item.title);\n      this._characters.set(item.title, item.character);\n    }\n  }\n  /**\n  * Returns special character groups in an order determined based on configuration and registration sequence.\n  */\n  getGroups() {\n    const groups = Array.from(this._groups.keys());\n    const order = this.editor.config.get('specialCharacters.order') || [];\n    const invalidGroup = order.find(item => !groups.includes(item));\n    if (invalidGroup) {\n      /**\n      * One of the special character groups in the \"specialCharacters.order\" configuration doesn't exist.\n      *\n      * @error special-character-invalid-order-group-name\n      */\n      throw new CKEditorError('special-character-invalid-order-group-name', null, {\n        invalidGroup\n      });\n    }\n    return new Set([...order, ...groups]);\n  }\n  /**\n  * Returns a collection of special characters symbol names (titles).\n  */\n  getCharactersForGroup(groupName) {\n    if (groupName === ALL_SPECIAL_CHARACTERS_GROUP) {\n      return new Set(this._characters.keys());\n    }\n    const group = this._groups.get(groupName);\n    if (group) {\n      return group.items;\n    }\n  }\n  /**\n  * Returns the symbol of a special character for the specified name. If the special character could not be found, `undefined`\n  * is returned.\n  *\n  * @param title The title of a special character.\n  */\n  getCharacter(title) {\n    return this._characters.get(title);\n  }\n  /**\n  * Returns a group of special characters. If the group with the specified name does not exist, it will be created.\n  *\n  * @param groupName The name of the group to create.\n  * @param label The label describing the new group.\n  */\n  _getGroup(groupName, label) {\n    if (!this._groups.has(groupName)) {\n      this._groups.set(groupName, {\n        items: new Set(),\n        label\n      });\n    }\n    return this._groups.get(groupName);\n  }\n  /**\n  * Updates the symbol grid depending on the currently selected character group.\n  */\n  _updateGrid(currentGroupName, gridView) {\n    // Updating the grid starts with removing all tiles belonging to the old group.\n    gridView.tiles.clear();\n    const characterTitles = this.getCharactersForGroup(currentGroupName);\n    for (const title of characterTitles) {\n      const character = this.getCharacter(title);\n      gridView.tiles.add(gridView.createTile(character, title));\n    }\n  }\n  /**\n  * Initializes the dropdown, used for lazy loading.\n  *\n  * @returns An object with `categoriesView`, `gridView` and `infoView` properties, containing UI parts.\n  */\n  _createDropdownPanelContent(locale) {\n    const groupEntries = Array.from(this.getGroups()).map(name => [name, this._groups.get(name).label]);\n    // The map contains a name of category (an identifier) and its label (a translational string).\n    const specialCharsGroups = new Map([\n    // Add a special group that shows all available special characters.\n    [ALL_SPECIAL_CHARACTERS_GROUP, this._allSpecialCharactersGroupLabel], ...groupEntries]);\n    const categoriesView = new SpecialCharactersCategoriesView(locale, specialCharsGroups);\n    const gridView = new CharacterGridView(locale);\n    const infoView = new CharacterInfoView(locale);\n    gridView.on('tileHover', (evt, data) => {\n      infoView.set(data);\n    });\n    gridView.on('tileFocus', (evt, data) => {\n      infoView.set(data);\n    });\n    // Update the grid of special characters when a user changed the character group.\n    categoriesView.on('change:currentGroupName', (evt, propertyName, newValue) => {\n      this._updateGrid(newValue, gridView);\n    });\n    // Set the initial content of the special characters grid.\n    this._updateGrid(categoriesView.currentGroupName, gridView);\n    return {\n      categoriesView,\n      gridView,\n      infoView\n    };\n  }\n  /**\n  * Creates a button for toolbar and menu bar that will show special characters dialog.\n  */\n  _createDialogButton(ButtonClass) {\n    const editor = this.editor;\n    const locale = editor.locale;\n    const buttonView = new ButtonClass(editor.locale);\n    const command = editor.commands.get('insertText');\n    const t = locale.t;\n    const dialogPlugin = this.editor.plugins.get('Dialog');\n    buttonView.set({\n      label: t('Special characters'),\n      icon: IconSpecialCharacters,\n      isToggleable: true\n    });\n    buttonView.bind('isOn').to(dialogPlugin, 'id', id => id === 'specialCharacters');\n    buttonView.bind('isEnabled').to(command, 'isEnabled');\n    buttonView.on('execute', () => {\n      if (dialogPlugin.id === 'specialCharacters') {\n        dialogPlugin.hide();\n        return;\n      }\n      this._showDialog();\n    });\n    return buttonView;\n  }\n  _showDialog() {\n    const editor = this.editor;\n    const dialog = editor.plugins.get('Dialog');\n    const locale = editor.locale;\n    const t = locale.t;\n    const {\n      categoriesView,\n      gridView,\n      infoView\n    } = this._createDropdownPanelContent(locale);\n    const content = new SpecialCharactersView(locale, categoriesView, gridView, infoView);\n    gridView.on('execute', (evt, data) => {\n      editor.execute('insertText', {\n        text: data.character\n      });\n    });\n    dialog.show({\n      id: 'specialCharacters',\n      title: t('Special characters'),\n      className: 'ck-special-characters',\n      content,\n      position: DialogViewPosition.EDITOR_TOP_SIDE\n    });\n  }\n}\n\n/**\n * A plugin that provides special characters for the \"Arrows\" category.\n *\n * ```ts\n * ClassicEditor\n *   .create( {\n *     plugins: [ ..., SpecialCharacters, SpecialCharactersArrows ],\n *   } )\n *   .then( ... )\n *   .catch( ... );\n * ```\n */\nclass SpecialCharactersArrows extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SpecialCharactersArrows';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const plugin = editor.plugins.get('SpecialCharacters');\n    plugin.addItems('Arrows', [{\n      title: t('leftwards simple arrow'),\n      character: 'â†'\n    }, {\n      title: t('rightwards simple arrow'),\n      character: 'â†’'\n    }, {\n      title: t('upwards simple arrow'),\n      character: 'â†‘'\n    }, {\n      title: t('downwards simple arrow'),\n      character: 'â†“'\n    }, {\n      title: t('leftwards double arrow'),\n      character: 'â‡'\n    }, {\n      title: t('rightwards double arrow'),\n      character: 'â‡’'\n    }, {\n      title: t('upwards double arrow'),\n      character: 'â‡‘'\n    }, {\n      title: t('downwards double arrow'),\n      character: 'â‡“'\n    }, {\n      title: t('leftwards dashed arrow'),\n      character: 'â‡ '\n    }, {\n      title: t('rightwards dashed arrow'),\n      character: 'â‡¢'\n    }, {\n      title: t('upwards dashed arrow'),\n      character: 'â‡¡'\n    }, {\n      title: t('downwards dashed arrow'),\n      character: 'â‡£'\n    }, {\n      title: t('leftwards arrow to bar'),\n      character: 'â‡¤'\n    }, {\n      title: t('rightwards arrow to bar'),\n      character: 'â‡¥'\n    }, {\n      title: t('upwards arrow to bar'),\n      character: 'â¤’'\n    }, {\n      title: t('downwards arrow to bar'),\n      character: 'â¤“'\n    }, {\n      title: t('up down arrow with base'),\n      character: 'â†¨'\n    }, {\n      title: t('back with leftwards arrow above'),\n      character: 'ðŸ”™'\n    }, {\n      title: t('end with leftwards arrow above'),\n      character: 'ðŸ”š'\n    }, {\n      title: t('on with exclamation mark with left right arrow above'),\n      character: 'ðŸ”›'\n    }, {\n      title: t('soon with rightwards arrow above'),\n      character: 'ðŸ”œ'\n    }, {\n      title: t('top with upwards arrow above'),\n      character: 'ðŸ”'\n    }], {\n      label: t('Arrows')\n    });\n  }\n}\n\n/**\n * A plugin that provides special characters for the \"Text\" category.\n *\n * ```ts\n * ClassicEditor\n *   .create( {\n *     plugins: [ ..., SpecialCharacters, SpecialCharactersText ],\n *   } )\n *   .then( ... )\n *   .catch( ... );\n * ```\n */\nclass SpecialCharactersText extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SpecialCharactersText';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const plugin = editor.plugins.get('SpecialCharacters');\n    plugin.addItems('Text', [{\n      character: 'â€¹',\n      title: t('Single left-pointing angle quotation mark')\n    }, {\n      character: 'â€º',\n      title: t('Single right-pointing angle quotation mark')\n    }, {\n      character: 'Â«',\n      title: t('Left-pointing double angle quotation mark')\n    }, {\n      character: 'Â»',\n      title: t('Right-pointing double angle quotation mark')\n    }, {\n      character: 'â€˜',\n      title: t('Left single quotation mark')\n    }, {\n      character: 'â€™',\n      title: t('Right single quotation mark')\n    }, {\n      character: 'â€œ',\n      title: t('Left double quotation mark')\n    }, {\n      character: 'â€',\n      title: t('Right double quotation mark')\n    }, {\n      character: 'â€š',\n      title: t('Single low-9 quotation mark')\n    }, {\n      character: 'â€ž',\n      title: t('Double low-9 quotation mark')\n    }, {\n      character: 'Â¡',\n      title: t('Inverted exclamation mark')\n    }, {\n      character: 'Â¿',\n      title: t('Inverted question mark')\n    }, {\n      character: 'â€¥',\n      title: t('Two dot leader')\n    }, {\n      character: 'â€¦',\n      title: t('Horizontal ellipsis')\n    }, {\n      character: 'â€¡',\n      title: t('Double dagger')\n    }, {\n      character: 'â€°',\n      title: t('Per mille sign')\n    }, {\n      character: 'â€±',\n      title: t('Per ten thousand sign')\n    }, {\n      character: 'â€¼',\n      title: t('Double exclamation mark')\n    }, {\n      character: 'âˆ',\n      title: t('Question exclamation mark')\n    }, {\n      character: 'â‰',\n      title: t('Exclamation question mark')\n    }, {\n      character: 'â‡',\n      title: t('Double question mark')\n    }, {\n      character: 'Â©',\n      title: t('Copyright sign')\n    }, {\n      character: 'Â®',\n      title: t('Registered sign')\n    }, {\n      character: 'â„¢',\n      title: t('Trade mark sign')\n    }, {\n      character: 'Â§',\n      title: t('Section sign')\n    }, {\n      character: 'Â¶',\n      title: t('Paragraph sign')\n    }, {\n      character: 'â‹',\n      title: t('Reversed paragraph sign')\n    }], {\n      label: t('Text')\n    });\n  }\n}\n\n/**\n * A plugin that provides special characters for the \"Mathematical\" category.\n *\n * ```ts\n * ClassicEditor\n *   .create( {\n *     plugins: [ ..., SpecialCharacters, SpecialCharactersMathematical ],\n *   } )\n *   .then( ... )\n *   .catch( ... );\n * ```\n */\nclass SpecialCharactersMathematical extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SpecialCharactersMathematical';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const plugin = editor.plugins.get('SpecialCharacters');\n    plugin.addItems('Mathematical', [{\n      character: '<',\n      title: t('Less-than sign')\n    }, {\n      character: '>',\n      title: t('Greater-than sign')\n    }, {\n      character: 'â‰¤',\n      title: t('Less-than or equal to')\n    }, {\n      character: 'â‰¥',\n      title: t('Greater-than or equal to')\n    }, {\n      character: 'â€“',\n      title: t('En dash')\n    }, {\n      character: 'â€”',\n      title: t('Em dash')\n    }, {\n      character: 'Â¯',\n      title: t('Macron')\n    }, {\n      character: 'â€¾',\n      title: t('Overline')\n    }, {\n      character: 'Â°',\n      title: t('Degree sign')\n    }, {\n      character: 'âˆ’',\n      title: t('Minus sign')\n    }, {\n      character: 'Â±',\n      title: t('Plus-minus sign')\n    }, {\n      character: 'Ã·',\n      title: t('Division sign')\n    }, {\n      character: 'â„',\n      title: t('Fraction slash')\n    }, {\n      character: 'Ã—',\n      title: t('Multiplication sign')\n    }, {\n      character: 'Æ’',\n      title: t('Latin small letter f with hook')\n    }, {\n      character: 'âˆ«',\n      title: t('Integral')\n    }, {\n      character: 'âˆ‘',\n      title: t('N-ary summation')\n    }, {\n      character: 'âˆž',\n      title: t('Infinity')\n    }, {\n      character: 'âˆš',\n      title: t('Square root')\n    }, {\n      character: 'âˆ¼',\n      title: t('Tilde operator')\n    }, {\n      character: 'â‰…',\n      title: t('Approximately equal to')\n    }, {\n      character: 'â‰ˆ',\n      title: t('Almost equal to')\n    }, {\n      character: 'â‰ ',\n      title: t('Not equal to')\n    }, {\n      character: 'â‰¡',\n      title: t('Identical to')\n    }, {\n      character: 'âˆˆ',\n      title: t('Element of')\n    }, {\n      character: 'âˆ‰',\n      title: t('Not an element of')\n    }, {\n      character: 'âˆ‹',\n      title: t('Contains as member')\n    }, {\n      character: 'âˆ',\n      title: t('N-ary product')\n    }, {\n      character: 'âˆ§',\n      title: t('Logical and')\n    }, {\n      character: 'âˆ¨',\n      title: t('Logical or')\n    }, {\n      character: 'Â¬',\n      title: t('Not sign')\n    }, {\n      character: 'âˆ©',\n      title: t('Intersection')\n    }, {\n      character: 'âˆª',\n      title: t('Union')\n    }, {\n      character: 'âˆ‚',\n      title: t('Partial differential')\n    }, {\n      character: 'âˆ€',\n      title: t('For all')\n    }, {\n      character: 'âˆƒ',\n      title: t('There exists')\n    }, {\n      character: 'âˆ…',\n      title: t('Empty set')\n    }, {\n      character: 'âˆ‡',\n      title: t('Nabla')\n    }, {\n      character: 'âˆ—',\n      title: t('Asterisk operator')\n    }, {\n      character: 'âˆ',\n      title: t('Proportional to')\n    }, {\n      character: 'âˆ ',\n      title: t('Angle')\n    }, {\n      character: 'Â¼',\n      title: t('Vulgar fraction one quarter')\n    }, {\n      character: 'Â½',\n      title: t('Vulgar fraction one half')\n    }, {\n      character: 'Â¾',\n      title: t('Vulgar fraction three quarters')\n    }], {\n      label: t('Mathematical')\n    });\n  }\n}\n\n/**\n * A plugin that provides special characters for the \"Latin\" category.\n *\n * ```ts\n * ClassicEditor\n *   .create( {\n *     plugins: [ ..., SpecialCharacters, SpecialCharactersLatin ],\n *   } )\n *   .then( ... )\n *   .catch( ... );\n * ```\n */\nclass SpecialCharactersLatin extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SpecialCharactersLatin';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const plugin = editor.plugins.get('SpecialCharacters');\n    plugin.addItems('Latin', [{\n      character: 'Ä€',\n      title: t('Latin capital letter a with macron')\n    }, {\n      character: 'Ä',\n      title: t('Latin small letter a with macron')\n    }, {\n      character: 'Ä‚',\n      title: t('Latin capital letter a with breve')\n    }, {\n      character: 'Äƒ',\n      title: t('Latin small letter a with breve')\n    }, {\n      character: 'Ä„',\n      title: t('Latin capital letter a with ogonek')\n    }, {\n      character: 'Ä…',\n      title: t('Latin small letter a with ogonek')\n    }, {\n      character: 'Ä†',\n      title: t('Latin capital letter c with acute')\n    }, {\n      character: 'Ä‡',\n      title: t('Latin small letter c with acute')\n    }, {\n      character: 'Äˆ',\n      title: t('Latin capital letter c with circumflex')\n    }, {\n      character: 'Ä‰',\n      title: t('Latin small letter c with circumflex')\n    }, {\n      character: 'ÄŠ',\n      title: t('Latin capital letter c with dot above')\n    }, {\n      character: 'Ä‹',\n      title: t('Latin small letter c with dot above')\n    }, {\n      character: 'ÄŒ',\n      title: t('Latin capital letter c with caron')\n    }, {\n      character: 'Ä',\n      title: t('Latin small letter c with caron')\n    }, {\n      character: 'ÄŽ',\n      title: t('Latin capital letter d with caron')\n    }, {\n      character: 'Ä',\n      title: t('Latin small letter d with caron')\n    }, {\n      character: 'Ä',\n      title: t('Latin capital letter d with stroke')\n    }, {\n      character: 'Ä‘',\n      title: t('Latin small letter d with stroke')\n    }, {\n      character: 'Ä’',\n      title: t('Latin capital letter e with macron')\n    }, {\n      character: 'Ä“',\n      title: t('Latin small letter e with macron')\n    }, {\n      character: 'Ä”',\n      title: t('Latin capital letter e with breve')\n    }, {\n      character: 'Ä•',\n      title: t('Latin small letter e with breve')\n    }, {\n      character: 'Ä–',\n      title: t('Latin capital letter e with dot above')\n    }, {\n      character: 'Ä—',\n      title: t('Latin small letter e with dot above')\n    }, {\n      character: 'Ä˜',\n      title: t('Latin capital letter e with ogonek')\n    }, {\n      character: 'Ä™',\n      title: t('Latin small letter e with ogonek')\n    }, {\n      character: 'Äš',\n      title: t('Latin capital letter e with caron')\n    }, {\n      character: 'Ä›',\n      title: t('Latin small letter e with caron')\n    }, {\n      character: 'Äœ',\n      title: t('Latin capital letter g with circumflex')\n    }, {\n      character: 'Ä',\n      title: t('Latin small letter g with circumflex')\n    }, {\n      character: 'Äž',\n      title: t('Latin capital letter g with breve')\n    }, {\n      character: 'ÄŸ',\n      title: t('Latin small letter g with breve')\n    }, {\n      character: 'Ä ',\n      title: t('Latin capital letter g with dot above')\n    }, {\n      character: 'Ä¡',\n      title: t('Latin small letter g with dot above')\n    }, {\n      character: 'Ä¢',\n      title: t('Latin capital letter g with cedilla')\n    }, {\n      character: 'Ä£',\n      title: t('Latin small letter g with cedilla')\n    }, {\n      character: 'Ä¤',\n      title: t('Latin capital letter h with circumflex')\n    }, {\n      character: 'Ä¥',\n      title: t('Latin small letter h with circumflex')\n    }, {\n      character: 'Ä¦',\n      title: t('Latin capital letter h with stroke')\n    }, {\n      character: 'Ä§',\n      title: t('Latin small letter h with stroke')\n    }, {\n      character: 'Ä¨',\n      title: t('Latin capital letter i with tilde')\n    }, {\n      character: 'Ä©',\n      title: t('Latin small letter i with tilde')\n    }, {\n      character: 'Äª',\n      title: t('Latin capital letter i with macron')\n    }, {\n      character: 'Ä«',\n      title: t('Latin small letter i with macron')\n    }, {\n      character: 'Ä¬',\n      title: t('Latin capital letter i with breve')\n    }, {\n      character: 'Ä­',\n      title: t('Latin small letter i with breve')\n    }, {\n      character: 'Ä®',\n      title: t('Latin capital letter i with ogonek')\n    }, {\n      character: 'Ä¯',\n      title: t('Latin small letter i with ogonek')\n    }, {\n      character: 'Ä°',\n      title: t('Latin capital letter i with dot above')\n    }, {\n      character: 'Ä±',\n      title: t('Latin small letter dotless i')\n    }, {\n      character: 'Ä²',\n      title: t('Latin capital ligature ij')\n    }, {\n      character: 'Ä³',\n      title: t('Latin small ligature ij')\n    }, {\n      character: 'Ä´',\n      title: t('Latin capital letter j with circumflex')\n    }, {\n      character: 'Äµ',\n      title: t('Latin small letter j with circumflex')\n    }, {\n      character: 'Ä¶',\n      title: t('Latin capital letter k with cedilla')\n    }, {\n      character: 'Ä·',\n      title: t('Latin small letter k with cedilla')\n    }, {\n      character: 'Ä¸',\n      title: t('Latin small letter kra')\n    }, {\n      character: 'Ä¹',\n      title: t('Latin capital letter l with acute')\n    }, {\n      character: 'Äº',\n      title: t('Latin small letter l with acute')\n    }, {\n      character: 'Ä»',\n      title: t('Latin capital letter l with cedilla')\n    }, {\n      character: 'Ä¼',\n      title: t('Latin small letter l with cedilla')\n    }, {\n      character: 'Ä½',\n      title: t('Latin capital letter l with caron')\n    }, {\n      character: 'Ä¾',\n      title: t('Latin small letter l with caron')\n    }, {\n      character: 'Ä¿',\n      title: t('Latin capital letter l with middle dot')\n    }, {\n      character: 'Å€',\n      title: t('Latin small letter l with middle dot')\n    }, {\n      character: 'Å',\n      title: t('Latin capital letter l with stroke')\n    }, {\n      character: 'Å‚',\n      title: t('Latin small letter l with stroke')\n    }, {\n      character: 'Åƒ',\n      title: t('Latin capital letter n with acute')\n    }, {\n      character: 'Å„',\n      title: t('Latin small letter n with acute')\n    }, {\n      character: 'Å…',\n      title: t('Latin capital letter n with cedilla')\n    }, {\n      character: 'Å†',\n      title: t('Latin small letter n with cedilla')\n    }, {\n      character: 'Å‡',\n      title: t('Latin capital letter n with caron')\n    }, {\n      character: 'Åˆ',\n      title: t('Latin small letter n with caron')\n    }, {\n      character: 'Å‰',\n      title: t('Latin small letter n preceded by apostrophe')\n    }, {\n      character: 'ÅŠ',\n      title: t('Latin capital letter eng')\n    }, {\n      character: 'Å‹',\n      title: t('Latin small letter eng')\n    }, {\n      character: 'ÅŒ',\n      title: t('Latin capital letter o with macron')\n    }, {\n      character: 'Å',\n      title: t('Latin small letter o with macron')\n    }, {\n      character: 'ÅŽ',\n      title: t('Latin capital letter o with breve')\n    }, {\n      character: 'Å',\n      title: t('Latin small letter o with breve')\n    }, {\n      character: 'Å',\n      title: t('Latin capital letter o with double acute')\n    }, {\n      character: 'Å‘',\n      title: t('Latin small letter o with double acute')\n    }, {\n      character: 'Å’',\n      title: t('Latin capital ligature oe')\n    }, {\n      character: 'Å“',\n      title: t('Latin small ligature oe')\n    }, {\n      character: 'Å”',\n      title: t('Latin capital letter r with acute')\n    }, {\n      character: 'Å•',\n      title: t('Latin small letter r with acute')\n    }, {\n      character: 'Å–',\n      title: t('Latin capital letter r with cedilla')\n    }, {\n      character: 'Å—',\n      title: t('Latin small letter r with cedilla')\n    }, {\n      character: 'Å˜',\n      title: t('Latin capital letter r with caron')\n    }, {\n      character: 'Å™',\n      title: t('Latin small letter r with caron')\n    }, {\n      character: 'Åš',\n      title: t('Latin capital letter s with acute')\n    }, {\n      character: 'Å›',\n      title: t('Latin small letter s with acute')\n    }, {\n      character: 'Åœ',\n      title: t('Latin capital letter s with circumflex')\n    }, {\n      character: 'Å',\n      title: t('Latin small letter s with circumflex')\n    }, {\n      character: 'Åž',\n      title: t('Latin capital letter s with cedilla')\n    }, {\n      character: 'ÅŸ',\n      title: t('Latin small letter s with cedilla')\n    }, {\n      character: 'Å ',\n      title: t('Latin capital letter s with caron')\n    }, {\n      character: 'Å¡',\n      title: t('Latin small letter s with caron')\n    }, {\n      character: 'Å¢',\n      title: t('Latin capital letter t with cedilla')\n    }, {\n      character: 'Å£',\n      title: t('Latin small letter t with cedilla')\n    }, {\n      character: 'Å¤',\n      title: t('Latin capital letter t with caron')\n    }, {\n      character: 'Å¥',\n      title: t('Latin small letter t with caron')\n    }, {\n      character: 'Å¦',\n      title: t('Latin capital letter t with stroke')\n    }, {\n      character: 'Å§',\n      title: t('Latin small letter t with stroke')\n    }, {\n      character: 'Å¨',\n      title: t('Latin capital letter u with tilde')\n    }, {\n      character: 'Å©',\n      title: t('Latin small letter u with tilde')\n    }, {\n      character: 'Åª',\n      title: t('Latin capital letter u with macron')\n    }, {\n      character: 'Å«',\n      title: t('Latin small letter u with macron')\n    }, {\n      character: 'Å¬',\n      title: t('Latin capital letter u with breve')\n    }, {\n      character: 'Å­',\n      title: t('Latin small letter u with breve')\n    }, {\n      character: 'Å®',\n      title: t('Latin capital letter u with ring above')\n    }, {\n      character: 'Å¯',\n      title: t('Latin small letter u with ring above')\n    }, {\n      character: 'Å°',\n      title: t('Latin capital letter u with double acute')\n    }, {\n      character: 'Å±',\n      title: t('Latin small letter u with double acute')\n    }, {\n      character: 'Å²',\n      title: t('Latin capital letter u with ogonek')\n    }, {\n      character: 'Å³',\n      title: t('Latin small letter u with ogonek')\n    }, {\n      character: 'Å´',\n      title: t('Latin capital letter w with circumflex')\n    }, {\n      character: 'Åµ',\n      title: t('Latin small letter w with circumflex')\n    }, {\n      character: 'Å¶',\n      title: t('Latin capital letter y with circumflex')\n    }, {\n      character: 'Å·',\n      title: t('Latin small letter y with circumflex')\n    }, {\n      character: 'Å¸',\n      title: t('Latin capital letter y with diaeresis')\n    }, {\n      character: 'Å¹',\n      title: t('Latin capital letter z with acute')\n    }, {\n      character: 'Åº',\n      title: t('Latin small letter z with acute')\n    }, {\n      character: 'Å»',\n      title: t('Latin capital letter z with dot above')\n    }, {\n      character: 'Å¼',\n      title: t('Latin small letter z with dot above')\n    }, {\n      character: 'Å½',\n      title: t('Latin capital letter z with caron')\n    }, {\n      character: 'Å¾',\n      title: t('Latin small letter z with caron')\n    }, {\n      character: 'Å¿',\n      title: t('Latin small letter long s')\n    }], {\n      label: t('Latin')\n    });\n  }\n}\n\n/**\n * A plugin that provides special characters for the \"Currency\" category.\n *\n * ```ts\n * ClassicEditor\n *   .create( {\n *     plugins: [ ..., SpecialCharacters, SpecialCharactersCurrency ],\n *   } )\n *   .then( ... )\n *   .catch( ... );\n * ```\n */\nclass SpecialCharactersCurrency extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SpecialCharactersCurrency';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    const plugin = editor.plugins.get('SpecialCharacters');\n    plugin.addItems('Currency', [{\n      character: '$',\n      title: t('Dollar sign')\n    }, {\n      character: 'â‚¬',\n      title: t('Euro sign')\n    }, {\n      character: 'Â¥',\n      title: t('Yen sign')\n    }, {\n      character: 'Â£',\n      title: t('Pound sign')\n    }, {\n      character: 'Â¢',\n      title: t('Cent sign')\n    }, {\n      character: 'â‚ ',\n      title: t('Euro-currency sign')\n    }, {\n      character: 'â‚¡',\n      title: t('Colon sign')\n    }, {\n      character: 'â‚¢',\n      title: t('Cruzeiro sign')\n    }, {\n      character: 'â‚£',\n      title: t('French franc sign')\n    }, {\n      character: 'â‚¤',\n      title: t('Lira sign')\n    }, {\n      character: 'Â¤',\n      title: t('Currency sign')\n    }, {\n      character: 'â‚¿',\n      title: t('Bitcoin sign')\n    }, {\n      character: 'â‚¥',\n      title: t('Mill sign')\n    }, {\n      character: 'â‚¦',\n      title: t('Naira sign')\n    }, {\n      character: 'â‚§',\n      title: t('Peseta sign')\n    }, {\n      character: 'â‚¨',\n      title: t('Rupee sign')\n    }, {\n      character: 'â‚©',\n      title: t('Won sign')\n    }, {\n      character: 'â‚ª',\n      title: t('New sheqel sign')\n    }, {\n      character: 'â‚«',\n      title: t('Dong sign')\n    }, {\n      character: 'â‚­',\n      title: t('Kip sign')\n    }, {\n      character: 'â‚®',\n      title: t('Tugrik sign')\n    }, {\n      character: 'â‚¯',\n      title: t('Drachma sign')\n    }, {\n      character: 'â‚°',\n      title: t('German penny sign')\n    }, {\n      character: 'â‚±',\n      title: t('Peso sign')\n    }, {\n      character: 'â‚²',\n      title: t('Guarani sign')\n    }, {\n      character: 'â‚³',\n      title: t('Austral sign')\n    }, {\n      character: 'â‚´',\n      title: t('Hryvnia sign')\n    }, {\n      character: 'â‚µ',\n      title: t('Cedi sign')\n    }, {\n      character: 'â‚¶',\n      title: t('Livre tournois sign')\n    }, {\n      character: 'â‚·',\n      title: t('Spesmilo sign')\n    }, {\n      character: 'â‚¸',\n      title: t('Tenge sign')\n    }, {\n      character: 'â‚¹',\n      title: t('Indian rupee sign')\n    }, {\n      character: 'â‚º',\n      title: t('Turkish lira sign')\n    }, {\n      character: 'â‚»',\n      title: t('Nordic mark sign')\n    }, {\n      character: 'â‚¼',\n      title: t('Manat sign')\n    }, {\n      character: 'â‚½',\n      title: t('Ruble sign')\n    }], {\n      label: t('Currency')\n    });\n  }\n}\n\n/**\n * A plugin combining a basic set of characters for the special characters plugin.\n *\n * ```ts\n * ClassicEditor\n *   .create( {\n *     plugins: [ ..., SpecialCharacters, SpecialCharactersEssentials ],\n *   } )\n *   .then( ... )\n *   .catch( ... );\n * ```\n */\nclass SpecialCharactersEssentials extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'SpecialCharactersEssentials';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [SpecialCharactersCurrency, SpecialCharactersText, SpecialCharactersMathematical, SpecialCharactersArrows, SpecialCharactersLatin];\n  }\n}\nexport { SpecialCharacters, SpecialCharactersArrows, SpecialCharactersCurrency, SpecialCharactersEssentials, SpecialCharactersLatin, SpecialCharactersMathematical, SpecialCharactersText };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin, Command } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { ButtonView, View, addKeyboardHandlingForGrid, LabelView, ViewCollection, FocusCycler, createDropdown } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { FocusTracker, KeystrokeHandler, first, logWarning } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { isObject } from 'es-toolkit/compat';\nimport { findAttributeRange, findAttributeRangeBound } from '@ckeditor/ckeditor5-typing/dist/index.js';\n\n/**\n * A class representing an individual button (style) in the grid. Renders a rich preview of the style.\n */\nclass StyleGridButtonView extends ButtonView {\n  /**\n  * Definition of the style the button will apply when executed.\n  */\n  styleDefinition;\n  /**\n  * The view rendering the preview of the style.\n  */\n  previewView;\n  /**\n  * Creates an instance of the {@link module:style/ui/stylegridbuttonview~StyleGridButtonView} class.\n  *\n  * @param locale The localization services instance.\n  * @param styleDefinition Definition of the style.\n  */\n  constructor(locale, styleDefinition) {\n    super(locale);\n    this.styleDefinition = styleDefinition;\n    this.previewView = this._createPreview();\n    this.set({\n      label: styleDefinition.name,\n      class: 'ck-style-grid__button',\n      withText: true\n    });\n    this.extendTemplate({\n      attributes: {\n        role: 'option'\n      }\n    });\n    this.children.add(this.previewView, 0);\n  }\n  /**\n  * Creates the view representing the preview of the style.\n  */\n  _createPreview() {\n    const previewView = new View(this.locale);\n    previewView.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-reset_all-excluded', 'ck-style-grid__button__preview', 'ck-content'],\n        // The preview \"AaBbCcDdEeFfGgHhIiJj\" should not be read by screen readers because it is purely presentational.\n        'aria-hidden': 'true'\n      },\n      children: [this.styleDefinition.previewTemplate]\n    });\n    return previewView;\n  }\n}\n\n/**\n * A class representing a grid of styles ({@link module:style/ui/stylegridbuttonview~StyleGridButtonView buttons}).\n * Allows users to select a style.\n */\nclass StyleGridView extends View {\n  /**\n  * Tracks information about the DOM focus in the view.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * A collection of style {@link module:style/ui/stylegridbuttonview~StyleGridButtonView buttons}.\n  */\n  children;\n  /**\n  * Creates an instance of the {@link module:style/ui/stylegridview~StyleGridView} class.\n  *\n  * @param locale The localization services instance.\n  * @param styleDefinitions Definitions of the styles.\n  */\n  constructor(locale, styleDefinitions) {\n    super(locale);\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this.set('activeStyles', []);\n    this.set('enabledStyles', []);\n    this.children = this.createCollection();\n    this.children.delegate('execute').to(this);\n    for (const definition of styleDefinitions) {\n      const gridTileView = new StyleGridButtonView(locale, definition);\n      this.children.add(gridTileView);\n    }\n    this.on('change:activeStyles', () => {\n      for (const child of this.children) {\n        child.isOn = this.activeStyles.includes(child.styleDefinition.name);\n      }\n    });\n    this.on('change:enabledStyles', () => {\n      for (const child of this.children) {\n        child.isEnabled = this.enabledStyles.includes(child.styleDefinition.name);\n      }\n    });\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-style-grid'],\n        role: 'listbox'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    for (const child of this.children) {\n      this.focusTracker.add(child.element);\n    }\n    addKeyboardHandlingForGrid({\n      keystrokeHandler: this.keystrokes,\n      focusTracker: this.focusTracker,\n      gridItems: this.children,\n      numberOfColumns: 3,\n      uiLanguageDirection: this.locale && this.locale.uiLanguageDirection\n    });\n    // Start listening for the keystrokes coming from the grid view.\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * Focuses the first style button in the grid.\n  */\n  focus() {\n    this.children.first.focus();\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n}\n\n/**\n * A class representing a group of styles (e.g. \"block\" or \"inline\").\n *\n * Renders a {@link module:style/ui/stylegridview~StyleGridView style grid} and a label.\n */\nclass StyleGroupView extends View {\n  /**\n  * The styles grid of the group.\n  */\n  gridView;\n  /**\n  * The label of the group.\n  */\n  labelView;\n  /**\n  * Creates an instance of the {@link module:style/ui/stylegroupview~StyleGroupView} class.\n  *\n  * @param locale The localization services instance.\n  * @param label The localized label of the group.\n  * @param styleDefinitions Definitions of the styles in the group.\n  */\n  constructor(locale, label, styleDefinitions) {\n    super(locale);\n    this.labelView = new LabelView(locale);\n    this.labelView.text = label;\n    this.gridView = new StyleGridView(locale, styleDefinitions);\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-style-panel__style-group'],\n        role: 'group',\n        'aria-labelledby': this.labelView.id\n      },\n      children: [this.labelView, this.gridView]\n    });\n  }\n}\n\n/**\n * A class representing a panel with available content styles. It renders styles in button grids, grouped\n * in categories.\n */\nclass StylePanelView extends View {\n  /**\n  * Tracks information about DOM focus in the panel.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * A collection of panel children.\n  */\n  children;\n  /**\n  * A view representing block styles group.\n  */\n  blockStylesGroupView;\n  /**\n  * A view representing inline styles group\n  */\n  inlineStylesGroupView;\n  /**\n  * A collection of views that can be focused in the panel.\n  */\n  _focusables;\n  /**\n  * Helps cycling over {@link #_focusables} in the panel.\n  */\n  _focusCycler;\n  /**\n  * Creates an instance of the {@link module:style/ui/stylegroupview~StyleGroupView} class.\n  *\n  * @param locale The localization services instance.\n  * @param styleDefinitions Normalized definitions of the styles.\n  */\n  constructor(locale, styleDefinitions) {\n    super(locale);\n    const t = locale.t;\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this.children = this.createCollection();\n    this.blockStylesGroupView = new StyleGroupView(locale, t('Block styles'), styleDefinitions.block);\n    this.inlineStylesGroupView = new StyleGroupView(locale, t('Text styles'), styleDefinitions.inline);\n    this.set('activeStyles', []);\n    this.set('enabledStyles', []);\n    this._focusables = new ViewCollection();\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate style groups backwards using the <kbd>Shift</kbd> + <kbd>Tab</kbd> keystroke.\n        focusPrevious: ['shift + tab'],\n        // Navigate style groups forward using the <kbd>Tab</kbd> key.\n        focusNext: ['tab']\n      }\n    });\n    if (styleDefinitions.block.length) {\n      this.children.add(this.blockStylesGroupView);\n    }\n    if (styleDefinitions.inline.length) {\n      this.children.add(this.inlineStylesGroupView);\n    }\n    this.blockStylesGroupView.gridView.delegate('execute').to(this);\n    this.inlineStylesGroupView.gridView.delegate('execute').to(this);\n    this.blockStylesGroupView.gridView.bind('activeStyles', 'enabledStyles').to(this, 'activeStyles', 'enabledStyles');\n    this.inlineStylesGroupView.gridView.bind('activeStyles', 'enabledStyles').to(this, 'activeStyles', 'enabledStyles');\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-style-panel']\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    // Register the views as focusable.\n    this._focusables.add(this.blockStylesGroupView.gridView);\n    this._focusables.add(this.inlineStylesGroupView.gridView);\n    // Register the views in the focus tracker.\n    this.focusTracker.add(this.blockStylesGroupView.gridView.element);\n    this.focusTracker.add(this.inlineStylesGroupView.gridView.element);\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * Focuses the first focusable element in the panel.\n  */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n  /**\n  * Focuses the last focusable element in the panel.\n  */\n  focusLast() {\n    this._focusCycler.focusLast();\n  }\n}\n\n// These are intermediate element names that can't be rendered as style preview because they don't make sense standalone.\nconst NON_PREVIEWABLE_ELEMENT_NAMES = ['caption', 'colgroup', 'dd', 'dt', 'figcaption', 'legend', 'li', 'optgroup', 'option', 'rp', 'rt', 'summary', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr'];\nclass StyleUtils extends Plugin {\n  _htmlSupport;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'StyleUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this.decorate('isStyleEnabledForBlock');\n    this.decorate('isStyleActiveForBlock');\n    this.decorate('getAffectedBlocks');\n    this.decorate('isStyleEnabledForInlineSelection');\n    this.decorate('isStyleActiveForInlineSelection');\n    this.decorate('getAffectedInlineSelectable');\n    this.decorate('getStylePreview');\n    this.decorate('configureGHSDataFilter');\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    this._htmlSupport = this.editor.plugins.get('GeneralHtmlSupport');\n  }\n  /**\n  * Normalizes {@link module:style/styleconfig~StyleConfig#definitions} in the configuration of the styles feature.\n  * The structure of normalized styles looks as follows:\n  *\n  * ```ts\n  * {\n  * \tblock: [\n  * \t\t<module:style/style~StyleDefinition>,\n  * \t\t<module:style/style~StyleDefinition>,\n  * \t\t...\n  * \t],\n  * \tinline: [\n  * \t\t<module:style/style~StyleDefinition>,\n  * \t\t<module:style/style~StyleDefinition>,\n  * \t\t...\n  * \t]\n  * }\n  * ```\n  *\n  * @returns An object with normalized style definitions grouped into `block` and `inline` categories (arrays).\n  */\n  normalizeConfig(dataSchema, styleDefinitions = []) {\n    const normalizedDefinitions = {\n      block: [],\n      inline: []\n    };\n    for (const definition of styleDefinitions) {\n      const modelElements = [];\n      const ghsAttributes = [];\n      for (const ghsDefinition of dataSchema.getDefinitionsForView(definition.element)) {\n        const appliesToBlock = 'appliesToBlock' in ghsDefinition ? ghsDefinition.appliesToBlock : false;\n        if (ghsDefinition.isBlock || appliesToBlock) {\n          if (typeof appliesToBlock == 'string') {\n            modelElements.push(appliesToBlock);\n          } else if (ghsDefinition.isBlock) {\n            const ghsBlockDefinition = ghsDefinition;\n            modelElements.push(ghsDefinition.model);\n            if (ghsBlockDefinition.paragraphLikeModel) {\n              modelElements.push(ghsBlockDefinition.paragraphLikeModel);\n            }\n          }\n        } else {\n          ghsAttributes.push(ghsDefinition.model);\n        }\n      }\n      const previewTemplate = this.getStylePreview(definition, [{\n        text: 'AaBbCcDdEeFfGgHhIiJj'\n      }]);\n      if (modelElements.length) {\n        normalizedDefinitions.block.push({\n          ...definition,\n          previewTemplate,\n          modelElements,\n          isBlock: true\n        });\n      } else {\n        normalizedDefinitions.inline.push({\n          ...definition,\n          previewTemplate,\n          ghsAttributes\n        });\n      }\n    }\n    return normalizedDefinitions;\n  }\n  /**\n  * Verifies if the given style is applicable to the provided block element.\n  *\n  * @internal\n  */\n  isStyleEnabledForBlock(definition, block) {\n    const model = this.editor.model;\n    const attributeName = this._htmlSupport.getGhsAttributeNameForElement(definition.element);\n    if (!model.schema.checkAttribute(block, attributeName)) {\n      return false;\n    }\n    return definition.modelElements.includes(block.name);\n  }\n  /**\n  * Returns true if the given style is applied to the specified block element.\n  *\n  * @internal\n  */\n  isStyleActiveForBlock(definition, block) {\n    const attributeName = this._htmlSupport.getGhsAttributeNameForElement(definition.element);\n    const ghsAttributeValue = block.getAttribute(attributeName);\n    return this.hasAllClasses(ghsAttributeValue, definition.classes);\n  }\n  /**\n  * Returns an array of block elements that style should be applied to.\n  *\n  * @internal\n  */\n  getAffectedBlocks(definition, block) {\n    if (definition.modelElements.includes(block.name)) {\n      return [block];\n    }\n    return null;\n  }\n  /**\n  * Verifies if the given style is applicable to the provided document selection.\n  *\n  * @internal\n  */\n  isStyleEnabledForInlineSelection(definition, selection) {\n    const model = this.editor.model;\n    for (const ghsAttributeName of definition.ghsAttributes) {\n      if (model.schema.checkAttributeInSelection(selection, ghsAttributeName)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  /**\n  * Returns true if the given style is applied to the specified document selection.\n  *\n  * @internal\n  */\n  isStyleActiveForInlineSelection(definition, selection) {\n    for (const ghsAttributeName of definition.ghsAttributes) {\n      const ghsAttributeValue = this._getValueFromFirstAllowedNode(selection, ghsAttributeName);\n      if (this.hasAllClasses(ghsAttributeValue, definition.classes)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  /**\n  * Returns a selectable that given style should be applied to.\n  *\n  * @internal\n  */\n  getAffectedInlineSelectable(definition, selection) {\n    return selection;\n  }\n  /**\n  * Returns the `TemplateDefinition` used by styles dropdown to render style preview.\n  *\n  * @internal\n  */\n  getStylePreview(definition, children) {\n    const {\n      element,\n      classes\n    } = definition;\n    return {\n      tag: isPreviewable(element) ? element : 'div',\n      attributes: {\n        class: classes\n      },\n      children\n    };\n  }\n  /**\n  * Verifies if all classes are present in the given GHS attribute.\n  *\n  * @internal\n  */\n  hasAllClasses(ghsAttributeValue, classes) {\n    return isObject(ghsAttributeValue) && hasClassesProperty(ghsAttributeValue) && classes.every(className => ghsAttributeValue.classes.includes(className));\n  }\n  /**\n  * This is where the styles feature configures the GHS feature. This method translates normalized\n  * {@link module:style/styleconfig~StyleDefinition style definitions} to\n  * {@link module:engine/view/matcher~MatcherObjectPattern matcher patterns} and feeds them to the GHS\n  * {@link module:html-support/datafilter~DataFilter} plugin.\n  *\n  * @internal\n  */\n  configureGHSDataFilter({\n    block,\n    inline\n  }) {\n    const ghsDataFilter = this.editor.plugins.get('DataFilter');\n    ghsDataFilter.loadAllowedConfig(block.map(normalizedStyleDefinitionToMatcherPattern));\n    ghsDataFilter.loadAllowedConfig(inline.map(normalizedStyleDefinitionToMatcherPattern));\n  }\n  /**\n  * Checks the attribute value of the first node in the selection that allows the attribute.\n  * For the collapsed selection, returns the selection attribute.\n  *\n  * @param selection The document selection.\n  * @param attributeName Name of the GHS attribute.\n  * @returns The attribute value.\n  */\n  _getValueFromFirstAllowedNode(selection, attributeName) {\n    const model = this.editor.model;\n    const schema = model.schema;\n    if (selection.isCollapsed) {\n      return selection.getAttribute(attributeName);\n    }\n    for (const range of selection.getRanges()) {\n      for (const item of range.getItems()) {\n        if (schema.checkAttribute(item, attributeName)) {\n          return item.getAttribute(attributeName);\n        }\n      }\n    }\n    return null;\n  }\n}\n/**\n * Checks if given object has `classes` property which is an array.\n *\n * @param obj Object to check.\n */\nfunction hasClassesProperty(obj) {\n  return Boolean(obj.classes) && Array.isArray(obj.classes);\n}\n/**\n * Decides whether an element should be created in the preview or a substitute `<div>` should\n * be used instead. This avoids previewing a standalone `<td>`, `<li>`, etc. without a parent.\n *\n * @param elementName Name of the element\n * @returns Boolean indicating whether the element can be rendered.\n */\nfunction isPreviewable(elementName) {\n  return !NON_PREVIEWABLE_ELEMENT_NAMES.includes(elementName);\n}\n/**\n * Translates a normalized style definition to a view matcher pattern.\n */\nfunction normalizedStyleDefinitionToMatcherPattern({\n  element,\n  classes\n}) {\n  return {\n    name: element,\n    classes\n  };\n}\n\n/**\n * The UI plugin of the style feature .\n *\n * It registers the `'style'` UI dropdown in the editor's {@link module:ui/componentfactory~ComponentFactory component factory}\n * that displays a grid of styles and allows changing styles of the content.\n */\nclass StyleUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'StyleUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [StyleUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const dataSchema = editor.plugins.get('DataSchema');\n    const styleUtils = editor.plugins.get('StyleUtils');\n    const styleDefinitions = editor.config.get('style.definitions');\n    const normalizedStyleDefinitions = styleUtils.normalizeConfig(dataSchema, styleDefinitions);\n    // Add the dropdown to the component factory.\n    editor.ui.componentFactory.add('style', locale => {\n      const t = locale.t;\n      const dropdown = createDropdown(locale);\n      const styleCommand = editor.commands.get('style');\n      dropdown.once('change:isOpen', () => {\n        const panelView = new StylePanelView(locale, normalizedStyleDefinitions);\n        // Put the styles panel is the dropdown.\n        dropdown.panelView.children.add(panelView);\n        // Close the dropdown when a style is selected in the styles panel.\n        panelView.delegate('execute').to(dropdown);\n        // Bind the state of the styles panel to the command.\n        panelView.bind('activeStyles').to(styleCommand, 'value');\n        panelView.bind('enabledStyles').to(styleCommand, 'enabledStyles');\n      });\n      // The entire dropdown will be disabled together with the command (e.g. when the editor goes read-only).\n      dropdown.bind('isEnabled').to(styleCommand);\n      // This dropdown has no icon. It displays text label depending on the selection.\n      dropdown.buttonView.withText = true;\n      // The label of the dropdown is dynamic and depends on how many styles are active at a time.\n      dropdown.buttonView.bind('label').to(styleCommand, 'value', value => {\n        if (value.length > 1) {\n          return t('Multiple styles');\n        } else if (value.length === 1) {\n          return value[0];\n        } else {\n          return t('Styles');\n        }\n      });\n      // The dropdown has a static CSS class for easy customization. There's another CSS class\n      // that gets displayed when multiple styles are active at a time allowing visual customization of\n      // the label.\n      dropdown.bind('class').to(styleCommand, 'value', value => {\n        const classes = ['ck-style-dropdown'];\n        if (value.length > 1) {\n          classes.push('ck-style-dropdown_multiple-active');\n        }\n        return classes.join(' ');\n      });\n      // Execute the command when a style is selected in the styles panel.\n      // Also focus the editable after executing the command.\n      // It overrides a default behaviour where the focus is moved to the dropdown button (#12125).\n      dropdown.on('execute', evt => {\n        editor.execute('style', {\n          styleName: evt.source.styleDefinition.name\n        });\n        editor.editing.view.focus();\n      });\n      return dropdown;\n    });\n  }\n}\n\n/**\n * Style command.\n *\n * Applies and removes styles from selection and elements.\n */\nclass StyleCommand extends Command {\n  /**\n  * Normalized definitions of the styles.\n  */\n  _styleDefinitions;\n  /**\n  * The StyleUtils plugin.\n  */\n  _styleUtils;\n  /**\n  * Creates an instance of the command.\n  *\n  * @param editor Editor on which this command will be used.\n  * @param styleDefinitions Normalized definitions of the styles.\n  */\n  constructor(editor, styleDefinitions) {\n    super(editor);\n    this.set('value', []);\n    this.set('enabledStyles', []);\n    this._styleDefinitions = styleDefinitions;\n    this._styleUtils = this.editor.plugins.get(StyleUtils);\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const value = new Set();\n    const enabledStyles = new Set();\n    // Inline styles.\n    for (const definition of this._styleDefinitions.inline) {\n      // Check if this inline style is enabled.\n      if (this._styleUtils.isStyleEnabledForInlineSelection(definition, selection)) {\n        enabledStyles.add(definition.name);\n      }\n      // Check if this inline style is active.\n      if (this._styleUtils.isStyleActiveForInlineSelection(definition, selection)) {\n        value.add(definition.name);\n      }\n    }\n    // Block styles.\n    const firstBlock = first(selection.getSelectedBlocks()) || selection.getFirstPosition().parent;\n    if (firstBlock) {\n      const ancestorBlocks = firstBlock.getAncestors({\n        includeSelf: true,\n        parentFirst: true\n      });\n      for (const block of ancestorBlocks) {\n        if (block.is('rootElement')) {\n          break;\n        }\n        for (const definition of this._styleDefinitions.block) {\n          // Check if this block style is enabled.\n          if (!this._styleUtils.isStyleEnabledForBlock(definition, block)) {\n            continue;\n          }\n          enabledStyles.add(definition.name);\n          // Check if this block style is active.\n          if (this._styleUtils.isStyleActiveForBlock(definition, block)) {\n            value.add(definition.name);\n          }\n        }\n        // E.g. reached a model table when the selection is in a cell. The command should not modify\n        // ancestors of a table.\n        if (model.schema.isObject(block)) {\n          break;\n        }\n      }\n    }\n    this.enabledStyles = Array.from(enabledStyles).sort();\n    this.isEnabled = this.enabledStyles.length > 0;\n    this.value = this.isEnabled ? Array.from(value).sort() : [];\n  }\n  /**\n  * Executes the command &ndash; applies the style classes to the selection or removes it from the selection.\n  *\n  * If the command value already contains the requested style, it will remove the style classes. Otherwise, it will set it.\n  *\n  * The execution result differs, depending on the {@link module:engine/model/document~Document#selection} and the\n  * style type (inline or block):\n  *\n  * * When applying inline styles:\n  *   * If the selection is on a range, the command applies the style classes to all nodes in that range.\n  *   * If the selection is collapsed in a non-empty node, the command applies the style classes to the\n  * {@link module:engine/model/document~Document#selection}.\n  *\n  * * When applying block styles:\n  *   * If the selection is on a range, the command applies the style classes to the nearest block parent element.\n  *\n  * @fires execute\n  * @param options Command options.\n  * @param options.styleName Style name matching the one defined in the\n  * {@link module:style/styleconfig~StyleConfig#definitions configuration}.\n  * @param options.forceValue Whether the command should add given style (`true`) or remove it (`false`) from the selection.\n  * If not set (default), the command will toggle the style basing on the first selected node. Note, that this will not force\n  * setting a style on an element that cannot receive given style.\n  */\n  execute({\n    styleName,\n    forceValue\n  }) {\n    if (!this.enabledStyles.includes(styleName)) {\n      /**\n      * Style command can be executed only with a correct style name.\n      *\n      * This warning may be caused by:\n      *\n      * * passing a name that is not specified in the {@link module:style/styleconfig~StyleConfig#definitions configuration}\n      * (e.g. a CSS class name),\n      * * when trying to apply a style that is not allowed on a given element.\n      *\n      * @error style-command-executed-with-incorrect-style-name\n      */\n      logWarning('style-command-executed-with-incorrect-style-name');\n      return;\n    }\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const htmlSupport = this.editor.plugins.get('GeneralHtmlSupport');\n    const allDefinitions = [...this._styleDefinitions.inline, ...this._styleDefinitions.block];\n    const activeDefinitions = allDefinitions.filter(({\n      name\n    }) => this.value.includes(name));\n    const definition = allDefinitions.find(({\n      name\n    }) => name == styleName);\n    const shouldAddStyle = forceValue === undefined ? !this.value.includes(definition.name) : forceValue;\n    model.change(() => {\n      let selectables;\n      if (isBlockStyleDefinition(definition)) {\n        selectables = this._findAffectedBlocks(getBlocksFromSelection(selection), definition);\n      } else {\n        selectables = [this._styleUtils.getAffectedInlineSelectable(definition, selection)];\n      }\n      for (const selectable of selectables) {\n        if (shouldAddStyle) {\n          htmlSupport.addModelHtmlClass(definition.element, definition.classes, selectable);\n        } else {\n          htmlSupport.removeModelHtmlClass(definition.element, getDefinitionExclusiveClasses(activeDefinitions, definition), selectable);\n        }\n      }\n    });\n  }\n  /**\n  * Returns a set of elements that should be affected by the block-style change.\n  */\n  _findAffectedBlocks(selectedBlocks, definition) {\n    const blocks = new Set();\n    for (const selectedBlock of selectedBlocks) {\n      const ancestorBlocks = selectedBlock.getAncestors({\n        includeSelf: true,\n        parentFirst: true\n      });\n      for (const block of ancestorBlocks) {\n        if (block.is('rootElement')) {\n          break;\n        }\n        const affectedBlocks = this._styleUtils.getAffectedBlocks(definition, block);\n        if (affectedBlocks) {\n          for (const affectedBlock of affectedBlocks) {\n            blocks.add(affectedBlock);\n          }\n          break;\n        }\n      }\n    }\n    return blocks;\n  }\n}\n/**\n * Returns classes that are defined only in the supplied definition and not in any other active definition. It's used\n * to ensure that classes used by other definitions are preserved when a style is removed. See #11748.\n *\n * @param activeDefinitions All currently active definitions affecting selected element(s).\n * @param definition Definition whose classes will be compared with all other active definition classes.\n * @returns Array of classes exclusive to the supplied definition.\n */\nfunction getDefinitionExclusiveClasses(activeDefinitions, definition) {\n  return activeDefinitions.reduce((classes, currentDefinition) => {\n    if (currentDefinition.name === definition.name) {\n      return classes;\n    }\n    return classes.filter(className => !currentDefinition.classes.includes(className));\n  }, definition.classes);\n}\n/**\n * Checks if provided style definition is of type block.\n */\nfunction isBlockStyleDefinition(definition) {\n  return 'isBlock' in definition;\n}\n/**\n * Gets block elements from selection. If there are none, returns first selected element.\n * @param selection Current document's selection.\n * @returns Selected blocks if there are any, first selected element otherwise.\n */\nfunction getBlocksFromSelection(selection) {\n  const blocks = Array.from(selection.getSelectedBlocks());\n  if (blocks.length) {\n    return blocks;\n  }\n  return [selection.getFirstPosition().parent];\n}\nclass ListStyleSupport extends Plugin {\n  _listUtils;\n  _styleUtils;\n  _htmlSupport;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'ListStyleSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [StyleUtils, 'GeneralHtmlSupport'];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!editor.plugins.has('ListEditing')) {\n      return;\n    }\n    this._styleUtils = editor.plugins.get(StyleUtils);\n    this._listUtils = this.editor.plugins.get('ListUtils');\n    this._htmlSupport = this.editor.plugins.get('GeneralHtmlSupport');\n    this.listenTo(this._styleUtils, 'isStyleEnabledForBlock', (evt, [definition, block]) => {\n      if (this._isStyleEnabledForBlock(definition, block)) {\n        evt.return = true;\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    this.listenTo(this._styleUtils, 'isStyleActiveForBlock', (evt, [definition, block]) => {\n      if (this._isStyleActiveForBlock(definition, block)) {\n        evt.return = true;\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    this.listenTo(this._styleUtils, 'getAffectedBlocks', (evt, [definition, block]) => {\n      const blocks = this._getAffectedBlocks(definition, block);\n      if (blocks) {\n        evt.return = blocks;\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    this.listenTo(this._styleUtils, 'getStylePreview', (evt, [definition, children]) => {\n      const templateDefinition = this._getStylePreview(definition, children);\n      if (templateDefinition) {\n        evt.return = templateDefinition;\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Verifies if the given style is applicable to the provided block element.\n  */\n  _isStyleEnabledForBlock(definition, block) {\n    const model = this.editor.model;\n    if (!['ol', 'ul', 'li'].includes(definition.element)) {\n      return false;\n    }\n    if (!this._listUtils.isListItemBlock(block)) {\n      return false;\n    }\n    const attributeName = this._htmlSupport.getGhsAttributeNameForElement(definition.element);\n    if (definition.element == 'ol' || definition.element == 'ul') {\n      if (!model.schema.checkAttribute(block, attributeName)) {\n        return false;\n      }\n      const isNumbered = this._listUtils.isNumberedListType(block.getAttribute('listType'));\n      const viewElementName = isNumbered ? 'ol' : 'ul';\n      return definition.element == viewElementName;\n    } else {\n      return model.schema.checkAttribute(block, attributeName);\n    }\n  }\n  /**\n  * Returns true if the given style is applied to the specified block element.\n  */\n  _isStyleActiveForBlock(definition, block) {\n    const attributeName = this._htmlSupport.getGhsAttributeNameForElement(definition.element);\n    const ghsAttributeValue = block.getAttribute(attributeName);\n    return this._styleUtils.hasAllClasses(ghsAttributeValue, definition.classes);\n  }\n  /**\n  * Returns an array of block elements that style should be applied to.\n  */\n  _getAffectedBlocks(definition, block) {\n    if (!this._isStyleEnabledForBlock(definition, block)) {\n      return null;\n    }\n    if (definition.element == 'li') {\n      return this._listUtils.expandListBlocksToCompleteItems(block, {\n        withNested: false\n      });\n    } else {\n      return this._listUtils.expandListBlocksToCompleteList(block);\n    }\n  }\n  /**\n  * Returns a view template definition for the style preview.\n  */\n  _getStylePreview(definition, children) {\n    const {\n      element,\n      classes\n    } = definition;\n    if (element == 'ol' || element == 'ul') {\n      return {\n        tag: element,\n        attributes: {\n          class: classes\n        },\n        children: [{\n          tag: 'li',\n          children\n        }]\n      };\n    } else if (element == 'li') {\n      return {\n        tag: 'ol',\n        children: [{\n          tag: element,\n          attributes: {\n            class: classes\n          },\n          children\n        }]\n      };\n    }\n    return null;\n  }\n}\nclass TableStyleSupport extends Plugin {\n  _tableUtils;\n  _styleUtils;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableStyleSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [StyleUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!editor.plugins.has('TableEditing')) {\n      return;\n    }\n    this._styleUtils = editor.plugins.get(StyleUtils);\n    this._tableUtils = this.editor.plugins.get('TableUtils');\n    this.listenTo(this._styleUtils, 'isStyleEnabledForBlock', (evt, [definition, block]) => {\n      if (this._isApplicable(definition, block)) {\n        evt.return = this._isStyleEnabledForBlock(definition, block);\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    this.listenTo(this._styleUtils, 'getAffectedBlocks', (evt, [definition, block]) => {\n      if (this._isApplicable(definition, block)) {\n        evt.return = this._getAffectedBlocks(definition, block);\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    this.listenTo(this._styleUtils, 'configureGHSDataFilter', (evt, [{\n      block\n    }]) => {\n      const ghsDataFilter = this.editor.plugins.get('DataFilter');\n      ghsDataFilter.loadAllowedConfig(block.filter(definition => definition.element == 'figcaption').map(definition => ({\n        name: 'caption',\n        classes: definition.classes\n      })));\n    });\n  }\n  /**\n  * Checks if this plugin's custom logic should be applied for defintion-block pair.\n  *\n  * @param definition Style definition that is being considered.\n  * @param block Block element to check if should be styled.\n  * @returns True if the defintion-block pair meet the plugin criteria, false otherwise.\n  */\n  _isApplicable(definition, block) {\n    if (['td', 'th'].includes(definition.element)) {\n      return block.name == 'tableCell';\n    }\n    if (['thead', 'tbody'].includes(definition.element)) {\n      return block.name == 'table';\n    }\n    return false;\n  }\n  /**\n  * Checks if the style definition should be applied to selected block.\n  *\n  * @param definition Style definition that is being considered.\n  * @param block Block element to check if should be styled.\n  * @returns True if the block should be style with the style description, false otherwise.\n  */\n  _isStyleEnabledForBlock(definition, block) {\n    if (['td', 'th'].includes(definition.element)) {\n      const location = this._tableUtils.getCellLocation(block);\n      const tableRow = block.parent;\n      const table = tableRow.parent;\n      const headingRows = table.getAttribute('headingRows') || 0;\n      const headingColumns = table.getAttribute('headingColumns') || 0;\n      const isHeadingCell = location.row < headingRows || location.column < headingColumns;\n      if (definition.element == 'th') {\n        return isHeadingCell;\n      } else {\n        return !isHeadingCell;\n      }\n    }\n    if (['thead', 'tbody'].includes(definition.element)) {\n      const headingRows = block.getAttribute('headingRows') || 0;\n      if (definition.element == 'thead') {\n        return headingRows > 0;\n      } else {\n        return headingRows < this._tableUtils.getRows(block);\n      }\n    }\n    /* istanbul ignore next -- @preserve */\n    return false;\n  }\n  /**\n  * Gets all blocks that the style should be applied to.\n  *\n  * @param definition Style definition that is being considered.\n  * @param block A block element from selection.\n  * @returns An array with the block that was passed as an argument if meets the criteria, null otherwise.\n  */\n  _getAffectedBlocks(definition, block) {\n    if (!this._isStyleEnabledForBlock(definition, block)) {\n      return null;\n    }\n    return [block];\n  }\n}\nclass LinkStyleSupport extends Plugin {\n  _styleUtils;\n  _htmlSupport;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'LinkStyleSupport';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [StyleUtils, 'GeneralHtmlSupport'];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    if (!editor.plugins.has('LinkEditing')) {\n      return;\n    }\n    this._styleUtils = editor.plugins.get(StyleUtils);\n    this._htmlSupport = this.editor.plugins.get('GeneralHtmlSupport');\n    this.listenTo(this._styleUtils, 'isStyleEnabledForInlineSelection', (evt, [definition, selection]) => {\n      if (definition.element == 'a') {\n        evt.return = this._isStyleEnabled(definition, selection);\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    this.listenTo(this._styleUtils, 'isStyleActiveForInlineSelection', (evt, [definition, selection]) => {\n      if (definition.element == 'a') {\n        evt.return = this._isStyleActive(definition, selection);\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n    this.listenTo(this._styleUtils, 'getAffectedInlineSelectable', (evt, [definition, selection]) => {\n      if (definition.element != 'a') {\n        return;\n      }\n      const selectable = this._getAffectedSelectable(definition, selection);\n      if (selectable) {\n        evt.return = selectable;\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n  }\n  /**\n  * Verifies if the given style is applicable to the provided document selection.\n  */\n  _isStyleEnabled(definition, selection) {\n    const model = this.editor.model;\n    // Handle collapsed selection.\n    if (selection.isCollapsed) {\n      return selection.hasAttribute('linkHref');\n    }\n    // Non-collapsed selection.\n    for (const range of selection.getRanges()) {\n      for (const item of range.getItems()) {\n        if ((item.is('$textProxy') || model.schema.isInline(item)) && item.hasAttribute('linkHref')) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  /**\n  * Returns true if the given style is applied to the specified document selection.\n  */\n  _isStyleActive(definition, selection) {\n    const model = this.editor.model;\n    const attributeName = this._htmlSupport.getGhsAttributeNameForElement(definition.element);\n    // Handle collapsed selection.\n    if (selection.isCollapsed) {\n      if (selection.hasAttribute('linkHref')) {\n        const ghsAttributeValue = selection.getAttribute(attributeName);\n        if (this._styleUtils.hasAllClasses(ghsAttributeValue, definition.classes)) {\n          return true;\n        }\n      }\n      return false;\n    }\n    // Non-collapsed selection.\n    for (const range of selection.getRanges()) {\n      for (const item of range.getItems()) {\n        if ((item.is('$textProxy') || model.schema.isInline(item)) && item.hasAttribute('linkHref')) {\n          const ghsAttributeValue = item.getAttribute(attributeName);\n          return this._styleUtils.hasAllClasses(ghsAttributeValue, definition.classes);\n        }\n      }\n    }\n    return false;\n  }\n  /**\n  * Returns a selectable that given style should be applied to.\n  */\n  _getAffectedSelectable(definition, selection) {\n    const model = this.editor.model;\n    // Handle collapsed selection.\n    if (selection.isCollapsed) {\n      const linkHref = selection.getAttribute('linkHref');\n      return findAttributeRange(selection.getFirstPosition(), 'linkHref', linkHref, model);\n    }\n    // Non-collapsed selection.\n    const ranges = [];\n    for (const range of selection.getRanges()) {\n      // First expand range to include the whole link.\n      const expandedRange = model.createRange(expandAttributePosition(range.start, 'linkHref', true, model), expandAttributePosition(range.end, 'linkHref', false, model));\n      // Pick only ranges on links.\n      for (const item of expandedRange.getItems()) {\n        if ((item.is('$textProxy') || model.schema.isInline(item)) && item.hasAttribute('linkHref')) {\n          ranges.push(this.editor.model.createRangeOn(item));\n        }\n      }\n    }\n    // Make sure that we have a continuous range on a link\n    // (not split between text nodes with mixed attributes like bold etc.)\n    return normalizeRanges(ranges);\n  }\n}\n/**\n * Walks forward or backward (depends on the `lookBack` flag), node by node, as long as they have the same attribute value\n * and returns a position just before or after (depends on the `lookBack` flag) the last matched node.\n */\nfunction expandAttributePosition(position, attributeName, lookBack, model) {\n  const referenceNode = position.textNode || (lookBack ? position.nodeAfter : position.nodeBefore);\n  if (!referenceNode || !referenceNode.hasAttribute(attributeName)) {\n    return position;\n  }\n  const attributeValue = referenceNode.getAttribute(attributeName);\n  return findAttributeRangeBound(position, attributeName, attributeValue, lookBack, model);\n}\n/**\n * Normalizes list of ranges by joining intersecting or \"touching\" ranges.\n *\n * Note: It assumes that ranges are sorted.\n */\nfunction normalizeRanges(ranges) {\n  for (let i = 1; i < ranges.length; i++) {\n    const joinedRange = ranges[i - 1].getJoined(ranges[i]);\n    if (joinedRange) {\n      // Replace the ranges on the list with the new joined range.\n      ranges.splice(--i, 2, joinedRange);\n    }\n  }\n  return ranges;\n}\n\n/**\n * The style engine feature.\n *\n * It configures the {@glink features/html/general-html-support General HTML Support feature} based on\n * {@link module:style/styleconfig~StyleConfig#definitions configured style definitions} and introduces the\n * {@link module:style/stylecommand~StyleCommand style command} that applies styles to the content of the document.\n */\nclass StyleEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'StyleEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return ['GeneralHtmlSupport', StyleUtils, ListStyleSupport, TableStyleSupport, LinkStyleSupport];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const dataSchema = editor.plugins.get('DataSchema');\n    const styleUtils = editor.plugins.get('StyleUtils');\n    const styleDefinitions = editor.config.get('style.definitions');\n    const normalizedStyleDefinitions = styleUtils.normalizeConfig(dataSchema, styleDefinitions);\n    editor.commands.add('style', new StyleCommand(editor, normalizedStyleDefinitions));\n    styleUtils.configureGHSDataFilter(normalizedStyleDefinitions);\n  }\n}\n\n/**\n * The style plugin.\n *\n * This is a \"glue\" plugin that loads the {@link module:style/styleediting~StyleEditing style editing feature}\n * and {@link module:style/styleui~StyleUI style UI feature}.\n */\nclass Style extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Style';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [StyleEditing, StyleUI];\n  }\n}\nexport { Style, StyleEditing, StyleUI, StyleUtils };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Command, Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { toWidgetEditable, toWidget, Widget, isWidget, WidgetToolbarRepository } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { first, global, CKEditorError, KeystrokeHandler, FocusTracker, Collection, getLocalizedArrowKeyCodeDirection, Rect, DomEmitterMixin, toUnit } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { IconTable, IconTableColumn, IconTableRow, IconTableMergeCell, IconCheck, IconCancel, IconAlignBottom, IconAlignMiddle, IconAlignTop, IconAlignJustify, IconAlignRight, IconAlignCenter, IconAlignLeft, IconTableCellProperties, IconTableLayout, IconTableProperties, IconObjectInlineRight, IconObjectCenter, IconObjectInlineLeft, IconCaption } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { View, addKeyboardHandlingForGrid, ButtonView, createDropdown, MenuBarMenuView, SwitchButtonView, SplitButtonView, addListToDropdown, ViewModel, ViewCollection, FocusCycler, InputTextView, ColorSelectorView, FormHeaderView, FormRowView, submitHandler, LabelView, LabeledFieldView, createLabeledDropdown, createLabeledInputText, ToolbarView, BalloonPanelView, ContextualBalloon, normalizeColorOptions, getLocalizedColorOptions, clickOutsideHandler, DropdownButtonView } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { ClipboardMarkersUtils, ClipboardPipeline } from '@ckeditor/ckeditor5-clipboard/dist/index.js';\nimport { DomEventObserver, isColor, isLength, isPercentage, addBorderRules, addPaddingRules, addBackgroundRules, enablePlaceholder, Element } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { isObject, debounce, isEqual, throttle } from 'es-toolkit/compat';\n\n/**\n * Conversion helper for upcasting attributes using normalized styles.\n *\n * @param options.modelAttribute The attribute to set.\n * @param options.styleName The style name to convert.\n * @param options.viewElement The view element name that should be converted.\n * @param options.defaultValue The default value for the specified `modelAttribute`.\n * @param options.shouldUpcast The function which returns `true` if style should be upcasted from this element.\n */\nfunction upcastStyleToAttribute(conversion, options) {\n  const {\n    modelAttribute,\n    styleName,\n    viewElement,\n    defaultValue,\n    reduceBoxSides = false,\n    shouldUpcast = () => true\n  } = options;\n  conversion.for('upcast').attributeToAttribute({\n    view: {\n      name: viewElement,\n      styles: {\n        [styleName]: /[\\s\\S]+/\n      }\n    },\n    model: {\n      key: modelAttribute,\n      value: (viewElement, conversionApi, data) => {\n        if (!shouldUpcast(viewElement)) {\n          return;\n        }\n        const localDefaultValue = getDefaultValueAdjusted(defaultValue, '', data);\n        const normalized = viewElement.getNormalizedStyle(styleName);\n        const value = reduceBoxSides ? reduceBoxSidesValue(normalized) : normalized;\n        if (localDefaultValue !== value) {\n          return value;\n        }\n      }\n    }\n  });\n}\n/**\n * Conversion helper for upcasting border styles for view elements.\n *\n * @param defaultBorder The default border values.\n * @param defaultBorder.color The default `borderColor` value.\n * @param defaultBorder.style The default `borderStyle` value.\n * @param defaultBorder.width The default `borderWidth` value.\n */\nfunction upcastBorderStyles(conversion, viewElementName, modelAttributes, defaultBorder) {\n  conversion.for('upcast').add(dispatcher => dispatcher.on('element:' + viewElementName, (evt, data, conversionApi) => {\n    // If the element was not converted by element-to-element converter,\n    // we should not try to convert the style. See #8393.\n    if (!data.modelRange) {\n      return;\n    }\n    // Check the most detailed properties. These will be always set directly or\n    // when using the \"group\" properties like: `border-(top|right|bottom|left)` or `border`.\n    const stylesToConsume = ['border-top-width', 'border-top-color', 'border-top-style', 'border-bottom-width', 'border-bottom-color', 'border-bottom-style', 'border-right-width', 'border-right-color', 'border-right-style', 'border-left-width', 'border-left-color', 'border-left-style'].filter(styleName => data.viewItem.hasStyle(styleName));\n    if (!stylesToConsume.length) {\n      return;\n    }\n    const matcherPattern = {\n      styles: stylesToConsume\n    };\n    // Try to consume appropriate values from consumable values list.\n    if (!conversionApi.consumable.test(data.viewItem, matcherPattern)) {\n      return;\n    }\n    const modelElement = [...data.modelRange.getItems({\n      shallow: true\n    })].pop();\n    const tableElement = modelElement.findAncestor('table', {\n      includeSelf: true\n    });\n    let localDefaultBorder = defaultBorder;\n    if (tableElement && tableElement.getAttribute('tableType') == 'layout') {\n      localDefaultBorder = {\n        style: 'none',\n        color: '',\n        width: ''\n      };\n    }\n    conversionApi.consumable.consume(data.viewItem, matcherPattern);\n    const normalizedBorder = {\n      style: data.viewItem.getNormalizedStyle('border-style'),\n      color: data.viewItem.getNormalizedStyle('border-color'),\n      width: data.viewItem.getNormalizedStyle('border-width')\n    };\n    const reducedBorder = {\n      style: reduceBoxSidesValue(normalizedBorder.style),\n      color: reduceBoxSidesValue(normalizedBorder.color),\n      width: reduceBoxSidesValue(normalizedBorder.width)\n    };\n    if (reducedBorder.style !== localDefaultBorder.style) {\n      conversionApi.writer.setAttribute(modelAttributes.style, reducedBorder.style, modelElement);\n    }\n    if (reducedBorder.color !== localDefaultBorder.color) {\n      conversionApi.writer.setAttribute(modelAttributes.color, reducedBorder.color, modelElement);\n    }\n    if (reducedBorder.width !== localDefaultBorder.width) {\n      conversionApi.writer.setAttribute(modelAttributes.width, reducedBorder.width, modelElement);\n    }\n  }));\n}\n/**\n * Conversion helper for downcasting an attribute to a style.\n */\nfunction downcastAttributeToStyle(conversion, options) {\n  const {\n    modelElement,\n    modelAttribute,\n    styleName\n  } = options;\n  conversion.for('downcast').attributeToAttribute({\n    model: {\n      name: modelElement,\n      key: modelAttribute\n    },\n    view: modelAttributeValue => ({\n      key: 'style',\n      value: {\n        [styleName]: modelAttributeValue\n      }\n    })\n  });\n}\n/**\n * Conversion helper for downcasting attributes from the model table to a view table (not to `<figure>`).\n */\nfunction downcastTableAttribute(conversion, options) {\n  const {\n    modelAttribute,\n    styleName\n  } = options;\n  conversion.for('downcast').add(dispatcher => dispatcher.on(`attribute:${modelAttribute}:table`, (evt, data, conversionApi) => {\n    const {\n      item,\n      attributeNewValue\n    } = data;\n    const {\n      mapper,\n      writer\n    } = conversionApi;\n    if (!conversionApi.consumable.consume(data.item, evt.name)) {\n      return;\n    }\n    const table = [...mapper.toViewElement(item).getChildren()].find(child => child.is('element', 'table'));\n    if (attributeNewValue) {\n      writer.setStyle(styleName, attributeNewValue, table);\n    } else {\n      writer.removeStyle(styleName, table);\n    }\n  }));\n}\n/**\n * Returns the default value for table or table cell property adjusted for layout tables.\n */\nfunction getDefaultValueAdjusted(defaultValue, layoutTableDefault, data) {\n  const modelElement = data.modelRange && first(data.modelRange.getItems({\n    shallow: true\n  }));\n  const tableElement = modelElement && modelElement.is('element') && modelElement.findAncestor('table', {\n    includeSelf: true\n  });\n  if (tableElement && tableElement.getAttribute('tableType') === 'layout') {\n    return layoutTableDefault;\n  }\n  return defaultValue;\n}\n/**\n * Reduces the full top, right, bottom, left object to a single string if all sides are equal.\n * Returns original style otherwise.\n */\nfunction reduceBoxSidesValue(style) {\n  if (!style) {\n    return;\n  }\n  const sides = ['top', 'right', 'bottom', 'left'];\n  const allSidesDefined = sides.every(side => style[side]);\n  if (!allSidesDefined) {\n    return style;\n  }\n  const topSideStyle = style.top;\n  const allSidesEqual = sides.every(side => style[side] === topSideStyle);\n  if (!allSidesEqual) {\n    return style;\n  }\n  return topSideStyle;\n}\n\n/**\n * A common method to update the numeric value. If a value is the default one, it will be unset.\n *\n * @param key An attribute key.\n * @param value The new attribute value.\n * @param item A model item on which the attribute will be set.\n * @param defaultValue The default attribute value. If a value is lower or equal, it will be unset.\n */\nfunction updateNumericAttribute(key, value, item, writer, defaultValue = 1) {\n  if (value !== undefined && value !== null && defaultValue !== undefined && defaultValue !== null && value > defaultValue) {\n    writer.setAttribute(key, value, item);\n  } else {\n    writer.removeAttribute(key, item);\n  }\n}\n/**\n * A common method to create an empty table cell. It creates a proper model structure as a table cell must have at least one block inside.\n *\n * @param writer The model writer.\n * @param insertPosition The position at which the table cell should be inserted.\n * @param attributes The element attributes.\n * @returns Created table cell.\n */\nfunction createEmptyTableCell(writer, insertPosition, attributes = {}) {\n  const tableCell = writer.createElement('tableCell', attributes);\n  writer.insertElement('paragraph', tableCell);\n  writer.insert(tableCell, insertPosition);\n  return tableCell;\n}\n/**\n * Checks if a table cell belongs to the heading column section.\n */\nfunction isHeadingColumnCell(tableUtils, tableCell) {\n  const table = tableCell.parent.parent;\n  const headingColumns = parseInt(table.getAttribute('headingColumns') || '0');\n  const {\n    column\n  } = tableUtils.getCellLocation(tableCell);\n  return !!headingColumns && column < headingColumns;\n}\n/**\n * Enables conversion for an attribute for simple view-model mappings.\n *\n * @param options.defaultValue The default value for the specified `modelAttribute`.\n */\nfunction enableProperty$1(schema, conversion, options) {\n  const {\n    modelAttribute\n  } = options;\n  schema.extend('tableCell', {\n    allowAttributes: [modelAttribute]\n  });\n  upcastStyleToAttribute(conversion, {\n    viewElement: /^(td|th)$/,\n    ...options\n  });\n  downcastAttributeToStyle(conversion, {\n    modelElement: 'tableCell',\n    ...options\n  });\n}\n/**\n * Depending on the position of the selection we either return the table under cursor or look for the table higher in the hierarchy.\n */\nfunction getSelectionAffectedTable(selection) {\n  const selectedElement = selection.getSelectedElement();\n  // Is the command triggered from the `tableToolbar`?\n  if (selectedElement && selectedElement.is('element', 'table')) {\n    return selectedElement;\n  }\n  return selection.getFirstPosition().findAncestor('table');\n}\n\n/**\n * Returns a function that converts the table view representation:\n *\n * ```xml\n * <figure class=\"table\"><table>...</table></figure>\n * ```\n *\n * to the model representation:\n *\n * ```xml\n * <table></table>\n * ```\n */\nfunction upcastTableFigure() {\n  return dispatcher => {\n    dispatcher.on('element:figure', (evt, data, conversionApi) => {\n      // Do not convert if this is not a \"table figure\".\n      if (!conversionApi.consumable.test(data.viewItem, {\n        name: true,\n        classes: 'table'\n      })) {\n        return;\n      }\n      // Find a table element inside the figure element.\n      const viewTable = getViewTableFromFigure(data.viewItem);\n      // Do not convert if table element is absent or was already converted.\n      if (!viewTable || !conversionApi.consumable.test(viewTable, {\n        name: true\n      })) {\n        return;\n      }\n      // Consume the figure to prevent other converters from processing it again.\n      conversionApi.consumable.consume(data.viewItem, {\n        name: true,\n        classes: 'table'\n      });\n      // Convert view table to model table.\n      const conversionResult = conversionApi.convertItem(viewTable, data.modelCursor);\n      // Get table element from conversion result.\n      const modelTable = first(conversionResult.modelRange.getItems());\n      // When table wasn't successfully converted then finish conversion.\n      if (!modelTable) {\n        // Revert consumed figure so other features can convert it.\n        conversionApi.consumable.revert(data.viewItem, {\n          name: true,\n          classes: 'table'\n        });\n        return;\n      }\n      conversionApi.convertChildren(data.viewItem, conversionApi.writer.createPositionAt(modelTable, 'end'));\n      conversionApi.updateConversionResult(modelTable, data);\n    });\n  };\n}\n/**\n * View table element to model table element conversion helper.\n *\n * This conversion helper converts the table element as well as table rows.\n *\n * @returns Conversion helper.\n */\nfunction upcastTable() {\n  return dispatcher => {\n    dispatcher.on('element:table', (evt, data, conversionApi) => {\n      const viewTable = data.viewItem;\n      // When element was already consumed then skip it.\n      if (!conversionApi.consumable.test(viewTable, {\n        name: true\n      })) {\n        return;\n      }\n      const {\n        rows,\n        headingRows,\n        headingColumns\n      } = scanTable(viewTable);\n      // Only set attributes if values is greater then 0.\n      const attributes = {};\n      if (headingColumns) {\n        attributes.headingColumns = headingColumns;\n      }\n      if (headingRows) {\n        attributes.headingRows = headingRows;\n      }\n      const table = conversionApi.writer.createElement('table', attributes);\n      if (!conversionApi.safeInsert(table, data.modelCursor)) {\n        return;\n      }\n      conversionApi.consumable.consume(viewTable, {\n        name: true\n      });\n      // Upcast table rows in proper order (heading rows first).\n      rows.forEach(row => conversionApi.convertItem(row, conversionApi.writer.createPositionAt(table, 'end')));\n      // Convert everything else.\n      conversionApi.convertChildren(viewTable, conversionApi.writer.createPositionAt(table, 'end'));\n      // Create one row and one table cell for empty table.\n      if (table.isEmpty) {\n        const row = conversionApi.writer.createElement('tableRow');\n        conversionApi.writer.insert(row, conversionApi.writer.createPositionAt(table, 'end'));\n        createEmptyTableCell(conversionApi.writer, conversionApi.writer.createPositionAt(row, 'end'));\n      }\n      conversionApi.updateConversionResult(table, data);\n    });\n  };\n}\n/**\n * A conversion helper that skips empty <tr> elements from upcasting at the beginning of the table.\n *\n * An empty row is considered a table model error but when handling clipboard data there could be rows that contain only row-spanned cells\n * and empty TR-s are used to maintain the table structure (also {@link module:table/tablewalker~TableWalker} assumes that there are only\n * rows that have related `tableRow` elements).\n *\n * *Note:* Only the first empty rows are removed because they have no meaning and it solves the issue\n * of an improper table with all empty rows.\n *\n * @returns Conversion helper.\n */\nfunction skipEmptyTableRow() {\n  return dispatcher => {\n    dispatcher.on('element:tr', (evt, data) => {\n      if (data.viewItem.isEmpty && data.modelCursor.index == 0) {\n        evt.stop();\n      }\n    }, {\n      priority: 'high'\n    });\n  };\n}\n/**\n * A converter that ensures an empty paragraph is inserted in a table cell if no other content was converted.\n *\n * @returns Conversion helper.\n */\nfunction ensureParagraphInTableCell(elementName) {\n  return dispatcher => {\n    dispatcher.on(`element:${elementName}`, (evt, data, {\n      writer\n    }) => {\n      // The default converter will create a model range on converted table cell.\n      if (!data.modelRange) {\n        return;\n      }\n      const tableCell = data.modelRange.start.nodeAfter;\n      const modelCursor = writer.createPositionAt(tableCell, 0);\n      // Ensure a paragraph in the model for empty table cells for converted table cells.\n      if (data.viewItem.isEmpty) {\n        writer.insertElement('paragraph', modelCursor);\n        return;\n      }\n      const childNodes = Array.from(tableCell.getChildren());\n      // In case there are only markers inside the table cell then move them to the paragraph.\n      if (childNodes.every(node => node.is('element', '$marker'))) {\n        const paragraph = writer.createElement('paragraph');\n        writer.insert(paragraph, writer.createPositionAt(tableCell, 0));\n        for (const node of childNodes) {\n          writer.move(writer.createRangeOn(node), writer.createPositionAt(paragraph, 'end'));\n        }\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * Get view `<table>` element from the view widget (`<figure>`).\n */\nfunction getViewTableFromFigure(figureView) {\n  for (const figureChild of figureView.getChildren()) {\n    if (figureChild.is('element', 'table')) {\n      return figureChild;\n    }\n  }\n}\n/**\n * Scans table rows and extracts required metadata from the table:\n *\n * headingRows    - The number of rows that go as table headers.\n * headingColumns - The maximum number of row headings.\n * rows           - Sorted `<tr>` elements as they should go into the model - ie. if `<thead>` is inserted after `<tbody>` in the view.\n */\nfunction scanTable(viewTable) {\n  let headingRows = 0;\n  let headingColumns = undefined;\n  // The `<tbody>` and `<thead>` sections in the DOM do not have to be in order `<thead>` -> `<tbody>` and there might be more than one\n  // of them.\n  // As the model does not have these sections, rows from different sections must be sorted.\n  // For example, below is a valid HTML table:\n  //\n  // <table>\n  //   <tbody><tr><td>2</td></tr></tbody>\n  //   <thead><tr><td>1</td></tr></thead>\n  //   <tbody><tr><td>3</td></tr></tbody>\n  // </table>\n  //\n  // But browsers will render rows in order as: 1 as the heading and 2 and 3 as the body.\n  const headRows = [];\n  const bodyRows = [];\n  // Currently the editor does not support more then one <thead> section.\n  // Only the first <thead> from the view will be used as a heading row and the others will be converted to body rows.\n  let firstTheadElement;\n  for (const tableChild of Array.from(viewTable.getChildren())) {\n    // Only `<thead>`, `<tbody>` & `<tfoot>` from allowed table children can have `<tr>`s.\n    // The else is for future purposes (mainly `<caption>`).\n    if (tableChild.name !== 'tbody' && tableChild.name !== 'thead' && tableChild.name !== 'tfoot') {\n      continue;\n    }\n    // Save the first `<thead>` in the table as table header - all other ones will be converted to table body rows.\n    if (tableChild.name === 'thead' && !firstTheadElement) {\n      firstTheadElement = tableChild;\n    }\n    // There might be some extra empty text nodes between the `<tr>`s.\n    // Make sure further code operates on `tr`s only. (#145)\n    const trs = Array.from(tableChild.getChildren()).filter(el => el.is('element', 'tr'));\n    // Keep tracking of the previous row columns count to improve detection of heading rows.\n    let maxPrevColumns = null;\n    for (const tr of trs) {\n      const trColumns = Array.from(tr.getChildren()).filter(el => el.is('element', 'td') || el.is('element', 'th'));\n      // This <tr> is a child of a first <thead> element.\n      if (firstTheadElement && tableChild === firstTheadElement || tableChild.name === 'tbody' && trColumns.length > 0 && (\n      // These conditions handles the case when the first column is a <th> element and it's the only column in the row.\n      // This case is problematic because it's not clear if this row should be a heading row or not, as it may be result\n      // of the cell span from the previous row.\n      // Issue: https://github.com/ckeditor/ckeditor5/issues/17556\n      maxPrevColumns === null || trColumns.length === maxPrevColumns) && trColumns.every(e => e.is('element', 'th'))) {\n        headingRows++;\n        headRows.push(tr);\n      } else {\n        bodyRows.push(tr);\n        // For other rows check how many column headings this row has.\n        const headingCols = scanRowForHeadingColumns(tr);\n        if (!headingColumns || headingCols < headingColumns) {\n          headingColumns = headingCols;\n        }\n      }\n      // We use the maximum number of columns to avoid false positives when detecting\n      // multiple rows with single column within `rowspan`. Without it the last row of `rowspan=3`\n      // would be detected as a heading row because it has only one column (identical to the previous row).\n      maxPrevColumns = Math.max(maxPrevColumns || 0, trColumns.length);\n    }\n  }\n  return {\n    headingRows,\n    headingColumns: headingColumns || 0,\n    rows: [...headRows, ...bodyRows]\n  };\n}\n/**\n * Scans a `<tr>` element and its children for metadata:\n * - For heading row:\n *     - Adds this row to either the heading or the body rows.\n *     - Updates the number of heading rows.\n * - For body rows:\n *     - Calculates the number of column headings.\n */\nfunction scanRowForHeadingColumns(tr) {\n  let headingColumns = 0;\n  let index = 0;\n  // Filter out empty text nodes from tr children.\n  const children = Array.from(tr.getChildren()).filter(child => child.name === 'th' || child.name === 'td');\n  // Count starting adjacent <th> elements of a <tr>.\n  while (index < children.length && children[index].name === 'th') {\n    const th = children[index];\n    // Adjust columns calculation by the number of spanned columns.\n    const colspan = parseInt(th.getAttribute('colspan') || '1');\n    headingColumns = headingColumns + colspan;\n    index++;\n  }\n  return headingColumns;\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module table/tablewalker\n    */ /**\n       * The table iterator class. It allows to iterate over table cells. For each cell the iterator yields\n       * {@link module:table/tablewalker~TableSlot} with proper table cell attributes.\n       */\nclass TableWalker {\n  /**\n  * The walker's table element.\n  *\n  * @internal\n  */\n  _table;\n  /**\n  * A row index from which this iterator will start.\n  */\n  _startRow;\n  /**\n  * A row index at which this iterator will end.\n  */\n  _endRow;\n  /**\n  * If set, the table walker will only output cells from a given column and following ones or cells that overlap them.\n  */\n  _startColumn;\n  /**\n  * If set, the table walker will only output cells up to a given column.\n  */\n  _endColumn;\n  /**\n  * Enables output of spanned cells that are normally not yielded.\n  */\n  _includeAllSlots;\n  /**\n  * Row indexes to skip from the iteration.\n  */\n  _skipRows;\n  /**\n  * The current row index.\n  *\n  * @internal\n  */\n  _row;\n  /**\n  * The index of the current row element in the table.\n  *\n  * @internal\n  */\n  _rowIndex;\n  /**\n  * The current column index.\n  *\n  * @internal\n  */\n  _column;\n  /**\n  * The cell index in a parent row. For spanned cells when {@link #_includeAllSlots} is set to `true`,\n  * this represents the index of the next table cell.\n  *\n  * @internal\n  */\n  _cellIndex;\n  /**\n  * Holds a map of spanned cells in a table.\n  */\n  _spannedCells;\n  /**\n  * Index of the next column where a cell is anchored.\n  */\n  _nextCellAtColumn;\n  /**\n  * Indicates whether the iterator jumped to (or close to) the start row, ignoring rows that don't need to be traversed.\n  */\n  _jumpedToStartRow = false;\n  /**\n  * Creates an instance of the table walker.\n  *\n  * The table walker iterates internally by traversing the table from row index = 0 and column index = 0.\n  * It walks row by row and column by column in order to output values defined in the constructor.\n  * By default it will output only the locations that are occupied by a cell. To include also spanned rows and columns,\n  * pass the `includeAllSlots` option to the constructor.\n  *\n  * The most important values of the iterator are column and row indexes of a cell.\n  *\n  * See {@link module:table/tablewalker~TableSlot} what values are returned by the table walker.\n  *\n  * To iterate over a given row:\n  *\n  * ```ts\n  * const tableWalker = new TableWalker( table, { startRow: 1, endRow: 2 } );\n  *\n  * for ( const tableSlot of tableWalker ) {\n  *   console.log( 'A cell at row', tableSlot.row, 'and column', tableSlot.column );\n  * }\n  * ```\n  *\n  * For instance the code above for the following table:\n  *\n  *  +----+----+----+----+----+----+\n  *  | 00      | 02 | 03 | 04 | 05 |\n  *  |         +----+----+----+----+\n  *  |         | 12      | 14 | 15 |\n  *  |         +----+----+----+    +\n  *  |         | 22           |    |\n  *  |----+----+----+----+----+    +\n  *  | 30 | 31 | 32 | 33 | 34 |    |\n  *  +----+----+----+----+----+----+\n  *\n  * will log in the console:\n  *\n  *  'A cell at row 1 and column 2'\n  *  'A cell at row 1 and column 4'\n  *  'A cell at row 1 and column 5'\n  *  'A cell at row 2 and column 2'\n  *\n  * To also iterate over spanned cells:\n  *\n  * ```ts\n  * const tableWalker = new TableWalker( table, { row: 1, includeAllSlots: true } );\n  *\n  * for ( const tableSlot of tableWalker ) {\n  *   console.log( 'Slot at', tableSlot.row, 'x', tableSlot.column, ':', tableSlot.isAnchor ? 'is anchored' : 'is spanned' );\n  * }\n  * ```\n  *\n  * will log in the console for the table from the previous example:\n  *\n  *  'Cell at 1 x 0 : is spanned'\n  *  'Cell at 1 x 1 : is spanned'\n  *  'Cell at 1 x 2 : is anchored'\n  *  'Cell at 1 x 3 : is spanned'\n  *  'Cell at 1 x 4 : is anchored'\n  *  'Cell at 1 x 5 : is anchored'\n  *\n  * **Note**: Option `row` is a shortcut that sets both `startRow` and `endRow` to the same row.\n  * (Use either `row` or `startRow` and `endRow` but never together). Similarly the `column` option sets both `startColumn`\n  * and `endColumn` to the same column (Use either `column` or `startColumn` and `endColumn` but never together).\n  *\n  * @param table A table over which the walker iterates.\n  * @param options An object with configuration.\n  * @param options.row A row index for which this iterator will output cells. Can't be used together with `startRow` and `endRow`.\n  * @param options.startRow A row index from which this iterator should start. Can't be used together with `row`. Default value is 0.\n  * @param options.endRow A row index at which this iterator should end. Can't be used together with `row`.\n  * @param options.column A column index for which this iterator will output cells.\n  * Can't be used together with `startColumn` and `endColumn`.\n  * @param options.startColumn A column index from which this iterator should start.\n  * Can't be used together with `column`. Default value is 0.\n  * @param options.endColumn A column index at which this iterator should end. Can't be used together with `column`.\n  * @param options.includeAllSlots Also return values for spanned cells. Default value is \"false\".\n  */\n  constructor(table, options = {}) {\n    this._table = table;\n    this._startRow = options.row !== undefined ? options.row : options.startRow || 0;\n    this._endRow = options.row !== undefined ? options.row : options.endRow;\n    this._startColumn = options.column !== undefined ? options.column : options.startColumn || 0;\n    this._endColumn = options.column !== undefined ? options.column : options.endColumn;\n    this._includeAllSlots = !!options.includeAllSlots;\n    this._skipRows = new Set();\n    this._row = 0;\n    this._rowIndex = 0;\n    this._column = 0;\n    this._cellIndex = 0;\n    this._spannedCells = new Map();\n    this._nextCellAtColumn = -1;\n  }\n  /**\n  * Iterable interface.\n  */\n  [Symbol.iterator]() {\n    return this;\n  }\n  /**\n  * Gets the next table walker's value.\n  *\n  * @returns The next table walker's value.\n  */\n  next() {\n    if (this._canJumpToStartRow()) {\n      this._jumpToNonSpannedRowClosestToStartRow();\n    }\n    const row = this._table.getChild(this._rowIndex);\n    // Iterator is done when there's no row (table ended) or the row is after `endRow` limit.\n    if (!row || this._isOverEndRow()) {\n      return {\n        done: true,\n        value: undefined\n      };\n    }\n    // We step over current element when it is not a tableRow instance.\n    if (!row.is('element', 'tableRow')) {\n      this._rowIndex++;\n      return this.next();\n    }\n    if (this._isOverEndColumn()) {\n      return this._advanceToNextRow();\n    }\n    let outValue = null;\n    const spanData = this._getSpanned();\n    if (spanData) {\n      if (this._includeAllSlots && !this._shouldSkipSlot()) {\n        outValue = this._formatOutValue(spanData.cell, spanData.row, spanData.column);\n      }\n    } else {\n      const cell = row.getChild(this._cellIndex);\n      if (!cell) {\n        // If there are no more cells left in row advance to the next row.\n        return this._advanceToNextRow();\n      }\n      const colspan = parseInt(cell.getAttribute('colspan') || '1');\n      const rowspan = parseInt(cell.getAttribute('rowspan') || '1');\n      // Record this cell spans if it's not 1x1 cell.\n      if (colspan > 1 || rowspan > 1) {\n        this._recordSpans(cell, rowspan, colspan);\n      }\n      if (!this._shouldSkipSlot()) {\n        outValue = this._formatOutValue(cell);\n      }\n      this._nextCellAtColumn = this._column + colspan;\n    }\n    // Advance to the next column before returning value.\n    this._column++;\n    if (this._column == this._nextCellAtColumn) {\n      this._cellIndex++;\n    }\n    // The current value will be returned only if current row and column are not skipped.\n    return outValue || this.next();\n  }\n  /**\n  * Marks a row to skip in the next iteration. It will also skip cells from the current row if there are any cells from the current row\n  * to output.\n  *\n  * @param row The row index to skip.\n  */\n  skipRow(row) {\n    this._skipRows.add(row);\n  }\n  /**\n  * Advances internal cursor to the next row.\n  */\n  _advanceToNextRow() {\n    this._row++;\n    this._rowIndex++;\n    this._column = 0;\n    this._cellIndex = 0;\n    this._nextCellAtColumn = -1;\n    return this.next();\n  }\n  /**\n  * Checks if the current row is over {@link #_endRow}.\n  */\n  _isOverEndRow() {\n    // If #_endRow is defined skip all rows after it.\n    return this._endRow !== undefined && this._row > this._endRow;\n  }\n  /**\n  * Checks if the current cell is over {@link #_endColumn}\n  */\n  _isOverEndColumn() {\n    // If #_endColumn is defined skip all cells after it.\n    return this._endColumn !== undefined && this._column > this._endColumn;\n  }\n  /**\n  * A common method for formatting the iterator's output value.\n  *\n  * @param cell The table cell to output.\n  * @param anchorRow The row index of a cell anchor slot.\n  * @param anchorColumn The column index of a cell anchor slot.\n  */\n  _formatOutValue(cell, anchorRow = this._row, anchorColumn = this._column) {\n    return {\n      done: false,\n      value: new TableSlot(this, cell, anchorRow, anchorColumn)\n    };\n  }\n  /**\n  * Checks if the current slot should be skipped.\n  */\n  _shouldSkipSlot() {\n    const rowIsMarkedAsSkipped = this._skipRows.has(this._row);\n    const rowIsBeforeStartRow = this._row < this._startRow;\n    const columnIsBeforeStartColumn = this._column < this._startColumn;\n    const columnIsAfterEndColumn = this._endColumn !== undefined && this._column > this._endColumn;\n    return rowIsMarkedAsSkipped || rowIsBeforeStartRow || columnIsBeforeStartColumn || columnIsAfterEndColumn;\n  }\n  /**\n  * Returns the cell element that is spanned over the current cell location.\n  */\n  _getSpanned() {\n    const rowMap = this._spannedCells.get(this._row);\n    // No spans for given row.\n    if (!rowMap) {\n      return null;\n    }\n    // If spans for given rows has entry for column it means that this location if spanned by other cell.\n    return rowMap.get(this._column) || null;\n  }\n  /**\n  * Updates spanned cells map relative to the current cell location and its span dimensions.\n  *\n  * @param cell A cell that is spanned.\n  * @param rowspan Cell height.\n  * @param colspan Cell width.\n  */\n  _recordSpans(cell, rowspan, colspan) {\n    const data = {\n      cell,\n      row: this._row,\n      column: this._column\n    };\n    for (let rowToUpdate = this._row; rowToUpdate < this._row + rowspan; rowToUpdate++) {\n      for (let columnToUpdate = this._column; columnToUpdate < this._column + colspan; columnToUpdate++) {\n        if (rowToUpdate != this._row || columnToUpdate != this._column) {\n          this._markSpannedCell(rowToUpdate, columnToUpdate, data);\n        }\n      }\n    }\n  }\n  /**\n  * Marks the cell location as spanned by another cell.\n  *\n  * @param row The row index of the cell location.\n  * @param column The column index of the cell location.\n  * @param data A spanned cell details (cell element, anchor row and column).\n  */\n  _markSpannedCell(row, column, data) {\n    if (!this._spannedCells.has(row)) {\n      this._spannedCells.set(row, new Map());\n    }\n    const rowSpans = this._spannedCells.get(row);\n    rowSpans.set(column, data);\n  }\n  /**\n  * Checks if part of the table can be skipped.\n  */\n  _canJumpToStartRow() {\n    return !!this._startRow && this._startRow > 0 && !this._jumpedToStartRow;\n  }\n  /**\n  * Sets the current row to `this._startRow` or the first row before it that has the number of cells\n  * equal to the number of columns in the table.\n  *\n  * Example:\n  * \t+----+----+----+\n  *  | 00 | 01 | 02 |\n  *  |----+----+----+\n  *  | 10      | 12 |\n  *  |         +----+\n  *  |         | 22 |\n  *  |         +----+\n  *  |         | 32 | <--- Start row\n  *  +----+----+----+\n  *  | 40 | 41 | 42 |\n  *  +----+----+----+\n  *\n  * If the 4th row is a `this._startRow`, this method will:\n  * 1.) Count the number of columns this table has based on the first row (3 columns in this case).\n  * 2.) Check if the 4th row contains 3 cells. It doesn't, so go to the row before it.\n  * 3.) Check if the 3rd row contains 3 cells. It doesn't, so go to the row before it.\n  * 4.) Check if the 2nd row contains 3 cells. It does, so set the current row to that row.\n  *\n  * Setting the current row this way is necessary to let the `next()`  method loop over the cells\n  * spanning multiple rows or columns and update the `this._spannedCells` property.\n  */\n  _jumpToNonSpannedRowClosestToStartRow() {\n    const firstRowLength = this._getRowLength(0);\n    for (let i = this._startRow; !this._jumpedToStartRow; i--) {\n      if (firstRowLength === this._getRowLength(i)) {\n        this._row = i;\n        this._rowIndex = i;\n        this._jumpedToStartRow = true;\n      }\n    }\n  }\n  /**\n  * Returns a number of columns in a row taking `colspan` into consideration.\n  */\n  _getRowLength(rowIndex) {\n    const row = this._table.getChild(rowIndex);\n    return [...row.getChildren()].reduce((cols, row) => {\n      return cols + parseInt(row.getAttribute('colspan') || '1');\n    }, 0);\n  }\n}\n/**\n * An object returned by {@link module:table/tablewalker~TableWalker} when traversing table cells.\n */\nclass TableSlot {\n  /**\n  * The current table cell.\n  */\n  cell;\n  /**\n  * The row index of a table slot.\n  */\n  row;\n  /**\n  * The column index of a table slot.\n  */\n  column;\n  /**\n  * The row index of a cell anchor slot.\n  */\n  cellAnchorRow;\n  /**\n  * The column index of a cell anchor slot.\n  */\n  cellAnchorColumn;\n  /**\n  * The index of the current cell in the parent row.\n  */\n  _cellIndex;\n  /**\n  * The index of the current row element in the table.\n  */\n  _rowIndex;\n  /**\n  * The table element.\n  */\n  _table;\n  /**\n  * Creates an instance of the table walker value.\n  *\n  * @param tableWalker The table walker instance.\n  * @param cell The current table cell.\n  * @param anchorRow The row index of a cell anchor slot.\n  * @param anchorColumn The column index of a cell anchor slot.\n  */\n  constructor(tableWalker, cell, anchorRow, anchorColumn) {\n    this.cell = cell;\n    this.row = tableWalker._row;\n    this.column = tableWalker._column;\n    this.cellAnchorRow = anchorRow;\n    this.cellAnchorColumn = anchorColumn;\n    this._cellIndex = tableWalker._cellIndex;\n    this._rowIndex = tableWalker._rowIndex;\n    this._table = tableWalker._table;\n  }\n  // @if CK_DEBUG // public get isSpanned(): unknown { return throwMissingGetterError( 'isSpanned' ); }\n  // @if CK_DEBUG // public get colspan(): unknown { return throwMissingGetterError( 'colspan' ); }\n  // @if CK_DEBUG // public get rowspan(): unknown { return throwMissingGetterError( 'rowspan' ); }\n  // @if CK_DEBUG // public get cellIndex(): unknown { return throwMissingGetterError( 'cellIndex' ); }\n  /**\n  * Whether the cell is anchored in the current slot.\n  */\n  get isAnchor() {\n    return this.row === this.cellAnchorRow && this.column === this.cellAnchorColumn;\n  }\n  /**\n  * The width of a cell defined by a `colspan` attribute. If the model attribute is not present, it is set to `1`.\n  */\n  get cellWidth() {\n    return parseInt(this.cell.getAttribute('colspan') || '1');\n  }\n  /**\n  * The height of a cell defined by a `rowspan` attribute. If the model attribute is not present, it is set to `1`.\n  */\n  get cellHeight() {\n    return parseInt(this.cell.getAttribute('rowspan') || '1');\n  }\n  /**\n  * The index of the current row element in the table.\n  */\n  get rowIndex() {\n    return this._rowIndex;\n  }\n  /**\n  * Returns the {@link module:engine/model/position~Position} before the table slot.\n  */\n  getPositionBefore() {\n    const model = this._table.root.document.model;\n    return model.createPositionAt(this._table.getChild(this.row), this._cellIndex);\n  }\n}\n/**\n* This `TableSlot`'s getter (property) was removed in CKEditor 5 v20.0.0.\n*\n* Check out the new `TableWalker`'s API in the documentation.\n*\n* @error tableslot-getter-removed\n* @param getterName\n*/ // @if CK_DEBUG // function throwMissingGetterError( getterName: string ): void {\n// @if CK_DEBUG //\t\tthrow new CKEditorError( 'tableslot-getter-removed', null, {\n// @if CK_DEBUG //\t\t\tgetterName\n// @if CK_DEBUG //\t\t} );\n// @if CK_DEBUG // }\n\n/**\n * Model table element to view table element conversion helper.\n */\nfunction downcastTable(tableUtils, options) {\n  return (table, {\n    writer\n  }) => {\n    const headingRows = table.getAttribute('headingRows') || 0;\n    const tableElement = writer.createContainerElement('table', null, []);\n    const figureElement = writer.createContainerElement('figure', {\n      class: 'table'\n    }, tableElement);\n    // Table head slot.\n    if (headingRows > 0) {\n      writer.insert(writer.createPositionAt(tableElement, 'end'), writer.createContainerElement('thead', null, writer.createSlot(element => element.is('element', 'tableRow') && element.index < headingRows)));\n    }\n    // Table body slot.\n    if (headingRows < tableUtils.getRows(table)) {\n      writer.insert(writer.createPositionAt(tableElement, 'end'), writer.createContainerElement('tbody', null, writer.createSlot(element => element.is('element', 'tableRow') && element.index >= headingRows)));\n    }\n    // Dynamic slots.\n    for (const {\n      positionOffset,\n      filter\n    } of options.additionalSlots) {\n      writer.insert(writer.createPositionAt(tableElement, positionOffset), writer.createSlot(filter));\n    }\n    // Create a slot with items that don't fit into the table.\n    writer.insert(writer.createPositionAt(tableElement, 'after'), writer.createSlot(element => {\n      if (element.is('element', 'tableRow')) {\n        return false;\n      }\n      return !options.additionalSlots.some(({\n        filter\n      }) => filter(element));\n    }));\n    return options.asWidget ? toTableWidget(figureElement, writer) : figureElement;\n  };\n}\n/**\n * Model table row element to view `<tr>` element conversion helper.\n *\n * @returns Element creator.\n */\nfunction downcastRow() {\n  return (tableRow, {\n    writer\n  }) => {\n    return tableRow.isEmpty ? writer.createEmptyElement('tr') : writer.createContainerElement('tr');\n  };\n}\n/**\n * Model table cell element to view `<td>` or `<th>` element conversion helper.\n *\n * This conversion helper will create proper `<th>` elements for table cells that are in the heading section (heading row or column)\n * and `<td>` otherwise.\n *\n * @param options.asWidget If set to `true`, the downcast conversion will produce a widget.\n * @returns Element creator.\n */\nfunction downcastCell(options = {}) {\n  return (tableCell, {\n    writer\n  }) => {\n    const tableRow = tableCell.parent;\n    const table = tableRow.parent;\n    const rowIndex = table.getChildIndex(tableRow);\n    const tableWalker = new TableWalker(table, {\n      row: rowIndex\n    });\n    const headingRows = table.getAttribute('headingRows') || 0;\n    const headingColumns = table.getAttribute('headingColumns') || 0;\n    let result = null;\n    // We need to iterate over a table in order to get proper row & column values from a walker.\n    for (const tableSlot of tableWalker) {\n      if (tableSlot.cell == tableCell) {\n        const isHeading = tableSlot.row < headingRows || tableSlot.column < headingColumns;\n        const cellElementName = isHeading ? 'th' : 'td';\n        result = options.asWidget ? toWidgetEditable(writer.createEditableElement(cellElementName), writer, {\n          withAriaRole: false\n        }) : writer.createContainerElement(cellElementName);\n        break;\n      }\n    }\n    return result;\n  };\n}\n/**\n * Overrides paragraph inside table cell conversion.\n *\n * This converter:\n * * should be used to override default paragraph conversion.\n * * It will only convert `<paragraph>` placed directly inside `<tableCell>`.\n * * For a single paragraph without attributes it returns `<span>` to simulate data table.\n * * For all other cases it returns `<p>` element.\n *\n * @param options.asWidget If set to `true`, the downcast conversion will produce a widget.\n * @returns Element creator.\n */\nfunction convertParagraphInTableCell(options = {}) {\n  return (modelElement, {\n    writer\n  }) => {\n    if (!modelElement.parent.is('element', 'tableCell')) {\n      return null;\n    }\n    if (!isSingleParagraphWithoutAttributes(modelElement)) {\n      return null;\n    }\n    if (options.asWidget) {\n      return writer.createContainerElement('span', {\n        class: 'ck-table-bogus-paragraph'\n      });\n    } else {\n      // Using `<p>` in case there are some markers on it and transparentRendering will render it anyway.\n      const viewElement = writer.createContainerElement('p');\n      writer.setCustomProperty('dataPipeline:transparentRendering', true, viewElement);\n      return viewElement;\n    }\n  };\n}\n/**\n * Checks if given model `<paragraph>` is an only child of a parent (`<tableCell>`) and if it has any attribute set.\n *\n * The paragraph should be converted in the editing view to:\n *\n * * If returned `true` - to a `<span class=\"ck-table-bogus-paragraph\">`\n * * If returned `false` - to a `<p>`\n */\nfunction isSingleParagraphWithoutAttributes(modelElement) {\n  const tableCell = modelElement.parent;\n  const isSingleParagraph = tableCell.childCount == 1;\n  return isSingleParagraph && !hasAnyAttribute(modelElement);\n}\n/**\n * Converts a given {@link module:engine/view/element~Element} to a table widget:\n * * Adds a {@link module:engine/view/element~Element#_setCustomProperty custom property} allowing to recognize the table widget element.\n * * Calls the {@link module:widget/utils~toWidget} function with the proper element's label creator.\n *\n * @param writer An instance of the view writer.\n * @param label The element's label. It will be concatenated with the table `alt` attribute if one is present.\n */\nfunction toTableWidget(viewElement, writer) {\n  writer.setCustomProperty('table', true, viewElement);\n  return toWidget(viewElement, writer, {\n    hasSelectionHandle: true\n  });\n}\n/**\n * Checks if an element has any attributes set.\n */\nfunction hasAnyAttribute(element) {\n  for (const attributeKey of element.getAttributeKeys()) {\n    // Ignore selection attributes stored on block elements.\n    if (attributeKey.startsWith('selection:') || attributeKey == 'htmlEmptyBlock') {\n      continue;\n    }\n    return true;\n  }\n  return false;\n}\n\n/**\n * The insert table command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'insertTable'` editor command.\n *\n * To insert a table at the current selection, execute the command and specify the dimensions:\n *\n * ```ts\n * editor.execute( 'insertTable', { rows: 20, columns: 5 } );\n * ```\n */\nclass InsertTableCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const schema = model.schema;\n    this.isEnabled = isAllowedInParent$1(selection, schema);\n  }\n  /**\n  * Executes the command.\n  *\n  * Inserts a table with the given number of rows and columns into the editor.\n  *\n  * @param options.rows The number of rows to create in the inserted table. Default value is 2.\n  * @param options.columns The number of columns to create in the inserted table. Default value is 2.\n  * @param options.headingRows The number of heading rows. If not provided it will default to\n  * {@link module:table/tableconfig~TableConfig#defaultHeadings `config.table.defaultHeadings.rows`} table config.\n  * @param options.headingColumns The number of heading columns. If not provided it will default to\n  * {@link module:table/tableconfig~TableConfig#defaultHeadings `config.table.defaultHeadings.columns`} table config.\n  * @fires execute\n  */\n  execute(options = {}) {\n    const editor = this.editor;\n    const model = editor.model;\n    const tableUtils = editor.plugins.get('TableUtils');\n    const defaultRows = editor.config.get('table.defaultHeadings.rows');\n    const defaultColumns = editor.config.get('table.defaultHeadings.columns');\n    if (options.headingRows === undefined && defaultRows) {\n      options.headingRows = defaultRows;\n    }\n    if (options.headingColumns === undefined && defaultColumns) {\n      options.headingColumns = defaultColumns;\n    }\n    model.change(writer => {\n      const table = tableUtils.createTable(writer, options);\n      model.insertObject(table, null, null, {\n        findOptimalPosition: 'auto'\n      });\n      writer.setSelection(writer.createPositionAt(table.getNodeByPath([0, 0, 0]), 0));\n    });\n  }\n}\n/**\n * Checks if the table is allowed in the parent.\n */\nfunction isAllowedInParent$1(selection, schema) {\n  const positionParent = selection.getFirstPosition().parent;\n  const validParent = positionParent === positionParent.root ? positionParent : positionParent.parent;\n  return schema.checkChild(validParent, 'table');\n}\n\n/**\n * The insert row command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'insertTableRowBelow'` and\n * `'insertTableRowAbove'` editor commands.\n *\n * To insert a row below the selected cell, execute the following command:\n *\n * ```ts\n * editor.execute( 'insertTableRowBelow' );\n * ```\n *\n * To insert a row above the selected cell, execute the following command:\n *\n * ```ts\n * editor.execute( 'insertTableRowAbove' );\n * ```\n */\nclass InsertRowCommand extends Command {\n  /**\n  * The order of insertion relative to the row in which the caret is located.\n  */\n  order;\n  /**\n  * Creates a new `InsertRowCommand` instance.\n  *\n  * @param editor The editor on which this command will be used.\n  * @param options.order The order of insertion relative to the row in which the caret is located.\n  * Possible values: `\"above\"` and `\"below\"`. Default value is \"below\"\n  */\n  constructor(editor, options = {}) {\n    super(editor);\n    this.order = options.order || 'below';\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const selection = this.editor.model.document.selection;\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const isAnyCellSelected = !!tableUtils.getSelectionAffectedTableCells(selection).length;\n    this.isEnabled = isAnyCellSelected;\n  }\n  /**\n  * Executes the command.\n  *\n  * Depending on the command's {@link #order} value, it inserts a row `'below'` or `'above'` the row in which selection is set.\n  *\n  * @fires execute\n  */\n  execute() {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    const tableUtils = editor.plugins.get('TableUtils');\n    const insertAbove = this.order === 'above';\n    const affectedTableCells = tableUtils.getSelectionAffectedTableCells(selection);\n    const rowIndexes = tableUtils.getRowIndexes(affectedTableCells);\n    const row = insertAbove ? rowIndexes.first : rowIndexes.last;\n    const table = affectedTableCells[0].findAncestor('table');\n    tableUtils.insertRows(table, {\n      at: insertAbove ? row : row + 1,\n      copyStructureFromAbove: !insertAbove\n    });\n  }\n}\n\n/**\n * The insert column command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'insertTableColumnLeft'` and\n * `'insertTableColumnRight'` editor commands.\n *\n * To insert a column to the left of the selected cell, execute the following command:\n *\n * ```ts\n * editor.execute( 'insertTableColumnLeft' );\n * ```\n *\n * To insert a column to the right of the selected cell, execute the following command:\n *\n * ```ts\n * editor.execute( 'insertTableColumnRight' );\n * ```\n */\nclass InsertColumnCommand extends Command {\n  /**\n  * The order of insertion relative to the column in which the caret is located.\n  */\n  order;\n  /**\n  * Creates a new `InsertColumnCommand` instance.\n  *\n  * @param editor An editor on which this command will be used.\n  * @param options.order The order of insertion relative to the column in which the caret is located.\n  * Possible values: `\"left\"` and `\"right\"`. Default value is \"right\".\n  */\n  constructor(editor, options = {}) {\n    super(editor);\n    this.order = options.order || 'right';\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const selection = this.editor.model.document.selection;\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const isAnyCellSelected = !!tableUtils.getSelectionAffectedTableCells(selection).length;\n    this.isEnabled = isAnyCellSelected;\n  }\n  /**\n  * Executes the command.\n  *\n  * Depending on the command's {@link #order} value, it inserts a column to the `'left'` or `'right'` of the column\n  * in which the selection is set.\n  *\n  * @fires execute\n  */\n  execute() {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    const tableUtils = editor.plugins.get('TableUtils');\n    const insertBefore = this.order === 'left';\n    const affectedTableCells = tableUtils.getSelectionAffectedTableCells(selection);\n    const columnIndexes = tableUtils.getColumnIndexes(affectedTableCells);\n    const column = insertBefore ? columnIndexes.first : columnIndexes.last;\n    const table = affectedTableCells[0].findAncestor('table');\n    tableUtils.insertColumns(table, {\n      columns: 1,\n      at: insertBefore ? column : column + 1\n    });\n  }\n}\n\n/**\n * The split cell command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'splitTableCellVertically'`\n * and `'splitTableCellHorizontally'`  editor commands.\n *\n * You can split any cell vertically or horizontally by executing this command. For example, to split the selected table cell vertically:\n *\n * ```ts\n * editor.execute( 'splitTableCellVertically' );\n * ```\n */\nclass SplitCellCommand extends Command {\n  /**\n  * The direction that indicates which cell will be split.\n  */\n  direction;\n  /**\n  * Creates a new `SplitCellCommand` instance.\n  *\n  * @param editor The editor on which this command will be used.\n  * @param options.direction Indicates whether the command should split cells `'horizontally'` or `'vertically'`.\n  */\n  constructor(editor, options = {}) {\n    super(editor);\n    this.direction = options.direction || 'horizontally';\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const selectedCells = tableUtils.getSelectionAffectedTableCells(this.editor.model.document.selection);\n    this.isEnabled = selectedCells.length === 1;\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const tableCell = tableUtils.getSelectionAffectedTableCells(this.editor.model.document.selection)[0];\n    const isHorizontal = this.direction === 'horizontally';\n    if (isHorizontal) {\n      tableUtils.splitCellHorizontally(tableCell, 2);\n    } else {\n      tableUtils.splitCellVertically(tableCell, 2);\n    }\n  }\n}\n\n/**\n * Returns a cropped table according to given dimensions.\n\n * To return a cropped table that starts at first row and first column and end in third row and column:\n *\n * ```ts\n * const croppedTable = cropTableToDimensions( table, {\n *   startRow: 1,\n *   endRow: 3,\n *   startColumn: 1,\n *   endColumn: 3\n * }, writer );\n * ```\n *\n * Calling the code above for the table below:\n *\n *        0   1   2   3   4                      0   1   2\n *      â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”\n *   0  â”‚ a â”‚ b â”‚ c â”‚ d â”‚ e â”‚\n *      â”œâ”€â”€â”€â”´â”€â”€â”€â”¤   â”œâ”€â”€â”€â”´â”€â”€â”€â”¤                  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”\n *   1  â”‚ f     â”‚   â”‚ g     â”‚                  â”‚   â”‚   â”‚ g â”‚  0\n *      â”œâ”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¤   will return:   â”œâ”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”¤\n *   2  â”‚ h â”‚ i     â”‚ j â”‚ k â”‚                  â”‚ i     â”‚ j â”‚  1\n *      â”œâ”€â”€â”€â”¤       â”œâ”€â”€â”€â”¤   â”‚                  â”‚       â”œâ”€â”€â”€â”¤\n *   3  â”‚ l â”‚       â”‚ m â”‚   â”‚                  â”‚       â”‚ m â”‚  2\n *      â”œâ”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¤   â”œâ”€â”€â”€â”¤                  â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”˜\n *   4  â”‚ n â”‚ o â”‚ p â”‚   â”‚ q â”‚\n *      â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜\n */\nfunction cropTableToDimensions(sourceTable, cropDimensions, writer) {\n  const {\n    startRow,\n    startColumn,\n    endRow,\n    endColumn\n  } = cropDimensions;\n  // Initialize the cropped table element.\n  const croppedTable = writer.createElement('table');\n  // Copy table type attribute if present.\n  const sourceTableType = sourceTable.getAttribute('tableType');\n  if (sourceTableType) {\n    writer.setAttribute('tableType', sourceTableType, croppedTable);\n  }\n  // Create empty table with empty rows equal to crop height.\n  const cropHeight = endRow - startRow + 1;\n  for (let i = 0; i < cropHeight; i++) {\n    writer.insertElement('tableRow', croppedTable, 'end');\n  }\n  const tableMap = [...new TableWalker(sourceTable, {\n    startRow,\n    endRow,\n    startColumn,\n    endColumn,\n    includeAllSlots: true\n  })];\n  // Iterate over source table slots (including empty - spanned - ones).\n  for (const {\n    row: sourceRow,\n    column: sourceColumn,\n    cell: tableCell,\n    isAnchor,\n    cellAnchorRow,\n    cellAnchorColumn\n  } of tableMap) {\n    // Row index in cropped table.\n    const rowInCroppedTable = sourceRow - startRow;\n    const row = croppedTable.getChild(rowInCroppedTable);\n    // For empty slots: fill the gap with empty table cell.\n    if (!isAnchor) {\n      // But fill the gap only if the spanning cell is anchored outside cropped area.\n      // In the table from method jsdoc those cells are: \"c\" & \"f\".\n      if (cellAnchorRow < startRow || cellAnchorColumn < startColumn) {\n        createEmptyTableCell(writer, writer.createPositionAt(row, 'end'));\n      }\n    } else {\n      const tableCellCopy = writer.cloneElement(tableCell);\n      writer.append(tableCellCopy, row);\n      // Trim table if it exceeds cropped area.\n      // In the table from method jsdoc those cells are: \"g\" & \"m\".\n      trimTableCellIfNeeded(tableCellCopy, sourceRow, sourceColumn, endRow, endColumn, writer);\n    }\n  }\n  // Adjust heading rows & columns in cropped table if crop selection includes headings parts.\n  addHeadingsToCroppedTable(croppedTable, sourceTable, startRow, startColumn, writer);\n  return croppedTable;\n}\n/**\n * Returns slot info of cells that starts above and overlaps a given row.\n *\n * In a table below, passing `overlapRow = 3`\n *\n *     â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”\n *  0  â”‚ a â”‚ b â”‚ c â”‚ d â”‚ e â”‚\n *     â”‚   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤\n *  1  â”‚   â”‚ f â”‚ g â”‚ h â”‚ i â”‚\n *     â”œâ”€â”€â”€â”¤   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¤   â”‚\n *  2  â”‚ j â”‚   â”‚ k â”‚ l â”‚   â”‚\n *     â”‚   â”‚   â”‚   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¤\n *  3  â”‚   â”‚   â”‚   â”‚ m â”‚ n â”‚  <- overlap row to check\n *     â”œâ”€â”€â”€â”¼â”€â”€â”€â”¤   â”‚   â”œâ”€â”€â”€â”‚\n *  4  â”‚ o â”‚ p â”‚   â”‚   â”‚ q â”‚\n *     â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜\n *\n * will return slot info for cells: \"j\", \"f\", \"k\".\n *\n * @param table The table to check.\n * @param overlapRow The index of the row to check.\n * @param startRow row to start analysis. Use it when it is known that the cells above that row will not overlap. Default value is 0.\n */\nfunction getVerticallyOverlappingCells(table, overlapRow, startRow = 0) {\n  const cells = [];\n  const tableWalker = new TableWalker(table, {\n    startRow,\n    endRow: overlapRow - 1\n  });\n  for (const slotInfo of tableWalker) {\n    const {\n      row,\n      cellHeight\n    } = slotInfo;\n    const cellEndRow = row + cellHeight - 1;\n    if (row < overlapRow && overlapRow <= cellEndRow) {\n      cells.push(slotInfo);\n    }\n  }\n  return cells;\n}\n/**\n * Splits the table cell horizontally.\n *\n * @returns Created table cell, if any were created.\n */\nfunction splitHorizontally(tableCell, splitRow, writer) {\n  const tableRow = tableCell.parent;\n  const table = tableRow.parent;\n  const rowIndex = tableRow.index;\n  const rowspan = parseInt(tableCell.getAttribute('rowspan'));\n  const newRowspan = splitRow - rowIndex;\n  const newCellAttributes = {};\n  const newCellRowSpan = rowspan - newRowspan;\n  if (newCellRowSpan > 1) {\n    newCellAttributes.rowspan = newCellRowSpan;\n  }\n  const colspan = parseInt(tableCell.getAttribute('colspan') || '1');\n  if (colspan > 1) {\n    newCellAttributes.colspan = colspan;\n  }\n  const startRow = rowIndex;\n  const endRow = startRow + newRowspan;\n  const tableMap = [...new TableWalker(table, {\n    startRow,\n    endRow,\n    includeAllSlots: true\n  })];\n  let newCell = null;\n  let columnIndex;\n  for (const tableSlot of tableMap) {\n    const {\n      row,\n      column,\n      cell\n    } = tableSlot;\n    if (cell === tableCell && columnIndex === undefined) {\n      columnIndex = column;\n    }\n    if (columnIndex !== undefined && columnIndex === column && row === endRow) {\n      newCell = createEmptyTableCell(writer, tableSlot.getPositionBefore(), newCellAttributes);\n    }\n  }\n  // Update the rowspan attribute after updating table.\n  updateNumericAttribute('rowspan', newRowspan, tableCell, writer);\n  return newCell;\n}\n/**\n * Returns slot info of cells that starts before and overlaps a given column.\n *\n * In a table below, passing `overlapColumn = 3`\n *\n *    0   1   2   3   4\n *  â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”\n *  â”‚ a     â”‚ b     â”‚ c â”‚\n *  â”‚â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤\n *  â”‚ d â”‚ e         â”‚ f â”‚\n *  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”¤\n *  â”‚ g â”‚ h â”‚ i         â”‚\n *  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¤\n *  â”‚ j â”‚ k â”‚ l â”‚ m     â”‚\n *  â”œâ”€â”€â”€â”¼â”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¤\n *  â”‚ n â”‚ o     â”‚ p â”‚ q â”‚\n *  â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜\n *                ^\n *                Overlap column to check\n *\n * will return slot info for cells: \"b\", \"e\", \"i\".\n *\n * @param table The table to check.\n * @param overlapColumn The index of the column to check.\n */\nfunction getHorizontallyOverlappingCells(table, overlapColumn) {\n  const cellsToSplit = [];\n  const tableWalker = new TableWalker(table);\n  for (const slotInfo of tableWalker) {\n    const {\n      column,\n      cellWidth\n    } = slotInfo;\n    const cellEndColumn = column + cellWidth - 1;\n    if (column < overlapColumn && overlapColumn <= cellEndColumn) {\n      cellsToSplit.push(slotInfo);\n    }\n  }\n  return cellsToSplit;\n}\n/**\n * Splits the table cell vertically.\n *\n * @param columnIndex The table cell column index.\n * @param splitColumn The index of column to split cell on.\n * @returns Created table cell.\n */\nfunction splitVertically(tableCell, columnIndex, splitColumn, writer) {\n  const colspan = parseInt(tableCell.getAttribute('colspan'));\n  const newColspan = splitColumn - columnIndex;\n  const newCellAttributes = {};\n  const newCellColSpan = colspan - newColspan;\n  if (newCellColSpan > 1) {\n    newCellAttributes.colspan = newCellColSpan;\n  }\n  const rowspan = parseInt(tableCell.getAttribute('rowspan') || '1');\n  if (rowspan > 1) {\n    newCellAttributes.rowspan = rowspan;\n  }\n  const newCell = createEmptyTableCell(writer, writer.createPositionAfter(tableCell), newCellAttributes);\n  // Update the colspan attribute after updating table.\n  updateNumericAttribute('colspan', newColspan, tableCell, writer);\n  return newCell;\n}\n/**\n * Adjusts table cell dimensions to not exceed limit row and column.\n *\n * If table cell width (or height) covers a column (or row) that is after a limit column (or row)\n * this method will trim \"colspan\" (or \"rowspan\") attribute so the table cell will fit in a defined limits.\n */\nfunction trimTableCellIfNeeded(tableCell, cellRow, cellColumn, limitRow, limitColumn, writer) {\n  const colspan = parseInt(tableCell.getAttribute('colspan') || '1');\n  const rowspan = parseInt(tableCell.getAttribute('rowspan') || '1');\n  const endColumn = cellColumn + colspan - 1;\n  if (endColumn > limitColumn) {\n    const trimmedSpan = limitColumn - cellColumn + 1;\n    updateNumericAttribute('colspan', trimmedSpan, tableCell, writer, 1);\n  }\n  const endRow = cellRow + rowspan - 1;\n  if (endRow > limitRow) {\n    const trimmedSpan = limitRow - cellRow + 1;\n    updateNumericAttribute('rowspan', trimmedSpan, tableCell, writer, 1);\n  }\n}\n/**\n * Sets proper heading attributes to a cropped table.\n */\nfunction addHeadingsToCroppedTable(croppedTable, sourceTable, startRow, startColumn, writer) {\n  const headingRows = parseInt(sourceTable.getAttribute('headingRows') || '0');\n  if (headingRows > 0) {\n    const headingRowsInCrop = headingRows - startRow;\n    updateNumericAttribute('headingRows', headingRowsInCrop, croppedTable, writer, 0);\n  }\n  const headingColumns = parseInt(sourceTable.getAttribute('headingColumns') || '0');\n  if (headingColumns > 0) {\n    const headingColumnsInCrop = headingColumns - startColumn;\n    updateNumericAttribute('headingColumns', headingColumnsInCrop, croppedTable, writer, 0);\n  }\n}\n/**\n * Removes columns that have no cells anchored.\n *\n * In table below:\n *\n *     +----+----+----+----+----+----+----+\n *     | 00 | 01      | 03 | 04      | 06 |\n *     +----+----+----+----+         +----+\n *     | 10 | 11      | 13 |         | 16 |\n *     +----+----+----+----+----+----+----+\n *     | 20 | 21      | 23 | 24      | 26 |\n *     +----+----+----+----+----+----+----+\n *                  ^--- empty ---^\n *\n * Will remove columns 2 and 5.\n *\n * **Note:** This is a low-level helper method for clearing invalid model state when doing table modifications.\n * To remove a column from a table use {@link module:table/tableutils~TableUtils#removeColumns `TableUtils.removeColumns()`}.\n *\n * @internal\n * @returns True if removed some columns.\n */\nfunction removeEmptyColumns(table, tableUtils) {\n  const width = tableUtils.getColumns(table);\n  const columnsMap = new Array(width).fill(0);\n  for (const {\n    column\n  } of new TableWalker(table)) {\n    columnsMap[column]++;\n  }\n  const emptyColumns = columnsMap.reduce((result, cellsCount, column) => {\n    return cellsCount ? result : [...result, column];\n  }, []);\n  if (emptyColumns.length > 0) {\n    // Remove only last empty column because it will recurrently trigger removing empty rows.\n    const emptyColumn = emptyColumns[emptyColumns.length - 1];\n    // @if CK_DEBUG_TABLE // console.log( `Removing empty column: ${ emptyColumn }.` );\n    tableUtils.removeColumns(table, {\n      at: emptyColumn\n    });\n    return true;\n  }\n  return false;\n}\n/**\n * Removes rows that have no cells anchored.\n *\n * In table below:\n *\n *     +----+----+----+\n *     | 00 | 01 | 02 |\n *     +----+----+----+\n *     | 10 | 11 | 12 |\n *     +    +    +    +\n *     |    |    |    | <-- empty\n *     +----+----+----+\n *     | 30 | 31 | 32 |\n *     +----+----+----+\n *     | 40      | 42 |\n *     +         +    +\n *     |         |    | <-- empty\n *     +----+----+----+\n *     | 60 | 61 | 62 |\n *     +----+----+----+\n *\n * Will remove rows 2 and 5.\n *\n * **Note:** This is a low-level helper method for clearing invalid model state when doing table modifications.\n * To remove a row from a table use {@link module:table/tableutils~TableUtils#removeRows `TableUtils.removeRows()`}.\n *\n * @internal\n * @returns True if removed some rows.\n */\nfunction removeEmptyRows(table, tableUtils) {\n  const emptyRows = [];\n  const tableRowCount = tableUtils.getRows(table);\n  for (let rowIndex = 0; rowIndex < tableRowCount; rowIndex++) {\n    const tableRow = table.getChild(rowIndex);\n    if (tableRow.isEmpty) {\n      emptyRows.push(rowIndex);\n    }\n  }\n  if (emptyRows.length > 0) {\n    // Remove only last empty row because it will recurrently trigger removing empty columns.\n    const emptyRow = emptyRows[emptyRows.length - 1];\n    // @if CK_DEBUG_TABLE // console.log( `Removing empty row: ${ emptyRow }.` );\n    tableUtils.removeRows(table, {\n      at: emptyRow\n    });\n    return true;\n  }\n  return false;\n}\n/**\n * Removes rows and columns that have no cells anchored.\n *\n * In table below:\n *\n *     +----+----+----+----+\n *     | 00      | 02      |\n *     +----+----+         +\n *     | 10      |         |\n *     +----+----+----+----+\n *     | 20      | 22 | 23 |\n *     +         +    +    +\n *     |         |    |    | <-- empty row\n *     +----+----+----+----+\n *             ^--- empty column\n *\n * Will remove row 3 and column 1.\n *\n * **Note:** This is a low-level helper method for clearing invalid model state when doing table modifications.\n * To remove a rows from a table use {@link module:table/tableutils~TableUtils#removeRows `TableUtils.removeRows()`} and\n * {@link module:table/tableutils~TableUtils#removeColumns `TableUtils.removeColumns()`} to remove a column.\n *\n * @internal\n */\nfunction removeEmptyRowsColumns(table, tableUtils) {\n  const removedColumns = removeEmptyColumns(table, tableUtils);\n  // If there was some columns removed then cleaning empty rows was already triggered.\n  if (!removedColumns) {\n    removeEmptyRows(table, tableUtils);\n  }\n}\n/**\n * Returns adjusted last row index if selection covers part of a row with empty slots (spanned by other cells).\n * The `dimensions.lastRow` is equal to last row index but selection might be bigger.\n *\n * This happens *only* on rectangular selection so we analyze a case like this:\n *\n *        +---+---+---+---+\n *      0 | a | b | c | d |\n *        +   +   +---+---+\n *      1 |   | e | f | g |\n *        +   +---+   +---+\n *      2 |   | h |   | i | <- last row, each cell has rowspan = 2,\n *        +   +   +   +   +    so we need to return 3, not 2\n *      3 |   |   |   |   |\n *        +---+---+---+---+\n *\n * @returns Adjusted last row index.\n */\nfunction adjustLastRowIndex(table, dimensions) {\n  const lastRowMap = Array.from(new TableWalker(table, {\n    startColumn: dimensions.firstColumn,\n    endColumn: dimensions.lastColumn,\n    row: dimensions.lastRow\n  }));\n  const everyCellHasSingleRowspan = lastRowMap.every(({\n    cellHeight\n  }) => cellHeight === 1);\n  // It is a \"flat\" row, so the last row index is OK.\n  if (everyCellHasSingleRowspan) {\n    return dimensions.lastRow;\n  }\n  // Otherwise get any cell's rowspan and adjust the last row index.\n  const rowspanAdjustment = lastRowMap[0].cellHeight - 1;\n  return dimensions.lastRow + rowspanAdjustment;\n}\n/**\n * Returns adjusted last column index if selection covers part of a column with empty slots (spanned by other cells).\n * The `dimensions.lastColumn` is equal to last column index but selection might be bigger.\n *\n * This happens *only* on rectangular selection so we analyze a case like this:\n *\n *       0   1   2   3\n *     +---+---+---+---+\n *     | a             |\n *     +---+---+---+---+\n *     | b | c | d     |\n *     +---+---+---+---+\n *     | e     | f     |\n *     +---+---+---+---+\n *     | g | h         |\n *     +---+---+---+---+\n *               ^\n *              last column, each cell has colspan = 2, so we need to return 3, not 2\n *\n * @returns Adjusted last column index.\n */\nfunction adjustLastColumnIndex(table, dimensions) {\n  const lastColumnMap = Array.from(new TableWalker(table, {\n    startRow: dimensions.firstRow,\n    endRow: dimensions.lastRow,\n    column: dimensions.lastColumn\n  }));\n  const everyCellHasSingleColspan = lastColumnMap.every(({\n    cellWidth\n  }) => cellWidth === 1);\n  // It is a \"flat\" column, so the last column index is OK.\n  if (everyCellHasSingleColspan) {\n    return dimensions.lastColumn;\n  }\n  // Otherwise get any cell's colspan and adjust the last column index.\n  const colspanAdjustment = lastColumnMap[0].cellWidth - 1;\n  return dimensions.lastColumn + colspanAdjustment;\n}\n\n/**\n * The merge cell command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'mergeTableCellRight'`, `'mergeTableCellLeft'`,\n * `'mergeTableCellUp'` and `'mergeTableCellDown'` editor commands.\n *\n * To merge a table cell at the current selection with another cell, execute the command corresponding with the preferred direction.\n *\n * For example, to merge with a cell to the right:\n *\n * ```ts\n * editor.execute( 'mergeTableCellRight' );\n * ```\n *\n * **Note**: If a table cell has a different [`rowspan`](https://www.w3.org/TR/html50/tabular-data.html#attr-tdth-rowspan)\n * (for `'mergeTableCellRight'` and `'mergeTableCellLeft'`) or [`colspan`](https://www.w3.org/TR/html50/tabular-data.html#attr-tdth-colspan)\n * (for `'mergeTableCellUp'` and `'mergeTableCellDown'`), the command will be disabled.\n */\nclass MergeCellCommand extends Command {\n  /**\n  * The direction that indicates which cell will be merged with the currently selected one.\n  */\n  direction;\n  /**\n  * Whether the merge is horizontal (left/right) or vertical (up/down).\n  */\n  isHorizontal;\n  /**\n  * Creates a new `MergeCellCommand` instance.\n  *\n  * @param editor The editor on which this command will be used.\n  * @param options.direction Indicates which cell to merge with the currently selected one.\n  * Possible values are: `'left'`, `'right'`, `'up'` and `'down'`.\n  */\n  constructor(editor, options) {\n    super(editor);\n    this.direction = options.direction;\n    this.isHorizontal = this.direction == 'right' || this.direction == 'left';\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const cellToMerge = this._getMergeableCell();\n    this.value = cellToMerge;\n    this.isEnabled = !!cellToMerge;\n  }\n  /**\n  * Executes the command.\n  *\n  * Depending on the command's {@link #direction} value, it will merge the cell that is to the `'left'`, `'right'`, `'up'` or `'down'`.\n  *\n  * @fires execute\n  */\n  execute() {\n    const model = this.editor.model;\n    const doc = model.document;\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const tableCell = tableUtils.getTableCellsContainingSelection(doc.selection)[0];\n    const cellToMerge = this.value;\n    const direction = this.direction;\n    model.change(writer => {\n      const isMergeNext = direction == 'right' || direction == 'down';\n      // The merge mechanism is always the same so sort cells to be merged.\n      const cellToExpand = isMergeNext ? tableCell : cellToMerge;\n      const cellToRemove = isMergeNext ? cellToMerge : tableCell;\n      // Cache the parent of cell to remove for later check.\n      const removedTableCellRow = cellToRemove.parent;\n      mergeTableCells$1(cellToRemove, cellToExpand, writer);\n      const spanAttribute = this.isHorizontal ? 'colspan' : 'rowspan';\n      const cellSpan = parseInt(tableCell.getAttribute(spanAttribute) || '1');\n      const cellToMergeSpan = parseInt(cellToMerge.getAttribute(spanAttribute) || '1');\n      // Update table cell span attribute and merge set selection on merged contents.\n      writer.setAttribute(spanAttribute, cellSpan + cellToMergeSpan, cellToExpand);\n      writer.setSelection(writer.createRangeIn(cellToExpand));\n      const tableUtils = this.editor.plugins.get('TableUtils');\n      const table = removedTableCellRow.findAncestor('table');\n      // Remove empty rows and columns after merging.\n      removeEmptyRowsColumns(table, tableUtils);\n    });\n  }\n  /**\n  * Returns a cell that can be merged with the current cell depending on the command's direction.\n  */\n  _getMergeableCell() {\n    const model = this.editor.model;\n    const doc = model.document;\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const tableCell = tableUtils.getTableCellsContainingSelection(doc.selection)[0];\n    if (!tableCell) {\n      return;\n    }\n    // First get the cell on proper direction.\n    const cellToMerge = this.isHorizontal ? getHorizontalCell(tableCell, this.direction, tableUtils) : getVerticalCell(tableCell, this.direction, tableUtils);\n    if (!cellToMerge) {\n      return;\n    }\n    // If found check if the span perpendicular to merge direction is equal on both cells.\n    const spanAttribute = this.isHorizontal ? 'rowspan' : 'colspan';\n    const span = parseInt(tableCell.getAttribute(spanAttribute) || '1');\n    const cellToMergeSpan = parseInt(cellToMerge.getAttribute(spanAttribute) || '1');\n    if (cellToMergeSpan === span) {\n      return cellToMerge;\n    }\n  }\n}\n/**\n * Returns the cell that can be merged horizontally.\n */\nfunction getHorizontalCell(tableCell, direction, tableUtils) {\n  const tableRow = tableCell.parent;\n  const table = tableRow.parent;\n  const horizontalCell = direction == 'right' ? tableCell.nextSibling : tableCell.previousSibling;\n  const hasHeadingColumns = (table.getAttribute('headingColumns') || 0) > 0;\n  if (!horizontalCell) {\n    return;\n  }\n  // Sort cells:\n  const cellOnLeft = direction == 'right' ? tableCell : horizontalCell;\n  const cellOnRight = direction == 'right' ? horizontalCell : tableCell;\n  // Get their column indexes:\n  const {\n    column: leftCellColumn\n  } = tableUtils.getCellLocation(cellOnLeft);\n  const {\n    column: rightCellColumn\n  } = tableUtils.getCellLocation(cellOnRight);\n  const leftCellSpan = parseInt(cellOnLeft.getAttribute('colspan') || '1');\n  const isCellOnLeftInHeadingColumn = isHeadingColumnCell(tableUtils, cellOnLeft);\n  const isCellOnRightInHeadingColumn = isHeadingColumnCell(tableUtils, cellOnRight);\n  // We cannot merge heading columns cells with regular cells.\n  if (hasHeadingColumns && isCellOnLeftInHeadingColumn != isCellOnRightInHeadingColumn) {\n    return;\n  }\n  // The cell on the right must have index that is distant to the cell on the left by the left cell's width (colspan).\n  const cellsAreTouching = leftCellColumn + leftCellSpan === rightCellColumn;\n  // If the right cell's column index is different it means that there are rowspanned cells between them.\n  return cellsAreTouching ? horizontalCell : undefined;\n}\n/**\n * Returns the cell that can be merged vertically.\n */\nfunction getVerticalCell(tableCell, direction, tableUtils) {\n  const tableRow = tableCell.parent;\n  const table = tableRow.parent;\n  const rowIndex = table.getChildIndex(tableRow);\n  // Don't search for mergeable cell if direction points out of the table.\n  if (direction == 'down' && rowIndex === tableUtils.getRows(table) - 1 || direction == 'up' && rowIndex === 0) {\n    return null;\n  }\n  const rowspan = parseInt(tableCell.getAttribute('rowspan') || '1');\n  const headingRows = table.getAttribute('headingRows') || 0;\n  const isMergeWithBodyCell = direction == 'down' && rowIndex + rowspan === headingRows;\n  const isMergeWithHeadCell = direction == 'up' && rowIndex === headingRows;\n  // Don't search for mergeable cell if direction points out of the current table section.\n  if (headingRows && (isMergeWithBodyCell || isMergeWithHeadCell)) {\n    return null;\n  }\n  const currentCellRowSpan = parseInt(tableCell.getAttribute('rowspan') || '1');\n  const rowOfCellToMerge = direction == 'down' ? rowIndex + currentCellRowSpan : rowIndex;\n  const tableMap = [...new TableWalker(table, {\n    endRow: rowOfCellToMerge\n  })];\n  const currentCellData = tableMap.find(value => value.cell === tableCell);\n  const mergeColumn = currentCellData.column;\n  const cellToMergeData = tableMap.find(({\n    row,\n    cellHeight,\n    column\n  }) => {\n    if (column !== mergeColumn) {\n      return false;\n    }\n    if (direction == 'down') {\n      // If merging a cell below the mergeRow is already calculated.\n      return row === rowOfCellToMerge;\n    } else {\n      // If merging a cell above calculate if it spans to mergeRow.\n      return rowOfCellToMerge === row + cellHeight;\n    }\n  });\n  return cellToMergeData && cellToMergeData.cell ? cellToMergeData.cell : null;\n}\n/**\n * Merges two table cells. It will ensure that after merging cells with an empty paragraph, the resulting table cell will only have one\n * paragraph. If one of the merged table cells is empty, the merged table cell will have the contents of the non-empty table cell.\n * If both are empty, the merged table cell will have only one empty paragraph.\n */\nfunction mergeTableCells$1(cellToRemove, cellToExpand, writer) {\n  if (!isEmpty$2(cellToRemove)) {\n    if (isEmpty$2(cellToExpand)) {\n      writer.remove(writer.createRangeIn(cellToExpand));\n    }\n    writer.move(writer.createRangeIn(cellToRemove), writer.createPositionAt(cellToExpand, 'end'));\n  }\n  // Remove merged table cell.\n  writer.remove(cellToRemove);\n}\n/**\n * Checks if the passed table cell contains an empty paragraph.\n */\nfunction isEmpty$2(tableCell) {\n  const firstTableChild = tableCell.getChild(0);\n  return tableCell.childCount == 1 && firstTableChild.is('element', 'paragraph') && firstTableChild.isEmpty;\n}\n\n/**\n * The remove row command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'removeTableRow'` editor command.\n *\n * To remove the row containing the selected cell, execute the command:\n *\n * ```ts\n * editor.execute( 'removeTableRow' );\n * ```\n */\nclass RemoveRowCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const selectedCells = tableUtils.getSelectionAffectedTableCells(this.editor.model.document.selection);\n    const firstCell = selectedCells[0];\n    if (firstCell) {\n      const table = firstCell.findAncestor('table');\n      const tableRowCount = tableUtils.getRows(table);\n      const lastRowIndex = tableRowCount - 1;\n      const selectedRowIndexes = tableUtils.getRowIndexes(selectedCells);\n      const areAllRowsSelected = selectedRowIndexes.first === 0 && selectedRowIndexes.last === lastRowIndex;\n      // Disallow selecting whole table -> delete whole table should be used instead.\n      this.isEnabled = !areAllRowsSelected;\n    } else {\n      this.isEnabled = false;\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const model = this.editor.model;\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const referenceCells = tableUtils.getSelectionAffectedTableCells(model.document.selection);\n    const removedRowIndexes = tableUtils.getRowIndexes(referenceCells);\n    const firstCell = referenceCells[0];\n    const table = firstCell.findAncestor('table');\n    const columnIndexToFocus = tableUtils.getCellLocation(firstCell).column;\n    model.change(writer => {\n      const rowsToRemove = removedRowIndexes.last - removedRowIndexes.first + 1;\n      tableUtils.removeRows(table, {\n        at: removedRowIndexes.first,\n        rows: rowsToRemove\n      });\n      const cellToFocus = getCellToFocus$1(table, removedRowIndexes.first, columnIndexToFocus, tableUtils.getRows(table));\n      writer.setSelection(writer.createPositionAt(cellToFocus, 0));\n    });\n  }\n}\n/**\n * Returns a cell that should be focused before removing the row, belonging to the same column as the currently focused cell.\n * - If the row was not the last one, the cell to focus will be in the row that followed it (before removal).\n * - If the row was the last one, the cell to focus will be in the row that preceded it (before removal).\n */\nfunction getCellToFocus$1(table, removedRowIndex, columnToFocus, tableRowCount) {\n  // Don't go beyond last row's index.\n  const row = table.getChild(Math.min(removedRowIndex, tableRowCount - 1));\n  // Default to first table cell.\n  let cellToFocus = row.getChild(0);\n  let column = 0;\n  for (const tableCell of row.getChildren()) {\n    if (column > columnToFocus) {\n      return cellToFocus;\n    }\n    cellToFocus = tableCell;\n    column += parseInt(tableCell.getAttribute('colspan') || '1');\n  }\n  return cellToFocus;\n}\n\n/**\n * The remove column command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'removeTableColumn'` editor command.\n *\n * To remove the column containing the selected cell, execute the command:\n *\n * ```ts\n * editor.execute( 'removeTableColumn' );\n * ```\n */\nclass RemoveColumnCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const selectedCells = tableUtils.getSelectionAffectedTableCells(this.editor.model.document.selection);\n    const firstCell = selectedCells[0];\n    if (firstCell) {\n      const table = firstCell.findAncestor('table');\n      const tableColumnCount = tableUtils.getColumns(table);\n      const {\n        first,\n        last\n      } = tableUtils.getColumnIndexes(selectedCells);\n      this.isEnabled = last - first < tableColumnCount - 1;\n    } else {\n      this.isEnabled = false;\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const [firstCell, lastCell] = getBoundaryCells(this.editor.model.document.selection, tableUtils);\n    const table = firstCell.parent.parent;\n    // Cache the table before removing or updating colspans.\n    const tableMap = [...new TableWalker(table)];\n    // Store column indexes of removed columns.\n    const removedColumnIndexes = {\n      first: tableMap.find(value => value.cell === firstCell).column,\n      last: tableMap.find(value => value.cell === lastCell).column\n    };\n    const cellToFocus = getCellToFocus(tableMap, firstCell, lastCell, removedColumnIndexes);\n    this.editor.model.change(writer => {\n      const columnsToRemove = removedColumnIndexes.last - removedColumnIndexes.first + 1;\n      tableUtils.removeColumns(table, {\n        at: removedColumnIndexes.first,\n        columns: columnsToRemove\n      });\n      writer.setSelection(writer.createPositionAt(cellToFocus, 0));\n    });\n  }\n}\n/**\n * Returns a proper table cell to focus after removing a column.\n * - selection is on last table cell it will return previous cell.\n */\nfunction getCellToFocus(tableMap, firstCell, lastCell, removedColumnIndexes) {\n  const colspan = parseInt(lastCell.getAttribute('colspan') || '1');\n  // If the table cell is spanned over 2+ columns - it will be truncated so the selection should\n  // stay in that cell.\n  if (colspan > 1) {\n    return lastCell;\n  } else if (firstCell.previousSibling || lastCell.nextSibling) {\n    return lastCell.nextSibling || firstCell.previousSibling;\n  } else {\n    // Look for any cell in a column that precedes the first removed column.\n    if (removedColumnIndexes.first) {\n      return tableMap.reverse().find(({\n        column\n      }) => {\n        return column < removedColumnIndexes.first;\n      }).cell;\n    } else {\n      return tableMap.reverse().find(({\n        column\n      }) => {\n        return column > removedColumnIndexes.last;\n      }).cell;\n    }\n  }\n}\n/**\n * Returns helper object returning the first and the last cell contained in given selection, based on DOM order.\n */\nfunction getBoundaryCells(selection, tableUtils) {\n  const referenceCells = tableUtils.getSelectionAffectedTableCells(selection);\n  const firstCell = referenceCells[0];\n  const lastCell = referenceCells.pop();\n  const returnValue = [firstCell, lastCell];\n  return firstCell.isBefore(lastCell) ? returnValue : returnValue.reverse();\n}\n\n/**\n * The header row command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'setTableColumnHeader'` editor command.\n *\n * You can make the row containing the selected cell a [header](https://www.w3.org/TR/html50/tabular-data.html#the-th-element) by executing:\n *\n * ```ts\n * editor.execute( 'setTableRowHeader' );\n * ```\n *\n * **Note:** All preceding rows will also become headers. If the current row is already a header, executing this command\n * will make it a regular row back again (including the following rows).\n */\nclass SetHeaderRowCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const model = this.editor.model;\n    const selectedCells = tableUtils.getSelectionAffectedTableCells(model.document.selection);\n    if (selectedCells.length === 0) {\n      this.isEnabled = false;\n      this.value = false;\n      return;\n    }\n    const table = selectedCells[0].findAncestor('table');\n    this.isEnabled = model.schema.checkAttribute(table, 'headingRows');\n    this.value = selectedCells.every(cell => this._isInHeading(cell, cell.parent.parent));\n  }\n  /**\n  * Executes the command.\n  *\n  * When the selection is in a non-header row, the command will set the `headingRows` table attribute to cover that row.\n  *\n  * When the selection is already in a header row, it will set `headingRows` so the heading section will end before that row.\n  *\n  * @fires execute\n  * @param options.forceValue If set, the command will set (`true`) or unset (`false`) the header rows according to\n  * the `forceValue` parameter instead of the current model state.\n  */\n  execute(options = {}) {\n    if (options.forceValue === this.value) {\n      return;\n    }\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const model = this.editor.model;\n    const selectedCells = tableUtils.getSelectionAffectedTableCells(model.document.selection);\n    const table = selectedCells[0].findAncestor('table');\n    const {\n      first,\n      last\n    } = tableUtils.getRowIndexes(selectedCells);\n    const headingRowsToSet = this.value ? first : last + 1;\n    const currentHeadingRows = table.getAttribute('headingRows') || 0;\n    model.change(writer => {\n      if (headingRowsToSet) {\n        // Changing heading rows requires to check if any of a heading cell is overlapping vertically the table head.\n        // Any table cell that has a rowspan attribute > 1 will not exceed the table head so we need to fix it in rows below.\n        const startRow = headingRowsToSet > currentHeadingRows ? currentHeadingRows : 0;\n        const overlappingCells = getVerticallyOverlappingCells(table, headingRowsToSet, startRow);\n        for (const {\n          cell\n        } of overlappingCells) {\n          splitHorizontally(cell, headingRowsToSet, writer);\n        }\n      }\n      updateNumericAttribute('headingRows', headingRowsToSet, table, writer, 0);\n    });\n  }\n  /**\n  * Checks if a table cell is in the heading section.\n  */\n  _isInHeading(tableCell, table) {\n    const headingRows = parseInt(table.getAttribute('headingRows') || '0');\n    return !!headingRows && tableCell.parent.index < headingRows;\n  }\n}\n\n/**\n * The header column command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'setTableColumnHeader'` editor command.\n *\n * You can make the column containing the selected cell a [header](https://www.w3.org/TR/html50/tabular-data.html#the-th-element)\n * by executing:\n *\n * ```ts\n * editor.execute( 'setTableColumnHeader' );\n * ```\n *\n * **Note:** All preceding columns will also become headers. If the current column is already a header, executing this command\n * will make it a regular column back again (including the following columns).\n */\nclass SetHeaderColumnCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const model = this.editor.model;\n    const selectedCells = tableUtils.getSelectionAffectedTableCells(model.document.selection);\n    if (selectedCells.length === 0) {\n      this.isEnabled = false;\n      this.value = false;\n      return;\n    }\n    const table = selectedCells[0].findAncestor('table');\n    this.isEnabled = model.schema.checkAttribute(table, 'headingColumns');\n    this.value = selectedCells.every(cell => isHeadingColumnCell(tableUtils, cell));\n  }\n  /**\n  * Executes the command.\n  *\n  * When the selection is in a non-header column, the command will set the `headingColumns` table attribute to cover that column.\n  *\n  * When the selection is already in a header column, it will set `headingColumns` so the heading section will end before that column.\n  *\n  * @fires execute\n  * @param options.forceValue If set, the command will set (`true`) or unset (`false`) the header columns according to\n  * the `forceValue` parameter instead of the current model state.\n  */\n  execute(options = {}) {\n    if (options.forceValue === this.value) {\n      return;\n    }\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const model = this.editor.model;\n    const selectedCells = tableUtils.getSelectionAffectedTableCells(model.document.selection);\n    const table = selectedCells[0].findAncestor('table');\n    const {\n      first,\n      last\n    } = tableUtils.getColumnIndexes(selectedCells);\n    const headingColumnsToSet = this.value ? first : last + 1;\n    model.change(writer => {\n      if (headingColumnsToSet) {\n        // Changing heading columns requires to check if any of a heading cell is overlapping horizontally the table head.\n        // Any table cell that has a colspan attribute > 1 will not exceed the table head so we need to fix it in columns before.\n        const overlappingCells = getHorizontallyOverlappingCells(table, headingColumnsToSet);\n        for (const {\n          cell,\n          column\n        } of overlappingCells) {\n          splitVertically(cell, column, headingColumnsToSet, writer);\n        }\n      }\n      updateNumericAttribute('headingColumns', headingColumnsToSet, table, writer, 0);\n    });\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module table/tablecolumnresize/constants\n    */ /**\n       * The minimum column width given as a percentage value. Used in situations when the table is not yet rendered, so it is impossible to\n       * calculate how many percentage of the table width would be {@link ~COLUMN_MIN_WIDTH_IN_PIXELS minimum column width in pixels}.\n       */\nconst COLUMN_MIN_WIDTH_AS_PERCENTAGE = 5;\n/**\n * The minimum column width in pixels when the maximum table width is known.\n */\nconst COLUMN_MIN_WIDTH_IN_PIXELS = 40;\n/**\n * Determines how many digits after the decimal point are used to store the column width as a percentage value.\n */\nconst COLUMN_WIDTH_PRECISION = 2;\n/**\n * The distance in pixels that the mouse has to move to start resizing the column.\n */\nconst COLUMN_RESIZE_DISTANCE_THRESHOLD = 3;\n\n/**\n * Returns all the inserted or changed table model elements in a given change set. Only the tables\n * with 'columnsWidth' attribute are taken into account. The returned set may be empty.\n *\n * Most notably if an entire table is removed it will not be included in returned set.\n *\n * @param model The model to collect the affected elements from.\n * @returns A set of table model elements.\n */\nfunction getChangedResizedTables(model) {\n  const affectedTables = new Set();\n  for (const change of model.document.differ.getChanges()) {\n    let referencePosition = null;\n    // Checks if the particular change from the differ is:\n    // - an insertion or removal of a table, a row or a cell,\n    // - an attribute change on a table, a row or a cell.\n    switch (change.type) {\n      case 'insert':\n        referencePosition = ['table', 'tableRow', 'tableCell'].includes(change.name) ? change.position : null;\n        break;\n      case 'remove':\n        // If the whole table is removed, there's no need to update its column widths (#12201).\n        referencePosition = ['tableRow', 'tableCell'].includes(change.name) ? change.position : null;\n        break;\n      case 'attribute':\n        if (change.range.start.nodeAfter) {\n          referencePosition = ['table', 'tableRow', 'tableCell'].includes(change.range.start.nodeAfter.name) ? change.range.start : null;\n        }\n        break;\n    }\n    if (!referencePosition) {\n      continue;\n    }\n    const tableNode = referencePosition.nodeAfter && referencePosition.nodeAfter.is('element', 'table') ? referencePosition.nodeAfter : referencePosition.findAncestor('table');\n    // We iterate over the whole table looking for the nested tables that are also affected.\n    for (const node of model.createRangeOn(tableNode).getItems()) {\n      if (!node.is('element', 'table')) {\n        continue;\n      }\n      if (!getColumnGroupElement(node)) {\n        continue;\n      }\n      affectedTables.add(node);\n    }\n  }\n  return affectedTables;\n}\n/**\n * Calculates the percentage of the minimum column width given in pixels for a given table.\n *\n * @param modelTable A table model element.\n * @param editor The editor instance.\n * @returns The minimal column width in percentage.\n */\nfunction getColumnMinWidthAsPercentage(modelTable, editor) {\n  return COLUMN_MIN_WIDTH_IN_PIXELS * 100 / getTableWidthInPixels(modelTable, editor);\n}\n/**\n * Calculates the table width in pixels.\n *\n * @param modelTable A table model element.\n * @param editor The editor instance.\n * @returns The width of the table in pixels.\n */\nfunction getTableWidthInPixels(modelTable, editor) {\n  // It is possible for a table to not have a <tbody> element - see #11878.\n  const referenceElement = getChildrenViewElement(modelTable, 'tbody', editor) || getChildrenViewElement(modelTable, 'thead', editor);\n  const domReferenceElement = editor.editing.view.domConverter.mapViewToDom(referenceElement);\n  return getElementWidthInPixels(domReferenceElement);\n}\n/**\n * Returns the a view element with a given name that is nested directly in a `<table>` element\n * related to a given `modelTable`.\n *\n * @param elementName Name of a view to be looked for, e.g. `'colgroup`', `'thead`'.\n * @returns Matched view or `undefined` otherwise.\n */\nfunction getChildrenViewElement(modelTable, elementName, editor) {\n  const viewFigure = editor.editing.mapper.toViewElement(modelTable);\n  const viewTable = [...viewFigure.getChildren()].find(node => node.is('element', 'table'));\n  return [...viewTable.getChildren()].find(node => node.is('element', elementName));\n}\n/**\n * Returns the computed width (in pixels) of the DOM element without padding and borders.\n *\n * @param domElement A DOM element.\n * @returns The width of the DOM element in pixels.\n */\nfunction getElementWidthInPixels(domElement) {\n  const styles = global.window.getComputedStyle(domElement);\n  // In the 'border-box' box sizing algorithm, the element's width\n  // already includes the padding and border width (#12335).\n  if (styles.boxSizing === 'border-box') {\n    return parseFloat(styles.width) - parseFloat(styles.paddingLeft) - parseFloat(styles.paddingRight) - parseFloat(styles.borderLeftWidth) - parseFloat(styles.borderRightWidth);\n  } else {\n    return parseFloat(styles.width);\n  }\n}\n/**\n * Returns the column indexes on the left and right edges of a cell. They differ if the cell spans\n * across multiple columns.\n *\n * @param cell A table cell model element.\n * @param tableUtils The Table Utils plugin instance.\n * @returns An object containing the indexes of the left and right edges of the cell.\n */\nfunction getColumnEdgesIndexes(cell, tableUtils) {\n  const cellColumnIndex = tableUtils.getCellLocation(cell).column;\n  const cellWidth = cell.getAttribute('colspan') || 1;\n  return {\n    leftEdge: cellColumnIndex,\n    rightEdge: cellColumnIndex + cellWidth - 1\n  };\n}\n/**\n * Rounds the provided value to a fixed-point number with defined number of digits after the decimal point.\n *\n * @param value A number to be rounded.\n * @returns The rounded number.\n */\nfunction toPrecision(value) {\n  const multiplier = Math.pow(10, COLUMN_WIDTH_PRECISION);\n  const number = typeof value === 'number' ? value : parseFloat(value);\n  return Math.round(number * multiplier) / multiplier;\n}\n/**\n * Clamps the number within the inclusive lower (min) and upper (max) bounds. Returned number is rounded using the\n * {@link ~toPrecision `toPrecision()`} function.\n *\n * @param number A number to be clamped.\n * @param min A lower bound.\n * @param max An upper bound.\n * @returns The clamped number.\n */\nfunction clamp(number, min, max) {\n  if (number <= min) {\n    return toPrecision(min);\n  }\n  if (number >= max) {\n    return toPrecision(max);\n  }\n  return toPrecision(number);\n}\n/**\n * Creates an array with defined length and fills all elements with defined value.\n *\n * @param length The length of the array.\n * @param value The value to fill the array with.\n * @returns An array with defined length and filled with defined value.\n */\nfunction createFilledArray(length, value) {\n  return Array(length).fill(value);\n}\n/**\n * Sums all array values that can be parsed to a float.\n *\n * @param array An array of numbers.\n * @returns The sum of all array values.\n */\nfunction sumArray(array) {\n  return array.map(value => typeof value === 'number' ? value : parseFloat(value)).filter(value => !Number.isNaN(value)).reduce((result, item) => result + item, 0);\n}\n/**\n * Makes sure that the sum of the widths from all columns is 100%. If the sum of all the widths is not equal 100%, all the widths are\n * changed proportionally so that they all sum back to 100%. If there are columns without specified width, the amount remaining\n * after assigning the known widths will be distributed equally between them.\n *\n * @param columnWidths An array of column widths.\n * @returns An array of column widths guaranteed to sum up to 100%.\n */\nfunction normalizeColumnWidths(columnWidths) {\n  const widths = columnWidths.map(width => {\n    if (width === 'auto') {\n      return width;\n    }\n    return parseFloat(width.replace('%', ''));\n  });\n  let normalizedWidths = calculateMissingColumnWidths(widths);\n  const totalWidth = sumArray(normalizedWidths);\n  if (totalWidth !== 100) {\n    normalizedWidths = normalizedWidths // Adjust all the columns proportionally.\n    .map(width => toPrecision(width * 100 / totalWidth)) // Due to rounding of numbers it may happen that the sum of the widths of all columns will not be exactly 100%.\n    // Therefore, the width of the last column is explicitly adjusted (narrowed or expanded), since all the columns\n    // have been proportionally changed already.\n    .map((columnWidth, columnIndex, width) => {\n      const isLastColumn = columnIndex === width.length - 1;\n      if (!isLastColumn) {\n        return columnWidth;\n      }\n      const totalWidth = sumArray(width);\n      return toPrecision(columnWidth + 100 - totalWidth);\n    });\n  }\n  return normalizedWidths.map(width => width + '%');\n}\n/**\n * Initializes the column widths by parsing the attribute value and calculating the uninitialized column widths. The special value 'auto'\n * indicates that width for the column must be calculated. The width of such uninitialized column is calculated as follows:\n * - If there is enough free space in the table for all uninitialized columns to have at least the minimum allowed width for all of them,\n *   then set this width equally for all uninitialized columns.\n * - Otherwise, just set the minimum allowed width for all uninitialized columns. The sum of all column widths will be greater than 100%,\n *   but then it will be adjusted proportionally to 100% in {@link #normalizeColumnWidths `normalizeColumnWidths()`}.\n *\n * @param columnWidths An array of column widths.\n * @returns An array with 'auto' values replaced with calculated widths.\n */\nfunction calculateMissingColumnWidths(columnWidths) {\n  const numberOfUninitializedColumns = columnWidths.filter(columnWidth => columnWidth === 'auto').length;\n  if (numberOfUninitializedColumns === 0) {\n    return columnWidths.map(columnWidth => toPrecision(columnWidth));\n  }\n  const totalWidthOfInitializedColumns = sumArray(columnWidths);\n  const widthForUninitializedColumn = Math.max((100 - totalWidthOfInitializedColumns) / numberOfUninitializedColumns, COLUMN_MIN_WIDTH_AS_PERCENTAGE);\n  return columnWidths.map(columnWidth => columnWidth === 'auto' ? widthForUninitializedColumn : columnWidth).map(columnWidth => toPrecision(columnWidth));\n}\n/**\n * Calculates the total horizontal space taken by the cell. That includes:\n *  * width,\n *  * left and red padding,\n *  * border width.\n *\n * @param domCell A DOM cell element.\n * @returns Width in pixels without `px` at the end.\n */\nfunction getDomCellOuterWidth(domCell) {\n  const styles = global.window.getComputedStyle(domCell);\n  // In the 'border-box' box sizing algorithm, the element's width\n  // already includes the padding and border width (#12335).\n  if (styles.boxSizing === 'border-box') {\n    return parseInt(styles.width);\n  } else {\n    return parseFloat(styles.width) + parseFloat(styles.paddingLeft) + parseFloat(styles.paddingRight) + parseFloat(styles.borderWidth);\n  }\n}\n/**\n * Updates column elements to match columns widths.\n *\n * @param columns\n * @param tableColumnGroup\n * @param normalizedWidths\n * @param writer\n */\nfunction updateColumnElements(columns, tableColumnGroup, normalizedWidths, writer) {\n  for (let i = 0; i < Math.max(normalizedWidths.length, columns.length); i++) {\n    const column = columns[i];\n    const columnWidth = normalizedWidths[i];\n    if (!columnWidth) {\n      // Number of `<tableColumn>` elements exceeds actual number of columns.\n      writer.remove(column);\n    } else if (!column) {\n      // There is fewer `<tableColumn>` elements than actual columns.\n      writer.appendElement('tableColumn', {\n        columnWidth\n      }, tableColumnGroup);\n    } else {\n      // Update column width.\n      writer.setAttribute('columnWidth', columnWidth, column);\n    }\n  }\n}\n/**\n * Returns a 'tableColumnGroup' element from the 'table'.\n *\n * @internal\n * @param element A 'table' or 'tableColumnGroup' element.\n * @returns A 'tableColumnGroup' element.\n */\nfunction getColumnGroupElement(element) {\n  if (element.is('element', 'tableColumnGroup')) {\n    return element;\n  }\n  const children = element.getChildren();\n  return Array.from(children).find(element => element.is('element', 'tableColumnGroup'));\n}\n/**\n * Returns an array of 'tableColumn' elements. It may be empty if there's no `tableColumnGroup` element.\n *\n * @internal\n * @param element A 'table' or 'tableColumnGroup' element.\n * @returns An array of 'tableColumn' elements.\n */\nfunction getTableColumnElements(element) {\n  const columnGroupElement = getColumnGroupElement(element);\n  if (!columnGroupElement) {\n    return [];\n  }\n  return Array.from(columnGroupElement.getChildren());\n}\n/**\n * Returns an array of table column widths.\n *\n * @internal\n * @param element A 'table' or 'tableColumnGroup' element.\n * @returns An array of table column widths.\n */\nfunction getTableColumnsWidths(element) {\n  return getTableColumnElements(element).map(column => column.getAttribute('columnWidth'));\n}\n/**\n * Translates the `colSpan` model attribute into additional column widths and returns the resulting array.\n *\n * @internal\n * @param element A 'table' or 'tableColumnGroup' element.\n * @param writer A writer instance.\n * @returns An array of table column widths.\n */\nfunction translateColSpanAttribute(element, writer) {\n  const tableColumnElements = getTableColumnElements(element);\n  return tableColumnElements.reduce((acc, element) => {\n    const columnWidth = element.getAttribute('columnWidth');\n    const colSpan = element.getAttribute('colSpan');\n    if (!colSpan) {\n      acc.push(columnWidth);\n      return acc;\n    }\n    // Translate the `colSpan` model attribute on to the proper number of column widths\n    // and remove it from the element.\n    // See https://github.com/ckeditor/ckeditor5/issues/14521#issuecomment-1662102889 for more details.\n    for (let i = 0; i < colSpan; i++) {\n      acc.push(columnWidth);\n    }\n    writer.removeAttribute('colSpan', element);\n    return acc;\n  }, []);\n}\n\n/**\n * The table utilities plugin.\n */\nclass TableUtils extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableUtils';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    this.decorate('insertColumns');\n    this.decorate('insertRows');\n  }\n  /**\n  * Returns the table cell location as an object with table row and table column indexes.\n  *\n  * For instance, in the table below:\n  *\n  *      0   1   2   3\n  *    +---+---+---+---+\n  *  0 | a     | b | c |\n  *    +       +   +---+\n  *  1 |       |   | d |\n  *    +---+---+   +---+\n  *  2 | e     |   | f |\n  *    +---+---+---+---+\n  *\n  * the method will return:\n  *\n  * ```ts\n  * const cellA = table.getNodeByPath( [ 0, 0 ] );\n  * editor.plugins.get( 'TableUtils' ).getCellLocation( cellA );\n  * // will return { row: 0, column: 0 }\n  *\n  * const cellD = table.getNodeByPath( [ 1, 0 ] );\n  * editor.plugins.get( 'TableUtils' ).getCellLocation( cellD );\n  * // will return { row: 1, column: 3 }\n  * ```\n  *\n  * @returns Returns a `{row, column}` object.\n  */\n  getCellLocation(tableCell) {\n    const tableRow = tableCell.parent;\n    const table = tableRow.parent;\n    const rowIndex = table.getChildIndex(tableRow);\n    const tableWalker = new TableWalker(table, {\n      row: rowIndex\n    });\n    for (const {\n      cell,\n      row,\n      column\n    } of tableWalker) {\n      if (cell === tableCell) {\n        return {\n          row,\n          column\n        };\n      }\n    }\n    // Should be unreachable code.\n    /* istanbul ignore next -- @preserve */\n    return undefined;\n  }\n  /**\n  * Creates an empty table with a proper structure. The table needs to be inserted into the model,\n  * for example, by using the {@link module:engine/model/model~Model#insertContent} function.\n  *\n  * ```ts\n  * model.change( ( writer ) => {\n  *   // Create a table of 2 rows and 7 columns:\n  *   const table = tableUtils.createTable( writer, { rows: 2, columns: 7 } );\n  *\n  *   // Insert a table to the model at the best position taking the current selection:\n  *   model.insertContent( table );\n  * }\n  * ```\n  *\n  * @param writer The model writer.\n  * @param options.rows The number of rows to create. Default value is 2.\n  * @param options.columns The number of columns to create. Default value is 2.\n  * @param options.headingRows The number of heading rows. Default value is 0.\n  * @param options.headingColumns The number of heading columns. Default value is 0.\n  * @returns The created table element.\n  */\n  createTable(writer, options) {\n    const table = writer.createElement('table');\n    const rows = options.rows || 2;\n    const columns = options.columns || 2;\n    createEmptyRows(writer, table, 0, rows, columns);\n    if (options.headingRows) {\n      updateNumericAttribute('headingRows', Math.min(options.headingRows, rows), table, writer, 0);\n    }\n    if (options.headingColumns) {\n      updateNumericAttribute('headingColumns', Math.min(options.headingColumns, columns), table, writer, 0);\n    }\n    return table;\n  }\n  /**\n  * Inserts rows into a table.\n  *\n  * ```ts\n  * editor.plugins.get( 'TableUtils' ).insertRows( table, { at: 1, rows: 2 } );\n  * ```\n  *\n  * Assuming the table on the left, the above code will transform it to the table on the right:\n  *\n  *  row index\n  *    0 +---+---+---+       `at` = 1,      +---+---+---+ 0\n  *      | a | b | c |       `rows` = 2,    | a | b | c |\n  *    1 +   +---+---+   <-- insert here    +   +---+---+ 1\n  *      |   | d | e |                      |   |   |   |\n  *    2 +   +---+---+       will give:     +   +---+---+ 2\n  *      |   | f | g |                      |   |   |   |\n  *    3 +---+---+---+                      +   +---+---+ 3\n  *                                         |   | d | e |\n  *                                         +   +---+---+ 4\n  *                                         +   + f | g |\n  *                                         +---+---+---+ 5\n  *\n  * @param table The table model element where the rows will be inserted.\n  * @param options.at The row index at which the rows will be inserted.  Default value is 0.\n  * @param options.rows The number of rows to insert.  Default value is 1.\n  * @param options.copyStructureFromAbove The flag for copying row structure. Note that\n  * the row structure will not be copied if this option is not provided.\n  */\n  insertRows(table, options = {}) {\n    const model = this.editor.model;\n    const insertAt = options.at || 0;\n    const rowsToInsert = options.rows || 1;\n    const isCopyStructure = options.copyStructureFromAbove !== undefined;\n    const copyStructureFrom = options.copyStructureFromAbove ? insertAt - 1 : insertAt;\n    const rows = this.getRows(table);\n    const columns = this.getColumns(table);\n    if (insertAt > rows) {\n      /**\n      * The `options.at` points at a row position that does not exist.\n      *\n      * @error tableutils-insertrows-insert-out-of-range\n      */\n      throw new CKEditorError('tableutils-insertrows-insert-out-of-range', this, {\n        options\n      });\n    }\n    model.change(writer => {\n      const headingRows = table.getAttribute('headingRows') || 0;\n      // Inserting rows inside heading section requires to update `headingRows` attribute as the heading section will grow.\n      if (headingRows > insertAt) {\n        updateNumericAttribute('headingRows', headingRows + rowsToInsert, table, writer, 0);\n      }\n      // Inserting at the end or at the beginning of a table doesn't require to calculate anything special.\n      if (!isCopyStructure && (insertAt === 0 || insertAt === rows)) {\n        createEmptyRows(writer, table, insertAt, rowsToInsert, columns);\n        return;\n      }\n      // Iterate over all the rows above the inserted rows in order to check for the row-spanned cells.\n      const walkerEndRow = isCopyStructure ? Math.max(insertAt, copyStructureFrom) : insertAt;\n      const tableIterator = new TableWalker(table, {\n        endRow: walkerEndRow\n      });\n      // Store spans of the reference row to reproduce it's structure. This array is column number indexed.\n      const rowColSpansMap = new Array(columns).fill(1);\n      for (const {\n        row,\n        column,\n        cellHeight,\n        cellWidth,\n        cell\n      } of tableIterator) {\n        const lastCellRow = row + cellHeight - 1;\n        const isOverlappingInsertedRow = row < insertAt && insertAt <= lastCellRow;\n        const isReferenceRow = row <= copyStructureFrom && copyStructureFrom <= lastCellRow;\n        // If the cell is row-spanned and overlaps the inserted row, then reserve space for it in the row map.\n        if (isOverlappingInsertedRow) {\n          // This cell overlaps the inserted rows so we need to expand it further.\n          writer.setAttribute('rowspan', cellHeight + rowsToInsert, cell);\n          // Mark this cell with negative number to indicate how many cells should be skipped when adding the new cells.\n          rowColSpansMap[column] = -cellWidth;\n        } else if (isCopyStructure && isReferenceRow) {\n          rowColSpansMap[column] = cellWidth;\n        }\n      }\n      for (let rowIndex = 0; rowIndex < rowsToInsert; rowIndex++) {\n        const tableRow = writer.createElement('tableRow');\n        writer.insert(tableRow, table, insertAt);\n        for (let cellIndex = 0; cellIndex < rowColSpansMap.length; cellIndex++) {\n          const colspan = rowColSpansMap[cellIndex];\n          const insertPosition = writer.createPositionAt(tableRow, 'end');\n          // Insert the empty cell only if this slot is not row-spanned from any other cell.\n          if (colspan > 0) {\n            createEmptyTableCell(writer, insertPosition, colspan > 1 ? {\n              colspan\n            } : undefined);\n          }\n          // Skip the col-spanned slots, there won't be any cells.\n          cellIndex += Math.abs(colspan) - 1;\n        }\n      }\n    });\n  }\n  /**\n  * Inserts columns into a table.\n  *\n  * ```ts\n  * editor.plugins.get( 'TableUtils' ).insertColumns( table, { at: 1, columns: 2 } );\n  * ```\n  *\n  * Assuming the table on the left, the above code will transform it to the table on the right:\n  *\n  *  0   1   2   3                   0   1   2   3   4   5\n  *  +---+---+---+                   +---+---+---+---+---+\n  *  | a     | b |                   | a             | b |\n  *  +       +---+                   +               +---+\n  *  |       | c |                   |               | c |\n  *  +---+---+---+     will give:    +---+---+---+---+---+\n  *  | d | e | f |                   | d |   |   | e | f |\n  *  +---+   +---+                   +---+---+---+   +---+\n  *  | g |   | h |                   | g |   |   |   | h |\n  *  +---+---+---+                   +---+---+---+---+---+\n  *  | i         |                   | i                 |\n  *  +---+---+---+                   +---+---+---+---+---+\n  *      ^---- insert here, `at` = 1, `columns` = 2\n  *\n  * @param table The table model element where the columns will be inserted.\n  * @param options.at The column index at which the columns will be inserted. Default value is 0.\n  * @param options.columns The number of columns to insert. Default value is 1.\n  */\n  insertColumns(table, options = {}) {\n    const model = this.editor.model;\n    const insertAt = options.at || 0;\n    const columnsToInsert = options.columns || 1;\n    model.change(writer => {\n      const headingColumns = table.getAttribute('headingColumns');\n      // Inserting columns inside heading section requires to update `headingColumns` attribute as the heading section will grow.\n      if (insertAt < headingColumns) {\n        writer.setAttribute('headingColumns', headingColumns + columnsToInsert, table);\n      }\n      const tableColumns = this.getColumns(table);\n      // Inserting at the end and at the beginning of a table doesn't require to calculate anything special.\n      if (insertAt === 0 || tableColumns === insertAt) {\n        for (const tableRow of table.getChildren()) {\n          // Ignore non-row elements inside the table (e.g. caption).\n          if (!tableRow.is('element', 'tableRow')) {\n            continue;\n          }\n          createCells(columnsToInsert, writer, writer.createPositionAt(tableRow, insertAt ? 'end' : 0));\n        }\n        return;\n      }\n      const tableWalker = new TableWalker(table, {\n        column: insertAt,\n        includeAllSlots: true\n      });\n      for (const tableSlot of tableWalker) {\n        const {\n          row,\n          cell,\n          cellAnchorColumn,\n          cellAnchorRow,\n          cellWidth,\n          cellHeight\n        } = tableSlot;\n        // When iterating over column the table walker outputs either:\n        // - cells at given column index (cell \"e\" from method docs),\n        // - spanned columns (spanned cell from row between cells \"g\" and \"h\" - spanned by \"e\", only if `includeAllSlots: true`),\n        // - or a cell from the same row which spans over this column (cell \"a\").\n        if (cellAnchorColumn < insertAt) {\n          // If cell is anchored in previous column, it is a cell that spans over an inserted column (cell \"a\" & \"i\").\n          // For such cells expand them by a number of columns inserted.\n          writer.setAttribute('colspan', cellWidth + columnsToInsert, cell);\n          // This cell will overlap cells in rows below so skip them (because of `includeAllSlots` option) - (cell \"a\")\n          const lastCellRow = cellAnchorRow + cellHeight - 1;\n          for (let i = row; i <= lastCellRow; i++) {\n            tableWalker.skipRow(i);\n          }\n        } else {\n          // It's either cell at this column index or spanned cell by a row-spanned cell from row above.\n          // In table above it's cell \"e\" and a spanned position from row below (empty cell between cells \"g\" and \"h\")\n          createCells(columnsToInsert, writer, tableSlot.getPositionBefore());\n        }\n      }\n    });\n  }\n  /**\n  * Removes rows from the given `table`.\n  *\n  * This method re-calculates the table geometry including `rowspan` attribute of table cells overlapping removed rows\n  * and table headings values.\n  *\n  * ```ts\n  * editor.plugins.get( 'TableUtils' ).removeRows( table, { at: 1, rows: 2 } );\n  * ```\n  *\n  * Executing the above code in the context of the table on the left will transform its structure as presented on the right:\n  *\n  *  row index\n  *      â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”        `at` = 1        â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”\n  *    0 â”‚ a â”‚ b â”‚ c â”‚        `rows` = 2      â”‚ a â”‚ b â”‚ c â”‚ 0\n  *      â”‚   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¤                        â”‚   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¤\n  *    1 â”‚   â”‚ d â”‚ e â”‚  <-- remove from here  â”‚   â”‚ d â”‚ g â”‚ 1\n  *      â”‚   â”‚   â”œâ”€â”€â”€â”¤        will give:      â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤\n  *    2 â”‚   â”‚   â”‚ f â”‚                        â”‚ h â”‚ i â”‚ j â”‚ 2\n  *      â”‚   â”‚   â”œâ”€â”€â”€â”¤                        â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜\n  *    3 â”‚   â”‚   â”‚ g â”‚\n  *      â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤\n  *    4 â”‚ h â”‚ i â”‚ j â”‚\n  *      â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜\n  *\n  * @param options.at The row index at which the removing rows will start.\n  * @param options.rows The number of rows to remove. Default value is 1.\n  */\n  removeRows(table, options) {\n    const model = this.editor.model;\n    const rowsToRemove = options.rows || 1;\n    const rowCount = this.getRows(table);\n    const first = options.at;\n    const last = first + rowsToRemove - 1;\n    if (last > rowCount - 1) {\n      /**\n      * The `options.at` param must point at existing row and `options.rows` must not exceed the rows in the table.\n      *\n      * @error tableutils-removerows-row-index-out-of-range\n      */\n      throw new CKEditorError('tableutils-removerows-row-index-out-of-range', this, {\n        table,\n        options\n      });\n    }\n    model.change(writer => {\n      const indexesObject = {\n        first,\n        last\n      };\n      // Removing rows from the table require that most calculations to be done prior to changing table structure.\n      // Preparations must be done in the same enqueueChange callback to use the current table structure.\n      // 1. Preparation - get row-spanned cells that have to be modified after removing rows.\n      const {\n        cellsToMove,\n        cellsToTrim\n      } = getCellsToMoveAndTrimOnRemoveRow(table, indexesObject);\n      // 2. Execution\n      // 2a. Move cells from removed rows that extends over a removed section - must be done before removing rows.\n      // This will fill any gaps in a rows below that previously were empty because of row-spanned cells.\n      if (cellsToMove.size) {\n        const rowAfterRemovedSection = last + 1;\n        moveCellsToRow(table, rowAfterRemovedSection, cellsToMove, writer);\n      }\n      // 2b. Remove all required rows.\n      for (let i = last; i >= first; i--) {\n        writer.remove(table.getChild(i));\n      }\n      // 2c. Update cells from rows above that overlap removed section. Similar to step 2 but does not involve moving cells.\n      for (const {\n        rowspan,\n        cell\n      } of cellsToTrim) {\n        updateNumericAttribute('rowspan', rowspan, cell, writer);\n      }\n      // 2d. Adjust heading rows if removed rows were in a heading section.\n      updateHeadingRows(table, indexesObject, writer);\n      // 2e. Remove empty columns (without anchored cells) if there are any.\n      if (!removeEmptyColumns(table, this)) {\n        // If there wasn't any empty columns then we still need to check if this wasn't called\n        // because of cleaning empty rows and we only removed one of them.\n        removeEmptyRows(table, this);\n      }\n    });\n  }\n  /**\n  * Removes columns from the given `table`.\n  *\n  * This method re-calculates the table geometry including the `colspan` attribute of table cells overlapping removed columns\n  * and table headings values.\n  *\n  * ```ts\n  * editor.plugins.get( 'TableUtils' ).removeColumns( table, { at: 1, columns: 2 } );\n  * ```\n  *\n  * Executing the above code in the context of the table on the left will transform its structure as presented on the right:\n  *\n  *    0   1   2   3   4                       0   1   2\n  *  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”\n  *  â”‚ a             â”‚ b â”‚                   â”‚ a     â”‚ b â”‚\n  *  â”‚               â”œâ”€â”€â”€â”¤                   â”‚       â”œâ”€â”€â”€â”¤\n  *  â”‚               â”‚ c â”‚                   â”‚       â”‚ c â”‚\n  *  â”œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¤     will give:    â”œâ”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¤\n  *  â”‚ d â”‚ e â”‚ f â”‚ g â”‚ h â”‚                   â”‚ d â”‚ g â”‚ h â”‚\n  *  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤   â”œâ”€â”€â”€â”¤                   â”œâ”€â”€â”€â”¤   â”œâ”€â”€â”€â”¤\n  *  â”‚ i â”‚ j â”‚ k â”‚   â”‚ l â”‚                   â”‚ i â”‚   â”‚ l â”‚\n  *  â”œâ”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”¤                   â”œâ”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”¤\n  *  â”‚ m                 â”‚                   â”‚ m         â”‚\n  *  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  *        ^---- remove from here, `at` = 1, `columns` = 2\n  *\n  * @param options.at The row index at which the removing columns will start.\n  * @param options.columns The number of columns to remove.\n  */\n  removeColumns(table, options) {\n    const model = this.editor.model;\n    const first = options.at;\n    const columnsToRemove = options.columns || 1;\n    const last = options.at + columnsToRemove - 1;\n    model.change(writer => {\n      adjustHeadingColumns(table, {\n        first,\n        last\n      }, writer);\n      const tableColumns = getTableColumnElements(table);\n      for (let removedColumnIndex = last; removedColumnIndex >= first; removedColumnIndex--) {\n        for (const {\n          cell,\n          column,\n          cellWidth\n        } of [...new TableWalker(table)]) {\n          // If colspaned cell overlaps removed column decrease its span.\n          if (column <= removedColumnIndex && cellWidth > 1 && column + cellWidth > removedColumnIndex) {\n            updateNumericAttribute('colspan', cellWidth - 1, cell, writer);\n          } else if (column === removedColumnIndex) {\n            // The cell in removed column has colspan of 1.\n            writer.remove(cell);\n          }\n        }\n        // If table has `tableColumn` elements, we need to update it manually.\n        // See https://github.com/ckeditor/ckeditor5/issues/14521#issuecomment-1662102889 for details.\n        if (tableColumns[removedColumnIndex]) {\n          // If the removed column is the first one then we need to add its width to the next column.\n          // Otherwise we add it to the previous column.\n          const adjacentColumn = removedColumnIndex === 0 ? tableColumns[1] : tableColumns[removedColumnIndex - 1];\n          const removedColumnWidth = parseFloat(tableColumns[removedColumnIndex].getAttribute('columnWidth'));\n          const adjacentColumnWidth = parseFloat(adjacentColumn.getAttribute('columnWidth'));\n          writer.remove(tableColumns[removedColumnIndex]);\n          // Add the removed column width (in %) to the adjacent column.\n          writer.setAttribute('columnWidth', removedColumnWidth + adjacentColumnWidth + '%', adjacentColumn);\n        }\n      }\n      // Remove empty rows that could appear after removing columns.\n      if (!removeEmptyRows(table, this)) {\n        // If there wasn't any empty rows then we still need to check if this wasn't called\n        // because of cleaning empty columns and we only removed one of them.\n        removeEmptyColumns(table, this);\n      }\n    });\n  }\n  /**\n  * Divides a table cell vertically into several ones.\n  *\n  * The cell will be visually split into more cells by updating colspans of other cells in a column\n  * and inserting cells (columns) after that cell.\n  *\n  * In the table below, if cell \"a\" is split into 3 cells:\n  *\n  *  +---+---+---+\n  *  | a | b | c |\n  *  +---+---+---+\n  *  | d | e | f |\n  *  +---+---+---+\n  *\n  * it will result in the table below:\n  *\n  *  +---+---+---+---+---+\n  *  | a |   |   | b | c |\n  *  +---+---+---+---+---+\n  *  | d         | e | f |\n  *  +---+---+---+---+---+\n  *\n  * So cell \"d\" will get its `colspan` updated to `3` and 2 cells will be added (2 columns will be created).\n  *\n  * Splitting a cell that already has a `colspan` attribute set will distribute the cell `colspan` evenly and the remainder\n  * will be left to the original cell:\n  *\n  *  +---+---+---+\n  *  | a         |\n  *  +---+---+---+\n  *  | b | c | d |\n  *  +---+---+---+\n  *\n  * Splitting cell \"a\" with `colspan=3` into 2 cells will create 1 cell with a `colspan=a` and cell \"a\" that will have `colspan=2`:\n  *\n  *  +---+---+---+\n  *  | a     |   |\n  *  +---+---+---+\n  *  | b | c | d |\n  *  +---+---+---+\n  */\n  splitCellVertically(tableCell, numberOfCells = 2) {\n    const model = this.editor.model;\n    const tableRow = tableCell.parent;\n    const table = tableRow.parent;\n    const rowspan = parseInt(tableCell.getAttribute('rowspan') || '1');\n    const colspan = parseInt(tableCell.getAttribute('colspan') || '1');\n    model.change(writer => {\n      // First check - the cell spans over multiple rows so before doing anything else just split this cell.\n      if (colspan > 1) {\n        // Get spans of new (inserted) cells and span to update of split cell.\n        const {\n          newCellsSpan,\n          updatedSpan\n        } = breakSpanEvenly(colspan, numberOfCells);\n        updateNumericAttribute('colspan', updatedSpan, tableCell, writer);\n        // Each inserted cell will have the same attributes:\n        const newCellsAttributes = {};\n        // Do not store default value in the model.\n        if (newCellsSpan > 1) {\n          newCellsAttributes.colspan = newCellsSpan;\n        }\n        // Copy rowspan of split cell.\n        if (rowspan > 1) {\n          newCellsAttributes.rowspan = rowspan;\n        }\n        const cellsToInsert = colspan > numberOfCells ? numberOfCells - 1 : colspan - 1;\n        createCells(cellsToInsert, writer, writer.createPositionAfter(tableCell), newCellsAttributes);\n      }\n      // Second check - the cell has colspan of 1 or we need to create more cells then the currently one spans over.\n      if (colspan < numberOfCells) {\n        const cellsToInsert = numberOfCells - colspan;\n        // First step: expand cells on the same column as split cell.\n        const tableMap = [...new TableWalker(table)];\n        // Get the column index of split cell.\n        const {\n          column: splitCellColumn\n        } = tableMap.find(({\n          cell\n        }) => cell === tableCell);\n        // Find cells which needs to be expanded vertically - those on the same column or those that spans over split cell's column.\n        const cellsToUpdate = tableMap.filter(({\n          cell,\n          cellWidth,\n          column\n        }) => {\n          const isOnSameColumn = cell !== tableCell && column === splitCellColumn;\n          const spansOverColumn = column < splitCellColumn && column + cellWidth > splitCellColumn;\n          return isOnSameColumn || spansOverColumn;\n        });\n        // Expand cells vertically.\n        for (const {\n          cell,\n          cellWidth\n        } of cellsToUpdate) {\n          writer.setAttribute('colspan', cellWidth + cellsToInsert, cell);\n        }\n        // Second step: create columns after split cell.\n        // Each inserted cell will have the same attributes:\n        const newCellsAttributes = {};\n        // Do not store default value in the model.\n        // Copy rowspan of split cell.\n        if (rowspan > 1) {\n          newCellsAttributes.rowspan = rowspan;\n        }\n        createCells(cellsToInsert, writer, writer.createPositionAfter(tableCell), newCellsAttributes);\n        const headingColumns = table.getAttribute('headingColumns') || 0;\n        // Update heading section if split cell is in heading section.\n        if (headingColumns > splitCellColumn) {\n          updateNumericAttribute('headingColumns', headingColumns + cellsToInsert, table, writer);\n        }\n      }\n    });\n  }\n  /**\n  * Divides a table cell horizontally into several ones.\n  *\n  * The cell will be visually split into more cells by updating rowspans of other cells in the row and inserting rows with a single cell\n  * below.\n  *\n  * If in the table below cell \"b\" is split into 3 cells:\n  *\n  *  +---+---+---+\n  *  | a | b | c |\n  *  +---+---+---+\n  *  | d | e | f |\n  *  +---+---+---+\n  *\n  * It will result in the table below:\n  *\n  *  +---+---+---+\n  *  | a | b | c |\n  *  +   +---+   +\n  *  |   |   |   |\n  *  +   +---+   +\n  *  |   |   |   |\n  *  +---+---+---+\n  *  | d | e | f |\n  *  +---+---+---+\n  *\n  * So cells \"a\" and \"b\" will get their `rowspan` updated to `3` and 2 rows with a single cell will be added.\n  *\n  * Splitting a cell that already has a `rowspan` attribute set will distribute the cell `rowspan` evenly and the remainder\n  * will be left to the original cell:\n  *\n  *  +---+---+---+\n  *  | a | b | c |\n  *  +   +---+---+\n  *  |   | d | e |\n  *  +   +---+---+\n  *  |   | f | g |\n  *  +   +---+---+\n  *  |   | h | i |\n  *  +---+---+---+\n  *\n  * Splitting cell \"a\" with `rowspan=4` into 3 cells will create 2 cells with a `rowspan=1` and cell \"a\" will have `rowspan=2`:\n  *\n  *  +---+---+---+\n  *  | a | b | c |\n  *  +   +---+---+\n  *  |   | d | e |\n  *  +---+---+---+\n  *  |   | f | g |\n  *  +---+---+---+\n  *  |   | h | i |\n  *  +---+---+---+\n  */\n  splitCellHorizontally(tableCell, numberOfCells = 2) {\n    const model = this.editor.model;\n    const tableRow = tableCell.parent;\n    const table = tableRow.parent;\n    const splitCellRow = table.getChildIndex(tableRow);\n    const rowspan = parseInt(tableCell.getAttribute('rowspan') || '1');\n    const colspan = parseInt(tableCell.getAttribute('colspan') || '1');\n    model.change(writer => {\n      // First check - the cell spans over multiple rows so before doing anything else just split this cell.\n      if (rowspan > 1) {\n        // Cache table map before updating table.\n        const tableMap = [...new TableWalker(table, {\n          startRow: splitCellRow,\n          endRow: splitCellRow + rowspan - 1,\n          includeAllSlots: true\n        })];\n        // Get spans of new (inserted) cells and span to update of split cell.\n        const {\n          newCellsSpan,\n          updatedSpan\n        } = breakSpanEvenly(rowspan, numberOfCells);\n        updateNumericAttribute('rowspan', updatedSpan, tableCell, writer);\n        const {\n          column: cellColumn\n        } = tableMap.find(({\n          cell\n        }) => cell === tableCell);\n        // Each inserted cell will have the same attributes:\n        const newCellsAttributes = {};\n        // Do not store default value in the model.\n        if (newCellsSpan > 1) {\n          newCellsAttributes.rowspan = newCellsSpan;\n        }\n        // Copy colspan of split cell.\n        if (colspan > 1) {\n          newCellsAttributes.colspan = colspan;\n        }\n        // Accumulator that stores distance from the last inserted cell span.\n        // It helps with evenly splitting larger cell spans (for example 10 cells collapsing into 3 cells).\n        // We split these cells into 3, 3, 4 cells and we have to call `createCells` only when distance between\n        // these cells is equal or greater than the new cells span size.\n        let distanceFromLastCellSpan = 0;\n        for (const tableSlot of tableMap) {\n          const {\n            column,\n            row\n          } = tableSlot;\n          // As both newly created cells and the split cell might have rowspan,\n          // the insertion of new cells must go to appropriate rows:\n          //\n          // 1. It's a row after split cell + it's height.\n          const isAfterSplitCell = row >= splitCellRow + updatedSpan;\n          // 2. Is on the same column.\n          const isOnSameColumn = column === cellColumn;\n          // Reset distance from the last cell span if we are on the same column and we exceeded the new cells span size.\n          if (distanceFromLastCellSpan >= newCellsSpan && isOnSameColumn) {\n            distanceFromLastCellSpan = 0;\n          }\n          if (isAfterSplitCell && isOnSameColumn) {\n            // Create new cells only if the distance from the last cell span is equal or greater than the new cells span.\n            if (!distanceFromLastCellSpan) {\n              createCells(1, writer, tableSlot.getPositionBefore(), newCellsAttributes);\n            }\n            // Increase the distance from the last cell span.\n            distanceFromLastCellSpan++;\n          }\n        }\n      }\n      // Second check - the cell has rowspan of 1 or we need to create more cells than the current cell spans over.\n      if (rowspan < numberOfCells) {\n        // We already split the cell in check one so here we split to the remaining number of cells only.\n        const cellsToInsert = numberOfCells - rowspan;\n        // This check is needed since we need to check if there are any cells from previous rows than spans over this cell's row.\n        const tableMap = [...new TableWalker(table, {\n          startRow: 0,\n          endRow: splitCellRow\n        })];\n        // First step: expand cells.\n        for (const {\n          cell,\n          cellHeight,\n          row\n        } of tableMap) {\n          // Expand rowspan of cells that are either:\n          // - on the same row as current cell,\n          // - or are below split cell row and overlaps that row.\n          if (cell !== tableCell && row + cellHeight > splitCellRow) {\n            const rowspanToSet = cellHeight + cellsToInsert;\n            writer.setAttribute('rowspan', rowspanToSet, cell);\n          }\n        }\n        // Second step: create rows with single cell below split cell.\n        const newCellsAttributes = {};\n        // Copy colspan of split cell.\n        if (colspan > 1) {\n          newCellsAttributes.colspan = colspan;\n        }\n        createEmptyRows(writer, table, splitCellRow + 1, cellsToInsert, 1, newCellsAttributes);\n        // Update heading section if split cell is in heading section.\n        const headingRows = table.getAttribute('headingRows') || 0;\n        if (headingRows > splitCellRow) {\n          updateNumericAttribute('headingRows', headingRows + cellsToInsert, table, writer);\n        }\n      }\n    });\n  }\n  /**\n  * Returns the number of columns for a given table.\n  *\n  * ```ts\n  * editor.plugins.get( 'TableUtils' ).getColumns( table );\n  * ```\n  *\n  * @param table The table to analyze.\n  */\n  getColumns(table) {\n    // Analyze first row only as all the rows should have the same width.\n    // Using the first row without checking if it's a tableRow because we expect\n    // that table will have only tableRow model elements at the beginning.\n    const row = table.getChild(0);\n    return [...row.getChildren()] // $marker elements can also be children of a row too (when TrackChanges is on). Don't include them in the count.\n    .filter(node => node.is('element', 'tableCell')).reduce((columns, row) => {\n      const columnWidth = parseInt(row.getAttribute('colspan') || '1');\n      return columns + columnWidth;\n    }, 0);\n  }\n  /**\n  * Returns the number of rows for a given table. Any other element present in the table model is omitted.\n  *\n  * ```ts\n  * editor.plugins.get( 'TableUtils' ).getRows( table );\n  * ```\n  *\n  * @param table The table to analyze.\n  */\n  getRows(table) {\n    // Rowspan not included due to #6427.\n    return Array.from(table.getChildren()).reduce((rowCount, child) => child.is('element', 'tableRow') ? rowCount + 1 : rowCount, 0);\n  }\n  /**\n  * Creates an instance of the table walker.\n  *\n  * The table walker iterates internally by traversing the table from row index = 0 and column index = 0.\n  * It walks row by row and column by column in order to output values defined in the options.\n  * By default it will output only the locations that are occupied by a cell. To include also spanned rows and columns,\n  * pass the `includeAllSlots` option.\n  *\n  * @internal\n  * @param table A table over which the walker iterates.\n  * @param options An object with configuration.\n  */\n  createTableWalker(table, options = {}) {\n    return new TableWalker(table, options);\n  }\n  /**\n  * Returns all model table cells that are fully selected (from the outside)\n  * within the provided model selection's ranges.\n  *\n  * To obtain the cells selected from the inside, use\n  * {@link #getTableCellsContainingSelection}.\n  */\n  getSelectedTableCells(selection) {\n    const cells = [];\n    for (const range of this.sortRanges(selection.getRanges())) {\n      const element = range.getContainedElement();\n      if (element && element.is('element', 'tableCell')) {\n        cells.push(element);\n      }\n    }\n    return cells;\n  }\n  /**\n  * Returns all model table cells that the provided model selection's ranges\n  * {@link module:engine/model/range~Range#start} inside.\n  *\n  * To obtain the cells selected from the outside, use\n  * {@link #getSelectedTableCells}.\n  */\n  getTableCellsContainingSelection(selection) {\n    const cells = [];\n    for (const range of selection.getRanges()) {\n      const cellWithSelection = range.start.findAncestor('tableCell');\n      if (cellWithSelection) {\n        cells.push(cellWithSelection);\n      }\n    }\n    return cells;\n  }\n  /**\n  * Returns all model table cells that are either completely selected\n  * by selection ranges or host selection range\n  * {@link module:engine/model/range~Range#start start positions} inside them.\n  *\n  * Combines {@link #getTableCellsContainingSelection} and\n  * {@link #getSelectedTableCells}.\n  */\n  getSelectionAffectedTableCells(selection) {\n    const selectedCells = this.getSelectedTableCells(selection);\n    if (selectedCells.length) {\n      return selectedCells;\n    }\n    return this.getTableCellsContainingSelection(selection);\n  }\n  /**\n  * Returns an object with the `first` and `last` row index contained in the given `tableCells`.\n  *\n  * ```ts\n  * const selectedTableCells = getSelectedTableCells( editor.model.document.selection );\n  *\n  * const { first, last } = getRowIndexes( selectedTableCells );\n  *\n  * console.log( `Selected rows: ${ first } to ${ last }` );\n  * ```\n  *\n  * @returns Returns an object with the `first` and `last` table row indexes.\n  */\n  getRowIndexes(tableCells) {\n    const indexes = tableCells.map(cell => cell.parent.index);\n    return this._getFirstLastIndexesObject(indexes);\n  }\n  /**\n  * Returns an object with the `first` and `last` column index contained in the given `tableCells`.\n  *\n  * ```ts\n  * const selectedTableCells = getSelectedTableCells( editor.model.document.selection );\n  *\n  * const { first, last } = getColumnIndexes( selectedTableCells );\n  *\n  * console.log( `Selected columns: ${ first } to ${ last }` );\n  * ```\n  *\n  * @returns Returns an object with the `first` and `last` table column indexes.\n  */\n  getColumnIndexes(tableCells) {\n    const table = tableCells[0].findAncestor('table');\n    const tableMap = [...new TableWalker(table)];\n    const indexes = tableMap.filter(entry => tableCells.includes(entry.cell)).map(entry => entry.column);\n    return this._getFirstLastIndexesObject(indexes);\n  }\n  /**\n  * Checks if the selection contains cells that do not exceed rectangular selection.\n  *\n  * In a table below:\n  *\n  *  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”\n  *  â”‚ a â”‚ b â”‚ c â”‚ d â”‚\n  *  â”œâ”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”¤   â”‚\n  *  â”‚ e     â”‚ f â”‚   â”‚\n  *  â”‚       â”œâ”€â”€â”€â”¼â”€â”€â”€â”¤\n  *  â”‚       â”‚ g â”‚ h â”‚\n  *  â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜\n  *\n  * Valid selections are these which create a solid rectangle (without gaps), such as:\n  *   - a, b (two horizontal cells)\n  *   - c, f (two vertical cells)\n  *   - a, b, e (cell \"e\" spans over four cells)\n  *   - c, d, f (cell d spans over a cell in the row below)\n  *\n  * While an invalid selection would be:\n  *   - a, c (the unselected cell \"b\" creates a gap)\n  *   - f, g, h (cell \"d\" spans over a cell from the row of \"f\" cell - thus creates a gap)\n  */\n  isSelectionRectangular(selectedTableCells) {\n    if (selectedTableCells.length < 2 || !this._areCellInTheSameTableSection(selectedTableCells)) {\n      return false;\n    }\n    // A valid selection is a fully occupied rectangle composed of table cells.\n    // Below we will calculate the area of a selected table cells and the area of valid selection.\n    // The area of a valid selection is defined by top-left and bottom-right cells.\n    const rows = new Set();\n    const columns = new Set();\n    let areaOfSelectedCells = 0;\n    for (const tableCell of selectedTableCells) {\n      const {\n        row,\n        column\n      } = this.getCellLocation(tableCell);\n      const rowspan = parseInt(tableCell.getAttribute('rowspan')) || 1;\n      const colspan = parseInt(tableCell.getAttribute('colspan')) || 1;\n      // Record row & column indexes of current cell.\n      rows.add(row);\n      columns.add(column);\n      // For cells that spans over multiple rows add also the last row that this cell spans over.\n      if (rowspan > 1) {\n        rows.add(row + rowspan - 1);\n      }\n      // For cells that spans over multiple columns add also the last column that this cell spans over.\n      if (colspan > 1) {\n        columns.add(column + colspan - 1);\n      }\n      areaOfSelectedCells += rowspan * colspan;\n    }\n    // We can only merge table cells that are in adjacent rows...\n    const areaOfValidSelection = getBiggestRectangleArea(rows, columns);\n    return areaOfValidSelection == areaOfSelectedCells;\n  }\n  /**\n  * Returns array of sorted ranges.\n  */\n  sortRanges(ranges) {\n    return Array.from(ranges).sort(compareRangeOrder);\n  }\n  /**\n  * Helper method to get an object with `first` and `last` indexes from an unsorted array of indexes.\n  */\n  _getFirstLastIndexesObject(indexes) {\n    const allIndexesSorted = indexes.sort((indexA, indexB) => indexA - indexB);\n    const first = allIndexesSorted[0];\n    const last = allIndexesSorted[allIndexesSorted.length - 1];\n    return {\n      first,\n      last\n    };\n  }\n  /**\n  * Checks if the selection does not mix a header (column or row) with other cells.\n  *\n  * For instance, in the table below valid selections consist of cells with the same letter only.\n  * So, a-a (same heading row and column) or d-d (body cells) are valid while c-d or a-b are not.\n  *\n  * header columns\n  *    â†“   â†“\n  *  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”\n  *  â”‚ a â”‚ a â”‚ b â”‚ b â”‚  â† header row\n  *  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤\n  *  â”‚ c â”‚ c â”‚ d â”‚ d â”‚\n  *  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤\n  *  â”‚ c â”‚ c â”‚ d â”‚ d â”‚\n  *  â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜\n  */\n  _areCellInTheSameTableSection(tableCells) {\n    const table = tableCells[0].findAncestor('table');\n    const rowIndexes = this.getRowIndexes(tableCells);\n    const headingRows = parseInt(table.getAttribute('headingRows')) || 0;\n    // Calculating row indexes is a bit cheaper so if this check fails we can't merge.\n    if (!this._areIndexesInSameSection(rowIndexes, headingRows)) {\n      return false;\n    }\n    const columnIndexes = this.getColumnIndexes(tableCells);\n    const headingColumns = parseInt(table.getAttribute('headingColumns')) || 0;\n    // Similarly cells must be in same column section.\n    return this._areIndexesInSameSection(columnIndexes, headingColumns);\n  }\n  /**\n  * Unified check if table rows/columns indexes are in the same heading/body section.\n  */\n  _areIndexesInSameSection({\n    first,\n    last\n  }, headingSectionSize) {\n    const firstCellIsInHeading = first < headingSectionSize;\n    const lastCellIsInHeading = last < headingSectionSize;\n    return firstCellIsInHeading === lastCellIsInHeading;\n  }\n}\n/**\n * Creates empty rows at the given index in an existing table.\n *\n * @param insertAt The row index of row insertion.\n * @param rows The number of rows to create.\n * @param tableCellToInsert The number of cells to insert in each row.\n */\nfunction createEmptyRows(writer, table, insertAt, rows, tableCellToInsert, attributes = {}) {\n  for (let i = 0; i < rows; i++) {\n    const tableRow = writer.createElement('tableRow');\n    writer.insert(tableRow, table, insertAt);\n    createCells(tableCellToInsert, writer, writer.createPositionAt(tableRow, 'end'), attributes);\n  }\n}\n/**\n * Creates cells at a given position.\n *\n * @param cells The number of cells to create\n */\nfunction createCells(cells, writer, insertPosition, attributes = {}) {\n  for (let i = 0; i < cells; i++) {\n    createEmptyTableCell(writer, insertPosition, attributes);\n  }\n}\n/**\n * Evenly distributes the span of a cell to a number of provided cells.\n * The resulting spans will always be integer values.\n *\n * For instance breaking a span of 7 into 3 cells will return:\n *\n * ```ts\n * { newCellsSpan: 2, updatedSpan: 3 }\n * ```\n *\n * as two cells will have a span of 2 and the remainder will go the first cell so its span will change to 3.\n *\n * @param span The span value do break.\n * @param numberOfCells The number of resulting spans.\n */\nfunction breakSpanEvenly(span, numberOfCells) {\n  if (span < numberOfCells) {\n    return {\n      newCellsSpan: 1,\n      updatedSpan: 1\n    };\n  }\n  const newCellsSpan = Math.floor(span / numberOfCells);\n  const updatedSpan = span - newCellsSpan * numberOfCells + newCellsSpan;\n  return {\n    newCellsSpan,\n    updatedSpan\n  };\n}\n/**\n * Updates heading columns attribute if removing a row from head section.\n */\nfunction adjustHeadingColumns(table, removedColumnIndexes, writer) {\n  const headingColumns = table.getAttribute('headingColumns') || 0;\n  if (headingColumns && removedColumnIndexes.first < headingColumns) {\n    const headingsRemoved = Math.min(headingColumns - 1 /* Other numbers are 0-based */, removedColumnIndexes.last) - removedColumnIndexes.first + 1;\n    writer.setAttribute('headingColumns', headingColumns - headingsRemoved, table);\n  }\n}\n/**\n * Calculates a new heading rows value for removing rows from heading section.\n */\nfunction updateHeadingRows(table, {\n  first,\n  last\n}, writer) {\n  const headingRows = table.getAttribute('headingRows') || 0;\n  if (first < headingRows) {\n    const newRows = last < headingRows ? headingRows - (last - first + 1) : first;\n    updateNumericAttribute('headingRows', newRows, table, writer, 0);\n  }\n}\n/**\n * Finds cells that will be:\n * - trimmed - Cells that are \"above\" removed rows sections and overlap the removed section - their rowspan must be trimmed.\n * - moved - Cells from removed rows section might stick out of. These cells are moved to the next row after a removed section.\n *\n * Sample table with overlapping & sticking out cells:\n *\n *      +----+----+----+----+----+\n *      | 00 | 01 | 02 | 03 | 04 |\n *      +----+    +    +    +    +\n *      | 10 |    |    |    |    |\n *      +----+----+    +    +    +\n *      | 20 | 21 |    |    |    | <-- removed row\n *      +    +    +----+    +    +\n *      |    |    | 32 |    |    | <-- removed row\n *      +----+    +    +----+    +\n *      | 40 |    |    | 43 |    |\n *      +----+----+----+----+----+\n *\n * In a table above:\n * - cells to trim: '02', '03' & '04'.\n * - cells to move: '21' & '32'.\n */\nfunction getCellsToMoveAndTrimOnRemoveRow(table, {\n  first,\n  last\n}) {\n  const cellsToMove = new Map();\n  const cellsToTrim = [];\n  for (const {\n    row,\n    column,\n    cellHeight,\n    cell\n  } of new TableWalker(table, {\n    endRow: last\n  })) {\n    const lastRowOfCell = row + cellHeight - 1;\n    const isCellStickingOutFromRemovedRows = row >= first && row <= last && lastRowOfCell > last;\n    if (isCellStickingOutFromRemovedRows) {\n      const rowspanInRemovedSection = last - row + 1;\n      const rowSpanToSet = cellHeight - rowspanInRemovedSection;\n      cellsToMove.set(column, {\n        cell,\n        rowspan: rowSpanToSet\n      });\n    }\n    const isCellOverlappingRemovedRows = row < first && lastRowOfCell >= first;\n    if (isCellOverlappingRemovedRows) {\n      let rowspanAdjustment;\n      // Cell fully covers removed section - trim it by removed rows count.\n      if (lastRowOfCell >= last) {\n        rowspanAdjustment = last - first + 1;\n      } else {\n        rowspanAdjustment = lastRowOfCell - first + 1;\n      }\n      cellsToTrim.push({\n        cell,\n        rowspan: cellHeight - rowspanAdjustment\n      });\n    }\n  }\n  return {\n    cellsToMove,\n    cellsToTrim\n  };\n}\nfunction moveCellsToRow(table, targetRowIndex, cellsToMove, writer) {\n  const tableWalker = new TableWalker(table, {\n    includeAllSlots: true,\n    row: targetRowIndex\n  });\n  const tableRowMap = [...tableWalker];\n  const row = table.getChild(targetRowIndex);\n  let previousCell;\n  for (const {\n    column,\n    cell,\n    isAnchor\n  } of tableRowMap) {\n    if (cellsToMove.has(column)) {\n      const {\n        cell: cellToMove,\n        rowspan\n      } = cellsToMove.get(column);\n      const targetPosition = previousCell ? writer.createPositionAfter(previousCell) : writer.createPositionAt(row, 0);\n      writer.move(writer.createRangeOn(cellToMove), targetPosition);\n      updateNumericAttribute('rowspan', rowspan, cellToMove, writer);\n      previousCell = cellToMove;\n    } else if (isAnchor) {\n      // If cell is spanned then `cell` holds reference to overlapping cell. See ckeditor/ckeditor5#6502.\n      previousCell = cell;\n    }\n  }\n}\nfunction compareRangeOrder(rangeA, rangeB) {\n  // Since table cell ranges are disjoint, it's enough to check their start positions.\n  const posA = rangeA.start;\n  const posB = rangeB.start;\n  // Checking for equal position (returning 0) is not needed because this would be either:\n  // a. Intersecting range (not allowed by model)\n  // b. Collapsed range on the same position (allowed by model but should not happen).\n  return posA.isBefore(posB) ? -1 : 1;\n}\n/**\n * Calculates the area of a maximum rectangle that can span over the provided row & column indexes.\n */\nfunction getBiggestRectangleArea(rows, columns) {\n  const rowsIndexes = Array.from(rows.values());\n  const columnIndexes = Array.from(columns.values());\n  const lastRow = Math.max(...rowsIndexes);\n  const firstRow = Math.min(...rowsIndexes);\n  const lastColumn = Math.max(...columnIndexes);\n  const firstColumn = Math.min(...columnIndexes);\n  return (lastRow - firstRow + 1) * (lastColumn - firstColumn + 1);\n}\n\n/**\n * The merge cells command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'mergeTableCells'` editor command.\n *\n * For example, to merge selected table cells:\n *\n * ```ts\n * editor.execute( 'mergeTableCells' );\n * ```\n */\nclass MergeCellsCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const tableUtils = this.editor.plugins.get(TableUtils);\n    const selectedTableCells = tableUtils.getSelectedTableCells(this.editor.model.document.selection);\n    this.isEnabled = tableUtils.isSelectionRectangular(selectedTableCells);\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  */\n  execute() {\n    const model = this.editor.model;\n    const tableUtils = this.editor.plugins.get(TableUtils);\n    model.change(writer => {\n      const selectedTableCells = tableUtils.getSelectedTableCells(model.document.selection);\n      // All cells will be merged into the first one.\n      const firstTableCell = selectedTableCells.shift();\n      // Update target cell dimensions.\n      const {\n        mergeWidth,\n        mergeHeight\n      } = getMergeDimensions(firstTableCell, selectedTableCells, tableUtils);\n      updateNumericAttribute('colspan', mergeWidth, firstTableCell, writer);\n      updateNumericAttribute('rowspan', mergeHeight, firstTableCell, writer);\n      for (const tableCell of selectedTableCells) {\n        mergeTableCells(tableCell, firstTableCell, writer);\n      }\n      const table = firstTableCell.findAncestor('table');\n      // Remove rows and columns that become empty (have no anchored cells).\n      removeEmptyRowsColumns(table, tableUtils);\n      writer.setSelection(firstTableCell, 'in');\n    });\n  }\n}\n/**\n *  Merges two table cells. It will ensure that after merging cells with empty paragraphs the resulting table cell will only have one\n * paragraph. If one of the merged table cells is empty, the merged table cell will have contents of the non-empty table cell.\n * If both are empty, the merged table cell will have only one empty paragraph.\n */\nfunction mergeTableCells(cellBeingMerged, targetCell, writer) {\n  if (!isEmpty$1(cellBeingMerged)) {\n    if (isEmpty$1(targetCell)) {\n      writer.remove(writer.createRangeIn(targetCell));\n    }\n    writer.move(writer.createRangeIn(cellBeingMerged), writer.createPositionAt(targetCell, 'end'));\n  }\n  // Remove merged table cell.\n  writer.remove(cellBeingMerged);\n}\n/**\n * Checks if the passed table cell contains an empty paragraph.\n */\nfunction isEmpty$1(tableCell) {\n  const firstTableChild = tableCell.getChild(0);\n  return tableCell.childCount == 1 && firstTableChild.is('element', 'paragraph') && firstTableChild.isEmpty;\n}\nfunction getMergeDimensions(firstTableCell, selectedTableCells, tableUtils) {\n  let maxWidthOffset = 0;\n  let maxHeightOffset = 0;\n  for (const tableCell of selectedTableCells) {\n    const {\n      row,\n      column\n    } = tableUtils.getCellLocation(tableCell);\n    maxWidthOffset = getMaxOffset(tableCell, column, maxWidthOffset, 'colspan');\n    maxHeightOffset = getMaxOffset(tableCell, row, maxHeightOffset, 'rowspan');\n  }\n  // Update table cell span attribute and merge set selection on a merged contents.\n  const {\n    row: firstCellRow,\n    column: firstCellColumn\n  } = tableUtils.getCellLocation(firstTableCell);\n  const mergeWidth = maxWidthOffset - firstCellColumn;\n  const mergeHeight = maxHeightOffset - firstCellRow;\n  return {\n    mergeWidth,\n    mergeHeight\n  };\n}\nfunction getMaxOffset(tableCell, start, currentMaxOffset, which) {\n  const dimensionValue = parseInt(tableCell.getAttribute(which) || '1');\n  return Math.max(currentMaxOffset, start + dimensionValue);\n}\n\n/**\n * The select row command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'selectTableRow'` editor command.\n *\n * To select the rows containing the selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'selectTableRow' );\n * ```\n */\nclass SelectRowCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    // It does not affect data so should be enabled in read-only mode.\n    this.affectsData = false;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const selectedCells = tableUtils.getSelectionAffectedTableCells(this.editor.model.document.selection);\n    this.isEnabled = selectedCells.length > 0;\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const model = this.editor.model;\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const referenceCells = tableUtils.getSelectionAffectedTableCells(model.document.selection);\n    const rowIndexes = tableUtils.getRowIndexes(referenceCells);\n    const table = referenceCells[0].findAncestor('table');\n    const rangesToSelect = [];\n    for (let rowIndex = rowIndexes.first; rowIndex <= rowIndexes.last; rowIndex++) {\n      for (const cell of table.getChild(rowIndex).getChildren()) {\n        rangesToSelect.push(model.createRangeOn(cell));\n      }\n    }\n    model.change(writer => {\n      writer.setSelection(rangesToSelect);\n    });\n  }\n}\n\n/**\n * The select column command.\n *\n * The command is registered by {@link module:table/tableediting~TableEditing} as the `'selectTableColumn'` editor command.\n *\n * To select the columns containing the selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'selectTableColumn' );\n * ```\n */\nclass SelectColumnCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    // It does not affect data so should be enabled in read-only mode.\n    this.affectsData = false;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const selectedCells = tableUtils.getSelectionAffectedTableCells(this.editor.model.document.selection);\n    this.isEnabled = selectedCells.length > 0;\n  }\n  /**\n  * @inheritDoc\n  */\n  execute() {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const model = this.editor.model;\n    const referenceCells = tableUtils.getSelectionAffectedTableCells(model.document.selection);\n    const firstCell = referenceCells[0];\n    const lastCell = referenceCells.pop();\n    const table = firstCell.findAncestor('table');\n    const startLocation = tableUtils.getCellLocation(firstCell);\n    const endLocation = tableUtils.getCellLocation(lastCell);\n    const startColumn = Math.min(startLocation.column, endLocation.column);\n    const endColumn = Math.max(startLocation.column, endLocation.column);\n    const rangesToSelect = [];\n    for (const cellInfo of new TableWalker(table, {\n      startColumn,\n      endColumn\n    })) {\n      rangesToSelect.push(model.createRangeOn(cellInfo.cell));\n    }\n    model.change(writer => {\n      writer.setSelection(rangesToSelect);\n    });\n  }\n}\n\n/**\n * Injects a table layout post-fixer into the model.\n *\n * The role of the table layout post-fixer is to ensure that the table rows have the correct structure\n * after a {@link module:engine/model/model~Model#change `change()`} block was executed.\n *\n * The correct structure means that:\n *\n * * All table rows have the same size.\n * * None of the table cells extend vertically beyond their section (either header or body).\n * * A table cell has always at least one element as a child.\n *\n * If the table structure is not correct, the post-fixer will automatically correct it in two steps:\n *\n * 1. It will clip table cells that extend beyond their section.\n * 2. It will add empty table cells to the rows that are narrower than the widest table row.\n *\n * ## Clipping overlapping table cells\n *\n * Such situation may occur when pasting a table (or a part of a table) to the editor from external sources.\n *\n * For example, see the following table which has a cell (FOO) with the rowspan attribute (2):\n *\n * ```xml\n * <table headingRows=\"1\">\n *   <tableRow>\n *     <tableCell rowspan=\"2\"><paragraph>FOO</paragraph></tableCell>\n *     <tableCell colspan=\"2\"><paragraph>BAR</paragraph></tableCell>\n *   </tableRow>\n *   <tableRow>\n *     <tableCell><paragraph>BAZ</paragraph></tableCell>\n *     <tableCell><paragraph>XYZ</paragraph></tableCell>\n *   </tableRow>\n * </table>\n * ```\n *\n * It will be rendered in the view as:\n *\n * ```xml\n * <table>\n *   <thead>\n *     <tr>\n *       <td rowspan=\"2\">FOO</td>\n *       <td colspan=\"2\">BAR</td>\n *     </tr>\n *   </thead>\n *   <tbody>\n *     <tr>\n *       <td>BAZ</td>\n *       <td>XYZ</td>\n *     </tr>\n *   </tbody>\n * </table>\n * ```\n *\n * In the above example the table will be rendered as a table with two rows: one in the header and second one in the body.\n * The table cell (FOO) cannot span over multiple rows as it would extend from the header to the body section.\n * The `rowspan` attribute must be changed to (1). The value (1) is the default value of the `rowspan` attribute\n * so the `rowspan` attribute will be removed from the model.\n *\n * The table cell with BAZ in the content will be in the first column of the table.\n *\n * ## Adding missing table cells\n *\n * The table post-fixer will insert empty table cells to equalize table row sizes (the number of columns).\n * The size of a table row is calculated by counting column spans of table cells, both horizontal (from the same row) and\n * vertical (from the rows above).\n *\n * In the above example, the table row in the body section of the table is narrower then the row from the header: it has two cells\n * with the default colspan (1). The header row has one cell with colspan (1) and the second with colspan (2).\n * The table cell (FOO) does not extend beyond the head section (and as such will be fixed in the first step of this post-fixer).\n * The post-fixer will add a missing table cell to the row in the body section of the table.\n *\n * The table from the above example will be fixed and rendered to the view as below:\n *\n * ```xml\n * <table>\n *   <thead>\n *     <tr>\n *       <td rowspan=\"2\">FOO</td>\n *       <td colspan=\"2\">BAR</td>\n *     </tr>\n *   </thead>\n *   <tbody>\n *     <tr>\n *       <td>BAZ</td>\n *       <td>XYZ</td>\n *     </tr>\n *   </tbody>\n * </table>\n * ```\n *\n * ## Collaboration and undo - Expectations vs post-fixer results\n *\n * The table post-fixer only ensures proper structure without a deeper analysis of the nature of the change. As such, it might lead\n * to a structure which was not intended by the user. In particular, it will also fix undo steps (in conjunction with collaboration)\n * in which the editor content might not return to the original state.\n *\n * This will usually happen when one or more users change the size of the table.\n *\n * As an example see the table below:\n *\n * ```xml\n * <table>\n *   <tbody>\n *     <tr>\n *       <td>11</td>\n *       <td>12</td>\n *     </tr>\n *     <tr>\n *       <td>21</td>\n *       <td>22</td>\n *     </tr>\n *   </tbody>\n * </table>\n * ```\n *\n * and the user actions:\n *\n * 1. Both users have a table with two rows and two columns.\n * 2. User A adds a column at the end of the table. This will insert empty table cells to two rows.\n * 3. User B adds a row at the end of the table. This will insert a row with two empty table cells.\n * 4. Both users will have a table as below:\n *\n * ```xml\n * <table>\n *   <tbody>\n *     <tr>\n *       <td>11</td>\n *       <td>12</td>\n *       <td>(empty, inserted by A)</td>\n *     </tr>\n *     <tr>\n *       <td>21</td>\n *       <td>22</td>\n *       <td>(empty, inserted by A)</td>\n *     </tr>\n *     <tr>\n *       <td>(empty, inserted by B)</td>\n *       <td>(empty, inserted by B)</td>\n *     </tr>\n *   </tbody>\n * </table>\n * ```\n *\n * The last row is shorter then others so the table post-fixer will add an empty row to the last row:\n *\n * ```xml\n * <table>\n *   <tbody>\n *     <tr>\n *       <td>11</td>\n *       <td>12</td>\n *       <td>(empty, inserted by A)</td>\n *     </tr>\n *     <tr>\n *       <td>21</td>\n *       <td>22</td>\n *       <td>(empty, inserted by A)</td>\n *     </tr>\n *     <tr>\n *       <td>(empty, inserted by B)</td>\n *       <td>(empty, inserted by B)</td>\n *       <td>(empty, inserted by the post-fixer)</td>\n *     </tr>\n *   </tbody>\n * </table>\n * ```\n *\n * Unfortunately undo does not know the nature of the changes and depending on which user applies the post-fixer changes, undoing them\n * might lead to a broken table. If User B undoes inserting the column to the table, the undo engine will undo only the operations of\n * inserting empty cells to rows from the initial table state (row 1 and 2) but the cell in the post-fixed row will remain:\n *\n * ```xml\n * <table>\n *   <tbody>\n *     <tr>\n *       <td>11</td>\n *       <td>12</td>\n *     </tr>\n *     <tr>\n *       <td>21</td>\n *       <td>22</td>\n *     </tr>\n *     <tr>\n *       <td>(empty, inserted by B)</td>\n *       <td>(empty, inserted by B)</td>\n *       <td>(empty, inserted by a post-fixer)</td>\n *     </tr>\n *   </tbody>\n * </table>\n * ```\n *\n * After undo, the table post-fixer will detect that two rows are shorter than others and will fix the table to:\n *\n * ```xml\n * <table>\n *   <tbody>\n *     <tr>\n *       <td>11</td>\n *       <td>12</td>\n *       <td>(empty, inserted by a post-fixer after undo)</td>\n *     </tr>\n *     <tr>\n *       <td>21</td>\n *       <td>22</td>\n *       <td>(empty, inserted by a post-fixer after undo)</td>\n *     </tr>\n *     <tr>\n *       <td>(empty, inserted by B)</td>\n *       <td>(empty, inserted by B)</td>\n *       <td>(empty, inserted by a post-fixer)</td>\n *     </tr>\n *   </tbody>\n * </table>\n * ```\n */\nfunction injectTableLayoutPostFixer(model) {\n  model.document.registerPostFixer(writer => tableLayoutPostFixer(writer, model));\n}\n/**\n * The table layout post-fixer.\n */\nfunction tableLayoutPostFixer(writer, model) {\n  const changes = model.document.differ.getChanges();\n  let wasFixed = false;\n  // Do not analyze the same table more then once - may happen for multiple changes in the same table.\n  const analyzedTables = new Set();\n  for (const entry of changes) {\n    let table = null;\n    if (entry.type == 'insert' && entry.name == 'table') {\n      table = entry.position.nodeAfter;\n    }\n    // Fix table on adding/removing table cells and rows.\n    if ((entry.type == 'insert' || entry.type == 'remove') && (entry.name == 'tableRow' || entry.name == 'tableCell')) {\n      table = entry.position.findAncestor('table');\n    }\n    // Fix table on any table's attribute change - including attributes of table cells.\n    if (isTableAttributeEntry(entry)) {\n      table = entry.range.start.findAncestor('table');\n    }\n    if (table && !analyzedTables.has(table)) {\n      // Step 1: correct rowspans of table cells if necessary.\n      // The wasFixed flag should be true if any of tables in batch was fixed - might be more then one.\n      wasFixed = fixTableCellsRowspan(table, writer) || wasFixed;\n      // Step 2: fix table rows sizes.\n      wasFixed = fixTableRowsSizes(table, writer) || wasFixed;\n      analyzedTables.add(table);\n    }\n  }\n  return wasFixed;\n}\n/**\n * Fixes the invalid value of the `rowspan` attribute because a table cell cannot vertically extend beyond the table section it belongs to.\n *\n * @returns Returns `true` if the table was fixed.\n */\nfunction fixTableCellsRowspan(table, writer) {\n  let wasFixed = false;\n  const cellsToTrim = findCellsToTrim(table);\n  if (cellsToTrim.length) {\n    // @if CK_DEBUG_TABLE // console.log( `Post-fixing table: trimming cells row-spans (${ cellsToTrim.length }).` );\n    wasFixed = true;\n    for (const data of cellsToTrim) {\n      updateNumericAttribute('rowspan', data.rowspan, data.cell, writer, 1);\n    }\n  }\n  return wasFixed;\n}\n/**\n * Makes all table rows in a table the same size.\n *\n * @returns Returns `true` if the table was fixed.\n */\nfunction fixTableRowsSizes(table, writer) {\n  let wasFixed = false;\n  const childrenLengths = getChildrenLengths(table);\n  const rowsToRemove = [];\n  // Find empty rows.\n  for (const [rowIndex, size] of childrenLengths.entries()) {\n    // Ignore all non-row models.\n    if (!size && table.getChild(rowIndex).is('element', 'tableRow')) {\n      rowsToRemove.push(rowIndex);\n    }\n  }\n  // Remove empty rows.\n  if (rowsToRemove.length) {\n    // @if CK_DEBUG_TABLE // console.log( `Post-fixing table: remove empty rows (${ rowsToRemove.length }).` );\n    wasFixed = true;\n    for (const rowIndex of rowsToRemove.reverse()) {\n      writer.remove(table.getChild(rowIndex));\n      childrenLengths.splice(rowIndex, 1);\n    }\n  }\n  // Filter out everything that's not a table row.\n  const rowsLengths = childrenLengths.filter((row, rowIndex) => table.getChild(rowIndex).is('element', 'tableRow'));\n  // Verify if all the rows have the same number of columns.\n  const tableSize = rowsLengths[0];\n  const isValid = rowsLengths.every(length => length === tableSize);\n  if (!isValid) {\n    // @if CK_DEBUG_TABLE // console.log( 'Post-fixing table: adding missing cells.' );\n    // Find the maximum number of columns.\n    const maxColumns = rowsLengths.reduce((prev, current) => current > prev ? current : prev, 0);\n    for (const [rowIndex, size] of rowsLengths.entries()) {\n      const columnsToInsert = maxColumns - size;\n      if (columnsToInsert) {\n        for (let i = 0; i < columnsToInsert; i++) {\n          createEmptyTableCell(writer, writer.createPositionAt(table.getChild(rowIndex), 'end'));\n        }\n        wasFixed = true;\n      }\n    }\n  }\n  return wasFixed;\n}\n/**\n * Searches for table cells that extend beyond the table section to which they belong to. It will return an array of objects\n * that stores table cells to be trimmed and the correct value of the `rowspan` attribute to set.\n */\nfunction findCellsToTrim(table) {\n  const headingRows = parseInt(table.getAttribute('headingRows') || '0');\n  const maxRows = Array.from(table.getChildren()).reduce((count, row) => row.is('element', 'tableRow') ? count + 1 : count, 0);\n  const cellsToTrim = [];\n  for (const {\n    row,\n    cell,\n    cellHeight\n  } of new TableWalker(table)) {\n    // Skip cells that do not expand over its row.\n    if (cellHeight < 2) {\n      continue;\n    }\n    const isInHeader = row < headingRows;\n    // Row limit is either end of header section or whole table as table body is after the header.\n    const rowLimit = isInHeader ? headingRows : maxRows;\n    // If table cell expands over its limit reduce it height to proper value.\n    if (row + cellHeight > rowLimit) {\n      const newRowspan = rowLimit - row;\n      cellsToTrim.push({\n        cell,\n        rowspan: newRowspan\n      });\n    }\n  }\n  return cellsToTrim;\n}\n/**\n * Returns an array with lengths of rows assigned to the corresponding row index.\n */\nfunction getChildrenLengths(table) {\n  // TableWalker will not provide items for the empty rows, we need to pre-fill this array.\n  const lengths = new Array(table.childCount).fill(0);\n  for (const {\n    rowIndex\n  } of new TableWalker(table, {\n    includeAllSlots: true\n  })) {\n    lengths[rowIndex]++;\n  }\n  return lengths;\n}\n/**\n * Checks if the differ entry for an attribute change is one of the table's attributes.\n */\nfunction isTableAttributeEntry(entry) {\n  if (entry.type !== 'attribute') {\n    return false;\n  }\n  const key = entry.attributeKey;\n  return key === 'headingRows' || key === 'colspan' || key === 'rowspan';\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module table/converters/table-cell-paragraph-post-fixer\n    */ /**\n       * Injects a table cell post-fixer into the model which inserts a `paragraph` element into empty table cells.\n       *\n       * A table cell must contain at least one block element as a child. An empty table cell will have an empty `paragraph` as a child.\n       *\n       * ```xml\n       * <table>\n       *   <tableRow>\n       *      <tableCell></tableCell>\n       *   </tableRow>\n       * </table>\n       * ```\n       *\n       * Will be fixed to:\n       *\n       * ```xml\n       * <table>\n       *   <tableRow>\n       *      <tableCell><paragraph></paragraph></tableCell>\n       *   </tableRow>\n       * </table>\n       * ```\n       */\nfunction injectTableCellParagraphPostFixer(model) {\n  model.document.registerPostFixer(writer => tableCellContentsPostFixer(writer, model));\n}\n/**\n * The table cell contents post-fixer.\n */\nfunction tableCellContentsPostFixer(writer, model) {\n  const changes = model.document.differ.getChanges();\n  let wasFixed = false;\n  for (const entry of changes) {\n    if (entry.type == 'insert' && entry.name == 'table') {\n      wasFixed = fixTable(entry.position.nodeAfter, writer) || wasFixed;\n    }\n    if (entry.type == 'insert' && entry.name == 'tableRow') {\n      wasFixed = fixTableRow(entry.position.nodeAfter, writer) || wasFixed;\n    }\n    if (entry.type == 'insert' && entry.name == 'tableCell') {\n      wasFixed = fixTableCellContent(entry.position.nodeAfter, writer) || wasFixed;\n    }\n    if ((entry.type == 'remove' || entry.type == 'insert') && checkTableCellChange(entry)) {\n      wasFixed = fixTableCellContent(entry.position.parent, writer) || wasFixed;\n    }\n  }\n  return wasFixed;\n}\n/**\n * Fixes all table cells in a table.\n */\nfunction fixTable(table, writer) {\n  let wasFixed = false;\n  for (const row of table.getChildren()) {\n    if (row.is('element', 'tableRow')) {\n      wasFixed = fixTableRow(row, writer) || wasFixed;\n    }\n  }\n  return wasFixed;\n}\n/**\n * Fixes all table cells in a table row.\n */\nfunction fixTableRow(tableRow, writer) {\n  let wasFixed = false;\n  for (const tableCell of tableRow.getChildren()) {\n    wasFixed = fixTableCellContent(tableCell, writer) || wasFixed;\n  }\n  return wasFixed;\n}\n/**\n * Fixes all table cell content by:\n * - Adding a paragraph to a table cell without any child.\n * - Wrapping direct $text in a `<paragraph>`.\n */\nfunction fixTableCellContent(tableCell, writer) {\n  // Insert paragraph to an empty table cell.\n  if (tableCell.childCount == 0) {\n    // @if CK_DEBUG_TABLE // console.log( 'Post-fixing table: insert paragraph in empty cell.' );\n    writer.insertElement('paragraph', tableCell);\n    return true;\n  }\n  // Check table cell children for directly placed text nodes.\n  // Temporary solution. See https://github.com/ckeditor/ckeditor5/issues/1464.\n  const textNodes = Array.from(tableCell.getChildren()).filter(child => child.is('$text'));\n  // @if CK_DEBUG_TABLE // textNodes.length && console.log( 'Post-fixing table: wrap cell content with paragraph.' );\n  for (const child of textNodes) {\n    writer.wrap(writer.createRangeOn(child), 'paragraph');\n  }\n  // Return true when there were text nodes to fix.\n  return !!textNodes.length;\n}\n/**\n * Checks if a differ change should fix the table cell. This happens on:\n * - Removing content from the table cell (i.e. `tableCell` can be left empty).\n * - Adding a text node directly into a table cell.\n */\nfunction checkTableCellChange(entry) {\n  if (!entry.position.parent.is('element', 'tableCell')) {\n    return false;\n  }\n  return entry.type == 'insert' && entry.name == '$text' || entry.type == 'remove';\n}\n\n/**\n * A table headings refresh handler which marks the table cells or rows in the differ to have it re-rendered\n * if the headings attribute changed.\n *\n * Table heading rows and heading columns are represented in the model by a `headingRows` and `headingColumns` attributes.\n *\n * When table headings attribute changes, all the cells/rows are marked to re-render to change between `<td>` and `<th>`.\n */\nfunction tableHeadingsRefreshHandler(model, editing) {\n  const differ = model.document.differ;\n  for (const change of differ.getChanges()) {\n    let table;\n    let isRowChange = false;\n    if (change.type == 'attribute') {\n      const element = change.range.start.nodeAfter;\n      if (!element || !element.is('element', 'table')) {\n        continue;\n      }\n      if (change.attributeKey != 'headingRows' && change.attributeKey != 'headingColumns') {\n        continue;\n      }\n      table = element;\n      isRowChange = change.attributeKey == 'headingRows';\n    } else if (change.name == 'tableRow' || change.name == 'tableCell') {\n      table = change.position.findAncestor('table');\n      isRowChange = change.name == 'tableRow';\n    }\n    if (!table) {\n      continue;\n    }\n    const headingRows = table.getAttribute('headingRows') || 0;\n    const headingColumns = table.getAttribute('headingColumns') || 0;\n    const tableWalker = new TableWalker(table);\n    for (const tableSlot of tableWalker) {\n      const isHeading = tableSlot.row < headingRows || tableSlot.column < headingColumns;\n      const expectedElementName = isHeading ? 'th' : 'td';\n      const viewElement = editing.mapper.toViewElement(tableSlot.cell);\n      if (viewElement && viewElement.is('element') && viewElement.name != expectedElementName) {\n        editing.reconvertItem(isRowChange ? tableSlot.cell.parent : tableSlot.cell);\n      }\n    }\n  }\n}\n\n/**\n * A table cell refresh handler which marks the table cell in the differ to have it re-rendered.\n *\n * Model `paragraph` inside a table cell can be rendered as `<span>` or `<p>`. It is rendered as `<span>` if this is the only block\n * element in that table cell and it does not have any attributes. It is rendered as `<p>` otherwise.\n *\n * When table cell content changes, for example a second `paragraph` element is added, we need to ensure that the first `paragraph` is\n * re-rendered so it changes from `<span>` to `<p>`. The easiest way to do it is to re-render the entire table cell.\n */\nfunction tableCellRefreshHandler(model, editing) {\n  const differ = model.document.differ;\n  // Stores cells to be refreshed, so the table cell will be refreshed once for multiple changes.\n  const cellsToCheck = new Set();\n  for (const change of differ.getChanges()) {\n    const parent = change.type == 'attribute' ? change.range.start.parent : change.position.parent;\n    if (parent.is('element', 'tableCell')) {\n      cellsToCheck.add(parent);\n    }\n  }\n  for (const tableCell of cellsToCheck.values()) {\n    const paragraphsToRefresh = Array.from(tableCell.getChildren()).filter(child => shouldRefresh(child, editing.mapper));\n    for (const paragraph of paragraphsToRefresh) {\n      editing.reconvertItem(paragraph);\n    }\n  }\n}\n/**\n * Check if given model element needs refreshing.\n */\nfunction shouldRefresh(child, mapper) {\n  if (!child.is('element', 'paragraph')) {\n    return false;\n  }\n  const viewElement = mapper.toViewElement(child);\n  if (!viewElement) {\n    return false;\n  }\n  return isSingleParagraphWithoutAttributes(child) !== viewElement.is('element', 'span');\n}\n\n/**\n * The table editing feature.\n */\nclass TableEditing extends Plugin {\n  /**\n  * Handlers for creating additional slots in the table.\n  */\n  _additionalSlots;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._additionalSlots = [];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const model = editor.model;\n    const schema = model.schema;\n    const conversion = editor.conversion;\n    const tableUtils = editor.plugins.get(TableUtils);\n    schema.register('table', {\n      inheritAllFrom: '$blockObject',\n      allowAttributes: ['headingRows', 'headingColumns']\n    });\n    schema.register('tableRow', {\n      allowIn: 'table',\n      isLimit: true\n    });\n    schema.register('tableCell', {\n      allowContentOf: '$container',\n      allowIn: 'tableRow',\n      allowAttributes: ['colspan', 'rowspan'],\n      isLimit: true,\n      isSelectable: true\n    });\n    // Figure conversion.\n    conversion.for('upcast').add(upcastTableFigure());\n    // Table conversion.\n    conversion.for('upcast').add(upcastTable());\n    conversion.for('editingDowncast').elementToStructure({\n      model: {\n        name: 'table',\n        attributes: ['headingRows']\n      },\n      view: downcastTable(tableUtils, {\n        asWidget: true,\n        additionalSlots: this._additionalSlots\n      })\n    });\n    conversion.for('dataDowncast').elementToStructure({\n      model: {\n        name: 'table',\n        attributes: ['headingRows']\n      },\n      view: downcastTable(tableUtils, {\n        additionalSlots: this._additionalSlots\n      })\n    });\n    // Table row conversion.\n    conversion.for('upcast').elementToElement({\n      model: 'tableRow',\n      view: 'tr'\n    });\n    conversion.for('upcast').add(skipEmptyTableRow());\n    conversion.for('downcast').elementToElement({\n      model: 'tableRow',\n      view: downcastRow()\n    });\n    // Table cell conversion.\n    conversion.for('upcast').elementToElement({\n      model: 'tableCell',\n      view: 'td'\n    });\n    conversion.for('upcast').elementToElement({\n      model: 'tableCell',\n      view: 'th'\n    });\n    conversion.for('upcast').add(ensureParagraphInTableCell('td'));\n    conversion.for('upcast').add(ensureParagraphInTableCell('th'));\n    conversion.for('editingDowncast').elementToElement({\n      model: 'tableCell',\n      view: downcastCell({\n        asWidget: true\n      })\n    });\n    conversion.for('dataDowncast').elementToElement({\n      model: 'tableCell',\n      view: downcastCell()\n    });\n    // Duplicates code - needed to properly refresh paragraph inside a table cell.\n    conversion.for('editingDowncast').elementToElement({\n      model: 'paragraph',\n      view: convertParagraphInTableCell({\n        asWidget: true\n      }),\n      converterPriority: 'high'\n    });\n    conversion.for('dataDowncast').elementToElement({\n      model: 'paragraph',\n      view: convertParagraphInTableCell(),\n      converterPriority: 'high'\n    });\n    // Table attributes conversion.\n    conversion.for('downcast').attributeToAttribute({\n      model: 'colspan',\n      view: 'colspan'\n    });\n    conversion.for('upcast').attributeToAttribute({\n      model: {\n        key: 'colspan',\n        value: upcastCellSpan('colspan')\n      },\n      view: 'colspan'\n    });\n    conversion.for('downcast').attributeToAttribute({\n      model: 'rowspan',\n      view: 'rowspan'\n    });\n    conversion.for('upcast').attributeToAttribute({\n      model: {\n        key: 'rowspan',\n        value: upcastCellSpan('rowspan')\n      },\n      view: 'rowspan'\n    });\n    // Define the config.\n    editor.config.define('table.defaultHeadings.rows', 0);\n    editor.config.define('table.defaultHeadings.columns', 0);\n    // Define all the commands.\n    editor.commands.add('insertTable', new InsertTableCommand(editor));\n    editor.commands.add('insertTableRowAbove', new InsertRowCommand(editor, {\n      order: 'above'\n    }));\n    editor.commands.add('insertTableRowBelow', new InsertRowCommand(editor, {\n      order: 'below'\n    }));\n    editor.commands.add('insertTableColumnLeft', new InsertColumnCommand(editor, {\n      order: 'left'\n    }));\n    editor.commands.add('insertTableColumnRight', new InsertColumnCommand(editor, {\n      order: 'right'\n    }));\n    editor.commands.add('removeTableRow', new RemoveRowCommand(editor));\n    editor.commands.add('removeTableColumn', new RemoveColumnCommand(editor));\n    editor.commands.add('splitTableCellVertically', new SplitCellCommand(editor, {\n      direction: 'vertically'\n    }));\n    editor.commands.add('splitTableCellHorizontally', new SplitCellCommand(editor, {\n      direction: 'horizontally'\n    }));\n    editor.commands.add('mergeTableCells', new MergeCellsCommand(editor));\n    editor.commands.add('mergeTableCellRight', new MergeCellCommand(editor, {\n      direction: 'right'\n    }));\n    editor.commands.add('mergeTableCellLeft', new MergeCellCommand(editor, {\n      direction: 'left'\n    }));\n    editor.commands.add('mergeTableCellDown', new MergeCellCommand(editor, {\n      direction: 'down'\n    }));\n    editor.commands.add('mergeTableCellUp', new MergeCellCommand(editor, {\n      direction: 'up'\n    }));\n    editor.commands.add('setTableColumnHeader', new SetHeaderColumnCommand(editor));\n    editor.commands.add('setTableRowHeader', new SetHeaderRowCommand(editor));\n    editor.commands.add('selectTableRow', new SelectRowCommand(editor));\n    editor.commands.add('selectTableColumn', new SelectColumnCommand(editor));\n    injectTableLayoutPostFixer(model);\n    injectTableCellParagraphPostFixer(model);\n    this.listenTo(model.document, 'change:data', () => {\n      tableHeadingsRefreshHandler(model, editor.editing);\n      tableCellRefreshHandler(model, editor.editing);\n    });\n  }\n  /**\n  * Registers downcast handler for the additional table slot.\n  */\n  registerAdditionalSlot(slotHandler) {\n    this._additionalSlots.push(slotHandler);\n  }\n}\n/**\n * Returns fixed colspan and rowspan attrbutes values.\n *\n * @param type colspan or rowspan.\n * @returns conversion value function.\n */\nfunction upcastCellSpan(type) {\n  return cell => {\n    const span = parseInt(cell.getAttribute(type));\n    if (Number.isNaN(span) || span <= 0) {\n      return null;\n    }\n    return span;\n  };\n}\n\n/**\n * The table size view.\n *\n * It renders a 10x10 grid to choose the inserted table size.\n */\nclass InsertTableView extends View {\n  /**\n  * A collection of table size box items.\n  */\n  items;\n  /**\n  * Listen to `keydown` events fired in this view's main element.\n  */\n  keystrokes;\n  /**\n  * Tracks information about the DOM focus in the grid.\n  */\n  focusTracker;\n  /**\n  * @inheritDoc\n  */\n  constructor(locale) {\n    super(locale);\n    const bind = this.bindTemplate;\n    this.items = this._createGridCollection();\n    this.keystrokes = new KeystrokeHandler();\n    this.focusTracker = new FocusTracker();\n    this.set('rows', 0);\n    this.set('columns', 0);\n    this.bind('label').to(this, 'columns', this, 'rows', (columns, rows) => `${rows} Ã— ${columns}`);\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck']\n      },\n      children: [{\n        tag: 'div',\n        attributes: {\n          class: ['ck-insert-table-dropdown__grid']\n        },\n        on: {\n          'mouseover@.ck-insert-table-dropdown-grid-box': bind.to('boxover')\n        },\n        children: this.items\n      }, {\n        tag: 'div',\n        attributes: {\n          class: ['ck', 'ck-insert-table-dropdown__label'],\n          'aria-hidden': true\n        },\n        children: [{\n          text: bind.to('label')\n        }]\n      }],\n      on: {\n        mousedown: bind.to(evt => {\n          evt.preventDefault();\n        }),\n        click: bind.to(() => {\n          this.fire('execute');\n        })\n      }\n    });\n    // #rows and #columns are set via changes to #focusTracker on mouse over.\n    this.on('boxover', (evt, domEvt) => {\n      const {\n        row,\n        column\n      } = domEvt.target.dataset;\n      this.items.get((parseInt(row, 10) - 1) * 10 + (parseInt(column, 10) - 1)).focus();\n    });\n    // This allows the #rows and #columns to be updated when:\n    // * the user navigates the grid using the keyboard,\n    // * the user moves the mouse over grid items.\n    this.focusTracker.on('change:focusedElement', (evt, name, focusedElement) => {\n      if (!focusedElement) {\n        return;\n      }\n      const {\n        row,\n        column\n      } = focusedElement.dataset;\n      // As row & column indexes are zero-based transform it to number of selected rows & columns.\n      this.set({\n        rows: parseInt(row),\n        columns: parseInt(column)\n      });\n    });\n    this.on('change:columns', () => this._highlightGridBoxes());\n    this.on('change:rows', () => this._highlightGridBoxes());\n  }\n  render() {\n    super.render();\n    addKeyboardHandlingForGrid({\n      keystrokeHandler: this.keystrokes,\n      focusTracker: this.focusTracker,\n      gridItems: this.items,\n      numberOfColumns: 10,\n      uiLanguageDirection: this.locale && this.locale.uiLanguageDirection\n    });\n    for (const item of this.items) {\n      this.focusTracker.add(item.element);\n    }\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * Resets the rows and columns selection.\n  */\n  reset() {\n    this.set({\n      rows: 1,\n      columns: 1\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  focus() {\n    this.items.get(0).focus();\n  }\n  /**\n  * @inheritDoc\n  */\n  focusLast() {\n    this.items.get(0).focus();\n  }\n  /**\n  * Highlights grid boxes depending on rows and columns selected.\n  */\n  _highlightGridBoxes() {\n    const rows = this.rows;\n    const columns = this.columns;\n    this.items.map((boxView, index) => {\n      // Translate box index to the row & column index.\n      const itemRow = Math.floor(index / 10);\n      const itemColumn = index % 10;\n      // Grid box is highlighted when its row & column index belongs to selected number of rows & columns.\n      const isOn = itemRow < rows && itemColumn < columns;\n      boxView.set('isOn', isOn);\n    });\n  }\n  /**\n  * Creates a new Button for the grid.\n  *\n  * @param locale The locale instance.\n  * @param row Row number.\n  * @param column Column number.\n  * @param label The grid button label.\n  */\n  _createGridButton(locale, row, column, label) {\n    const button = new ButtonView(locale);\n    button.set({\n      label,\n      class: 'ck-insert-table-dropdown-grid-box'\n    });\n    button.extendTemplate({\n      attributes: {\n        'data-row': row,\n        'data-column': column\n      }\n    });\n    return button;\n  }\n  /**\n  * @returns A view collection containing boxes to be placed in a table grid.\n  */\n  _createGridCollection() {\n    const boxes = [];\n    // Add grid boxes to table selection view.\n    for (let index = 0; index < 100; index++) {\n      const row = Math.floor(index / 10);\n      const column = index % 10;\n      const label = `${row + 1} Ã— ${column + 1}`;\n      boxes.push(this._createGridButton(this.locale, row + 1, column + 1, label));\n    }\n    return this.createCollection(boxes);\n  }\n}\n\n/**\n * The table UI plugin. It introduces:\n *\n * * The `'insertTable'` dropdown,\n * * The `'menuBar:insertTable'` menu bar menu,\n * * The `'tableColumn'` dropdown,\n * * The `'tableRow'` dropdown,\n * * The `'mergeTableCells'` split button.\n *\n * The `'tableColumn'`, `'tableRow'` and `'mergeTableCells'` dropdowns work best with {@link module:table/tabletoolbar~TableToolbar}.\n */\nclass TableUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = this.editor.t;\n    const contentLanguageDirection = editor.locale.contentLanguageDirection;\n    const isContentLtr = contentLanguageDirection === 'ltr';\n    editor.ui.componentFactory.add('insertTable', locale => {\n      const command = editor.commands.get('insertTable');\n      const dropdownView = createDropdown(locale);\n      dropdownView.bind('isEnabled').to(command);\n      // Decorate dropdown's button.\n      dropdownView.buttonView.set({\n        icon: IconTable,\n        label: t('Insert table'),\n        tooltip: true\n      });\n      let insertTableView;\n      dropdownView.on('change:isOpen', () => {\n        if (insertTableView) {\n          return;\n        }\n        // Prepare custom view for dropdown's panel.\n        insertTableView = new InsertTableView(locale);\n        dropdownView.panelView.children.add(insertTableView);\n        insertTableView.delegate('execute').to(dropdownView);\n        dropdownView.on('execute', () => {\n          editor.execute('insertTable', {\n            rows: insertTableView.rows,\n            columns: insertTableView.columns\n          });\n          editor.editing.view.focus();\n        });\n      });\n      return dropdownView;\n    });\n    editor.ui.componentFactory.add('menuBar:insertTable', locale => {\n      const command = editor.commands.get('insertTable');\n      const menuView = new MenuBarMenuView(locale);\n      const insertTableView = new InsertTableView(locale);\n      insertTableView.delegate('execute').to(menuView);\n      menuView.on('change:isOpen', (event, name, isOpen) => {\n        if (!isOpen) {\n          insertTableView.reset();\n        }\n      });\n      insertTableView.on('execute', () => {\n        editor.execute('insertTable', {\n          rows: insertTableView.rows,\n          columns: insertTableView.columns\n        });\n        editor.editing.view.focus();\n      });\n      menuView.buttonView.set({\n        label: t('Table'),\n        icon: IconTable\n      });\n      menuView.panelView.children.add(insertTableView);\n      menuView.bind('isEnabled').to(command);\n      return menuView;\n    });\n    editor.ui.componentFactory.add('tableColumn', locale => {\n      const options = [{\n        type: 'switchbutton',\n        model: {\n          commandName: 'setTableColumnHeader',\n          label: t('Header column'),\n          bindIsOn: true\n        }\n      }, {\n        type: 'separator'\n      }, {\n        type: 'button',\n        model: {\n          commandName: isContentLtr ? 'insertTableColumnLeft' : 'insertTableColumnRight',\n          label: t('Insert column left')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: isContentLtr ? 'insertTableColumnRight' : 'insertTableColumnLeft',\n          label: t('Insert column right')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: 'removeTableColumn',\n          label: t('Delete column')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: 'selectTableColumn',\n          label: t('Select column')\n        }\n      }];\n      return this._prepareDropdown(t('Column'), IconTableColumn, options, locale);\n    });\n    editor.ui.componentFactory.add('tableRow', locale => {\n      const options = [{\n        type: 'switchbutton',\n        model: {\n          commandName: 'setTableRowHeader',\n          label: t('Header row'),\n          bindIsOn: true\n        }\n      }, {\n        type: 'separator'\n      }, {\n        type: 'button',\n        model: {\n          commandName: 'insertTableRowAbove',\n          label: t('Insert row above')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: 'insertTableRowBelow',\n          label: t('Insert row below')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: 'removeTableRow',\n          label: t('Delete row')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: 'selectTableRow',\n          label: t('Select row')\n        }\n      }];\n      return this._prepareDropdown(t('Row'), IconTableRow, options, locale);\n    });\n    editor.ui.componentFactory.add('mergeTableCells', locale => {\n      const options = [{\n        type: 'button',\n        model: {\n          commandName: 'mergeTableCellUp',\n          label: t('Merge cell up')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: isContentLtr ? 'mergeTableCellRight' : 'mergeTableCellLeft',\n          label: t('Merge cell right')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: 'mergeTableCellDown',\n          label: t('Merge cell down')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: isContentLtr ? 'mergeTableCellLeft' : 'mergeTableCellRight',\n          label: t('Merge cell left')\n        }\n      }, {\n        type: 'separator'\n      }, {\n        type: 'button',\n        model: {\n          commandName: 'splitTableCellVertically',\n          label: t('Split cell vertically')\n        }\n      }, {\n        type: 'button',\n        model: {\n          commandName: 'splitTableCellHorizontally',\n          label: t('Split cell horizontally')\n        }\n      }];\n      return this._prepareMergeSplitButtonDropdown(t('Merge cells'), IconTableMergeCell, options, locale);\n    });\n  }\n  /**\n  * Creates a dropdown view from a set of options.\n  *\n  * @param label The dropdown button label.\n  * @param icon An icon for the dropdown button.\n  * @param options The list of options for the dropdown.\n  */\n  _prepareDropdown(label, icon, options, locale) {\n    const editor = this.editor;\n    const dropdownView = createDropdown(locale);\n    const commands = this._fillDropdownWithListOptions(dropdownView, options);\n    // Decorate dropdown's button.\n    dropdownView.buttonView.set({\n      label,\n      icon,\n      tooltip: true\n    });\n    // Make dropdown button disabled when all options are disabled.\n    dropdownView.bind('isEnabled').toMany(commands, 'isEnabled', (...areEnabled) => {\n      return areEnabled.some(isEnabled => isEnabled);\n    });\n    this.listenTo(dropdownView, 'execute', evt => {\n      editor.execute(evt.source.commandName);\n      // Toggling a switch button view should not move the focus to the editable.\n      if (!(evt.source instanceof SwitchButtonView)) {\n        editor.editing.view.focus();\n      }\n    });\n    return dropdownView;\n  }\n  /**\n  * Creates a dropdown view with a {@link module:ui/dropdown/button/splitbuttonview~SplitButtonView} for\n  * merge (and split)â€“related commands.\n  *\n  * @param label The dropdown button label.\n  * @param icon An icon for the dropdown button.\n  * @param options The list of options for the dropdown.\n  */\n  _prepareMergeSplitButtonDropdown(label, icon, options, locale) {\n    const editor = this.editor;\n    const dropdownView = createDropdown(locale, SplitButtonView);\n    const mergeCommandName = 'mergeTableCells';\n    // Main command.\n    const mergeCommand = editor.commands.get(mergeCommandName);\n    // Subcommands in the dropdown.\n    const commands = this._fillDropdownWithListOptions(dropdownView, options);\n    dropdownView.buttonView.set({\n      label,\n      icon,\n      tooltip: true,\n      isEnabled: true\n    });\n    // Make dropdown button disabled when all options are disabled together with the main command.\n    dropdownView.bind('isEnabled').toMany([mergeCommand, ...commands], 'isEnabled', (...areEnabled) => {\n      return areEnabled.some(isEnabled => isEnabled);\n    });\n    // Merge selected table cells when the main part of the split button is clicked.\n    this.listenTo(dropdownView.buttonView, 'execute', () => {\n      editor.execute(mergeCommandName);\n      editor.editing.view.focus();\n    });\n    // Execute commands for events coming from the list in the dropdown panel.\n    this.listenTo(dropdownView, 'execute', evt => {\n      editor.execute(evt.source.commandName);\n      editor.editing.view.focus();\n    });\n    return dropdownView;\n  }\n  /**\n  * Injects a {@link module:ui/list/listview~ListView} into the passed dropdown with buttons\n  * which execute editor commands as configured in passed options.\n  *\n  * @param options The list of options for the dropdown.\n  * @returns Commands the list options are interacting with.\n  */\n  _fillDropdownWithListOptions(dropdownView, options) {\n    const editor = this.editor;\n    const commands = [];\n    const itemDefinitions = new Collection();\n    for (const option of options) {\n      addListOption(option, editor, commands, itemDefinitions);\n    }\n    addListToDropdown(dropdownView, itemDefinitions);\n    return commands;\n  }\n}\n/**\n * Adds an option to a list view.\n *\n * @param option A configuration option.\n * @param commands The list of commands to update.\n * @param itemDefinitions A collection of dropdown items to update with the given option.\n */\nfunction addListOption(option, editor, commands, itemDefinitions) {\n  if (option.type === 'button' || option.type === 'switchbutton') {\n    const model = option.model = new ViewModel(option.model);\n    const {\n      commandName,\n      bindIsOn\n    } = option.model;\n    const command = editor.commands.get(commandName);\n    commands.push(command);\n    model.set({\n      commandName\n    });\n    model.bind('isEnabled').to(command);\n    if (bindIsOn) {\n      model.bind('isOn').to(command, 'value');\n    }\n    model.set({\n      withText: true\n    });\n  }\n  itemDefinitions.add(option);\n}\n\n/**\n * This plugin enables the advanced table cells, rows and columns selection.\n * It is loaded automatically by the {@link module:table/table~Table} plugin.\n */\nclass TableSelection extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableSelection';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableUtils, TableUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const model = editor.model;\n    const view = editor.editing.view;\n    this.listenTo(model, 'deleteContent', (evt, args) => this._handleDeleteContent(evt, args), {\n      priority: 'high'\n    });\n    this.listenTo(view.document, 'insertText', (evt, data) => this._handleInsertTextEvent(evt, data), {\n      priority: 'high'\n    });\n    this._defineSelectionConverter();\n    this._enablePluginDisabling(); // sic!\n  }\n  /**\n  * Returns the currently selected table cells or `null` if it is not a table cells selection.\n  */\n  getSelectedTableCells() {\n    const tableUtils = this.editor.plugins.get(TableUtils);\n    const selection = this.editor.model.document.selection;\n    const selectedCells = tableUtils.getSelectedTableCells(selection);\n    if (selectedCells.length == 0) {\n      return null;\n    }\n    // This should never happen, but let's know if it ever happens.\n    // @if CK_DEBUG //\tif ( selectedCells.length != selection.rangeCount ) {\n    // @if CK_DEBUG //\t\tconsole.warn( 'Mixed selection warning. The selection contains table cells and some other ranges.' );\n    // @if CK_DEBUG //\t}\n    return selectedCells;\n  }\n  /**\n  * Returns the selected table fragment as a document fragment.\n  */\n  getSelectionAsFragment() {\n    const tableUtils = this.editor.plugins.get(TableUtils);\n    const selectedCells = this.getSelectedTableCells();\n    if (!selectedCells) {\n      return null;\n    }\n    return this.editor.model.change(writer => {\n      const documentFragment = writer.createDocumentFragment();\n      const {\n        first: firstColumn,\n        last: lastColumn\n      } = tableUtils.getColumnIndexes(selectedCells);\n      const {\n        first: firstRow,\n        last: lastRow\n      } = tableUtils.getRowIndexes(selectedCells);\n      const sourceTable = selectedCells[0].findAncestor('table');\n      let adjustedLastRow = lastRow;\n      let adjustedLastColumn = lastColumn;\n      // If the selection is rectangular there could be a case of all cells in the last row/column spanned over\n      // next row/column so the real lastRow/lastColumn should be updated.\n      if (tableUtils.isSelectionRectangular(selectedCells)) {\n        const dimensions = {\n          firstColumn,\n          lastColumn,\n          firstRow,\n          lastRow\n        };\n        adjustedLastRow = adjustLastRowIndex(sourceTable, dimensions);\n        adjustedLastColumn = adjustLastColumnIndex(sourceTable, dimensions);\n      }\n      const cropDimensions = {\n        startRow: firstRow,\n        startColumn: firstColumn,\n        endRow: adjustedLastRow,\n        endColumn: adjustedLastColumn\n      };\n      const table = cropTableToDimensions(sourceTable, cropDimensions, writer);\n      writer.insert(table, documentFragment, 0);\n      return documentFragment;\n    });\n  }\n  /**\n  * Sets the model selection based on given anchor and target cells (can be the same cell).\n  * Takes care of setting the backward flag.\n  *\n  * ```ts\n  * const modelRoot = editor.model.document.getRoot();\n  * const firstCell = modelRoot.getNodeByPath( [ 0, 0, 0 ] );\n  * const lastCell = modelRoot.getNodeByPath( [ 0, 0, 1 ] );\n  *\n  * const tableSelection = editor.plugins.get( 'TableSelection' );\n  * tableSelection.setCellSelection( firstCell, lastCell );\n  * ```\n  */\n  setCellSelection(anchorCell, targetCell) {\n    const cellsToSelect = this._getCellsToSelect(anchorCell, targetCell);\n    this.editor.model.change(writer => {\n      writer.setSelection(cellsToSelect.cells.map(cell => writer.createRangeOn(cell)), {\n        backward: cellsToSelect.backward\n      });\n    });\n  }\n  /**\n  * Returns the focus cell from the current selection.\n  */\n  getFocusCell() {\n    const selection = this.editor.model.document.selection;\n    const focusCellRange = [...selection.getRanges()].pop();\n    const element = focusCellRange.getContainedElement();\n    if (element && element.is('element', 'tableCell')) {\n      return element;\n    }\n    return null;\n  }\n  /**\n  * Returns the anchor cell from the current selection.\n  */\n  getAnchorCell() {\n    const selection = this.editor.model.document.selection;\n    const anchorCellRange = first(selection.getRanges());\n    const element = anchorCellRange.getContainedElement();\n    if (element && element.is('element', 'tableCell')) {\n      return element;\n    }\n    return null;\n  }\n  /**\n  * Defines a selection converter which marks the selected cells with a specific class.\n  *\n  * The real DOM selection is put in the last cell. Since the order of ranges is dependent on whether the\n  * selection is backward or not, the last cell will usually be close to the \"focus\" end of the selection\n  * (a selection has anchor and focus).\n  *\n  * The real DOM selection is then hidden with CSS.\n  */\n  _defineSelectionConverter() {\n    const editor = this.editor;\n    const highlighted = new Set();\n    editor.conversion.for('editingDowncast').add(dispatcher => dispatcher.on('selection', (evt, data, conversionApi) => {\n      const viewWriter = conversionApi.writer;\n      clearHighlightedTableCells(viewWriter);\n      const selectedCells = this.getSelectedTableCells();\n      if (!selectedCells) {\n        return;\n      }\n      for (const tableCell of selectedCells) {\n        const viewElement = conversionApi.mapper.toViewElement(tableCell);\n        viewWriter.addClass('ck-editor__editable_selected', viewElement);\n        highlighted.add(viewElement);\n      }\n      const lastViewCell = conversionApi.mapper.toViewElement(selectedCells[selectedCells.length - 1]);\n      viewWriter.setSelection(lastViewCell, 0);\n    }, {\n      priority: 'lowest'\n    }));\n    function clearHighlightedTableCells(viewWriter) {\n      for (const previouslyHighlighted of highlighted) {\n        viewWriter.removeClass('ck-editor__editable_selected', previouslyHighlighted);\n      }\n      highlighted.clear();\n    }\n  }\n  /**\n  * Creates a listener that reacts to changes in {@link #isEnabled} and, if the plugin was disabled,\n  * it collapses the multi-cell selection to a regular selection placed inside a table cell.\n  *\n  * This listener helps features that disable the table selection plugin bring the selection\n  * to a clear state they can work with (for instance, because they don't support multiple cell selection).\n  */\n  _enablePluginDisabling() {\n    const editor = this.editor;\n    this.on('change:isEnabled', () => {\n      if (!this.isEnabled) {\n        const selectedCells = this.getSelectedTableCells();\n        if (!selectedCells) {\n          return;\n        }\n        editor.model.change(writer => {\n          const position = writer.createPositionAt(selectedCells[0], 0);\n          const range = editor.model.schema.getNearestSelectionRange(position);\n          writer.setSelection(range);\n        });\n      }\n    });\n  }\n  /**\n  * Overrides the default `model.deleteContent()` behavior over a selected table fragment.\n  *\n  * @param args Delete content method arguments.\n  */\n  _handleDeleteContent(event, args) {\n    const tableUtils = this.editor.plugins.get(TableUtils);\n    const selection = args[0];\n    const options = args[1];\n    const model = this.editor.model;\n    const isBackward = !options || options.direction == 'backward';\n    const selectedTableCells = tableUtils.getSelectedTableCells(selection);\n    if (!selectedTableCells.length) {\n      return;\n    }\n    event.stop();\n    model.change(writer => {\n      const tableCellToSelect = selectedTableCells[isBackward ? selectedTableCells.length - 1 : 0];\n      model.change(writer => {\n        for (const tableCell of selectedTableCells) {\n          model.deleteContent(writer.createSelection(tableCell, 'in'));\n        }\n      });\n      const rangeToSelect = model.schema.getNearestSelectionRange(writer.createPositionAt(tableCellToSelect, 0));\n      // Note: we ignore the case where rangeToSelect may be null because deleteContent() will always (unless someone broke it)\n      // create an empty paragraph to accommodate the selection.\n      if (selection.is('documentSelection')) {\n        writer.setSelection(rangeToSelect);\n      } else {\n        selection.setTo(rangeToSelect);\n      }\n    });\n  }\n  /**\n  * This handler makes it possible to remove the content of all selected cells by starting to type.\n  * If you take a look at {@link #_defineSelectionConverter} you will find out that despite the multi-cell selection being set\n  * in the model, the view selection is collapsed in the last cell (because most browsers are unable to render multi-cell selections;\n  * yes, it's a hack).\n  *\n  * When multiple cells are selected in the model and the user starts to type, the\n  * {@link module:engine/view/document~Document#event:insertText} event carries information provided by the\n  * beforeinput DOM  event, that in turn only knows about this collapsed DOM selection in the last cell.\n  *\n  * As a result, the selected cells have no chance to be cleaned up. To fix this, this listener intercepts\n  * the event and injects the custom view selection in the data that translates correctly to the actual state\n  * of the multi-cell selection in the model.\n  *\n  * @param data Insert text event data.\n  */\n  _handleInsertTextEvent(evt, data) {\n    const editor = this.editor;\n    const selectedCells = this.getSelectedTableCells();\n    if (!selectedCells) {\n      return;\n    }\n    const view = editor.editing.view;\n    const mapper = editor.editing.mapper;\n    const viewRanges = selectedCells.map(tableCell => view.createRangeOn(mapper.toViewElement(tableCell)));\n    data.selection = view.createSelection(viewRanges);\n  }\n  /**\n  * Returns an array of table cells that should be selected based on the\n  * given anchor cell and target (focus) cell.\n  *\n  * The cells are returned in a reverse direction if the selection is backward.\n  */\n  _getCellsToSelect(anchorCell, targetCell) {\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const startLocation = tableUtils.getCellLocation(anchorCell);\n    const endLocation = tableUtils.getCellLocation(targetCell);\n    const startRow = Math.min(startLocation.row, endLocation.row);\n    const endRow = Math.max(startLocation.row, endLocation.row);\n    const startColumn = Math.min(startLocation.column, endLocation.column);\n    // Adjust the selection to include the entire row if a cell with colspan is selected.\n    // This ensures that the selection covers the full width of the colspan cell.\n    //\n    // Example:\n    // +---+---+---+---+\n    // | A | B | C | D |\n    // +---+---+---+---+\n    // | E             |\n    // +---+---+---+---+\n    //\n    // If the selection starts at `B` and ends at `E`, the entire first row should be selected.\n    //\n    // In other words, the selection will represent the following cells:\n    // \t* Without this adjustment, only `B`, `A` and `E` would be selected.\n    // \t* With this adjustment, `A`, `B`, `C`, `D`, and `E` are selected.\n    //\n    // See: https://github.com/ckeditor/ckeditor5/issues/17538\n    const endColumnExtraColspan = parseInt(targetCell.getAttribute('colspan') || '1') - 1;\n    const endColumn = Math.max(startLocation.column, endLocation.column + endColumnExtraColspan);\n    // 2-dimensional array of the selected cells to ease flipping the order of cells for backward selections.\n    const selectionMap = new Array(endRow - startRow + 1).fill(null).map(() => []);\n    const walkerOptions = {\n      startRow,\n      endRow,\n      startColumn,\n      endColumn\n    };\n    for (const {\n      row,\n      cell\n    } of new TableWalker(anchorCell.findAncestor('table'), walkerOptions)) {\n      selectionMap[row - startRow].push(cell);\n    }\n    const flipVertically = endLocation.row < startLocation.row;\n    const flipHorizontally = endLocation.column < startLocation.column;\n    if (flipVertically) {\n      selectionMap.reverse();\n    }\n    if (flipHorizontally) {\n      selectionMap.forEach(row => row.reverse());\n    }\n    return {\n      cells: selectionMap.flat(),\n      backward: flipVertically || flipHorizontally\n    };\n  }\n}\n\n/**\n * This plugin adds support for copying/cutting/pasting fragments of tables.\n * It is loaded automatically by the {@link module:table/table~Table} plugin.\n */\nclass TableClipboard extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableClipboard';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ClipboardMarkersUtils, ClipboardPipeline, TableSelection, TableUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const viewDocument = editor.editing.view.document;\n    this.listenTo(viewDocument, 'copy', (evt, data) => this._onCopyCut(evt, data));\n    this.listenTo(viewDocument, 'cut', (evt, data) => this._onCopyCut(evt, data));\n    this._listenToContentInsertion();\n    this.decorate('_replaceTableSlotCell');\n  }\n  /**\n  * Sets up listening for events from the clipboard pipeline to properly handle\n  * table content merging during paste/drop operations.\n  *\n  * When a user is dragging and dropping a table, we want to insert the entire table into\n  * a table cell instead of merging table contents. For paste and other events,\n  * the normal table merge behavior is applied.\n  */\n  _listenToContentInsertion() {\n    const {\n      editor\n    } = this;\n    const clipboardPipeline = editor.plugins.get(ClipboardPipeline);\n    const tableSelection = editor.plugins.get(TableSelection);\n    let isPaste = false;\n    clipboardPipeline.on('contentInsertion', (evt, data) => {\n      isPaste = data.method === 'paste';\n    });\n    this.listenTo(editor.model, 'insertContent', (evt, [content, selectable]) => {\n      // Handles drag-and-drop of tables, where tables are inserted into selected cells rather than merged.\n      // The `isPaste` flag handles scenarios where other features (e.g., Templates) insert tables into specific cells.\n      if (isPaste || tableSelection.getSelectedTableCells() !== null) {\n        this._onInsertContent(evt, content, selectable);\n      }\n    }, {\n      priority: 'high'\n    });\n    clipboardPipeline.on('contentInsertion', () => {\n      isPaste = false;\n    }, {\n      priority: 'lowest'\n    });\n  }\n  /**\n  * Copies table content to a clipboard on \"copy\" & \"cut\" events.\n  *\n  * @param evt An object containing information about the handled event.\n  * @param data Clipboard event data.\n  */\n  _onCopyCut(evt, data) {\n    const view = this.editor.editing.view;\n    const tableSelection = this.editor.plugins.get(TableSelection);\n    const clipboardMarkersUtils = this.editor.plugins.get(ClipboardMarkersUtils);\n    if (!tableSelection.getSelectedTableCells()) {\n      return;\n    }\n    if (evt.name == 'cut' && !this.editor.model.canEditAt(this.editor.model.document.selection)) {\n      return;\n    }\n    data.preventDefault();\n    evt.stop();\n    this.editor.model.enqueueChange({\n      isUndoable: evt.name === 'cut'\n    }, () => {\n      const documentFragment = clipboardMarkersUtils._copySelectedFragmentWithMarkers(evt.name, this.editor.model.document.selection, () => tableSelection.getSelectionAsFragment());\n      view.document.fire('clipboardOutput', {\n        dataTransfer: data.dataTransfer,\n        content: this.editor.data.toView(documentFragment),\n        method: evt.name\n      });\n    });\n  }\n  /**\n  * Overrides default {@link module:engine/model/model~Model#insertContent `model.insertContent()`} method to handle pasting table inside\n  * selected table fragment.\n  *\n  * Depending on selected table fragment:\n  * - If a selected table fragment is smaller than paste table it will crop pasted table to match dimensions.\n  * - If dimensions are equal it will replace selected table fragment with a pasted table contents.\n  *\n  * @param content The content to insert.\n  * @param selectable The selection into which the content should be inserted.\n  * If not provided the current model document selection will be used.\n  */\n  _onInsertContent(evt, content, selectable) {\n    if (selectable && !selectable.is('documentSelection')) {\n      return;\n    }\n    const model = this.editor.model;\n    const tableUtils = this.editor.plugins.get(TableUtils);\n    const clipboardMarkersUtils = this.editor.plugins.get(ClipboardMarkersUtils);\n    // We might need to crop table before inserting so reference might change.\n    const pastedTable = this.getTableIfOnlyTableInContent(content, model);\n    if (!pastedTable) {\n      return;\n    }\n    const selectedTableCells = tableUtils.getSelectionAffectedTableCells(model.document.selection);\n    if (!selectedTableCells.length) {\n      removeEmptyRowsColumns(pastedTable, tableUtils);\n      return;\n    }\n    // Override default model.insertContent() handling at this point.\n    evt.stop();\n    if (content.is('documentFragment')) {\n      clipboardMarkersUtils._pasteMarkersIntoTransformedElement(content.markers, writer => this._replaceSelectedCells(pastedTable, selectedTableCells, writer));\n    } else {\n      this.editor.model.change(writer => {\n        this._replaceSelectedCells(pastedTable, selectedTableCells, writer);\n      });\n    }\n  }\n  /**\n  * Inserts provided `selectedTableCells` into `pastedTable`.\n  */\n  _replaceSelectedCells(pastedTable, selectedTableCells, writer) {\n    const tableUtils = this.editor.plugins.get(TableUtils);\n    const pastedDimensions = {\n      width: tableUtils.getColumns(pastedTable),\n      height: tableUtils.getRows(pastedTable)\n    };\n    // Prepare the table for pasting.\n    const selection = prepareTableForPasting(selectedTableCells, pastedDimensions, writer, tableUtils);\n    // Beyond this point we operate on a fixed content table with rectangular selection and proper last row/column values.\n    const selectionHeight = selection.lastRow - selection.firstRow + 1;\n    const selectionWidth = selection.lastColumn - selection.firstColumn + 1;\n    // Crop pasted table if:\n    // - Pasted table dimensions exceeds selection area.\n    // - Pasted table has broken layout (ie some cells sticks out by the table dimensions established by the first and last row).\n    //\n    // Note: The table dimensions are established by the width of the first row and the total number of rows.\n    // It is possible to programmatically create a table that has rows which would have cells anchored beyond first row width but\n    // such table will not be created by other editing solutions.\n    const cropDimensions = {\n      startRow: 0,\n      startColumn: 0,\n      endRow: Math.min(selectionHeight, pastedDimensions.height) - 1,\n      endColumn: Math.min(selectionWidth, pastedDimensions.width) - 1\n    };\n    pastedTable = cropTableToDimensions(pastedTable, cropDimensions, writer);\n    // Content table to which we insert a pasted table.\n    const selectedTable = selectedTableCells[0].findAncestor('table');\n    const cellsToSelect = this._replaceSelectedCellsWithPasted(pastedTable, pastedDimensions, selectedTable, selection, writer);\n    if (this.editor.plugins.get('TableSelection').isEnabled) {\n      // Selection ranges must be sorted because the first and last selection ranges are considered\n      // as anchor/focus cell ranges for multi-cell selection.\n      const selectionRanges = tableUtils.sortRanges(cellsToSelect.map(cell => writer.createRangeOn(cell)));\n      writer.setSelection(selectionRanges);\n    } else {\n      // Set selection inside first cell if multi-cell selection is disabled.\n      writer.setSelection(cellsToSelect[0], 0);\n    }\n    return selectedTable;\n  }\n  /**\n  * Replaces the part of selectedTable with pastedTable.\n  */\n  _replaceSelectedCellsWithPasted(pastedTable, pastedDimensions, selectedTable, selection, writer) {\n    const {\n      width: pastedWidth,\n      height: pastedHeight\n    } = pastedDimensions;\n    // Holds two-dimensional array that is addressed by [ row ][ column ] that stores cells anchored at given location.\n    const pastedTableLocationMap = createLocationMap(pastedTable, pastedWidth, pastedHeight);\n    const selectedTableMap = [...new TableWalker(selectedTable, {\n      startRow: selection.firstRow,\n      endRow: selection.lastRow,\n      startColumn: selection.firstColumn,\n      endColumn: selection.lastColumn,\n      includeAllSlots: true\n    })];\n    // Selection must be set to pasted cells (some might be removed or new created).\n    const cellsToSelect = [];\n    // Store next cell insert position.\n    let insertPosition;\n    // Content table replace cells algorithm iterates over a selected table fragment and:\n    //\n    // - Removes existing table cells at current slot (location).\n    // - Inserts cell from a pasted table for a matched slots.\n    //\n    // This ensures proper table geometry after the paste\n    for (const tableSlot of selectedTableMap) {\n      const {\n        row,\n        column\n      } = tableSlot;\n      // Save the insert position for current row start.\n      if (column === selection.firstColumn) {\n        insertPosition = tableSlot.getPositionBefore();\n      }\n      // Map current table slot location to an pasted table slot location.\n      const pastedRow = row - selection.firstRow;\n      const pastedColumn = column - selection.firstColumn;\n      const pastedCell = pastedTableLocationMap[pastedRow % pastedHeight][pastedColumn % pastedWidth];\n      // Clone cell to insert (to duplicate its attributes and children).\n      // Cloning is required to support repeating pasted table content when inserting to a bigger selection.\n      const cellToInsert = pastedCell ? writer.cloneElement(pastedCell) : null;\n      // Replace the cell from the current slot with new table cell.\n      const newTableCell = this._replaceTableSlotCell(tableSlot, cellToInsert, insertPosition, writer);\n      // The cell was only removed.\n      if (!newTableCell) {\n        continue;\n      }\n      // Trim the cell if it's row/col-spans would exceed selection area.\n      trimTableCellIfNeeded(newTableCell, row, column, selection.lastRow, selection.lastColumn, writer);\n      cellsToSelect.push(newTableCell);\n      insertPosition = writer.createPositionAfter(newTableCell);\n    }\n    // If there are any headings, all the cells that overlap from heading must be splitted.\n    const headingRows = parseInt(selectedTable.getAttribute('headingRows') || '0');\n    const headingColumns = parseInt(selectedTable.getAttribute('headingColumns') || '0');\n    const areHeadingRowsIntersectingSelection = selection.firstRow < headingRows && headingRows <= selection.lastRow;\n    const areHeadingColumnsIntersectingSelection = selection.firstColumn < headingColumns && headingColumns <= selection.lastColumn;\n    if (areHeadingRowsIntersectingSelection) {\n      const columnsLimit = {\n        first: selection.firstColumn,\n        last: selection.lastColumn\n      };\n      const newCells = doHorizontalSplit(selectedTable, headingRows, columnsLimit, writer, selection.firstRow);\n      cellsToSelect.push(...newCells);\n    }\n    if (areHeadingColumnsIntersectingSelection) {\n      const rowsLimit = {\n        first: selection.firstRow,\n        last: selection.lastRow\n      };\n      const newCells = doVerticalSplit(selectedTable, headingColumns, rowsLimit, writer);\n      cellsToSelect.push(...newCells);\n    }\n    return cellsToSelect;\n  }\n  /**\n  * Replaces a single table slot.\n  *\n  * @returns Inserted table cell or null if slot should remain empty.\n  * @private\n  */\n  _replaceTableSlotCell(tableSlot, cellToInsert, insertPosition, writer) {\n    const {\n      cell,\n      isAnchor\n    } = tableSlot;\n    // If the slot is occupied by a cell in a selected table - remove it.\n    // The slot of this cell will be either:\n    // - Replaced by a pasted table cell.\n    // - Spanned by a previously pasted table cell.\n    if (isAnchor) {\n      writer.remove(cell);\n    }\n    // There is no cell to insert (might be spanned by other cell in a pasted table) - advance to the next content table slot.\n    if (!cellToInsert) {\n      return null;\n    }\n    writer.insert(cellToInsert, insertPosition);\n    return cellToInsert;\n  }\n  /**\n  * Extracts the table for pasting into a table.\n  *\n  * @param content The content to insert.\n  * @param model The editor model.\n  */\n  getTableIfOnlyTableInContent(content, model) {\n    if (!content.is('documentFragment') && !content.is('element')) {\n      return null;\n    }\n    // Table passed directly.\n    if (content.is('element', 'table')) {\n      return content;\n    }\n    // We do not support mixed content when pasting table into table.\n    // See: https://github.com/ckeditor/ckeditor5/issues/6817.\n    if (content.childCount == 1 && content.getChild(0).is('element', 'table')) {\n      return content.getChild(0);\n    }\n    // If there are only whitespaces around a table then use that table for pasting.\n    const contentRange = model.createRangeIn(content);\n    for (const element of contentRange.getItems()) {\n      if (element.is('element', 'table')) {\n        // Stop checking if there is some content before table.\n        const rangeBefore = model.createRange(contentRange.start, model.createPositionBefore(element));\n        if (model.hasContent(rangeBefore, {\n          ignoreWhitespaces: true\n        })) {\n          return null;\n        }\n        // Stop checking if there is some content after table.\n        const rangeAfter = model.createRange(model.createPositionAfter(element), contentRange.end);\n        if (model.hasContent(rangeAfter, {\n          ignoreWhitespaces: true\n        })) {\n          return null;\n        }\n        // There wasn't any content neither before nor after.\n        return element;\n      }\n    }\n    return null;\n  }\n}\n/**\n * Prepares a table for pasting and returns adjusted selection dimensions.\n */\nfunction prepareTableForPasting(selectedTableCells, pastedDimensions, writer, tableUtils) {\n  const selectedTable = selectedTableCells[0].findAncestor('table');\n  const columnIndexes = tableUtils.getColumnIndexes(selectedTableCells);\n  const rowIndexes = tableUtils.getRowIndexes(selectedTableCells);\n  const selection = {\n    firstColumn: columnIndexes.first,\n    lastColumn: columnIndexes.last,\n    firstRow: rowIndexes.first,\n    lastRow: rowIndexes.last\n  };\n  // Single cell selected - expand selection to pasted table dimensions.\n  const shouldExpandSelection = selectedTableCells.length === 1;\n  if (shouldExpandSelection) {\n    selection.lastRow += pastedDimensions.height - 1;\n    selection.lastColumn += pastedDimensions.width - 1;\n    expandTableSize(selectedTable, selection.lastRow + 1, selection.lastColumn + 1, tableUtils);\n  }\n  // In case of expanding selection we do not reset the selection so in this case we will always try to fix selection\n  // like in the case of a non-rectangular area. This might be fixed by re-setting selected cells array but this shortcut is safe.\n  if (shouldExpandSelection || !tableUtils.isSelectionRectangular(selectedTableCells)) {\n    // For a non-rectangular selection (ie in which some cells sticks out from a virtual selection rectangle) we need to create\n    // a table layout that has a rectangular selection. This will split cells so the selection become rectangular.\n    // Beyond this point we will operate on fixed content table.\n    splitCellsToRectangularSelection(selectedTable, selection, writer);\n  } else {\n    selection.lastRow = adjustLastRowIndex(selectedTable, selection);\n    selection.lastColumn = adjustLastColumnIndex(selectedTable, selection);\n  }\n  return selection;\n}\n/**\n * Expand table (in place) to expected size.\n */\nfunction expandTableSize(table, expectedHeight, expectedWidth, tableUtils) {\n  const tableWidth = tableUtils.getColumns(table);\n  const tableHeight = tableUtils.getRows(table);\n  if (expectedWidth > tableWidth) {\n    tableUtils.insertColumns(table, {\n      at: tableWidth,\n      columns: expectedWidth - tableWidth\n    });\n  }\n  if (expectedHeight > tableHeight) {\n    tableUtils.insertRows(table, {\n      at: tableHeight,\n      rows: expectedHeight - tableHeight\n    });\n  }\n}\n/**\n * Returns two-dimensional array that is addressed by [ row ][ column ] that stores cells anchored at given location.\n *\n * At given row & column location it might be one of:\n *\n * * cell - cell from pasted table anchored at this location.\n * * null - if no cell is anchored at this location.\n *\n * For instance, from a table below:\n *\n *   +----+----+----+----+\n *   | 00 | 01 | 02 | 03 |\n *   +    +----+----+----+\n *   |    | 11      | 13 |\n *   +----+         +----+\n *   | 20 |         | 23 |\n *   +----+----+----+----+\n *\n * The method will return an array (numbers represents cell element):\n *\n * ```ts\n * const map = [\n *   [ '00', '01', '02', '03' ],\n *   [ null, '11', null, '13' ],\n *   [ '20', null, null, '23' ]\n * ]\n * ```\n *\n * This allows for a quick access to table at give row & column. For instance to access table cell \"13\" from pasted table call:\n *\n * ```ts\n * const cell = map[ 1 ][ 3 ]\n * ```\n */\nfunction createLocationMap(table, width, height) {\n  // Create height x width (row x column) two-dimensional table to store cells.\n  const map = new Array(height).fill(null).map(() => new Array(width).fill(null));\n  for (const {\n    column,\n    row,\n    cell\n  } of new TableWalker(table)) {\n    map[row][column] = cell;\n  }\n  return map;\n}\n/**\n * Make selected cells rectangular by splitting the cells that stand out from a rectangular selection.\n *\n * In the table below a selection is shown with \"::\" and slots with anchor cells are named.\n *\n * +----+----+----+----+----+                    +----+----+----+----+----+\n * | 00 | 01 | 02 | 03      |                    | 00 | 01 | 02 | 03      |\n * +    +----+    +----+----+                    |    ::::::::::::::::----+\n * |    | 11 |    | 13 | 14 |                    |    ::11 |    | 13:: 14 |    <- first row\n * +----+----+    +    +----+                    +----::---|    |   ::----+\n * | 20 | 21 |    |    | 24 |   select cells:    | 20 ::21 |    |   :: 24 |\n * +----+----+    +----+----+     11 -> 33       +----::---|    |---::----+\n * | 30      |    | 33 | 34 |                    | 30 ::   |    | 33:: 34 |    <- last row\n * +         +    +----+    +                    |    ::::::::::::::::    +\n * |         |    | 43 |    |                    |         |    | 43 |    |\n * +----+----+----+----+----+                    +----+----+----+----+----+\n *                                                      ^          ^\n *                                                     first & last columns\n *\n * Will update table to:\n *\n *                       +----+----+----+----+----+\n *                       | 00 | 01 | 02 | 03      |\n *                       +    +----+----+----+----+\n *                       |    | 11 |    | 13 | 14 |\n *                       +----+----+    +    +----+\n *                       | 20 | 21 |    |    | 24 |\n *                       +----+----+    +----+----+\n *                       | 30 |    |    | 33 | 34 |\n *                       +    +----+----+----+    +\n *                       |    |    |    | 43 |    |\n *                       +----+----+----+----+----+\n *\n * In th example above:\n * - Cell \"02\" which have `rowspan = 4` must be trimmed at first and at after last row.\n * - Cell \"03\" which have `rowspan = 2` and `colspan = 2` must be trimmed at first column and after last row.\n * - Cells \"00\", \"03\" & \"30\" which cannot be cut by this algorithm as they are outside the trimmed area.\n * - Cell \"13\" cannot be cut as it is inside the trimmed area.\n */\nfunction splitCellsToRectangularSelection(table, dimensions, writer) {\n  const {\n    firstRow,\n    lastRow,\n    firstColumn,\n    lastColumn\n  } = dimensions;\n  const rowIndexes = {\n    first: firstRow,\n    last: lastRow\n  };\n  const columnIndexes = {\n    first: firstColumn,\n    last: lastColumn\n  };\n  // 1. Split cells vertically in two steps as first step might create cells that needs to split again.\n  doVerticalSplit(table, firstColumn, rowIndexes, writer);\n  doVerticalSplit(table, lastColumn + 1, rowIndexes, writer);\n  // 2. Split cells horizontally in two steps as first step might create cells that needs to split again.\n  doHorizontalSplit(table, firstRow, columnIndexes, writer);\n  doHorizontalSplit(table, lastRow + 1, columnIndexes, writer, firstRow);\n}\nfunction doHorizontalSplit(table, splitRow, limitColumns, writer, startRow = 0) {\n  // If selection starts at first row then no split is needed.\n  if (splitRow < 1) {\n    return;\n  }\n  const overlappingCells = getVerticallyOverlappingCells(table, splitRow, startRow);\n  // Filter out cells that are not touching insides of the rectangular selection.\n  const cellsToSplit = overlappingCells.filter(({\n    column,\n    cellWidth\n  }) => isAffectedBySelection(column, cellWidth, limitColumns));\n  return cellsToSplit.map(({\n    cell\n  }) => splitHorizontally(cell, splitRow, writer));\n}\nfunction doVerticalSplit(table, splitColumn, limitRows, writer) {\n  // If selection starts at first column then no split is needed.\n  if (splitColumn < 1) {\n    return;\n  }\n  const overlappingCells = getHorizontallyOverlappingCells(table, splitColumn);\n  // Filter out cells that are not touching insides of the rectangular selection.\n  const cellsToSplit = overlappingCells.filter(({\n    row,\n    cellHeight\n  }) => isAffectedBySelection(row, cellHeight, limitRows));\n  return cellsToSplit.map(({\n    cell,\n    column\n  }) => splitVertically(cell, column, splitColumn, writer));\n}\n/**\n * Checks if cell at given row (column) is affected by a rectangular selection defined by first/last column (row).\n *\n * The same check is used for row as for column.\n */\nfunction isAffectedBySelection(index, span, limit) {\n  const endIndex = index + span - 1;\n  const {\n    first,\n    last\n  } = limit;\n  const isInsideSelection = index >= first && index <= last;\n  const overlapsSelectionFromOutside = index < first && endIndex >= first;\n  return isInsideSelection || overlapsSelectionFromOutside;\n}\n\n/**\n * This plugin enables keyboard navigation for tables.\n * It is loaded automatically by the {@link module:table/table~Table} plugin.\n */\nclass TableKeyboard extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableKeyboard';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableSelection, TableUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const view = editor.editing.view;\n    const viewDocument = view.document;\n    const t = editor.t;\n    this.listenTo(viewDocument, 'arrowKey', (...args) => this._onArrowKey(...args), {\n      context: 'table'\n    });\n    this.listenTo(viewDocument, 'tab', (...args) => this._handleTabOnSelectedTable(...args), {\n      context: 'figure'\n    });\n    this.listenTo(viewDocument, 'tab', (...args) => this._handleTab(...args), {\n      context: ['th', 'td']\n    });\n    // Add the information about the keystrokes to the accessibility database.\n    editor.accessibility.addKeystrokeInfoGroup({\n      id: 'table',\n      label: t('Keystrokes that can be used in a table cell'),\n      keystrokes: [{\n        label: t('Move the selection to the next cell'),\n        keystroke: 'Tab'\n      }, {\n        label: t('Move the selection to the previous cell'),\n        keystroke: 'Shift+Tab'\n      }, {\n        label: t('Insert a new table row (when in the last cell of a table)'),\n        keystroke: 'Tab'\n      }, {\n        label: t('Navigate through the table'),\n        keystroke: [['arrowup'], ['arrowright'], ['arrowdown'], ['arrowleft']]\n      }]\n    });\n  }\n  /**\n  * Handles {@link module:engine/view/document~Document#event:tab tab} events for the <kbd>Tab</kbd> key executed\n  * when the table widget is selected.\n  */\n  _handleTabOnSelectedTable(bubblingEventInfo, domEventData) {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    const selectedElement = selection.getSelectedElement();\n    if (!selectedElement || !selectedElement.is('element', 'table')) {\n      return;\n    }\n    domEventData.preventDefault();\n    domEventData.stopPropagation();\n    bubblingEventInfo.stop();\n    editor.model.change(writer => {\n      writer.setSelection(writer.createRangeIn(selectedElement.getChild(0).getChild(0)));\n    });\n  }\n  /**\n  * Handles {@link module:engine/view/document~Document#event:tab tab} events for the <kbd>Tab</kbd> key executed\n  * inside table cells.\n  */\n  _handleTab(bubblingEventInfo, domEventData) {\n    const editor = this.editor;\n    const tableUtils = this.editor.plugins.get(TableUtils);\n    const tableSelection = this.editor.plugins.get('TableSelection');\n    const selection = editor.model.document.selection;\n    const isForward = !domEventData.shiftKey;\n    let tableCell = tableUtils.getTableCellsContainingSelection(selection)[0];\n    if (!tableCell) {\n      tableCell = tableSelection.getFocusCell();\n    }\n    if (!tableCell) {\n      return;\n    }\n    domEventData.preventDefault();\n    domEventData.stopPropagation();\n    bubblingEventInfo.stop();\n    const tableRow = tableCell.parent;\n    const table = tableRow.parent;\n    const currentRowIndex = table.getChildIndex(tableRow);\n    const currentCellIndex = tableRow.getChildIndex(tableCell);\n    const isFirstCellInRow = currentCellIndex === 0;\n    if (!isForward && isFirstCellInRow && currentRowIndex === 0) {\n      // Set the selection over the whole table if the selection was in the first table cell.\n      editor.model.change(writer => {\n        writer.setSelection(writer.createRangeOn(table));\n      });\n      return;\n    }\n    const isLastCellInRow = currentCellIndex === tableRow.childCount - 1;\n    const isLastRow = currentRowIndex === tableUtils.getRows(table) - 1;\n    if (isForward && isLastRow && isLastCellInRow) {\n      editor.execute('insertTableRowBelow');\n      // Check if the command actually added a row. If `insertTableRowBelow` execution didn't add a row (because it was disabled\n      // or it got overwritten) set the selection over the whole table to mirror the first cell case.\n      if (currentRowIndex === tableUtils.getRows(table) - 1) {\n        editor.model.change(writer => {\n          writer.setSelection(writer.createRangeOn(table));\n        });\n        return;\n      }\n    }\n    let cellToFocus;\n    // Move to the first cell in the next row.\n    if (isForward && isLastCellInRow) {\n      const nextRow = table.getChild(currentRowIndex + 1);\n      cellToFocus = nextRow.getChild(0);\n    } else if (!isForward && isFirstCellInRow) {\n      const previousRow = table.getChild(currentRowIndex - 1);\n      cellToFocus = previousRow.getChild(previousRow.childCount - 1);\n    } else {\n      cellToFocus = tableRow.getChild(currentCellIndex + (isForward ? 1 : -1));\n    }\n    editor.model.change(writer => {\n      writer.setSelection(writer.createRangeIn(cellToFocus));\n    });\n  }\n  /**\n  * Handles {@link module:engine/view/document~Document#event:keydown keydown} events.\n  */\n  _onArrowKey(eventInfo, domEventData) {\n    const editor = this.editor;\n    const keyCode = domEventData.keyCode;\n    const direction = getLocalizedArrowKeyCodeDirection(keyCode, editor.locale.contentLanguageDirection);\n    const wasHandled = this._handleArrowKeys(direction, domEventData.shiftKey);\n    if (wasHandled) {\n      domEventData.preventDefault();\n      domEventData.stopPropagation();\n      eventInfo.stop();\n    }\n  }\n  /**\n  * Handles arrow keys to move the selection around the table.\n  *\n  * @param direction The direction of the arrow key.\n  * @param expandSelection If the current selection should be expanded.\n  * @returns Returns `true` if key was handled.\n  */\n  _handleArrowKeys(direction, expandSelection) {\n    const tableUtils = this.editor.plugins.get(TableUtils);\n    const tableSelection = this.editor.plugins.get('TableSelection');\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const isForward = ['right', 'down'].includes(direction);\n    // In case one or more table cells are selected (from outside),\n    // move the selection to a cell adjacent to the selected table fragment.\n    const selectedCells = tableUtils.getSelectedTableCells(selection);\n    if (selectedCells.length) {\n      let focusCell;\n      if (expandSelection) {\n        focusCell = tableSelection.getFocusCell();\n      } else {\n        focusCell = isForward ? selectedCells[selectedCells.length - 1] : selectedCells[0];\n      }\n      this._navigateFromCellInDirection(focusCell, direction, expandSelection);\n      return true;\n    }\n    // Abort if we're not in a table cell.\n    const tableCell = selection.focus.findAncestor('tableCell');\n    /* istanbul ignore if: paranoid check -- @preserve */\n    if (!tableCell) {\n      return false;\n    }\n    // When the selection is not collapsed.\n    if (!selection.isCollapsed) {\n      if (expandSelection) {\n        // Navigation is in the opposite direction than the selection direction so this is shrinking of the selection.\n        // Selection for sure will not approach cell edge.\n        //\n        // With a special case when all cell content is selected - then selection should expand to the other cell.\n        // Note: When the entire cell gets selected using CTRL+A, the selection is always forward.\n        if (selection.isBackward == isForward && !selection.containsEntireContent(tableCell)) {\n          return false;\n        }\n      } else {\n        const selectedElement = selection.getSelectedElement();\n        // It will collapse for non-object selected so it's not going to move to other cell.\n        if (!selectedElement || !model.schema.isObject(selectedElement)) {\n          return false;\n        }\n      }\n    }\n    // Let's check if the selection is at the beginning/end of the cell.\n    if (this._isSelectionAtCellEdge(selection, tableCell, isForward)) {\n      this._navigateFromCellInDirection(tableCell, direction, expandSelection);\n      return true;\n    }\n    return false;\n  }\n  /**\n  * Returns `true` if the selection is at the boundary of a table cell according to the navigation direction.\n  *\n  * @param selection The current selection.\n  * @param tableCell The current table cell element.\n  * @param isForward The expected navigation direction.\n  */\n  _isSelectionAtCellEdge(selection, tableCell, isForward) {\n    const model = this.editor.model;\n    const schema = this.editor.model.schema;\n    const focus = isForward ? selection.getLastPosition() : selection.getFirstPosition();\n    // If the current limit element is not table cell we are for sure not at the cell edge.\n    // Also `modifySelection` will not let us out of it.\n    if (!schema.getLimitElement(focus).is('element', 'tableCell')) {\n      const boundaryPosition = model.createPositionAt(tableCell, isForward ? 'end' : 0);\n      return boundaryPosition.isTouching(focus);\n    }\n    const probe = model.createSelection(focus);\n    model.modifySelection(probe, {\n      direction: isForward ? 'forward' : 'backward'\n    });\n    // If there was no change in the focus position, then it's not possible to move the selection there.\n    return focus.isEqual(probe.focus);\n  }\n  /**\n  * Moves the selection from the given table cell in the specified direction.\n  *\n  * @param focusCell The table cell that is current multi-cell selection focus.\n  * @param direction Direction in which selection should move.\n  * @param expandSelection If the current selection should be expanded. Default value is false.\n  */\n  _navigateFromCellInDirection(focusCell, direction, expandSelection = false) {\n    const model = this.editor.model;\n    const table = focusCell.findAncestor('table');\n    const tableMap = [...new TableWalker(table, {\n      includeAllSlots: true\n    })];\n    const {\n      row: lastRow,\n      column: lastColumn\n    } = tableMap[tableMap.length - 1];\n    const currentCellInfo = tableMap.find(({\n      cell\n    }) => cell == focusCell);\n    let {\n      row,\n      column\n    } = currentCellInfo;\n    switch (direction) {\n      case 'left':\n        column--;\n        break;\n      case 'up':\n        row--;\n        break;\n      case 'right':\n        column += currentCellInfo.cellWidth;\n        break;\n      case 'down':\n        row += currentCellInfo.cellHeight;\n        break;\n    }\n    const isOutsideVertically = row < 0 || row > lastRow;\n    const isBeforeFirstCell = column < 0 && row <= 0;\n    const isAfterLastCell = column > lastColumn && row >= lastRow;\n    // Note that if the table cell at the end of a row is row-spanned then isAfterLastCell will never be true.\n    // However, we don't know if user was navigating on the last row or not, so let's stay in the table.\n    if (isOutsideVertically || isBeforeFirstCell || isAfterLastCell) {\n      model.change(writer => {\n        writer.setSelection(writer.createRangeOn(table));\n      });\n      return;\n    }\n    if (column < 0) {\n      column = expandSelection ? 0 : lastColumn;\n      row--;\n    } else if (column > lastColumn) {\n      column = expandSelection ? lastColumn : 0;\n      row++;\n    }\n    const cellToSelect = tableMap.find(cellInfo => cellInfo.row == row && cellInfo.column == column).cell;\n    const isForward = ['right', 'down'].includes(direction);\n    const tableSelection = this.editor.plugins.get('TableSelection');\n    if (expandSelection && tableSelection.isEnabled) {\n      const anchorCell = tableSelection.getAnchorCell() || focusCell;\n      tableSelection.setCellSelection(anchorCell, cellToSelect);\n    } else {\n      const positionToSelect = model.createPositionAt(cellToSelect, isForward ? 0 : 'end');\n      model.change(writer => {\n        writer.setSelection(positionToSelect);\n      });\n    }\n  }\n}\n\n/**\n * The mouse selection event observer.\n *\n * It registers listeners for the following DOM events:\n *\n * - `'mousemove'`\n * - `'mouseleave'`\n *\n * Note that this observer is disabled by default. To enable this observer, it needs to be added to\n * {@link module:engine/view/view~View} using the {@link module:engine/view/view~View#addObserver} method.\n *\n * The observer is registered by the {@link module:table/tableselection~TableSelection} plugin.\n */\nclass MouseEventsObserver extends DomEventObserver {\n  domEventType = ['mousemove', 'mouseleave'];\n  /**\n  * @inheritDoc\n  */\n  onDomEvent(domEvent) {\n    this.fire(domEvent.type, domEvent);\n  }\n}\n\n/**\n * This plugin enables a table cells' selection with the mouse.\n * It is loaded automatically by the {@link module:table/table~Table} plugin.\n */\nclass TableMouse extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableMouse';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableSelection, TableUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Currently the MouseObserver only handles `mousedown` and `mouseup` events.\n    // TODO move to the engine?\n    editor.editing.view.addObserver(MouseEventsObserver);\n    this._enableShiftClickSelection();\n    this._enableMouseDragSelection();\n  }\n  /**\n  * Enables making cells selection by <kbd>Shift</kbd>+click. Creates a selection from the cell which previously held\n  * the selection to the cell which was clicked. It can be the same cell, in which case it selects a single cell.\n  */\n  _enableShiftClickSelection() {\n    const editor = this.editor;\n    const tableUtils = editor.plugins.get(TableUtils);\n    let blockSelectionChange = false;\n    const tableSelection = editor.plugins.get(TableSelection);\n    this.listenTo(editor.editing.view.document, 'mousedown', (evt, domEventData) => {\n      const selection = editor.model.document.selection;\n      if (!this.isEnabled || !tableSelection.isEnabled) {\n        return;\n      }\n      if (!domEventData.domEvent.shiftKey) {\n        return;\n      }\n      const anchorCell = tableSelection.getAnchorCell() || tableUtils.getTableCellsContainingSelection(selection)[0];\n      if (!anchorCell) {\n        return;\n      }\n      const targetCell = this._getModelTableCellFromDomEvent(domEventData);\n      if (targetCell && haveSameTableParent(anchorCell, targetCell)) {\n        blockSelectionChange = true;\n        tableSelection.setCellSelection(anchorCell, targetCell);\n        domEventData.preventDefault();\n      }\n    });\n    this.listenTo(editor.editing.view.document, 'mouseup', () => {\n      blockSelectionChange = false;\n    });\n    // We need to ignore a `selectionChange` event that is fired after we render our new table cells selection.\n    // When downcasting table cells selection to the view, we put the view selection in the last selected cell\n    // in a place that may not be natively a \"correct\" location. This is â€“ we put it directly in the `<td>` element.\n    // All browsers fire the native `selectionchange` event.\n    // However, all browsers except Safari return the selection in the exact place where we put it\n    // (even though it's visually normalized). Safari returns `<td><p>^foo` that makes our selection observer\n    // fire our `selectionChange` event (because the view selection that we set in the first step differs from the DOM selection).\n    // Since `selectionChange` is fired, we automatically update the model selection that moves it that paragraph.\n    // This breaks our dear cells selection.\n    //\n    // Theoretically this issue concerns only Safari that is the only browser that do normalize the selection.\n    // However, to avoid code branching and to have a good coverage for this event blocker, I enabled it for all browsers.\n    //\n    // Note: I'm keeping the `blockSelectionChange` state separately for shift+click and mouse drag (exact same logic)\n    // so I don't have to try to analyze whether they don't overlap in some weird cases. Probably they don't.\n    // But I have other things to do, like writing this comment.\n    this.listenTo(editor.editing.view.document, 'selectionChange', evt => {\n      if (blockSelectionChange) {\n        // @if CK_DEBUG // console.log( 'Blocked selectionChange to avoid breaking table cells selection.' );\n        evt.stop();\n      }\n    }, {\n      priority: 'highest'\n    });\n  }\n  /**\n  * Enables making cells selection by dragging.\n  *\n  * The selection is made only on mousemove. Mouse tracking is started on mousedown.\n  * However, the cells selection is enabled only after the mouse cursor left the anchor cell.\n  * Thanks to that normal text selection within one cell works just fine. However, you can still select\n  * just one cell by leaving the anchor cell and moving back to it.\n  */\n  _enableMouseDragSelection() {\n    const editor = this.editor;\n    let anchorCell, targetCell;\n    let beganCellSelection = false;\n    let blockSelectionChange = false;\n    const tableSelection = editor.plugins.get(TableSelection);\n    this.listenTo(editor.editing.view.document, 'mousedown', (evt, domEventData) => {\n      if (!this.isEnabled || !tableSelection.isEnabled) {\n        return;\n      }\n      // Make sure to not conflict with the shift+click listener and any other possible handler.\n      if (domEventData.domEvent.shiftKey || domEventData.domEvent.ctrlKey || domEventData.domEvent.altKey) {\n        return;\n      }\n      anchorCell = this._getModelTableCellFromDomEvent(domEventData);\n    });\n    this.listenTo(editor.editing.view.document, 'mousemove', (evt, domEventData) => {\n      if (!domEventData.domEvent.buttons) {\n        return;\n      }\n      if (!anchorCell) {\n        return;\n      }\n      const newTargetCell = this._getModelTableCellFromDomEvent(domEventData);\n      if (newTargetCell && haveSameTableParent(anchorCell, newTargetCell)) {\n        targetCell = newTargetCell;\n        // Switch to the cell selection mode after the mouse cursor left the anchor cell.\n        // Switch off only on mouseup (makes selecting a single cell possible).\n        if (!beganCellSelection && targetCell != anchorCell) {\n          beganCellSelection = true;\n        }\n      }\n      // Yep, not making a cell selection yet. See method docs.\n      if (!beganCellSelection) {\n        return;\n      }\n      blockSelectionChange = true;\n      tableSelection.setCellSelection(anchorCell, targetCell);\n      domEventData.preventDefault();\n    });\n    this.listenTo(editor.editing.view.document, 'mouseup', () => {\n      beganCellSelection = false;\n      blockSelectionChange = false;\n      anchorCell = null;\n      targetCell = null;\n    });\n    // See the explanation in `_enableShiftClickSelection()`.\n    this.listenTo(editor.editing.view.document, 'selectionChange', evt => {\n      if (blockSelectionChange) {\n        // @if CK_DEBUG // console.log( 'Blocked selectionChange to avoid breaking table cells selection.' );\n        evt.stop();\n      }\n    }, {\n      priority: 'highest'\n    });\n  }\n  /**\n  * Returns the model table cell element based on the target element of the passed DOM event.\n  *\n  * @returns Returns the table cell or `undefined`.\n  */\n  _getModelTableCellFromDomEvent(domEventData) {\n    // Note: Work with positions (not element mapping) because the target element can be an attribute or other non-mapped element.\n    const viewTargetElement = domEventData.target;\n    const viewPosition = this.editor.editing.view.createPositionAt(viewTargetElement, 0);\n    const modelPosition = this.editor.editing.mapper.toModelPosition(viewPosition);\n    const modelElement = modelPosition.parent;\n    return modelElement.findAncestor('tableCell', {\n      includeSelf: true\n    });\n  }\n}\nfunction haveSameTableParent(cellA, cellB) {\n  return cellA.parent.parent == cellB.parent.parent;\n}\n\n/**\n * The table plugin.\n *\n * For a detailed overview, check the {@glink features/tables/tables Table feature documentation}.\n *\n * This is a \"glue\" plugin that loads the following table features:\n *\n * * {@link module:table/tableediting~TableEditing editing feature},\n * * {@link module:table/tableselection~TableSelection selection feature},\n * * {@link module:table/tablekeyboard~TableKeyboard keyboard navigation feature},\n * * {@link module:table/tablemouse~TableMouse mouse selection feature},\n * * {@link module:table/tableclipboard~TableClipboard clipboard feature},\n * * {@link module:table/tableui~TableUI UI feature}.\n */\nclass Table extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableEditing, TableUI, TableSelection, TableMouse, TableKeyboard, TableClipboard, Widget];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'Table';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The plain table output feature.\n *\n * This feature strips the `<figure>` tag from the table data. This is because this tag is not supported\n * by most popular email clients and removing it ensures compatibility.\n */\nclass PlainTableOutput extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'PlainTableOutput';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [Table];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    // Override default table data downcast converter.\n    editor.conversion.for('dataDowncast').elementToStructure({\n      model: 'table',\n      view: downcastTableElement,\n      converterPriority: 'high'\n    });\n    // Make sure table <caption> is downcasted into <caption> in the data pipeline when necessary.\n    if (editor.plugins.has('TableCaption')) {\n      editor.conversion.for('dataDowncast').elementToElement({\n        model: 'caption',\n        view: (modelElement, {\n          writer\n        }) => {\n          if (modelElement.parent.name === 'table') {\n            return writer.createContainerElement('caption');\n          }\n        },\n        converterPriority: 'high'\n      });\n    }\n    // Handle border-style, border-color, border-width and background-color table attributes.\n    if (editor.plugins.has('TableProperties')) {\n      downcastTableBorderAndBackgroundAttributes(editor);\n    }\n    editor.conversion.for('upcast').add(dispatcher => {\n      dispatcher.on('element:table', (evt, data, conversionApi) => {\n        // It's not necessary to upcast the `table` class. This class was only added in data downcast\n        // to center a plain table in the editor output.\n        // See: https://github.com/ckeditor/ckeditor5/issues/17888.\n        conversionApi.consumable.consume(data.viewItem, {\n          classes: 'table'\n        });\n      });\n    });\n  }\n}\n/**\n * The plain table downcast converter callback.\n *\n * @param table Table model element.\n * @param conversionApi The conversion API object.\n * @returns Created element.\n */\nfunction downcastTableElement(table, {\n  writer\n}) {\n  const headingRows = table.getAttribute('headingRows') || 0;\n  // Table head rows slot.\n  const headRowsSlot = writer.createSlot(element => element.is('element', 'tableRow') && element.index < headingRows);\n  // Table body rows slot.\n  const bodyRowsSlot = writer.createSlot(element => element.is('element', 'tableRow') && element.index >= headingRows);\n  // Table children slot.\n  const childrenSlot = writer.createSlot(element => !element.is('element', 'tableRow'));\n  // Table <thead> element with all the heading rows.\n  const theadElement = writer.createContainerElement('thead', null, headRowsSlot);\n  // Table <tbody> element with all the body rows.\n  const tbodyElement = writer.createContainerElement('tbody', null, bodyRowsSlot);\n  // Table contents element containing <thead> and <tbody> when necessary.\n  const tableContentElements = [];\n  if (headingRows) {\n    tableContentElements.push(theadElement);\n  }\n  if (headingRows < table.childCount) {\n    tableContentElements.push(tbodyElement);\n  }\n  // Create table structure.\n  //\n  // <table>\n  //    {children-slot-like-caption}\n  //    <thead>\n  //        {table-head-rows-slot}\n  //    </thead>\n  //    <tbody>\n  //        {table-body-rows-slot}\n  //    </tbody>\n  // </table>\n  return writer.createContainerElement('table', {\n    class: 'table'\n  }, [childrenSlot, ...tableContentElements]);\n}\n/**\n * Register table border and background attributes converters.\n */\nfunction downcastTableBorderAndBackgroundAttributes(editor) {\n  const modelAttributes = {\n    'border-width': 'tableBorderWidth',\n    'border-color': 'tableBorderColor',\n    'border-style': 'tableBorderStyle',\n    'background-color': 'tableBackgroundColor'\n  };\n  for (const [styleName, modelAttribute] of Object.entries(modelAttributes)) {\n    editor.conversion.for('dataDowncast').add(dispatcher => {\n      return dispatcher.on(`attribute:${modelAttribute}:table`, (evt, data, conversionApi) => {\n        const {\n          item,\n          attributeNewValue\n        } = data;\n        const {\n          mapper,\n          writer\n        } = conversionApi;\n        if (!conversionApi.consumable.consume(item, evt.name)) {\n          return;\n        }\n        const table = mapper.toViewElement(item);\n        if (attributeNewValue) {\n          writer.setStyle(styleName, attributeNewValue, table);\n        } else {\n          writer.removeStyle(styleName, table);\n        }\n      }, {\n        priority: 'high'\n      });\n    });\n  }\n}\n\n/**\n * Depending on the position of the selection either return the selected table or the table higher in the hierarchy.\n */\nfunction getSelectionAffectedTableWidget(selection) {\n  const selectedTable = getSelectedTableWidget(selection);\n  if (selectedTable) {\n    return selectedTable;\n  }\n  return getTableWidgetAncestor(selection);\n}\n/**\n * Returns a table widget editing view element if one is selected.\n */\nfunction getSelectedTableWidget(selection) {\n  const viewElement = selection.getSelectedElement();\n  if (viewElement && isTableWidget(viewElement)) {\n    return viewElement;\n  }\n  return null;\n}\n/**\n * Returns a table widget editing view element if one is among the selection's ancestors.\n */\nfunction getTableWidgetAncestor(selection) {\n  const selectionPosition = selection.getFirstPosition();\n  if (!selectionPosition) {\n    return null;\n  }\n  let parent = selectionPosition.parent;\n  while (parent) {\n    if (parent.is('element') && isTableWidget(parent)) {\n      return parent;\n    }\n    parent = parent.parent;\n  }\n  return null;\n}\n/**\n * Checks if a given view element is a table widget.\n */\nfunction isTableWidget(viewElement) {\n  return !!viewElement.getCustomProperty('table') && isWidget(viewElement);\n}\n\n/**\n * The table toolbar class. It creates toolbars for the table feature and its content (for now only for the table cell content).\n *\n * The table toolbar shows up when a table widget is selected. Its components (e.g. buttons) are created based on the\n * {@link module:table/tableconfig~TableConfig#tableToolbar `table.tableToolbar` configuration option}.\n *\n * Table content toolbar shows up when the selection is inside the content of a table. It creates its component based on the\n * {@link module:table/tableconfig~TableConfig#contentToolbar `table.contentToolbar` configuration option}.\n */\nclass TableToolbar extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [WidgetToolbarRepository];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableToolbar';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    const t = editor.t;\n    const widgetToolbarRepository = editor.plugins.get(WidgetToolbarRepository);\n    const tableContentToolbarItems = editor.config.get('table.contentToolbar');\n    const tableToolbarItems = editor.config.get('table.tableToolbar');\n    if (tableContentToolbarItems) {\n      widgetToolbarRepository.register('tableContent', {\n        ariaLabel: t('Table toolbar'),\n        items: tableContentToolbarItems,\n        getRelatedElement: getTableWidgetAncestor\n      });\n    }\n    if (tableToolbarItems) {\n      widgetToolbarRepository.register('table', {\n        ariaLabel: t('Table toolbar'),\n        items: tableToolbarItems,\n        getRelatedElement: getSelectedTableWidget\n      });\n    }\n  }\n}\n\n/**\n * The color input view class. It allows the user to type in a color (hex, rgb, etc.)\n * or choose it from the configurable color palette with a preview.\n *\n * @internal\n */\nclass ColorInputView extends View {\n  /**\n  * A cached reference to the options passed to the constructor.\n  */\n  options;\n  /**\n  * Tracks information about the DOM focus in the view.\n  */\n  focusTracker;\n  /**\n  * Helps cycling over focusable children in the input view.\n  */\n  focusCycler;\n  /**\n  * A collection of views that can be focused in the view.\n  */\n  _focusables;\n  /**\n  * An instance of the dropdown allowing to select a color from a grid.\n  */\n  dropdownView;\n  /**\n  * An instance of the input allowing the user to type a color value.\n  */\n  inputView;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * The flag that indicates whether the user is still typing.\n  * If set to true, it means that the text input field ({@link #inputView}) still has the focus.\n  * So, we should interrupt the user by replacing the input's value.\n  */\n  _stillTyping;\n  /**\n  * Creates an instance of the color input view.\n  *\n  * @param locale The locale instance.\n  * @param options The input options.\n  * @param options.colorDefinitions The colors to be displayed in the palette inside the input's dropdown.\n  * @param options.columns The number of columns in which the colors will be displayed.\n  * @param options.defaultColorValue If specified, the color input view will replace the \"Remove color\" button with\n  * the \"Restore default\" button. Instead of clearing the input field, the default color value will be set.\n  */\n  constructor(locale, options) {\n    super(locale);\n    this.set('value', '');\n    this.set('isReadOnly', false);\n    this.set('isFocused', false);\n    this.set('isEmpty', true);\n    this.options = options;\n    this.focusTracker = new FocusTracker();\n    this._focusables = new ViewCollection();\n    this.dropdownView = this._createDropdownView();\n    this.inputView = this._createInputTextView();\n    this.keystrokes = new KeystrokeHandler();\n    this._stillTyping = false;\n    this.focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate items backwards using the <kbd>Shift</kbd> + <kbd>Tab</kbd> keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate items forwards using the <kbd>Tab</kbd> key.\n        focusNext: 'tab'\n      }\n    });\n    this.setTemplate({\n      tag: 'div',\n      attributes: {\n        class: ['ck', 'ck-input-color']\n      },\n      children: [this.dropdownView, this.inputView]\n    });\n    this.on('change:value', (evt, name, inputValue) => this._setInputValue(inputValue));\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    [this.inputView, this.dropdownView.buttonView].forEach(view => {\n      this.focusTracker.add(view.element);\n      this._focusables.add(view);\n    });\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * Focuses the view.\n  */\n  focus(direction) {\n    if (direction === -1) {\n      this.focusCycler.focusLast();\n    } else {\n      this.focusCycler.focusFirst();\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Creates and configures the {@link #dropdownView}.\n  */\n  _createDropdownView() {\n    const locale = this.locale;\n    const t = locale.t;\n    const bind = this.bindTemplate;\n    const colorSelector = this._createColorSelector(locale);\n    const dropdown = createDropdown(locale);\n    const colorPreview = new View();\n    colorPreview.setTemplate({\n      tag: 'span',\n      attributes: {\n        class: ['ck', 'ck-input-color__button__preview'],\n        style: {\n          backgroundColor: bind.to('value')\n        }\n      },\n      children: [{\n        tag: 'span',\n        attributes: {\n          class: ['ck', 'ck-input-color__button__preview__no-color-indicator', bind.if('value', 'ck-hidden', value => value != '')]\n        }\n      }]\n    });\n    dropdown.buttonView.extendTemplate({\n      attributes: {\n        class: 'ck-input-color__button'\n      }\n    });\n    dropdown.buttonView.children.add(colorPreview);\n    dropdown.buttonView.label = t('Color picker');\n    dropdown.buttonView.tooltip = true;\n    dropdown.panelPosition = locale.uiLanguageDirection === 'rtl' ? 'se' : 'sw';\n    dropdown.panelView.children.add(colorSelector);\n    dropdown.bind('isEnabled').to(this, 'isReadOnly', value => !value);\n    dropdown.on('change:isOpen', (evt, name, isVisible) => {\n      if (isVisible) {\n        colorSelector.updateSelectedColors();\n        colorSelector.showColorGridsFragment();\n      }\n    });\n    return dropdown;\n  }\n  /**\n  * Creates and configures an instance of {@link module:ui/inputtext/inputtextview~InputTextView}.\n  *\n  * @returns A configured instance to be set as {@link #inputView}.\n  */\n  _createInputTextView() {\n    const locale = this.locale;\n    const inputView = new InputTextView(locale);\n    inputView.extendTemplate({\n      on: {\n        blur: inputView.bindTemplate.to('blur')\n      }\n    });\n    inputView.value = this.value;\n    inputView.bind('isReadOnly', 'hasError').to(this);\n    this.bind('isFocused', 'isEmpty').to(inputView);\n    inputView.on('input', () => {\n      const inputValue = inputView.element.value;\n      // Check if the value matches one of our defined colors' label.\n      const mappedColor = this.options.colorDefinitions.find(def => inputValue === def.label);\n      this._stillTyping = true;\n      this.value = mappedColor && mappedColor.color || inputValue;\n    });\n    inputView.on('blur', () => {\n      this._stillTyping = false;\n      this._setInputValue(inputView.element.value);\n    });\n    inputView.delegate('input').to(this);\n    return inputView;\n  }\n  /**\n  * Creates and configures the panel with \"color grid\" and \"color picker\" inside the {@link #dropdownView}.\n  */\n  _createColorSelector(locale) {\n    const t = locale.t;\n    const defaultColor = this.options.defaultColorValue || '';\n    const removeColorButtonLabel = defaultColor ? t('Restore default') : t('Remove color');\n    const colorSelector = new ColorSelectorView(locale, {\n      colors: this.options.colorDefinitions,\n      columns: this.options.columns,\n      removeButtonLabel: removeColorButtonLabel,\n      colorPickerLabel: t('Color picker'),\n      colorPickerViewConfig: this.options.colorPickerConfig === false ? false : {\n        ...this.options.colorPickerConfig,\n        hideInput: true\n      }\n    });\n    colorSelector.appendUI();\n    colorSelector.on('execute', (evt, data) => {\n      if (data.source === 'colorPickerSaveButton') {\n        this.dropdownView.isOpen = false;\n        return;\n      }\n      this.value = data.value || defaultColor;\n      // Trigger the listener that actually applies the set value.\n      this.fire('input');\n      if (data.source !== 'colorPicker') {\n        this.dropdownView.isOpen = false;\n      }\n    });\n    /**\n    * Color is saved before changes in color picker. In case \"cancel button\" is pressed\n    * this color will be applied.\n    */\n    let backupColor = this.value;\n    colorSelector.on('colorPicker:cancel', () => {\n      /**\n      * Revert color to previous value before changes in color picker.\n      */\n      this.value = backupColor;\n      this.fire('input');\n      this.dropdownView.isOpen = false;\n    });\n    colorSelector.colorGridsFragmentView.colorPickerButtonView.on('execute', () => {\n      /**\n      * Save color value before changes in color picker.\n      */\n      backupColor = this.value;\n    });\n    colorSelector.bind('selectedColor').to(this, 'value');\n    return colorSelector;\n  }\n  /**\n  * Sets {@link #inputView}'s value property to the color value or color label,\n  * if there is one and the user is not typing.\n  *\n  * Handles cases like:\n  *\n  * * Someone picks the color in the grid.\n  * * The color is set from the plugin level.\n  *\n  * @param inputValue Color value to be set.\n  */\n  _setInputValue(inputValue) {\n    if (!this._stillTyping) {\n      const normalizedInputValue = normalizeColor(inputValue);\n      // Check if the value matches one of our defined colors.\n      const mappedColor = this.options.colorDefinitions.find(def => normalizedInputValue === normalizeColor(def.color));\n      if (mappedColor) {\n        this.inputView.value = mappedColor.label;\n      } else {\n        this.inputView.value = inputValue || '';\n      }\n    }\n  }\n}\n/**\n * Normalizes color value, by stripping extensive whitespace.\n * For example., transforms:\n * * `   rgb(  25 50    0 )` to `rgb(25 50 0)`,\n * * \"\\t  rgb(  25 ,  50,0 )\t\t\" to `rgb(25 50 0)`.\n *\n * @param colorString The value to be normalized.\n */\nfunction normalizeColor(colorString) {\n  return colorString // Remove any whitespace right after `(` or `,`.\n  .replace(/([(,])\\s+/g, '$1') // Remove any whitespace at the beginning or right before the end, `)`, `,`, or another whitespace.\n  .replace(/^\\s+|\\s+(?=[),\\s]|$)/g, '') // Then, replace `,` or whitespace with a single space.\n  .replace(/,|\\s/g, ' ');\n}\nconst isEmpty = val => val === '';\n/**\n * Returns an object containing pairs of CSS border style values and their localized UI\n * labels. Used by {@link module:table/tablecellproperties/ui/tablecellpropertiesview~TableCellPropertiesView}\n * and {@link module:table/tableproperties/ui/tablepropertiesview~TablePropertiesView}.\n *\n * @param t The \"t\" function provided by the editor that is used to localize strings.\n */\nfunction getBorderStyleLabels(t) {\n  return {\n    none: t('None'),\n    solid: t('Solid'),\n    dotted: t('Dotted'),\n    dashed: t('Dashed'),\n    double: t('Double'),\n    groove: t('Groove'),\n    ridge: t('Ridge'),\n    inset: t('Inset'),\n    outset: t('Outset')\n  };\n}\n/**\n * Returns a localized error string that can be displayed next to color (background, border)\n * fields that have an invalid value.\n *\n * @param t The \"t\" function provided by the editor that is used to localize strings.\n */\nfunction getLocalizedColorErrorText(t) {\n  return t('The color is invalid. Try \"#FF0000\" or \"rgb(255,0,0)\" or \"red\".');\n}\n/**\n * Returns a localized error string that can be displayed next to length (padding, border width)\n * fields that have an invalid value.\n *\n * @param t The \"t\" function provided by the editor that is used to localize strings.\n */\nfunction getLocalizedLengthErrorText(t) {\n  return t('The value is invalid. Try \"10px\" or \"2em\" or simply \"2\".');\n}\n/**\n * Returns `true` when the passed value is an empty string or a valid CSS color expression.\n * Otherwise, `false` is returned.\n *\n * See {@link module:engine/view/styles/utils~isColor}.\n */\nfunction colorFieldValidator(value) {\n  value = value.trim().toLowerCase();\n  return isEmpty(value) || isColor(value);\n}\n/**\n * Returns `true` when the passed value is an empty string, a number without a unit or a valid CSS length expression.\n * Otherwise, `false` is returned.\n *\n * See {@link module:engine/view/styles/utils~isLength}.\n * See {@link module:engine/view/styles/utils~isPercentage}.\n */\nfunction lengthFieldValidator(value) {\n  value = value.trim();\n  return isEmpty(value) || isNumberString(value) || isLength(value) || isPercentage(value);\n}\n/**\n * Returns `true` when the passed value is an empty string, a number without a unit or a valid CSS length expression.\n * Otherwise, `false` is returned.\n *\n * See {@link module:engine/view/styles/utils~isLength}.\n */\nfunction lineWidthFieldValidator(value) {\n  value = value.trim();\n  return isEmpty(value) || isNumberString(value) || isLength(value);\n}\n/**\n * Generates item definitions for a UI dropdown that allows changing the border style of a table or a table cell.\n *\n * @param defaultStyle The default border.\n */\nfunction getBorderStyleDefinitions(view, defaultStyle) {\n  const itemDefinitions = new Collection();\n  const styleLabels = getBorderStyleLabels(view.t);\n  for (const style in styleLabels) {\n    const definition = {\n      type: 'button',\n      model: new ViewModel({\n        _borderStyleValue: style,\n        label: styleLabels[style],\n        role: 'menuitemradio',\n        withText: true\n      })\n    };\n    if (style === 'none') {\n      definition.model.bind('isOn').to(view, 'borderStyle', value => {\n        if (defaultStyle === 'none') {\n          return !value;\n        }\n        return value === style;\n      });\n    } else {\n      definition.model.bind('isOn').to(view, 'borderStyle', value => {\n        return value === style;\n      });\n    }\n    itemDefinitions.add(definition);\n  }\n  return itemDefinitions;\n}\n/**\n * A helper that fills a toolbar with buttons that:\n *\n * * have some labels,\n * * have some icons,\n * * set a certain UI view property value upon execution.\n *\n * @param nameToValue A function that maps a button name to a value. By default names are the same as values.\n */\nfunction fillToolbar(options) {\n  const {\n    view,\n    icons,\n    toolbar,\n    labels,\n    propertyName,\n    nameToValue,\n    defaultValue\n  } = options;\n  for (const name in labels) {\n    const button = new ButtonView(view.locale);\n    button.set({\n      role: 'radio',\n      isToggleable: true,\n      label: labels[name],\n      icon: icons[name],\n      tooltip: labels[name]\n    });\n    // If specified the `nameToValue()` callback, map the value based on the option's name.\n    const buttonValue = nameToValue ? nameToValue(name) : name;\n    button.bind('isOn').to(view, propertyName, value => {\n      // `value` comes from `view[ propertyName ]`.\n      let valueToCompare = value;\n      // If it's empty, and the `defaultValue` is specified, use it instead.\n      if (value === '' && defaultValue) {\n        valueToCompare = defaultValue;\n      }\n      return buttonValue === valueToCompare;\n    });\n    button.on('execute', () => {\n      // Allow toggling alignment if there is no default value specified (especially for layout tables).\n      if (!defaultValue && buttonValue && view[propertyName] === buttonValue) {\n        view[propertyName] = undefined;\n      } else {\n        view[propertyName] = buttonValue;\n      }\n    });\n    toolbar.items.add(button);\n  }\n}\n/**\n * A default color palette used by various user interfaces related to tables, for instance,\n * by {@link module:table/tablecellproperties/tablecellpropertiesui~TableCellPropertiesUI} or\n * {@link module:table/tableproperties/tablepropertiesui~TablePropertiesUI}.\n *\n * The color palette follows the {@link module:table/tableconfig~TableColorConfig table color configuration format}\n * and contains the following color definitions:\n *\n * ```ts\n * const defaultColors = [\n *   {\n *     color: 'hsl(0, 0%, 0%)',\n *     label: 'Black'\n *   },\n *   {\n *     color: 'hsl(0, 0%, 30%)',\n *     label: 'Dim grey'\n *   },\n *   {\n *     color: 'hsl(0, 0%, 60%)',\n *     label: 'Grey'\n *   },\n *   {\n *     color: 'hsl(0, 0%, 90%)',\n *     label: 'Light grey'\n *   },\n *   {\n *     color: 'hsl(0, 0%, 100%)',\n *     label: 'White',\n *     hasBorder: true\n *   },\n *   {\n *     color: 'hsl(0, 75%, 60%)',\n *     label: 'Red'\n *   },\n *   {\n *     color: 'hsl(30, 75%, 60%)',\n *     label: 'Orange'\n *   },\n *   {\n *     color: 'hsl(60, 75%, 60%)',\n *     label: 'Yellow'\n *   },\n *   {\n *     color: 'hsl(90, 75%, 60%)',\n *     label: 'Light green'\n *   },\n *   {\n *     color: 'hsl(120, 75%, 60%)',\n *     label: 'Green'\n *   },\n *   {\n *     color: 'hsl(150, 75%, 60%)',\n *     label: 'Aquamarine'\n *   },\n *   {\n *     color: 'hsl(180, 75%, 60%)',\n *     label: 'Turquoise'\n *   },\n *   {\n *     color: 'hsl(210, 75%, 60%)',\n *     label: 'Light blue'\n *   },\n *   {\n *     color: 'hsl(240, 75%, 60%)',\n *     label: 'Blue'\n *   },\n *   {\n *     color: 'hsl(270, 75%, 60%)',\n *     label: 'Purple'\n *   }\n * ];\n * ```\n */\nconst defaultColors = [{\n  color: 'hsl(0, 0%, 0%)',\n  label: 'Black'\n}, {\n  color: 'hsl(0, 0%, 30%)',\n  label: 'Dim grey'\n}, {\n  color: 'hsl(0, 0%, 60%)',\n  label: 'Grey'\n}, {\n  color: 'hsl(0, 0%, 90%)',\n  label: 'Light grey'\n}, {\n  color: 'hsl(0, 0%, 100%)',\n  label: 'White',\n  hasBorder: true\n}, {\n  color: 'hsl(0, 75%, 60%)',\n  label: 'Red'\n}, {\n  color: 'hsl(30, 75%, 60%)',\n  label: 'Orange'\n}, {\n  color: 'hsl(60, 75%, 60%)',\n  label: 'Yellow'\n}, {\n  color: 'hsl(90, 75%, 60%)',\n  label: 'Light green'\n}, {\n  color: 'hsl(120, 75%, 60%)',\n  label: 'Green'\n}, {\n  color: 'hsl(150, 75%, 60%)',\n  label: 'Aquamarine'\n}, {\n  color: 'hsl(180, 75%, 60%)',\n  label: 'Turquoise'\n}, {\n  color: 'hsl(210, 75%, 60%)',\n  label: 'Light blue'\n}, {\n  color: 'hsl(240, 75%, 60%)',\n  label: 'Blue'\n}, {\n  color: 'hsl(270, 75%, 60%)',\n  label: 'Purple'\n}];\n/**\n * Returns a creator for a color input with a label.\n *\n * For given options, it returns a function that creates an instance of a\n * {@link module:table/ui/colorinputview~ColorInputView color input} logically related to\n * a {@link module:ui/labeledfield/labeledfieldview~LabeledFieldView labeled view} in the DOM.\n *\n * The helper does the following:\n *\n * * It sets the color input `id` and `ariaDescribedById` attributes.\n * * It binds the color input `isReadOnly` to the labeled view.\n * * It binds the color input `hasError` to the labeled view.\n * * It enables a logic that cleans up the error when the user starts typing in the color input.\n *\n * Usage:\n *\n * ```ts\n * const colorInputCreator = getLabeledColorInputCreator( {\n *   colorConfig: [ ... ],\n *   columns: 3,\n * } );\n *\n * const labeledInputView = new LabeledFieldView( locale, colorInputCreator );\n * console.log( labeledInputView.view ); // A color input instance.\n * ```\n *\n * @internal\n * @param options Color input options.\n * @param options.colorConfig The configuration of the color palette displayed in the input's dropdown.\n * @param options.columns The configuration of the number of columns the color palette consists of in the input's dropdown.\n * @param options.defaultColorValue If specified, the color input view will replace the \"Remove color\" button with\n * the \"Restore default\" button. Instead of clearing the input field, the default color value will be set.\n * @param options.colorPickerConfig The configuration of the color picker. You could disable it or define your output format.\n */\nfunction getLabeledColorInputCreator(options) {\n  return (labeledFieldView, viewUid, statusUid) => {\n    const colorInputView = new ColorInputView(labeledFieldView.locale, {\n      colorDefinitions: colorConfigToColorGridDefinitions(options.colorConfig),\n      columns: options.columns,\n      defaultColorValue: options.defaultColorValue,\n      colorPickerConfig: options.colorPickerConfig\n    });\n    colorInputView.inputView.set({\n      id: viewUid,\n      ariaDescribedById: statusUid\n    });\n    colorInputView.bind('isReadOnly').to(labeledFieldView, 'isEnabled', value => !value);\n    colorInputView.bind('hasError').to(labeledFieldView, 'errorText', value => !!value);\n    colorInputView.on('input', () => {\n      // UX: Make the error text disappear and disable the error indicator as the user\n      // starts fixing the errors.\n      labeledFieldView.errorText = null;\n    });\n    labeledFieldView.bind('isEmpty', 'isFocused').to(colorInputView);\n    return colorInputView;\n  };\n}\n/**\n * A simple helper method to detect number strings.\n * I allows full number notation, so omitting 0 is not allowed:\n */\nfunction isNumberString(value) {\n  const parsedValue = parseFloat(value);\n  return !Number.isNaN(parsedValue) && value === String(parsedValue);\n}\nfunction colorConfigToColorGridDefinitions(colorConfig) {\n  return colorConfig.map(item => ({\n    color: item.model,\n    label: item.label,\n    options: {\n      hasBorder: item.hasBorder\n    }\n  }));\n}\n\n/**\n * The class representing a table cell properties form, allowing users to customize\n * certain style aspects of a table cell, for instance, border, padding, text alignment, etc..\n */\nclass TableCellPropertiesView extends View {\n  /**\n  * Options passed to the view. See {@link #constructor} to learn more.\n  */\n  options;\n  /**\n  * Tracks information about the DOM focus in the form.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * A collection of child views in the form.\n  */\n  children;\n  /**\n  * A dropdown that allows selecting the style of the table cell border.\n  */\n  borderStyleDropdown;\n  /**\n  * An input that allows specifying the width of the table cell border.\n  */\n  borderWidthInput;\n  /**\n  * An input that allows specifying the color of the table cell border.\n  */\n  borderColorInput;\n  /**\n  * An input that allows specifying the table cell background color.\n  */\n  backgroundInput;\n  /**\n  * An input that allows specifying the table cell padding.\n  */\n  paddingInput;\n  /**\n  * An input that allows specifying the table cell width.\n  */\n  widthInput;\n  /**\n  * An input that allows specifying the table cell height.\n  */\n  heightInput;\n  /**\n  * A toolbar with buttons that allow changing the horizontal text alignment in a table cell.\n  */\n  horizontalAlignmentToolbar;\n  /**\n  * A toolbar with buttons that allow changing the vertical text alignment in a table cell.\n  */\n  verticalAlignmentToolbar;\n  /**\n  * The \"Save\" button view.\n  */\n  saveButtonView;\n  /**\n  * The \"Cancel\" button view.\n  */\n  cancelButtonView;\n  /**\n  * A collection of views that can be focused in the form.\n  */\n  _focusables;\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n  * @param options Additional configuration of the view.\n  * @param options.borderColors A configuration of the border color palette used by the\n  * {@link module:table/tablecellproperties/ui/tablecellpropertiesview~TableCellPropertiesView#borderColorInput}.\n  * @param options.backgroundColors A configuration of the background color palette used by the\n  * {@link module:table/tablecellproperties/ui/tablecellpropertiesview~TableCellPropertiesView#backgroundInput}.\n  * @param options.defaultTableCellProperties The default table cell properties.\n  */\n  constructor(locale, options) {\n    super(locale);\n    this.set({\n      borderStyle: '',\n      borderWidth: '',\n      borderColor: '',\n      padding: '',\n      backgroundColor: '',\n      width: '',\n      height: '',\n      horizontalAlignment: '',\n      verticalAlignment: ''\n    });\n    this.options = options;\n    const {\n      borderStyleDropdown,\n      borderWidthInput,\n      borderColorInput,\n      borderRowLabel\n    } = this._createBorderFields();\n    const {\n      backgroundRowLabel,\n      backgroundInput\n    } = this._createBackgroundFields();\n    const {\n      widthInput,\n      operatorLabel,\n      heightInput,\n      dimensionsLabel\n    } = this._createDimensionFields();\n    const {\n      horizontalAlignmentToolbar,\n      verticalAlignmentToolbar,\n      alignmentLabel\n    } = this._createAlignmentFields();\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this.children = this.createCollection();\n    this.borderStyleDropdown = borderStyleDropdown;\n    this.borderWidthInput = borderWidthInput;\n    this.borderColorInput = borderColorInput;\n    this.backgroundInput = backgroundInput;\n    this.paddingInput = this._createPaddingField();\n    this.widthInput = widthInput;\n    this.heightInput = heightInput;\n    this.horizontalAlignmentToolbar = horizontalAlignmentToolbar;\n    this.verticalAlignmentToolbar = verticalAlignmentToolbar;\n    // Defer creating to make sure other fields are present and the Save button can\n    // bind its #isEnabled to their error messages so there's no way to save unless all\n    // fields are valid.\n    const {\n      saveButtonView,\n      cancelButtonView\n    } = this._createActionButtons();\n    this.saveButtonView = saveButtonView;\n    this.cancelButtonView = cancelButtonView;\n    this._focusables = new ViewCollection();\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    // Form header.\n    this.children.add(new FormHeaderView(locale, {\n      label: this.t('Cell properties')\n    }));\n    // Border row.\n    this.children.add(new FormRowView(locale, {\n      labelView: borderRowLabel,\n      children: [borderRowLabel, borderStyleDropdown, borderColorInput, borderWidthInput],\n      class: 'ck-table-form__border-row'\n    }));\n    // Background.\n    this.children.add(new FormRowView(locale, {\n      labelView: backgroundRowLabel,\n      children: [backgroundRowLabel, backgroundInput],\n      class: 'ck-table-form__background-row'\n    }));\n    // Dimensions row and padding.\n    this.children.add(new FormRowView(locale, {\n      children: [\n      // Dimensions row.\n      new FormRowView(locale, {\n        labelView: dimensionsLabel,\n        children: [dimensionsLabel, widthInput, operatorLabel, heightInput],\n        class: 'ck-table-form__dimensions-row'\n      }),\n      // Padding row.\n      new FormRowView(locale, {\n        children: [this.paddingInput],\n        class: 'ck-table-cell-properties-form__padding-row'\n      })]\n    }));\n    // Text alignment row.\n    this.children.add(new FormRowView(locale, {\n      labelView: alignmentLabel,\n      children: [alignmentLabel, horizontalAlignmentToolbar, verticalAlignmentToolbar],\n      class: 'ck-table-cell-properties-form__alignment-row'\n    }));\n    // Action row.\n    this.children.add(new FormRowView(locale, {\n      children: [this.saveButtonView, this.cancelButtonView],\n      class: 'ck-table-form__action-row'\n    }));\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-form', 'ck-table-form', 'ck-table-cell-properties-form'],\n        // https://github.com/ckeditor/ckeditor5-link/issues/90\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    // Enable the \"submit\" event for this view. It can be triggered by the #saveButtonView\n    // which is of the \"submit\" DOM \"type\".\n    submitHandler({\n      view: this\n    });\n    // Maintain continuous focus cycling over views that have focusable children and focus cyclers themselves.\n    [this.borderColorInput, this.backgroundInput].forEach(view => {\n      this._focusCycler.chain(view.fieldView.focusCycler);\n    });\n    [this.borderStyleDropdown, this.borderColorInput, this.borderWidthInput, this.backgroundInput, this.widthInput, this.heightInput, this.paddingInput, this.horizontalAlignmentToolbar, this.verticalAlignmentToolbar, this.saveButtonView, this.cancelButtonView].forEach(view => {\n      // Register the view as focusable.\n      this._focusables.add(view);\n      // Register the view in the focus tracker.\n      this.focusTracker.add(view.element);\n    });\n    // Mainly for closing using \"Esc\" and navigation using \"Tab\".\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the fist focusable field in the form.\n  */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n  /**\n  * Creates the following form fields:\n  *\n  * * {@link #borderStyleDropdown},\n  * * {@link #borderWidthInput},\n  * * {@link #borderColorInput}.\n  */\n  _createBorderFields() {\n    const defaultTableCellProperties = this.options.defaultTableCellProperties;\n    const defaultBorder = {\n      style: defaultTableCellProperties.borderStyle,\n      width: defaultTableCellProperties.borderWidth,\n      color: defaultTableCellProperties.borderColor\n    };\n    const colorInputCreator = getLabeledColorInputCreator({\n      colorConfig: this.options.borderColors,\n      columns: 5,\n      defaultColorValue: defaultBorder.color,\n      colorPickerConfig: this.options.colorPickerConfig\n    });\n    const locale = this.locale;\n    const t = this.t;\n    const accessibleLabel = t('Style');\n    // -- Group label ---------------------------------------------\n    const borderRowLabel = new LabelView(locale);\n    borderRowLabel.text = t('Border');\n    // -- Style ---------------------------------------------------\n    const styleLabels = getBorderStyleLabels(t);\n    const borderStyleDropdown = new LabeledFieldView(locale, createLabeledDropdown);\n    borderStyleDropdown.set({\n      label: accessibleLabel,\n      class: 'ck-table-form__border-style'\n    });\n    borderStyleDropdown.fieldView.buttonView.set({\n      ariaLabel: accessibleLabel,\n      ariaLabelledBy: undefined,\n      isOn: false,\n      withText: true,\n      tooltip: accessibleLabel\n    });\n    borderStyleDropdown.fieldView.buttonView.bind('label').to(this, 'borderStyle', value => {\n      return styleLabels[value ? value : 'none'];\n    });\n    borderStyleDropdown.fieldView.on('execute', evt => {\n      this.borderStyle = evt.source._borderStyleValue;\n    });\n    borderStyleDropdown.bind('isEmpty').to(this, 'borderStyle', value => !value);\n    addListToDropdown(borderStyleDropdown.fieldView, getBorderStyleDefinitions(this, defaultBorder.style), {\n      role: 'menu',\n      ariaLabel: accessibleLabel\n    });\n    // -- Width ---------------------------------------------------\n    const borderWidthInput = new LabeledFieldView(locale, createLabeledInputText);\n    borderWidthInput.set({\n      label: t('Width'),\n      class: 'ck-table-form__border-width'\n    });\n    borderWidthInput.fieldView.bind('value').to(this, 'borderWidth');\n    borderWidthInput.bind('isEnabled').to(this, 'borderStyle', isBorderStyleSet$1);\n    borderWidthInput.fieldView.on('input', () => {\n      this.borderWidth = borderWidthInput.fieldView.element.value;\n    });\n    // -- Color ---------------------------------------------------\n    const borderColorInput = new LabeledFieldView(locale, colorInputCreator);\n    borderColorInput.set({\n      label: t('Color'),\n      class: 'ck-table-form__border-color'\n    });\n    borderColorInput.fieldView.bind('value').to(this, 'borderColor');\n    borderColorInput.bind('isEnabled').to(this, 'borderStyle', isBorderStyleSet$1);\n    borderColorInput.fieldView.on('input', () => {\n      this.borderColor = borderColorInput.fieldView.value;\n    });\n    // Reset the border color and width fields depending on the `border-style` value.\n    this.on('change:borderStyle', (evt, name, newValue, oldValue) => {\n      // When removing the border (`border-style:none`), clear the remaining `border-*` properties.\n      // See: https://github.com/ckeditor/ckeditor5/issues/6227.\n      if (!isBorderStyleSet$1(newValue)) {\n        this.borderColor = '';\n        this.borderWidth = '';\n      }\n      // When setting the `border-style` from `none`, set the default `border-color` and `border-width` properties.\n      if (!isBorderStyleSet$1(oldValue)) {\n        this.borderColor = defaultBorder.color;\n        this.borderWidth = defaultBorder.width;\n      }\n    });\n    return {\n      borderRowLabel,\n      borderStyleDropdown,\n      borderColorInput,\n      borderWidthInput\n    };\n  }\n  /**\n  * Creates the following form fields:\n  *\n  * * {@link #backgroundInput}.\n  */\n  _createBackgroundFields() {\n    const locale = this.locale;\n    const t = this.t;\n    // -- Group label ---------------------------------------------\n    const backgroundRowLabel = new LabelView(locale);\n    backgroundRowLabel.text = t('Background');\n    // -- Background color input -----------------------------------\n    const colorInputCreator = getLabeledColorInputCreator({\n      colorConfig: this.options.backgroundColors,\n      columns: 5,\n      defaultColorValue: this.options.defaultTableCellProperties.backgroundColor,\n      colorPickerConfig: this.options.colorPickerConfig\n    });\n    const backgroundInput = new LabeledFieldView(locale, colorInputCreator);\n    backgroundInput.set({\n      label: t('Color'),\n      class: 'ck-table-cell-properties-form__background'\n    });\n    backgroundInput.fieldView.bind('value').to(this, 'backgroundColor');\n    backgroundInput.fieldView.on('input', () => {\n      this.backgroundColor = backgroundInput.fieldView.value;\n    });\n    return {\n      backgroundRowLabel,\n      backgroundInput\n    };\n  }\n  /**\n  * Creates the following form fields:\n  *\n  * * {@link #widthInput}.\n  * * {@link #heightInput}.\n  */\n  _createDimensionFields() {\n    const locale = this.locale;\n    const t = this.t;\n    // -- Label ---------------------------------------------------\n    const dimensionsLabel = new LabelView(locale);\n    dimensionsLabel.text = t('Dimensions');\n    // -- Width ---------------------------------------------------\n    const widthInput = new LabeledFieldView(locale, createLabeledInputText);\n    widthInput.set({\n      label: t('Width'),\n      class: 'ck-table-form__dimensions-row__width'\n    });\n    widthInput.fieldView.bind('value').to(this, 'width');\n    widthInput.fieldView.on('input', () => {\n      this.width = widthInput.fieldView.element.value;\n    });\n    // -- Operator ---------------------------------------------------\n    const operatorLabel = new View(locale);\n    operatorLabel.setTemplate({\n      tag: 'span',\n      attributes: {\n        class: ['ck-table-form__dimension-operator']\n      },\n      children: [{\n        text: 'Ã—'\n      }]\n    });\n    // -- Height ---------------------------------------------------\n    const heightInput = new LabeledFieldView(locale, createLabeledInputText);\n    heightInput.set({\n      label: t('Height'),\n      class: 'ck-table-form__dimensions-row__height'\n    });\n    heightInput.fieldView.bind('value').to(this, 'height');\n    heightInput.fieldView.on('input', () => {\n      this.height = heightInput.fieldView.element.value;\n    });\n    return {\n      dimensionsLabel,\n      widthInput,\n      operatorLabel,\n      heightInput\n    };\n  }\n  /**\n  * Creates the following form fields:\n  *\n  * * {@link #paddingInput}.\n  */\n  _createPaddingField() {\n    const locale = this.locale;\n    const t = this.t;\n    const paddingInput = new LabeledFieldView(locale, createLabeledInputText);\n    paddingInput.set({\n      label: t('Padding'),\n      class: 'ck-table-cell-properties-form__padding'\n    });\n    paddingInput.fieldView.bind('value').to(this, 'padding');\n    paddingInput.fieldView.on('input', () => {\n      this.padding = paddingInput.fieldView.element.value;\n    });\n    return paddingInput;\n  }\n  /**\n  * Creates the following form fields:\n  *\n  * * {@link #horizontalAlignmentToolbar},\n  * * {@link #verticalAlignmentToolbar}.\n  */\n  _createAlignmentFields() {\n    const locale = this.locale;\n    const t = this.t;\n    const alignmentLabel = new LabelView(locale);\n    const ALIGNMENT_ICONS = {\n      left: IconAlignLeft,\n      center: IconAlignCenter,\n      right: IconAlignRight,\n      justify: IconAlignJustify,\n      top: IconAlignTop,\n      middle: IconAlignMiddle,\n      bottom: IconAlignBottom\n    };\n    alignmentLabel.text = t('Table cell text alignment');\n    // -- Horizontal ---------------------------------------------------\n    const horizontalAlignmentToolbar = new ToolbarView(locale);\n    const isContentRTL = locale.contentLanguageDirection === 'rtl';\n    horizontalAlignmentToolbar.set({\n      isCompact: true,\n      role: 'radiogroup',\n      ariaLabel: t('Horizontal text alignment toolbar')\n    });\n    fillToolbar({\n      view: this,\n      icons: ALIGNMENT_ICONS,\n      toolbar: horizontalAlignmentToolbar,\n      labels: this._horizontalAlignmentLabels,\n      propertyName: 'horizontalAlignment',\n      nameToValue: name => {\n        // For the RTL content, we want to swap the buttons \"align to the left\" and \"align to the right\".\n        if (isContentRTL) {\n          if (name === 'left') {\n            return 'right';\n          } else if (name === 'right') {\n            return 'left';\n          }\n        }\n        return name;\n      },\n      defaultValue: this.options.defaultTableCellProperties.horizontalAlignment\n    });\n    // -- Vertical -----------------------------------------------------\n    const verticalAlignmentToolbar = new ToolbarView(locale);\n    verticalAlignmentToolbar.set({\n      isCompact: true,\n      role: 'radiogroup',\n      ariaLabel: t('Vertical text alignment toolbar')\n    });\n    fillToolbar({\n      view: this,\n      icons: ALIGNMENT_ICONS,\n      toolbar: verticalAlignmentToolbar,\n      labels: this._verticalAlignmentLabels,\n      propertyName: 'verticalAlignment',\n      defaultValue: this.options.defaultTableCellProperties.verticalAlignment\n    });\n    return {\n      horizontalAlignmentToolbar,\n      verticalAlignmentToolbar,\n      alignmentLabel\n    };\n  }\n  /**\n  * Creates the following form controls:\n  *\n  * * {@link #saveButtonView},\n  * * {@link #cancelButtonView}.\n  */\n  _createActionButtons() {\n    const locale = this.locale;\n    const t = this.t;\n    const saveButtonView = new ButtonView(locale);\n    const cancelButtonView = new ButtonView(locale);\n    const fieldsThatShouldValidateToSave = [this.borderWidthInput, this.borderColorInput, this.backgroundInput, this.paddingInput];\n    saveButtonView.set({\n      label: t('Save'),\n      icon: IconCheck,\n      class: 'ck-button-save',\n      type: 'submit',\n      withText: true\n    });\n    saveButtonView.bind('isEnabled').toMany(fieldsThatShouldValidateToSave, 'errorText', (...errorTexts) => {\n      return errorTexts.every(errorText => !errorText);\n    });\n    cancelButtonView.set({\n      label: t('Cancel'),\n      icon: IconCancel,\n      class: 'ck-button-cancel',\n      withText: true\n    });\n    cancelButtonView.delegate('execute').to(this, 'cancel');\n    return {\n      saveButtonView,\n      cancelButtonView\n    };\n  }\n  /**\n  * Provides localized labels for {@link #horizontalAlignmentToolbar} buttons.\n  */\n  get _horizontalAlignmentLabels() {\n    const locale = this.locale;\n    const t = this.t;\n    const left = t('Align cell text to the left');\n    const center = t('Align cell text to the center');\n    const right = t('Align cell text to the right');\n    const justify = t('Justify cell text');\n    // Returns object with a proper order of labels.\n    if (locale.uiLanguageDirection === 'rtl') {\n      return {\n        right,\n        center,\n        left,\n        justify\n      };\n    } else {\n      return {\n        left,\n        center,\n        right,\n        justify\n      };\n    }\n  }\n  /**\n  * Provides localized labels for {@link #verticalAlignmentToolbar} buttons.\n  */\n  get _verticalAlignmentLabels() {\n    const t = this.t;\n    return {\n      top: t('Align cell text to the top'),\n      middle: t('Align cell text to the middle'),\n      bottom: t('Align cell text to the bottom')\n    };\n  }\n}\nfunction isBorderStyleSet$1(value) {\n  return value !== 'none';\n}\nconst BALLOON_POSITIONS = /* #__PURE__ */(() => [BalloonPanelView.defaultPositions.northArrowSouth, BalloonPanelView.defaultPositions.northArrowSouthWest, BalloonPanelView.defaultPositions.northArrowSouthEast, BalloonPanelView.defaultPositions.southArrowNorth, BalloonPanelView.defaultPositions.southArrowNorthWest, BalloonPanelView.defaultPositions.southArrowNorthEast, BalloonPanelView.defaultPositions.viewportStickyNorth])();\n/**\n * A helper utility that positions the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon} instance\n * with respect to the table in the editor content, if one is selected.\n *\n * @param editor The editor instance.\n * @param target Either \"cell\" or \"table\". Determines the target the balloon will be attached to.\n */\nfunction repositionContextualBalloon(editor, target) {\n  const balloon = editor.plugins.get('ContextualBalloon');\n  const selection = editor.editing.view.document.selection;\n  let position;\n  if (target === 'cell') {\n    if (getTableWidgetAncestor(selection)) {\n      position = getBalloonCellPositionData(editor);\n    }\n  } else if (getSelectionAffectedTableWidget(selection)) {\n    position = getBalloonTablePositionData(editor);\n  }\n  if (position) {\n    balloon.updatePosition(position);\n  }\n}\n/**\n * Returns the positioning options that control the geometry of the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon} with respect\n * to the selected table in the editor content.\n *\n * @param editor The editor instance.\n */\nfunction getBalloonTablePositionData(editor) {\n  const selection = editor.model.document.selection;\n  const modelTable = getSelectionAffectedTable(selection);\n  const viewTable = editor.editing.mapper.toViewElement(modelTable);\n  return {\n    target: editor.editing.view.domConverter.mapViewToDom(viewTable),\n    positions: BALLOON_POSITIONS\n  };\n}\n/**\n * Returns the positioning options that control the geometry of the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon} with respect\n * to the selected table cell in the editor content.\n *\n * @param editor The editor instance.\n */\nfunction getBalloonCellPositionData(editor) {\n  const mapper = editor.editing.mapper;\n  const domConverter = editor.editing.view.domConverter;\n  const selection = editor.model.document.selection;\n  if (selection.rangeCount > 1) {\n    return {\n      target: () => createBoundingRect(selection.getRanges(), editor),\n      positions: BALLOON_POSITIONS\n    };\n  }\n  const modelTableCell = getTableCellAtPosition(selection.getFirstPosition());\n  const viewTableCell = mapper.toViewElement(modelTableCell);\n  return {\n    target: domConverter.mapViewToDom(viewTableCell),\n    positions: BALLOON_POSITIONS\n  };\n}\n/**\n * Returns the first selected table cell from a multi-cell or in-cell selection.\n *\n * @param position Document position.\n */\nfunction getTableCellAtPosition(position) {\n  const isTableCellSelected = position.nodeAfter && position.nodeAfter.is('element', 'tableCell');\n  return isTableCellSelected ? position.nodeAfter : position.findAncestor('tableCell');\n}\n/**\n * Returns bounding rectangle for given model ranges.\n *\n * @param ranges Model ranges that the bounding rect should be returned for.\n * @param editor The editor instance.\n */\nfunction createBoundingRect(ranges, editor) {\n  const mapper = editor.editing.mapper;\n  const domConverter = editor.editing.view.domConverter;\n  const rects = Array.from(ranges).map(range => {\n    const modelTableCell = getTableCellAtPosition(range.start);\n    const viewTableCell = mapper.toViewElement(modelTableCell);\n    return new Rect(domConverter.mapViewToDom(viewTableCell));\n  });\n  return Rect.getBoundingRect(rects);\n}\n\n/**\n * Returns a string if all four values of box sides are equal.\n *\n * If a string is passed, it is treated as a single value (pass-through).\n *\n * ```ts\n * // Returns 'foo':\n * getSingleValue( { top: 'foo', right: 'foo', bottom: 'foo', left: 'foo' } );\n * getSingleValue( 'foo' );\n *\n * // Returns undefined:\n * getSingleValue( { top: 'foo', right: 'foo', bottom: 'bar', left: 'foo' } );\n * getSingleValue( { top: 'foo', right: 'foo' } );\n * ```\n */\nfunction getSingleValue(objectOrString) {\n  if (!objectOrString || !isObject(objectOrString)) {\n    return objectOrString;\n  }\n  const {\n    top,\n    right,\n    bottom,\n    left\n  } = objectOrString;\n  if (top == right && right == bottom && bottom == left) {\n    return top;\n  }\n}\n/**\n * Adds a unit to a value if the value is a number or a string representing a number.\n *\n * **Note**: It does nothing to non-numeric values.\n *\n * ```ts\n * getSingleValue( 25, 'px' ); // '25px'\n * getSingleValue( 25, 'em' ); // '25em'\n * getSingleValue( '25em', 'px' ); // '25em'\n * getSingleValue( 'foo', 'px' ); // 'foo'\n * ```\n *\n * @param defaultUnit A default unit added to a numeric value.\n */\nfunction addDefaultUnitToNumericValue(value, defaultUnit) {\n  const numericValue = parseFloat(value);\n  if (Number.isNaN(numericValue)) {\n    return value;\n  }\n  if (String(numericValue) !== String(value)) {\n    return value;\n  }\n  return `${numericValue}${defaultUnit}`;\n}\n/**\n * Returns the normalized configuration.\n *\n * @param config The configuration to normalize.\n * @param options Options used to determine which properties should be added.\n */\nfunction getNormalizedDefaultProperties(config, options = {}) {\n  const normalizedConfig = {\n    borderStyle: 'none',\n    borderWidth: '',\n    borderColor: '',\n    backgroundColor: '',\n    width: '',\n    height: '',\n    ...config\n  };\n  if (options.includeAlignmentProperty && !normalizedConfig.alignment) {\n    normalizedConfig.alignment = 'center';\n  }\n  if (options.includePaddingProperty && !normalizedConfig.padding) {\n    normalizedConfig.padding = '';\n  }\n  if (options.includeVerticalAlignmentProperty && !normalizedConfig.verticalAlignment) {\n    normalizedConfig.verticalAlignment = 'middle';\n  }\n  if (options.includeHorizontalAlignmentProperty && !normalizedConfig.horizontalAlignment) {\n    normalizedConfig.horizontalAlignment = options.isRightToLeftContent ? 'right' : 'left';\n  }\n  return normalizedConfig;\n}\n/**\n * Returns the normalized default table properties.\n *\n * @param config The configuration to normalize.\n * @param options Options used to determine which properties should be added.\n */\nfunction getNormalizedDefaultTableProperties(config, options) {\n  return getNormalizedDefaultProperties({\n    // It adds support for border none in the table element, keep it in sync with the content styles\n    // See more: https://github.com/ckeditor/ckeditor5/issues/6841#issuecomment-1959195608\n    borderStyle: 'double',\n    borderColor: 'hsl(0, 0%, 70%)',\n    borderWidth: '1px',\n    ...config\n  }, options);\n}\n/**\n * Returns the normalized default cell properties.\n *\n * @param config The configuration to normalize.\n * @param options Options used to determine which properties should be added.\n */\nfunction getNormalizedDefaultCellProperties(config, options) {\n  return getNormalizedDefaultProperties({\n    // It adds support for border none in the table element, keep it in sync with the content styles\n    // See more: https://github.com/ckeditor/ckeditor5/issues/6841#issuecomment-1959195608\n    borderStyle: 'solid',\n    borderColor: 'hsl(0, 0%, 75%)',\n    borderWidth: '1px',\n    ...config\n  }, options);\n}\nconst ERROR_TEXT_TIMEOUT$1 = 500;\n// Map of view properties and related commands.\nconst propertyToCommandMap$1 = {\n  borderStyle: 'tableCellBorderStyle',\n  borderColor: 'tableCellBorderColor',\n  borderWidth: 'tableCellBorderWidth',\n  height: 'tableCellHeight',\n  width: 'tableCellWidth',\n  padding: 'tableCellPadding',\n  backgroundColor: 'tableCellBackgroundColor',\n  horizontalAlignment: 'tableCellHorizontalAlignment',\n  verticalAlignment: 'tableCellVerticalAlignment'\n};\n/**\n * The table cell properties UI plugin. It introduces the `'tableCellProperties'` button\n * that opens a form allowing to specify the visual styling of a table cell.\n *\n * It uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon plugin}.\n */\nclass TableCellPropertiesUI extends Plugin {\n  /**\n  * The default table cell properties.\n  */\n  _defaultContentTableCellProperties;\n  /**\n  * The default layout table cell properties.\n  */\n  _defaultLayoutTableCellProperties;\n  /**\n  * The contextual balloon plugin instance.\n  */\n  _balloon;\n  /**\n  * The cell properties form view displayed inside the balloon.\n  */\n  view;\n  /**\n  * The cell properties form view displayed inside the balloon (content table).\n  */\n  _viewWithContentTableDefaults;\n  /**\n  * The cell properties form view displayed inside the balloon (layout table).\n  */\n  _viewWithLayoutTableDefaults;\n  /**\n  * The batch used to undo all changes made by the form (which are live, as the user types)\n  * when \"Cancel\" was pressed. Each time the view is shown, a new batch is created.\n  */\n  _undoStepBatch;\n  /**\n  * Flag used to indicate whether view is ready to execute update commands\n  * (it finished loading initial data).\n  */\n  _isReady;\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ContextualBalloon];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableCellPropertiesUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('table.tableCellProperties', {\n      borderColors: defaultColors,\n      backgroundColors: defaultColors\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = editor.t;\n    this._defaultContentTableCellProperties = getNormalizedDefaultCellProperties(editor.config.get('table.tableCellProperties.defaultProperties'), {\n      includeVerticalAlignmentProperty: true,\n      includeHorizontalAlignmentProperty: true,\n      includePaddingProperty: true,\n      isRightToLeftContent: editor.locale.contentLanguageDirection === 'rtl'\n    });\n    this._defaultLayoutTableCellProperties = getNormalizedDefaultProperties(undefined, {\n      includeVerticalAlignmentProperty: true,\n      includeHorizontalAlignmentProperty: true,\n      isRightToLeftContent: editor.locale.contentLanguageDirection === 'rtl'\n    });\n    this._balloon = editor.plugins.get(ContextualBalloon);\n    this.view = null;\n    this._isReady = false;\n    editor.ui.componentFactory.add('tableCellProperties', locale => {\n      const view = new ButtonView(locale);\n      view.set({\n        label: t('Cell properties'),\n        icon: IconTableCellProperties,\n        tooltip: true\n      });\n      this.listenTo(view, 'execute', () => this._showView());\n      const commands = Object.values(propertyToCommandMap$1).map(commandName => editor.commands.get(commandName));\n      view.bind('isEnabled').toMany(commands, 'isEnabled', (...areEnabled) => areEnabled.some(isCommandEnabled => isCommandEnabled));\n      return view;\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    // Destroy created UI components as they are not automatically destroyed.\n    // See https://github.com/ckeditor/ckeditor5/issues/1341.\n    if (this.view) {\n      this.view.destroy();\n    }\n  }\n  /**\n  * Creates the {@link module:table/tablecellproperties/ui/tablecellpropertiesview~TableCellPropertiesView} instance.\n  *\n  * @returns The cell properties form view instance.\n  */\n  _createPropertiesView(defaultTableCellProperties) {\n    const editor = this.editor;\n    const config = editor.config.get('table.tableCellProperties');\n    const borderColorsConfig = normalizeColorOptions(config.borderColors);\n    const localizedBorderColors = getLocalizedColorOptions(editor.locale, borderColorsConfig);\n    const backgroundColorsConfig = normalizeColorOptions(config.backgroundColors);\n    const localizedBackgroundColors = getLocalizedColorOptions(editor.locale, backgroundColorsConfig);\n    const hasColorPicker = config.colorPicker !== false;\n    const view = new TableCellPropertiesView(editor.locale, {\n      borderColors: localizedBorderColors,\n      backgroundColors: localizedBackgroundColors,\n      defaultTableCellProperties,\n      colorPickerConfig: hasColorPicker ? config.colorPicker || {} : false\n    });\n    const t = editor.t;\n    // Render the view so its #element is available for the clickOutsideHandler.\n    view.render();\n    this.listenTo(view, 'submit', () => {\n      this._hideView();\n    });\n    this.listenTo(view, 'cancel', () => {\n      // https://github.com/ckeditor/ckeditor5/issues/6180\n      if (this._undoStepBatch.operations.length) {\n        editor.execute('undo', this._undoStepBatch);\n      }\n      this._hideView();\n    });\n    // Close the balloon on Esc key press.\n    view.keystrokes.set('Esc', (data, cancel) => {\n      this._hideView();\n      cancel();\n    });\n    // Close on click outside of balloon panel element.\n    clickOutsideHandler({\n      emitter: view,\n      activator: () => this._isViewInBalloon,\n      contextElements: [this._balloon.view.element],\n      callback: () => this._hideView()\n    });\n    const colorErrorText = getLocalizedColorErrorText(t);\n    const lengthErrorText = getLocalizedLengthErrorText(t);\n    // Create the \"UI -> editor data\" binding.\n    // These listeners update the editor data (via table commands) when any observable\n    // property of the view has changed. They also validate the value and display errors in the UI\n    // when necessary. This makes the view live, which means the changes are\n    // visible in the editing as soon as the user types or changes fields' values.\n    view.on('change:borderStyle', this._getPropertyChangeCallback('tableCellBorderStyle'));\n    view.on('change:borderColor', this._getValidatedPropertyChangeCallback({\n      viewField: view.borderColorInput,\n      commandName: 'tableCellBorderColor',\n      errorText: colorErrorText,\n      validator: colorFieldValidator\n    }));\n    view.on('change:borderWidth', this._getValidatedPropertyChangeCallback({\n      viewField: view.borderWidthInput,\n      commandName: 'tableCellBorderWidth',\n      errorText: lengthErrorText,\n      validator: lineWidthFieldValidator\n    }));\n    view.on('change:padding', this._getValidatedPropertyChangeCallback({\n      viewField: view.paddingInput,\n      commandName: 'tableCellPadding',\n      errorText: lengthErrorText,\n      validator: lengthFieldValidator\n    }));\n    view.on('change:width', this._getValidatedPropertyChangeCallback({\n      viewField: view.widthInput,\n      commandName: 'tableCellWidth',\n      errorText: lengthErrorText,\n      validator: lengthFieldValidator\n    }));\n    view.on('change:height', this._getValidatedPropertyChangeCallback({\n      viewField: view.heightInput,\n      commandName: 'tableCellHeight',\n      errorText: lengthErrorText,\n      validator: lengthFieldValidator\n    }));\n    view.on('change:backgroundColor', this._getValidatedPropertyChangeCallback({\n      viewField: view.backgroundInput,\n      commandName: 'tableCellBackgroundColor',\n      errorText: colorErrorText,\n      validator: colorFieldValidator\n    }));\n    view.on('change:horizontalAlignment', this._getPropertyChangeCallback('tableCellHorizontalAlignment'));\n    view.on('change:verticalAlignment', this._getPropertyChangeCallback('tableCellVerticalAlignment'));\n    return view;\n  }\n  /**\n  * In this method the \"editor data -> UI\" binding is happening.\n  *\n  * When executed, this method obtains selected cell property values from various table commands\n  * and passes them to the {@link #view}.\n  *\n  * This way, the UI stays upâ€“toâ€“date with the editor data.\n  */\n  _fillViewFormFromCommandValues() {\n    const commands = this.editor.commands;\n    const borderStyleCommand = commands.get('tableCellBorderStyle');\n    Object.entries(propertyToCommandMap$1).map(([property, commandName]) => {\n      const propertyKey = property;\n      const defaultValue = this.view === this._viewWithContentTableDefaults ? this._defaultContentTableCellProperties[propertyKey] || '' : this._defaultLayoutTableCellProperties[propertyKey] || '';\n      return [property, commands.get(commandName).value || defaultValue];\n    }).forEach(([property, value]) => {\n      // Do not set the `border-color` and `border-width` fields if `border-style:none`.\n      if ((property === 'borderColor' || property === 'borderWidth') && borderStyleCommand.value === 'none') {\n        return;\n      }\n      this.view.set(property, value);\n    });\n    this._isReady = true;\n  }\n  /**\n  * Shows the {@link #view} in the {@link #_balloon}.\n  *\n  * **Note**: Each time a view is shown, a new {@link #_undoStepBatch} is created. It contains\n  * all changes made to the document when the view is visible, allowing a single undo step\n  * for all of them.\n  */\n  _showView() {\n    const editor = this.editor;\n    const viewTable = getSelectionAffectedTableWidget(editor.editing.view.document.selection);\n    const modelTable = viewTable && editor.editing.mapper.toModelElement(viewTable);\n    const useDefaults = !modelTable || modelTable.getAttribute('tableType') !== 'layout';\n    if (useDefaults && !this._viewWithContentTableDefaults) {\n      this._viewWithContentTableDefaults = this._createPropertiesView(this._defaultContentTableCellProperties);\n    } else if (!useDefaults && !this._viewWithLayoutTableDefaults) {\n      this._viewWithLayoutTableDefaults = this._createPropertiesView(this._defaultLayoutTableCellProperties);\n    }\n    this.view = useDefaults ? this._viewWithContentTableDefaults : this._viewWithLayoutTableDefaults;\n    this.listenTo(editor.ui, 'update', () => {\n      this._updateView();\n    });\n    // Update the view with the model values.\n    this._fillViewFormFromCommandValues();\n    this._balloon.add({\n      view: this.view,\n      position: getBalloonCellPositionData(editor)\n    });\n    // Create a new batch. Clicking \"Cancel\" will undo this batch.\n    this._undoStepBatch = editor.model.createBatch();\n    // Basic a11y.\n    this.view.focus();\n  }\n  /**\n  * Removes the {@link #view} from the {@link #_balloon}.\n  */\n  _hideView() {\n    const editor = this.editor;\n    this.stopListening(editor.ui, 'update');\n    this._isReady = false;\n    // Blur any input element before removing it from DOM to prevent issues in some browsers.\n    // See https://github.com/ckeditor/ckeditor5/issues/1501.\n    this.view.saveButtonView.focus();\n    this._balloon.remove(this.view);\n    // Make sure the focus is not lost in the process by putting it directly\n    // into the editing view.\n    this.editor.editing.view.focus();\n  }\n  /**\n  * Repositions the {@link #_balloon} or hides the {@link #view} if a table cell is no longer selected.\n  */\n  _updateView() {\n    const editor = this.editor;\n    const viewDocument = editor.editing.view.document;\n    if (!getTableWidgetAncestor(viewDocument.selection)) {\n      this._hideView();\n    } else if (this._isViewVisible) {\n      repositionContextualBalloon(editor, 'cell');\n    }\n  }\n  /**\n  * Returns `true` when the {@link #view} is visible in the {@link #_balloon}.\n  */\n  get _isViewVisible() {\n    return !!this.view && this._balloon.visibleView === this.view;\n  }\n  /**\n  * Returns `true` when the {@link #view} is in the {@link #_balloon}.\n  */\n  get _isViewInBalloon() {\n    return !!this.view && this._balloon.hasView(this.view);\n  }\n  /**\n  * Creates a callback that when executed upon the {@link #view view's} property change\n  * executes a related editor command with the new property value.\n  *\n  * @param defaultValue The default value of the command.\n  */\n  _getPropertyChangeCallback(commandName) {\n    return (evt, propertyName, newValue) => {\n      if (!this._isReady) {\n        return;\n      }\n      this.editor.execute(commandName, {\n        value: newValue,\n        batch: this._undoStepBatch\n      });\n    };\n  }\n  /**\n  * Creates a callback that when executed upon the {@link #view view's} property change:\n  * * Executes a related editor command with the new property value if the value is valid,\n  * * Or sets the error text next to the invalid field, if the value did not pass the validation.\n  */\n  _getValidatedPropertyChangeCallback(options) {\n    const {\n      commandName,\n      viewField,\n      validator,\n      errorText\n    } = options;\n    const setErrorTextDebounced = debounce(() => {\n      viewField.errorText = errorText;\n    }, ERROR_TEXT_TIMEOUT$1);\n    return (evt, propertyName, newValue) => {\n      setErrorTextDebounced.cancel();\n      // Do not execute the command on initial call (opening the table properties view).\n      if (!this._isReady) {\n        return;\n      }\n      if (validator(newValue)) {\n        this.editor.execute(commandName, {\n          value: newValue,\n          batch: this._undoStepBatch\n        });\n        viewField.errorText = null;\n      } else {\n        setErrorTextDebounced();\n      }\n    };\n  }\n}\n\n/**\n * The table cell attribute command.\n *\n * The command is a base command for other table cell property commands.\n */\nclass TableCellPropertyCommand extends Command {\n  /**\n  * The attribute that will be set by the command.\n  */\n  attributeName;\n  /**\n  * The default value for the attribute.\n  *\n  * @readonly\n  */\n  _defaultValue;\n  /**\n  * The default value for the attribute for the content table.\n  */\n  _defaultContentTableValue;\n  /**\n  * The default value for the attribute for the layout table.\n  */\n  _defaultLayoutTableValue;\n  /**\n  * Creates a new `TableCellPropertyCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param attributeName Table cell attribute name.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, attributeName, defaultValue) {\n    super(editor);\n    this.attributeName = attributeName;\n    this._defaultContentTableValue = defaultValue;\n    // Hardcoded defaults for layout table.\n    switch (attributeName) {\n      case 'tableCellBorderStyle':\n        this._defaultLayoutTableValue = 'none';\n        break;\n      case 'tableCellHorizontalAlignment':\n        this._defaultLayoutTableValue = 'left';\n        break;\n      case 'tableCellVerticalAlignment':\n        this._defaultLayoutTableValue = 'middle';\n        break;\n      default:\n        this._defaultLayoutTableValue = undefined;\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const selectedTableCells = tableUtils.getSelectionAffectedTableCells(selection);\n    const table = getSelectionAffectedTable(selection);\n    this._defaultValue = !table || table.getAttribute('tableType') !== 'layout' ? this._defaultContentTableValue : this._defaultLayoutTableValue;\n    this.isEnabled = !!selectedTableCells.length;\n    this.value = this._getSingleValue(selectedTableCells);\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options.value If set, the command will set the attribute on selected table cells.\n  * If it is not set, the command will remove the attribute from the selected table cells.\n  * @param options.batch Pass the model batch instance to the command to aggregate changes,\n  * for example to allow a single undo step for multiple executions.\n  */\n  execute(options = {}) {\n    const {\n      value,\n      batch\n    } = options;\n    const model = this.editor.model;\n    const tableUtils = this.editor.plugins.get('TableUtils');\n    const tableCells = tableUtils.getSelectionAffectedTableCells(model.document.selection);\n    const valueToSet = this._getValueToSet(value);\n    model.enqueueChange(batch, writer => {\n      if (valueToSet) {\n        tableCells.forEach(tableCell => writer.setAttribute(this.attributeName, valueToSet, tableCell));\n      } else {\n        tableCells.forEach(tableCell => writer.removeAttribute(this.attributeName, tableCell));\n      }\n    });\n  }\n  /**\n  * Returns the attribute value for a table cell.\n  */\n  _getAttribute(tableCell) {\n    if (!tableCell) {\n      return;\n    }\n    const value = tableCell.getAttribute(this.attributeName);\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n  /**\n  * Returns the proper model value. It can be used to add a default unit to numeric values.\n  */\n  _getValueToSet(value) {\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n  /**\n  * Returns a single value for all selected table cells. If the value is the same for all cells,\n  * it will be returned (`undefined` otherwise).\n  */\n  _getSingleValue(tableCells) {\n    const firstCellValue = this._getAttribute(tableCells[0]);\n    const everyCellHasAttribute = tableCells.every(tableCells => this._getAttribute(tableCells) === firstCellValue);\n    return everyCellHasAttribute ? firstCellValue : undefined;\n  }\n}\n\n/**\n * The table cell width command.\n *\n * The command is registered by the {@link module:table/tablecellwidth/tablecellwidthediting~TableCellWidthEditing} as\n * the `'tableCellWidth'` editor command.\n *\n * To change the width of selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'tableCellWidth', {\n *   value: '50px'\n * } );\n * ```\n *\n * **Note**: This command adds a default `'px'` unit to numeric values. Executing:\n *\n * ```ts\n * editor.execute( 'tableCellWidth', {\n *   value: '50'\n * } );\n * ```\n *\n * will set the `width` attribute to `'50px'` in the model.\n */\nclass TableCellWidthCommand extends TableCellPropertyCommand {\n  /**\n  * Creates a new `TableCellWidthCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableCellWidth', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValueToSet(value) {\n    value = addDefaultUnitToNumericValue(value, 'px');\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n}\n\n/**\n * The table cell width editing feature.\n *\n * Introduces `tableCellWidth` table cell model attribute alongside with its converters\n * and a command.\n */\nclass TableCellWidthEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableCellWidthEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const defaultTableCellProperties = getNormalizedDefaultCellProperties(editor.config.get('table.tableCellProperties.defaultProperties'));\n    enableProperty$1(editor.model.schema, editor.conversion, {\n      modelAttribute: 'tableCellWidth',\n      styleName: 'width',\n      defaultValue: defaultTableCellProperties.width\n    });\n    editor.commands.add('tableCellWidth', new TableCellWidthCommand(editor, defaultTableCellProperties.width));\n  }\n}\n\n/**\n * The table cell padding command.\n *\n * The command is registered by the {@link module:table/tablecellproperties/tablecellpropertiesediting~TableCellPropertiesEditing} as\n * the `'tableCellPadding'` editor command.\n *\n * To change the padding of selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'tableCellPadding', {\n *   value: '5px'\n * } );\n * ```\n *\n * **Note**: This command adds the default `'px'` unit to numeric values. Executing:\n *\n * ```ts\n * editor.execute( 'tableCellPadding', {\n *   value: '5'\n * } );\n * ```\n *\n * will set the `padding` attribute to `'5px'` in the model.\n */\nclass TableCellPaddingCommand extends TableCellPropertyCommand {\n  /**\n  * Creates a new `TableCellPaddingCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableCellPadding', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getAttribute(tableCell) {\n    if (!tableCell) {\n      return;\n    }\n    const value = getSingleValue(tableCell.getAttribute(this.attributeName));\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValueToSet(value) {\n    const newValue = addDefaultUnitToNumericValue(value, 'px');\n    if (newValue === this._defaultValue) {\n      return;\n    }\n    return newValue;\n  }\n}\n\n/**\n * The table cell height command.\n *\n * The command is registered by the {@link module:table/tablecellproperties/tablecellpropertiesediting~TableCellPropertiesEditing} as\n * the `'tableCellHeight'` editor command.\n *\n * To change the height of selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'tableCellHeight', {\n *   value: '50px'\n * } );\n * ```\n *\n * **Note**: This command adds the default `'px'` unit to numeric values. Executing:\n *\n * ```ts\n * editor.execute( 'tableCellHeight', {\n *   value: '50'\n * } );\n * ```\n *\n * will set the `height` attribute to `'50px'` in the model.\n */\nclass TableCellHeightCommand extends TableCellPropertyCommand {\n  /**\n  * Creates a new `TableCellHeightCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableCellHeight', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValueToSet(value) {\n    const newValue = addDefaultUnitToNumericValue(value, 'px');\n    if (newValue === this._defaultValue) {\n      return;\n    }\n    return newValue;\n  }\n}\n\n/**\n * The table cell background color command.\n *\n * The command is registered by the {@link module:table/tablecellproperties/tablecellpropertiesediting~TableCellPropertiesEditing} as\n * the `'tableCellBackgroundColor'` editor command.\n *\n * To change the background color of selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'tableCellBackgroundColor', {\n *   value: '#f00'\n * } );\n * ```\n */\nclass TableCellBackgroundColorCommand extends TableCellPropertyCommand {\n  /**\n  * Creates a new `TableCellBackgroundColorCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableCellBackgroundColor', defaultValue);\n  }\n}\n\n/**\n * The table cell vertical alignment command.\n *\n * The command is registered by the {@link module:table/tablecellproperties/tablecellpropertiesediting~TableCellPropertiesEditing} as\n * the `'tableCellVerticalAlignment'` editor command.\n *\n * To change the vertical text alignment of selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'tableCellVerticalAlignment', {\n *   value: 'top'\n * } );\n * ```\n *\n * The following values, corresponding to the\n * [`vertical-align` CSS attribute](https://developer.mozilla.org/en-US/docs/Web/CSS/vertical-align), are allowed:\n *\n * * `'top'`\n * * `'bottom'`\n *\n * The `'middle'` value is the default one so there is no need to set it.\n */\nclass TableCellVerticalAlignmentCommand extends TableCellPropertyCommand {\n  /**\n  * Creates a new `TableCellVerticalAlignmentCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value for the \"alignment\" attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableCellVerticalAlignment', defaultValue);\n  }\n}\n\n/**\n * The table cell horizontal alignment command.\n *\n * The command is registered by the {@link module:table/tablecellproperties/tablecellpropertiesediting~TableCellPropertiesEditing} as\n * the `'tableCellHorizontalAlignment'` editor command.\n *\n * To change the horizontal text alignment of selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'tableCellHorizontalAlignment', {\n *  value: 'right'\n * } );\n * ```\n */\nclass TableCellHorizontalAlignmentCommand extends TableCellPropertyCommand {\n  /**\n  * Creates a new `TableCellHorizontalAlignmentCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value for the \"alignment\" attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableCellHorizontalAlignment', defaultValue);\n  }\n}\n\n/**\n * The table cell border style command.\n *\n * The command is registered by the {@link module:table/tablecellproperties/tablecellpropertiesediting~TableCellPropertiesEditing} as\n * the `'tableCellBorderStyle'` editor command.\n *\n * To change the border style of selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'tableCellBorderStyle', {\n *   value: 'dashed'\n * } );\n * ```\n */\nclass TableCellBorderStyleCommand extends TableCellPropertyCommand {\n  /**\n  * Creates a new `TableCellBorderStyleCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableCellBorderStyle', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getAttribute(tableCell) {\n    if (!tableCell) {\n      return;\n    }\n    const value = getSingleValue(tableCell.getAttribute(this.attributeName));\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n}\n\n/**\n * The table cell border color command.\n *\n * The command is registered by the {@link module:table/tablecellproperties/tablecellpropertiesediting~TableCellPropertiesEditing} as\n * the `'tableCellBorderColor'` editor command.\n *\n * To change the border color of selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'tableCellBorderColor', {\n *   value: '#f00'\n * } );\n * ```\n */\nclass TableCellBorderColorCommand extends TableCellPropertyCommand {\n  /**\n  * Creates a new `TableCellBorderColorCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableCellBorderColor', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getAttribute(tableCell) {\n    if (!tableCell) {\n      return;\n    }\n    const value = getSingleValue(tableCell.getAttribute(this.attributeName));\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n}\n\n/**\n * The table cell border width command.\n *\n * The command is registered by the {@link module:table/tablecellproperties/tablecellpropertiesediting~TableCellPropertiesEditing} as\n * the `'tableCellBorderWidth'` editor command.\n *\n * To change the border width of selected cells, execute the command:\n *\n * ```ts\n * editor.execute( 'tableCellBorderWidth', {\n *   value: '5px'\n * } );\n * ```\n *\n * **Note**: This command adds the default `'px'` unit to numeric values. Executing:\n *\n * ```ts\n * editor.execute( 'tableCellBorderWidth', {\n *   value: '5'\n * } );\n * ```\n *\n * will set the `borderWidth` attribute to `'5px'` in the model.\n */\nclass TableCellBorderWidthCommand extends TableCellPropertyCommand {\n  /**\n  * Creates a new `TableCellBorderWidthCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableCellBorderWidth', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getAttribute(tableCell) {\n    if (!tableCell) {\n      return;\n    }\n    const value = getSingleValue(tableCell.getAttribute(this.attributeName));\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValueToSet(value) {\n    const newValue = addDefaultUnitToNumericValue(value, 'px');\n    if (newValue === this._defaultValue) {\n      return;\n    }\n    return newValue;\n  }\n}\nconst VALIGN_VALUES_REG_EXP = /^(top|middle|bottom)$/;\nconst ALIGN_VALUES_REG_EXP$1 = /^(left|center|right|justify)$/;\n/**\n * The table cell properties editing feature.\n *\n * Introduces table cell model attributes and their conversion:\n *\n * - border: `tableCellBorderStyle`, `tableCellBorderColor` and `tableCellBorderWidth`\n * - background color: `tableCellBackgroundColor`\n * - cell padding: `tableCellPadding`\n * - horizontal and vertical alignment: `tableCellHorizontalAlignment`, `tableCellVerticalAlignment`\n * - cell width and height: `tableCellWidth`, `tableCellHeight`\n *\n * It also registers commands used to manipulate the above attributes:\n *\n * - border: the `'tableCellBorderStyle'`, `'tableCellBorderColor'` and `'tableCellBorderWidth'` commands\n * - background color: the `'tableCellBackgroundColor'` command\n * - cell padding: the `'tableCellPadding'` command\n * - horizontal and vertical alignment: the `'tableCellHorizontalAlignment'` and `'tableCellVerticalAlignment'` commands\n * - width and height: the `'tableCellWidth'` and `'tableCellHeight'` commands\n */\nclass TableCellPropertiesEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableCellPropertiesEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableEditing, TableCellWidthEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    editor.config.define('table.tableCellProperties.defaultProperties', {});\n    const defaultTableCellProperties = getNormalizedDefaultCellProperties(editor.config.get('table.tableCellProperties.defaultProperties'), {\n      includeVerticalAlignmentProperty: true,\n      includeHorizontalAlignmentProperty: true,\n      includePaddingProperty: true,\n      isRightToLeftContent: editor.locale.contentLanguageDirection === 'rtl'\n    });\n    editor.data.addStyleProcessorRules(addBorderRules);\n    enableBorderProperties$1(schema, conversion, {\n      color: defaultTableCellProperties.borderColor,\n      style: defaultTableCellProperties.borderStyle,\n      width: defaultTableCellProperties.borderWidth\n    });\n    editor.commands.add('tableCellBorderStyle', new TableCellBorderStyleCommand(editor, defaultTableCellProperties.borderStyle));\n    editor.commands.add('tableCellBorderColor', new TableCellBorderColorCommand(editor, defaultTableCellProperties.borderColor));\n    editor.commands.add('tableCellBorderWidth', new TableCellBorderWidthCommand(editor, defaultTableCellProperties.borderWidth));\n    enableProperty$1(schema, conversion, {\n      modelAttribute: 'tableCellHeight',\n      styleName: 'height',\n      defaultValue: defaultTableCellProperties.height\n    });\n    editor.commands.add('tableCellHeight', new TableCellHeightCommand(editor, defaultTableCellProperties.height));\n    editor.data.addStyleProcessorRules(addPaddingRules);\n    enableProperty$1(schema, conversion, {\n      modelAttribute: 'tableCellPadding',\n      styleName: 'padding',\n      reduceBoxSides: true,\n      defaultValue: defaultTableCellProperties.padding\n    });\n    editor.commands.add('tableCellPadding', new TableCellPaddingCommand(editor, defaultTableCellProperties.padding));\n    editor.data.addStyleProcessorRules(addBackgroundRules);\n    enableProperty$1(schema, conversion, {\n      modelAttribute: 'tableCellBackgroundColor',\n      styleName: 'background-color',\n      defaultValue: defaultTableCellProperties.backgroundColor\n    });\n    editor.commands.add('tableCellBackgroundColor', new TableCellBackgroundColorCommand(editor, defaultTableCellProperties.backgroundColor));\n    enableHorizontalAlignmentProperty(schema, conversion, defaultTableCellProperties.horizontalAlignment);\n    editor.commands.add('tableCellHorizontalAlignment', new TableCellHorizontalAlignmentCommand(editor, defaultTableCellProperties.horizontalAlignment));\n    enableVerticalAlignmentProperty(schema, conversion, defaultTableCellProperties.verticalAlignment);\n    editor.commands.add('tableCellVerticalAlignment', new TableCellVerticalAlignmentCommand(editor, defaultTableCellProperties.verticalAlignment));\n  }\n}\n/**\n * Enables the `'tableCellBorderStyle'`, `'tableCellBorderColor'` and `'tableCellBorderWidth'` attributes for table cells.\n *\n * @param defaultBorder The default border values.\n * @param defaultBorder.color The default `tableCellBorderColor` value.\n * @param defaultBorder.style The default `tableCellBorderStyle` value.\n * @param defaultBorder.width The default `tableCellBorderWidth` value.\n */\nfunction enableBorderProperties$1(schema, conversion, defaultBorder) {\n  const modelAttributes = {\n    width: 'tableCellBorderWidth',\n    color: 'tableCellBorderColor',\n    style: 'tableCellBorderStyle'\n  };\n  schema.extend('tableCell', {\n    allowAttributes: Object.values(modelAttributes)\n  });\n  upcastBorderStyles(conversion, 'td', modelAttributes, defaultBorder);\n  upcastBorderStyles(conversion, 'th', modelAttributes, defaultBorder);\n  downcastAttributeToStyle(conversion, {\n    modelElement: 'tableCell',\n    modelAttribute: modelAttributes.style,\n    styleName: 'border-style'\n  });\n  downcastAttributeToStyle(conversion, {\n    modelElement: 'tableCell',\n    modelAttribute: modelAttributes.color,\n    styleName: 'border-color'\n  });\n  downcastAttributeToStyle(conversion, {\n    modelElement: 'tableCell',\n    modelAttribute: modelAttributes.width,\n    styleName: 'border-width'\n  });\n}\n/**\n * Enables the `'tableCellHorizontalAlignment'` attribute for table cells.\n *\n * @param defaultValue The default horizontal alignment value.\n */\nfunction enableHorizontalAlignmentProperty(schema, conversion, defaultValue) {\n  schema.extend('tableCell', {\n    allowAttributes: ['tableCellHorizontalAlignment']\n  });\n  conversion.for('downcast').attributeToAttribute({\n    model: {\n      name: 'tableCell',\n      key: 'tableCellHorizontalAlignment'\n    },\n    view: alignment => ({\n      key: 'style',\n      value: {\n        'text-align': alignment\n      }\n    })\n  });\n  conversion.for('upcast') // Support for the `text-align:*;` CSS definition for the table cell alignment.\n  .attributeToAttribute({\n    view: {\n      name: /^(td|th)$/,\n      styles: {\n        'text-align': ALIGN_VALUES_REG_EXP$1\n      }\n    },\n    model: {\n      key: 'tableCellHorizontalAlignment',\n      value: (viewElement, conversionApi, data) => {\n        const localDefaultValue = getDefaultValueAdjusted(defaultValue, 'left', data);\n        const align = viewElement.getStyle('text-align');\n        return align === localDefaultValue ? null : align;\n      }\n    }\n  }) // Support for the `align` attribute as the backward compatibility while pasting from other sources.\n  .attributeToAttribute({\n    view: {\n      name: /^(td|th)$/,\n      attributes: {\n        align: ALIGN_VALUES_REG_EXP$1\n      }\n    },\n    model: {\n      key: 'tableCellHorizontalAlignment',\n      value: (viewElement, conversionApi, data) => {\n        const localDefaultValue = getDefaultValueAdjusted(defaultValue, 'left', data);\n        const align = viewElement.getAttribute('align');\n        return align === localDefaultValue ? null : align;\n      }\n    }\n  });\n}\n/**\n * Enables the `'verticalAlignment'` attribute for table cells.\n *\n * @param defaultValue The default vertical alignment value.\n */\nfunction enableVerticalAlignmentProperty(schema, conversion, defaultValue) {\n  schema.extend('tableCell', {\n    allowAttributes: ['tableCellVerticalAlignment']\n  });\n  conversion.for('downcast').attributeToAttribute({\n    model: {\n      name: 'tableCell',\n      key: 'tableCellVerticalAlignment'\n    },\n    view: alignment => ({\n      key: 'style',\n      value: {\n        'vertical-align': alignment\n      }\n    })\n  });\n  conversion.for('upcast') // Support for the `vertical-align:*;` CSS definition for the table cell alignment.\n  .attributeToAttribute({\n    view: {\n      name: /^(td|th)$/,\n      styles: {\n        'vertical-align': VALIGN_VALUES_REG_EXP\n      }\n    },\n    model: {\n      key: 'tableCellVerticalAlignment',\n      value: (viewElement, conversionApi, data) => {\n        const localDefaultValue = getDefaultValueAdjusted(defaultValue, 'middle', data);\n        const align = viewElement.getStyle('vertical-align');\n        return align === localDefaultValue ? null : align;\n      }\n    }\n  }) // Support for the `align` attribute as the backward compatibility while pasting from other sources.\n  .attributeToAttribute({\n    view: {\n      name: /^(td|th)$/,\n      attributes: {\n        valign: VALIGN_VALUES_REG_EXP\n      }\n    },\n    model: {\n      key: 'tableCellVerticalAlignment',\n      value: (viewElement, conversionApi, data) => {\n        const localDefaultValue = getDefaultValueAdjusted(defaultValue, 'middle', data);\n        const valign = viewElement.getAttribute('valign');\n        return valign === localDefaultValue ? null : valign;\n      }\n    }\n  });\n}\n\n/**\n * The table cell properties feature. Enables support for setting properties of table cells (size, border, background, etc.).\n *\n * Read more in the {@glink features/tables/tables-styling Table and cell styling tools} section.\n * See also the {@link module:table/tableproperties~TableProperties} plugin.\n *\n * This is a \"glue\" plugin that loads the\n * {@link module:table/tablecellproperties/tablecellpropertiesediting~TableCellPropertiesEditing table cell properties editing feature} and\n * the {@link module:table/tablecellproperties/tablecellpropertiesui~TableCellPropertiesUI table cell properties UI feature}.\n */\nclass TableCellProperties extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableCellProperties';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableCellPropertiesEditing, TableCellPropertiesUI];\n  }\n}\n\n/**\n * The table layout UI plugin. It introduces:\n *\n * * The `'insertTableLayout'` dropdown,\n * * The `'menuBar:insertTableLayout'` menu bar menu.\n */\nclass TableLayoutUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableLayoutUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const t = this.editor.t;\n    editor.ui.componentFactory.add('insertTableLayout', locale => {\n      const command = editor.commands.get('insertTableLayout');\n      const dropdownView = createDropdown(locale);\n      dropdownView.bind('isEnabled').to(command);\n      // Decorate dropdown's button.\n      dropdownView.buttonView.set({\n        icon: IconTableLayout,\n        label: t('Insert table layout'),\n        tooltip: true\n      });\n      let insertTableLayoutView;\n      dropdownView.on('change:isOpen', () => {\n        if (insertTableLayoutView) {\n          return;\n        }\n        // Prepare custom view for dropdown's panel.\n        insertTableLayoutView = new InsertTableView(locale);\n        dropdownView.panelView.children.add(insertTableLayoutView);\n        insertTableLayoutView.delegate('execute').to(dropdownView);\n        dropdownView.on('execute', () => {\n          editor.execute('insertTableLayout', {\n            rows: insertTableLayoutView.rows,\n            columns: insertTableLayoutView.columns\n          });\n          editor.editing.view.focus();\n        });\n      });\n      return dropdownView;\n    });\n    editor.ui.componentFactory.add('menuBar:insertTableLayout', locale => {\n      const command = editor.commands.get('insertTableLayout');\n      const menuView = new MenuBarMenuView(locale);\n      const insertTableLayoutView = new InsertTableView(locale);\n      insertTableLayoutView.delegate('execute').to(menuView);\n      menuView.on('change:isOpen', (event, name, isOpen) => {\n        if (!isOpen) {\n          insertTableLayoutView.reset();\n        }\n      });\n      insertTableLayoutView.on('execute', () => {\n        editor.execute('insertTableLayout', {\n          rows: insertTableLayoutView.rows,\n          columns: insertTableLayoutView.columns\n        });\n        editor.editing.view.focus();\n      });\n      menuView.buttonView.set({\n        label: t('Table layout'),\n        icon: IconTableLayout\n      });\n      menuView.panelView.children.add(insertTableLayoutView);\n      menuView.bind('isEnabled').to(command);\n      return menuView;\n    });\n    // Create table type dropdown button.\n    editor.ui.componentFactory.add('tableType', () => {\n      const editor = this.editor;\n      const t = editor.t;\n      const button = new DropdownButtonView(editor.locale);\n      button.set({\n        label: t('Table type'),\n        icon: IconTableProperties,\n        tooltip: true\n      });\n      return createTableTypeDropdown(editor, button);\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  afterInit() {\n    const editor = this.editor;\n    if (!editor.plugins.has('TablePropertiesUI')) {\n      return;\n    }\n    const tablePropertiesUI = editor.plugins.get('TablePropertiesUI');\n    // Override the default table properties button to include the table type dropdown.\n    // It needs to be done in `afterInit()` to make sure that `tableProperties` button is\n    // registered after the initialization of the `TablePropertiesUI`. Otherwise, the\n    // button will be overridden by the default one if the `TablePropertiesUI` is\n    // initialized after the `TableLayoutUI`.\n    editor.ui.componentFactory.add('tableProperties', locale => {\n      const baseButton = tablePropertiesUI._createTablePropertiesButton();\n      const splitButtonView = new SplitButtonView(locale, baseButton);\n      return createTableTypeDropdown(editor, splitButtonView);\n    });\n  }\n}\n/**\n * Creates a dropdown for the table type selection.\n *\n * @param editor The editor instance.\n * @param dropdownButton The button view that will be used as the dropdown trigger.\n * @returns A dropdown view containing table type options.\n */\nfunction createTableTypeDropdown(editor, dropdownButton) {\n  const t = editor.t;\n  const locale = editor.locale;\n  const tableTypeCommand = editor.commands.get('tableType');\n  // Wrap the original button in a SplitButtonView.\n  const dropdownView = createDropdown(locale, dropdownButton);\n  const itemsDefinitions = createTableLayoutTypeDropdownItems(editor);\n  // Add table types to the dropdown.\n  addListToDropdown(dropdownView, itemsDefinitions, {\n    ariaLabel: t('Table type options'),\n    role: 'menu'\n  });\n  dropdownButton.tooltip = t('Choose table type');\n  dropdownView.on('execute', evt => {\n    const tableType = evt.source.tableType;\n    if (tableType) {\n      tableTypeCommand.execute(tableType);\n    }\n  });\n  return dropdownView;\n}\n/**\n * Creates dropdown items for table type selection.\n *\n * @param editor The editor instance.\n * @returns A collection of dropdown items for the table type dropdown.\n */\nfunction createTableLayoutTypeDropdownItems(editor) {\n  const t = editor.t;\n  const tableTypeCommand = editor.commands.get('tableType');\n  const itemDefinitions = new Collection();\n  itemDefinitions.add(createTableTypeDropdownItem(tableTypeCommand, 'layout', t('Layout table')));\n  itemDefinitions.add(createTableTypeDropdownItem(tableTypeCommand, 'content', t('Content table')));\n  return itemDefinitions;\n}\n/**\n * Creates a dropdown item for a specific table type.\n *\n * @param tableTypeCommand The table type command.\n * @param type The table type value ('layout' or 'content').\n * @param label The localized label for the dropdown item.\n * @returns The dropdown item definition.\n */\nfunction createTableTypeDropdownItem(tableTypeCommand, type, label) {\n  const model = new ViewModel({\n    label,\n    role: 'menuitemradio',\n    withText: true,\n    tableType: type\n  });\n  model.bind('isEnabled').to(tableTypeCommand, 'isEnabled');\n  model.bind('isOn').to(tableTypeCommand, 'value', value => value === type);\n  return {\n    type: 'button',\n    model\n  };\n}\n\n/**\n * The insert table layout command.\n *\n * The command is registered by {@link module:table/tablelayout/tablelayoutediting~TableLayoutEditing}\n * as the `'insertTableLayout'` editor command.\n *\n * To insert a layout table at the current selection, execute the command and specify the dimensions:\n *\n * ```ts\n * editor.execute( 'insertTableLayout', { rows: 20, columns: 5 } );\n * ```\n */\nclass InsertTableLayoutCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const schema = model.schema;\n    this.isEnabled = isAllowedInParent(selection, schema);\n  }\n  /**\n  * Executes the command.\n  *\n  * Inserts a layout table with the given number of rows and columns into the editor.\n  *\n  * @param options.rows The number of rows to create in the inserted table. Default value is 2.\n  * @param options.columns The number of columns to create in the inserted table. Default value is 2.\n  * @fires execute\n  */\n  execute(options = {}) {\n    const editor = this.editor;\n    const model = editor.model;\n    const tableUtils = editor.plugins.get('TableUtils');\n    model.change(writer => {\n      const normalizedOptions = {\n        rows: options.rows || 2,\n        columns: options.columns || 2\n      };\n      const table = tableUtils.createTable(writer, normalizedOptions);\n      writer.setAttribute('tableType', 'layout', table);\n      model.insertObject(table, null, null, {\n        findOptimalPosition: 'auto'\n      });\n      const singleColumnWidth = `${100 / normalizedOptions.columns}%`;\n      const columnWidths = Array(normalizedOptions.columns).fill(singleColumnWidth);\n      const tableWidthsCommand = editor.commands.get('resizeColumnWidths');\n      // Make the table full-width with equal columns width.\n      tableWidthsCommand.execute({\n        tableWidth: '100%',\n        columnWidths,\n        table\n      });\n      writer.setSelection(writer.createPositionAt(table.getNodeByPath([0, 0, 0]), 0));\n    });\n  }\n}\n/**\n * Checks if the table is allowed in the parent.\n */\nfunction isAllowedInParent(selection, schema) {\n  const positionParent = selection.getFirstPosition().parent;\n  const validParent = positionParent === positionParent.root ? positionParent : positionParent.parent;\n  return schema.checkChild(validParent, 'table');\n}\n\n/**\n * Command used by the {@link module:table/tablecolumnresize~TableColumnResize Table column resize feature} that\n * updates the width of the whole table as well as its individual columns.\n */\nclass TableWidthsCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    // The command is always enabled as it doesn't care about the actual selection - table can be resized\n    // even if the selection is elsewhere.\n    this.isEnabled = true;\n  }\n  /**\n  * Updated the `tableWidth` attribute of the table and the `columnWidth` attribute of the columns of that table.\n  */\n  execute(options = {}) {\n    const {\n      model,\n      plugins\n    } = this.editor;\n    let {\n      table = model.document.selection.getSelectedElement(),\n      columnWidths,\n      tableWidth\n    } = options;\n    if (columnWidths) {\n      // For backwards compatibility, columnWidths might be an array or a string of comma-separated values.\n      columnWidths = Array.isArray(columnWidths) ? columnWidths : columnWidths.split(',');\n    }\n    model.change(writer => {\n      if (tableWidth) {\n        writer.setAttribute('tableWidth', tableWidth, table);\n      } else {\n        writer.removeAttribute('tableWidth', table);\n      }\n      const tableColumnGroup = plugins.get('TableColumnResizeEditing').getColumnGroupElement(table);\n      if (!columnWidths && !tableColumnGroup) {\n        return;\n      }\n      if (!columnWidths) {\n        return writer.remove(tableColumnGroup);\n      }\n      const widths = normalizeColumnWidths(columnWidths);\n      if (!tableColumnGroup) {\n        const colGroupElement = writer.createElement('tableColumnGroup');\n        widths.forEach(columnWidth => writer.appendElement('tableColumn', {\n          columnWidth\n        }, colGroupElement));\n        writer.append(colGroupElement, table);\n      } else {\n        Array.from(tableColumnGroup.getChildren()).forEach((column, index) => writer.setAttribute('columnWidth', widths[index], column));\n      }\n    });\n  }\n}\n\n/**\n * Returns a upcast helper that ensures the number of `<tableColumn>` elements corresponds to the actual number of columns in the table,\n * because the input data might have too few or too many <col> elements.\n */\nfunction upcastColgroupElement(tableUtilsPlugin) {\n  return dispatcher => dispatcher.on('element:colgroup', (evt, data, conversionApi) => {\n    const modelTable = data.modelCursor.findAncestor('table');\n    const tableColumnGroup = getColumnGroupElement(modelTable);\n    if (!tableColumnGroup) {\n      return;\n    }\n    const columnElements = getTableColumnElements(tableColumnGroup);\n    const columnsCount = tableUtilsPlugin.getColumns(modelTable);\n    let columnWidths = translateColSpanAttribute(tableColumnGroup, conversionApi.writer);\n    // Fill the array with 'auto' values if the number of columns is higher than number of declared values.\n    columnWidths = Array.from({\n      length: columnsCount\n    }, (_, index) => columnWidths[index] || 'auto');\n    if (columnWidths.length != columnElements.length || columnWidths.includes('auto')) {\n      updateColumnElements(columnElements, tableColumnGroup, normalizeColumnWidths(columnWidths), conversionApi.writer);\n    }\n  }, {\n    priority: 'low'\n  });\n}\n/**\n * Returns downcast helper for adding `ck-table-resized` class if there is a `<tableColumnGroup>` element inside the table.\n */\nfunction downcastTableResizedClass() {\n  return dispatcher => dispatcher.on('insert:table', (evt, data, conversionApi) => {\n    const viewWriter = conversionApi.writer;\n    const modelTable = data.item;\n    const viewElement = conversionApi.mapper.toViewElement(modelTable);\n    const viewTable = viewElement.is('element', 'table') ? viewElement : Array.from(viewElement.getChildren()).find(viewChild => viewChild.is('element', 'table'));\n    const tableColumnGroup = getColumnGroupElement(modelTable);\n    if (tableColumnGroup) {\n      viewWriter.addClass('ck-table-resized', viewTable);\n    } else {\n      viewWriter.removeClass('ck-table-resized', viewTable);\n    }\n  }, {\n    priority: 'low'\n  });\n}\nconst toPx = /* #__PURE__ */toUnit('px');\n/**\n * The table column resize editing plugin.\n */\nclass TableColumnResizeEditing extends Plugin {\n  /**\n  * A flag indicating if the column resizing is in progress.\n  */\n  _isResizingActive;\n  /**\n  * A temporary storage for the required data needed to correctly calculate the widths of the resized columns. This storage is\n  * initialized when column resizing begins, and is purged upon completion.\n  */\n  _resizingData;\n  /**\n  * DOM emitter.\n  */\n  _domEmitter;\n  /**\n  * A local reference to the {@link module:table/tableutils~TableUtils} plugin.\n  */\n  _tableUtilsPlugin;\n  /**\n  * Starting mouse position data used to add a threshold to the resizing process.\n  */\n  _initialMouseEventData = null;\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableEditing, TableUtils];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableColumnResizeEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._isResizingActive = false;\n    this.set('_isResizingAllowed', true);\n    this._resizingData = null;\n    this._domEmitter = new (DomEmitterMixin())();\n    this._tableUtilsPlugin = editor.plugins.get('TableUtils');\n    this.on('change:_isResizingAllowed', (evt, name, value) => {\n      // Toggling the `ck-column-resize_disabled` class shows and hides the resizers through CSS.\n      const classAction = value ? 'removeClass' : 'addClass';\n      editor.editing.view.change(writer => {\n        for (const root of editor.editing.view.document.roots) {\n          writer[classAction]('ck-column-resize_disabled', editor.editing.view.document.getRoot(root.rootName));\n        }\n      });\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    this._extendSchema();\n    this._registerPostFixer();\n    this._registerConverters();\n    this._registerResizingListeners();\n    this._registerResizerInserter();\n    const editor = this.editor;\n    const columnResizePlugin = editor.plugins.get('TableColumnResize');\n    const tableEditing = editor.plugins.get('TableEditing');\n    tableEditing.registerAdditionalSlot({\n      filter: element => element.is('element', 'tableColumnGroup'),\n      positionOffset: 0\n    });\n    const tableWidthsCommand = new TableWidthsCommand(editor);\n    // For backwards compatibility we have two commands that perform exactly the same operation.\n    editor.commands.add('resizeTableWidth', tableWidthsCommand);\n    editor.commands.add('resizeColumnWidths', tableWidthsCommand);\n    // Currently the states of column resize and table resize (which is actually the last column resize) features\n    // are bound together. They can be separated in the future by adding distinct listeners and applying\n    // different CSS classes (e.g. `ck-column-resize_disabled` and `ck-table-resize_disabled`) to the editor root.\n    // See #12148 for the details.\n    this.bind('_isResizingAllowed').to(editor, 'isReadOnly', columnResizePlugin, 'isEnabled', tableWidthsCommand, 'isEnabled', (isEditorReadOnly, isPluginEnabled, isTableWidthsCommandCommandEnabled) => !isEditorReadOnly && isPluginEnabled && isTableWidthsCommandCommandEnabled);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    this._domEmitter.stopListening();\n    super.destroy();\n  }\n  /**\n  * Returns a 'tableColumnGroup' element from the 'table'.\n  *\n  * @param element A 'table' or 'tableColumnGroup' element.\n  * @returns A 'tableColumnGroup' element.\n  */\n  getColumnGroupElement(element) {\n    return getColumnGroupElement(element);\n  }\n  /**\n  * Returns an array of 'tableColumn' elements.\n  *\n  * @param element A 'table' or 'tableColumnGroup' element.\n  * @returns An array of 'tableColumn' elements.\n  */\n  getTableColumnElements(element) {\n    return getTableColumnElements(element);\n  }\n  /**\n  * Returns an array of table column widths.\n  *\n  * @param element A 'table' or 'tableColumnGroup' element.\n  * @returns An array of table column widths.\n  */\n  getTableColumnsWidths(element) {\n    return getTableColumnsWidths(element);\n  }\n  /**\n  * Registers new attributes for a table model element.\n  */\n  _extendSchema() {\n    this.editor.model.schema.extend('table', {\n      allowAttributes: ['tableWidth']\n    });\n    this.editor.model.schema.register('tableColumnGroup', {\n      allowIn: 'table',\n      isLimit: true\n    });\n    this.editor.model.schema.register('tableColumn', {\n      allowIn: 'tableColumnGroup',\n      allowAttributes: ['columnWidth', 'colSpan'],\n      isLimit: true\n    });\n  }\n  /**\n  * Registers table column resize post-fixer.\n  *\n  * It checks if the change from the differ concerns a table-related element or attribute. For detected changes it:\n  *  * Adjusts the `columnWidths` attribute to guarantee that the sum of the widths from all columns is 100%.\n  *  * Checks if the `columnWidths` attribute gets updated accordingly after columns have been added or removed.\n  */\n  _registerPostFixer() {\n    const editor = this.editor;\n    const model = editor.model;\n    model.document.registerPostFixer(writer => {\n      let changed = false;\n      for (const table of getChangedResizedTables(model)) {\n        const tableColumnGroup = this.getColumnGroupElement(table);\n        const columns = this.getTableColumnElements(tableColumnGroup);\n        const columnWidths = this.getTableColumnsWidths(tableColumnGroup);\n        // Adjust the `columnWidths` attribute to guarantee that the sum of the widths from all columns is 100%.\n        let normalizedWidths = normalizeColumnWidths(columnWidths);\n        // If the number of columns has changed, then we need to adjust the widths of the affected columns.\n        normalizedWidths = adjustColumnWidths(normalizedWidths, table, this);\n        if (isEqual(columnWidths, normalizedWidths)) {\n          continue;\n        }\n        updateColumnElements(columns, tableColumnGroup, normalizedWidths, writer);\n        changed = true;\n      }\n      return changed;\n    });\n    /**\n    * Adjusts if necessary the `columnWidths` in case if the number of column has changed.\n    *\n    * @param columnWidths Note: this array **may be modified** by the function.\n    * @param table Table to be checked.\n    */\n    function adjustColumnWidths(columnWidths, table, plugin) {\n      const newTableColumnsCount = plugin._tableUtilsPlugin.getColumns(table);\n      const columnsCountDelta = newTableColumnsCount - columnWidths.length;\n      if (columnsCountDelta === 0) {\n        return columnWidths;\n      }\n      const widths = columnWidths.map(width => Number(width.replace('%', '')));\n      // Collect all cells that are affected by the change.\n      const cellSet = getAffectedCells(plugin.editor.model.document.differ, table);\n      for (const cell of cellSet) {\n        const currentColumnsDelta = newTableColumnsCount - widths.length;\n        if (currentColumnsDelta === 0) {\n          continue;\n        }\n        // If the column count in the table changed, adjust the widths of the affected columns.\n        const hasMoreColumns = currentColumnsDelta > 0;\n        const currentColumnIndex = plugin._tableUtilsPlugin.getCellLocation(cell).column;\n        if (hasMoreColumns) {\n          const columnMinWidthAsPercentage = getColumnMinWidthAsPercentage(table, plugin.editor);\n          const columnWidthsToInsert = createFilledArray(currentColumnsDelta, columnMinWidthAsPercentage);\n          widths.splice(currentColumnIndex, 0, ...columnWidthsToInsert);\n        } else {\n          // Moves the widths of the removed columns to the preceding one.\n          // Other editors either reduce the width of the whole table or adjust the widths\n          // proportionally, so change of this behavior can be considered in the future.\n          const removedColumnWidths = widths.splice(currentColumnIndex, Math.abs(currentColumnsDelta));\n          widths[currentColumnIndex] += sumArray(removedColumnWidths);\n        }\n      }\n      return widths.map(width => width + '%');\n    }\n    /**\n    * Returns a set of cells that have been changed in a given table.\n    */\n    function getAffectedCells(differ, table) {\n      const cellSet = new Set();\n      for (const change of differ.getChanges()) {\n        if (change.type == 'insert' && change.position.nodeAfter && change.position.nodeAfter.name == 'tableCell' && change.position.nodeAfter.getAncestors().includes(table)) {\n          cellSet.add(change.position.nodeAfter);\n        } else if (change.type == 'remove') {\n          // If the first cell was removed, use the node after the change position instead.\n          const referenceNode = change.position.nodeBefore || change.position.nodeAfter;\n          if (referenceNode.name == 'tableCell' && referenceNode.getAncestors().includes(table)) {\n            cellSet.add(referenceNode);\n          }\n        }\n      }\n      return cellSet;\n    }\n  }\n  /**\n  * Registers table column resize converters.\n  */\n  _registerConverters() {\n    const editor = this.editor;\n    const conversion = editor.conversion;\n    // Table width style\n    conversion.for('upcast').attributeToAttribute({\n      view: {\n        name: /^(figure|table)$/,\n        styles: {\n          width: /[\\s\\S]+/\n        }\n      },\n      model: {\n        name: 'table',\n        key: 'tableWidth',\n        value: viewElement => viewElement.getStyle('width')\n      }\n    });\n    conversion.for('downcast').attributeToAttribute({\n      model: {\n        name: 'table',\n        key: 'tableWidth'\n      },\n      view: width => ({\n        name: 'figure',\n        key: 'style',\n        value: {\n          width\n        }\n      })\n    });\n    conversion.elementToElement({\n      model: 'tableColumnGroup',\n      view: 'colgroup'\n    });\n    conversion.elementToElement({\n      model: 'tableColumn',\n      view: 'col'\n    });\n    conversion.for('downcast').add(downcastTableResizedClass());\n    conversion.for('upcast').add(upcastColgroupElement(this._tableUtilsPlugin));\n    conversion.for('upcast').attributeToAttribute({\n      view: {\n        name: 'col',\n        styles: {\n          width: /.*/\n        }\n      },\n      model: {\n        key: 'columnWidth',\n        value: viewElement => {\n          const viewColWidth = viewElement.getStyle('width');\n          // 'pt' is the default unit for table column width pasted from MS Office.\n          // See https://github.com/ckeditor/ckeditor5/issues/14521#issuecomment-1662102889 for more details.\n          if (!viewColWidth || !viewColWidth.endsWith('%') && !viewColWidth.endsWith('pt')) {\n            return 'auto';\n          }\n          return viewColWidth;\n        }\n      }\n    });\n    // The `col[span]` attribute is present in tables pasted from MS Excel. We use it to set the temporary `colSpan` model attribute,\n    // which is consumed during the `colgroup` element upcast.\n    // See https://github.com/ckeditor/ckeditor5/issues/14521#issuecomment-1662102889 for more details.\n    conversion.for('upcast').attributeToAttribute({\n      view: {\n        name: 'col',\n        key: 'span'\n      },\n      model: 'colSpan'\n    });\n    conversion.for('downcast').attributeToAttribute({\n      model: {\n        name: 'tableColumn',\n        key: 'columnWidth'\n      },\n      view: width => ({\n        key: 'style',\n        value: {\n          width\n        }\n      })\n    });\n  }\n  /**\n  * Registers listeners to handle resizing process.\n  */\n  _registerResizingListeners() {\n    const editingView = this.editor.editing.view;\n    editingView.addObserver(MouseEventsObserver);\n    editingView.document.on('mouseover', this._onMouseOverHandler.bind(this), {\n      priority: 'high'\n    });\n    editingView.document.on('mousedown', this._onMouseDownHandler.bind(this), {\n      priority: 'high'\n    });\n    editingView.document.on('mouseout', this._onMouseOutHandler.bind(this), {\n      priority: 'high'\n    });\n    this._domEmitter.listenTo(global.window.document, 'mousemove', throttle(this._onMouseMoveHandler.bind(this), 50));\n    this._domEmitter.listenTo(global.window.document, 'mouseup', this._onMouseUpHandler.bind(this));\n  }\n  /**\n  * Calculate and set `top` and `bottom` styles to the column resizer element to fit the height of the table.\n  *\n  * @param viewResizer The column resizer element.\n  */\n  _recalculateResizerElement(viewResizer) {\n    const editor = this.editor;\n    const domConverter = editor.editing.view.domConverter;\n    // Get DOM target figure ancestor element.\n    const domTable = domConverter.mapViewToDom(viewResizer.findAncestor('table'));\n    // Get DOM table cell element.\n    const domCell = domConverter.mapViewToDom(viewResizer.findAncestor(item => ['td', 'th'].includes(item.name)));\n    const rectTable = new Rect(domTable);\n    const rectCell = new Rect(domCell);\n    // Calculate the top, and bottom positions of the column resizer element.\n    const targetTopPosition = toPx(Number((rectTable.top - rectCell.top).toFixed(4)));\n    const targetBottomPosition = toPx(Number((rectCell.bottom - rectTable.bottom).toFixed(4)));\n    // Set `top` and `bottom` styles to the column resizer element.\n    editor.editing.view.change(viewWriter => {\n      viewWriter.setStyle('top', targetTopPosition, viewResizer);\n      viewWriter.setStyle('bottom', targetBottomPosition, viewResizer);\n    });\n  }\n  /**\n  * Remove `top` and `bottom` styles of the column resizer element.\n  *\n  * @param viewResizer The column resizer element.\n  */\n  _resetResizerStyles(viewResizer) {\n    this.editor.editing.view.change(viewWriter => {\n      viewWriter.removeStyle('top', viewResizer);\n      viewWriter.removeStyle('bottom', viewResizer);\n    });\n  }\n  /**\n  * Handles the `mouseover` event on column resizer element.\n  * Recalculates the `top` and `bottom` styles of the column resizer element to fit the height of the table.\n  *\n  * @param eventInfo An object containing information about the fired event.\n  * @param domEventData The data related to the DOM event.\n  */\n  _onMouseOverHandler(eventInfo, domEventData) {\n    const target = domEventData.target;\n    if (!target.hasClass('ck-table-column-resizer')) {\n      return;\n    }\n    if (!this._isResizingAllowed) {\n      return;\n    }\n    this._recalculateResizerElement(target);\n  }\n  /**\n  * Handles the `mouseout` event on column resizer element.\n  * When resizing is not active, it resets the `top` and `bottom` styles of the column resizer element.\n  *\n  * @param eventInfo An object containing information about the fired event.\n  * @param domEventData The data related to the DOM event.\n  */\n  _onMouseOutHandler(eventInfo, domEventData) {\n    const target = domEventData.target;\n    if (!target.hasClass('ck-table-column-resizer')) {\n      return;\n    }\n    if (!this._isResizingAllowed) {\n      return;\n    }\n    if (this._isResizingActive) {\n      return;\n    }\n    this._resetResizerStyles(target);\n  }\n  /**\n  * Handles the `mousedown` event on column resizer element:\n  *  * calculates the initial column pixel widths,\n  *  * inserts the `<colgroup>` element if it is not present in the `<table>`,\n  *  * puts the necessary data in the temporary storage,\n  *  * applies the attributes to the `<table>` view element.\n  *\n  * @param eventInfo An object containing information about the fired event.\n  * @param domEventData The data related to the DOM event.\n  */\n  _onMouseDownHandler(eventInfo, domEventData) {\n    const target = domEventData.target;\n    if (!target.hasClass('ck-table-column-resizer')) {\n      return;\n    }\n    if (!this._isResizingAllowed) {\n      return;\n    }\n    const editor = this.editor;\n    const modelTable = editor.editing.mapper.toModelElement(target.findAncestor('figure'));\n    // Do not resize if table model is in non-editable place.\n    if (!editor.model.canEditAt(modelTable)) {\n      return;\n    }\n    domEventData.preventDefault();\n    eventInfo.stop();\n    this._initialMouseEventData = domEventData;\n  }\n  /**\n  * Starts the resizing process after the threshold is reached.\n  */\n  _startResizingAfterThreshold() {\n    const domEventData = this._initialMouseEventData;\n    const {\n      target\n    } = domEventData;\n    const modelTable = this.editor.editing.mapper.toModelElement(target.findAncestor('figure'));\n    const viewTable = target.findAncestor('table');\n    // Calculate the initial column widths in pixels.\n    const columnWidthsInPx = _calculateDomColumnWidths(modelTable, this._tableUtilsPlugin, this.editor);\n    // Insert colgroup for the table that is resized for the first time.\n    if (!Array.from(viewTable.getChildren()).find(viewCol => viewCol.is('element', 'colgroup'))) {\n      this.editor.editing.view.change(viewWriter => {\n        _insertColgroupElement(viewWriter, columnWidthsInPx, viewTable);\n      });\n    }\n    this._isResizingActive = true;\n    this._resizingData = this._getResizingData(domEventData, columnWidthsInPx);\n    // At this point we change only the editor view - we don't want other users to see our changes yet,\n    // so we can't apply them in the model.\n    this.editor.editing.view.change(writer => _applyResizingAttributesToTable(writer, viewTable, this._resizingData));\n    /**\n    * Calculates the DOM columns' widths. It is done by taking the width of the widest cell\n    * from each table column (we rely on the  {@link module:table/tablewalker~TableWalker}\n    * to determine which column the cell belongs to).\n    *\n    * @param modelTable A table which columns should be measured.\n    * @param tableUtils The Table Utils plugin instance.\n    * @param editor The editor instance.\n    * @returns Columns' widths expressed in pixels (without unit).\n    */\n    function _calculateDomColumnWidths(modelTable, tableUtilsPlugin, editor) {\n      const columnWidthsInPx = Array(tableUtilsPlugin.getColumns(modelTable));\n      const tableWalker = new TableWalker(modelTable);\n      for (const cellSlot of tableWalker) {\n        const viewCell = editor.editing.mapper.toViewElement(cellSlot.cell);\n        const domCell = editor.editing.view.domConverter.mapViewToDom(viewCell);\n        const domCellWidth = getDomCellOuterWidth(domCell);\n        if (!columnWidthsInPx[cellSlot.column] || domCellWidth < columnWidthsInPx[cellSlot.column]) {\n          columnWidthsInPx[cellSlot.column] = toPrecision(domCellWidth);\n        }\n      }\n      return columnWidthsInPx;\n    }\n    /**\n    * Creates a `<colgroup>` element with `<col>`s and inserts it into a given view table.\n    *\n    * @param viewWriter A writer instance.\n    * @param columnWidthsInPx Column widths.\n    * @param viewTable A table view element.\n    */\n    function _insertColgroupElement(viewWriter, columnWidthsInPx, viewTable) {\n      const colgroup = viewWriter.createContainerElement('colgroup');\n      for (let i = 0; i < columnWidthsInPx.length; i++) {\n        const viewColElement = viewWriter.createEmptyElement('col');\n        const columnWidthInPc = `${toPrecision(columnWidthsInPx[i] / sumArray(columnWidthsInPx) * 100)}%`;\n        viewWriter.setStyle('width', columnWidthInPc, viewColElement);\n        viewWriter.insert(viewWriter.createPositionAt(colgroup, 'end'), viewColElement);\n      }\n      viewWriter.insert(viewWriter.createPositionAt(viewTable, 0), colgroup);\n    }\n    /**\n    * Applies the style and classes to the view table as the resizing begun.\n    *\n    * @param viewWriter A writer instance.\n    * @param viewTable A table containing the clicked resizer.\n    * @param resizingData Data related to the resizing.\n    */\n    function _applyResizingAttributesToTable(viewWriter, viewTable, resizingData) {\n      const figureInitialPcWidth = resizingData.widths.viewFigureWidth / resizingData.widths.viewFigureParentWidth;\n      viewWriter.addClass('ck-table-resized', viewTable);\n      viewWriter.addClass('ck-table-column-resizer__active', resizingData.elements.viewResizer);\n      viewWriter.setStyle('width', `${toPrecision(figureInitialPcWidth * 100)}%`, viewTable.findAncestor('figure'));\n    }\n  }\n  /**\n  * Handles the `mousemove` event.\n  *  * If resizing process is not in progress, it does nothing.\n  *  * If resizing is active but not allowed, it stops the resizing process instantly calling the `mousedown` event handler.\n  *  * Otherwise it dynamically updates the widths of the resized columns.\n  *\n  * @param eventInfo An object containing information about the fired event.\n  * @param mouseEventData The native DOM event.\n  */\n  _onMouseMoveHandler(eventInfo, mouseEventData) {\n    if (this._initialMouseEventData) {\n      const mouseEvent = this._initialMouseEventData.domEvent;\n      const distanceX = Math.abs(mouseEventData.clientX - mouseEvent.clientX);\n      if (distanceX >= COLUMN_RESIZE_DISTANCE_THRESHOLD) {\n        this._startResizingAfterThreshold();\n        this._initialMouseEventData = null;\n      } else {\n        return;\n      }\n    }\n    if (!this._isResizingActive) {\n      return;\n    }\n    if (!this._isResizingAllowed) {\n      this._onMouseUpHandler();\n      return;\n    }\n    const {\n      columnPosition,\n      flags: {\n        isRightEdge,\n        isTableCentered,\n        isLtrContent\n      },\n      elements: {\n        viewFigure,\n        viewLeftColumn,\n        viewRightColumn,\n        viewResizer\n      },\n      widths: {\n        viewFigureParentWidth,\n        tableWidth,\n        leftColumnWidth,\n        rightColumnWidth\n      }\n    } = this._resizingData;\n    const dxLowerBound = -leftColumnWidth + COLUMN_MIN_WIDTH_IN_PIXELS;\n    const dxUpperBound = isRightEdge ? viewFigureParentWidth - tableWidth : rightColumnWidth - COLUMN_MIN_WIDTH_IN_PIXELS;\n    // The multiplier is needed for calculating the proper movement offset:\n    // - it should negate the sign if content language direction is right-to-left,\n    // - it should double the offset if the table edge is resized and table is centered.\n    const multiplier = (isLtrContent ? 1 : -1) * (isRightEdge && isTableCentered ? 2 : 1);\n    const dx = clamp((mouseEventData.clientX - columnPosition) * multiplier, Math.min(dxLowerBound, 0), Math.max(dxUpperBound, 0));\n    if (dx === 0) {\n      return;\n    }\n    this.editor.editing.view.change(writer => {\n      const leftColumnWidthAsPercentage = toPrecision((leftColumnWidth + dx) * 100 / tableWidth);\n      writer.setStyle('width', `${leftColumnWidthAsPercentage}%`, viewLeftColumn);\n      if (isRightEdge) {\n        const tableWidthAsPercentage = toPrecision((tableWidth + dx) * 100 / viewFigureParentWidth);\n        writer.setStyle('width', `${tableWidthAsPercentage}%`, viewFigure);\n      } else {\n        const rightColumnWidthAsPercentage = toPrecision((rightColumnWidth - dx) * 100 / tableWidth);\n        writer.setStyle('width', `${rightColumnWidthAsPercentage}%`, viewRightColumn);\n      }\n    });\n    this._recalculateResizerElement(viewResizer);\n  }\n  /**\n  * Handles the `mouseup` event.\n  *  * If resizing process is not in progress, it does nothing.\n  *  * If resizing is active but not allowed, it cancels the resizing process restoring the original widths.\n  *  * Otherwise it propagates the changes from view to the model by executing the adequate commands.\n  */\n  _onMouseUpHandler() {\n    this._initialMouseEventData = null;\n    if (!this._isResizingActive) {\n      return;\n    }\n    const {\n      viewResizer,\n      modelTable,\n      viewFigure,\n      viewColgroup\n    } = this._resizingData.elements;\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const tableColumnGroup = this.getColumnGroupElement(modelTable);\n    const viewColumns = Array.from(viewColgroup.getChildren()).filter(column => column.is('view:element'));\n    const columnWidthsAttributeOld = tableColumnGroup ? this.getTableColumnsWidths(tableColumnGroup) : null;\n    const columnWidthsAttributeNew = viewColumns.map(column => column.getStyle('width'));\n    const isColumnWidthsAttributeChanged = !isEqual(columnWidthsAttributeOld, columnWidthsAttributeNew);\n    const tableWidthAttributeOld = modelTable.getAttribute('tableWidth');\n    const tableWidthAttributeNew = viewFigure.getStyle('width');\n    const isTableWidthAttributeChanged = tableWidthAttributeOld !== tableWidthAttributeNew;\n    if (isColumnWidthsAttributeChanged || isTableWidthAttributeChanged) {\n      if (this._isResizingAllowed) {\n        editor.execute('resizeTableWidth', {\n          table: modelTable,\n          tableWidth: `${toPrecision(tableWidthAttributeNew)}%`,\n          columnWidths: columnWidthsAttributeNew\n        });\n      } else {\n        // In read-only mode revert all changes in the editing view. The model is not touched so it does not need to be restored.\n        // This case can occur if the read-only mode kicks in during the resizing process.\n        editingView.change(writer => {\n          // If table had resized columns before, restore the previous column widths.\n          // Otherwise clean up the view from the temporary column resizing markup.\n          if (columnWidthsAttributeOld) {\n            for (const viewCol of viewColumns) {\n              writer.setStyle('width', columnWidthsAttributeOld.shift(), viewCol);\n            }\n          } else {\n            writer.remove(viewColgroup);\n          }\n          if (isTableWidthAttributeChanged) {\n            // If the whole table was already resized before, restore the previous table width.\n            // Otherwise clean up the view from the temporary table resizing markup.\n            if (tableWidthAttributeOld) {\n              writer.setStyle('width', tableWidthAttributeOld, viewFigure);\n            } else {\n              writer.removeStyle('width', viewFigure);\n            }\n          }\n          // If a table and its columns weren't resized before,\n          // prune the remaining common resizing markup.\n          if (!columnWidthsAttributeOld && !tableWidthAttributeOld) {\n            writer.removeClass('ck-table-resized', [...viewFigure.getChildren()].find(element => element.name === 'table'));\n          }\n        });\n      }\n    }\n    editingView.change(writer => {\n      writer.removeClass('ck-table-column-resizer__active', viewResizer);\n    });\n    const element = editingView.domConverter.mapViewToDom(viewResizer);\n    if (!element.matches(':hover')) {\n      this._resetResizerStyles(viewResizer);\n    }\n    this._isResizingActive = false;\n    this._resizingData = null;\n  }\n  /**\n  * Retrieves and returns required data needed for the resizing process.\n  *\n  * @param domEventData The data of the `mousedown` event.\n  * @param columnWidths The current widths of the columns.\n  * @returns The data needed for the resizing process.\n  */\n  _getResizingData(domEventData, columnWidths) {\n    const editor = this.editor;\n    const columnPosition = domEventData.domEvent.clientX;\n    const viewResizer = domEventData.target;\n    const viewLeftCell = viewResizer.findAncestor('td') || viewResizer.findAncestor('th');\n    const modelLeftCell = editor.editing.mapper.toModelElement(viewLeftCell);\n    const modelTable = modelLeftCell.findAncestor('table');\n    const leftColumnIndex = getColumnEdgesIndexes(modelLeftCell, this._tableUtilsPlugin).rightEdge;\n    const lastColumnIndex = this._tableUtilsPlugin.getColumns(modelTable) - 1;\n    const isRightEdge = leftColumnIndex === lastColumnIndex;\n    const isTableCentered = !modelTable.hasAttribute('tableAlignment');\n    const isLtrContent = editor.locale.contentLanguageDirection !== 'rtl';\n    const viewTable = viewLeftCell.findAncestor('table');\n    const viewFigure = viewTable.findAncestor('figure');\n    const viewColgroup = [...viewTable.getChildren()].find(viewCol => viewCol.is('element', 'colgroup'));\n    const viewLeftColumn = viewColgroup.getChild(leftColumnIndex);\n    const viewRightColumn = isRightEdge ? undefined : viewColgroup.getChild(leftColumnIndex + 1);\n    const viewFigureParentWidth = getElementWidthInPixels(editor.editing.view.domConverter.mapViewToDom(viewFigure.parent));\n    const viewFigureWidth = getElementWidthInPixels(editor.editing.view.domConverter.mapViewToDom(viewFigure));\n    const tableWidth = getTableWidthInPixels(modelTable, editor);\n    const leftColumnWidth = columnWidths[leftColumnIndex];\n    const rightColumnWidth = isRightEdge ? undefined : columnWidths[leftColumnIndex + 1];\n    return {\n      columnPosition,\n      flags: {\n        isRightEdge,\n        isTableCentered,\n        isLtrContent\n      },\n      elements: {\n        viewResizer,\n        modelTable,\n        viewFigure,\n        viewColgroup,\n        viewLeftColumn,\n        viewRightColumn\n      },\n      widths: {\n        viewFigureParentWidth,\n        viewFigureWidth,\n        tableWidth,\n        leftColumnWidth,\n        rightColumnWidth\n      }\n    };\n  }\n  /**\n  * Registers a listener ensuring that each resizable cell have a resizer handle.\n  */\n  _registerResizerInserter() {\n    this.editor.conversion.for('editingDowncast').add(dispatcher => {\n      dispatcher.on('insert:tableCell', (evt, data, conversionApi) => {\n        const modelElement = data.item;\n        const viewElement = conversionApi.mapper.toViewElement(modelElement);\n        const viewWriter = conversionApi.writer;\n        viewWriter.insert(viewWriter.createPositionAt(viewElement, 'end'), viewWriter.createUIElement('div', {\n          class: 'ck-table-column-resizer'\n        }));\n      }, {\n        priority: 'lowest'\n      });\n    });\n  }\n}\n\n/**\n * The table column resize feature.\n *\n * It provides the possibility to set the width of each column in a table using a resize handler.\n */\nclass TableColumnResize extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableColumnResizeEditing, TableCellWidthEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableColumnResize';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n}\n\n/**\n * The set table type command.\n *\n * The command is registered by {@link module:table/tablelayout/tablelayoutediting~TableLayoutEditing}\n * as the `'tableType'` editor command.\n *\n * To set the table type at the current selection, execute the command and specify the table type:\n *\n * ```ts\n * editor.execute( 'tableType', 'layout' );\n * ```\n */\nclass TableTypeCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedTable = getSelectionAffectedTable(selection);\n    if (selectedTable) {\n      this.isEnabled = true;\n      this.value = selectedTable.getAttribute('tableType');\n    } else {\n      this.isEnabled = false;\n      this.value = null;\n    }\n  }\n  /**\n  * Executes the command.\n  *\n  * Set table type by the given table type parameter.\n  *\n  * @param tableType The type of table it should become.\n  * @fires execute\n  */\n  execute(tableType) {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    const table = getSelectionAffectedTable(selection);\n    const currentTableType = table.getAttribute('tableType');\n    if (currentTableType === tableType) {\n      return;\n    }\n    model.change(writer => {\n      writer.setAttribute('tableType', tableType, table);\n      model.schema.removeDisallowedAttributes([table], writer);\n      const tableChildren = table.getChildren();\n      // Check if all children are allowed for the new table type.\n      for (const child of tableChildren) {\n        if (!model.schema.checkChild(table, child)) {\n          writer.remove(child);\n        }\n      }\n    });\n  }\n}\nconst TABLE_TYPES = ['content', 'layout'];\n/**\n * The table layout editing plugin.\n */\nclass TableLayoutEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableLayoutEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableColumnResize];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    this._defineSchema();\n    this._defineConverters();\n    this._defineClipboardPasteHandlers();\n    this._registerTableTypeAttributePostfixer();\n    this.editor.commands.add('insertTableLayout', new InsertTableLayoutCommand(this.editor));\n    this.editor.commands.add('tableType', new TableTypeCommand(this.editor));\n  }\n  /**\n  * Defines the schema for the table layout feature.\n  */\n  _defineSchema() {\n    const {\n      schema\n    } = this.editor.model;\n    schema.extend('table', {\n      allowAttributes: 'tableType'\n    });\n    // Disallow adding `caption` to layout table.\n    schema.addChildCheck(layoutTableCheck, 'caption');\n    // Disallow adding `headingRows` attribute to layout table.\n    schema.addAttributeCheck(layoutTableCheck, 'headingRows');\n    // Disallow adding `headingColumns` attribute to layout table.\n    schema.addAttributeCheck(layoutTableCheck, 'headingColumns');\n  }\n  /**\n  * Defines the converters for the table layout feature.\n  */\n  _defineConverters() {\n    const {\n      editor\n    } = this;\n    const {\n      conversion\n    } = editor;\n    const preferredExternalTableType = editor.config.get('table.tableLayout.preferredExternalTableType');\n    conversion.for('upcast').add(upcastLayoutTable(preferredExternalTableType));\n    conversion.for('dataDowncast').add(dataDowncastLayoutTable());\n    conversion.for('editingDowncast').attributeToAttribute({\n      model: {\n        key: 'tableType',\n        values: ['layout', 'content']\n      },\n      view: {\n        layout: {\n          key: 'class',\n          value: ['layout-table']\n        },\n        content: {\n          key: 'class',\n          value: ['content-table']\n        }\n      }\n    });\n  }\n  /**\n  * Handles the clipboard content insertion events.\n  *\n  * - If the content is from another editor, do not override the table type.\n  * - If the content is from another source, set the table type to 'content'.\n  *\n  * It handles the scenario when user copies `<table></table>` from Word. We do not want to\n  * change the table type to `layout` because it is really `content` table.\n  */\n  _defineClipboardPasteHandlers() {\n    const {\n      plugins\n    } = this.editor;\n    if (!plugins.has('ClipboardPipeline')) {\n      return;\n    }\n    const clipboardPipeline = plugins.get('ClipboardPipeline');\n    this.listenTo(clipboardPipeline, 'contentInsertion', (evt, data) => {\n      // If content is pasted from the other editor, skip overriding table type.\n      if (data.sourceEditorId) {\n        return;\n      }\n      // For content from other sources, always set table type to 'content'.\n      this.editor.model.change(writer => {\n        for (const {\n          item\n        } of writer.createRangeIn(data.content)) {\n          if (item.is('element', 'table')) {\n            writer.setAttribute('tableType', 'content', item);\n          }\n        }\n      });\n    });\n  }\n  /**\n  * Registers a post-fixer that sets the `tableType` attribute to `content` for inserted \"default\" tables.\n  * Also fixes potential issues with the table structure when the `tableType` attribute has been changed.\n  */\n  _registerTableTypeAttributePostfixer() {\n    const editor = this.editor;\n    editor.model.document.registerPostFixer(writer => {\n      const changes = editor.model.document.differ.getChanges();\n      let hasChanged = false;\n      for (const entry of changes) {\n        if (entry.type == 'insert' && entry.name != '$text') {\n          const element = entry.position.nodeAfter;\n          const range = writer.createRangeOn(element);\n          for (const item of range.getItems()) {\n            if (item.is('element', 'table') && !item.hasAttribute('tableType')) {\n              writer.setAttribute('tableType', 'content', item);\n              hasChanged = true;\n            }\n          }\n        }\n        // Remove disallowed attributes and children for layout tables\n        // when `tableType` attribute has been changed by `TableTypeCommand`.\n        if (entry.type == 'attribute' && entry.attributeKey == 'tableType') {\n          for (const item of entry.range.getItems()) {\n            if (item.is('element', 'table')) {\n              editor.model.schema.removeDisallowedAttributes([item], writer);\n              const tableChildren = item.getChildren();\n              // Check if all children are allowed for the new table type.\n              for (const child of tableChildren) {\n                if (!editor.model.schema.checkChild(item, child)) {\n                  writer.remove(child);\n                  hasChanged = true;\n                }\n              }\n            }\n          }\n        }\n      }\n      return hasChanged;\n    });\n  }\n}\n/**\n * View table element to model table element conversion helper.\n *\n * This conversion helper overrides the default table converter to meet table layout conditions.\n *\n * @returns Conversion helper.\n */\nfunction upcastLayoutTable(preferredExternalTableType) {\n  return dispatcher => {\n    dispatcher.on('element:table', (evt, data, conversionApi) => {\n      const viewTable = data.viewItem;\n      if (!conversionApi.consumable.test(viewTable, {\n        name: true\n      })) {\n        return;\n      }\n      const resolvedTableType = resolveTableType(viewTable, preferredExternalTableType);\n      // When an element is a content table, then skip it.\n      if (resolvedTableType == 'content') {\n        return;\n      }\n      const table = conversionApi.writer.createElement('table', {\n        tableType: 'layout'\n      });\n      if (!conversionApi.safeInsert(table, data.modelCursor)) {\n        return;\n      }\n      conversionApi.consumable.consume(viewTable, {\n        name: true\n      });\n      conversionApi.consumable.consume(viewTable, {\n        attributes: ['role']\n      });\n      conversionApi.consumable.consume(viewTable, {\n        classes: ['layout-table']\n      });\n      // Get all rows from the table and convert them.\n      // While looping over the children of `<table>` we can be sure that first will be `<tbody>`\n      // and optionally `<thead>` and `<tfoot>`, and in these elements are the table rows found.\n      // We can be sure of that because of `DomParser` handle it.\n      for (const tableChild of viewTable.getChildren()) {\n        if (tableChild.is('element')) {\n          for (const row of tableChild.getChildren()) {\n            if (row.is('element', 'tr')) {\n              conversionApi.convertItem(row, conversionApi.writer.createPositionAt(table, 'end'));\n            }\n          }\n        }\n      }\n      // Convert everything else.\n      conversionApi.convertChildren(viewTable, conversionApi.writer.createPositionAt(table, 'end'));\n      // Create one row and one table cell for empty table.\n      if (table.isEmpty) {\n        const row = conversionApi.writer.createElement('tableRow');\n        conversionApi.writer.insert(row, conversionApi.writer.createPositionAt(table, 'end'));\n        createEmptyTableCell(conversionApi.writer, conversionApi.writer.createPositionAt(row, 'end'));\n      }\n      conversionApi.updateConversionResult(table, data);\n    }, {\n      priority: 'high'\n    });\n    // Sets only the table type attribute.\n    dispatcher.on('element:table', (evt, data, conversionApi) => {\n      const {\n        viewItem,\n        modelRange\n      } = data;\n      if (modelRange) {\n        conversionApi.writer.setAttribute('tableType', resolveTableType(viewItem, preferredExternalTableType), modelRange);\n        conversionApi.consumable.consume(viewItem, {\n          classes: ['layout-table']\n        });\n        conversionApi.consumable.consume(viewItem, {\n          classes: ['content-table']\n        });\n      }\n    }, {\n      priority: 'low'\n    });\n  };\n}\n/**\n * Model table container element to view table element conversion helper.\n *\n * @returns Conversion helper.\n */\nfunction dataDowncastLayoutTable() {\n  return dispatcher => {\n    return dispatcher.on('attribute:tableType:table', (evt, data, conversionApi) => {\n      const {\n        item,\n        attributeNewValue\n      } = data;\n      const {\n        mapper,\n        writer\n      } = conversionApi;\n      if (!conversionApi.consumable.test(item, evt.name)) {\n        return;\n      }\n      const table = mapper.toViewElement(item);\n      writer.addClass(`${attributeNewValue}-table`, table);\n      if (attributeNewValue == 'layout') {\n        writer.setAttribute('role', 'presentation', table);\n      }\n      conversionApi.consumable.consume(item, evt.name);\n    });\n  };\n}\n/**\n * Resolves the table type based on the view table element and the preferred external table type.\n */\nfunction resolveTableType(viewTable, preferredExternalTableType) {\n  if (viewTable.hasClass('content-table')) {\n    return 'content';\n  }\n  if (viewTable.hasClass('layout-table')) {\n    return 'layout';\n  }\n  if (preferredExternalTableType && TABLE_TYPES.includes(preferredExternalTableType)) {\n    return preferredExternalTableType;\n  }\n  const parent = viewTable.parent;\n  /**\n  * Checks if the table is a content table if any of the following conditions are met:\n  * - the `<table>` is wrapped with `<figure>`,\n  * - the `<table>` has a `<caption>` element.\n  */\n  if (parent.is('element', 'figure') || Array.from(viewTable.getChildren()).some(child => child.is('element', 'caption'))) {\n    return 'content';\n  }\n  return 'layout';\n}\n/**\n * Checks if the element is a layout table.\n * It is used to disallow attributes or children that is managed by `Schema`.\n */\nfunction layoutTableCheck(context) {\n  if (context.endsWith('table') && context.last.getAttribute('tableType') == 'layout') {\n    return false;\n  }\n}\n\n/**\n * The table plugin.\n *\n * For a detailed overview, check the {@glink features/tables/layout-tables Layout table feature documentation}.\n */\nclass TableLayout extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableLayout';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [PlainTableOutput, TableColumnResize, TableLayoutEditing, TableLayoutUI];\n  }\n}\n\n/**\n * The table cell attribute command.\n *\n * This command is a base command for other table property commands.\n */\nclass TablePropertyCommand extends Command {\n  /**\n  * The attribute that will be set by the command.\n  */\n  attributeName;\n  /**\n  * The default value for the attribute.\n  *\n  * @readonly\n  */\n  _defaultValue;\n  /**\n  * The default value for the attribute for the content table.\n  */\n  _defaultContentTableValue;\n  /**\n  * The default value for the attribute for the layout table.\n  */\n  _defaultLayoutTableValue;\n  /**\n  * Creates a new `TablePropertyCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param attributeName Table cell attribute name.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, attributeName, defaultValue) {\n    super(editor);\n    this.attributeName = attributeName;\n    this._defaultContentTableValue = defaultValue;\n    this._defaultLayoutTableValue = attributeName === 'tableBorderStyle' ? 'none' : undefined;\n  }\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const selection = editor.model.document.selection;\n    const table = getSelectionAffectedTable(selection);\n    this._defaultValue = !table || table.getAttribute('tableType') !== 'layout' ? this._defaultContentTableValue : this._defaultLayoutTableValue;\n    this.isEnabled = !!table;\n    this.value = this._getValue(table);\n  }\n  /**\n  * Executes the command.\n  *\n  * @fires execute\n  * @param options.value If set, the command will set the attribute on the selected table.\n  * If not set, the command will remove the attribute from the selected table.\n  * @param options.batch Pass the model batch instance to the command to aggregate changes,\n  * for example, to allow a single undo step for multiple executions.\n  */\n  execute(options = {}) {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const {\n      value,\n      batch\n    } = options;\n    const table = getSelectionAffectedTable(selection);\n    const valueToSet = this._getValueToSet(value);\n    model.enqueueChange(batch, writer => {\n      if (valueToSet) {\n        writer.setAttribute(this.attributeName, valueToSet, table);\n      } else {\n        writer.removeAttribute(this.attributeName, table);\n      }\n    });\n  }\n  /**\n  * Returns the attribute value for a table.\n  */\n  _getValue(table) {\n    if (!table) {\n      return;\n    }\n    const value = table.getAttribute(this.attributeName);\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n  /**\n  * Returns the proper model value. It can be used to add a default unit to numeric values.\n  */\n  _getValueToSet(value) {\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n}\n\n/**\n * The table background color command.\n *\n * The command is registered by the {@link module:table/tableproperties/tablepropertiesediting~TablePropertiesEditing} as\n * the `'tableBackgroundColor'` editor command.\n *\n * To change the background color of the selected table, execute the command:\n *\n * ```ts\n * editor.execute( 'tableBackgroundColor', {\n *   value: '#f00'\n * } );\n * ```\n */\nclass TableBackgroundColorCommand extends TablePropertyCommand {\n  /**\n  * Creates a new `TableBackgroundColorCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableBackgroundColor', defaultValue);\n  }\n}\n\n/**\n * The table border color command.\n *\n * The command is registered by the {@link module:table/tableproperties/tablepropertiesediting~TablePropertiesEditing} as\n * the `'tableBorderColor'` editor command.\n *\n * To change the border color of the selected table, execute the command:\n *\n * ```ts\n * editor.execute( 'tableBorderColor', {\n *   value: '#f00'\n * } );\n * ```\n */\nclass TableBorderColorCommand extends TablePropertyCommand {\n  /**\n  * Creates a new `TableBorderColorCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableBorderColor', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValue(table) {\n    if (!table) {\n      return;\n    }\n    const value = getSingleValue(table.getAttribute(this.attributeName));\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n}\n\n/**\n * The table style border command.\n *\n * The command is registered by the {@link module:table/tableproperties/tablepropertiesediting~TablePropertiesEditing} as\n * the `'tableBorderStyle'` editor command.\n *\n * To change the border style of the selected table, execute the command:\n *\n * ```ts\n * editor.execute( 'tableBorderStyle', {\n *   value: 'dashed'\n * } );\n * ```\n */\nclass TableBorderStyleCommand extends TablePropertyCommand {\n  /**\n  * Creates a new `TableBorderStyleCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableBorderStyle', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValue(table) {\n    if (!table) {\n      return;\n    }\n    const value = getSingleValue(table.getAttribute(this.attributeName));\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n}\n\n/**\n * The table width border command.\n *\n * The command is registered by the {@link module:table/tableproperties/tablepropertiesediting~TablePropertiesEditing} as\n * the `'tableBorderWidth'` editor command.\n *\n * To change the border width of the selected table, execute the command:\n *\n * ```ts\n * editor.execute( 'tableBorderWidth', {\n *   value: '5px'\n * } );\n * ```\n *\n * **Note**: This command adds the default `'px'` unit to numeric values. Executing:\n *\n * ```ts\n * editor.execute( 'tableBorderWidth', {\n *   value: '5'\n * } );\n * ```\n *\n * will set the `borderWidth` attribute to `'5px'` in the model.\n */\nclass TableBorderWidthCommand extends TablePropertyCommand {\n  /**\n  * Creates a new `TableBorderWidthCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableBorderWidth', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValue(table) {\n    if (!table) {\n      return;\n    }\n    const value = getSingleValue(table.getAttribute(this.attributeName));\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValueToSet(value) {\n    const newValue = addDefaultUnitToNumericValue(value, 'px');\n    if (newValue === this._defaultValue) {\n      return;\n    }\n    return newValue;\n  }\n}\n\n/**\n * The table width command.\n *\n * The command is registered by the {@link module:table/tableproperties/tablepropertiesediting~TablePropertiesEditing} as\n * the `'tableWidth'` editor command.\n *\n * To change the width of the selected table, execute the command:\n *\n * ```ts\n * editor.execute( 'tableWidth', {\n *   value: '400px'\n * } );\n * ```\n *\n * **Note**: This command adds the default `'px'` unit to numeric values. Executing:\n *\n * ```ts\n * editor.execute( 'tableWidth', {\n *   value: '50'\n * } );\n * ```\n *\n * will set the `width` attribute to `'50px'` in the model.\n */\nclass TableWidthCommand extends TablePropertyCommand {\n  /**\n  * Creates a new `TableWidthCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableWidth', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValueToSet(value) {\n    value = addDefaultUnitToNumericValue(value, 'px');\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n}\n\n/**\n * The table height command.\n *\n * The command is registered by the {@link module:table/tableproperties/tablepropertiesediting~TablePropertiesEditing} as\n * the `'tableHeight'` editor command.\n *\n * To change the height of the selected table, execute the command:\n *\n * ```ts\n * editor.execute( 'tableHeight', {\n *   value: '500px'\n * } );\n * ```\n *\n * **Note**: This command adds the default `'px'` unit to numeric values. Executing:\n *\n * ```ts\n * editor.execute( 'tableHeight', {\n *   value: '50'\n * } );\n * ```\n *\n * will set the `height` attribute to `'50px'` in the model.\n */\nclass TableHeightCommand extends TablePropertyCommand {\n  /**\n  * Creates a new `TableHeightCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value of the attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableHeight', defaultValue);\n  }\n  /**\n  * @inheritDoc\n  */\n  _getValueToSet(value) {\n    value = addDefaultUnitToNumericValue(value, 'px');\n    if (value === this._defaultValue) {\n      return;\n    }\n    return value;\n  }\n}\n\n/**\n * The table alignment command.\n *\n * The command is registered by the {@link module:table/tableproperties/tablepropertiesediting~TablePropertiesEditing} as\n * the `'tableAlignment'` editor command.\n *\n * To change the alignment of the selected table, execute the command:\n *\n * ```ts\n * editor.execute( 'tableAlignment', {\n *   value: 'right'\n * } );\n * ```\n */\nclass TableAlignmentCommand extends TablePropertyCommand {\n  /**\n  * Creates a new `TableAlignmentCommand` instance.\n  *\n  * @param editor An editor in which this command will be used.\n  * @param defaultValue The default value for the \"alignment\" attribute.\n  */\n  constructor(editor, defaultValue) {\n    super(editor, 'tableAlignment', defaultValue);\n  }\n}\nconst ALIGN_VALUES_REG_EXP = /^(left|center|right)$/;\nconst FLOAT_VALUES_REG_EXP = /^(left|none|right)$/;\n/**\n * The table properties editing feature.\n *\n * Introduces table's model attributes and their conversion:\n *\n * - border: `tableBorderStyle`, `tableBorderColor` and `tableBorderWidth`\n * - background color: `tableBackgroundColor`\n * - horizontal alignment: `tableAlignment`\n * - width & height: `tableWidth` & `tableHeight`\n *\n * It also registers commands used to manipulate the above attributes:\n *\n * - border: `'tableBorderStyle'`, `'tableBorderColor'` and `'tableBorderWidth'` commands\n * - background color: `'tableBackgroundColor'`\n * - horizontal alignment: `'tableAlignment'`\n * - width & height: `'tableWidth'` & `'tableHeight'`\n */\nclass TablePropertiesEditing extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TablePropertiesEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableEditing];\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const conversion = editor.conversion;\n    editor.config.define('table.tableProperties.defaultProperties', {});\n    const defaultTableProperties = getNormalizedDefaultTableProperties(editor.config.get('table.tableProperties.defaultProperties'), {\n      includeAlignmentProperty: true\n    });\n    editor.data.addStyleProcessorRules(addBorderRules);\n    enableBorderProperties(schema, conversion, {\n      color: defaultTableProperties.borderColor,\n      style: defaultTableProperties.borderStyle,\n      width: defaultTableProperties.borderWidth\n    });\n    editor.commands.add('tableBorderColor', new TableBorderColorCommand(editor, defaultTableProperties.borderColor));\n    editor.commands.add('tableBorderStyle', new TableBorderStyleCommand(editor, defaultTableProperties.borderStyle));\n    editor.commands.add('tableBorderWidth', new TableBorderWidthCommand(editor, defaultTableProperties.borderWidth));\n    enableAlignmentProperty(schema, conversion, defaultTableProperties.alignment);\n    editor.commands.add('tableAlignment', new TableAlignmentCommand(editor, defaultTableProperties.alignment));\n    enableTableToFigureProperty(schema, conversion, {\n      modelAttribute: 'tableWidth',\n      styleName: 'width',\n      defaultValue: defaultTableProperties.width\n    });\n    editor.commands.add('tableWidth', new TableWidthCommand(editor, defaultTableProperties.width));\n    enableTableToFigureProperty(schema, conversion, {\n      modelAttribute: 'tableHeight',\n      styleName: 'height',\n      defaultValue: defaultTableProperties.height\n    });\n    editor.commands.add('tableHeight', new TableHeightCommand(editor, defaultTableProperties.height));\n    editor.data.addStyleProcessorRules(addBackgroundRules);\n    enableProperty(schema, conversion, {\n      modelAttribute: 'tableBackgroundColor',\n      styleName: 'background-color',\n      defaultValue: defaultTableProperties.backgroundColor\n    });\n    editor.commands.add('tableBackgroundColor', new TableBackgroundColorCommand(editor, defaultTableProperties.backgroundColor));\n  }\n}\n/**\n * Enables `tableBorderStyle'`, `tableBorderColor'` and `tableBorderWidth'` attributes for table.\n *\n * @param defaultBorder The default border values.\n * @param defaultBorder.color The default `tableBorderColor` value.\n * @param defaultBorder.style The default `tableBorderStyle` value.\n * @param defaultBorder.width The default `tableBorderWidth` value.\n */\nfunction enableBorderProperties(schema, conversion, defaultBorder) {\n  const modelAttributes = {\n    width: 'tableBorderWidth',\n    color: 'tableBorderColor',\n    style: 'tableBorderStyle'\n  };\n  schema.extend('table', {\n    allowAttributes: Object.values(modelAttributes)\n  });\n  upcastBorderStyles(conversion, 'table', modelAttributes, defaultBorder);\n  downcastTableAttribute(conversion, {\n    modelAttribute: modelAttributes.color,\n    styleName: 'border-color'\n  });\n  downcastTableAttribute(conversion, {\n    modelAttribute: modelAttributes.style,\n    styleName: 'border-style'\n  });\n  downcastTableAttribute(conversion, {\n    modelAttribute: modelAttributes.width,\n    styleName: 'border-width'\n  });\n}\n/**\n * Enables the `'alignment'` attribute for table.\n *\n * @param defaultValue The default alignment value.\n */\nfunction enableAlignmentProperty(schema, conversion, defaultValue) {\n  schema.extend('table', {\n    allowAttributes: ['tableAlignment']\n  });\n  conversion.for('downcast').attributeToAttribute({\n    model: {\n      name: 'table',\n      key: 'tableAlignment',\n      values: ['left', 'center', 'right']\n    },\n    view: {\n      left: {\n        key: 'style',\n        value: {\n          float: 'left'\n        }\n      },\n      right: {\n        key: 'style',\n        value: {\n          float: 'right'\n        }\n      },\n      center: (alignment, conversionApi, data) => {\n        const value = data.item.getAttribute('tableType') !== 'layout' ? {\n          // Model: `alignment:center` => CSS: `float:none`.\n          float: 'none'\n        } : {\n          'margin-left': 'auto',\n          'margin-right': 'auto'\n        };\n        return {\n          key: 'style',\n          value\n        };\n      }\n    },\n    converterPriority: 'high'\n  });\n  conversion.for('upcast') // Support for the `float:*;` CSS definition for the table alignment.\n  .attributeToAttribute({\n    view: {\n      name: /^(table|figure)$/,\n      styles: {\n        float: FLOAT_VALUES_REG_EXP\n      }\n    },\n    model: {\n      key: 'tableAlignment',\n      value: (viewElement, conversionApi, data) => {\n        const localDefaultValue = getDefaultValueAdjusted(defaultValue, '', data);\n        let align = viewElement.getStyle('float');\n        // CSS: `float:none` => Model: `alignment:center`.\n        if (align === 'none') {\n          align = 'center';\n        }\n        return align === localDefaultValue ? null : align;\n      }\n    }\n  }) // Support for the `margin-left:auto; margin-right:auto;` CSS definition for the table alignment.\n  .attributeToAttribute({\n    view: {\n      name: /^(table|figure)$/,\n      styles: {\n        'margin-left': 'auto',\n        'margin-right': 'auto'\n      }\n    },\n    model: {\n      key: 'tableAlignment',\n      value: (viewElement, conversionApi, data) => {\n        const localDefaultValue = getDefaultValueAdjusted(defaultValue, '', data);\n        const align = 'center';\n        return align === localDefaultValue ? null : align;\n      }\n    }\n  }) // Support for the `align` attribute as the backward compatibility while pasting from other sources.\n  .attributeToAttribute({\n    view: {\n      attributes: {\n        align: ALIGN_VALUES_REG_EXP\n      }\n    },\n    model: {\n      name: 'table',\n      key: 'tableAlignment',\n      value: (viewElement, conversionApi, data) => {\n        const localDefaultValue = getDefaultValueAdjusted(defaultValue, '', data);\n        const align = viewElement.getAttribute('align');\n        return align === localDefaultValue ? null : align;\n      }\n    }\n  });\n}\n/**\n * Enables conversion for an attribute for simple view-model mappings.\n *\n * @param options.defaultValue The default value for the specified `modelAttribute`.\n */\nfunction enableProperty(schema, conversion, options) {\n  const {\n    modelAttribute\n  } = options;\n  schema.extend('table', {\n    allowAttributes: [modelAttribute]\n  });\n  upcastStyleToAttribute(conversion, {\n    viewElement: 'table',\n    ...options\n  });\n  downcastTableAttribute(conversion, options);\n}\n/**\n * Enables conversion for an attribute for simple view (figure) to model (table) mappings.\n */\nfunction enableTableToFigureProperty(schema, conversion, options) {\n  const {\n    modelAttribute\n  } = options;\n  schema.extend('table', {\n    allowAttributes: [modelAttribute]\n  });\n  upcastStyleToAttribute(conversion, {\n    viewElement: /^(table|figure)$/,\n    shouldUpcast: element => !(element.name == 'table' && element.parent.name == 'figure'),\n    ...options\n  });\n  downcastAttributeToStyle(conversion, {\n    modelElement: 'table',\n    ...options\n  });\n}\n\n/**\n * The class representing a table properties form, allowing users to customize\n * certain style aspects of a table, for instance, border, background color, alignment, etc..\n */\nclass TablePropertiesView extends View {\n  /**\n  * Options passed to the view. See {@link #constructor} to learn more.\n  */\n  options;\n  /**\n  * Tracks information about the DOM focus in the form.\n  */\n  focusTracker;\n  /**\n  * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n  */\n  keystrokes;\n  /**\n  * A collection of child views in the form.\n  */\n  children;\n  /**\n  * A dropdown that allows selecting the style of the table border.\n  */\n  borderStyleDropdown;\n  /**\n  * An input that allows specifying the width of the table border.\n  */\n  borderWidthInput;\n  /**\n  * An input that allows specifying the color of the table border.\n  */\n  borderColorInput;\n  /**\n  * An input that allows specifying the table background color.\n  */\n  backgroundInput;\n  /**\n  * An input that allows specifying the table width.\n  */\n  widthInput;\n  /**\n  * An input that allows specifying the table height.\n  */\n  heightInput;\n  /**\n  * A toolbar with buttons that allow changing the alignment of an entire table.\n  */\n  alignmentToolbar;\n  /**\n  * The \"Save\" button view.\n  */\n  saveButtonView;\n  /**\n  * The \"Cancel\" button view.\n  */\n  cancelButtonView;\n  /**\n  * A collection of views that can be focused in the form.\n  */\n  _focusables;\n  /**\n  * Helps cycling over {@link #_focusables} in the form.\n  */\n  _focusCycler;\n  /**\n  * @param locale The {@link module:core/editor/editor~Editor#locale} instance.\n  * @param options Additional configuration of the view.\n  */\n  constructor(locale, options) {\n    super(locale);\n    this.set({\n      borderStyle: '',\n      borderWidth: '',\n      borderColor: '',\n      backgroundColor: '',\n      width: '',\n      height: '',\n      alignment: ''\n    });\n    this.options = options;\n    const {\n      borderStyleDropdown,\n      borderWidthInput,\n      borderColorInput,\n      borderRowLabel\n    } = this._createBorderFields();\n    const {\n      backgroundRowLabel,\n      backgroundInput\n    } = this._createBackgroundFields();\n    const {\n      widthInput,\n      operatorLabel,\n      heightInput,\n      dimensionsLabel\n    } = this._createDimensionFields();\n    const {\n      alignmentToolbar,\n      alignmentLabel\n    } = this._createAlignmentFields();\n    this.focusTracker = new FocusTracker();\n    this.keystrokes = new KeystrokeHandler();\n    this.children = this.createCollection();\n    this.borderStyleDropdown = borderStyleDropdown;\n    this.borderWidthInput = borderWidthInput;\n    this.borderColorInput = borderColorInput;\n    this.backgroundInput = backgroundInput;\n    this.widthInput = widthInput;\n    this.heightInput = heightInput;\n    this.alignmentToolbar = alignmentToolbar;\n    // Defer creating to make sure other fields are present and the Save button can\n    // bind its #isEnabled to their error messages so there's no way to save unless all\n    // fields are valid.\n    const {\n      saveButtonView,\n      cancelButtonView\n    } = this._createActionButtons();\n    this.saveButtonView = saveButtonView;\n    this.cancelButtonView = cancelButtonView;\n    this._focusables = new ViewCollection();\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: 'shift + tab',\n        // Navigate form fields forwards using the Tab key.\n        focusNext: 'tab'\n      }\n    });\n    // Form header.\n    this.children.add(new FormHeaderView(locale, {\n      label: this.t('Table properties')\n    }));\n    // Border row.\n    this.children.add(new FormRowView(locale, {\n      labelView: borderRowLabel,\n      children: [borderRowLabel, borderStyleDropdown, borderColorInput, borderWidthInput],\n      class: 'ck-table-form__border-row'\n    }));\n    // Background row.\n    this.children.add(new FormRowView(locale, {\n      labelView: backgroundRowLabel,\n      children: [backgroundRowLabel, backgroundInput],\n      class: 'ck-table-form__background-row'\n    }));\n    this.children.add(new FormRowView(locale, {\n      children: [\n      // Dimensions row.\n      new FormRowView(locale, {\n        labelView: dimensionsLabel,\n        children: [dimensionsLabel, widthInput, operatorLabel, heightInput],\n        class: 'ck-table-form__dimensions-row'\n      }),\n      // Alignment row.\n      new FormRowView(locale, {\n        labelView: alignmentLabel,\n        children: [alignmentLabel, alignmentToolbar],\n        class: 'ck-table-properties-form__alignment-row'\n      })]\n    }));\n    // Action row.\n    this.children.add(new FormRowView(locale, {\n      children: [this.saveButtonView, this.cancelButtonView],\n      class: 'ck-table-form__action-row'\n    }));\n    this.setTemplate({\n      tag: 'form',\n      attributes: {\n        class: ['ck', 'ck-form', 'ck-table-form', 'ck-table-properties-form'],\n        // https://github.com/ckeditor/ckeditor5-link/issues/90\n        tabindex: '-1'\n      },\n      children: this.children\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  render() {\n    super.render();\n    // Enable the \"submit\" event for this view. It can be triggered by the #saveButtonView\n    // which is of the \"submit\" DOM \"type\".\n    submitHandler({\n      view: this\n    });\n    // Maintain continuous focus cycling over views that have focusable children and focus cyclers themselves.\n    [this.borderColorInput, this.backgroundInput].forEach(view => {\n      this._focusCycler.chain(view.fieldView.focusCycler);\n    });\n    [this.borderStyleDropdown, this.borderColorInput, this.borderWidthInput, this.backgroundInput, this.widthInput, this.heightInput, this.alignmentToolbar, this.saveButtonView, this.cancelButtonView].forEach(view => {\n      // Register the view as focusable.\n      this._focusables.add(view);\n      // Register the view in the focus tracker.\n      this.focusTracker.add(view.element);\n    });\n    // Mainly for closing using \"Esc\" and navigation using \"Tab\".\n    this.keystrokes.listenTo(this.element);\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n  /**\n  * Focuses the fist focusable field in the form.\n  */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n  /**\n  * Creates the following form fields:\n  *\n  * * {@link #borderStyleDropdown},\n  * * {@link #borderWidthInput},\n  * * {@link #borderColorInput}.\n  */\n  _createBorderFields() {\n    const defaultTableProperties = this.options.defaultTableProperties;\n    const defaultBorder = {\n      style: defaultTableProperties.borderStyle,\n      width: defaultTableProperties.borderWidth,\n      color: defaultTableProperties.borderColor\n    };\n    const colorInputCreator = getLabeledColorInputCreator({\n      colorConfig: this.options.borderColors,\n      columns: 5,\n      defaultColorValue: defaultBorder.color,\n      colorPickerConfig: this.options.colorPickerConfig\n    });\n    const locale = this.locale;\n    const t = this.t;\n    const accessibleLabel = t('Style');\n    // -- Group label ---------------------------------------------\n    const borderRowLabel = new LabelView(locale);\n    borderRowLabel.text = t('Border');\n    // -- Style ---------------------------------------------------\n    const styleLabels = getBorderStyleLabels(t);\n    const borderStyleDropdown = new LabeledFieldView(locale, createLabeledDropdown);\n    borderStyleDropdown.set({\n      label: accessibleLabel,\n      class: 'ck-table-form__border-style'\n    });\n    borderStyleDropdown.fieldView.buttonView.set({\n      ariaLabel: accessibleLabel,\n      ariaLabelledBy: undefined,\n      isOn: false,\n      withText: true,\n      tooltip: accessibleLabel\n    });\n    borderStyleDropdown.fieldView.buttonView.bind('label').to(this, 'borderStyle', value => {\n      return styleLabels[value ? value : 'none'];\n    });\n    borderStyleDropdown.fieldView.on('execute', evt => {\n      this.borderStyle = evt.source._borderStyleValue;\n    });\n    borderStyleDropdown.bind('isEmpty').to(this, 'borderStyle', value => !value);\n    addListToDropdown(borderStyleDropdown.fieldView, getBorderStyleDefinitions(this, defaultBorder.style), {\n      role: 'menu',\n      ariaLabel: accessibleLabel\n    });\n    // -- Width ---------------------------------------------------\n    const borderWidthInput = new LabeledFieldView(locale, createLabeledInputText);\n    borderWidthInput.set({\n      label: t('Width'),\n      class: 'ck-table-form__border-width'\n    });\n    borderWidthInput.fieldView.bind('value').to(this, 'borderWidth');\n    borderWidthInput.bind('isEnabled').to(this, 'borderStyle', isBorderStyleSet);\n    borderWidthInput.fieldView.on('input', () => {\n      this.borderWidth = borderWidthInput.fieldView.element.value;\n    });\n    // -- Color ---------------------------------------------------\n    const borderColorInput = new LabeledFieldView(locale, colorInputCreator);\n    borderColorInput.set({\n      label: t('Color'),\n      class: 'ck-table-form__border-color'\n    });\n    borderColorInput.fieldView.bind('value').to(this, 'borderColor');\n    borderColorInput.bind('isEnabled').to(this, 'borderStyle', isBorderStyleSet);\n    borderColorInput.fieldView.on('input', () => {\n      this.borderColor = borderColorInput.fieldView.value;\n    });\n    // Reset the border color and width fields depending on the `border-style` value.\n    this.on('change:borderStyle', (evt, name, newValue, oldValue) => {\n      // When removing the border (`border-style:none`), clear the remaining `border-*` properties.\n      // See: https://github.com/ckeditor/ckeditor5/issues/6227.\n      if (!isBorderStyleSet(newValue)) {\n        this.borderColor = '';\n        this.borderWidth = '';\n      }\n      // When setting the `border-style` from `none`, set the default `border-color` and `border-width` properties.\n      if (!isBorderStyleSet(oldValue)) {\n        this.borderColor = defaultBorder.color;\n        this.borderWidth = defaultBorder.width;\n      }\n    });\n    return {\n      borderRowLabel,\n      borderStyleDropdown,\n      borderColorInput,\n      borderWidthInput\n    };\n  }\n  /**\n  * Creates the following form fields:\n  *\n  * * {@link #backgroundInput}.\n  */\n  _createBackgroundFields() {\n    const locale = this.locale;\n    const t = this.t;\n    // -- Group label ---------------------------------------------\n    const backgroundRowLabel = new LabelView(locale);\n    backgroundRowLabel.text = t('Background');\n    // -- Background color input -----------------------------------\n    const backgroundInputCreator = getLabeledColorInputCreator({\n      colorConfig: this.options.backgroundColors,\n      columns: 5,\n      defaultColorValue: this.options.defaultTableProperties.backgroundColor,\n      colorPickerConfig: this.options.colorPickerConfig\n    });\n    const backgroundInput = new LabeledFieldView(locale, backgroundInputCreator);\n    backgroundInput.set({\n      label: t('Color'),\n      class: 'ck-table-properties-form__background'\n    });\n    backgroundInput.fieldView.bind('value').to(this, 'backgroundColor');\n    backgroundInput.fieldView.on('input', () => {\n      this.backgroundColor = backgroundInput.fieldView.value;\n    });\n    return {\n      backgroundRowLabel,\n      backgroundInput\n    };\n  }\n  /**\n  * Creates the following form fields:\n  *\n  * * {@link #widthInput},\n  * * {@link #heightInput}.\n  */\n  _createDimensionFields() {\n    const locale = this.locale;\n    const t = this.t;\n    // -- Label ---------------------------------------------------\n    const dimensionsLabel = new LabelView(locale);\n    dimensionsLabel.text = t('Dimensions');\n    // -- Width ---------------------------------------------------\n    const widthInput = new LabeledFieldView(locale, createLabeledInputText);\n    widthInput.set({\n      label: t('Width'),\n      class: 'ck-table-form__dimensions-row__width'\n    });\n    widthInput.fieldView.bind('value').to(this, 'width');\n    widthInput.fieldView.on('input', () => {\n      this.width = widthInput.fieldView.element.value;\n    });\n    // -- Operator ---------------------------------------------------\n    const operatorLabel = new View(locale);\n    operatorLabel.setTemplate({\n      tag: 'span',\n      attributes: {\n        class: ['ck-table-form__dimension-operator']\n      },\n      children: [{\n        text: 'Ã—'\n      }]\n    });\n    // -- Height ---------------------------------------------------\n    const heightInput = new LabeledFieldView(locale, createLabeledInputText);\n    heightInput.set({\n      label: t('Height'),\n      class: 'ck-table-form__dimensions-row__height'\n    });\n    heightInput.fieldView.bind('value').to(this, 'height');\n    heightInput.fieldView.on('input', () => {\n      this.height = heightInput.fieldView.element.value;\n    });\n    return {\n      dimensionsLabel,\n      widthInput,\n      operatorLabel,\n      heightInput\n    };\n  }\n  /**\n  * Creates the following form fields:\n  *\n  * * {@link #alignmentToolbar}.\n  */\n  _createAlignmentFields() {\n    const locale = this.locale;\n    const t = this.t;\n    // -- Label ---------------------------------------------------\n    const alignmentLabel = new LabelView(locale);\n    alignmentLabel.text = t('Alignment');\n    // -- Toolbar ---------------------------------------------------\n    const alignmentToolbar = new ToolbarView(locale);\n    alignmentToolbar.set({\n      role: 'radiogroup',\n      isCompact: true,\n      ariaLabel: t('Table alignment toolbar')\n    });\n    fillToolbar({\n      view: this,\n      icons: {\n        left: IconObjectInlineLeft,\n        center: IconObjectCenter,\n        right: IconObjectInlineRight\n      },\n      toolbar: alignmentToolbar,\n      labels: this._alignmentLabels,\n      propertyName: 'alignment',\n      defaultValue: this.options.defaultTableProperties.alignment\n    });\n    return {\n      alignmentLabel,\n      alignmentToolbar\n    };\n  }\n  /**\n  * Creates the following form controls:\n  *\n  * * {@link #saveButtonView},\n  * * {@link #cancelButtonView}.\n  */\n  _createActionButtons() {\n    const locale = this.locale;\n    const t = this.t;\n    const saveButtonView = new ButtonView(locale);\n    const cancelButtonView = new ButtonView(locale);\n    const fieldsThatShouldValidateToSave = [this.borderWidthInput, this.borderColorInput, this.backgroundInput, this.widthInput, this.heightInput];\n    saveButtonView.set({\n      label: t('Save'),\n      icon: IconCheck,\n      class: 'ck-button-save',\n      type: 'submit',\n      withText: true\n    });\n    saveButtonView.bind('isEnabled').toMany(fieldsThatShouldValidateToSave, 'errorText', (...errorTexts) => {\n      return errorTexts.every(errorText => !errorText);\n    });\n    cancelButtonView.set({\n      label: t('Cancel'),\n      icon: IconCancel,\n      class: 'ck-button-cancel',\n      withText: true\n    });\n    cancelButtonView.delegate('execute').to(this, 'cancel');\n    return {\n      saveButtonView,\n      cancelButtonView\n    };\n  }\n  /**\n  * Provides localized labels for {@link #alignmentToolbar} buttons.\n  */\n  get _alignmentLabels() {\n    const locale = this.locale;\n    const t = this.t;\n    const left = t('Align table to the left');\n    const center = t('Center table');\n    const right = t('Align table to the right');\n    // Returns object with a proper order of labels.\n    if (locale.uiLanguageDirection === 'rtl') {\n      return {\n        right,\n        center,\n        left\n      };\n    } else {\n      return {\n        left,\n        center,\n        right\n      };\n    }\n  }\n}\nfunction isBorderStyleSet(value) {\n  return value !== 'none';\n}\nconst ERROR_TEXT_TIMEOUT = 500;\n// Map of view properties and related commands.\nconst propertyToCommandMap = {\n  borderStyle: 'tableBorderStyle',\n  borderColor: 'tableBorderColor',\n  borderWidth: 'tableBorderWidth',\n  backgroundColor: 'tableBackgroundColor',\n  width: 'tableWidth',\n  height: 'tableHeight',\n  alignment: 'tableAlignment'\n};\n/**\n * The table properties UI plugin. It introduces the `'tableProperties'` button\n * that opens a form allowing to specify visual styling of an entire table.\n *\n * It uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon plugin}.\n */\nclass TablePropertiesUI extends Plugin {\n  /**\n  * The default table properties.\n  */\n  _defaultContentTableProperties;\n  /**\n  * The default layout table properties.\n  */\n  _defaultLayoutTableProperties;\n  /**\n  * The contextual balloon plugin instance.\n  */\n  _balloon;\n  /**\n  * The properties form view displayed inside the balloon.\n  */\n  view = null;\n  /**\n  * The properties form view displayed inside the balloon (content table).\n  */\n  _viewWithContentTableDefaults = null;\n  /**\n  * The properties form view displayed inside the balloon (layout table).\n  */\n  _viewWithLayoutTableDefaults = null;\n  /**\n  * The batch used to undo all changes made by the form (which are live, as the user types)\n  * when \"Cancel\" was pressed. Each time the view is shown, a new batch is created.\n  */\n  _undoStepBatch;\n  /**\n  * Flag used to indicate whether view is ready to execute update commands\n  * (it finished loading initial data).\n  */\n  _isReady;\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [ContextualBalloon];\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TablePropertiesUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('table.tableProperties', {\n      borderColors: defaultColors,\n      backgroundColors: defaultColors\n    });\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    this._defaultContentTableProperties = getNormalizedDefaultTableProperties(editor.config.get('table.tableProperties.defaultProperties'), {\n      includeAlignmentProperty: true\n    });\n    this._defaultLayoutTableProperties = getNormalizedDefaultProperties();\n    this._balloon = editor.plugins.get(ContextualBalloon);\n    editor.ui.componentFactory.add('tableProperties', () => this._createTablePropertiesButton());\n  }\n  /**\n  * Creates the table properties button.\n  *\n  * @internal\n  */\n  _createTablePropertiesButton() {\n    const editor = this.editor;\n    const t = editor.t;\n    const view = new ButtonView(editor.locale);\n    view.set({\n      label: t('Table properties'),\n      icon: IconTableProperties,\n      tooltip: true\n    });\n    this.listenTo(view, 'execute', () => this._showView());\n    const commands = Object.values(propertyToCommandMap).map(commandName => editor.commands.get(commandName));\n    view.bind('isEnabled').toMany(commands, 'isEnabled', (...areEnabled) => areEnabled.some(isCommandEnabled => isCommandEnabled));\n    return view;\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    super.destroy();\n    // Destroy created UI components as they are not automatically destroyed.\n    // See https://github.com/ckeditor/ckeditor5/issues/1341.\n    if (this.view) {\n      this.view.destroy();\n    }\n  }\n  /**\n  * Creates the {@link module:table/tableproperties/ui/tablepropertiesview~TablePropertiesView} instance.\n  *\n  * @returns The table properties form view instance.\n  */\n  _createPropertiesView(defaultTableProperties) {\n    const editor = this.editor;\n    const config = editor.config.get('table.tableProperties');\n    const borderColorsConfig = normalizeColorOptions(config.borderColors);\n    const localizedBorderColors = getLocalizedColorOptions(editor.locale, borderColorsConfig);\n    const backgroundColorsConfig = normalizeColorOptions(config.backgroundColors);\n    const localizedBackgroundColors = getLocalizedColorOptions(editor.locale, backgroundColorsConfig);\n    const hasColorPicker = config.colorPicker !== false;\n    const view = new TablePropertiesView(editor.locale, {\n      borderColors: localizedBorderColors,\n      backgroundColors: localizedBackgroundColors,\n      defaultTableProperties,\n      colorPickerConfig: hasColorPicker ? config.colorPicker || {} : false\n    });\n    const t = editor.t;\n    // Render the view so its #element is available for the clickOutsideHandler.\n    view.render();\n    this.listenTo(view, 'submit', () => {\n      this._hideView();\n    });\n    this.listenTo(view, 'cancel', () => {\n      // https://github.com/ckeditor/ckeditor5/issues/6180\n      if (this._undoStepBatch.operations.length) {\n        editor.execute('undo', this._undoStepBatch);\n      }\n      this._hideView();\n    });\n    // Close the balloon on Esc key press.\n    view.keystrokes.set('Esc', (data, cancel) => {\n      this._hideView();\n      cancel();\n    });\n    // Close on click outside of balloon panel element.\n    clickOutsideHandler({\n      emitter: view,\n      activator: () => this._isViewInBalloon,\n      contextElements: [this._balloon.view.element],\n      callback: () => this._hideView()\n    });\n    const colorErrorText = getLocalizedColorErrorText(t);\n    const lengthErrorText = getLocalizedLengthErrorText(t);\n    // Create the \"UI -> editor data\" binding.\n    // These listeners update the editor data (via table commands) when any observable\n    // property of the view has changed. They also validate the value and display errors in the UI\n    // when necessary. This makes the view live, which means the changes are\n    // visible in the editing as soon as the user types or changes fields' values.\n    view.on('change:borderStyle', this._getPropertyChangeCallback('tableBorderStyle'));\n    view.on('change:borderColor', this._getValidatedPropertyChangeCallback({\n      viewField: view.borderColorInput,\n      commandName: 'tableBorderColor',\n      errorText: colorErrorText,\n      validator: colorFieldValidator\n    }));\n    view.on('change:borderWidth', this._getValidatedPropertyChangeCallback({\n      viewField: view.borderWidthInput,\n      commandName: 'tableBorderWidth',\n      errorText: lengthErrorText,\n      validator: lineWidthFieldValidator\n    }));\n    view.on('change:backgroundColor', this._getValidatedPropertyChangeCallback({\n      viewField: view.backgroundInput,\n      commandName: 'tableBackgroundColor',\n      errorText: colorErrorText,\n      validator: colorFieldValidator\n    }));\n    view.on('change:width', this._getValidatedPropertyChangeCallback({\n      viewField: view.widthInput,\n      commandName: 'tableWidth',\n      errorText: lengthErrorText,\n      validator: lengthFieldValidator\n    }));\n    view.on('change:height', this._getValidatedPropertyChangeCallback({\n      viewField: view.heightInput,\n      commandName: 'tableHeight',\n      errorText: lengthErrorText,\n      validator: lengthFieldValidator\n    }));\n    view.on('change:alignment', this._getPropertyChangeCallback('tableAlignment'));\n    return view;\n  }\n  /**\n  * In this method the \"editor data -> UI\" binding is happening.\n  *\n  * When executed, this method obtains selected table property values from various table commands\n  * and passes them to the {@link #view}.\n  *\n  * This way, the UI stays upâ€“toâ€“date with the editor data.\n  */\n  _fillViewFormFromCommandValues() {\n    const commands = this.editor.commands;\n    const borderStyleCommand = commands.get('tableBorderStyle');\n    Object.entries(propertyToCommandMap).map(([property, commandName]) => {\n      const propertyKey = property;\n      const defaultValue = this.view === this._viewWithContentTableDefaults ? this._defaultContentTableProperties[propertyKey] || '' : this._defaultLayoutTableProperties[propertyKey] || '';\n      return [propertyKey, commands.get(commandName).value || defaultValue];\n    }).forEach(([property, value]) => {\n      // Do not set the `border-color` and `border-width` fields if `border-style:none`.\n      if ((property === 'borderColor' || property === 'borderWidth') && borderStyleCommand.value === 'none') {\n        return;\n      }\n      this.view.set(property, value);\n    });\n    this._isReady = true;\n  }\n  /**\n  * Shows the {@link #view} in the {@link #_balloon}.\n  *\n  * **Note**: Each time a view is shown, the new {@link #_undoStepBatch} is created that contains\n  * all changes made to the document when the view is visible, allowing a single undo step\n  * for all of them.\n  */\n  _showView() {\n    const editor = this.editor;\n    const viewTable = getSelectionAffectedTableWidget(editor.editing.view.document.selection);\n    const modelTable = viewTable && editor.editing.mapper.toModelElement(viewTable);\n    const useDefaults = !modelTable || modelTable.getAttribute('tableType') !== 'layout';\n    if (useDefaults && !this._viewWithContentTableDefaults) {\n      this._viewWithContentTableDefaults = this._createPropertiesView(this._defaultContentTableProperties);\n    } else if (!useDefaults && !this._viewWithLayoutTableDefaults) {\n      this._viewWithLayoutTableDefaults = this._createPropertiesView(this._defaultLayoutTableProperties);\n    }\n    this.view = useDefaults ? this._viewWithContentTableDefaults : this._viewWithLayoutTableDefaults;\n    this.listenTo(editor.ui, 'update', () => {\n      this._updateView();\n    });\n    // Update the view with the model values.\n    this._fillViewFormFromCommandValues();\n    this._balloon.add({\n      view: this.view,\n      position: getBalloonTablePositionData(editor)\n    });\n    // Create a new batch. Clicking \"Cancel\" will undo this batch.\n    this._undoStepBatch = editor.model.createBatch();\n    // Basic a11y.\n    this.view.focus();\n  }\n  /**\n  * Removes the {@link #view} from the {@link #_balloon}.\n  */\n  _hideView() {\n    const editor = this.editor;\n    this.stopListening(editor.ui, 'update');\n    this._isReady = false;\n    // Blur any input element before removing it from DOM to prevent issues in some browsers.\n    // See https://github.com/ckeditor/ckeditor5/issues/1501.\n    this.view.saveButtonView.focus();\n    this._balloon.remove(this.view);\n    // Make sure the focus is not lost in the process by putting it directly\n    // into the editing view.\n    this.editor.editing.view.focus();\n  }\n  /**\n  * Repositions the {@link #_balloon} or hides the {@link #view} if a table is no longer selected.\n  */\n  _updateView() {\n    const editor = this.editor;\n    const viewDocument = editor.editing.view.document;\n    if (!getSelectionAffectedTableWidget(viewDocument.selection)) {\n      this._hideView();\n    } else if (this._isViewVisible) {\n      repositionContextualBalloon(editor, 'table');\n    }\n  }\n  /**\n  * Returns `true` when the {@link #view} is the visible in the {@link #_balloon}.\n  */\n  get _isViewVisible() {\n    return !!this.view && this._balloon.visibleView === this.view;\n  }\n  /**\n  * Returns `true` when the {@link #view} is in the {@link #_balloon}.\n  */\n  get _isViewInBalloon() {\n    return !!this.view && this._balloon.hasView(this.view);\n  }\n  /**\n  * Creates a callback that when executed upon {@link #view view's} property change\n  * executes a related editor command with the new property value.\n  *\n  * If new value will be set to the default value, the command will not be executed.\n  *\n  * @param commandName The command that will be executed.\n  */\n  _getPropertyChangeCallback(commandName) {\n    return (evt, propertyName, newValue) => {\n      // Do not execute the command on initial call (opening the table properties view).\n      if (!this._isReady) {\n        return;\n      }\n      this.editor.execute(commandName, {\n        value: newValue,\n        batch: this._undoStepBatch\n      });\n    };\n  }\n  /**\n  * Creates a callback that when executed upon {@link #view view's} property change:\n  * * executes a related editor command with the new property value if the value is valid,\n  * * or sets the error text next to the invalid field, if the value did not pass the validation.\n  */\n  _getValidatedPropertyChangeCallback(options) {\n    const {\n      commandName,\n      viewField,\n      validator,\n      errorText\n    } = options;\n    const setErrorTextDebounced = debounce(() => {\n      viewField.errorText = errorText;\n    }, ERROR_TEXT_TIMEOUT);\n    return (evt, propertyName, newValue) => {\n      setErrorTextDebounced.cancel();\n      // Do not execute the command on initial call (opening the table properties view).\n      if (!this._isReady) {\n        return;\n      }\n      if (validator(newValue)) {\n        this.editor.execute(commandName, {\n          value: newValue,\n          batch: this._undoStepBatch\n        });\n        viewField.errorText = null;\n      } else {\n        setErrorTextDebounced();\n      }\n    };\n  }\n}\n\n/**\n * The table properties feature. Enables support for setting properties of tables (size, border, background, etc.).\n *\n * Read more in the {@glink features/tables/tables-styling Table and cell styling tools} section.\n * See also the {@link module:table/tablecellproperties~TableCellProperties} plugin.\n *\n * This is a \"glue\" plugin that loads the\n * {@link module:table/tableproperties/tablepropertiesediting~TablePropertiesEditing table properties editing feature} and\n * the {@link module:table/tableproperties/tablepropertiesui~TablePropertiesUI table properties UI feature}.\n */\nclass TableProperties extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableProperties';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TablePropertiesEditing, TablePropertiesUI];\n  }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module table/converters/table-caption-post-fixer\n    */ /**\n       * Injects a table caption post-fixer into the model.\n       *\n       * The role of the table caption post-fixer is to ensure that the table with caption have the correct structure\n       * after a {@link module:engine/model/model~Model#change `change()`} block was executed.\n       *\n       * The correct structure means that:\n       *\n       * * If there are many caption model element, they are merged into one model.\n       * * A final, merged caption model is placed at the end of the table.\n       */\nfunction injectTableCaptionPostFixer(model) {\n  model.document.registerPostFixer(writer => tableCaptionPostFixer(writer, model));\n}\n/**\n * The table caption post-fixer.\n */\nfunction tableCaptionPostFixer(writer, model) {\n  const changes = model.document.differ.getChanges();\n  let wasFixed = false;\n  for (const entry of changes) {\n    if (entry.type != 'insert') {\n      continue;\n    }\n    const positionParent = entry.position.parent;\n    if (positionParent.is('element', 'table') || entry.name == 'table') {\n      const table = entry.name == 'table' ? entry.position.nodeAfter : positionParent;\n      const captionsToMerge = Array.from(table.getChildren()).filter(child => child.is('element', 'caption'));\n      const firstCaption = captionsToMerge.shift();\n      if (!firstCaption) {\n        continue;\n      }\n      // Move all the contents of the captions to the first one.\n      for (const caption of captionsToMerge) {\n        writer.move(writer.createRangeIn(caption), firstCaption, 'end');\n        writer.remove(caption);\n      }\n      // Make sure the final caption is at the end of the table.\n      if (firstCaption.nextSibling) {\n        writer.move(writer.createRangeOn(firstCaption), table, 'end');\n        wasFixed = true;\n      }\n      // Do we merged captions and/or moved the single caption to the end of the table?\n      wasFixed = !!captionsToMerge.length || wasFixed;\n    }\n  }\n  return wasFixed;\n}\n\n/**\n * Checks if the provided model element is a `table`.\n *\n * @param modelElement Element to check if it is a table.\n */\nfunction isTable(modelElement) {\n  return !!modelElement && modelElement.is('element', 'table');\n}\n/**\n * Returns the caption model element from a given table element. Returns `null` if no caption is found.\n *\n * @param tableModelElement Table element in which we will try to find a caption element.\n */\nfunction getCaptionFromTableModelElement(tableModelElement) {\n  for (const node of tableModelElement.getChildren()) {\n    if (node.is('element', 'caption')) {\n      return node;\n    }\n  }\n  return null;\n}\n/**\n * Returns the caption model element for a model selection. Returns `null` if the selection has no caption element ancestor.\n *\n * @param selection The selection checked for caption presence.\n */\nfunction getCaptionFromModelSelection(selection) {\n  const tableElement = getSelectionAffectedTable(selection);\n  if (!tableElement) {\n    return null;\n  }\n  return getCaptionFromTableModelElement(tableElement);\n}\n/**\n * {@link module:engine/view/matcher~Matcher} pattern. Checks if a given element is a caption.\n *\n * There are two possible forms of the valid caption:\n *  - A `<figcaption>` element inside a `<figure class=\"table\">` element.\n *  - A `<caption>` inside a <table>.\n *\n * @returns Returns the object accepted by {@link module:engine/view/matcher~Matcher} or `null` if the element cannot be matched.\n */\nfunction matchTableCaptionViewElement(element) {\n  const parent = element.parent;\n  if (element.name == 'figcaption' && parent && parent.is('element', 'figure') && parent.hasClass('table')) {\n    return {\n      name: true\n    };\n  }\n  if (element.name == 'caption' && parent && parent.is('element', 'table')) {\n    return {\n      name: true\n    };\n  }\n  return null;\n}\n\n/**\n * The toggle table caption command.\n *\n * This command is registered by {@link module:table/tablecaption/tablecaptionediting~TableCaptionEditing} as the\n * `'toggleTableCaption'` editor command.\n *\n * Executing this command:\n *\n * * either adds or removes the table caption of a selected table (depending on whether the caption is present or not),\n * * removes the table caption if the selection is anchored in one.\n *\n * ```ts\n * // Toggle the presence of the caption.\n * editor.execute( 'toggleTableCaption' );\n * ```\n *\n * **Note**: You can move the selection to the caption right away as it shows up upon executing this command by using\n * the `focusCaptionOnShow` option:\n *\n * ```ts\n * editor.execute( 'toggleTableCaption', { focusCaptionOnShow: true } );\n * ```\n */\nclass ToggleTableCaptionCommand extends Command {\n  /**\n  * @inheritDoc\n  */\n  refresh() {\n    const editor = this.editor;\n    const tableElement = getSelectionAffectedTable(editor.model.document.selection);\n    this.isEnabled = !!tableElement && editor.model.schema.checkChild(tableElement, 'caption');\n    if (!this.isEnabled) {\n      this.value = false;\n    } else {\n      this.value = !!getCaptionFromTableModelElement(tableElement);\n    }\n  }\n  /**\n  * Executes the command.\n  *\n  * ```ts\n  * editor.execute( 'toggleTableCaption' );\n  * ```\n  *\n  * @param options Options for the executed command.\n  * @param options.focusCaptionOnShow When true and the caption shows up, the selection will be moved into it straight away.\n  * @fires execute\n  */\n  execute({\n    focusCaptionOnShow = false\n  } = {}) {\n    this.editor.model.change(writer => {\n      if (this.value) {\n        this._hideTableCaption(writer);\n      } else {\n        this._showTableCaption(writer, focusCaptionOnShow);\n      }\n    });\n  }\n  /**\n  * Shows the table caption. Also:\n  *\n  * * it attempts to restore the caption content from the `TableCaptionEditing` caption registry,\n  * * it moves the selection to the caption right away, it the `focusCaptionOnShow` option was set.\n  *\n  * @param focusCaptionOnShow Default focus behavior when showing the caption.\n  */\n  _showTableCaption(writer, focusCaptionOnShow) {\n    const model = this.editor.model;\n    const tableElement = getSelectionAffectedTable(model.document.selection);\n    const tableCaptionEditing = this.editor.plugins.get('TableCaptionEditing');\n    const savedCaptionElement = tableCaptionEditing._getSavedCaption(tableElement);\n    // Try restoring the caption from the TableCaptionEditing plugin storage.\n    const newCaptionElement = savedCaptionElement || writer.createElement('caption');\n    model.insertContent(newCaptionElement, tableElement, 'end');\n    if (focusCaptionOnShow) {\n      writer.setSelection(newCaptionElement, 'in');\n    }\n  }\n  /**\n  * Hides the caption of a selected table (or an table caption the selection is anchored to).\n  *\n  * The content of the caption is stored in the `TableCaptionEditing` caption registry to make this\n  * a reversible action.\n  */\n  _hideTableCaption(writer) {\n    const model = this.editor.model;\n    const tableElement = getSelectionAffectedTable(model.document.selection);\n    const tableCaptionEditing = this.editor.plugins.get('TableCaptionEditing');\n    const captionElement = getCaptionFromTableModelElement(tableElement);\n    // Store the caption content so it can be restored quickly if the user changes their mind.\n    tableCaptionEditing._saveCaption(tableElement, captionElement);\n    model.deleteContent(writer.createSelection(captionElement, 'on'));\n  }\n}\n\n/**\n * The table caption editing plugin.\n */\nclass TableCaptionEditing extends Plugin {\n  /**\n  * A map that keeps saved JSONified table captions and table model elements they are\n  * associated with.\n  *\n  * To learn more about this system, see {@link #_saveCaption}.\n  */\n  _savedCaptionsMap;\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableCaptionEditing';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this._savedCaptionsMap = new WeakMap();\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const schema = editor.model.schema;\n    const view = editor.editing.view;\n    const t = editor.t;\n    if (!schema.isRegistered('caption')) {\n      schema.register('caption', {\n        allowIn: 'table',\n        allowContentOf: '$block',\n        isLimit: true\n      });\n    } else {\n      schema.extend('caption', {\n        allowIn: 'table'\n      });\n    }\n    editor.commands.add('toggleTableCaption', new ToggleTableCaptionCommand(this.editor));\n    // View -> model converter for the data pipeline.\n    editor.conversion.for('upcast').elementToElement({\n      view: matchTableCaptionViewElement,\n      model: 'caption'\n    });\n    // Model -> view converter for the data pipeline.\n    editor.conversion.for('dataDowncast').elementToElement({\n      model: 'caption',\n      view: (modelElement, {\n        writer\n      }) => {\n        if (!isTable(modelElement.parent)) {\n          return null;\n        }\n        return writer.createContainerElement('figcaption');\n      }\n    });\n    // Model -> view converter for the editing pipeline.\n    editor.conversion.for('editingDowncast').elementToElement({\n      model: 'caption',\n      view: (modelElement, {\n        writer\n      }) => {\n        if (!isTable(modelElement.parent)) {\n          return null;\n        }\n        const figcaptionElement = writer.createEditableElement('figcaption');\n        writer.setCustomProperty('tableCaption', true, figcaptionElement);\n        figcaptionElement.placeholder = t('Enter table caption');\n        enablePlaceholder({\n          view,\n          element: figcaptionElement,\n          keepOnFocus: true\n        });\n        return toWidgetEditable(figcaptionElement, writer);\n      }\n    });\n    injectTableCaptionPostFixer(editor.model);\n  }\n  /**\n  * Returns the saved {@link module:engine/model/element~Element#toJSON JSONified} caption\n  * of a table model element.\n  *\n  * See {@link #_saveCaption}.\n  *\n  * @internal\n  * @param tableModelElement The model element the caption should be returned for.\n  * @returns The model caption element or `null` if there is none.\n  */\n  _getSavedCaption(tableModelElement) {\n    const jsonObject = this._savedCaptionsMap.get(tableModelElement);\n    return jsonObject ? Element.fromJSON(jsonObject) : null;\n  }\n  /**\n  * Saves a {@link module:engine/model/element~Element#toJSON JSONified} caption for\n  * a table element to allow restoring it in the future.\n  *\n  * A caption is saved every time it gets hidden. The\n  * user should be able to restore it on demand.\n  *\n  * **Note**: The caption cannot be stored in the table model element attribute because,\n  * for instance, when the model state propagates to collaborators, the attribute would get\n  * lost (mainly because it does not convert to anything when the caption is hidden) and\n  * the states of collaborators' models would de-synchronize causing numerous issues.\n  *\n  * See {@link #_getSavedCaption}.\n  *\n  * @internal\n  * @param tableModelElement The model element the caption is saved for.\n  * @param caption The caption model element to be saved.\n  */\n  _saveCaption(tableModelElement, caption) {\n    this._savedCaptionsMap.set(tableModelElement, caption.toJSON());\n  }\n}\n\n/**\n  * The table caption UI plugin. It introduces the `'toggleTableCaption'` UI button.\n  */\nclass TableCaptionUI extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableCaptionUI';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    const editingView = editor.editing.view;\n    const t = editor.t;\n    editor.ui.componentFactory.add('toggleTableCaption', locale => {\n      const command = editor.commands.get('toggleTableCaption');\n      const view = new ButtonView(locale);\n      view.set({\n        icon: IconCaption,\n        tooltip: true,\n        isToggleable: true\n      });\n      view.bind('isOn', 'isEnabled').to(command, 'value', 'isEnabled');\n      view.bind('label').to(command, 'value', value => value ? t('Toggle caption off') : t('Toggle caption on'));\n      this.listenTo(view, 'execute', () => {\n        editor.execute('toggleTableCaption', {\n          focusCaptionOnShow: true\n        });\n        // Scroll to the selection and highlight the caption if the caption showed up.\n        if (command.value) {\n          const modelCaptionElement = getCaptionFromModelSelection(editor.model.document.selection);\n          const figcaptionElement = editor.editing.mapper.toViewElement(modelCaptionElement);\n          if (!figcaptionElement) {\n            return;\n          }\n          editingView.scrollToTheSelection();\n          editingView.change(writer => {\n            writer.addClass('table__caption_highlighted', figcaptionElement);\n          });\n        }\n        editor.editing.view.focus();\n      });\n      return view;\n    });\n  }\n}\n\n/**\n * The table caption plugin.\n */\nclass TableCaption extends Plugin {\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'TableCaption';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get requires() {\n    return [TableCaptionEditing, TableCaptionUI];\n  }\n}\nexport { PlainTableOutput, Table, TableCaption, TableCaptionEditing, TableCaptionUI, TableCellProperties, TableCellPropertiesEditing, TableCellPropertiesUI, TableCellWidthEditing, TableClipboard, TableColumnResize, TableColumnResizeEditing, TableEditing, TableKeyboard, TableLayout, TableLayoutEditing, TableMouse, TableProperties, TablePropertiesEditing, TablePropertiesUI, TableSelection, TableToolbar, TableUI, TableUtils };\n", "/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\nimport { Plugin } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Template, View } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { env } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { throttle, isElement } from 'es-toolkit/compat';\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n    * @module word-count/utils\n    */ /**\n       * Returns a plain text representation of an element and its children.\n       *\n       * @returns Plain text representing the model's data.\n       */\nfunction modelElementToPlainText(item) {\n  if (item.is('$text') || item.is('$textProxy')) {\n    return item.data;\n  }\n  const element = item;\n  let text = '';\n  let prev = null;\n  for (const child of element.getChildren()) {\n    const childText = modelElementToPlainText(child);\n    // If last block was finish, start from new line.\n    if (prev && prev.is('element')) {\n      text += '\\n';\n    }\n    text += childText;\n    prev = child;\n  }\n  return text;\n}\n\n/**\n * The word count plugin.\n *\n * This plugin calculates all words and characters in all {@link module:engine/model/text~Text text nodes} available in the model.\n * It also provides an HTML element that updates its state whenever the editor content is changed.\n *\n * The model's data is first converted to plain text using {@link module:word-count/utils~modelElementToPlainText}.\n * The number of words and characters in your text are determined based on the created plain text. Please keep in mind\n * that every block in the editor is separated with a newline character, which is included in the calculation.\n *\n * Here are some examples of how the word and character calculations are made:\n *\n * ```html\n * <paragraph>foo</paragraph>\n * <paragraph>bar</paragraph>\n * // Words: 2, Characters: 7\n *\n * <paragraph><$text bold=\"true\">foo</$text>bar</paragraph>\n * // Words: 1, Characters: 6\n *\n * <paragraph>*&^%)</paragraph>\n * // Words: 0, Characters: 5\n *\n * <paragraph>foo(bar)</paragraph>\n * //Words: 1, Characters: 8\n *\n * <paragraph>12345</paragraph>\n * // Words: 1, Characters: 5\n * ```\n */\nclass WordCount extends Plugin {\n  /**\n  * The configuration of this plugin.\n  */\n  _config;\n  /**\n  * The reference to a {@link module:ui/view~View view object} that contains the self-updating HTML container.\n  */\n  _outputView;\n  /**\n  * A regular expression used to recognize words in the editor's content.\n  */\n  _wordsMatchRegExp;\n  /**\n  * @inheritDoc\n  */\n  constructor(editor) {\n    super(editor);\n    this.set('characters', 0);\n    this.set('words', 0);\n    // Don't wait for the #update event to set the value of the properties but obtain it right away.\n    // This way, accessing the properties directly returns precise numbers, e.g. for validation, etc.\n    // If not accessed directly, the properties will be refreshed upon #update anyway.\n    Object.defineProperties(this, {\n      characters: {\n        get() {\n          return this.characters = this._getCharacters(this._getText());\n        }\n      },\n      words: {\n        get() {\n          return this.words = this._getWords(this._getText());\n        }\n      }\n    });\n    this.set('_wordsLabel', undefined);\n    this.set('_charactersLabel', undefined);\n    this._config = editor.config.get('wordCount') || {};\n    this._outputView = undefined;\n    this._wordsMatchRegExp = env.features.isRegExpUnicodePropertySupported ?\n    // Usage of regular expression literal cause error during build (ckeditor/ckeditor5-dev#534).\n    // Groups:\n    // {L} - Any kind of letter from any language.\n    // {N} - Any kind of numeric character in any script.\n    new RegExp('([\\\\p{L}\\\\p{N}]+\\\\S?)+', 'gu') : /([a-zA-Z0-9Ã€-Å¾]+\\S?)+/gu;\n  }\n  /**\n  * @inheritDoc\n  */\n  static get pluginName() {\n    return 'WordCount';\n  }\n  /**\n  * @inheritDoc\n  */\n  static get isOfficialPlugin() {\n    return true;\n  }\n  /**\n  * @inheritDoc\n  */\n  init() {\n    const editor = this.editor;\n    editor.model.document.on('change:data', throttle(this._refreshStats.bind(this), 250));\n    if (typeof this._config.onUpdate == 'function') {\n      this.on('update', (evt, data) => {\n        this._config.onUpdate(data);\n      });\n    }\n    if (isElement(this._config.container)) {\n      this._config.container.appendChild(this.wordCountContainer);\n    }\n  }\n  /**\n  * @inheritDoc\n  */\n  destroy() {\n    if (this._outputView) {\n      this._outputView.element.remove();\n      this._outputView.destroy();\n    }\n    super.destroy();\n  }\n  /**\n  * Creates a self-updating HTML element. Repeated executions return the same element.\n  * The returned element has the following HTML structure:\n  *\n  * ```html\n  * <div class=\"ck ck-word-count\">\n  * \t<div class=\"ck-word-count__words\">Words: 4</div>\n  * \t<div class=\"ck-word-count__characters\">Characters: 28</div>\n  * </div>\n  * ```\n  */\n  get wordCountContainer() {\n    const editor = this.editor;\n    const t = editor.t;\n    const displayWords = editor.config.get('wordCount.displayWords');\n    const displayCharacters = editor.config.get('wordCount.displayCharacters');\n    const bind = Template.bind(this, this);\n    const children = [];\n    if (!this._outputView) {\n      this._outputView = new View();\n      if (displayWords || displayWords === undefined) {\n        this.bind('_wordsLabel').to(this, 'words', words => {\n          return t('Words: %0', words);\n        });\n        children.push({\n          tag: 'div',\n          children: [{\n            text: [bind.to('_wordsLabel')]\n          }],\n          attributes: {\n            class: 'ck-word-count__words'\n          }\n        });\n      }\n      if (displayCharacters || displayCharacters === undefined) {\n        this.bind('_charactersLabel').to(this, 'characters', words => {\n          return t('Characters: %0', words);\n        });\n        children.push({\n          tag: 'div',\n          children: [{\n            text: [bind.to('_charactersLabel')]\n          }],\n          attributes: {\n            class: 'ck-word-count__characters'\n          }\n        });\n      }\n      this._outputView.setTemplate({\n        tag: 'div',\n        attributes: {\n          class: ['ck', 'ck-word-count']\n        },\n        children\n      });\n      this._outputView.render();\n    }\n    return this._outputView.element;\n  }\n  _getText() {\n    let txt = '';\n    for (const root of this.editor.model.document.getRoots()) {\n      if (txt !== '') {\n        // Add a delimiter, so words from each root are treated independently.\n        txt += '\\n';\n      }\n      txt += modelElementToPlainText(root);\n    }\n    return txt;\n  }\n  /**\n  * Determines the number of characters in the current editor's model.\n  */\n  _getCharacters(txt) {\n    return txt.replace(/\\n/g, '').length;\n  }\n  /**\n  * Determines the number of words in the current editor's model.\n  */\n  _getWords(txt) {\n    const detectedWords = txt.match(this._wordsMatchRegExp) || [];\n    return detectedWords.length;\n  }\n  /**\n  * Determines the number of words and characters in the current editor's model and assigns it to {@link #characters} and {@link #words}.\n  * It also fires the {@link #event:update}.\n  *\n  * @fires update\n  */\n  _refreshStats() {\n    const txt = this._getText();\n    const words = this.words = this._getWords(txt);\n    const characters = this.characters = this._getCharacters(txt);\n    this.fire('update', {\n      words,\n      characters\n    });\n  }\n}\nexport { WordCount };\n"],
  "mappings": "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",
  "names": ["root", "options", "result", "q", "i", "score", "j", "x", "r", "a", "v", "f", "j", "options", "block", "range", "text", "remove", "block", "attributeKey", "attributeKey", "options", "options", "block", "quote", "View", "cancel", "options", "isBookmarkAllowed", "bookmark", "getListItems", "remove", "options", "range", "isLibraryLoaded", "category", "image", "isLinkElement", "error", "notification", "imageUrl", "asset", "options", "image", "notification", "options", "error", "text", "options", "block", "code", "codeBlock", "data", "model", "indent", "outdent", "Model", "Adapter", "isElement", "options", "isElement", "getInitialData", "options", "isElement", "getInitialData", "options", "isElement", "getInitialData", "options", "getInitialData", "evt", "root", "isElement", "count", "x", "emoji", "fuzzysort", "searchQueryTokens", "text", "View", "Model", "VISUAL_SELECTION_MARKER_NAME", "cancel", "View", "options", "marker", "text", "HIGHLIGHT_CLASS", "attributeKey", "options", "document", "Model", "locale", "isVisible", "cancel", "block", "options", "document", "Model", "paragraph", "root", "marker", "cancel", "options", "document", "listItemView", "buttonView", "writer", "editor", "source", "values", "attributeKey", "definitions", "rules", "pattern", "splitRules", "blockElements", "options", "table", "error", "root", "marker", "range", "options", "writer", "View", "cancel", "attributeKey", "image", "marker", "isEnabled", "caption", "uploadImageCommand", "notification", "error", "Model", "option", "getFormValidators", "DEFAULT_OPTIONS", "name", "source", "normalizeStyles", "getDefaultStylesConfiguration", "document", "block", "options", "options", "Model", "item", "createLinkElement", "link", "protocol", "text", "HIGHLIGHT_CLASS", "cancel", "View", "VISUAL_SELECTION_MARKER_NAME", "getFormValidators", "options", "indent", "block", "attributeKey", "document", "shouldMergeOnBlocksContentLevel", "marker", "outdent", "x", "numberedList", "bulletedList", "View", "next", "data", "root", "html", "noopTest", "tableRow", "count", "link", "lexer", "text", "options", "indent", "j", "mangle", "smartypants", "rules", "next", "Renderer", "code", "quote", "parser", "cell", "args", "walkTokens", "source", "count", "options", "underline", "code", "rules", "isBlock", "isVoid", "node", "text", "remove", "next", "Parser", "root", "defaults", "escape", "options", "strikethrough", "indexOf", "rules", "escape", "string", "html", "parser", "document", "options", "View", "isMediaSelected", "getFormValidators", "options", "document", "text", "View", "marker", "error", "options", "html", "toPx", "View", "diff", "block", "marker", "HIGHLIGHT_CLASS", "COMMAND_FORCE_DISABLE_ID", "root", "cancel", "options", "Model", "document", "root", "COMMAND_FORCE_DISABLE_ID", "View", "Model", "source", "options", "View", "block", "inline", "tableRow", "table", "options", "viewElement", "table", "paragraph", "cell", "row", "tableRow", "attributeKey", "tableUtils", "first", "totalWidth", "element", "insertAt", "count", "View", "Model", "writer", "isVisible", "repositionContextualBalloon", "cancel", "tableCells", "editor", "t", "isAllowedInParent", "toPx", "root", "modelTable", "columnWidthsInPx", "viewTable", "caption", "text", "View", "root"]
}
